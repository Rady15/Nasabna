const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.es-UX7yn5Wd.js","assets/vendor-BKU87Gzz.js","assets/query-BznAFzS8.js","assets/router-DDWzQd2G.js","assets/forms-Csk79DIL.js","assets/d3-D8AkCXfq.js"])))=>i.map(i=>d[i]);
var oq=Object.defineProperty;var lq=(e,t,n)=>t in e?oq(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Hn=(e,t,n)=>lq(e,typeof t!="symbol"?t+"":t,n);import{j as o,Q as cq,a as uq}from"./query-BznAFzS8.js";import{b as dq,r as J,g as n0,a as be,c as Tf}from"./vendor-BKU87Gzz.js";import{L as _t,u as e3,a as jr,N as uh,b as t3,c as pd,R as fq,d as $n,B as hq}from"./router-DDWzQd2G.js";import{o as mq,r as pq,a as gq,b as r0,s as mo,u as zh,c as xq}from"./forms-Csk79DIL.js";import{i as dc,z as RP,s as n3,p as $P,d as yq}from"./d3-D8AkCXfq.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var g5={},o_=dq;g5.createRoot=o_.createRoot,g5.hydrateRoot=o_.hydrateRoot;let vq={data:""},bq=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||vq,wq=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,Nq=/\/\*[^]*?\*\/|  +/g,l_=/\n+/g,sl=(e,t)=>{let n="",r="",s="";for(let i in e){let l=e[i];i[0]=="@"?i[1]=="i"?n=i+" "+l+";":r+=i[1]=="f"?sl(l,i):i+"{"+sl(l,i[1]=="k"?"":t)+"}":typeof l=="object"?r+=sl(l,t?t.replace(/([^,])+/g,a=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,c=>/&/.test(c)?c.replace(/&/g,a):a?a+" "+c:c)):i):l!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),s+=sl.p?sl.p(i,l):i+":"+l+";")}return n+(t&&s?t+"{"+s+"}":s)+r},no={},OP=e=>{if(typeof e=="object"){let t="";for(let n in e)t+=n+OP(e[n]);return t}return e},jq=(e,t,n,r,s)=>{let i=OP(e),l=no[i]||(no[i]=(c=>{let d=0,u=11;for(;d<c.length;)u=101*u+c.charCodeAt(d++)>>>0;return"go"+u})(i));if(!no[l]){let c=i!==e?e:(d=>{let u,f,m=[{}];for(;u=wq.exec(d.replace(Nq,""));)u[4]?m.shift():u[3]?(f=u[3].replace(l_," ").trim(),m.unshift(m[0][f]=m[0][f]||{})):m[0][u[1]]=u[2].replace(l_," ").trim();return m[0]})(e);no[l]=sl(s?{["@keyframes "+l]:c}:c,n?"":"."+l)}let a=n&&no.g?no.g:null;return n&&(no.g=no[l]),((c,d,u,f)=>{f?d.data=d.data.replace(f,c):d.data.indexOf(c)===-1&&(d.data=u?c+d.data:d.data+c)})(no[l],t,r,a),l},_q=(e,t,n)=>e.reduce((r,s,i)=>{let l=t[i];if(l&&l.call){let a=l(n),c=a&&a.props&&a.props.className||/^go/.test(a)&&a;l=c?"."+c:a&&typeof a=="object"?a.props?"":sl(a,""):a===!1?"":a}return r+s+(l??"")},"");function s0(e){let t=this||{},n=e.call?e(t.p):e;return jq(n.unshift?n.raw?_q(n,[].slice.call(arguments,1),t.p):n.reduce((r,s)=>Object.assign(r,s&&s.call?s(t.p):s),{}):n,bq(t.target),t.g,t.o,t.k)}let FP,x5,y5;s0.bind({g:1});let wo=s0.bind({k:1});function Sq(e,t,n,r){sl.p=t,FP=e,x5=n,y5=r}function Nl(e,t){let n=this||{};return function(){let r=arguments;function s(i,l){let a=Object.assign({},i),c=a.className||s.className;n.p=Object.assign({theme:x5&&x5()},a),n.o=/ *go\d+/.test(c),a.className=s0.apply(n,r)+(c?" "+c:"");let d=e;return e[0]&&(d=a.as||e,delete a.as),y5&&d[0]&&y5(a),FP(d,a)}return s}}var Aq=e=>typeof e=="function",Qp=(e,t)=>Aq(e)?e(t):e,kq=(()=>{let e=0;return()=>(++e).toString()})(),DP=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),Eq=20,qP=(e,t)=>{switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,Eq)};case 1:return{...e,toasts:e.toasts.map(i=>i.id===t.toast.id?{...i,...t.toast}:i)};case 2:let{toast:n}=t;return qP(e,{type:e.toasts.find(i=>i.id===n.id)?1:0,toast:n});case 3:let{toastId:r}=t;return{...e,toasts:e.toasts.map(i=>i.id===r||r===void 0?{...i,dismissed:!0,visible:!1}:i)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(i=>i.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let s=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(i=>({...i,pauseDuration:i.pauseDuration+s}))}}},Ep=[],ac={toasts:[],pausedAt:void 0},Cc=e=>{ac=qP(ac,e),Ep.forEach(t=>{t(ac)})},Cq={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},Pq=(e={})=>{let[t,n]=J.useState(ac),r=J.useRef(ac);J.useEffect(()=>(r.current!==ac&&n(ac),Ep.push(n),()=>{let i=Ep.indexOf(n);i>-1&&Ep.splice(i,1)}),[]);let s=t.toasts.map(i=>{var l,a,c;return{...e,...e[i.type],...i,removeDelay:i.removeDelay||((l=e[i.type])==null?void 0:l.removeDelay)||(e==null?void 0:e.removeDelay),duration:i.duration||((a=e[i.type])==null?void 0:a.duration)||(e==null?void 0:e.duration)||Cq[i.type],style:{...e.style,...(c=e[i.type])==null?void 0:c.style,...i.style}}});return{...t,toasts:s}},Iq=(e,t="blank",n)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...n,id:(n==null?void 0:n.id)||kq()}),Uh=e=>(t,n)=>{let r=Iq(t,e,n);return Cc({type:2,toast:r}),r.id},Xs=(e,t)=>Uh("blank")(e,t);Xs.error=Uh("error");Xs.success=Uh("success");Xs.loading=Uh("loading");Xs.custom=Uh("custom");Xs.dismiss=e=>{Cc({type:3,toastId:e})};Xs.remove=e=>Cc({type:4,toastId:e});Xs.promise=(e,t,n)=>{let r=Xs.loading(t.loading,{...n,...n==null?void 0:n.loading});return typeof e=="function"&&(e=e()),e.then(s=>{let i=t.success?Qp(t.success,s):void 0;return i?Xs.success(i,{id:r,...n,...n==null?void 0:n.success}):Xs.dismiss(r),s}).catch(s=>{let i=t.error?Qp(t.error,s):void 0;i?Xs.error(i,{id:r,...n,...n==null?void 0:n.error}):Xs.dismiss(r)}),e};var Tq=(e,t)=>{Cc({type:1,toast:{id:e,height:t}})},Lq=()=>{Cc({type:5,time:Date.now()})},Qf=new Map,Mq=1e3,Rq=(e,t=Mq)=>{if(Qf.has(e))return;let n=setTimeout(()=>{Qf.delete(e),Cc({type:4,toastId:e})},t);Qf.set(e,n)},$q=e=>{let{toasts:t,pausedAt:n}=Pq(e);J.useEffect(()=>{if(n)return;let i=Date.now(),l=t.map(a=>{if(a.duration===1/0)return;let c=(a.duration||0)+a.pauseDuration-(i-a.createdAt);if(c<0){a.visible&&Xs.dismiss(a.id);return}return setTimeout(()=>Xs.dismiss(a.id),c)});return()=>{l.forEach(a=>a&&clearTimeout(a))}},[t,n]);let r=J.useCallback(()=>{n&&Cc({type:6,time:Date.now()})},[n]),s=J.useCallback((i,l)=>{let{reverseOrder:a=!1,gutter:c=8,defaultPosition:d}=l||{},u=t.filter(h=>(h.position||d)===(i.position||d)&&h.height),f=u.findIndex(h=>h.id===i.id),m=u.filter((h,g)=>g<f&&h.visible).length;return u.filter(h=>h.visible).slice(...a?[m+1]:[0,m]).reduce((h,g)=>h+(g.height||0)+c,0)},[t]);return J.useEffect(()=>{t.forEach(i=>{if(i.dismissed)Rq(i.id,i.removeDelay);else{let l=Qf.get(i.id);l&&(clearTimeout(l),Qf.delete(i.id))}})},[t]),{toasts:t,handlers:{updateHeight:Tq,startPause:Lq,endPause:r,calculateOffset:s}}},Oq=wo`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,Fq=wo`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Dq=wo`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,qq=Nl("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Oq} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${Fq} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${Dq} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,Bq=wo`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,zq=Nl("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${Bq} 1s linear infinite;
`,Uq=wo`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,Hq=wo`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,Vq=Nl("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${Uq} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${Hq} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,Wq=Nl("div")`
  position: absolute;
`,Gq=Nl("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,Yq=wo`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,Xq=Nl("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${Yq} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,Kq=({toast:e})=>{let{icon:t,type:n,iconTheme:r}=e;return t!==void 0?typeof t=="string"?J.createElement(Xq,null,t):t:n==="blank"?null:J.createElement(Gq,null,J.createElement(zq,{...r}),n!=="loading"&&J.createElement(Wq,null,n==="error"?J.createElement(qq,{...r}):J.createElement(Vq,{...r})))},Jq=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,Zq=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,Qq="0%{opacity:0;} 100%{opacity:1;}",eB="0%{opacity:1;} 100%{opacity:0;}",tB=Nl("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,nB=Nl("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,rB=(e,t)=>{let n=e.includes("top")?1:-1,[r,s]=DP()?[Qq,eB]:[Jq(n),Zq(n)];return{animation:t?`${wo(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${wo(s)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},sB=J.memo(({toast:e,position:t,style:n,children:r})=>{let s=e.height?rB(e.position||t||"top-center",e.visible):{opacity:0},i=J.createElement(Kq,{toast:e}),l=J.createElement(nB,{...e.ariaProps},Qp(e.message,e));return J.createElement(tB,{className:e.className,style:{...s,...n,...e.style}},typeof r=="function"?r({icon:i,message:l}):J.createElement(J.Fragment,null,i,l))});Sq(J.createElement);var iB=({id:e,className:t,style:n,onHeightUpdate:r,children:s})=>{let i=J.useCallback(l=>{if(l){let a=()=>{let c=l.getBoundingClientRect().height;r(e,c)};a(),new MutationObserver(a).observe(l,{subtree:!0,childList:!0,characterData:!0})}},[e,r]);return J.createElement("div",{ref:i,className:t,style:n},s)},aB=(e,t)=>{let n=e.includes("top"),r=n?{top:0}:{bottom:0},s=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:DP()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(n?1:-1)}px)`,...r,...s}},oB=s0`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Dm=16,lB=({reverseOrder:e,position:t="top-center",toastOptions:n,gutter:r,children:s,containerStyle:i,containerClassName:l})=>{let{toasts:a,handlers:c}=$q(n);return J.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:Dm,left:Dm,right:Dm,bottom:Dm,pointerEvents:"none",...i},className:l,onMouseEnter:c.startPause,onMouseLeave:c.endPause},a.map(d=>{let u=d.position||t,f=c.calculateOffset(d,{reverseOrder:e,gutter:r,defaultPosition:t}),m=aB(u,f);return J.createElement(iB,{id:d.id,key:d.id,onHeightUpdate:c.updateHeight,className:d.visible?oB:"",style:m},d.type==="custom"?Qp(d.message,d):s?s(d):J.createElement(sB,{toast:d,position:u}))}))};const cB={},c_=e=>{let t;const n=new Set,r=(u,f)=>{const m=typeof u=="function"?u(t):u;if(!Object.is(m,t)){const h=t;t=f??(typeof m!="object"||m===null)?m:Object.assign({},t,m),n.forEach(g=>g(t,h))}},s=()=>t,c={setState:r,getState:s,getInitialState:()=>d,subscribe:u=>(n.add(u),()=>n.delete(u)),destroy:()=>{(cB?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},d=t=e(r,s,c);return c},BP=e=>e?c_(e):c_;var zP={exports:{}},UP={},HP={exports:{}},VP={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vu=J;function uB(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var dB=typeof Object.is=="function"?Object.is:uB,fB=Vu.useState,hB=Vu.useEffect,mB=Vu.useLayoutEffect,pB=Vu.useDebugValue;function gB(e,t){var n=t(),r=fB({inst:{value:n,getSnapshot:t}}),s=r[0].inst,i=r[1];return mB(function(){s.value=n,s.getSnapshot=t,X1(s)&&i({inst:s})},[e,n,t]),hB(function(){return X1(s)&&i({inst:s}),e(function(){X1(s)&&i({inst:s})})},[e]),pB(n),n}function X1(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!dB(e,n)}catch{return!0}}function xB(e,t){return t()}var yB=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?xB:gB;VP.useSyncExternalStore=Vu.useSyncExternalStore!==void 0?Vu.useSyncExternalStore:yB;HP.exports=VP;var vB=HP.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var i0=J,bB=vB;function wB(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var NB=typeof Object.is=="function"?Object.is:wB,jB=bB.useSyncExternalStore,_B=i0.useRef,SB=i0.useEffect,AB=i0.useMemo,kB=i0.useDebugValue;UP.useSyncExternalStoreWithSelector=function(e,t,n,r,s){var i=_B(null);if(i.current===null){var l={hasValue:!1,value:null};i.current=l}else l=i.current;i=AB(function(){function c(h){if(!d){if(d=!0,u=h,h=r(h),s!==void 0&&l.hasValue){var g=l.value;if(s(g,h))return f=g}return f=h}if(g=f,NB(u,h))return g;var y=r(h);return s!==void 0&&s(g,y)?(u=h,g):(u=h,f=y)}var d=!1,u,f,m=n===void 0?null:n;return[function(){return c(t())},m===null?void 0:function(){return c(m())}]},[t,n,r,s]);var a=jB(e,i[0],i[1]);return SB(function(){l.hasValue=!0,l.value=a},[a]),kB(a),a};zP.exports=UP;var EB=zP.exports;const WP=n0(EB),GP={},{useDebugValue:CB}=be,{useSyncExternalStoreWithSelector:PB}=WP;let u_=!1;const IB=e=>e;function TB(e,t=IB,n){(GP?"production":void 0)!=="production"&&n&&!u_&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),u_=!0);const r=PB(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return CB(r),r}const LB=e=>{(GP?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?BP(e):e,n=(r,s)=>TB(t,r,s);return Object.assign(n,t),n},r3=e=>LB,Cp={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_BASE_URL:"https://qabael.premiumasp.net/api",VITE_APP_DESCRIPTION:"Family Tree Management Application",VITE_APP_NAME:"Nasabna",VITE_APP_VERSION:"1.0.0",VITE_DEFAULT_LANGUAGE:"en",VITE_DEFAULT_THEME:"auto",VITE_ENABLE_DEVTOOLS:"true",VITE_ENABLE_MOCK_API:"false",VITE_ENABLE_RTL:"true",VITE_FEATURE_COLLABORATION:"true",VITE_FEATURE_OFFLINE_MODE:"true",VITE_FEATURE_TREE_VISUALIZATION:"true",VITE_NODE_ENV:"production",VITE_STRIPE_PUBLISHABLE_KEY:"pk_test_your-stripe-publishable-key",VITE_SUBSCRIPTION_API_BASE_URL:"https://qabael.premiumasp.net/api"},v5=new Map,qm=e=>{const t=v5.get(e);return t?Object.fromEntries(Object.entries(t.stores).map(([n,r])=>[n,r.getState()])):{}},MB=(e,t,n)=>{if(e===void 0)return{type:"untracked",connection:t.connect(n)};const r=v5.get(n.name);if(r)return{type:"tracked",store:e,...r};const s={connection:t.connect(n),stores:{}};return v5.set(n.name,s),{type:"tracked",store:e,...s}},RB=(e,t={})=>(n,r,s)=>{const{enabled:i,anonymousActionType:l,store:a,...c}=t;let d;try{d=(i??(Cp?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!d)return(Cp?"production":void 0)!=="production"&&i&&console.warn("[zustand devtools middleware] Please install/enable Redux devtools extension"),e(n,r,s);const{connection:u,...f}=MB(a,d,c);let m=!0;s.setState=(y,p,x)=>{const b=n(y,p);if(!m)return b;const w=x===void 0?{type:l||"anonymous"}:typeof x=="string"?{type:x}:x;return a===void 0?(u==null||u.send(w,r()),b):(u==null||u.send({...w,type:`${a}/${w.type}`},{...qm(c.name),[a]:s.getState()}),b)};const h=(...y)=>{const p=m;m=!1,n(...y),m=p},g=e(s.setState,r,s);if(f.type==="untracked"?u==null||u.init(g):(f.stores[f.store]=s,u==null||u.init(Object.fromEntries(Object.entries(f.stores).map(([y,p])=>[y,y===f.store?g:p.getState()])))),s.dispatchFromDevtools&&typeof s.dispatch=="function"){let y=!1;const p=s.dispatch;s.dispatch=(...x)=>{(Cp?"production":void 0)!=="production"&&x[0].type==="__setState"&&!y&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),y=!0),p(...x)}}return u.subscribe(y=>{var p;switch(y.type){case"ACTION":if(typeof y.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return K1(y.payload,x=>{if(x.type==="__setState"){if(a===void 0){h(x.state);return}Object.keys(x.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format. 
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const b=x.state[a];if(b==null)return;JSON.stringify(s.getState())!==JSON.stringify(b)&&h(b);return}s.dispatchFromDevtools&&typeof s.dispatch=="function"&&s.dispatch(x)});case"DISPATCH":switch(y.payload.type){case"RESET":return h(g),a===void 0?u==null?void 0:u.init(s.getState()):u==null?void 0:u.init(qm(c.name));case"COMMIT":if(a===void 0){u==null||u.init(s.getState());return}return u==null?void 0:u.init(qm(c.name));case"ROLLBACK":return K1(y.state,x=>{if(a===void 0){h(x),u==null||u.init(s.getState());return}h(x[a]),u==null||u.init(qm(c.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return K1(y.state,x=>{if(a===void 0){h(x);return}JSON.stringify(s.getState())!==JSON.stringify(x[a])&&h(x[a])});case"IMPORT_STATE":{const{nextLiftedState:x}=y.payload,b=(p=x.computedStates.slice(-1)[0])==null?void 0:p.state;if(!b)return;h(a===void 0?b:b[a]),u==null||u.send(null,x);return}case"PAUSE_RECORDING":return m=!m}return}}),g},YP=RB,K1=(e,t)=>{let n;try{n=JSON.parse(e)}catch(r){console.error("[zustand devtools middleware] Could not parse the received json",r)}n!==void 0&&t(n)};function $B(e,t){let n;try{n=e()}catch{return}return{getItem:s=>{var i;const l=c=>c===null?null:JSON.parse(c,void 0),a=(i=n.getItem(s))!=null?i:null;return a instanceof Promise?a.then(l):l(a)},setItem:(s,i)=>n.setItem(s,JSON.stringify(i,void 0)),removeItem:s=>n.removeItem(s)}}const dh=e=>t=>{try{const n=e(t);return n instanceof Promise?n:{then(r){return dh(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return dh(r)(n)}}}},OB=(e,t)=>(n,r,s)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:p=>p,version:0,merge:(p,x)=>({...x,...p}),...t},l=!1;const a=new Set,c=new Set;let d;try{d=i.getStorage()}catch{}if(!d)return e((...p)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...p)},r,s);const u=dh(i.serialize),f=()=>{const p=i.partialize({...r()});let x;const b=u({state:p,version:i.version}).then(w=>d.setItem(i.name,w)).catch(w=>{x=w});if(x)throw x;return b},m=s.setState;s.setState=(p,x)=>{m(p,x),f()};const h=e((...p)=>{n(...p),f()},r,s);let g;const y=()=>{var p;if(!d)return;l=!1,a.forEach(b=>b(r()));const x=((p=i.onRehydrateStorage)==null?void 0:p.call(i,r()))||void 0;return dh(d.getItem.bind(d))(i.name).then(b=>{if(b)return i.deserialize(b)}).then(b=>{if(b)if(typeof b.version=="number"&&b.version!==i.version){if(i.migrate)return i.migrate(b.state,b.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return b.state}).then(b=>{var w;return g=i.merge(b,(w=r())!=null?w:h),n(g,!0),f()}).then(()=>{x==null||x(g,void 0),l=!0,c.forEach(b=>b(g))}).catch(b=>{x==null||x(void 0,b)})};return s.persist={setOptions:p=>{i={...i,...p},p.getStorage&&(d=p.getStorage())},clearStorage:()=>{d==null||d.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>y(),hasHydrated:()=>l,onHydrate:p=>(a.add(p),()=>{a.delete(p)}),onFinishHydration:p=>(c.add(p),()=>{c.delete(p)})},y(),g||h},FB=(e,t)=>(n,r,s)=>{let i={storage:$B(()=>localStorage),partialize:y=>y,version:0,merge:(y,p)=>({...p,...y}),...t},l=!1;const a=new Set,c=new Set;let d=i.storage;if(!d)return e((...y)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...y)},r,s);const u=()=>{const y=i.partialize({...r()});return d.setItem(i.name,{state:y,version:i.version})},f=s.setState;s.setState=(y,p)=>{f(y,p),u()};const m=e((...y)=>{n(...y),u()},r,s);s.getInitialState=()=>m;let h;const g=()=>{var y,p;if(!d)return;l=!1,a.forEach(b=>{var w;return b((w=r())!=null?w:m)});const x=((p=i.onRehydrateStorage)==null?void 0:p.call(i,(y=r())!=null?y:m))||void 0;return dh(d.getItem.bind(d))(i.name).then(b=>{if(b)if(typeof b.version=="number"&&b.version!==i.version){if(i.migrate)return[!0,i.migrate(b.state,b.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,b.state];return[!1,void 0]}).then(b=>{var w;const[N,k]=b;if(h=i.merge(k,(w=r())!=null?w:m),n(h,!0),N)return u()}).then(()=>{x==null||x(h,void 0),h=r(),l=!0,c.forEach(b=>b(h))}).catch(b=>{x==null||x(void 0,b)})};return s.persist={setOptions:y=>{i={...i,...y},y.storage&&(d=y.storage)},clearStorage:()=>{d==null||d.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>g(),hasHydrated:()=>l,onHydrate:y=>(a.add(y),()=>{a.delete(y)}),onFinishHydration:y=>(c.add(y),()=>{c.delete(y)})},i.skipHydration||g(),h||m},DB=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?((Cp?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),OB(e,t)):FB(e,t),s3=DB;function XP(e,t){return function(){return e.apply(t,arguments)}}const{toString:qB}=Object.prototype,{getPrototypeOf:i3}=Object,{iterator:a0,toStringTag:KP}=Symbol,o0=(e=>t=>{const n=qB.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),la=e=>(e=e.toLowerCase(),t=>o0(t)===e),l0=e=>t=>typeof t===e,{isArray:gd}=Array,fh=l0("undefined");function Hh(e){return e!==null&&!fh(e)&&e.constructor!==null&&!fh(e.constructor)&&Js(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const JP=la("ArrayBuffer");function BB(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&JP(e.buffer),t}const zB=l0("string"),Js=l0("function"),ZP=l0("number"),Vh=e=>e!==null&&typeof e=="object",UB=e=>e===!0||e===!1,Pp=e=>{if(o0(e)!=="object")return!1;const t=i3(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(KP in e)&&!(a0 in e)},HB=e=>{if(!Vh(e)||Hh(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},VB=la("Date"),WB=la("File"),GB=la("Blob"),YB=la("FileList"),XB=e=>Vh(e)&&Js(e.pipe),KB=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||Js(e.append)&&((t=o0(e))==="formdata"||t==="object"&&Js(e.toString)&&e.toString()==="[object FormData]"))},JB=la("URLSearchParams"),[ZB,QB,ez,tz]=["ReadableStream","Request","Response","Headers"].map(la),nz=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Wh(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let r,s;if(typeof e!="object"&&(e=[e]),gd(e))for(r=0,s=e.length;r<s;r++)t.call(null,e[r],r,e);else{if(Hh(e))return;const i=n?Object.getOwnPropertyNames(e):Object.keys(e),l=i.length;let a;for(r=0;r<l;r++)a=i[r],t.call(null,e[a],a,e)}}function QP(e,t){if(Hh(e))return null;t=t.toLowerCase();const n=Object.keys(e);let r=n.length,s;for(;r-- >0;)if(s=n[r],t===s.toLowerCase())return s;return null}const oc=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,eI=e=>!fh(e)&&e!==oc;function b5(){const{caseless:e}=eI(this)&&this||{},t={},n=(r,s)=>{const i=e&&QP(t,s)||s;Pp(t[i])&&Pp(r)?t[i]=b5(t[i],r):Pp(r)?t[i]=b5({},r):gd(r)?t[i]=r.slice():t[i]=r};for(let r=0,s=arguments.length;r<s;r++)arguments[r]&&Wh(arguments[r],n);return t}const rz=(e,t,n,{allOwnKeys:r}={})=>(Wh(t,(s,i)=>{n&&Js(s)?e[i]=XP(s,n):e[i]=s},{allOwnKeys:r}),e),sz=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),iz=(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},az=(e,t,n,r)=>{let s,i,l;const a={};if(t=t||{},e==null)return t;do{for(s=Object.getOwnPropertyNames(e),i=s.length;i-- >0;)l=s[i],(!r||r(l,e,t))&&!a[l]&&(t[l]=e[l],a[l]=!0);e=n!==!1&&i3(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},oz=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return r!==-1&&r===n},lz=e=>{if(!e)return null;if(gd(e))return e;let t=e.length;if(!ZP(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},cz=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&i3(Uint8Array)),uz=(e,t)=>{const r=(e&&e[a0]).call(e);let s;for(;(s=r.next())&&!s.done;){const i=s.value;t.call(e,i[0],i[1])}},dz=(e,t)=>{let n;const r=[];for(;(n=e.exec(t))!==null;)r.push(n);return r},fz=la("HTMLFormElement"),hz=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,s){return r.toUpperCase()+s}),d_=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),mz=la("RegExp"),tI=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};Wh(n,(s,i)=>{let l;(l=t(s,i,e))!==!1&&(r[i]=l||s)}),Object.defineProperties(e,r)},pz=e=>{tI(e,(t,n)=>{if(Js(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=e[n];if(Js(r)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},gz=(e,t)=>{const n={},r=s=>{s.forEach(i=>{n[i]=!0})};return gd(e)?r(e):r(String(e).split(t)),n},xz=()=>{},yz=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function vz(e){return!!(e&&Js(e.append)&&e[KP]==="FormData"&&e[a0])}const bz=e=>{const t=new Array(10),n=(r,s)=>{if(Vh(r)){if(t.indexOf(r)>=0)return;if(Hh(r))return r;if(!("toJSON"in r)){t[s]=r;const i=gd(r)?[]:{};return Wh(r,(l,a)=>{const c=n(l,s+1);!fh(c)&&(i[a]=c)}),t[s]=void 0,i}}return r};return n(e,0)},wz=la("AsyncFunction"),Nz=e=>e&&(Vh(e)||Js(e))&&Js(e.then)&&Js(e.catch),nI=((e,t)=>e?setImmediate:t?((n,r)=>(oc.addEventListener("message",({source:s,data:i})=>{s===oc&&i===n&&r.length&&r.shift()()},!1),s=>{r.push(s),oc.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",Js(oc.postMessage)),jz=typeof queueMicrotask<"u"?queueMicrotask.bind(oc):typeof process<"u"&&process.nextTick||nI,_z=e=>e!=null&&Js(e[a0]),He={isArray:gd,isArrayBuffer:JP,isBuffer:Hh,isFormData:KB,isArrayBufferView:BB,isString:zB,isNumber:ZP,isBoolean:UB,isObject:Vh,isPlainObject:Pp,isEmptyObject:HB,isReadableStream:ZB,isRequest:QB,isResponse:ez,isHeaders:tz,isUndefined:fh,isDate:VB,isFile:WB,isBlob:GB,isRegExp:mz,isFunction:Js,isStream:XB,isURLSearchParams:JB,isTypedArray:cz,isFileList:YB,forEach:Wh,merge:b5,extend:rz,trim:nz,stripBOM:sz,inherits:iz,toFlatObject:az,kindOf:o0,kindOfTest:la,endsWith:oz,toArray:lz,forEachEntry:uz,matchAll:dz,isHTMLForm:fz,hasOwnProperty:d_,hasOwnProp:d_,reduceDescriptors:tI,freezeMethods:pz,toObjectSet:gz,toCamelCase:hz,noop:xz,toFiniteNumber:yz,findKey:QP,global:oc,isContextDefined:eI,isSpecCompliantForm:vz,toJSONObject:bz,isAsyncFn:wz,isThenable:Nz,setImmediate:nI,asap:jz,isIterable:_z};function mn(e,t,n,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),s&&(this.response=s,this.status=s.status?s.status:null)}He.inherits(mn,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:He.toJSONObject(this.config),code:this.code,status:this.status}}});const rI=mn.prototype,sI={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{sI[e]={value:e}});Object.defineProperties(mn,sI);Object.defineProperty(rI,"isAxiosError",{value:!0});mn.from=(e,t,n,r,s,i)=>{const l=Object.create(rI);return He.toFlatObject(e,l,function(c){return c!==Error.prototype},a=>a!=="isAxiosError"),mn.call(l,e.message,t,n,r,s),l.cause=e,l.name=e.name,i&&Object.assign(l,i),l};const Sz=null;function w5(e){return He.isPlainObject(e)||He.isArray(e)}function iI(e){return He.endsWith(e,"[]")?e.slice(0,-2):e}function f_(e,t,n){return e?e.concat(t).map(function(s,i){return s=iI(s),!n&&i?"["+s+"]":s}).join(n?".":""):t}function Az(e){return He.isArray(e)&&!e.some(w5)}const kz=He.toFlatObject(He,{},null,function(t){return/^is[A-Z]/.test(t)});function c0(e,t,n){if(!He.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=He.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(y,p){return!He.isUndefined(p[y])});const r=n.metaTokens,s=n.visitor||u,i=n.dots,l=n.indexes,c=(n.Blob||typeof Blob<"u"&&Blob)&&He.isSpecCompliantForm(t);if(!He.isFunction(s))throw new TypeError("visitor must be a function");function d(g){if(g===null)return"";if(He.isDate(g))return g.toISOString();if(He.isBoolean(g))return g.toString();if(!c&&He.isBlob(g))throw new mn("Blob is not supported. Use a Buffer instead.");return He.isArrayBuffer(g)||He.isTypedArray(g)?c&&typeof Blob=="function"?new Blob([g]):Buffer.from(g):g}function u(g,y,p){let x=g;if(g&&!p&&typeof g=="object"){if(He.endsWith(y,"{}"))y=r?y:y.slice(0,-2),g=JSON.stringify(g);else if(He.isArray(g)&&Az(g)||(He.isFileList(g)||He.endsWith(y,"[]"))&&(x=He.toArray(g)))return y=iI(y),x.forEach(function(w,N){!(He.isUndefined(w)||w===null)&&t.append(l===!0?f_([y],N,i):l===null?y:y+"[]",d(w))}),!1}return w5(g)?!0:(t.append(f_(p,y,i),d(g)),!1)}const f=[],m=Object.assign(kz,{defaultVisitor:u,convertValue:d,isVisitable:w5});function h(g,y){if(!He.isUndefined(g)){if(f.indexOf(g)!==-1)throw Error("Circular reference detected in "+y.join("."));f.push(g),He.forEach(g,function(x,b){(!(He.isUndefined(x)||x===null)&&s.call(t,x,He.isString(b)?b.trim():b,y,m))===!0&&h(x,y?y.concat(b):[b])}),f.pop()}}if(!He.isObject(e))throw new TypeError("data must be an object");return h(e),t}function h_(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return t[r]})}function a3(e,t){this._pairs=[],e&&c0(e,this,t)}const aI=a3.prototype;aI.append=function(t,n){this._pairs.push([t,n])};aI.toString=function(t){const n=t?function(r){return t.call(this,r,h_)}:h_;return this._pairs.map(function(s){return n(s[0])+"="+n(s[1])},"").join("&")};function Ez(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function oI(e,t,n){if(!t)return e;const r=n&&n.encode||Ez;He.isFunction(n)&&(n={serialize:n});const s=n&&n.serialize;let i;if(s?i=s(t,n):i=He.isURLSearchParams(t)?t.toString():new a3(t,n).toString(r),i){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class m_{constructor(){this.handlers=[]}use(t,n,r){return this.handlers.push({fulfilled:t,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){He.forEach(this.handlers,function(r){r!==null&&t(r)})}}const lI={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},Cz=typeof URLSearchParams<"u"?URLSearchParams:a3,Pz=typeof FormData<"u"?FormData:null,Iz=typeof Blob<"u"?Blob:null,Tz={isBrowser:!0,classes:{URLSearchParams:Cz,FormData:Pz,Blob:Iz},protocols:["http","https","file","blob","url","data"]},o3=typeof window<"u"&&typeof document<"u",N5=typeof navigator=="object"&&navigator||void 0,Lz=o3&&(!N5||["ReactNative","NativeScript","NS"].indexOf(N5.product)<0),Mz=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",Rz=o3&&window.location.href||"http://localhost",$z=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:o3,hasStandardBrowserEnv:Lz,hasStandardBrowserWebWorkerEnv:Mz,navigator:N5,origin:Rz},Symbol.toStringTag,{value:"Module"})),ks={...$z,...Tz};function Oz(e,t){return c0(e,new ks.classes.URLSearchParams,{visitor:function(n,r,s,i){return ks.isNode&&He.isBuffer(n)?(this.append(r,n.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function Fz(e){return He.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function Dz(e){const t={},n=Object.keys(e);let r;const s=n.length;let i;for(r=0;r<s;r++)i=n[r],t[i]=e[i];return t}function cI(e){function t(n,r,s,i){let l=n[i++];if(l==="__proto__")return!0;const a=Number.isFinite(+l),c=i>=n.length;return l=!l&&He.isArray(s)?s.length:l,c?(He.hasOwnProp(s,l)?s[l]=[s[l],r]:s[l]=r,!a):((!s[l]||!He.isObject(s[l]))&&(s[l]=[]),t(n,r,s[l],i)&&He.isArray(s[l])&&(s[l]=Dz(s[l])),!a)}if(He.isFormData(e)&&He.isFunction(e.entries)){const n={};return He.forEachEntry(e,(r,s)=>{t(Fz(r),s,n,0)}),n}return null}function qz(e,t,n){if(He.isString(e))try{return(t||JSON.parse)(e),He.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(e)}const Gh={transitional:lI,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const r=n.getContentType()||"",s=r.indexOf("application/json")>-1,i=He.isObject(t);if(i&&He.isHTMLForm(t)&&(t=new FormData(t)),He.isFormData(t))return s?JSON.stringify(cI(t)):t;if(He.isArrayBuffer(t)||He.isBuffer(t)||He.isStream(t)||He.isFile(t)||He.isBlob(t)||He.isReadableStream(t))return t;if(He.isArrayBufferView(t))return t.buffer;if(He.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let a;if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return Oz(t,this.formSerializer).toString();if((a=He.isFileList(t))||r.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return c0(a?{"files[]":t}:t,c&&new c,this.formSerializer)}}return i||s?(n.setContentType("application/json",!1),qz(t)):t}],transformResponse:[function(t){const n=this.transitional||Gh.transitional,r=n&&n.forcedJSONParsing,s=this.responseType==="json";if(He.isResponse(t)||He.isReadableStream(t))return t;if(t&&He.isString(t)&&(r&&!this.responseType||s)){const l=!(n&&n.silentJSONParsing)&&s;try{return JSON.parse(t)}catch(a){if(l)throw a.name==="SyntaxError"?mn.from(a,mn.ERR_BAD_RESPONSE,this,null,this.response):a}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:ks.classes.FormData,Blob:ks.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};He.forEach(["delete","get","head","post","put","patch"],e=>{Gh.headers[e]={}});const Bz=He.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),zz=e=>{const t={};let n,r,s;return e&&e.split(`
`).forEach(function(l){s=l.indexOf(":"),n=l.substring(0,s).trim().toLowerCase(),r=l.substring(s+1).trim(),!(!n||t[n]&&Bz[n])&&(n==="set-cookie"?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t},p_=Symbol("internals");function nf(e){return e&&String(e).trim().toLowerCase()}function Ip(e){return e===!1||e==null?e:He.isArray(e)?e.map(Ip):String(e)}function Uz(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}const Hz=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function J1(e,t,n,r,s){if(He.isFunction(r))return r.call(this,t,n);if(s&&(t=n),!!He.isString(t)){if(He.isString(r))return t.indexOf(r)!==-1;if(He.isRegExp(r))return r.test(t)}}function Vz(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,r)=>n.toUpperCase()+r)}function Wz(e,t){const n=He.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(s,i,l){return this[r].call(this,t,s,i,l)},configurable:!0})})}let Zs=class{constructor(t){t&&this.set(t)}set(t,n,r){const s=this;function i(a,c,d){const u=nf(c);if(!u)throw new Error("header name must be a non-empty string");const f=He.findKey(s,u);(!f||s[f]===void 0||d===!0||d===void 0&&s[f]!==!1)&&(s[f||c]=Ip(a))}const l=(a,c)=>He.forEach(a,(d,u)=>i(d,u,c));if(He.isPlainObject(t)||t instanceof this.constructor)l(t,n);else if(He.isString(t)&&(t=t.trim())&&!Hz(t))l(zz(t),n);else if(He.isObject(t)&&He.isIterable(t)){let a={},c,d;for(const u of t){if(!He.isArray(u))throw TypeError("Object iterator must return a key-value pair");a[d=u[0]]=(c=a[d])?He.isArray(c)?[...c,u[1]]:[c,u[1]]:u[1]}l(a,n)}else t!=null&&i(n,t,r);return this}get(t,n){if(t=nf(t),t){const r=He.findKey(this,t);if(r){const s=this[r];if(!n)return s;if(n===!0)return Uz(s);if(He.isFunction(n))return n.call(this,s,r);if(He.isRegExp(n))return n.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=nf(t),t){const r=He.findKey(this,t);return!!(r&&this[r]!==void 0&&(!n||J1(this,this[r],r,n)))}return!1}delete(t,n){const r=this;let s=!1;function i(l){if(l=nf(l),l){const a=He.findKey(r,l);a&&(!n||J1(r,r[a],a,n))&&(delete r[a],s=!0)}}return He.isArray(t)?t.forEach(i):i(t),s}clear(t){const n=Object.keys(this);let r=n.length,s=!1;for(;r--;){const i=n[r];(!t||J1(this,this[i],i,t,!0))&&(delete this[i],s=!0)}return s}normalize(t){const n=this,r={};return He.forEach(this,(s,i)=>{const l=He.findKey(r,i);if(l){n[l]=Ip(s),delete n[i];return}const a=t?Vz(i):String(i).trim();a!==i&&delete n[i],n[a]=Ip(s),r[a]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return He.forEach(this,(r,s)=>{r!=null&&r!==!1&&(n[s]=t&&He.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const r=new this(t);return n.forEach(s=>r.set(s)),r}static accessor(t){const r=(this[p_]=this[p_]={accessors:{}}).accessors,s=this.prototype;function i(l){const a=nf(l);r[a]||(Wz(s,l),r[a]=!0)}return He.isArray(t)?t.forEach(i):i(t),this}};Zs.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);He.reduceDescriptors(Zs.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(r){this[n]=r}}});He.freezeMethods(Zs);function Z1(e,t){const n=this||Gh,r=t||n,s=Zs.from(r.headers);let i=r.data;return He.forEach(e,function(a){i=a.call(n,i,s.normalize(),t?t.status:void 0)}),s.normalize(),i}function uI(e){return!!(e&&e.__CANCEL__)}function xd(e,t,n){mn.call(this,e??"canceled",mn.ERR_CANCELED,t,n),this.name="CanceledError"}He.inherits(xd,mn,{__CANCEL__:!0});function dI(e,t,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?e(n):t(new mn("Request failed with status code "+n.status,[mn.ERR_BAD_REQUEST,mn.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function Gz(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function Yz(e,t){e=e||10;const n=new Array(e),r=new Array(e);let s=0,i=0,l;return t=t!==void 0?t:1e3,function(c){const d=Date.now(),u=r[i];l||(l=d),n[s]=c,r[s]=d;let f=i,m=0;for(;f!==s;)m+=n[f++],f=f%e;if(s=(s+1)%e,s===i&&(i=(i+1)%e),d-l<t)return;const h=u&&d-u;return h?Math.round(m*1e3/h):void 0}}function Xz(e,t){let n=0,r=1e3/t,s,i;const l=(d,u=Date.now())=>{n=u,s=null,i&&(clearTimeout(i),i=null),e(...d)};return[(...d)=>{const u=Date.now(),f=u-n;f>=r?l(d,u):(s=d,i||(i=setTimeout(()=>{i=null,l(s)},r-f)))},()=>s&&l(s)]}const eg=(e,t,n=3)=>{let r=0;const s=Yz(50,250);return Xz(i=>{const l=i.loaded,a=i.lengthComputable?i.total:void 0,c=l-r,d=s(c),u=l<=a;r=l;const f={loaded:l,total:a,progress:a?l/a:void 0,bytes:c,rate:d||void 0,estimated:d&&a&&u?(a-l)/d:void 0,event:i,lengthComputable:a!=null,[t?"download":"upload"]:!0};e(f)},n)},g_=(e,t)=>{const n=e!=null;return[r=>t[0]({lengthComputable:n,total:e,loaded:r}),t[1]]},x_=e=>(...t)=>He.asap(()=>e(...t)),Kz=ks.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,ks.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(ks.origin),ks.navigator&&/(msie|trident)/i.test(ks.navigator.userAgent)):()=>!0,Jz=ks.hasStandardBrowserEnv?{write(e,t,n,r,s,i){const l=[e+"="+encodeURIComponent(t)];He.isNumber(n)&&l.push("expires="+new Date(n).toGMTString()),He.isString(r)&&l.push("path="+r),He.isString(s)&&l.push("domain="+s),i===!0&&l.push("secure"),document.cookie=l.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function Zz(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function Qz(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function fI(e,t,n){let r=!Zz(t);return e&&(r||n==!1)?Qz(e,t):t}const y_=e=>e instanceof Zs?{...e}:e;function xc(e,t){t=t||{};const n={};function r(d,u,f,m){return He.isPlainObject(d)&&He.isPlainObject(u)?He.merge.call({caseless:m},d,u):He.isPlainObject(u)?He.merge({},u):He.isArray(u)?u.slice():u}function s(d,u,f,m){if(He.isUndefined(u)){if(!He.isUndefined(d))return r(void 0,d,f,m)}else return r(d,u,f,m)}function i(d,u){if(!He.isUndefined(u))return r(void 0,u)}function l(d,u){if(He.isUndefined(u)){if(!He.isUndefined(d))return r(void 0,d)}else return r(void 0,u)}function a(d,u,f){if(f in t)return r(d,u);if(f in e)return r(void 0,d)}const c={url:i,method:i,data:i,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:a,headers:(d,u,f)=>s(y_(d),y_(u),f,!0)};return He.forEach(Object.keys({...e,...t}),function(u){const f=c[u]||s,m=f(e[u],t[u],u);He.isUndefined(m)&&f!==a||(n[u]=m)}),n}const hI=e=>{const t=xc({},e);let{data:n,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:i,headers:l,auth:a}=t;t.headers=l=Zs.from(l),t.url=oI(fI(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),a&&l.set("Authorization","Basic "+btoa((a.username||"")+":"+(a.password?unescape(encodeURIComponent(a.password)):"")));let c;if(He.isFormData(n)){if(ks.hasStandardBrowserEnv||ks.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if((c=l.getContentType())!==!1){const[d,...u]=c?c.split(";").map(f=>f.trim()).filter(Boolean):[];l.setContentType([d||"multipart/form-data",...u].join("; "))}}if(ks.hasStandardBrowserEnv&&(r&&He.isFunction(r)&&(r=r(t)),r||r!==!1&&Kz(t.url))){const d=s&&i&&Jz.read(i);d&&l.set(s,d)}return t},eU=typeof XMLHttpRequest<"u",tU=eU&&function(e){return new Promise(function(n,r){const s=hI(e);let i=s.data;const l=Zs.from(s.headers).normalize();let{responseType:a,onUploadProgress:c,onDownloadProgress:d}=s,u,f,m,h,g;function y(){h&&h(),g&&g(),s.cancelToken&&s.cancelToken.unsubscribe(u),s.signal&&s.signal.removeEventListener("abort",u)}let p=new XMLHttpRequest;p.open(s.method.toUpperCase(),s.url,!0),p.timeout=s.timeout;function x(){if(!p)return;const w=Zs.from("getAllResponseHeaders"in p&&p.getAllResponseHeaders()),k={data:!a||a==="text"||a==="json"?p.responseText:p.response,status:p.status,statusText:p.statusText,headers:w,config:e,request:p};dI(function(R){n(R),y()},function(R){r(R),y()},k),p=null}"onloadend"in p?p.onloadend=x:p.onreadystatechange=function(){!p||p.readyState!==4||p.status===0&&!(p.responseURL&&p.responseURL.indexOf("file:")===0)||setTimeout(x)},p.onabort=function(){p&&(r(new mn("Request aborted",mn.ECONNABORTED,e,p)),p=null)},p.onerror=function(){r(new mn("Network Error",mn.ERR_NETWORK,e,p)),p=null},p.ontimeout=function(){let N=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const k=s.transitional||lI;s.timeoutErrorMessage&&(N=s.timeoutErrorMessage),r(new mn(N,k.clarifyTimeoutError?mn.ETIMEDOUT:mn.ECONNABORTED,e,p)),p=null},i===void 0&&l.setContentType(null),"setRequestHeader"in p&&He.forEach(l.toJSON(),function(N,k){p.setRequestHeader(k,N)}),He.isUndefined(s.withCredentials)||(p.withCredentials=!!s.withCredentials),a&&a!=="json"&&(p.responseType=s.responseType),d&&([m,g]=eg(d,!0),p.addEventListener("progress",m)),c&&p.upload&&([f,h]=eg(c),p.upload.addEventListener("progress",f),p.upload.addEventListener("loadend",h)),(s.cancelToken||s.signal)&&(u=w=>{p&&(r(!w||w.type?new xd(null,e,p):w),p.abort(),p=null)},s.cancelToken&&s.cancelToken.subscribe(u),s.signal&&(s.signal.aborted?u():s.signal.addEventListener("abort",u)));const b=Gz(s.url);if(b&&ks.protocols.indexOf(b)===-1){r(new mn("Unsupported protocol "+b+":",mn.ERR_BAD_REQUEST,e));return}p.send(i||null)})},nU=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let r=new AbortController,s;const i=function(d){if(!s){s=!0,a();const u=d instanceof Error?d:this.reason;r.abort(u instanceof mn?u:new xd(u instanceof Error?u.message:u))}};let l=t&&setTimeout(()=>{l=null,i(new mn(`timeout ${t} of ms exceeded`,mn.ETIMEDOUT))},t);const a=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(d=>{d.unsubscribe?d.unsubscribe(i):d.removeEventListener("abort",i)}),e=null)};e.forEach(d=>d.addEventListener("abort",i));const{signal:c}=r;return c.unsubscribe=()=>He.asap(a),c}},rU=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let r=0,s;for(;r<n;)s=r+t,yield e.slice(r,s),r=s},sU=async function*(e,t){for await(const n of iU(e))yield*rU(n,t)},iU=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:r}=await t.read();if(n)break;yield r}}finally{await t.cancel()}},v_=(e,t,n,r)=>{const s=sU(e,t);let i=0,l,a=c=>{l||(l=!0,r&&r(c))};return new ReadableStream({async pull(c){try{const{done:d,value:u}=await s.next();if(d){a(),c.close();return}let f=u.byteLength;if(n){let m=i+=f;n(m)}c.enqueue(new Uint8Array(u))}catch(d){throw a(d),d}},cancel(c){return a(c),s.return()}},{highWaterMark:2})},u0=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",mI=u0&&typeof ReadableStream=="function",aU=u0&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),pI=(e,...t)=>{try{return!!e(...t)}catch{return!1}},oU=mI&&pI(()=>{let e=!1;const t=new Request(ks.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),b_=64*1024,j5=mI&&pI(()=>He.isReadableStream(new Response("").body)),tg={stream:j5&&(e=>e.body)};u0&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!tg[t]&&(tg[t]=He.isFunction(e[t])?n=>n[t]():(n,r)=>{throw new mn(`Response type '${t}' is not supported`,mn.ERR_NOT_SUPPORT,r)})})})(new Response);const lU=async e=>{if(e==null)return 0;if(He.isBlob(e))return e.size;if(He.isSpecCompliantForm(e))return(await new Request(ks.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(He.isArrayBufferView(e)||He.isArrayBuffer(e))return e.byteLength;if(He.isURLSearchParams(e)&&(e=e+""),He.isString(e))return(await aU(e)).byteLength},cU=async(e,t)=>{const n=He.toFiniteNumber(e.getContentLength());return n??lU(t)},uU=u0&&(async e=>{let{url:t,method:n,data:r,signal:s,cancelToken:i,timeout:l,onDownloadProgress:a,onUploadProgress:c,responseType:d,headers:u,withCredentials:f="same-origin",fetchOptions:m}=hI(e);d=d?(d+"").toLowerCase():"text";let h=nU([s,i&&i.toAbortSignal()],l),g;const y=h&&h.unsubscribe&&(()=>{h.unsubscribe()});let p;try{if(c&&oU&&n!=="get"&&n!=="head"&&(p=await cU(u,r))!==0){let k=new Request(t,{method:"POST",body:r,duplex:"half"}),I;if(He.isFormData(r)&&(I=k.headers.get("content-type"))&&u.setContentType(I),k.body){const[R,T]=g_(p,eg(x_(c)));r=v_(k.body,b_,R,T)}}He.isString(f)||(f=f?"include":"omit");const x="credentials"in Request.prototype;g=new Request(t,{...m,signal:h,method:n.toUpperCase(),headers:u.normalize().toJSON(),body:r,duplex:"half",credentials:x?f:void 0});let b=await fetch(g,m);const w=j5&&(d==="stream"||d==="response");if(j5&&(a||w&&y)){const k={};["status","statusText","headers"].forEach(S=>{k[S]=b[S]});const I=He.toFiniteNumber(b.headers.get("content-length")),[R,T]=a&&g_(I,eg(x_(a),!0))||[];b=new Response(v_(b.body,b_,R,()=>{T&&T(),y&&y()}),k)}d=d||"text";let N=await tg[He.findKey(tg,d)||"text"](b,e);return!w&&y&&y(),await new Promise((k,I)=>{dI(k,I,{data:N,headers:Zs.from(b.headers),status:b.status,statusText:b.statusText,config:e,request:g})})}catch(x){throw y&&y(),x&&x.name==="TypeError"&&/Load failed|fetch/i.test(x.message)?Object.assign(new mn("Network Error",mn.ERR_NETWORK,e,g),{cause:x.cause||x}):mn.from(x,x&&x.code,e,g)}}),_5={http:Sz,xhr:tU,fetch:uU};He.forEach(_5,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const w_=e=>`- ${e}`,dU=e=>He.isFunction(e)||e===null||e===!1,gI={getAdapter:e=>{e=He.isArray(e)?e:[e];const{length:t}=e;let n,r;const s={};for(let i=0;i<t;i++){n=e[i];let l;if(r=n,!dU(n)&&(r=_5[(l=String(n)).toLowerCase()],r===void 0))throw new mn(`Unknown adapter '${l}'`);if(r)break;s[l||"#"+i]=r}if(!r){const i=Object.entries(s).map(([a,c])=>`adapter ${a} `+(c===!1?"is not supported by the environment":"is not available in the build"));let l=t?i.length>1?`since :
`+i.map(w_).join(`
`):" "+w_(i[0]):"as no adapter specified";throw new mn("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return r},adapters:_5};function Q1(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new xd(null,e)}function N_(e){return Q1(e),e.headers=Zs.from(e.headers),e.data=Z1.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),gI.getAdapter(e.adapter||Gh.adapter)(e).then(function(r){return Q1(e),r.data=Z1.call(e,e.transformResponse,r),r.headers=Zs.from(r.headers),r},function(r){return uI(r)||(Q1(e),r&&r.response&&(r.response.data=Z1.call(e,e.transformResponse,r.response),r.response.headers=Zs.from(r.response.headers))),Promise.reject(r)})}const xI="1.11.0",d0={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{d0[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});const j_={};d0.transitional=function(t,n,r){function s(i,l){return"[Axios v"+xI+"] Transitional option '"+i+"'"+l+(r?". "+r:"")}return(i,l,a)=>{if(t===!1)throw new mn(s(l," has been removed"+(n?" in "+n:"")),mn.ERR_DEPRECATED);return n&&!j_[l]&&(j_[l]=!0,console.warn(s(l," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(i,l,a):!0}};d0.spelling=function(t){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${t}`),!0)};function fU(e,t,n){if(typeof e!="object")throw new mn("options must be an object",mn.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let s=r.length;for(;s-- >0;){const i=r[s],l=t[i];if(l){const a=e[i],c=a===void 0||l(a,i,e);if(c!==!0)throw new mn("option "+i+" must be "+c,mn.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new mn("Unknown option "+i,mn.ERR_BAD_OPTION)}}const Tp={assertOptions:fU,validators:d0},ba=Tp.validators;let fc=class{constructor(t){this.defaults=t||{},this.interceptors={request:new m_,response:new m_}}async request(t,n){try{return await this._request(t,n)}catch(r){if(r instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const i=s.stack?s.stack.replace(/^.+\n/,""):"";try{r.stack?i&&!String(r.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+i):r.stack=i}catch{}}throw r}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=xc(this.defaults,n);const{transitional:r,paramsSerializer:s,headers:i}=n;r!==void 0&&Tp.assertOptions(r,{silentJSONParsing:ba.transitional(ba.boolean),forcedJSONParsing:ba.transitional(ba.boolean),clarifyTimeoutError:ba.transitional(ba.boolean)},!1),s!=null&&(He.isFunction(s)?n.paramsSerializer={serialize:s}:Tp.assertOptions(s,{encode:ba.function,serialize:ba.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),Tp.assertOptions(n,{baseUrl:ba.spelling("baseURL"),withXsrfToken:ba.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let l=i&&He.merge(i.common,i[n.method]);i&&He.forEach(["delete","get","head","post","put","patch","common"],g=>{delete i[g]}),n.headers=Zs.concat(l,i);const a=[];let c=!0;this.interceptors.request.forEach(function(y){typeof y.runWhen=="function"&&y.runWhen(n)===!1||(c=c&&y.synchronous,a.unshift(y.fulfilled,y.rejected))});const d=[];this.interceptors.response.forEach(function(y){d.push(y.fulfilled,y.rejected)});let u,f=0,m;if(!c){const g=[N_.bind(this),void 0];for(g.unshift(...a),g.push(...d),m=g.length,u=Promise.resolve(n);f<m;)u=u.then(g[f++],g[f++]);return u}m=a.length;let h=n;for(f=0;f<m;){const g=a[f++],y=a[f++];try{h=g(h)}catch(p){y.call(this,p);break}}try{u=N_.call(this,h)}catch(g){return Promise.reject(g)}for(f=0,m=d.length;f<m;)u=u.then(d[f++],d[f++]);return u}getUri(t){t=xc(this.defaults,t);const n=fI(t.baseURL,t.url,t.allowAbsoluteUrls);return oI(n,t.params,t.paramsSerializer)}};He.forEach(["delete","get","head","options"],function(t){fc.prototype[t]=function(n,r){return this.request(xc(r||{},{method:t,url:n,data:(r||{}).data}))}});He.forEach(["post","put","patch"],function(t){function n(r){return function(i,l,a){return this.request(xc(a||{},{method:t,headers:r?{"Content-Type":"multipart/form-data"}:{},url:i,data:l}))}}fc.prototype[t]=n(),fc.prototype[t+"Form"]=n(!0)});let hU=class yI{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(i){n=i});const r=this;this.promise.then(s=>{if(!r._listeners)return;let i=r._listeners.length;for(;i-- >0;)r._listeners[i](s);r._listeners=null}),this.promise.then=s=>{let i;const l=new Promise(a=>{r.subscribe(a),i=a}).then(s);return l.cancel=function(){r.unsubscribe(i)},l},t(function(i,l,a){r.reason||(r.reason=new xd(i,l,a),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=r=>{t.abort(r)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new yI(function(s){t=s}),cancel:t}}};function mU(e){return function(n){return e.apply(null,n)}}function pU(e){return He.isObject(e)&&e.isAxiosError===!0}const S5={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(S5).forEach(([e,t])=>{S5[t]=e});function vI(e){const t=new fc(e),n=XP(fc.prototype.request,t);return He.extend(n,fc.prototype,t,{allOwnKeys:!0}),He.extend(n,t,null,{allOwnKeys:!0}),n.create=function(s){return vI(xc(e,s))},n}const or=vI(Gh);or.Axios=fc;or.CanceledError=xd;or.CancelToken=hU;or.isCancel=uI;or.VERSION=xI;or.toFormData=c0;or.AxiosError=mn;or.Cancel=or.CanceledError;or.all=function(t){return Promise.all(t)};or.spread=mU;or.isAxiosError=pU;or.mergeConfig=xc;or.AxiosHeaders=Zs;or.formToJSON=e=>cI(He.isHTMLForm(e)?new FormData(e):e);or.getAdapter=gI.getAdapter;or.HttpStatusCode=S5;or.default=or;const{Axios:fxe,AxiosError:hxe,CanceledError:mxe,isCancel:pxe,CancelToken:gxe,VERSION:xxe,all:yxe,Cancel:vxe,isAxiosError:bxe,spread:wxe,toFormData:Nxe,AxiosHeaders:jxe,HttpStatusCode:_xe,formToJSON:Sxe,getAdapter:Axe,mergeConfig:kxe}=or;let rf=null,sf=null;const uu={},gU=3e4,Jt=or.create({baseURL:"https://qabael.premiumasp.net/api",timeout:3e4,headers:{"Content-Type":"application/json"}}),Eu=or.create({baseURL:"https://qabael.premiumasp.net/api",timeout:3e4,headers:{"Content-Type":"application/json"},maxRedirects:5,maxContentLength:50*1024*1024,maxBodyLength:50*1024*1024}),bI=or.create({baseURL:"https://qabael.premiumasp.net/api",timeout:3e4,headers:{"Content-Type":"application/json"}});Eu.interceptors.request.use(e=>e,e=>Promise.reject(e));Eu.interceptors.response.use(e=>e,e=>(e.response||e.request,Promise.reject(e)));Jt.interceptors.request.use(e=>{const t=localStorage.getItem("authToken");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));Jt.interceptors.response.use(e=>e,e=>{var t;return((t=e.response)==null?void 0:t.status)===401&&(localStorage.removeItem("authToken"),window.location.href="/login"),Promise.reject(e)});bI.interceptors.request.use(e=>{const t=localStorage.getItem("authToken");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));bI.interceptors.response.use(e=>e,e=>{var t;return((t=e.response)==null?void 0:t.status)===401&&(localStorage.removeItem("authToken"),window.location.href="/login"),Promise.reject(e)});let wa=null;const xU=3e4,en={login:(e,t)=>Eu.post("/account/login",{Email:e,Password:t}).then(n=>{const r=n.data;if(r.success===!1||r.error||r.errors){const l=r.message||r.error||"Login failed";throw new Error(l)}let s=r.token||r.accessToken||r.access_token,i=r.user||r.userData||r.userInfo;if(!s&&r.data&&(s=r.data.token||r.data.accessToken||r.data.access_token,i=i||r.data.user||r.data.userData||r.data.userInfo),!s&&typeof r=="string"&&(s=r),s&&!i)if(r.userName||r.email)i={id:r.id||r.userId||r.userID||r.user_id||"unknown",firstName:r.userName||r.firstName||"User",lastName:r.lastName||"",email:r.email||"",phone:r.phone||void 0,language:"ar",theme:"light"};else try{const l=s.split(".")[1];if(l){const a=l.replace(/-/g,"+").replace(/_/g,"/"),c=decodeURIComponent(atob(a).split("").map(function(u){return"%"+("00"+u.charCodeAt(0).toString(16)).slice(-2)}).join("")),d=JSON.parse(c);i={id:d.nameid||d.sub||d.userId||d.userID||d.user_id||d.id||"unknown",firstName:d["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname"]||d.given_name||d.name||d.userName||d["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name"]||"User",lastName:d.family_name||d["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/surname"]||"",email:d["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress"]||d.email||"",phone:d.phone_number||void 0,language:"ar",theme:"light"}}}catch(l){console.warn("Could not parse token for user data:",l)}if(!s)throw new Error("Invalid login response: No authentication token received");if(!i||i.id==="unknown"&&!i.email)throw new Error("Invalid login response: No valid user identifier received");return wa=null,{token:s,user:i,success:!0}}).catch(n=>{var r;if(n.response){const s=n.response.status,i=n.response.data;if(s===401)throw new Error("Invalid email or password");if(s===403)throw new Error("Account is disabled or suspended");if(s===429)throw new Error("Too many login attempts. Please try again later");if(s>=500)throw new Error("Server error. Please try again later");const l=(i==null?void 0:i.message)||(i==null?void 0:i.error)||((r=i==null?void 0:i.errors)==null?void 0:r[0])||`Login failed with status ${s}`;throw new Error(l)}else throw n.request?new Error("Network error: Unable to reach the server. Please check your connection."):new Error(n.message||"Login error occurred")}),register:(e,t,n,r)=>Eu.post("/account/register",{UserName:e,Email:t,Password:n,PasswordConfirmation:r}).then(s=>{const i=s.data;if(i.success===!1||i.error||i.errors){const c=i.message||i.error||"Registration failed";throw new Error(c)}let l=i.token||i.accessToken||i.access_token,a=i.user||i.userData||i.userInfo;if(!l&&i.data&&(l=i.data.token||i.data.accessToken||i.data.access_token,a=a||i.data.user||i.data.userData||i.data.userInfo),!l&&typeof i=="string"&&(l=i),l&&!a)if(i.userName||i.email)a={id:i.id||i.userId||"unknown",firstName:i.userName||i.firstName||"User",lastName:i.lastName||"",email:i.email||"",phone:i.phone||void 0,language:"ar",theme:"light"};else try{const c=l.split(".")[1];if(c){const d=c.replace(/-/g,"+").replace(/_/g,"/"),u=decodeURIComponent(atob(d).split("").map(function(m){return"%"+("00"+m.charCodeAt(0).toString(16)).slice(-2)}).join("")),f=JSON.parse(u);a={id:f.nameid||f.sub||f.userId||"unknown",firstName:f["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname"]||f.given_name||f.name||f.userName||"User",lastName:f.family_name||"",email:f["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress"]||f.email||"",phone:f.phone_number||void 0,language:"ar",theme:"light"}}}catch(c){console.warn("Could not parse token for user data:",c)}if(!l)throw new Error("Invalid registration response: No authentication token received");if(!a||a.id==="unknown"&&!a.email)throw new Error("Invalid registration response: No valid user identifier received");return{token:l,user:a,success:!0}}).catch(s=>{var i;if(s.response){const l=s.response.status,a=s.response.data;if(l===400){if(a!=null&&a.errors){const d=Object.values(a.errors).flat();throw new Error(d.join(", ")||"Registration validation failed")}throw new Error("Invalid registration data")}else{if(l===409)throw new Error("Email or username already exists");if(l===422)throw new Error("Registration data validation failed");if(l>=500)throw new Error("Server error. Please try again later")}const c=(a==null?void 0:a.message)||(a==null?void 0:a.error)||((i=a==null?void 0:a.errors)==null?void 0:i[0])||`Registration failed with status ${l}`;throw new Error(c)}else throw s.request?new Error("Network error: Unable to reach the server. Please check your connection."):new Error(s.message||"Registration error occurred")}),getCurrentUser:()=>{const e=Date.now();return wa&&e-wa.timestamp<xU&&wa.data&&wa.data&&(wa.data.id!=="unknown"||wa.data.email)?Promise.resolve(wa.data):Jt.get("/account",{responseType:"json",decompress:!0}).then(t=>{const n=t.data;if(!n||n.id==="unknown"&&!n.email)throw new Error("Invalid user data received from server");return wa={data:n,timestamp:e},n})},emailExists:e=>Jt.get(`/account/Emailexists?email=${e}`).then(t=>t.data),signOut:()=>Jt.post("/account/SignOut").then(e=>e.data),forgetPassword:e=>Eu.post("https://qabael.premiumasp.net/api/account/ForgetPassword",{Email:e}).then(t=>t.data).catch(t=>{var n,r,s;if(t.response){if(t.response.status===404)return{};const i=((n=t.response.data)==null?void 0:n.message)||((r=t.response.data)==null?void 0:r.error)||"";if(i.includes("User not found")||i.includes("user not found"))return{}}else if(t.code==="ERR_NETWORK"||(s=t.message)!=null&&s.includes("Network Error"))return{};return{}}),resetPassword:(e,t,n,r)=>Jt.post(`/account/reset-password?email=${e}&token=${t}`,{NewPassword:n,ConfirmPassword:r}).then(s=>s.data),getProfile:()=>Jt.get("/Profile").then(e=>e.data),updateNotificationSettings:e=>Jt.put("/Profile/notifications",e).then(t=>t.data).catch(t=>{var n;if(((n=t.response)==null?void 0:n.status)===405)return Jt.post("/Profile/notifications",e).then(r=>r.data);throw t}),updatePrivacySettings:e=>Jt.put("/Profile/privacy",e).then(t=>t.data).catch(t=>{var n;if(((n=t.response)==null?void 0:n.status)===405)return Jt.post("/Profile/privacy",e).then(r=>r.data);throw t}),updateProfile:(e,t,n,r,s,i,l,a,c)=>Jt.post("/Profile",{userName:e,displayName:t,phoneNumber:n,age:r,nationality:s,nidOrPassport:i,city:l,country:a,gender:c}).then(d=>d.data).catch(d=>{var u;if(((u=d.response)==null?void 0:u.status)===405)return Jt.put("/Profile",{userName:e,displayName:t,phoneNumber:n,age:r,nationality:s,nidOrPassport:i,city:l,country:a,gender:c}).then(f=>f.data);throw d}),createOrUpdateProfile:(e,t,n,r,s,i,l,a,c)=>Jt.post("/Profile",{userName:e,displayName:t,phoneNumber:n,age:r,nationality:s,nidOrPassport:i,city:l,country:a,gender:c}).then(d=>d.data),uploadProfilePicture:e=>Jt.post("/Profile/upload-picture",e,{headers:{"Content-Type":"multipart/form-data"}}).then(t=>t.data),deleteProfilePicture:()=>Jt.delete("/Profile/delete-picture").then(e=>e.data),getTrees:()=>rf||(rf=Jt.get("/FamilyTree").then(e=>e.data).finally(()=>{rf=null}),rf),getAllPublicTrees:()=>sf||(sf=Eu.get("/FamilyTree/public").then(e=>e.data).finally(()=>{sf=null}),sf),addTree:(e,t,n)=>Jt.post("/FamilyTree",{name:e,IsPrivate:t,Description:n}).then(r=>r),getTreeById:e=>Jt.get(`/FamilyTree/${e}`).then(t=>t.data),updateTree:(e,t,n,r)=>{if(!t||t.trim()==="")return Promise.reject(new Error("Tree name is required"));const s={name:t.trim(),IsPrivate:n,Description:(r==null?void 0:r.trim())||""};return Jt.put(`/FamilyTree/${e}`,s).then(i=>i).catch(i=>{throw i.response,i})},deleteTree:e=>Jt.delete(`/FamilyTree/${e}`).then(t=>t.data),uploadTreePhoto:e=>Jt.post("/FamilyTree/upload-picture",e,{headers:{"Content-Type":"multipart/form-data"}}).then(t=>t.data),deleteTreePhoto:e=>Jt.delete(`/FamilyTree/Delete-photo/${e}`).then(t=>t.data),addPerson:(e,t,n,r,s,i,l,a)=>{const c={name:e};return t&&t.trim()!==""&&(c.birthDate=t),n&&n.trim()!==""&&(c.birthPlace=n),r&&r.trim()!==""&&(c.occupation=r),s&&s.trim()!==""&&(c.gender=s),i&&i.trim()!==""&&(c.DeathDate=i),c.IsDeceased=l,c.FamilyTreeId=a,Jt.post("/Person",c).then(d=>d).catch(d=>{throw d.response,d})},getPersonsInTree:e=>{const t=e.toString(),n=Date.now();return uu[t]&&n-uu[t].timestamp<gU?Promise.resolve(uu[t].data):Jt.get(`/Person/person_in_tree?familyTreeId=${e}`).then(r=>(uu[t]={data:r.data,timestamp:n},r.data))},updatePerson:(e,t,n,r,s,i,l)=>{const a={name:t};return n&&n.trim()!==""&&(a.birthDate=n),r&&r.trim()!==""&&(a.birthPlace=r),s&&s.trim()!==""&&(a.occupation=s),i&&i.trim()!==""&&(a.gender=i),l&&(a.familyTreeId=l),Jt.put(`/Person/${e}`,a).then(c=>c).catch(c=>{throw c.response,c})},getPersonById:e=>Jt.get(`/Person/${e}`).then(t=>t.data).catch(t=>{throw t}),deletePerson:e=>Jt.delete(`/Person/${e}`).then(t=>t.data).catch(t=>{var n,r;if(t.response){const s=((n=t.response.data)==null?void 0:n.message)||((r=t.response.data)==null?void 0:r.error)||JSON.stringify(t.response.data);throw new Error(`Server error ${t.response.status}: ${s||"Unknown server error"}`)}else throw t.request?new Error("Network error: No response received from server"):new Error(`Request error: ${t.message}`)}),uploadPersonPicture:e=>Jt.post("/Person/upload-picture",e,{headers:{"Content-Type":"multipart/form-data"}}).then(t=>t.data),deletePersonPicture:e=>Jt.delete(`/Person/delete-photo/${e}`).then(t=>t.data),addRelationship:(e,t,n)=>Jt.post("/Relationship",{personId:e,relatedPersonId:t,relationshipType:n}).then(r=>r.data),getRelationships:()=>Jt.get("/Relationship").then(e=>e.data),deleteRelationship:e=>Jt.delete(`/Relationship/${e}`).then(t=>t.data),testApiConnectivity:async()=>{var e;try{return(await Jt.get("/health",{timeout:5e3})).status===200}catch(t){return((e=t.response)==null?void 0:e.status)===404}},createJoinRequest:async(e,t,n,r,s,i,l,a,c,d)=>{var f,m;if(!e||e<=0)throw new Error("Invalid family tree ID");if(!t||t.trim().length<2)throw new Error("Name must be at least 2 characters");if(!n)throw new Error("Birth date is required");if(!r||r.trim().length<2)throw new Error("Birth place must be at least 2 characters");if(!s||!["Male","Female"].includes(s))throw new Error("Gender must be either Male or Female");if(!i||i.trim().length<2)throw new Error("Occupation must be at least 2 characters");const u={FamilyTreeId:e,Name:t,BirthDate:n,BirthPlace:r,Gender:s,Occupation:i,RelatedPersonId:l,Status:a,RequesterId:c,RelationshipType:d};try{return(await Jt.post("/JoinRequest",u)).data}catch(h){if(h.response){const g=((f=h.response.data)==null?void 0:f.message)||((m=h.response.data)==null?void 0:m.error)||JSON.stringify(h.response.data);throw new Error(`Server error ${h.response.status}: ${g||"Unknown server error"}`)}else throw h.request?new Error("Network error: No response received from server"):new Error(`Request error: ${h.message}`)}},getJoinRequestsByTree:e=>Jt.get(`/JoinRequest/by-tree/${e}`).then(t=>t.data),acceptJoinRequest:e=>Jt.put(`/JoinRequest/${e}/accept`,{}).then(t=>t.data),rejectJoinRequest:e=>Jt.put(`/JoinRequest/${e}/reject`,{}).then(t=>t.data),getAdminTrees:()=>Jt.get("/FamilyTree/Admin_FamilyTrees").then(e=>e.data).catch(e=>{var t;return((t=e.response)==null?void 0:t.status)===404?{data:[]}:{data:[]}}),getUserCount:()=>Jt.get("/admin/users/count").then(e=>e.data).catch(e=>{var t;return((t=e.response)==null?void 0:t.status)===404?{count:0}:{count:0}}),getTotalTreeCount:()=>Jt.get("/admin/familytrees/count").then(e=>e.data).catch(e=>{var t;return((t=e.response)==null?void 0:t.status)===404?{count:0}:{count:0}}),getPrivateTreeCount:()=>Jt.get("/admin/familytrees/private/count").then(e=>e.data).catch(e=>{var t;return((t=e.response)==null?void 0:t.status)===404?{count:0}:{count:0}}),getPublicTreeCount:()=>Jt.get("/admin/familytrees/public/count").then(e=>e.data).catch(e=>{var t;return((t=e.response)==null?void 0:t.status)===404?{count:0}:{count:0}}),getPersonCount:()=>Jt.get("/admin/persons/count").then(e=>e.data).catch(e=>{var t;return((t=e.response)==null?void 0:t.status)===404?{count:0}:{count:0}}),getAllSubscriptions:()=>Jt.get("/admin/subscriptions").then(e=>e.data).catch(e=>{var t;return((t=e.response)==null?void 0:t.status)===404?{data:[]}:{data:[]}}),getSubscriptionById:e=>Jt.get(`/admin/subscriptions/${e}`).then(t=>t.data).catch(t=>{var n;return((n=t.response)==null?void 0:n.status)===404,null}),updateSubscription:(e,t)=>Jt.put(`/admin/subscriptions/${e}`,t).then(n=>n.data).catch(n=>{var r;return((r=n.response)==null?void 0:r.status)===404,null}),cancelSubscription:e=>Jt.post(`/admin/subscriptions/${e}/cancel`).then(t=>t.data).catch(t=>{var n;return((n=t.response)==null?void 0:n.status)===404,null}),refundSubscription:(e,t)=>Jt.post(`/admin/subscriptions/${e}/refund`,{amount:t}).then(n=>n.data).catch(n=>{var r;return((r=n.response)==null?void 0:r.status)===404,null}),getAllUsers:()=>Jt.get("/admin/users").then(e=>e.data).catch(e=>{var t;return((t=e.response)==null?void 0:t.status)===404?{data:[],count:0}:{data:[],count:0}}),deleteUser:e=>Jt.delete(`/admin/users/${e}`).then(t=>t.data),blockUser:e=>Promise.resolve({success:!0,message:`User with email ${e} blocked successfully`}),clearPersonsInTreeCache:()=>{Object.keys(uu).forEach(e=>{delete uu[e]})},clearUserCache:()=>{wa=null}},yU=e=>{if(!e||!e.token||typeof e.token!="string"||e.token.trim()===""||!e.user||!e.user.id||!e.user.email)return!1;const t=e.token.split(".");if(t.length!==3)return!1;try{const r=t[1].replace(/-/g,"+").replace(/_/g,"/"),s=decodeURIComponent(atob(r).split("").map(function(a){return"%"+("00"+a.charCodeAt(0).toString(16)).slice(-2)}).join("")),i=JSON.parse(s),l=Math.floor(Date.now()/1e3);return!(i.exp&&i.exp<l)}catch{return!1}},vU=e=>{try{const n=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent(atob(n).split("").map(function(i){return"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(r)}catch{return null}},af=(e,t)=>{const n=vU(t),r=(e==null?void 0:e.role)==="admin",s=(n==null?void 0:n.role)==="admin",i=(e==null?void 0:e.email)==="alkarbi.mohamed@gmail.com"||(n==null?void 0:n.email)==="alkarbi.mohamed@gmail.com",l=r||s||i;return{id:(e==null?void 0:e.id)||(n==null?void 0:n.nameid)||(n==null?void 0:n.sub)||(n==null?void 0:n.userId)||(e==null?void 0:e.userId)||"unknown",firstName:(e==null?void 0:e.firstName)||(e==null?void 0:e.userName)||(n==null?void 0:n.given_name)||(n==null?void 0:n.name)||"User",lastName:(e==null?void 0:e.lastName)||"",email:(e==null?void 0:e.email)||(n==null?void 0:n.email)||"",phone:(e==null?void 0:e.phone)||(e==null?void 0:e.phoneNumber)||(n==null?void 0:n.phone_number)||void 0,dateOfBirth:(e==null?void 0:e.dateOfBirth)||void 0,gender:(e==null?void 0:e.gender)||(e==null?void 0:e.gender)||(n==null?void 0:n.gender)||void 0,country:(e==null?void 0:e.country)||(e==null?void 0:e.nationality)||(n==null?void 0:n.country)||void 0,city:(e==null?void 0:e.city)||void 0,language:(e==null?void 0:e.language)||"en",theme:(e==null?void 0:e.theme)||"light",timezone:(e==null?void 0:e.timezone)||(n==null?void 0:n.zoneinfo)||void 0,avatar:(e==null?void 0:e.avatar)||void 0,isEmailVerified:(e==null?void 0:e.isEmailVerified)||!1,stats:(e==null?void 0:e.stats)||{treesCreated:0,totalPeople:0,photosUploaded:0,documentsUploaded:0,storageUsed:0,totalLogins:0},notifications:(e==null?void 0:e.notifications)||{email:{newSuggestions:!0,treeUpdates:!0,subscriptionUpdates:!0,marketing:!1},push:{enabled:!0}},privacy:(e==null?void 0:e.privacy)||{profileVisibility:"public",allowSearchEngines:!1,showOnlineStatus:!0},createdAt:(e==null?void 0:e.createdAt)||new Date().toISOString(),lastLoginAt:(e==null?void 0:e.lastLoginAt)||void 0,role:l?"admin":(e==null?void 0:e.role)||(n==null?void 0:n.role)||"user"}},Vn={login:async e=>{try{const t=await en.login(e.email,e.password);if(!yU(t))throw new Error("Invalid login response: Authentication failed");localStorage.setItem("authToken",t.token);let n={};try{n=await en.getProfile()}catch(i){console.warn("Failed to fetch profile data:",i)}const r={...t.user,...n,firstName:n.userName||n.firstName||t.user.firstName||"User",lastName:n.lastName||t.user.lastName||"",phone:n.phoneNumber!==void 0?n.phoneNumber:t.user.phone,country:n.country||n.nationality||t.user.country,city:n.city||t.user.city,dateOfBirth:n.dateOfBirth||t.user.dateOfBirth,gender:n.gender||t.user.gender,email:t.user.email||n.email||""},s=af(r,t.token);return localStorage.setItem("user",JSON.stringify(s)),t.user=s,t}catch(t){if(localStorage.removeItem("authToken"),localStorage.removeItem("user"),t.response){const n=t.response.status,r=t.response.data;switch(n){case 400:throw new Error("Invalid email or password format");case 401:throw new Error("Invalid email or password");case 403:throw new Error("Account is disabled or suspended");case 429:throw new Error("Too many login attempts. Please try again later");case 500:throw new Error("Server error. Please try again later");default:throw new Error((r==null?void 0:r.message)||"Login failed. Please try again")}}else throw t.code==="ERR_NETWORK"?new Error("Network error. Please check your internet connection"):t.message?new Error(t.message):new Error("Login failed. Please check your credentials and try again")}},register:async e=>{try{const t=await en.register(e.name||e.firstName,e.email,e.password,e.confirmPassword);if(t.token&&localStorage.setItem("authToken",t.token),t.user||t.token){const n=af(t.user||{},t.token);localStorage.setItem("user",JSON.stringify(n)),t.user=n}return t}catch(t){throw t}},logout:async()=>{try{await en.signOut()}catch{}finally{localStorage.removeItem("authToken"),localStorage.removeItem("user")}},getCurrentUser:async()=>{try{const e=await en.getCurrentUser();let t={};try{t=await en.getProfile()}catch(i){console.warn("Failed to fetch profile data:",i)}const n={...e,...t,firstName:t.userName||t.firstName||e.firstName||"User",lastName:t.lastName||e.lastName||"",phone:t.phoneNumber!==void 0?t.phoneNumber:e.phone,country:t.country||t.nationality||e.country,city:t.city||e.city,dateOfBirth:t.dateOfBirth||e.dateOfBirth,gender:t.gender||e.gender,email:e.email||t.email||""},r=localStorage.getItem("authToken");if(r){const i=af(n,r);return localStorage.setItem("user",JSON.stringify(i)),i}return af(n,"")}catch(e){throw e}},emailExists:async e=>{try{return await en.emailExists(e)}catch(t){throw t}},forgotPassword:async e=>{try{await en.forgetPassword(e)}catch{}},resetPassword:async(e,t,n,r)=>{try{await en.resetPassword(e,t,n,r)}catch(s){throw s}},verifyEmail:async e=>{try{await new Promise(t=>setTimeout(t,1e3))}catch(t){throw t}},resendVerificationEmail:async()=>{try{await new Promise(e=>setTimeout(e,1e3))}catch(e){throw e}},getStoredToken:()=>localStorage.getItem("authToken"),getStoredUser:()=>{const e=localStorage.getItem("user");if(!e)return null;try{const t=JSON.parse(e);if(t&&typeof t=="object"&&!t.firstName&&t.userName){const n=localStorage.getItem("authToken");if(n)return af(t,n)}return t}catch{return null}},storeUser:e=>{localStorage.setItem("user",JSON.stringify(e))},clearStoredAuth:()=>{localStorage.removeItem("authToken"),localStorage.removeItem("user")},isTokenExpired:()=>{const e=localStorage.getItem("authToken");if(!e)return!0;try{const t=e.split(".")[1];if(!t)return!0;const n=t.replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent(atob(n).split("").map(function(a){return"%"+("00"+a.charCodeAt(0).toString(16)).slice(-2)}).join("")),s=JSON.parse(r),i=Math.floor(Date.now()/1e3);return s.exp<i}catch{return!1}},refreshToken:async()=>{throw new Error("Token refresh not implemented")},updateProfile:async e=>{try{const t=Vn.getStoredUser();if(!t)throw new Error("No user data found");const n={userName:e.firstName||t.firstName||"",displayName:e.firstName||t.firstName||"",phoneNumber:e.phone||t.phone||"",age:e.dateOfBirth?Math.floor((Date.now()-new Date(e.dateOfBirth).getTime())/(1e3*365*24*60*60)).toString():t.dateOfBirth?Math.floor((Date.now()-new Date(t.dateOfBirth).getTime())/(1e3*365*24*60*60)).toString():"",nationality:e.country||t.country||"",nidOrPassport:"",city:e.city||t.city||"",country:e.country||t.country||"",gender:e.gender||t.gender||""};await en.updateProfile(n.userName,n.displayName,n.phoneNumber,n.age,n.nationality,n.nidOrPassport,n.city,n.country,n.gender);const r={...t,...e,firstName:e.firstName!==void 0?e.firstName:t.firstName,lastName:e.lastName!==void 0?e.lastName:t.lastName,phone:e.phone!==void 0?e.phone:t.phone,dateOfBirth:e.dateOfBirth!==void 0?e.dateOfBirth:t.dateOfBirth,country:e.country!==void 0?e.country:t.country,city:e.city!==void 0?e.city:t.city,gender:e.gender!==void 0?e.gender:t.gender};return Vn.storeUser(r),r}catch(t){throw t}},uploadAvatar:async e=>{try{const t=new FormData;t.append("picture",e);const n=await en.uploadProfilePicture(t),r=Vn.getStoredUser();if(r){const s={...r,avatar:n};Vn.storeUser(s)}return{avatar:n}}catch(t){throw t}},deleteAvatar:async()=>{try{await en.deleteProfilePicture();const e=Vn.getStoredUser();if(e){const t={...e,avatar:void 0};Vn.storeUser(t)}}catch(e){throw e}},changePassword:async(e,t,n)=>{throw new Error("Change password not implemented")},updateNotificationSettings:async e=>{try{return await en.updateNotificationSettings(e)}catch(t){throw t}},updatePrivacySettings:async e=>{try{return await en.updatePrivacySettings(e)}catch(t){throw t}},deleteAccount:async()=>{throw new Error("Delete account not implemented")},deleteUser:async e=>{try{await en.deleteUser(e)}catch(t){throw t}}};let ex=null,tx="",of=null;const Xl=e=>{if(!e)return ex=null,tx="",null;const t=JSON.stringify(e);return t!==tx&&(ex=e,tx=t),ex},Mr=r3()(YP(s3((e,t)=>({user:null,token:null,isAuthenticated:!1,isLoading:!0,login:async n=>{e({isLoading:!0});try{const r=await Vn.login(n);if(!r.user||!r.token)throw new Error("Invalid login response");return e({user:Xl(r.user),token:r.token,isAuthenticated:!0,isLoading:!1}),r}catch(r){throw e({user:null,token:null,isAuthenticated:!1,isLoading:!1}),r}},register:async n=>{e({isLoading:!0});try{const r=await Vn.register(n);if(!r.user||!r.token)throw new Error("Invalid registration response");return e({user:Xl(r.user),token:r.token,isAuthenticated:!0,isLoading:!1}),r}catch(r){throw e({user:null,token:null,isAuthenticated:!1,isLoading:!1}),r}},logout:async()=>{e({isLoading:!0});try{await Vn.logout()}catch{}finally{e({user:null,token:null,isAuthenticated:!1,isLoading:!1})}},updateUser:n=>{const r=t().user;if(r){const s={...r,...n};e({user:Xl(s)})}},setAuthData:(n,r)=>{e({user:Xl(n),token:r,isAuthenticated:!0,isLoading:!1})},clearAuth:()=>{e({user:null,token:null,isAuthenticated:!1,isLoading:!1})},refreshToken:async()=>{try{const n=await Vn.refreshToken();e({user:Xl(n.user),token:n.token,isAuthenticated:!0})}catch(n){throw e({user:null,token:null,isAuthenticated:!1}),n}},initialize:()=>{const n=Vn.getStoredUser(),r=Vn.getStoredToken(),s=Vn.isTokenExpired();return n&&r&&!s?e({user:Xl(n),token:r,isAuthenticated:!0,isLoading:!1}):((r||n)&&Vn.clearStoredAuth(),e({user:null,token:null,isAuthenticated:!1,isLoading:!1})),Promise.resolve()},getCurrentUser:async()=>of||(of=(async()=>{try{const n=await Vn.getCurrentUser();if(!n||n.id==="unknown"&&!n.email)throw new Error("Invalid user data received");return e({user:Xl(n),isAuthenticated:!0,isLoading:!1}),n}catch(n){throw e({user:null,token:null,isAuthenticated:!1,isLoading:!1}),n}finally{of=null}})(),of),updateProfile:async n=>{e({isLoading:!0});try{const r=await Vn.updateProfile(n);return e({user:r,isLoading:!1}),r}catch(r){throw e({isLoading:!1}),r}},uploadAvatar:async n=>{e({isLoading:!0});try{const r=await Vn.uploadAvatar(n),s=t().user;return s&&e({user:{...s,avatar:r.avatar},isLoading:!1}),r}catch(r){throw e({isLoading:!1}),r}},deleteAvatar:async()=>{e({isLoading:!0});try{await Vn.deleteAvatar();const n=t().user;n&&e({user:{...n,avatar:void 0},isLoading:!1})}catch(n){throw e({isLoading:!1}),n}},changePassword:async(n,r,s)=>{e({isLoading:!0});try{await Vn.changePassword(n,r,s),e({isLoading:!1})}catch(i){throw e({isLoading:!1}),i}},updateNotificationSettings:async n=>{e({isLoading:!0});try{const r=await Vn.updateNotificationSettings(n),s=t().user;return s&&e({user:{...s,notifications:r},isLoading:!1}),r}catch(r){throw e({isLoading:!1}),r}},updatePrivacySettings:async n=>{e({isLoading:!0});try{const r=await Vn.updatePrivacySettings(n),s=t().user;return s&&e({user:{...s,privacy:r},isLoading:!1}),r}catch(r){throw e({isLoading:!1}),r}},deleteAccount:async()=>{e({isLoading:!0});try{await Vn.deleteAccount(),e({user:null,token:null,isAuthenticated:!1,isLoading:!1})}catch(n){throw e({isLoading:!1}),n}}}),{name:"auth-storage",partialize:e=>({user:e.user,token:e.token,isAuthenticated:e.isAuthenticated})}),{name:"auth-store"})),Ft=r3()(s3((e,t)=>({language:"ar",theme:"light",sidebarCollapsed:!1,notifications:[],setLanguage:n=>e({language:n}),setTheme:n=>e({theme:n}),setSidebarCollapsed:n=>e({sidebarCollapsed:n}),addNotification:n=>{const r=Math.random().toString(36).substr(2,9),s={...n,id:r};e(l=>({notifications:[...l.notifications,s]}));const i=n.duration||5e3;return setTimeout(()=>{t().removeNotification(r)},i),r},removeNotification:n=>e(r=>({notifications:r.notifications.filter(s=>s.id!==n)})),clearNotifications:()=>e({notifications:[]}),showSuccess:(n,r)=>t().addNotification({type:"success",title:n,message:r||"",duration:5e3}),showError:(n,r)=>t().addNotification({type:"error",title:n,message:r||"",duration:7e3}),showErrorWithAction:(n,r,s)=>t().addNotification({type:"error",title:n,message:r||"",action:s,duration:7e3}),showWarning:(n,r)=>t().addNotification({type:"warning",title:n,message:r||"",duration:6e3}),showInfo:(n,r)=>t().addNotification({type:"info",title:n,message:r||"",duration:5e3})}),{name:"ui-store",partialize:e=>({language:e.language,theme:e.theme,sidebarCollapsed:e.sidebarCollapsed})}));function wI(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(n=wI(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function bU(){for(var e,t,n=0,r="",s=arguments.length;n<s;n++)(e=arguments[n])&&(t=wI(e))&&(r&&(r+=" "),r+=t);return r}const l3="-",wU=e=>{const t=jU(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:l=>{const a=l.split(l3);return a[0]===""&&a.length!==1&&a.shift(),NI(a,t)||NU(l)},getConflictingClassGroupIds:(l,a)=>{const c=n[l]||[];return a&&r[l]?[...c,...r[l]]:c}}},NI=(e,t)=>{var l;if(e.length===0)return t.classGroupId;const n=e[0],r=t.nextPart.get(n),s=r?NI(e.slice(1),r):void 0;if(s)return s;if(t.validators.length===0)return;const i=e.join(l3);return(l=t.validators.find(({validator:a})=>a(i)))==null?void 0:l.classGroupId},__=/^\[(.+)\]$/,NU=e=>{if(__.test(e)){const t=__.exec(e)[1],n=t==null?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},jU=e=>{const{theme:t,prefix:n}=e,r={nextPart:new Map,validators:[]};return SU(Object.entries(e.classGroups),n).forEach(([i,l])=>{A5(l,r,i,t)}),r},A5=(e,t,n,r)=>{e.forEach(s=>{if(typeof s=="string"){const i=s===""?t:S_(t,s);i.classGroupId=n;return}if(typeof s=="function"){if(_U(s)){A5(s(r),t,n,r);return}t.validators.push({validator:s,classGroupId:n});return}Object.entries(s).forEach(([i,l])=>{A5(l,S_(t,i),n,r)})})},S_=(e,t)=>{let n=e;return t.split(l3).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},_U=e=>e.isThemeGetter,SU=(e,t)=>t?e.map(([n,r])=>{const s=r.map(i=>typeof i=="string"?t+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([l,a])=>[t+l,a])):i);return[n,s]}):e,AU=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,r=new Map;const s=(i,l)=>{n.set(i,l),t++,t>e&&(t=0,r=n,n=new Map)};return{get(i){let l=n.get(i);if(l!==void 0)return l;if((l=r.get(i))!==void 0)return s(i,l),l},set(i,l){n.has(i)?n.set(i,l):s(i,l)}}},jI="!",kU=e=>{const{separator:t,experimentalParseClassName:n}=e,r=t.length===1,s=t[0],i=t.length,l=a=>{const c=[];let d=0,u=0,f;for(let p=0;p<a.length;p++){let x=a[p];if(d===0){if(x===s&&(r||a.slice(p,p+i)===t)){c.push(a.slice(u,p)),u=p+i;continue}if(x==="/"){f=p;continue}}x==="["?d++:x==="]"&&d--}const m=c.length===0?a:a.substring(u),h=m.startsWith(jI),g=h?m.substring(1):m,y=f&&f>u?f-u:void 0;return{modifiers:c,hasImportantModifier:h,baseClassName:g,maybePostfixModifierPosition:y}};return n?a=>n({className:a,parseClassName:l}):l},EU=e=>{if(e.length<=1)return e;const t=[];let n=[];return e.forEach(r=>{r[0]==="["?(t.push(...n.sort(),r),n=[]):n.push(r)}),t.push(...n.sort()),t},CU=e=>({cache:AU(e.cacheSize),parseClassName:kU(e),...wU(e)}),PU=/\s+/,IU=(e,t)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:s}=t,i=[],l=e.trim().split(PU);let a="";for(let c=l.length-1;c>=0;c-=1){const d=l[c],{modifiers:u,hasImportantModifier:f,baseClassName:m,maybePostfixModifierPosition:h}=n(d);let g=!!h,y=r(g?m.substring(0,h):m);if(!y){if(!g){a=d+(a.length>0?" "+a:a);continue}if(y=r(m),!y){a=d+(a.length>0?" "+a:a);continue}g=!1}const p=EU(u).join(":"),x=f?p+jI:p,b=x+y;if(i.includes(b))continue;i.push(b);const w=s(y,g);for(let N=0;N<w.length;++N){const k=w[N];i.push(x+k)}a=d+(a.length>0?" "+a:a)}return a};function TU(){let e=0,t,n,r="";for(;e<arguments.length;)(t=arguments[e++])&&(n=_I(t))&&(r&&(r+=" "),r+=n);return r}const _I=e=>{if(typeof e=="string")return e;let t,n="";for(let r=0;r<e.length;r++)e[r]&&(t=_I(e[r]))&&(n&&(n+=" "),n+=t);return n};function LU(e,...t){let n,r,s,i=l;function l(c){const d=t.reduce((u,f)=>f(u),e());return n=CU(d),r=n.cache.get,s=n.cache.set,i=a,a(c)}function a(c){const d=r(c);if(d)return d;const u=IU(c,n);return s(c,u),u}return function(){return i(TU.apply(null,arguments))}}const rr=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},SI=/^\[(?:([a-z-]+):)?(.+)\]$/i,MU=/^\d+\/\d+$/,RU=new Set(["px","full","screen"]),$U=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,OU=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,FU=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,DU=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,qU=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ro=e=>Mu(e)||RU.has(e)||MU.test(e),Yo=e=>yd(e,"length",YU),Mu=e=>!!e&&!Number.isNaN(Number(e)),nx=e=>yd(e,"number",Mu),lf=e=>!!e&&Number.isInteger(Number(e)),BU=e=>e.endsWith("%")&&Mu(e.slice(0,-1)),xn=e=>SI.test(e),Xo=e=>$U.test(e),zU=new Set(["length","size","percentage"]),UU=e=>yd(e,zU,AI),HU=e=>yd(e,"position",AI),VU=new Set(["image","url"]),WU=e=>yd(e,VU,KU),GU=e=>yd(e,"",XU),cf=()=>!0,yd=(e,t,n)=>{const r=SI.exec(e);return r?r[1]?typeof t=="string"?r[1]===t:t.has(r[1]):n(r[2]):!1},YU=e=>OU.test(e)&&!FU.test(e),AI=()=>!1,XU=e=>DU.test(e),KU=e=>qU.test(e),JU=()=>{const e=rr("colors"),t=rr("spacing"),n=rr("blur"),r=rr("brightness"),s=rr("borderColor"),i=rr("borderRadius"),l=rr("borderSpacing"),a=rr("borderWidth"),c=rr("contrast"),d=rr("grayscale"),u=rr("hueRotate"),f=rr("invert"),m=rr("gap"),h=rr("gradientColorStops"),g=rr("gradientColorStopPositions"),y=rr("inset"),p=rr("margin"),x=rr("opacity"),b=rr("padding"),w=rr("saturate"),N=rr("scale"),k=rr("sepia"),I=rr("skew"),R=rr("space"),T=rr("translate"),S=()=>["auto","contain","none"],E=()=>["auto","hidden","clip","visible","scroll"],_=()=>["auto",xn,t],M=()=>[xn,t],A=()=>["",ro,Yo],P=()=>["auto",Mu,xn],B=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],L=()=>["solid","dashed","dotted","double","none"],D=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],V=()=>["start","end","center","between","around","evenly","stretch"],O=()=>["","0",xn],H=()=>["auto","avoid","all","avoid-page","page","left","right","column"],W=()=>[Mu,xn];return{cacheSize:500,separator:":",theme:{colors:[cf],spacing:[ro,Yo],blur:["none","",Xo,xn],brightness:W(),borderColor:[e],borderRadius:["none","","full",Xo,xn],borderSpacing:M(),borderWidth:A(),contrast:W(),grayscale:O(),hueRotate:W(),invert:O(),gap:M(),gradientColorStops:[e],gradientColorStopPositions:[BU,Yo],inset:_(),margin:_(),opacity:W(),padding:M(),saturate:W(),scale:W(),sepia:O(),skew:W(),space:M(),translate:M()},classGroups:{aspect:[{aspect:["auto","square","video",xn]}],container:["container"],columns:[{columns:[Xo]}],"break-after":[{"break-after":H()}],"break-before":[{"break-before":H()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...B(),xn]}],overflow:[{overflow:E()}],"overflow-x":[{"overflow-x":E()}],"overflow-y":[{"overflow-y":E()}],overscroll:[{overscroll:S()}],"overscroll-x":[{"overscroll-x":S()}],"overscroll-y":[{"overscroll-y":S()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[y]}],"inset-x":[{"inset-x":[y]}],"inset-y":[{"inset-y":[y]}],start:[{start:[y]}],end:[{end:[y]}],top:[{top:[y]}],right:[{right:[y]}],bottom:[{bottom:[y]}],left:[{left:[y]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",lf,xn]}],basis:[{basis:_()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",xn]}],grow:[{grow:O()}],shrink:[{shrink:O()}],order:[{order:["first","last","none",lf,xn]}],"grid-cols":[{"grid-cols":[cf]}],"col-start-end":[{col:["auto",{span:["full",lf,xn]},xn]}],"col-start":[{"col-start":P()}],"col-end":[{"col-end":P()}],"grid-rows":[{"grid-rows":[cf]}],"row-start-end":[{row:["auto",{span:[lf,xn]},xn]}],"row-start":[{"row-start":P()}],"row-end":[{"row-end":P()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",xn]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",xn]}],gap:[{gap:[m]}],"gap-x":[{"gap-x":[m]}],"gap-y":[{"gap-y":[m]}],"justify-content":[{justify:["normal",...V()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...V(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...V(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[b]}],px:[{px:[b]}],py:[{py:[b]}],ps:[{ps:[b]}],pe:[{pe:[b]}],pt:[{pt:[b]}],pr:[{pr:[b]}],pb:[{pb:[b]}],pl:[{pl:[b]}],m:[{m:[p]}],mx:[{mx:[p]}],my:[{my:[p]}],ms:[{ms:[p]}],me:[{me:[p]}],mt:[{mt:[p]}],mr:[{mr:[p]}],mb:[{mb:[p]}],ml:[{ml:[p]}],"space-x":[{"space-x":[R]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[R]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",xn,t]}],"min-w":[{"min-w":[xn,t,"min","max","fit"]}],"max-w":[{"max-w":[xn,t,"none","full","min","max","fit","prose",{screen:[Xo]},Xo]}],h:[{h:[xn,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[xn,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[xn,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[xn,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Xo,Yo]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",nx]}],"font-family":[{font:[cf]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",xn]}],"line-clamp":[{"line-clamp":["none",Mu,nx]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",ro,xn]}],"list-image":[{"list-image":["none",xn]}],"list-style-type":[{list:["none","disc","decimal",xn]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[x]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[x]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...L(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",ro,Yo]}],"underline-offset":[{"underline-offset":["auto",ro,xn]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:M()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",xn]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",xn]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[x]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...B(),HU]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",UU]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},WU]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[g]}],"gradient-via-pos":[{via:[g]}],"gradient-to-pos":[{to:[g]}],"gradient-from":[{from:[h]}],"gradient-via":[{via:[h]}],"gradient-to":[{to:[h]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[a]}],"border-w-x":[{"border-x":[a]}],"border-w-y":[{"border-y":[a]}],"border-w-s":[{"border-s":[a]}],"border-w-e":[{"border-e":[a]}],"border-w-t":[{"border-t":[a]}],"border-w-r":[{"border-r":[a]}],"border-w-b":[{"border-b":[a]}],"border-w-l":[{"border-l":[a]}],"border-opacity":[{"border-opacity":[x]}],"border-style":[{border:[...L(),"hidden"]}],"divide-x":[{"divide-x":[a]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[a]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[x]}],"divide-style":[{divide:L()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...L()]}],"outline-offset":[{"outline-offset":[ro,xn]}],"outline-w":[{outline:[ro,Yo]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:A()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[x]}],"ring-offset-w":[{"ring-offset":[ro,Yo]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Xo,GU]}],"shadow-color":[{shadow:[cf]}],opacity:[{opacity:[x]}],"mix-blend":[{"mix-blend":[...D(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":D()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",Xo,xn]}],grayscale:[{grayscale:[d]}],"hue-rotate":[{"hue-rotate":[u]}],invert:[{invert:[f]}],saturate:[{saturate:[w]}],sepia:[{sepia:[k]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[d]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[u]}],"backdrop-invert":[{"backdrop-invert":[f]}],"backdrop-opacity":[{"backdrop-opacity":[x]}],"backdrop-saturate":[{"backdrop-saturate":[w]}],"backdrop-sepia":[{"backdrop-sepia":[k]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[l]}],"border-spacing-x":[{"border-spacing-x":[l]}],"border-spacing-y":[{"border-spacing-y":[l]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",xn]}],duration:[{duration:W()}],ease:[{ease:["linear","in","out","in-out",xn]}],delay:[{delay:W()}],animate:[{animate:["none","spin","ping","pulse","bounce",xn]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[N]}],"scale-x":[{"scale-x":[N]}],"scale-y":[{"scale-y":[N]}],rotate:[{rotate:[lf,xn]}],"translate-x":[{"translate-x":[T]}],"translate-y":[{"translate-y":[T]}],"skew-x":[{"skew-x":[I]}],"skew-y":[{"skew-y":[I]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",xn]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",xn]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":M()}],"scroll-mx":[{"scroll-mx":M()}],"scroll-my":[{"scroll-my":M()}],"scroll-ms":[{"scroll-ms":M()}],"scroll-me":[{"scroll-me":M()}],"scroll-mt":[{"scroll-mt":M()}],"scroll-mr":[{"scroll-mr":M()}],"scroll-mb":[{"scroll-mb":M()}],"scroll-ml":[{"scroll-ml":M()}],"scroll-p":[{"scroll-p":M()}],"scroll-px":[{"scroll-px":M()}],"scroll-py":[{"scroll-py":M()}],"scroll-ps":[{"scroll-ps":M()}],"scroll-pe":[{"scroll-pe":M()}],"scroll-pt":[{"scroll-pt":M()}],"scroll-pr":[{"scroll-pr":M()}],"scroll-pb":[{"scroll-pb":M()}],"scroll-pl":[{"scroll-pl":M()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",xn]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[ro,Yo,nx]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},ZU=LU(JU);function wi(...e){return ZU(bU(e))}/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var QU={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eH=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),xt=(e,t)=>{const n=J.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:l,className:a="",children:c,...d},u)=>J.createElement("svg",{ref:u,...QU,width:s,height:s,stroke:r,strokeWidth:l?Number(i)*24/Number(s):i,className:["lucide",`lucide-${eH(e)}`,a].join(" "),...d},[...t.map(([f,m])=>J.createElement(f,m)),...Array.isArray(c)?c:[c]]));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qs=xt("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const No=xt("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fl=xt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ki=xt("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ta=xt("Baby",[["path",{d:"M9 12h.01",key:"157uk2"}],["path",{d:"M15 12h.01",key:"1k8ypt"}],["path",{d:"M10 16c.5.3 1.2.5 2 .5s1.5-.2 2-.5",key:"1u7htd"}],["path",{d:"M19 6.3a9 9 0 0 1 1.8 3.9 2 2 0 0 1 0 3.6 9 9 0 0 1-17.6 0 2 2 0 0 1 0-3.6A9 9 0 0 1 12 3c2 0 3.5 1.1 3.5 2.5s-.9 2.5-2 2.5c-.8 0-1.5-.4-1.5-1",key:"5yv0yz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tH=xt("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nH=xt("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hl=xt("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lr=xt("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yh=xt("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vi=xt("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rH=xt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f0=xt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c3=xt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h0=xt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sH=xt("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hh=xt("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mh=xt("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iH=xt("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aH=xt("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eh=xt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kI=xt("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ra=xt("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oH=xt("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ru=xt("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jo=xt("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lH=xt("GraduationCap",[["path",{d:"M22 10v6M2 10l10-5 10 5-10 5z",key:"1ef52a"}],["path",{d:"M6 12v5c3 3 9 3 12 0v-5",key:"1f75yj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cH=xt("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const br=xt("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m0=xt("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uH=xt("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wu=xt("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dH=xt("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EI=xt("Languages",[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fH=xt("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hH=xt("Linkedin",[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mH=xt("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mr=xt("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Di=xt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k5=xt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ra=xt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ei=xt("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CI=xt("Maximize",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PI=xt("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pH=xt("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const II=xt("Minimize",[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3",key:"hohbtr"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3",key:"5jw1f3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3",key:"198tvr"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3",key:"ph8mxp"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A_=xt("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ph=xt("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gH=xt("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xH=xt("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",key:"1xcu5"}],["circle",{cx:"17.5",cy:"10.5",r:".5",key:"736e4u"}],["circle",{cx:"8.5",cy:"7.5",r:".5",key:"clrty"}],["circle",{cx:"6.5",cy:"12.5",r:".5",key:"1s4xz9"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sa=xt("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gu=xt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yu=xt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ml=xt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xu=xt("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qi=xt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k_=xt("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gh=xt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p0=xt("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g0=xt("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yH=xt("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vH=xt("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bH=xt("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u3=xt("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xh=xt("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wH=xt("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $a=xt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qn=xt("TreePine",[["path",{d:"m17 14 3 3.3a1 1 0 0 1-.7 1.7H4.7a1 1 0 0 1-.7-1.7L7 14h-.3a1 1 0 0 1-.7-1.7L9 9h-.2A1 1 0 0 1 8 7.3L12 3l4 4.3a1 1 0 0 1-.8 1.7H15l3 3.3a1 1 0 0 1-.7 1.7H17Z",key:"cpyugq"}],["path",{d:"M12 22v-3",key:"kmzjlo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ng=xt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NH=xt("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jH=xt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lp=xt("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rg=xt("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TI=xt("UserRoundCheck",[["path",{d:"M2 21a8 8 0 0 1 13.292-6",key:"bjp14o"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"m16 19 2 2 4-4",key:"1b14m6"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aa=xt("UserRound",[["circle",{cx:"12",cy:"8",r:"5",key:"1hypcn"}],["path",{d:"M20 21a8 8 0 0 0-16 0",key:"rfgkzh"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LI=xt("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=xt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kn=xt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const th=xt("VenetianMask",[["path",{d:"M2 12a5 5 0 0 0 5 5 8 8 0 0 1 5 2 8 8 0 0 1 5-2 5 5 0 0 0 5-5V7h-5a8 8 0 0 0-5 2 8 8 0 0 0-5-2H2Z",key:"1g6z3j"}],["path",{d:"M6 11c1.5 0 3 .5 3 2-2 0-3 0-3-2Z",key:"c2lwnf"}],["path",{d:"M18 11c-1.5 0-3 .5-3 2 2 0 3 0 3-2Z",key:"njd9zo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _H=xt("Volume2",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}],["path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14",key:"1kegas"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SH=xt("VolumeX",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sg=xt("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ia=xt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AH=xt("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kH=xt("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EH=xt("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),ye=({className:e,variant:t="default",size:n="default",asChild:r=!1,loading:s=!1,loadingText:i,children:l,disabled:a,...c})=>{const d={default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},u={default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"},f={...c};return delete f.asChild,delete f.loading,delete f.loadingText,o.jsxs("button",{className:wi("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",d[t],u[n],e),disabled:a||s,...f,children:[s&&o.jsx(mr,{className:"mr-2 h-4 w-4 animate-spin"}),s&&i?i:l]})},uf=({children:e})=>{const{language:t,theme:n,setLanguage:r,setTheme:s}=Ft(),i=()=>{r(t==="en"?"ar":"en")},l=()=>{s(n==="light"?"dark":"light")};return o.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-primary/5 via-background to-primary/5",children:[o.jsx("header",{className:"absolute top-0 left-0 right-0 z-10",children:o.jsxs("div",{className:"flex items-center justify-between p-6",children:[o.jsxs(_t,{to:"/",className:"flex items-center space-x-2",children:[o.jsxs("svg",{className:"h-8 w-8 text-primary",viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[o.jsx("circle",{cx:"50",cy:"50",r:"45",stroke:"currentColor",strokeWidth:"2",fill:"none",opacity:"0.3"}),o.jsx("path",{d:"M50 20 L35 35 L50 50 L65 35 Z",fill:"currentColor"}),o.jsx("path",{d:"M35 35 L20 50 L35 65 L50 50 Z",fill:"currentColor",opacity:"0.8"}),o.jsx("path",{d:"M65 35 L80 50 L65 65 L50 50 Z",fill:"currentColor",opacity:"0.8"}),o.jsx("path",{d:"M35 65 L50 80 L65 65 L50 50 Z",fill:"currentColor",opacity:"0.6"}),o.jsx("circle",{cx:"50",cy:"35",r:"3",fill:"currentColor"}),o.jsx("circle",{cx:"35",cy:"50",r:"3",fill:"currentColor"}),o.jsx("circle",{cx:"65",cy:"50",r:"3",fill:"currentColor"}),o.jsx("circle",{cx:"50",cy:"65",r:"3",fill:"currentColor"})]}),o.jsx("span",{className:"text-xl font-bold text-foreground",children:t==="ar"?"":"Nasabna"})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(ye,{variant:"ghost",size:"icon",onClick:l,className:"h-9 w-9",children:n==="light"?o.jsx(ph,{className:"h-4 w-4"}):o.jsx(xh,{className:"h-4 w-4"})}),o.jsx(ye,{variant:"ghost",size:"icon",onClick:i,className:"h-9 w-9",children:o.jsx(jo,{className:"h-4 w-4"})})]})]})}),o.jsxs("div",{className:"flex min-h-screen",children:[o.jsx("div",{className:"hidden lg:flex lg:flex-1 lg:flex-col lg:justify-center lg:px-8",children:o.jsx("div",{className:"mx-auto max-w-md",children:o.jsxs("div",{className:"text-center",children:[o.jsxs("svg",{className:"mx-auto h-24 w-24 text-primary mb-8",viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[o.jsx("circle",{cx:"50",cy:"50",r:"45",stroke:"currentColor",strokeWidth:"2",fill:"none",opacity:"0.3"}),o.jsx("path",{d:"M50 20 L35 35 L50 50 L65 35 Z",fill:"currentColor"}),o.jsx("path",{d:"M35 35 L20 50 L35 65 L50 50 Z",fill:"currentColor",opacity:"0.8"}),o.jsx("path",{d:"M65 35 L80 50 L65 65 L50 50 Z",fill:"currentColor",opacity:"0.8"}),o.jsx("path",{d:"M35 65 L50 80 L65 65 L50 50 Z",fill:"currentColor",opacity:"0.6"}),o.jsx("circle",{cx:"50",cy:"35",r:"3",fill:"currentColor"}),o.jsx("circle",{cx:"35",cy:"50",r:"3",fill:"currentColor"}),o.jsx("circle",{cx:"65",cy:"50",r:"3",fill:"currentColor"}),o.jsx("circle",{cx:"50",cy:"65",r:"3",fill:"currentColor"})]}),o.jsx("h1",{className:"text-3xl font-bold text-foreground mb-4",children:t==="ar"?"":"Nasabna"}),o.jsx("p",{className:"text-lg text-muted-foreground mb-8",children:t==="ar"?"        ":"Discover your family history and build your genealogy with our comprehensive platform"}),o.jsxs("div",{className:"space-y-4 text-left",children:[o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"flex-shrink-0 w-2 h-2 bg-primary rounded-full"}),o.jsx("span",{className:"text-sm text-muted-foreground",children:t==="ar"?"   ":"Full Arabic language support"})]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"flex-shrink-0 w-2 h-2 bg-primary rounded-full"}),o.jsx("span",{className:"text-sm text-muted-foreground",children:t==="ar"?"  ":"Interactive family trees"})]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"flex-shrink-0 w-2 h-2 bg-primary rounded-full"}),o.jsx("span",{className:"text-sm text-muted-foreground",children:t==="ar"?"   ":"Secure family sharing"})]}),o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"flex-shrink-0 w-2 h-2 bg-primary rounded-full"}),o.jsx("span",{className:"text-sm text-muted-foreground",children:t==="ar"?"  ":"Photo and document storage"})]})]})]})})}),o.jsx("div",{className:"flex flex-1 flex-col justify-center px-6 py-12 lg:px-8",children:o.jsx("div",{className:"mx-auto w-full max-w-md",children:e})})]}),o.jsx("footer",{className:"absolute bottom-0 left-0 right-0 p-6",children:o.jsx("div",{className:"text-center",children:o.jsxs("p",{className:"text-xs text-muted-foreground",children:[" 2024 ",t==="ar"?"":"Nasabna",". ",t==="ar"?"  ":"All rights reserved","."]})})})]})},CH=e=>e&&typeof e=="object"&&("en"in e||"ar"in e),MI=()=>{const{language:e,showSuccess:t,showError:n,showWarning:r,showInfo:s}=Ft();return{success:(d,u)=>{t(d,u)},error:(d,u)=>{n(d,u)},warning:(d,u)=>{r(d,u)},info:(d,u)=>{s(d,u)}}},E_=(e,t)=>CH(e)?t==="ar"?e.ar:e.en:e,PH=({notification:e,onClose:t})=>{const{type:n,title:r,message:s,id:i,action:l}=e,{language:a}=Ft(),c=()=>E_(r,a),d=()=>E_(s,a),u=()=>{switch(n){case"success":return o.jsx(vi,{className:"h-5 w-5 text-green-500"});case"error":return o.jsx(Qs,{className:"h-5 w-5 text-red-500"});case"warning":return o.jsx(No,{className:"h-5 w-5 text-yellow-500"});case"info":return o.jsx(Wu,{className:"h-5 w-5 text-blue-500"});default:return null}},f=()=>{switch(n){case"success":return"bg-green-50 border-green-200";case"error":return"bg-red-50 border-red-200";case"warning":return"bg-yellow-50 border-yellow-200";case"info":return"bg-blue-50 border-blue-200";default:return"bg-white border-gray-200"}},m=()=>{switch(n){case"success":return"text-green-800";case"error":return"text-red-800";case"warning":return"text-yellow-800";case"info":return"text-blue-800";default:return"text-gray-800"}},h=()=>{switch(n){case"success":return"text-green-700";case"error":return"text-red-700";case"warning":return"text-yellow-700";case"info":return"text-blue-700";default:return"text-gray-700"}};return o.jsxs("div",{className:`flex items-start p-4 rounded-lg border shadow-lg max-w-sm w-full ${f()}`,role:"alert","aria-live":"assertive",dir:a==="ar"?"rtl":"ltr",children:[o.jsx("div",{className:"flex-shrink-0",children:u()}),o.jsxs("div",{className:"ml-3 flex-1",children:[o.jsx("h3",{className:`text-sm font-medium ${m()}`,children:c()}),d()&&o.jsx("div",{className:`mt-1 text-sm ${h()}`,children:o.jsx("p",{children:d()})}),l&&o.jsx("div",{className:"mt-3",children:o.jsx("button",{type:"button",onClick:l.onClick,className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded text-white bg-primary hover:bg-primary/90 focus:outline-none",children:l.label})})]}),o.jsx("div",{className:"ml-4 flex-shrink-0",children:o.jsx("button",{type:"button",className:"inline-flex rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2",onClick:()=>t(i),"aria-label":a==="ar"?"":"Close",children:o.jsx(ia,{className:"h-5 w-5 text-gray-400 hover:text-gray-500"})})})]})},IH=()=>{const{notifications:e,removeNotification:t}=Ft(),n=e.slice(-3);return o.jsx("div",{className:"fixed top-4 left-1/2 transform -translate-x-1/2 z-50 space-y-2 w-full px-4 flex flex-col items-center",style:{direction:"ltr"},children:n.map(r=>o.jsx(PH,{notification:r,onClose:t},r.id))})},df={},C_=5*60*1e3,P_={},TH=[{id:"basic",name:"Basic",price:{month:9.99,year:99.99},currency:"USD",features:{maxTrees:1,maxPeoplePerTree:5,maxPhotosPerPerson:0,maxDocumentsPerPerson:0,storage:1073741824,canShare:!0,canExport:!1,smartSuggestions:!1,prioritySupport:!1,customThemes:!1,advancedSearch:!1,collaborators:1},popular:!1},{id:"premium",name:"Premium",price:{month:19.99,year:199.99},currency:"USD",features:{maxTrees:3,maxPeoplePerTree:150,maxPhotosPerPerson:5,maxDocumentsPerPerson:0,storage:10737418240,canShare:!0,canExport:!0,smartSuggestions:!0,prioritySupport:!0,customThemes:!1,advancedSearch:!1,collaborators:5},popular:!0},{id:"family",name:"Family",price:{month:29.99,year:299.99},currency:"USD",features:{maxTrees:0,maxPeoplePerTree:0,maxPhotosPerPerson:20,maxDocumentsPerPerson:5,storage:53687091200,canShare:!0,canExport:!0,smartSuggestions:!0,prioritySupport:!0,customThemes:!0,advancedSearch:!0,collaborators:0},popular:!1}],E5={getSubscriptionPlans:async()=>(await new Promise(e=>setTimeout(e,500)),TH),subscribeToPlan:async(e,t,n="usd",r="year")=>{try{const s="https://qabael.premiumasp.net/api";let i="";r==="year"||t.includes("_year")?i=`${s}/Payments/CreateSubscription/`:i=`${s}/payments/OneTimePaid/`;const l=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e,currency:n,productId:t})});if(!l.ok)return console.warn("Subscription API not available, simulating success"),{url:"/subscription/success"};const a=await l.json();if(a.url){window.location.href=a.url;return}else if(a.Url){window.location.href=a.Url;return}if(a.clientSecret)return{clientSecret:a.clientSecret};throw new Error("Failed to create subscription")}catch(s){return console.warn("Subscription API error, simulating success:",s),{url:"/subscription/success"}}},getUserSubscriptionStatus:async e=>{if(!e||e==="unknown"||e.trim()==="")return console.warn("Invalid userId provided to getUserSubscriptionStatus:",e),{isActive:!1,planId:"basic",status:"inactive"};const t=P_[e]||0,n=Date.now();if(n-t<3e4){const s=df[e];return s&&n-s.timestamp<C_?s.data:{isActive:!1,planId:"basic",status:"inactive"}}P_[e]=n;const r=df[e];if(r&&n-r.timestamp<C_)return r.data;try{const i=await fetch(`https://qabael.premiumasp.net/api/payments/UserSubscriptionStatus/${e}`);if(!i.ok){const a={isActive:!1,planId:"basic",status:"inactive"};return df[e]={data:a,timestamp:n},a}const l=await i.json();return df[e]={data:l,timestamp:n},l}catch{const i={isActive:!1,planId:"basic",status:"inactive"};return df[e]={data:i,timestamp:n},i}},getCurrentSubscription:async e=>(await new Promise(t=>setTimeout(t,300)),null),getUsage:async()=>(await new Promise(e=>setTimeout(e,300)),{trees:0,members:0,photos:0,documents:0,storage:0})},fs=({children:e})=>{var T,S,E,_,M;const[t,n]=be.useState(!1),[r,s]=be.useState(!1),[i,l]=be.useState(null),[a,c]=be.useState(!1),d=e3(),u=jr(),{user:f,logout:m,updateUser:h}=Mr(),{language:g,theme:y,setLanguage:p,setTheme:x}=Ft(),b=!!f;J.useEffect(()=>{if(!f||!f.id&&!f.email&&!f.firstName)return;const A=f.id||f.email||f.firstName;if(!A||A==="unknown"||f!=null&&f.subscription)return;const P=setTimeout(()=>{(async()=>{c(!0);try{let L="unknown";if(f!=null&&f.id&&f.id!=="unknown"&&f.id.trim()!==""?L=f.id:f!=null&&f.email&&f.email.trim()!==""?L=f.email:f!=null&&f.firstName&&f.firstName.trim()!==""&&(L=f.firstName),!L||L==="unknown"||L.trim()===""){console.warn("Unable to fetch subscription status: No valid user identifier"),c(!1);return}const D=`subscription_${L}`,V=sessionStorage.getItem(D);if(V){const{timestamp:H,data:W}=JSON.parse(V);if(Date.now()-H<3e5){l(W),c(!1);return}}const O=await E5.getUserSubscriptionStatus(L);sessionStorage.setItem(D,JSON.stringify({timestamp:Date.now(),data:O})),O&&(l(O),O&&O.plan&&h({subscription:{id:O.id||"sub_"+Date.now(),plan:O.plan,status:O.status||"active",currentPeriodStart:O.currentPeriodStart||new Date().toISOString(),currentPeriodEnd:O.currentPeriodEnd||new Date(Date.now()+2592e6).toISOString(),cancelAtPeriodEnd:O.cancelAtPeriodEnd||!1,createdAt:O.createdAt||new Date().toISOString(),updatedAt:O.updatedAt||new Date().toISOString(),billing:{amount:0,currency:"usd",interval:"month"},features:{maxTrees:1,maxPeoplePerTree:5,maxPhotosPerPerson:0,maxDocumentsPerPerson:0,storage:1073741824,canShare:!0,canExport:!1,smartSuggestions:!1,prioritySupport:!1,customThemes:!1,advancedSearch:!1,collaborators:1},limits:{trees:1,people:5,photos:0,documents:0,storage:1073741824,collaborators:1},usage:{trees:0,people:0,photos:0,documents:0,storage:0,collaborators:0}}}))}catch(L){console.warn("Failed to fetch subscription status:",L)}finally{c(!1)}})()},1e3);return()=>clearTimeout(P)},[f,h]);const w=[{name:"Dashboard",nameAr:" ",href:"/dashboard",icon:m0},{name:"Family Trees",nameAr:" ",href:"/trees",icon:kn},{name:"Profile",nameAr:" ",href:"/profile",icon:Xt},{name:"Subscription",nameAr:"",href:"/subscription",icon:hh},{name:"Settings",nameAr:"",href:"/settings",icon:gh},...(f==null?void 0:f.role)==="admin"?[{name:"Admin Dashboard",nameAr:" ",href:"/admin/dashboard",icon:kn}]:[]],N=()=>{p(g==="en"?"ar":"en")},k=()=>{x(y==="light"?"dark":"light")},I=async()=>{try{await m(),u("/")}catch{}},R=A=>d.pathname===A||d.pathname.startsWith(A+"/");return be.useEffect(()=>{g==="ar"?document.documentElement.setAttribute("dir","rtl"):document.documentElement.setAttribute("dir","ltr")},[g]),be.useEffect(()=>{const A=()=>{window.innerWidth>=1024&&n(!1)};return window.addEventListener("resize",A),()=>window.removeEventListener("resize",A)},[]),be.useEffect(()=>{const A=P=>{if(r){const B=document.getElementById("profile-dropdown"),L=document.getElementById("profile-button");B&&L&&!B.contains(P.target)&&!L.contains(P.target)&&s(!1)}};return document.addEventListener("mousedown",A),()=>document.removeEventListener("mousedown",A)},[r]),b?o.jsxs("div",{className:"min-h-screen bg-background",children:[o.jsx(IH,{}),o.jsx("div",{className:`hidden lg:fixed lg:inset-y-0 lg:z-50 lg:flex lg:w-72 lg:flex-col ${g==="ar"?"lg:right-0":"lg:left-0"}`,children:o.jsxs("div",{className:"flex grow flex-col gap-y-5 overflow-y-auto bg-card border-border px-6 pb-4 lg:border-r",children:[o.jsx("div",{className:"flex h-16 shrink-0 items-center",children:o.jsxs(_t,{to:"/dashboard",className:`flex items-center ${g==="ar"?"space-x-reverse":"space-x-2"}`,children:[o.jsxs("svg",{className:"h-8 w-8 text-primary",viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[o.jsx("circle",{cx:"50",cy:"50",r:"45",stroke:"currentColor",strokeWidth:"2",fill:"none",opacity:"0.3"}),o.jsx("path",{d:"M50 20 L35 35 L50 50 L65 35 Z",fill:"currentColor"}),o.jsx("path",{d:"M35 35 L20 50 L35 65 L50 50 Z",fill:"currentColor",opacity:"0.8"}),o.jsx("path",{d:"M65 35 L80 50 L65 65 L50 50 Z",fill:"currentColor",opacity:"0.8"}),o.jsx("path",{d:"M35 65 L50 80 L65 65 L50 50 Z",fill:"currentColor",opacity:"0.6"}),o.jsx("circle",{cx:"50",cy:"35",r:"3",fill:"currentColor"}),o.jsx("circle",{cx:"35",cy:"50",r:"3",fill:"currentColor"}),o.jsx("circle",{cx:"65",cy:"50",r:"3",fill:"currentColor"}),o.jsx("circle",{cx:"50",cy:"65",r:"3",fill:"currentColor"})]}),o.jsx("span",{className:`text-lg font-semibold text-foreground ${g==="ar"?"rtl:text-right":""}`,children:g==="ar"?"":"Nasabna"})]})}),o.jsx("nav",{className:"flex flex-1 flex-col",children:o.jsxs("ul",{role:"list",className:"flex flex-1 flex-col gap-y-7",children:[o.jsx("li",{children:o.jsx("ul",{role:"list",className:"-mx-2 space-y-1",children:w.map(A=>o.jsx("li",{children:o.jsxs(_t,{to:A.href,className:`group flex items-center rounded-md p-2 text-sm leading-6 font-semibold transition-colors ${R(A.href)?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground hover:bg-muted"} ${g==="ar"?"flex-row-reverse":""}`,children:[o.jsx(A.icon,{className:"h-6 w-6 shrink-0","aria-hidden":"true"}),o.jsx("span",{className:`truncate ${g==="ar"?"mr-3":"ml-3"}`,children:g==="ar"?A.nameAr:A.name})]})},A.name))})}),o.jsxs("li",{children:[o.jsx("div",{className:"text-xs font-semibold leading-6 text-muted-foreground px-2 py-1",children:g==="ar"?"":"Subscription"}),o.jsx("ul",{role:"list",className:"-mx-2 space-y-1",children:a?o.jsx("li",{children:o.jsxs("div",{className:"group flex items-center rounded-md p-2 text-sm leading-6 font-semibold bg-muted",children:[o.jsx("div",{className:"h-4 w-4 rounded-full bg-muted animate-pulse mr-3"}),o.jsx("div",{className:"h-4 w-20 bg-muted rounded animate-pulse"})]})}):f!=null&&f.subscription||i?o.jsx("li",{children:o.jsxs("div",{className:"group flex items-center rounded-md p-2 text-sm leading-6 font-semibold bg-muted",children:[o.jsx(ng,{className:"h-5 w-5 shrink-0 text-green-500","aria-hidden":"true"}),o.jsxs("div",{className:"ml-3 flex-1 min-w-0",children:[o.jsx("div",{className:"truncate capitalize",children:((T=f==null?void 0:f.subscription)==null?void 0:T.plan)||(i==null?void 0:i.plan)||"basic"}),o.jsx("div",{className:"text-xs text-muted-foreground",children:((S=f==null?void 0:f.subscription)==null?void 0:S.status)==="active"||(i==null?void 0:i.status)==="active"?g==="ar"?"":"Active":g==="ar"?"":"Expired"})]})]})}):o.jsx("li",{children:o.jsxs(_t,{to:"/subscription",className:"group flex items-center rounded-md p-2 text-sm leading-6 font-semibold text-muted-foreground hover:text-foreground hover:bg-muted",children:[o.jsx(Qs,{className:"h-5 w-5 shrink-0","aria-hidden":"true"}),o.jsx("span",{className:"ml-3 truncate",children:g==="ar"?" ":"Subscribe Now"})]})})})]})]})})]})}),o.jsxs("div",{className:`${g==="ar"?"lg:pr-72":"lg:pl-72"}`,children:[o.jsxs("div",{className:"sticky top-0 z-40 flex h-16 shrink-0 items-center gap-x-4 border-b border-border bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 px-4 shadow-sm sm:gap-x-6 sm:px-6 lg:px-8",children:[o.jsxs("button",{type:"button",className:"-m-2.5 p-2.5 text-muted-foreground lg:hidden",onClick:()=>n(!0),children:[o.jsx("span",{className:"sr-only",children:"Open sidebar"}),o.jsx(PI,{className:"h-6 w-6","aria-hidden":"true"})]}),o.jsx("div",{className:"h-6 w-px bg-border lg:hidden","aria-hidden":"true"}),o.jsxs("div",{className:"flex flex-1 gap-x-4 self-stretch lg:gap-x-6",children:[o.jsx("div",{className:"flex flex-1"}),o.jsxs("div",{className:"flex items-center gap-x-4 lg:gap-x-6",children:[o.jsx(ye,{variant:"ghost",size:"icon",onClick:k,className:"h-9 w-9",children:y==="light"?o.jsx(ph,{className:"h-4 w-4"}):o.jsx(xh,{className:"h-4 w-4"})}),o.jsx(ye,{variant:"ghost",size:"icon",onClick:N,className:"h-9 w-9",children:o.jsx(jo,{className:"h-4 w-4"})}),o.jsx("div",{className:"hidden lg:block lg:h-6 lg:w-px lg:bg-border","aria-hidden":"true"}),o.jsxs("div",{className:"relative",children:[o.jsxs(ye,{id:"profile-button",variant:"ghost",className:"flex items-center space-x-2 rounded-full p-1 hover:bg-muted",onClick:()=>s(!r),children:[o.jsx("div",{className:"flex-shrink-0",children:(E=f==null?void 0:f.avatar)!=null&&E.url?o.jsx("img",{className:"h-8 w-8 rounded-full object-cover",src:f.avatar.url,alt:`${(f==null?void 0:f.firstName)||""} ${(f==null?void 0:f.lastName)||""}`}):o.jsx("div",{className:"h-8 w-8 rounded-full bg-primary/10 flex items-center justify-center",children:o.jsx(Xt,{className:"h-4 w-4 text-primary"})})}),o.jsxs("div",{className:"hidden lg:block text-left",children:[o.jsx("p",{className:"text-sm font-medium text-foreground",children:f!=null&&f.firstName?`${f.firstName} ${(f==null?void 0:f.lastName)||""}`.trim():(f==null?void 0:f.email)||"User"}),o.jsx("p",{className:"text-xs text-muted-foreground",children:(f==null?void 0:f.email)||""})]}),o.jsx(f0,{className:"hidden lg:block h-4 w-4 text-muted-foreground"})]}),r&&o.jsx("div",{id:"profile-dropdown",className:`absolute z-10 mt-2 w-56 origin-top-right rounded-md bg-card shadow-lg ring-1 ring-border focus:outline-none ${g==="ar"?"left-0":"right-0"}`,children:o.jsxs("div",{className:"p-1",children:[o.jsxs("div",{className:"px-4 py-2 border-b border-border",children:[o.jsx("p",{className:"text-sm font-medium text-foreground",children:f!=null&&f.firstName?`${f.firstName} ${(f==null?void 0:f.lastName)||""}`.trim():(f==null?void 0:f.email)||"User"}),o.jsx("p",{className:"text-xs text-muted-foreground",children:(f==null?void 0:f.email)||""})]}),o.jsx(_t,{to:"/profile",className:"block px-4 py-2 text-sm text-foreground hover:bg-muted rounded-md",onClick:()=>s(!1),children:g==="ar"?" ":"Profile"}),o.jsx(_t,{to:"/settings",className:"block px-4 py-2 text-sm text-foreground hover:bg-muted rounded-md",onClick:()=>s(!1),children:g==="ar"?"":"Settings"}),o.jsxs("button",{onClick:()=>{s(!1),I()},className:"w-full text-left px-4 py-2 text-sm text-foreground hover:bg-muted rounded-md flex items-center",children:[o.jsx(k5,{className:"mr-2 h-4 w-4"}),g==="ar"?" ":"Logout"]})]})})]})]})]})]}),o.jsx("main",{className:"py-6",children:o.jsx("div",{className:"px-4 sm:px-6 lg:px-8",children:e})})]}),t&&o.jsxs("div",{className:"lg:hidden fixed inset-0 z-50",children:[o.jsx("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm",onClick:()=>n(!1)}),o.jsx("div",{className:"fixed inset-0 flex",children:o.jsxs("div",{className:`relative flex w-full max-w-xs flex-1 ${g==="ar"?"ml-16":"mr-16"}`,children:[o.jsx("div",{className:`absolute top-0 flex w-16 justify-center pt-5 ${g==="ar"?"right-full":"left-full"}`,children:o.jsxs("button",{type:"button",className:"-m-2.5 p-2.5",onClick:()=>n(!1),children:[o.jsx("span",{className:"sr-only",children:"Close sidebar"}),o.jsx(ia,{className:"h-6 w-6 text-foreground","aria-hidden":"true"})]})}),o.jsxs("div",{className:"flex grow flex-col gap-y-5 overflow-y-auto bg-card px-6 pb-4 ring-1 ring-border/10",children:[o.jsx("div",{className:"flex h-16 shrink-0 items-center",children:o.jsxs(_t,{to:"/dashboard",className:`flex items-center ${g==="ar"?"space-x-reverse":"space-x-2"}`,onClick:()=>n(!1),children:[o.jsxs("svg",{className:"h-8 w-8 text-primary",viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[o.jsx("circle",{cx:"50",cy:"50",r:"45",stroke:"currentColor",strokeWidth:"2",fill:"none",opacity:"0.3"}),o.jsx("path",{d:"M50 20 L35 35 L50 50 L65 35 Z",fill:"currentColor"}),o.jsx("path",{d:"M35 35 L20 50 L35 65 L50 50 Z",fill:"currentColor",opacity:"0.8"}),o.jsx("path",{d:"M65 35 L80 50 L65 65 L50 50 Z",fill:"currentColor",opacity:"0.8"}),o.jsx("path",{d:"M35 65 L50 80 L65 65 L50 50 Z",fill:"currentColor",opacity:"0.6"}),o.jsx("circle",{cx:"50",cy:"35",r:"3",fill:"currentColor"}),o.jsx("circle",{cx:"35",cy:"50",r:"3",fill:"currentColor"}),o.jsx("circle",{cx:"65",cy:"50",r:"3",fill:"currentColor"}),o.jsx("circle",{cx:"50",cy:"65",r:"3",fill:"currentColor"})]}),o.jsx("span",{className:`text-lg font-semibold text-foreground ${g==="ar"?"rtl:text-right":""}`,children:g==="ar"?"":"Nasabna"})]})}),o.jsx("nav",{className:"flex flex-1 flex-col",children:o.jsxs("ul",{role:"list",className:"flex flex-1 flex-col gap-y-7",children:[o.jsx("li",{children:o.jsx("ul",{role:"list",className:"-mx-2 space-y-1",children:w.map(A=>o.jsx("li",{children:o.jsxs(_t,{to:A.href,className:`group flex items-center rounded-md p-2 text-sm leading-6 font-semibold transition-colors ${R(A.href)?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground hover:bg-muted"} ${g==="ar"?"flex-row-reverse":""}`,onClick:()=>n(!1),children:[o.jsx(A.icon,{className:"h-6 w-6 shrink-0","aria-hidden":"true"}),o.jsx("span",{className:`truncate ${g==="ar"?"mr-3":"ml-3"}`,children:g==="ar"?A.nameAr:A.name})]})},A.name))})}),o.jsxs("li",{children:[o.jsx("div",{className:"text-xs font-semibold leading-6 text-muted-foreground px-2 py-1",children:g==="ar"?"":"Subscription"}),o.jsx("ul",{role:"list",className:"-mx-2 space-y-1",children:a?o.jsx("li",{children:o.jsxs("div",{className:"group flex items-center rounded-md p-2 text-sm leading-6 font-semibold bg-muted",children:[o.jsx("div",{className:"h-4 w-4 rounded-full bg-muted animate-pulse mr-3"}),o.jsx("div",{className:"h-4 w-20 bg-muted rounded animate-pulse"})]})}):f!=null&&f.subscription||i?o.jsx("li",{children:o.jsxs("div",{className:"group flex items-center rounded-md p-2 text-sm leading-6 font-semibold bg-muted",children:[o.jsx(ng,{className:"h-5 w-5 shrink-0 text-green-500","aria-hidden":"true"}),o.jsxs("div",{className:"ml-3 flex-1 min-w-0",children:[o.jsx("div",{className:"truncate capitalize",children:((_=f==null?void 0:f.subscription)==null?void 0:_.plan)||(i==null?void 0:i.plan)||"basic"}),o.jsx("div",{className:"text-xs text-muted-foreground",children:((M=f==null?void 0:f.subscription)==null?void 0:M.status)==="active"||(i==null?void 0:i.status)==="active"?g==="ar"?"":"Active":g==="ar"?"":"Expired"})]})]})}):o.jsx("li",{children:o.jsxs(_t,{to:"/subscription",className:"group flex items-center rounded-md p-2 text-sm leading-6 font-semibold text-muted-foreground hover:text-foreground hover:bg-muted",onClick:()=>n(!1),children:[o.jsx(Qs,{className:"h-5 w-5 shrink-0","aria-hidden":"true"}),o.jsx("span",{className:"ml-3 truncate",children:g==="ar"?" ":"Subscribe Now"})]})})})]})]})})]})]})})]})]}):o.jsx("div",{className:"min-h-screen bg-background",children:o.jsxs("div",{className:`${g==="ar"?"lg:pr-72":"lg:pl-72"}`,children:[o.jsxs("div",{className:"sticky top-0 z-40 flex h-16 shrink-0 items-center gap-x-4 border-b border-border bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 px-4 shadow-sm sm:gap-x-6 sm:px-6 lg:px-8",children:[o.jsx("div",{className:"flex flex-1"}),o.jsx("div",{className:"flex items-center gap-x-4 lg:gap-x-6",children:o.jsx("div",{className:"relative",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx("div",{className:"h-8 w-8 rounded-full bg-muted animate-pulse"})}),o.jsxs("div",{className:"hidden lg:block",children:[o.jsx("div",{className:"h-4 w-20 bg-muted rounded animate-pulse mb-1"}),o.jsx("div",{className:"h-3 w-16 bg-muted rounded animate-pulse"})]})]})})})]}),o.jsx("main",{className:"py-6",children:o.jsx("div",{className:"px-4 sm:px-6 lg:px-8",children:e})})]})})},LH=()=>{const{language:e}=Ft(),t=e==="ar",n={product:[{name:"Features",nameAr:"",href:"/features"},{name:"Pricing",nameAr:"",href:"/pricing"}],company:[{name:"About",nameAr:"",href:"/about"},{name:"Contact",nameAr:" ",href:"/contact"}],legal:[{name:"Privacy",nameAr:"",href:"/privacy"},{name:"Terms",nameAr:"",href:"/terms"}]};return o.jsx("footer",{className:"bg-muted border-t",children:o.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-8",children:[o.jsxs("div",{className:"lg:col-span-2",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(qn,{className:"h-8 w-8 text-primary"}),o.jsx("span",{className:"ml-2 text-xl font-bold",children:t?"":"Nasabna"})]}),o.jsx("p",{className:"mt-4 text-muted-foreground max-w-md",children:t?"      .       .":"A comprehensive platform for building, exploring, and sharing family trees. Connect with your roots and preserve your family's story for future generations."}),o.jsxs("div",{className:"flex space-x-4 mt-6",children:[o.jsx("a",{href:"#",className:"text-muted-foreground hover:text-foreground transition-colors",children:o.jsx(oH,{className:"h-5 w-5"})}),o.jsx("a",{href:"#",className:"text-muted-foreground hover:text-foreground transition-colors",children:o.jsx(NH,{className:"h-5 w-5"})}),o.jsx("a",{href:"#",className:"text-muted-foreground hover:text-foreground transition-colors",children:o.jsx(dH,{className:"h-5 w-5"})}),o.jsx("a",{href:"#",className:"text-muted-foreground hover:text-foreground transition-colors",children:o.jsx(hH,{className:"h-5 w-5"})})]})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-semibold uppercase tracking-wider",children:t?"":"Product"}),o.jsx("ul",{className:"mt-4 space-y-2",children:n.product.map(r=>o.jsx("li",{children:o.jsx(_t,{to:r.href,className:"text-sm font-semibold leading-6 text-muted-foreground hover:text-foreground transition-colors",children:t?r.nameAr:r.name})},r.name))})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-semibold uppercase tracking-wider",children:t?"":"Company"}),o.jsx("ul",{className:"mt-4 space-y-2",children:n.company.map(r=>o.jsx("li",{children:o.jsx(_t,{to:r.href,className:"text-sm font-semibold leading-6 text-muted-foreground hover:text-foreground transition-colors",children:t?r.nameAr:r.name})},r.name))})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-sm font-semibold uppercase tracking-wider",children:t?"":"Legal"}),o.jsx("ul",{className:"mt-4 space-y-2",children:n.legal.map(r=>o.jsx("li",{children:o.jsx(_t,{to:r.href,className:"text-sm font-semibold leading-6 text-muted-foreground hover:text-foreground transition-colors",children:t?r.nameAr:r.name})},r.name))})]})]}),o.jsxs("div",{className:"mt-12 pt-8 border-t border-muted-foreground/20 flex flex-col md:flex-row justify-between items-center",children:[o.jsxs("p",{className:"text-muted-foreground",children:[" ",new Date().getFullYear()," ",t?"":"Nasabna",". ",t?"  .":"All rights reserved."]}),o.jsxs("div",{className:"mt-4 md:mt-0 flex space-x-6",children:[o.jsxs("div",{className:"flex items-center text-muted-foreground hover:text-foreground transition-colors",children:[o.jsx(Ra,{className:"h-4 w-4 mr-2"}),o.jsx("span",{children:"support@nasabna.com"})]}),o.jsxs("div",{className:"flex items-center text-muted-foreground hover:text-foreground transition-colors",children:[o.jsx(Gu,{className:"h-4 w-4 mr-2"}),o.jsx("span",{children:"+1 (555) 123-4567"})]})]})]})]})})},Ko=({children:e})=>{const[t,n]=be.useState(!1),{language:r,theme:s,setLanguage:i,setTheme:l}=Ft(),{isAuthenticated:a,logout:c}=Mr(),d=jr(),u=[{name:"Home",nameAr:"",href:"/"},{name:"Features",nameAr:"",href:"/features"},{name:"Pricing",nameAr:"",href:"/pricing"},{name:"About",nameAr:" ",href:"/about"},...a?[{name:"Dashboard",nameAr:" ",href:"/dashboard"}]:[]],f=()=>{i(r==="en"?"ar":"en")},m=()=>{l(s==="light"?"dark":"light")},h=async()=>{try{await c(),d("/")}catch(g){console.error("Logout failed:",g)}};return be.useEffect(()=>{const g=()=>{window.innerWidth>=1024&&n(!1)};return window.addEventListener("resize",g),()=>window.removeEventListener("resize",g)},[]),o.jsxs("div",{className:"min-h-screen bg-background",children:[o.jsx("header",{className:"bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 sticky top-0 z-40 w-full border-b border-border/40",children:o.jsxs("nav",{className:"mx-auto flex max-w-7xl items-center justify-between p-6 lg:px-8","aria-label":"Global",children:[o.jsx("div",{className:"flex lg:flex-1",children:o.jsxs(_t,{to:"/",className:"-m-1.5 p-1.5",children:[o.jsx("span",{className:"sr-only",children:r==="ar"?"":"Nasabna"}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsxs("svg",{className:"h-8 w-8 text-primary",viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[o.jsx("circle",{cx:"50",cy:"50",r:"45",stroke:"currentColor",strokeWidth:"2",fill:"none",opacity:"0.3"}),o.jsx("path",{d:"M50 20 L35 35 L50 50 L65 35 Z",fill:"currentColor"}),o.jsx("path",{d:"M35 35 L20 50 L35 65 L50 50 Z",fill:"currentColor",opacity:"0.8"}),o.jsx("path",{d:"M65 35 L80 50 L65 65 L50 50 Z",fill:"currentColor",opacity:"0.8"}),o.jsx("path",{d:"M35 65 L50 80 L65 65 L50 50 Z",fill:"currentColor",opacity:"0.6"}),o.jsx("circle",{cx:"50",cy:"35",r:"3",fill:"currentColor"}),o.jsx("circle",{cx:"35",cy:"50",r:"3",fill:"currentColor"}),o.jsx("circle",{cx:"65",cy:"50",r:"3",fill:"currentColor"}),o.jsx("circle",{cx:"50",cy:"65",r:"3",fill:"currentColor"})]}),o.jsx("span",{className:"text-xl font-bold text-foreground",children:r==="ar"?"":"Nasabna"})]})]})}),o.jsx("div",{className:"flex lg:hidden",children:o.jsxs("button",{type:"button",className:"-m-2.5 inline-flex items-center justify-center rounded-md p-2.5 text-muted-foreground",onClick:()=>n(!0),children:[o.jsx("span",{className:"sr-only",children:"Open main menu"}),o.jsx(PI,{className:"h-6 w-6","aria-hidden":"true"})]})}),o.jsx("div",{className:"hidden lg:flex lg:gap-x-12",children:u.map(g=>o.jsx(_t,{to:g.href,className:"text-sm font-semibold leading-6 text-muted-foreground hover:text-foreground transition-colors",children:r==="ar"?g.nameAr:g.name},g.name))}),o.jsxs("div",{className:"hidden lg:flex lg:flex-1 lg:justify-end lg:items-center lg:space-x-4",children:[o.jsx(ye,{variant:"ghost",size:"icon",onClick:m,className:"h-9 w-9",children:s==="light"?o.jsx(ph,{className:"h-4 w-4"}):o.jsx(xh,{className:"h-4 w-4"})}),o.jsx(ye,{variant:"ghost",size:"icon",onClick:f,className:"h-9 w-9",children:o.jsx(jo,{className:"h-4 w-4"})}),a?o.jsxs(ye,{variant:"ghost",onClick:h,className:"flex items-center",children:[o.jsx(k5,{className:"h-4 w-4 mr-2"}),r==="ar"?" ":"Logout"]}):o.jsxs(o.Fragment,{children:[o.jsx(ye,{asChild:!0,variant:"ghost",children:o.jsx(_t,{to:"/login",children:r==="ar"?" ":"Sign In"})}),o.jsx(ye,{asChild:!0,children:o.jsx(_t,{to:"/register",children:r==="ar"?" ":"Get Started"})})]})]})]})}),t&&o.jsxs("div",{className:"lg:hidden fixed inset-0 z-50",children:[o.jsx("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm",onClick:()=>n(!1)}),o.jsxs("div",{className:"fixed inset-y-0 right-0 z-50 w-full overflow-y-auto bg-background px-6 py-6 sm:max-w-sm sm:ring-1 sm:ring-border/10",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs(_t,{to:"/",className:"-m-1.5 p-1.5",onClick:()=>n(!1),children:[o.jsx("span",{className:"sr-only",children:r==="ar"?"":"Nasabna"}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsxs("svg",{className:"h-8 w-8 text-primary",viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[o.jsx("circle",{cx:"50",cy:"50",r:"45",stroke:"currentColor",strokeWidth:"2",fill:"none",opacity:"0.3"}),o.jsx("path",{d:"M50 20 L35 35 L50 50 L65 35 Z",fill:"currentColor"}),o.jsx("path",{d:"M35 35 L20 50 L35 65 L50 50 Z",fill:"currentColor",opacity:"0.8"}),o.jsx("path",{d:"M65 35 L80 50 L65 65 L50 50 Z",fill:"currentColor",opacity:"0.8"}),o.jsx("path",{d:"M35 65 L50 80 L65 65 L50 50 Z",fill:"currentColor",opacity:"0.6"}),o.jsx("circle",{cx:"50",cy:"35",r:"3",fill:"currentColor"}),o.jsx("circle",{cx:"35",cy:"50",r:"3",fill:"currentColor"}),o.jsx("circle",{cx:"65",cy:"50",r:"3",fill:"currentColor"}),o.jsx("circle",{cx:"50",cy:"65",r:"3",fill:"currentColor"})]}),o.jsx("span",{className:"text-xl font-bold text-foreground",children:r==="ar"?"":"Nasabna"})]})]}),o.jsxs("button",{type:"button",className:"-m-2.5 rounded-md p-2.5 text-muted-foreground",onClick:()=>n(!1),children:[o.jsx("span",{className:"sr-only",children:"Close menu"}),o.jsx(ia,{className:"h-6 w-6","aria-hidden":"true"})]})]}),o.jsx("div",{className:"mt-6 flow-root",children:o.jsxs("div",{className:"-my-6 divide-y divide-border/10",children:[o.jsx("div",{className:"space-y-2 py-6",children:u.map(g=>o.jsx(_t,{to:g.href,className:"-mx-3 block rounded-lg px-3 py-2 text-base font-semibold leading-7 text-foreground hover:bg-muted",onClick:()=>n(!1),children:r==="ar"?g.nameAr:g.name},g.name))}),o.jsxs("div",{className:"py-6 space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm font-medium",children:"Theme"}),o.jsx(ye,{variant:"ghost",size:"icon",onClick:g=>{g.stopPropagation(),m()},className:"h-9 w-9",children:s==="light"?o.jsx(ph,{className:"h-4 w-4"}):o.jsx(xh,{className:"h-4 w-4"})})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("span",{className:"text-sm font-medium",children:"Language"}),o.jsx(ye,{variant:"ghost",size:"icon",onClick:g=>{g.stopPropagation(),f()},className:"h-9 w-9",children:o.jsx(jo,{className:"h-4 w-4"})})]}),o.jsx("div",{className:"space-y-2",children:a?o.jsxs(ye,{variant:"outline",className:"w-full",onClick:()=>{n(!1),h()},children:[o.jsx(k5,{className:"h-4 w-4 mr-2"}),r==="ar"?" ":"Logout"]}):o.jsxs(o.Fragment,{children:[o.jsx(ye,{asChild:!0,variant:"outline",className:"w-full",onClick:()=>n(!1),children:o.jsx(_t,{to:"/login",children:r==="ar"?" ":"Sign In"})}),o.jsx(ye,{asChild:!0,className:"w-full",onClick:()=>n(!1),children:o.jsx(_t,{to:"/register",children:r==="ar"?" ":"Get Started"})})]})})]})]})})]})]}),o.jsx("main",{children:e}),o.jsx(LH,{})]})},MH=(e=10)=>{const t=J.useRef(null),n=J.useRef(null),{logout:r}=Mr(),s=jr(),i=()=>{t.current&&clearTimeout(t.current),n.current&&clearTimeout(n.current);const l=e*60*1e3-60*1e3;n.current=setTimeout(()=>{window.dispatchEvent(new CustomEvent("inactivity-warning"))},l),t.current=setTimeout(async()=>{try{await r(),s("/login")}catch{s("/login")}},e*60*1e3)};return J.useEffect(()=>{const l=["mousedown","mousemove","keypress","scroll","touchstart","click"],a=()=>{i()};return l.forEach(c=>{window.addEventListener(c,a,{passive:!0})}),i(),()=>{t.current&&clearTimeout(t.current),n.current&&clearTimeout(n.current),l.forEach(c=>{window.removeEventListener(c,a)})}},[e]),{resetLogoutTimer:i}},I_=({children:e})=>{const{user:t,isAuthenticated:n}=Mr();return MH(10),n?(t==null?void 0:t.role)!=="admin"?o.jsx(uh,{to:"/dashboard",replace:!0}):o.jsx(o.Fragment,{children:e}):o.jsx(uh,{to:"/login",replace:!0})},RH=e=>{var t,n;if(e.code==="ERR_NETWORK"||(t=e.message)!=null&&t.includes("Network Error"))return{message:"Network connection error. Please check your internet connection.",code:"NETWORK_ERROR"};if(e.code==="ECONNABORTED"||(n=e.message)!=null&&n.includes("timeout"))return{message:"Request timeout. Please try again.",code:"TIMEOUT_ERROR"};if(e.response){const r=e.response.status,s=e.response.data;switch(r){case 400:return{message:(s==null?void 0:s.message)||"Invalid request. Please check your input.",status:r,code:"BAD_REQUEST"};case 401:return{message:"Authentication required. Please log in.",status:r,code:"UNAUTHORIZED"};case 403:return{message:"Access denied. You don't have permission for this action.",status:r,code:"FORBIDDEN"};case 404:return{message:"Resource not found.",status:r,code:"NOT_FOUND"};case 429:return{message:"Too many requests. Please wait before trying again.",status:r,code:"RATE_LIMITED"};case 500:return{message:"Server error. Please try again later.",status:r,code:"SERVER_ERROR"};case 502:case 503:case 504:return{message:"Service temporarily unavailable. Please try again later.",status:r,code:"SERVICE_UNAVAILABLE"};default:return{message:(s==null?void 0:s.message)||`HTTP Error ${r}`,status:r,code:"HTTP_ERROR"}}}return{message:e.message||"An unexpected error occurred.",code:"UNKNOWN_ERROR"}},$H=e=>!["NOT_FOUND"].includes(e.code||""),At={getTrees:async()=>{try{return await en.getTrees()||[]}catch(e){throw e}},getPublicTrees:async()=>{try{return await en.getAllPublicTrees()||[]}catch(e){const t=RH(e);if(t.code==="NOT_FOUND")return console.warn("Public trees endpoint not available, returning empty array"),[];if($H(t))throw new Error(t.message);return[]}},createTree:async(e,t,n)=>{try{return(await en.addTree(e,t,n)).data}catch(r){throw r}},getTreeById:async e=>{try{return await en.getTreeById(e)}catch(t){throw t}},updateTree:async(e,t,n,r)=>{try{if(!e||e<=0)throw new Error("Invalid tree ID");if(!t||t.trim()==="")throw new Error("Tree name is required");return(await en.updateTree(e,t.trim(),n,(r==null?void 0:r.trim())||"")).data}catch(s){throw s.response?s.response.status===403?new Error("You do not have permission to edit this tree"):new Error(`Failed to update tree: ${JSON.stringify(s.response.data)}`):new Error("Failed to update tree: "+(s.message||"Unknown error"))}},deleteTree:async e=>{try{await en.deleteTree(e)}catch(t){throw t}},uploadTreePhoto:async(e,t)=>{try{const n=new FormData;return n.append("picture",t),n.append("FamilyTreeId",e.toString()),(await en.uploadTreePhoto(n)).data}catch(n){throw n}},deleteTreePhoto:async e=>{try{await en.deleteTreePhoto(e)}catch(t){throw t}},getPersonsInTree:async e=>{try{return await en.getPersonsInTree(e)||[]}catch(t){throw t}},addPersonToTree:async(e,t,n,r,s,i,l,a)=>{try{const c=await en.addPerson(e,t,n,r,s,i,l,a);return en.clearPersonsInTreeCache(),c.data}catch(c){throw c.response,c}},updatePerson:async(e,t,n,r,s,i,l)=>{try{const a=await en.updatePerson(e,t,n,r,s,i,l);if(!a)throw new Error("No response from server");if(!a.data)throw new Error("No data in response");return en.clearPersonsInTreeCache(),a.data}catch(a){throw a.response?a.response.status===403?new Error("You do not have permission to edit this person"):new Error(`Failed to update person: ${JSON.stringify(a.response.data)}`):new Error("Failed to update person: "+(a.message||"Unknown error"))}},getPersonById:async e=>{var t;try{const n=await en.getPersonById(e);if(n)return typeof n=="object"&&(n.hasOwnProperty("id")||n.hasOwnProperty("firstName")||n.hasOwnProperty("lastName"))?n:n.hasOwnProperty("data")?n.data:n;throw new Error("Empty response from API")}catch(n){if(((t=n.response)==null?void 0:t.status)===404)try{const s=(await At.getAllPersons()).find(i=>i.id&&(parseInt(i.id.toString())===e||i.id.toString()===e.toString()));if(s)return s}catch{}throw n.response?new Error(`API Error: ${n.response.status} - ${JSON.stringify(n.response.data)}`):new Error(`Network Error: ${n.message||"Unknown error"}`)}},deletePerson:async e=>{var t,n;try{await en.deletePerson(e),en.clearPersonsInTreeCache()}catch(r){if(r.response){const s=((t=r.response.data)==null?void 0:t.message)||((n=r.response.data)==null?void 0:n.error)||JSON.stringify(r.response.data);throw new Error(`Server error: ${r.response.status} - ${s||"Unknown server error"}`)}else throw r.request?new Error("Network error: No response received from server. Please check your internet connection and try again."):new Error(`Request setup error: ${r.message}`)}},uploadPersonPhoto:async(e,t)=>{try{const n=new FormData;return n.append("picture",t),n.append("PersonId",e.toString()),(await en.uploadPersonPicture(n)).data}catch(n){throw n}},deletePersonPhoto:async e=>{try{await en.deletePersonPicture(e)}catch(t){throw t}},addRelationship:async(e,t,n)=>{try{return await en.addRelationship(e,t,n)}catch(r){throw r}},getRelationships:async()=>{try{return await en.getRelationships()||[]}catch(e){throw e}},deleteRelationship:async e=>{try{await en.deleteRelationship(e)}catch(t){throw t}},getAllPersons:async()=>{try{const e=await At.getTrees(),t=[];for(const n of e)try{const r=await At.getPersonsInTree(parseInt(n.id));t.push(...r)}catch{}return t}catch(e){throw e}},searchPersons:async e=>{try{const t=await At.getAllPersons();if(!e)return t;const n=e.toLowerCase();return t.filter(r=>r.firstName&&r.firstName.toLowerCase().includes(n)||r.lastName&&r.lastName.toLowerCase().includes(n)||r.fullName&&r.fullName.toLowerCase().includes(n))}catch(t){throw t}},searchTrees:async e=>{try{const t=await At.getTrees(),n=await At.getPublicTrees(),r=new Map;t.forEach(l=>{r.has(l.id.toString())||r.set(l.id.toString(),l)}),n.forEach(l=>{r.has(l.id.toString())||r.set(l.id.toString(),l)});const s=Array.from(r.values());if(!e)return s;const i=e.toLowerCase();return s.filter(l=>l.name&&l.name.toLowerCase().includes(i)||l.description&&l.description.toLowerCase().includes(i))}catch(t){throw t}},createJoinRequest:async(e,t,n,r,s,i,l,a,c,d)=>{var u,f;try{return await en.createJoinRequest(e,t,n,r,s,i,l,a,c,d)}catch(m){if(m.response){const h=((u=m.response.data)==null?void 0:u.message)||((f=m.response.data)==null?void 0:f.error)||JSON.stringify(m.response.data);throw new Error(`Server error: ${m.response.status} - ${h||"Unknown server error"}`)}else throw m.request?new Error("Network error: No response received from server. Please check your internet connection and try again."):new Error(`Request setup error: ${m.message}`)}},getIncomingJoinRequests:async e=>{try{const t=await en.getJoinRequestsByTree(e);let n=[];return Array.isArray(t)?n=t:t&&t.data&&Array.isArray(t.data)?n=t.data:t&&typeof t=="object"&&(Array.isArray(t.requests)?n=t.requests:t.id&&(n=[t])),n}catch{return[]}},getOutgoingJoinRequests:async e=>{try{return[]}catch{return[]}},acceptJoinRequest:async e=>{try{return await en.acceptJoinRequest(e)}catch(t){throw new Error(`Failed to accept join request: ${t.message}`)}},rejectJoinRequest:async e=>{try{return await en.rejectJoinRequest(e)}catch(t){throw new Error(`Failed to reject join request: ${t.message}`)}}},rx=50,sx=(e,t)=>e.length<=t?e:e.slice(-t);let ff=null,hf=null;const Bm={},As=r3()(YP(s3((e,t)=>({trees:[],publicTrees:[],currentTree:null,currentPerson:null,isLoading:!1,error:null,fetchTrees:async()=>ff||(ff=(async()=>{e({isLoading:!0,error:null});try{const n=await At.getTrees(),r=t().trees,s=n.map(l=>{var c,d,u,f,m,h,g,y,p,x,b,w;const a=r.find(N=>N.id===l.id.toString());return{...l,id:l.id.toString(),ownerId:l.ownerId||(l.owner?l.owner.id:void 0),userRole:l.userRole||"owner",category:l.category||"family",tags:l.tags||[],settings:{isPublic:((c=l.settings)==null?void 0:c.isPublic)!==void 0?l.settings.isPublic:!l.isPrivate,theme:((d=l.settings)==null?void 0:d.theme)||"default",layout:((u=l.settings)==null?void 0:u.layout)||"vertical",showPhotos:((f=l.settings)==null?void 0:f.showPhotos)!==void 0?l.settings.showPhotos:!0,showDates:((m=l.settings)==null?void 0:m.showDates)!==void 0?l.settings.showDates:!0,showPlaces:((h=l.settings)==null?void 0:h.showPlaces)!==void 0?l.settings.showPlaces:!0,allowComments:((g=l.settings)==null?void 0:g.allowComments)!==void 0?l.settings.allowComments:!0,allowSuggestions:((y=l.settings)==null?void 0:y.allowSuggestions)!==void 0?l.settings.allowSuggestions:!0},sharing:l.sharing||{isShared:l.members&&l.members.length>0||!1,allowedUsers:[],shareToken:void 0,publicUrl:void 0},stats:{totalPeople:((p=l.members)==null?void 0:p.length)||0,totalGenerations:((x=a==null?void 0:a.stats)==null?void 0:x.totalGenerations)!==void 0?a.stats.totalGenerations:((b=l.stats)==null?void 0:b.totalGenerations)||0,totalPhotos:((w=l.stats)==null?void 0:w.totalPhotos)||0,completionPercentage:l.members&&l.members.length>0?50:0},createdAt:l.createdAt||new Date().toISOString(),updatedAt:l.updatedAt||new Date().toISOString()}}),i=sx(s,rx);e({trees:i,isLoading:!1})}catch(n){throw e({error:n.message||"Failed to fetch trees",isLoading:!1}),n}finally{ff=null}})(),ff),fetchPublicTrees:async()=>hf||(hf=(async()=>{var n,r;e({isLoading:!0,error:null});try{const s=await At.getPublicTrees(),i=t().publicTrees,l=s.map(c=>{var u,f,m,h,g,y,p,x,b,w,N,k;const d=i.find(I=>I.id===c.id.toString());return{...c,id:c.id.toString(),ownerId:c.ownerId||(c.owner?c.owner.id:void 0),userRole:c.userRole||"viewer",category:c.category||"family",tags:c.tags||[],settings:{isPublic:((u=c.settings)==null?void 0:u.isPublic)!==void 0?c.settings.isPublic:!c.isPrivate,theme:((f=c.settings)==null?void 0:f.theme)||"default",layout:((m=c.settings)==null?void 0:m.layout)||"vertical",showPhotos:((h=c.settings)==null?void 0:h.showPhotos)!==void 0?c.settings.showPhotos:!0,showDates:((g=c.settings)==null?void 0:g.showDates)!==void 0?c.settings.showDates:!0,showPlaces:((y=c.settings)==null?void 0:y.showPlaces)!==void 0?c.settings.showPlaces:!0,allowComments:((p=c.settings)==null?void 0:p.allowComments)!==void 0?c.settings.allowComments:!0,allowSuggestions:((x=c.settings)==null?void 0:x.allowSuggestions)!==void 0?c.settings.allowSuggestions:!0},sharing:c.sharing||{isShared:!0,allowedUsers:[],shareToken:void 0,publicUrl:void 0},stats:{totalPeople:((b=c.members)==null?void 0:b.length)||0,totalGenerations:((w=d==null?void 0:d.stats)==null?void 0:w.totalGenerations)!==void 0?d.stats.totalGenerations:((N=c.stats)==null?void 0:N.totalGenerations)||0,totalPhotos:((k=c.stats)==null?void 0:k.totalPhotos)||0,completionPercentage:c.members&&c.members.length>0?50:0},createdAt:c.createdAt||new Date().toISOString(),updatedAt:c.updatedAt||new Date().toISOString()}}),a=sx(l,rx);e({publicTrees:a,isLoading:!1})}catch(s){if(((n=s.response)==null?void 0:n.status)===404){e({publicTrees:[],isLoading:!1,error:null}),console.warn("Public trees endpoint not found, using empty array");return}const i=((r=s.response)==null?void 0:r.status)===500?"Server temporarily unavailable. Please try again later.":s.message||"Failed to fetch public trees";e({publicTrees:[],isLoading:!1,error:i}),console.error("Error fetching public trees:",s)}finally{hf=null}})(),hf),createTree:async n=>{var r,s,i,l,a,c,d,u,f,m,h,g;e({isLoading:!0,error:null});try{const y=await At.createTree(n.name||"Untitled Tree",((r=n.settings)==null?void 0:r.isPublic)!==void 0?!n.settings.isPublic:!0,n.description||""),p={...y,id:y.id.toString(),ownerId:y.ownerId||(y.owner?y.owner.id:void 0),userRole:"owner",category:y.category||"family",tags:y.tags||[],settings:{isPublic:((s=y.settings)==null?void 0:s.isPublic)!==void 0?y.settings.isPublic:!y.isPrivate,theme:((i=y.settings)==null?void 0:i.theme)||"default",layout:((l=y.settings)==null?void 0:l.layout)||"vertical",showPhotos:((a=y.settings)==null?void 0:a.showPhotos)!==void 0?y.settings.showPhotos:!0,showDates:((c=y.settings)==null?void 0:c.showDates)!==void 0?y.settings.showDates:!0,showPlaces:((d=y.settings)==null?void 0:d.showPlaces)!==void 0?y.settings.showPlaces:!0,allowComments:((u=y.settings)==null?void 0:u.allowComments)!==void 0?y.settings.allowComments:!0,allowSuggestions:((f=y.settings)==null?void 0:f.allowSuggestions)!==void 0?y.settings.allowSuggestions:!0},sharing:y.sharing||{isShared:y.members&&y.members.length>0||!1,allowedUsers:[],shareToken:void 0,publicUrl:void 0},stats:{totalPeople:((m=y.members)==null?void 0:m.length)||0,totalGenerations:((h=y.stats)==null?void 0:h.totalGenerations)!==void 0?y.stats.totalGenerations:0,totalPhotos:((g=y.stats)==null?void 0:g.totalPhotos)!==void 0?y.stats.totalPhotos:0,completionPercentage:y.members&&y.members.length>0?50:0},createdAt:y.createdAt||new Date().toISOString(),updatedAt:y.updatedAt||new Date().toISOString()};return e(x=>({trees:sx([...x.trees,p],rx),isLoading:!1})),p}catch(y){throw e({error:y.message||"Failed to create tree",isLoading:!1}),y}},updateTree:async(n,r)=>{var s;e({isLoading:!0,error:null});try{const i=await At.updateTree(parseInt(n),r.name||"",r.isPrivate!==void 0?r.isPrivate:((s=r.settings)==null?void 0:s.isPublic)!==void 0?!r.settings.isPublic:!0,r.description||"");return e(l=>{var a,c,d,u,f,m,h,g,y,p,x,b,w,N,k,I,R,T,S,E,_,M,A,P,B,L,D,V;return{trees:l.trees.map(O=>{var H,W,$,z,q,G,re,oe,ie,Y,te,we,me,Ee,pe,ee,ft,$e,De,ge,Me,_e,ke,se,Ae,Re,Ce;return O.id===n?{...O,...i,id:((H=i.id)==null?void 0:H.toString())||n,category:i.category||O.category||"family",tags:i.tags||O.tags||[],settings:{...O.settings,...i.settings,isPublic:i.isPrivate!==void 0?!i.isPrivate:((W=O.settings)==null?void 0:W.isPublic)!==void 0?O.settings.isPublic:!0,theme:(($=i.settings)==null?void 0:$.theme)||((z=O.settings)==null?void 0:z.theme)||"default",layout:((q=i.settings)==null?void 0:q.layout)||((G=O.settings)==null?void 0:G.layout)||"vertical",showPhotos:((re=i.settings)==null?void 0:re.showPhotos)!==void 0?i.settings.showPhotos:((oe=O.settings)==null?void 0:oe.showPhotos)!==void 0?O.settings.showPhotos:!0,showDates:((ie=i.settings)==null?void 0:ie.showDates)!==void 0?i.settings.showDates:((Y=O.settings)==null?void 0:Y.showDates)!==void 0?O.settings.showDates:!0,showPlaces:((te=i.settings)==null?void 0:te.showPlaces)!==void 0?i.settings.showPlaces:((we=O.settings)==null?void 0:we.showPlaces)!==void 0?O.settings.showPlaces:!0,allowComments:((me=i.settings)==null?void 0:me.allowComments)!==void 0?i.settings.allowComments:((Ee=O.settings)==null?void 0:Ee.allowComments)!==void 0?O.settings.allowComments:!0,allowSuggestions:((pe=i.settings)==null?void 0:pe.allowSuggestions)!==void 0?i.settings.allowSuggestions:((ee=O.settings)==null?void 0:ee.allowSuggestions)!==void 0?O.settings.allowSuggestions:!0},sharing:{...O.sharing,...i.sharing,isShared:((ft=i.sharing)==null?void 0:ft.isShared)||i.members&&i.members.length>0||(($e=O.sharing)==null?void 0:$e.isShared)||!1,allowedUsers:((De=i.sharing)==null?void 0:De.allowedUsers)||((ge=O.sharing)==null?void 0:ge.allowedUsers)||[]},stats:{...O.stats,...i.stats,totalPeople:((Me=i.members)==null?void 0:Me.length)||((_e=O.stats)==null?void 0:_e.totalPeople)||0,totalGenerations:((ke=O.stats)==null?void 0:ke.totalGenerations)||((se=i.stats)==null?void 0:se.totalGenerations)||0,totalPhotos:((Ae=O.stats)==null?void 0:Ae.totalPhotos)||((Re=i.stats)==null?void 0:Re.totalPhotos)||0,completionPercentage:i.members&&i.members.length>0?50:((Ce=O.stats)==null?void 0:Ce.completionPercentage)||0},createdAt:i.createdAt||O.createdAt||new Date().toISOString(),updatedAt:i.updatedAt||new Date().toISOString()}:O}),currentTree:((a=l.currentTree)==null?void 0:a.id)===n?{...l.currentTree,...i,id:((c=i.id)==null?void 0:c.toString())||n,category:i.category||l.currentTree.category||"family",tags:i.tags||l.currentTree.tags||[],settings:{...l.currentTree.settings,...i.settings,isPublic:i.isPrivate!==void 0?!i.isPrivate:((d=l.currentTree.settings)==null?void 0:d.isPublic)!==void 0?l.currentTree.settings.isPublic:!0,theme:((u=i.settings)==null?void 0:u.theme)||((f=l.currentTree.settings)==null?void 0:f.theme)||"default",layout:((m=i.settings)==null?void 0:m.layout)||((h=l.currentTree.settings)==null?void 0:h.layout)||"vertical",showPhotos:((g=i.settings)==null?void 0:g.showPhotos)!==void 0?i.settings.showPhotos:((y=l.currentTree.settings)==null?void 0:y.showPhotos)!==void 0?l.currentTree.settings.showPhotos:!0,showDates:((p=i.settings)==null?void 0:p.showDates)!==void 0?i.settings.showDates:((x=l.currentTree.settings)==null?void 0:x.showDates)!==void 0?l.currentTree.settings.showDates:!0,showPlaces:((b=i.settings)==null?void 0:b.showPlaces)!==void 0?i.settings.showPlaces:((w=l.currentTree.settings)==null?void 0:w.showPlaces)!==void 0?l.currentTree.settings.showPlaces:!0,allowComments:((N=i.settings)==null?void 0:N.allowComments)!==void 0?i.settings.allowComments:((k=l.currentTree.settings)==null?void 0:k.allowComments)!==void 0?l.currentTree.settings.allowComments:!0,allowSuggestions:((I=i.settings)==null?void 0:I.allowSuggestions)!==void 0?i.settings.allowSuggestions:((R=l.currentTree.settings)==null?void 0:R.allowSuggestions)!==void 0?l.currentTree.settings.allowSuggestions:!0},sharing:{...l.currentTree.sharing,...i.sharing,isShared:((T=i.sharing)==null?void 0:T.isShared)||i.members&&i.members.length>0||((S=l.currentTree.sharing)==null?void 0:S.isShared)||!1,allowedUsers:((E=i.sharing)==null?void 0:E.allowedUsers)||((_=l.currentTree.sharing)==null?void 0:_.allowedUsers)||[]},stats:{...l.currentTree.stats,...i.stats,totalPeople:((M=i.members)==null?void 0:M.length)||((A=l.currentTree.stats)==null?void 0:A.totalPeople)||0,totalGenerations:((P=l.currentTree.stats)==null?void 0:P.totalGenerations)||((B=i.stats)==null?void 0:B.totalGenerations)||0,totalPhotos:((L=l.currentTree.stats)==null?void 0:L.totalPhotos)||((D=i.stats)==null?void 0:D.totalPhotos)||0,completionPercentage:i.members&&i.members.length>0?50:((V=l.currentTree.stats)==null?void 0:V.completionPercentage)||0},createdAt:i.createdAt||l.currentTree.createdAt||new Date().toISOString(),updatedAt:i.updatedAt||new Date().toISOString()}:l.currentTree,isLoading:!1}}),i}catch(i){throw e({error:i.message||"Failed to update tree",isLoading:!1}),i}},deleteTree:async n=>{e({isLoading:!0,error:null});try{await At.deleteTree(parseInt(n)),e(r=>{var s;return{trees:r.trees.filter(i=>i.id!==n),currentTree:((s=r.currentTree)==null?void 0:s.id)===n?null:r.currentTree,isLoading:!1}})}catch(r){throw e({error:r.message||"Failed to delete tree",isLoading:!1}),r}},setCurrentTree:n=>{e({currentTree:n})},setCurrentPerson:n=>{e({currentPerson:n})},fetchPersonsInTree:async n=>{const r=n.toString();if(Bm[r])return Bm[r];const s=(async()=>{e({isLoading:!0,error:null});try{const i=await At.getPersonsInTree(parseInt(n));try{const l=await At.getRelationships()}catch{}return e({isLoading:!1}),i}catch(i){throw e({error:i.message||"Failed to fetch persons",isLoading:!1}),i}finally{delete Bm[r]}})();return Bm[r]=s,s},addPersonToTree:async n=>{var r,s,i,l,a,c;e({isLoading:!0,error:null});try{const d=await At.addPersonToTree(n.firstName||"",((r=n.birth)==null?void 0:r.date)||"",((i=(s=n.birth)==null?void 0:s.place)==null?void 0:i.city)||"",((a=(l=n.occupation)==null?void 0:l[0])==null?void 0:a.title)||"",n.gender||"unknown",((c=n.death)==null?void 0:c.date)||"",n.isDeceased||!1,parseInt(n.tree||"0"));return e(u=>({trees:u.trees.map(m=>{var h;return m.id===n.tree?{...m,stats:{...m.stats,totalPeople:(((h=m.stats)==null?void 0:h.totalPeople)||0)+1}}:m}),isLoading:!1})),d}catch(d){throw e({error:d.message||"Failed to add person",isLoading:!1}),d}},updatePerson:async(n,r)=>{var s,i,l,a,c;e({isLoading:!0,error:null});try{const d=await At.updatePerson(parseInt(n),r.firstName||"",((s=r.birth)==null?void 0:s.date)||"",((l=(i=r.birth)==null?void 0:i.place)==null?void 0:l.city)||"",((c=(a=r.occupation)==null?void 0:a[0])==null?void 0:c.title)||"",r.gender||"unknown",parseInt(r.tree||"0"));return e({isLoading:!1}),d}catch(d){throw e({error:d.message||"Failed to update person",isLoading:!1}),d}},deletePerson:async n=>{e({isLoading:!0,error:null});try{await At.deletePerson(parseInt(n)),e({isLoading:!1})}catch(r){throw e({error:r.message||"Failed to delete person",isLoading:!1}),r}},addRelationship:async(n,r,s)=>{e({isLoading:!0,error:null});try{const i=await At.addRelationship(parseInt(n),parseInt(r),s);return e({isLoading:!1}),i}catch(i){throw e({error:i.message||"Failed to add relationship",isLoading:!1}),i}},deleteRelationship:async n=>{e({isLoading:!0,error:null});try{await At.deleteRelationship(parseInt(n)),e({isLoading:!1})}catch(r){throw e({error:r.message||"Failed to delete relationship",isLoading:!1}),r}},getRelationships:async()=>{e({isLoading:!0,error:null});try{const n=await At.getRelationships();return e({isLoading:!1}),n}catch(n){throw e({error:n.message||"Failed to fetch relationships",isLoading:!1}),n}},uploadTreePhoto:async(n,r)=>{e({isLoading:!0,error:null});try{const s=await At.uploadTreePhoto(parseInt(n),r);return e({isLoading:!1}),s}catch(s){throw e({error:s.message||"Failed to upload tree photo",isLoading:!1}),s}},uploadPersonPhoto:async(n,r)=>{e({isLoading:!0,error:null});try{const s=await At.uploadPersonPhoto(parseInt(n),r);return e({isLoading:!1}),s}catch(s){throw e({error:s.message||"Failed to upload person photo",isLoading:!1}),s}},updateTreeGenerations:(n,r)=>{e(s=>{var i;return{trees:s.trees.map(l=>l.id===n?{...l,stats:{...l.stats,totalGenerations:r}}:l),currentTree:((i=s.currentTree)==null?void 0:i.id)===n?{...s.currentTree,stats:{...s.currentTree.stats,totalGenerations:r}}:s.currentTree}})}}),{name:"tree-storage",partialize:e=>({trees:e.trees,publicTrees:e.publicTrees})}),{name:"tree-store"})),et=({className:e,children:t,...n})=>o.jsx("div",{className:wi("rounded-lg border bg-card text-card-foreground shadow-sm",e),...n,children:t}),ht=({className:e,children:t,...n})=>o.jsx("div",{className:wi("flex flex-col space-y-1.5 p-6",e),...n,children:t}),gt=({className:e,children:t,...n})=>o.jsx("h3",{className:wi("text-2xl font-semibold leading-none tracking-tight",e),...n,children:t}),qr=({className:e,children:t,...n})=>o.jsx("p",{className:wi("text-sm text-muted-foreground",e),...n,children:t}),rt=({className:e,children:t,...n})=>o.jsx("div",{className:wi("p-6 pt-0",e),...n,children:t}),OH="/assets/hero-C8KRVFcu.jpg",RI="/assets/aboutimg-D4G8moL-.png";var FH="6.7.0";function Br(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function x0(e){let t=e,n=e;e.length===1&&(t=(l,a)=>e(l)-a,n=DH(e));function r(l,a,c,d){for(c==null&&(c=0),d==null&&(d=l.length);c<d;){const u=c+d>>>1;n(l[u],a)<0?c=u+1:d=u}return c}function s(l,a,c,d){for(c==null&&(c=0),d==null&&(d=l.length);c<d;){const u=c+d>>>1;n(l[u],a)>0?d=u:c=u+1}return c}function i(l,a,c,d){c==null&&(c=0),d==null&&(d=l.length);const u=r(l,a,c,d-1);return u>c&&t(l[u-1],a)>-t(l[u],a)?u-1:u}return{left:r,center:i,right:s}}function DH(e){return(t,n)=>Br(e(t),n)}function $I(e){return e===null?NaN:+e}function*qH(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)(r=t(r,++n,e))!=null&&(r=+r)>=r&&(yield r)}}const OI=x0(Br),pl=OI.right,BH=OI.left,zH=x0($I).center;function y0(e,t){let n=0;if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&++n;else{let r=-1;for(let s of e)(s=t(s,++r,e))!=null&&(s=+s)>=s&&++n}return n}function UH(e){return e.length|0}function HH(e){return!(e>0)}function VH(e){return typeof e!="object"||"length"in e?e:Array.from(e)}function WH(e){return t=>e(...t)}function GH(...e){const t=typeof e[e.length-1]=="function"&&WH(e.pop());e=e.map(VH);const n=e.map(UH),r=e.length-1,s=new Array(r+1).fill(0),i=[];if(r<0||n.some(HH))return i;for(;;){i.push(s.map((a,c)=>e[c][a]));let l=r;for(;++s[l]===n[l];){if(l===0)return t?i.map(t):i;s[l--]=0}}}function YH(e,t){var n=0,r=0;return Float64Array.from(e,t===void 0?s=>n+=+s||0:s=>n+=+t(s,r++,e)||0)}function XH(e,t){return t<e?-1:t>e?1:t>=e?0:NaN}function FI(e,t){let n=0,r,s=0,i=0;if(t===void 0)for(let l of e)l!=null&&(l=+l)>=l&&(r=l-s,s+=r/++n,i+=r*(l-s));else{let l=-1;for(let a of e)(a=t(a,++l,e))!=null&&(a=+a)>=a&&(r=a-s,s+=r/++n,i+=r*(a-s))}if(n>1)return i/(n-1)}function DI(e,t){const n=FI(e,t);return n&&Math.sqrt(n)}function nh(e,t){let n,r;if(t===void 0)for(const s of e)s!=null&&(n===void 0?s>=s&&(n=r=s):(n>s&&(n=s),r<s&&(r=s)));else{let s=-1;for(let i of e)(i=t(i,++s,e))!=null&&(n===void 0?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)))}return[n,r]}class Zr{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let s=0;s<this._n&&s<32;s++){const i=n[s],l=t+i,a=Math.abs(t)<Math.abs(i)?t-(l-i):i-(l-t);a&&(n[r++]=a),t=l}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,s,i,l=0;if(n>0){for(l=t[--n];n>0&&(r=l,s=t[--n],l=r+s,i=s-(l-r),!i););n>0&&(i<0&&t[n-1]<0||i>0&&t[n-1]>0)&&(s=i*2,r=l+s,s==r-l&&(l=r))}return l}}function KH(e,t){const n=new Zr;if(t===void 0)for(let r of e)(r=+r)&&n.add(r);else{let r=-1;for(let s of e)(s=+t(s,++r,e))&&n.add(s)}return+n}function JH(e,t){const n=new Zr;let r=-1;return Float64Array.from(e,t===void 0?s=>n.add(+s||0):s=>n.add(+t(s,++r,e)||0))}class qI extends Map{constructor(t,n=UI){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,s]of t)this.set(r,s)}get(t){return super.get(C5(this,t))}has(t){return super.has(C5(this,t))}set(t,n){return super.set(BI(this,t),n)}delete(t){return super.delete(zI(this,t))}}class ZH extends Set{constructor(t,n=UI){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const r of t)this.add(r)}has(t){return super.has(C5(this,t))}add(t){return super.add(BI(this,t))}delete(t){return super.delete(zI(this,t))}}function C5({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function BI({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function zI({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(n),e.delete(r)),n}function UI(e){return e!==null&&typeof e=="object"?e.valueOf():e}function Ku(e){return e}function HI(e,...t){return vd(e,Ku,Ku,t)}function QH(e,...t){return vd(e,Array.from,Ku,t)}function VI(e,t,...n){return vd(e,Ku,t,n)}function eV(e,t,...n){return vd(e,Array.from,t,n)}function tV(e,...t){return vd(e,Ku,WI,t)}function nV(e,...t){return vd(e,Array.from,WI,t)}function WI(e){if(e.length!==1)throw new Error("duplicate key");return e[0]}function vd(e,t,n,r){return function s(i,l){if(l>=r.length)return n(i);const a=new qI,c=r[l++];let d=-1;for(const u of i){const f=c(u,++d,i),m=a.get(f);m?m.push(u):a.set(f,[u])}for(const[u,f]of a)a.set(u,s(f,l));return t(a)}(e,0)}function GI(e,t){return Array.from(t,n=>e[n])}function P5(e,...t){if(typeof e[Symbol.iterator]!="function")throw new TypeError("values is not iterable");e=Array.from(e);let[n=Br]=t;if(n.length===1||t.length>1){const r=Uint32Array.from(e,(s,i)=>i);return t.length>1?(t=t.map(s=>e.map(s)),r.sort((s,i)=>{for(const l of t){const a=Br(l[s],l[i]);if(a)return a}})):(n=e.map(n),r.sort((s,i)=>Br(n[s],n[i]))),GI(e,r)}return e.sort(n)}function rV(e,t,n){return(t.length===1?P5(VI(e,t,n),([r,s],[i,l])=>Br(s,l)||Br(r,i)):P5(HI(e,n),([r,s],[i,l])=>t(s,l)||Br(r,i))).map(([r])=>r)}var sV=Array.prototype,iV=sV.slice;function zm(e){return function(){return e}}var I5=Math.sqrt(50),T5=Math.sqrt(10),L5=Math.sqrt(2);function yh(e,t,n){var r,s=-1,i,l,a;if(t=+t,e=+e,n=+n,e===t&&n>0)return[e];if((r=t<e)&&(i=e,e=t,t=i),(a=Xh(e,t,n))===0||!isFinite(a))return[];if(a>0){let c=Math.round(e/a),d=Math.round(t/a);for(c*a<e&&++c,d*a>t&&--d,l=new Array(i=d-c+1);++s<i;)l[s]=(c+s)*a}else{a=-a;let c=Math.round(e*a),d=Math.round(t*a);for(c/a<e&&++c,d/a>t&&--d,l=new Array(i=d-c+1);++s<i;)l[s]=(c+s)/a}return r&&l.reverse(),l}function Xh(e,t,n){var r=(t-e)/Math.max(0,n),s=Math.floor(Math.log(r)/Math.LN10),i=r/Math.pow(10,s);return s>=0?(i>=I5?10:i>=T5?5:i>=L5?2:1)*Math.pow(10,s):-Math.pow(10,-s)/(i>=I5?10:i>=T5?5:i>=L5?2:1)}function Ju(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),s=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),i=r/s;return i>=I5?s*=10:i>=T5?s*=5:i>=L5&&(s*=2),t<e?-s:s}function YI(e,t,n){let r;for(;;){const s=Xh(e,t,n);if(s===r||s===0||!isFinite(s))return[e,t];s>0?(e=Math.floor(e/s)*s,t=Math.ceil(t/s)*s):s<0&&(e=Math.ceil(e*s)/s,t=Math.floor(t*s)/s),r=s}}function d3(e){return Math.ceil(Math.log(y0(e))/Math.LN2)+1}function T_(){var e=Ku,t=nh,n=d3;function r(s){Array.isArray(s)||(s=Array.from(s));var i,l=s.length,a,c=new Array(l);for(i=0;i<l;++i)c[i]=e(s[i],i,s);var d=t(c),u=d[0],f=d[1],m=n(c,u,f);if(!Array.isArray(m)){const p=f,x=+m;if(t===nh&&([u,f]=YI(u,f,x)),m=yh(u,f,x),m[m.length-1]>=f)if(p>=f&&t===nh){const b=Xh(u,f,x);isFinite(b)&&(b>0?f=(Math.floor(f/b)+1)*b:b<0&&(f=(Math.ceil(f*-b)+1)/-b))}else m.pop()}for(var h=m.length;m[0]<=u;)m.shift(),--h;for(;m[h-1]>f;)m.pop(),--h;var g=new Array(h+1),y;for(i=0;i<=h;++i)y=g[i]=[],y.x0=i>0?m[i-1]:u,y.x1=i<h?m[i]:f;for(i=0;i<l;++i)a=c[i],u<=a&&a<=f&&g[pl(m,a,0,h)].push(s[i]);return g}return r.value=function(s){return arguments.length?(e=typeof s=="function"?s:zm(s),r):e},r.domain=function(s){return arguments.length?(t=typeof s=="function"?s:zm([s[0],s[1]]),r):t},r.thresholds=function(s){return arguments.length?(n=typeof s=="function"?s:Array.isArray(s)?zm(iV.call(s)):zm(s),r):n},r}function ig(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let s of e)(s=t(s,++r,e))!=null&&(n<s||n===void 0&&s>=s)&&(n=s)}return n}function ag(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let s of e)(s=t(s,++r,e))!=null&&(n>s||n===void 0&&s>=s)&&(n=s)}return n}function f3(e,t,n=0,r=e.length-1,s=Br){for(;r>n;){if(r-n>600){const c=r-n+1,d=t-n+1,u=Math.log(c),f=.5*Math.exp(2*u/3),m=.5*Math.sqrt(u*f*(c-f)/c)*(d-c/2<0?-1:1),h=Math.max(n,Math.floor(t-d*f/c+m)),g=Math.min(r,Math.floor(t+(c-d)*f/c+m));f3(e,t,h,g,s)}const i=e[t];let l=n,a=r;for(mf(e,n,t),s(e[r],i)>0&&mf(e,n,r);l<a;){for(mf(e,l,a),++l,--a;s(e[l],i)<0;)++l;for(;s(e[a],i)>0;)--a}s(e[n],i)===0?mf(e,n,a):(++a,mf(e,a,r)),a<=t&&(n=a+1),t<=a&&(r=a-1)}return e}function mf(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function vh(e,t,n){if(e=Float64Array.from(qH(e,n)),!!(r=e.length)){if((t=+t)<=0||r<2)return ag(e);if(t>=1)return ig(e);var r,s=(r-1)*t,i=Math.floor(s),l=ig(f3(e,i).subarray(0,i+1)),a=ag(e.subarray(i+1));return l+(a-l)*(s-i)}}function XI(e,t,n=$I){if(r=e.length){if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,s=(r-1)*t,i=Math.floor(s),l=+n(e[i],i,e),a=+n(e[i+1],i+1,e);return l+(a-l)*(s-i)}}function aV(e,t,n){return Math.ceil((n-t)/(2*(vh(e,.75)-vh(e,.25))*Math.pow(y0(e),-1/3)))}function oV(e,t,n){return Math.ceil((n-t)/(3.5*DI(e)*Math.pow(y0(e),-1/3)))}function KI(e,t){let n,r=-1,s=-1;if(t===void 0)for(const i of e)++s,i!=null&&(n<i||n===void 0&&i>=i)&&(n=i,r=s);else for(let i of e)(i=t(i,++s,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i,r=s);return r}function lV(e,t){let n=0,r=0;if(t===void 0)for(let s of e)s!=null&&(s=+s)>=s&&(++n,r+=s);else{let s=-1;for(let i of e)(i=t(i,++s,e))!=null&&(i=+i)>=i&&(++n,r+=i)}if(n)return r/n}function cV(e,t){return vh(e,.5,t)}function*uV(e){for(const t of e)yield*t}function h3(e){return Array.from(uV(e))}function JI(e,t){let n,r=-1,s=-1;if(t===void 0)for(const i of e)++s,i!=null&&(n>i||n===void 0&&i>=i)&&(n=i,r=s);else for(let i of e)(i=t(i,++s,e))!=null&&(n>i||n===void 0&&i>=i)&&(n=i,r=s);return r}function dV(e,t=fV){const n=[];let r,s=!1;for(const i of e)s&&n.push(t(r,i)),r=i,s=!0;return n}function fV(e,t){return[e,t]}function Pa(e,t,n){e=+e,t=+t,n=(s=arguments.length)<2?(t=e,e=0,1):s<3?1:+n;for(var r=-1,s=Math.max(0,Math.ceil((t-e)/n))|0,i=new Array(s);++r<s;)i[r]=e+r*n;return i}function hV(e,t=Br){let n,r=!1;if(t.length===1){let s;for(const i of e){const l=t(i);(r?Br(l,s)<0:Br(l,l)===0)&&(n=i,s=l,r=!0)}}else for(const s of e)(r?t(s,n)<0:t(s,s)===0)&&(n=s,r=!0);return n}function ZI(e,t=Br){if(t.length===1)return JI(e,t);let n,r=-1,s=-1;for(const i of e)++s,(r<0?t(i,i)===0:t(i,n)<0)&&(n=i,r=s);return r}function mV(e,t=Br){let n,r=!1;if(t.length===1){let s;for(const i of e){const l=t(i);(r?Br(l,s)>0:Br(l,l)===0)&&(n=i,s=l,r=!0)}}else for(const s of e)(r?t(s,n)>0:t(s,s)===0)&&(n=s,r=!0);return n}function pV(e,t=Br){if(t.length===1)return KI(e,t);let n,r=-1,s=-1;for(const i of e)++s,(r<0?t(i,i)===0:t(i,n)>0)&&(n=i,r=s);return r}function gV(e,t){const n=ZI(e,t);return n<0?void 0:n}const xV=QI(Math.random);function QI(e){return function(n,r=0,s=n.length){let i=s-(r=+r);for(;i;){const l=e()*i--|0,a=n[i+r];n[i+r]=n[l+r],n[l+r]=a}return n}}function yV(e,t){let n=0;if(t===void 0)for(let r of e)(r=+r)&&(n+=r);else{let r=-1;for(let s of e)(s=+t(s,++r,e))&&(n+=s)}return n}function eT(e){if(!(i=e.length))return[];for(var t=-1,n=ag(e,vV),r=new Array(n);++t<n;)for(var s=-1,i,l=r[t]=new Array(i);++s<i;)l[s]=e[s][t];return r}function vV(e){return e.length}function bV(){return eT(arguments)}function wV(e,t){if(typeof t!="function")throw new TypeError("test is not a function");let n=-1;for(const r of e)if(!t(r,++n,e))return!1;return!0}function NV(e,t){if(typeof t!="function")throw new TypeError("test is not a function");let n=-1;for(const r of e)if(t(r,++n,e))return!0;return!1}function jV(e,t){if(typeof t!="function")throw new TypeError("test is not a function");const n=[];let r=-1;for(const s of e)t(s,++r,e)&&n.push(s);return n}function _V(e,t){if(typeof e[Symbol.iterator]!="function")throw new TypeError("values is not iterable");if(typeof t!="function")throw new TypeError("mapper is not a function");return Array.from(e,(n,r)=>t(n,r,e))}function SV(e,t,n){if(typeof t!="function")throw new TypeError("reducer is not a function");const r=e[Symbol.iterator]();let s,i,l=-1;if(arguments.length<3){if({done:s,value:n}=r.next(),s)return;++l}for(;{done:s,value:i}=r.next(),!s;)n=t(n,i,++l,e);return n}function AV(e){if(typeof e[Symbol.iterator]!="function")throw new TypeError("values is not iterable");return Array.from(e).reverse()}function kV(e,...t){e=new Set(e);for(const n of t)for(const r of n)e.delete(r);return e}function EV(e,t){const n=t[Symbol.iterator](),r=new Set;for(const s of e){if(r.has(s))return!1;let i,l;for(;({value:i,done:l}=n.next())&&!l;){if(Object.is(s,i))return!1;r.add(i)}}return!0}function CV(e){return e instanceof Set?e:new Set(e)}function PV(e,...t){e=new Set(e),t=t.map(CV);e:for(const n of e)for(const r of t)if(!r.has(n)){e.delete(n);continue e}return e}function tT(e,t){const n=e[Symbol.iterator](),r=new Set;for(const s of t){if(r.has(s))continue;let i,l;for(;{value:i,done:l}=n.next();){if(l)return!1;if(r.add(i),Object.is(s,i))break}}return!0}function IV(e,t){return tT(t,e)}function TV(...e){const t=new Set;for(const n of e)for(const r of n)t.add(r);return t}var ix=Array.prototype.slice;function LV(e){return e}var Mp=1,Rp=2,M5=3,Lf=4,L_=1e-6;function MV(e){return"translate("+e+",0)"}function RV(e){return"translate(0,"+e+")"}function $V(e){return t=>+e(t)}function OV(e,t){return t=Math.max(0,e.bandwidth()-t*2)/2,e.round()&&(t=Math.round(t)),n=>+e(n)+t}function FV(){return!this.__axis}function v0(e,t){var n=[],r=null,s=null,i=6,l=6,a=3,c=typeof window<"u"&&window.devicePixelRatio>1?0:.5,d=e===Mp||e===Lf?-1:1,u=e===Lf||e===Rp?"x":"y",f=e===Mp||e===M5?MV:RV;function m(h){var g=r??(t.ticks?t.ticks.apply(t,n):t.domain()),y=s??(t.tickFormat?t.tickFormat.apply(t,n):LV),p=Math.max(i,0)+a,x=t.range(),b=+x[0]+c,w=+x[x.length-1]+c,N=(t.bandwidth?OV:$V)(t.copy(),c),k=h.selection?h.selection():h,I=k.selectAll(".domain").data([null]),R=k.selectAll(".tick").data(g,t).order(),T=R.exit(),S=R.enter().append("g").attr("class","tick"),E=R.select("line"),_=R.select("text");I=I.merge(I.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),R=R.merge(S),E=E.merge(S.append("line").attr("stroke","currentColor").attr(u+"2",d*i)),_=_.merge(S.append("text").attr("fill","currentColor").attr(u,d*p).attr("dy",e===Mp?"0em":e===M5?"0.71em":"0.32em")),h!==k&&(I=I.transition(h),R=R.transition(h),E=E.transition(h),_=_.transition(h),T=T.transition(h).attr("opacity",L_).attr("transform",function(M){return isFinite(M=N(M))?f(M+c):this.getAttribute("transform")}),S.attr("opacity",L_).attr("transform",function(M){var A=this.parentNode.__axis;return f((A&&isFinite(A=A(M))?A:N(M))+c)})),T.remove(),I.attr("d",e===Lf||e===Rp?l?"M"+d*l+","+b+"H"+c+"V"+w+"H"+d*l:"M"+c+","+b+"V"+w:l?"M"+b+","+d*l+"V"+c+"H"+w+"V"+d*l:"M"+b+","+c+"H"+w),R.attr("opacity",1).attr("transform",function(M){return f(N(M)+c)}),E.attr(u+"2",d*i),_.attr(u,d*p).text(y),k.filter(FV).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",e===Rp?"start":e===Lf?"end":"middle"),k.each(function(){this.__axis=N})}return m.scale=function(h){return arguments.length?(t=h,m):t},m.ticks=function(){return n=ix.call(arguments),m},m.tickArguments=function(h){return arguments.length?(n=h==null?[]:ix.call(h),m):n.slice()},m.tickValues=function(h){return arguments.length?(r=h==null?null:ix.call(h),m):r&&r.slice()},m.tickFormat=function(h){return arguments.length?(s=h,m):s},m.tickSize=function(h){return arguments.length?(i=l=+h,m):i},m.tickSizeInner=function(h){return arguments.length?(i=+h,m):i},m.tickSizeOuter=function(h){return arguments.length?(l=+h,m):l},m.tickPadding=function(h){return arguments.length?(a=+h,m):a},m.offset=function(h){return arguments.length?(c=+h,m):c},m}function DV(e){return v0(Mp,e)}function qV(e){return v0(Rp,e)}function BV(e){return v0(M5,e)}function zV(e){return v0(Lf,e)}var UV={value:()=>{}};function Pc(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new $p(n)}function $p(e){this._=e}function HV(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",s=n.indexOf(".");if(s>=0&&(r=n.slice(s+1),n=n.slice(0,s)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}$p.prototype=Pc.prototype={constructor:$p,on:function(e,t){var n=this._,r=HV(e+"",n),s,i=-1,l=r.length;if(arguments.length<2){for(;++i<l;)if((s=(e=r[i]).type)&&(s=VV(n[s],e.name)))return s;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<l;)if(s=(e=r[i]).type)n[s]=M_(n[s],e.name,t);else if(t==null)for(s in n)n[s]=M_(n[s],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new $p(e)},call:function(e,t){if((s=arguments.length-2)>0)for(var n=new Array(s),r=0,s,i;r<s;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],r=0,s=i.length;r<s;++r)i[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],s=0,i=r.length;s<i;++s)r[s].value.apply(t,n)}};function VV(e,t){for(var n=0,r=e.length,s;n<r;++n)if((s=e[n]).name===t)return s.value}function M_(e,t,n){for(var r=0,s=e.length;r<s;++r)if(e[r].name===t){e[r]=UV,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var R5="http://www.w3.org/1999/xhtml";const $5={svg:"http://www.w3.org/2000/svg",xhtml:R5,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Kh(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),$5.hasOwnProperty(t)?{space:$5[t],local:e}:e}function WV(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===R5&&t.documentElement.namespaceURI===R5?t.createElement(e):t.createElementNS(n,e)}}function GV(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function b0(e){var t=Kh(e);return(t.local?GV:WV)(t)}function YV(){}function w0(e){return e==null?YV:function(){return this.querySelector(e)}}function XV(e){typeof e!="function"&&(e=w0(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var i=t[s],l=i.length,a=r[s]=new Array(l),c,d,u=0;u<l;++u)(c=i[u])&&(d=e.call(c,c.__data__,u,i))&&("__data__"in c&&(d.__data__=c.__data__),a[u]=d);return new Cs(r,this._parents)}function m3(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function KV(){return[]}function p3(e){return e==null?KV:function(){return this.querySelectorAll(e)}}function JV(e){return function(){var t=e.apply(this,arguments);return t==null?[]:m3(t)}}function ZV(e){typeof e=="function"?e=JV(e):e=p3(e);for(var t=this._groups,n=t.length,r=[],s=[],i=0;i<n;++i)for(var l=t[i],a=l.length,c,d=0;d<a;++d)(c=l[d])&&(r.push(e.call(c,c.__data__,d,l)),s.push(c));return new Cs(r,s)}function g3(e){return function(){return this.matches(e)}}function nT(e){return function(t){return t.matches(e)}}var QV=Array.prototype.find;function eW(e){return function(){return QV.call(this.children,e)}}function tW(){return this.firstElementChild}function nW(e){return this.select(e==null?tW:eW(typeof e=="function"?e:nT(e)))}var rW=Array.prototype.filter;function sW(){return this.children}function iW(e){return function(){return rW.call(this.children,e)}}function aW(e){return this.selectAll(e==null?sW:iW(typeof e=="function"?e:nT(e)))}function oW(e){typeof e!="function"&&(e=g3(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var i=t[s],l=i.length,a=r[s]=[],c,d=0;d<l;++d)(c=i[d])&&e.call(c,c.__data__,d,i)&&a.push(c);return new Cs(r,this._parents)}function rT(e){return new Array(e.length)}function lW(){return new Cs(this._enter||this._groups.map(rT),this._parents)}function og(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}og.prototype={constructor:og,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function cW(e){return function(){return e}}function uW(e,t,n,r,s,i){for(var l=0,a,c=t.length,d=i.length;l<d;++l)(a=t[l])?(a.__data__=i[l],r[l]=a):n[l]=new og(e,i[l]);for(;l<c;++l)(a=t[l])&&(s[l]=a)}function dW(e,t,n,r,s,i,l){var a,c,d=new Map,u=t.length,f=i.length,m=new Array(u),h;for(a=0;a<u;++a)(c=t[a])&&(m[a]=h=l.call(c,c.__data__,a,t)+"",d.has(h)?s[a]=c:d.set(h,c));for(a=0;a<f;++a)h=l.call(e,i[a],a,i)+"",(c=d.get(h))?(r[a]=c,c.__data__=i[a],d.delete(h)):n[a]=new og(e,i[a]);for(a=0;a<u;++a)(c=t[a])&&d.get(m[a])===c&&(s[a]=c)}function fW(e){return e.__data__}function hW(e,t){if(!arguments.length)return Array.from(this,fW);var n=t?dW:uW,r=this._parents,s=this._groups;typeof e!="function"&&(e=cW(e));for(var i=s.length,l=new Array(i),a=new Array(i),c=new Array(i),d=0;d<i;++d){var u=r[d],f=s[d],m=f.length,h=m3(e.call(u,u&&u.__data__,d,r)),g=h.length,y=a[d]=new Array(g),p=l[d]=new Array(g),x=c[d]=new Array(m);n(u,f,y,p,x,h,t);for(var b=0,w=0,N,k;b<g;++b)if(N=y[b]){for(b>=w&&(w=b+1);!(k=p[w])&&++w<g;);N._next=k||null}}return l=new Cs(l,r),l._enter=a,l._exit=c,l}function mW(){return new Cs(this._exit||this._groups.map(rT),this._parents)}function pW(e,t,n){var r=this.enter(),s=this,i=this.exit();return r=typeof e=="function"?e(r):r.append(e+""),t!=null&&(s=t(s)),n==null?i.remove():n(i),r&&s?r.merge(s).order():s}function gW(e){if(!(e instanceof Cs))throw new Error("invalid merge");for(var t=this._groups,n=e._groups,r=t.length,s=n.length,i=Math.min(r,s),l=new Array(r),a=0;a<i;++a)for(var c=t[a],d=n[a],u=c.length,f=l[a]=new Array(u),m,h=0;h<u;++h)(m=c[h]||d[h])&&(f[h]=m);for(;a<r;++a)l[a]=t[a];return new Cs(l,this._parents)}function xW(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],s=r.length-1,i=r[s],l;--s>=0;)(l=r[s])&&(i&&l.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(l,i),i=l);return this}function yW(e){e||(e=vW);function t(f,m){return f&&m?e(f.__data__,m.__data__):!f-!m}for(var n=this._groups,r=n.length,s=new Array(r),i=0;i<r;++i){for(var l=n[i],a=l.length,c=s[i]=new Array(a),d,u=0;u<a;++u)(d=l[u])&&(c[u]=d);c.sort(t)}return new Cs(s,this._parents).order()}function vW(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function bW(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function wW(){return Array.from(this)}function NW(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],s=0,i=r.length;s<i;++s){var l=r[s];if(l)return l}return null}function jW(){let e=0;for(const t of this)++e;return e}function _W(){return!this.node()}function SW(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var s=t[n],i=0,l=s.length,a;i<l;++i)(a=s[i])&&e.call(a,a.__data__,i,s);return this}function AW(e){return function(){this.removeAttribute(e)}}function kW(e){return function(){this.removeAttributeNS(e.space,e.local)}}function EW(e,t){return function(){this.setAttribute(e,t)}}function CW(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function PW(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function IW(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function TW(e,t){var n=Kh(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?kW:AW:typeof t=="function"?n.local?IW:PW:n.local?CW:EW)(n,t))}function x3(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function LW(e){return function(){this.style.removeProperty(e)}}function MW(e,t,n){return function(){this.style.setProperty(e,t,n)}}function RW(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function $W(e,t,n){return arguments.length>1?this.each((t==null?LW:typeof t=="function"?RW:MW)(e,t,n??"")):yc(this.node(),e)}function yc(e,t){return e.style.getPropertyValue(t)||x3(e).getComputedStyle(e,null).getPropertyValue(t)}function OW(e){return function(){delete this[e]}}function FW(e,t){return function(){this[e]=t}}function DW(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function qW(e,t){return arguments.length>1?this.each((t==null?OW:typeof t=="function"?DW:FW)(e,t)):this.node()[e]}function sT(e){return e.trim().split(/^|\s+/)}function y3(e){return e.classList||new iT(e)}function iT(e){this._node=e,this._names=sT(e.getAttribute("class")||"")}iT.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function aT(e,t){for(var n=y3(e),r=-1,s=t.length;++r<s;)n.add(t[r])}function oT(e,t){for(var n=y3(e),r=-1,s=t.length;++r<s;)n.remove(t[r])}function BW(e){return function(){aT(this,e)}}function zW(e){return function(){oT(this,e)}}function UW(e,t){return function(){(t.apply(this,arguments)?aT:oT)(this,e)}}function HW(e,t){var n=sT(e+"");if(arguments.length<2){for(var r=y3(this.node()),s=-1,i=n.length;++s<i;)if(!r.contains(n[s]))return!1;return!0}return this.each((typeof t=="function"?UW:t?BW:zW)(n,t))}function VW(){this.textContent=""}function WW(e){return function(){this.textContent=e}}function GW(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function YW(e){return arguments.length?this.each(e==null?VW:(typeof e=="function"?GW:WW)(e)):this.node().textContent}function XW(){this.innerHTML=""}function KW(e){return function(){this.innerHTML=e}}function JW(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function ZW(e){return arguments.length?this.each(e==null?XW:(typeof e=="function"?JW:KW)(e)):this.node().innerHTML}function QW(){this.nextSibling&&this.parentNode.appendChild(this)}function eG(){return this.each(QW)}function tG(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function nG(){return this.each(tG)}function rG(e){var t=typeof e=="function"?e:b0(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function sG(){return null}function iG(e,t){var n=typeof e=="function"?e:b0(e),r=t==null?sG:typeof t=="function"?t:w0(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function aG(){var e=this.parentNode;e&&e.removeChild(this)}function oG(){return this.each(aG)}function lG(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function cG(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function uG(e){return this.select(e?cG:lG)}function dG(e){return arguments.length?this.property("__data__",e):this.node().__data__}function fG(e){return function(t){e.call(this,t,this.__data__)}}function hG(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function mG(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,s=t.length,i;n<s;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++r]=i;++r?t.length=r:delete this.__on}}}function pG(e,t,n){return function(){var r=this.__on,s,i=fG(t);if(r){for(var l=0,a=r.length;l<a;++l)if((s=r[l]).type===e.type&&s.name===e.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=i,s.options=n),s.value=t;return}}this.addEventListener(e.type,i,n),s={type:e.type,name:e.name,value:t,listener:i,options:n},r?r.push(s):this.__on=[s]}}function gG(e,t,n){var r=hG(e+""),s,i=r.length,l;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,d=a.length,u;c<d;++c)for(s=0,u=a[c];s<i;++s)if((l=r[s]).type===u.type&&l.name===u.name)return u.value}return}for(a=t?pG:mG,s=0;s<i;++s)this.each(a(r[s],t,n));return this}function lT(e,t,n){var r=x3(e),s=r.CustomEvent;typeof s=="function"?s=new s(t,n):(s=r.document.createEvent("Event"),n?(s.initEvent(t,n.bubbles,n.cancelable),s.detail=n.detail):s.initEvent(t,!1,!1)),e.dispatchEvent(s)}function xG(e,t){return function(){return lT(this,e,t)}}function yG(e,t){return function(){return lT(this,e,t.apply(this,arguments))}}function vG(e,t){return this.each((typeof t=="function"?yG:xG)(e,t))}function*bG(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],s=0,i=r.length,l;s<i;++s)(l=r[s])&&(yield l)}var v3=[null];function Cs(e,t){this._groups=e,this._parents=t}function Ic(){return new Cs([[document.documentElement]],v3)}function wG(){return this}Cs.prototype=Ic.prototype={constructor:Cs,select:XV,selectAll:ZV,selectChild:nW,selectChildren:aW,filter:oW,data:hW,enter:lW,exit:mW,join:pW,merge:gW,selection:wG,order:xW,sort:yW,call:bW,nodes:wW,node:NW,size:jW,empty:_W,each:SW,attr:TW,style:$W,property:qW,classed:HW,text:YW,html:ZW,raise:eG,lower:nG,append:rG,insert:iG,remove:oG,clone:uG,datum:dG,on:gG,dispatch:vG,[Symbol.iterator]:bG};function Es(e){return typeof e=="string"?new Cs([[document.querySelector(e)]],[document.documentElement]):new Cs([[e]],v3)}function NG(e){return Es(b0(e).call(document.documentElement))}var jG=0;function cT(){return new O5}function O5(){this._="@"+(++jG).toString(36)}O5.prototype=cT.prototype={constructor:O5,get:function(e){for(var t=this._;!(t in e);)if(!(e=e.parentNode))return;return e[t]},set:function(e,t){return e[this._]=t},remove:function(e){return this._ in e&&delete e[this._]},toString:function(){return this._}};function uT(e){let t;for(;t=e.sourceEvent;)e=t;return e}function gi(e,t){if(e=uT(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var s=t.getBoundingClientRect();return[e.clientX-s.left-t.clientLeft,e.clientY-s.top-t.clientTop]}}return[e.pageX,e.pageY]}function _G(e,t){return e.target&&(e=uT(e),t===void 0&&(t=e.currentTarget),e=e.touches||[e]),Array.from(e,n=>gi(n,t))}function SG(e){return typeof e=="string"?new Cs([document.querySelectorAll(e)],[document.documentElement]):new Cs([e==null?[]:m3(e)],v3)}function ax(e){e.stopImmediatePropagation()}function $u(e){e.preventDefault(),e.stopImmediatePropagation()}function N0(e){var t=e.document.documentElement,n=Es(e).on("dragstart.drag",$u,!0);"onselectstart"in t?n.on("selectstart.drag",$u,!0):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function j0(e,t){var n=e.document.documentElement,r=Es(e).on("dragstart.drag",null);t&&(r.on("click.drag",$u,!0),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Um=e=>()=>e;function F5(e,{sourceEvent:t,subject:n,target:r,identifier:s,active:i,x:l,y:a,dx:c,dy:d,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:l,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:d,enumerable:!0,configurable:!0},_:{value:u}})}F5.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function AG(e){return!e.ctrlKey&&!e.button}function kG(){return this.parentNode}function EG(e,t){return t??{x:e.x,y:e.y}}function CG(){return navigator.maxTouchPoints||"ontouchstart"in this}function PG(){var e=AG,t=kG,n=EG,r=CG,s={},i=Pc("start","drag","end"),l=0,a,c,d,u,f=0;function m(N){N.on("mousedown.drag",h).filter(r).on("touchstart.drag",p).on("touchmove.drag",x).on("touchend.drag touchcancel.drag",b).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(N,k){if(!(u||!e.call(this,N,k))){var I=w(this,t.call(this,N,k),N,k,"mouse");I&&(Es(N.view).on("mousemove.drag",g,!0).on("mouseup.drag",y,!0),N0(N.view),ax(N),d=!1,a=N.clientX,c=N.clientY,I("start",N))}}function g(N){if($u(N),!d){var k=N.clientX-a,I=N.clientY-c;d=k*k+I*I>f}s.mouse("drag",N)}function y(N){Es(N.view).on("mousemove.drag mouseup.drag",null),j0(N.view,d),$u(N),s.mouse("end",N)}function p(N,k){if(e.call(this,N,k)){var I=N.changedTouches,R=t.call(this,N,k),T=I.length,S,E;for(S=0;S<T;++S)(E=w(this,R,N,k,I[S].identifier,I[S]))&&(ax(N),E("start",N,I[S]))}}function x(N){var k=N.changedTouches,I=k.length,R,T;for(R=0;R<I;++R)(T=s[k[R].identifier])&&($u(N),T("drag",N,k[R]))}function b(N){var k=N.changedTouches,I=k.length,R,T;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),R=0;R<I;++R)(T=s[k[R].identifier])&&(ax(N),T("end",N,k[R]))}function w(N,k,I,R,T,S){var E=i.copy(),_=gi(S||I,k),M,A,P;if((P=n.call(N,new F5("beforestart",{sourceEvent:I,target:m,identifier:T,active:l,x:_[0],y:_[1],dx:0,dy:0,dispatch:E}),R))!=null)return M=P.x-_[0]||0,A=P.y-_[1]||0,function B(L,D,V){var O=_,H;switch(L){case"start":s[T]=B,H=l++;break;case"end":delete s[T],--l;case"drag":_=gi(V||D,k),H=l;break}E.call(L,N,new F5(L,{sourceEvent:D,subject:P,target:m,identifier:T,active:H,x:_[0]+M,y:_[1]+A,dx:_[0]-O[0],dy:_[1]-O[1],dispatch:E}),R)}}return m.filter=function(N){return arguments.length?(e=typeof N=="function"?N:Um(!!N),m):e},m.container=function(N){return arguments.length?(t=typeof N=="function"?N:Um(N),m):t},m.subject=function(N){return arguments.length?(n=typeof N=="function"?N:Um(N),m):n},m.touchable=function(N){return arguments.length?(r=typeof N=="function"?N:Um(!!N),m):r},m.on=function(){var N=i.on.apply(i,arguments);return N===i?m:N},m.clickDistance=function(N){return arguments.length?(f=(N=+N)*N,m):Math.sqrt(f)},m}function bd(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function Jh(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function jl(){}var vc=.7,Zu=1/vc,Ou="\\s*([+-]?\\d+)\\s*",bh="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ma="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",IG=/^#([0-9a-f]{3,8})$/,TG=new RegExp("^rgb\\("+[Ou,Ou,Ou]+"\\)$"),LG=new RegExp("^rgb\\("+[Ma,Ma,Ma]+"\\)$"),MG=new RegExp("^rgba\\("+[Ou,Ou,Ou,bh]+"\\)$"),RG=new RegExp("^rgba\\("+[Ma,Ma,Ma,bh]+"\\)$"),$G=new RegExp("^hsl\\("+[bh,Ma,Ma]+"\\)$"),OG=new RegExp("^hsla\\("+[bh,Ma,Ma,bh]+"\\)$"),R_={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};bd(jl,gl,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:$_,formatHex:$_,formatHsl:FG,formatRgb:O_,toString:O_});function $_(){return this.rgb().formatHex()}function FG(){return dT(this).formatHsl()}function O_(){return this.rgb().formatRgb()}function gl(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=IG.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?F_(t):n===3?new hs(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?Hm(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?Hm(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=TG.exec(e))?new hs(t[1],t[2],t[3],1):(t=LG.exec(e))?new hs(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=MG.exec(e))?Hm(t[1],t[2],t[3],t[4]):(t=RG.exec(e))?Hm(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=$G.exec(e))?B_(t[1],t[2]/100,t[3]/100,1):(t=OG.exec(e))?B_(t[1],t[2]/100,t[3]/100,t[4]):R_.hasOwnProperty(e)?F_(R_[e]):e==="transparent"?new hs(NaN,NaN,NaN,0):null}function F_(e){return new hs(e>>16&255,e>>8&255,e&255,1)}function Hm(e,t,n,r){return r<=0&&(e=t=n=NaN),new hs(e,t,n,r)}function b3(e){return e instanceof jl||(e=gl(e)),e?(e=e.rgb(),new hs(e.r,e.g,e.b,e.opacity)):new hs}function Qu(e,t,n,r){return arguments.length===1?b3(e):new hs(e,t,n,r??1)}function hs(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}bd(hs,Qu,Jh(jl,{brighter:function(e){return e=e==null?Zu:Math.pow(Zu,e),new hs(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?vc:Math.pow(vc,e),new hs(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:D_,formatHex:D_,formatRgb:q_,toString:q_}));function D_(){return"#"+ox(this.r)+ox(this.g)+ox(this.b)}function q_(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function ox(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function B_(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new ka(e,t,n,r)}function dT(e){if(e instanceof ka)return new ka(e.h,e.s,e.l,e.opacity);if(e instanceof jl||(e=gl(e)),!e)return new ka;if(e instanceof ka)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,s=Math.min(t,n,r),i=Math.max(t,n,r),l=NaN,a=i-s,c=(i+s)/2;return a?(t===i?l=(n-r)/a+(n<r)*6:n===i?l=(r-t)/a+2:l=(t-n)/a+4,a/=c<.5?i+s:2-i-s,l*=60):a=c>0&&c<1?0:l,new ka(l,a,c,e.opacity)}function lg(e,t,n,r){return arguments.length===1?dT(e):new ka(e,t,n,r??1)}function ka(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}bd(ka,lg,Jh(jl,{brighter:function(e){return e=e==null?Zu:Math.pow(Zu,e),new ka(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?vc:Math.pow(vc,e),new ka(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,s=2*n-r;return new hs(lx(e>=240?e-240:e+120,s,r),lx(e,s,r),lx(e<120?e+240:e-120,s,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function lx(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const fT=Math.PI/180,hT=180/Math.PI,cg=18,mT=.96422,pT=1,gT=.82521,xT=4/29,Fu=6/29,yT=3*Fu*Fu,DG=Fu*Fu*Fu;function vT(e){if(e instanceof na)return new na(e.l,e.a,e.b,e.opacity);if(e instanceof Ia)return wT(e);e instanceof hs||(e=b3(e));var t=fx(e.r),n=fx(e.g),r=fx(e.b),s=cx((.2225045*t+.7168786*n+.0606169*r)/pT),i,l;return t===n&&n===r?i=l=s:(i=cx((.4360747*t+.3850649*n+.1430804*r)/mT),l=cx((.0139322*t+.0971045*n+.7141733*r)/gT)),new na(116*s-16,500*(i-s),200*(s-l),e.opacity)}function qG(e,t){return new na(e,0,0,t??1)}function ug(e,t,n,r){return arguments.length===1?vT(e):new na(e,t,n,r??1)}function na(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}bd(na,ug,Jh(jl,{brighter:function(e){return new na(this.l+cg*(e??1),this.a,this.b,this.opacity)},darker:function(e){return new na(this.l-cg*(e??1),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=mT*ux(t),e=pT*ux(e),n=gT*ux(n),new hs(dx(3.1338561*t-1.6168667*e-.4906146*n),dx(-.9787684*t+1.9161415*e+.033454*n),dx(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function cx(e){return e>DG?Math.pow(e,1/3):e/yT+xT}function ux(e){return e>Fu?e*e*e:yT*(e-xT)}function dx(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function fx(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function bT(e){if(e instanceof Ia)return new Ia(e.h,e.c,e.l,e.opacity);if(e instanceof na||(e=vT(e)),e.a===0&&e.b===0)return new Ia(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*hT;return new Ia(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function BG(e,t,n,r){return arguments.length===1?bT(e):new Ia(n,t,e,r??1)}function dg(e,t,n,r){return arguments.length===1?bT(e):new Ia(e,t,n,r??1)}function Ia(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function wT(e){if(isNaN(e.h))return new na(e.l,0,0,e.opacity);var t=e.h*fT;return new na(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}bd(Ia,dg,Jh(jl,{brighter:function(e){return new Ia(this.h,this.c,this.l+cg*(e??1),this.opacity)},darker:function(e){return new Ia(this.h,this.c,this.l-cg*(e??1),this.opacity)},rgb:function(){return wT(this).rgb()}}));var NT=-.14861,w3=1.78277,N3=-.29227,_0=-.90649,wh=1.97294,z_=wh*_0,U_=wh*w3,H_=w3*N3-_0*NT;function zG(e){if(e instanceof hc)return new hc(e.h,e.s,e.l,e.opacity);e instanceof hs||(e=b3(e));var t=e.r/255,n=e.g/255,r=e.b/255,s=(H_*r+z_*t-U_*n)/(H_+z_-U_),i=r-s,l=(wh*(n-s)-N3*i)/_0,a=Math.sqrt(l*l+i*i)/(wh*s*(1-s)),c=a?Math.atan2(l,i)*hT-120:NaN;return new hc(c<0?c+360:c,a,s,e.opacity)}function aa(e,t,n,r){return arguments.length===1?zG(e):new hc(e,t,n,r??1)}function hc(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}bd(hc,aa,Jh(jl,{brighter:function(e){return e=e==null?Zu:Math.pow(Zu,e),new hc(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?vc:Math.pow(vc,e),new hc(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*fT,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),s=Math.sin(e);return new hs(255*(t+n*(NT*r+w3*s)),255*(t+n*(N3*r+_0*s)),255*(t+n*(wh*r)),this.opacity)}}));function jT(e,t,n,r,s){var i=e*e,l=i*e;return((1-3*e+3*i-l)*t+(4-6*i+3*l)*n+(1+3*e+3*i-3*l)*r+l*s)/6}function _T(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),s=e[r],i=e[r+1],l=r>0?e[r-1]:2*s-i,a=r<t-1?e[r+2]:2*i-s;return jT((n-r/t)*t,l,s,i,a)}}function ST(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),s=e[(r+t-1)%t],i=e[r%t],l=e[(r+1)%t],a=e[(r+2)%t];return jT((n-r/t)*t,s,i,l,a)}}const S0=e=>()=>e;function AT(e,t){return function(n){return e+n*t}}function UG(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function A0(e,t){var n=t-e;return n?AT(e,n>180||n<-180?n-360*Math.round(n/360):n):S0(isNaN(e)?t:e)}function HG(e){return(e=+e)==1?ns:function(t,n){return n-t?UG(t,n,e):S0(isNaN(t)?n:t)}}function ns(e,t){var n=t-e;return n?AT(e,n):S0(isNaN(e)?t:e)}const Nh=function e(t){var n=HG(t);function r(s,i){var l=n((s=Qu(s)).r,(i=Qu(i)).r),a=n(s.g,i.g),c=n(s.b,i.b),d=ns(s.opacity,i.opacity);return function(u){return s.r=l(u),s.g=a(u),s.b=c(u),s.opacity=d(u),s+""}}return r.gamma=e,r}(1);function kT(e){return function(t){var n=t.length,r=new Array(n),s=new Array(n),i=new Array(n),l,a;for(l=0;l<n;++l)a=Qu(t[l]),r[l]=a.r||0,s[l]=a.g||0,i[l]=a.b||0;return r=e(r),s=e(s),i=e(i),a.opacity=1,function(c){return a.r=r(c),a.g=s(c),a.b=i(c),a+""}}}var ET=kT(_T),VG=kT(ST);function j3(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),s;return function(i){for(s=0;s<n;++s)r[s]=e[s]*(1-i)+t[s]*i;return r}}function CT(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function WG(e,t){return(CT(t)?j3:PT)(e,t)}function PT(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,s=new Array(r),i=new Array(n),l;for(l=0;l<r;++l)s[l]=_l(e[l],t[l]);for(;l<n;++l)i[l]=t[l];return function(a){for(l=0;l<r;++l)i[l]=s[l](a);return i}}function IT(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Ti(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function TT(e,t){var n={},r={},s;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(s in t)s in e?n[s]=_l(e[s],t[s]):r[s]=t[s];return function(i){for(s in n)r[s]=n[s](i);return r}}var D5=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,hx=new RegExp(D5.source,"g");function GG(e){return function(){return e}}function YG(e){return function(t){return e(t)+""}}function _3(e,t){var n=D5.lastIndex=hx.lastIndex=0,r,s,i,l=-1,a=[],c=[];for(e=e+"",t=t+"";(r=D5.exec(e))&&(s=hx.exec(t));)(i=s.index)>n&&(i=t.slice(n,i),a[l]?a[l]+=i:a[++l]=i),(r=r[0])===(s=s[0])?a[l]?a[l]+=s:a[++l]=s:(a[++l]=null,c.push({i:l,x:Ti(r,s)})),n=hx.lastIndex;return n<t.length&&(i=t.slice(n),a[l]?a[l]+=i:a[++l]=i),a.length<2?c[0]?YG(c[0].x):GG(t):(t=c.length,function(d){for(var u=0,f;u<t;++u)a[(f=c[u]).i]=f.x(d);return a.join("")})}function _l(e,t){var n=typeof t,r;return t==null||n==="boolean"?S0(t):(n==="number"?Ti:n==="string"?(r=gl(t))?(t=r,Nh):_3:t instanceof gl?Nh:t instanceof Date?IT:CT(t)?j3:Array.isArray(t)?PT:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?TT:Ti)(e,t)}function XG(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function KG(e,t){var n=A0(+e,+t);return function(r){var s=n(r);return s-360*Math.floor(s/360)}}function k0(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var V_=180/Math.PI,q5={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function LT(e,t,n,r,s,i){var l,a,c;return(l=Math.sqrt(e*e+t*t))&&(e/=l,t/=l),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,c/=a),e*r<t*n&&(e=-e,t=-t,c=-c,l=-l),{translateX:s,translateY:i,rotate:Math.atan2(t,e)*V_,skewX:Math.atan(c)*V_,scaleX:l,scaleY:a}}var Vm;function JG(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?q5:LT(t.a,t.b,t.c,t.d,t.e,t.f)}function ZG(e){return e==null||(Vm||(Vm=document.createElementNS("http://www.w3.org/2000/svg","g")),Vm.setAttribute("transform",e),!(e=Vm.transform.baseVal.consolidate()))?q5:(e=e.matrix,LT(e.a,e.b,e.c,e.d,e.e,e.f))}function MT(e,t,n,r){function s(d){return d.length?d.pop()+" ":""}function i(d,u,f,m,h,g){if(d!==f||u!==m){var y=h.push("translate(",null,t,null,n);g.push({i:y-4,x:Ti(d,f)},{i:y-2,x:Ti(u,m)})}else(f||m)&&h.push("translate("+f+t+m+n)}function l(d,u,f,m){d!==u?(d-u>180?u+=360:u-d>180&&(d+=360),m.push({i:f.push(s(f)+"rotate(",null,r)-2,x:Ti(d,u)})):u&&f.push(s(f)+"rotate("+u+r)}function a(d,u,f,m){d!==u?m.push({i:f.push(s(f)+"skewX(",null,r)-2,x:Ti(d,u)}):u&&f.push(s(f)+"skewX("+u+r)}function c(d,u,f,m,h,g){if(d!==f||u!==m){var y=h.push(s(h)+"scale(",null,",",null,")");g.push({i:y-4,x:Ti(d,f)},{i:y-2,x:Ti(u,m)})}else(f!==1||m!==1)&&h.push(s(h)+"scale("+f+","+m+")")}return function(d,u){var f=[],m=[];return d=e(d),u=e(u),i(d.translateX,d.translateY,u.translateX,u.translateY,f,m),l(d.rotate,u.rotate,f,m),a(d.skewX,u.skewX,f,m),c(d.scaleX,d.scaleY,u.scaleX,u.scaleY,f,m),d=u=null,function(h){for(var g=-1,y=m.length,p;++g<y;)f[(p=m[g]).i]=p.x(h);return f.join("")}}}var RT=MT(JG,"px, ","px)","deg)"),$T=MT(ZG,", ",")",")"),QG=1e-12;function W_(e){return((e=Math.exp(e))+1/e)/2}function eY(e){return((e=Math.exp(e))-1/e)/2}function tY(e){return((e=Math.exp(2*e))-1)/(e+1)}const OT=function e(t,n,r){function s(i,l){var a=i[0],c=i[1],d=i[2],u=l[0],f=l[1],m=l[2],h=u-a,g=f-c,y=h*h+g*g,p,x;if(y<QG)x=Math.log(m/d)/t,p=function(R){return[a+R*h,c+R*g,d*Math.exp(t*R*x)]};else{var b=Math.sqrt(y),w=(m*m-d*d+r*y)/(2*d*n*b),N=(m*m-d*d-r*y)/(2*m*n*b),k=Math.log(Math.sqrt(w*w+1)-w),I=Math.log(Math.sqrt(N*N+1)-N);x=(I-k)/t,p=function(R){var T=R*x,S=W_(k),E=d/(n*b)*(S*tY(t*T+k)-eY(k));return[a+E*h,c+E*g,d*S/W_(t*T+k)]}}return p.duration=x*1e3*t/Math.SQRT2,p}return s.rho=function(i){var l=Math.max(.001,+i),a=l*l,c=a*a;return e(l,a,c)},s}(Math.SQRT2,2,4);function FT(e){return function(t,n){var r=e((t=lg(t)).h,(n=lg(n)).h),s=ns(t.s,n.s),i=ns(t.l,n.l),l=ns(t.opacity,n.opacity);return function(a){return t.h=r(a),t.s=s(a),t.l=i(a),t.opacity=l(a),t+""}}}const nY=FT(A0);var rY=FT(ns);function sY(e,t){var n=ns((e=ug(e)).l,(t=ug(t)).l),r=ns(e.a,t.a),s=ns(e.b,t.b),i=ns(e.opacity,t.opacity);return function(l){return e.l=n(l),e.a=r(l),e.b=s(l),e.opacity=i(l),e+""}}function DT(e){return function(t,n){var r=e((t=dg(t)).h,(n=dg(n)).h),s=ns(t.c,n.c),i=ns(t.l,n.l),l=ns(t.opacity,n.opacity);return function(a){return t.h=r(a),t.c=s(a),t.l=i(a),t.opacity=l(a),t+""}}}const iY=DT(A0);var aY=DT(ns);function qT(e){return function t(n){n=+n;function r(s,i){var l=e((s=aa(s)).h,(i=aa(i)).h),a=ns(s.s,i.s),c=ns(s.l,i.l),d=ns(s.opacity,i.opacity);return function(u){return s.h=l(u),s.s=a(u),s.l=c(Math.pow(u,n)),s.opacity=d(u),s+""}}return r.gamma=t,r}(1)}const oY=qT(A0);var E0=qT(ns);function BT(e,t){t===void 0&&(t=e,e=_l);for(var n=0,r=t.length-1,s=t[0],i=new Array(r<0?0:r);n<r;)i[n]=e(s,s=t[++n]);return function(l){var a=Math.max(0,Math.min(r-1,Math.floor(l*=r)));return i[a](l-a)}}function lY(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}var ed=0,Mf=0,pf=0,zT=1e3,fg,Rf,hg=0,bc=0,C0=0,jh=typeof performance=="object"&&performance.now?performance:Date,UT=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function Zh(){return bc||(UT(cY),bc=jh.now()+C0)}function cY(){bc=0}function _h(){this._call=this._time=this._next=null}_h.prototype=P0.prototype={constructor:_h,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?Zh():+n)+(t==null?0:+t),!this._next&&Rf!==this&&(Rf?Rf._next=this:fg=this,Rf=this),this._call=e,this._time=n,B5()},stop:function(){this._call&&(this._call=null,this._time=1/0,B5())}};function P0(e,t,n){var r=new _h;return r.restart(e,t,n),r}function HT(){Zh(),++ed;for(var e=fg,t;e;)(t=bc-e._time)>=0&&e._call.call(null,t),e=e._next;--ed}function G_(){bc=(hg=jh.now())+C0,ed=Mf=0;try{HT()}finally{ed=0,dY(),bc=0}}function uY(){var e=jh.now(),t=e-hg;t>zT&&(C0-=t,hg=e)}function dY(){for(var e,t=fg,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:fg=n);Rf=e,B5(r)}function B5(e){if(!ed){Mf&&(Mf=clearTimeout(Mf));var t=e-bc;t>24?(e<1/0&&(Mf=setTimeout(G_,e-jh.now()-C0)),pf&&(pf=clearInterval(pf))):(pf||(hg=jh.now(),pf=setInterval(uY,zT)),ed=1,UT(G_))}}function z5(e,t,n){var r=new _h;return t=t==null?0:+t,r.restart(s=>{r.stop(),e(s+t)},t,n),r}function fY(e,t,n){var r=new _h,s=t;return t==null?(r.restart(e,t,n),r):(r._restart=r.restart,r.restart=function(i,l,a){l=+l,a=a==null?Zh():+a,r._restart(function c(d){d+=s,r._restart(c,s+=l,a),i(d)},l,a)},r.restart(e,t,n),r)}var hY=Pc("start","end","cancel","interrupt"),mY=[],VT=0,U5=1,H5=2,Op=3,Y_=4,V5=5,Fp=6;function I0(e,t,n,r,s,i){var l=e.__transition;if(!l)e.__transition={};else if(n in l)return;pY(e,n,{name:t,index:r,group:s,on:hY,tween:mY,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:VT})}function S3(e,t){var n=ca(e,t);if(n.state>VT)throw new Error("too late; already scheduled");return n}function Ba(e,t){var n=ca(e,t);if(n.state>Op)throw new Error("too late; already running");return n}function ca(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function pY(e,t,n){var r=e.__transition,s;r[t]=n,n.timer=P0(i,0,n.time);function i(d){n.state=U5,n.timer.restart(l,n.delay,n.time),n.delay<=d&&l(d-n.delay)}function l(d){var u,f,m,h;if(n.state!==U5)return c();for(u in r)if(h=r[u],h.name===n.name){if(h.state===Op)return z5(l);h.state===Y_?(h.state=Fp,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete r[u]):+u<t&&(h.state=Fp,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete r[u])}if(z5(function(){n.state===Op&&(n.state=Y_,n.timer.restart(a,n.delay,n.time),a(d))}),n.state=H5,n.on.call("start",e,e.__data__,n.index,n.group),n.state===H5){for(n.state=Op,s=new Array(m=n.tween.length),u=0,f=-1;u<m;++u)(h=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(s[++f]=h);s.length=f+1}}function a(d){for(var u=d<n.duration?n.ease.call(null,d/n.duration):(n.timer.restart(c),n.state=V5,1),f=-1,m=s.length;++f<m;)s[f].call(e,u);n.state===V5&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=Fp,n.timer.stop(),delete r[t];for(var d in r)return;delete e.__transition}}function mc(e,t){var n=e.__transition,r,s,i=!0,l;if(n){t=t==null?null:t+"";for(l in n){if((r=n[l]).name!==t){i=!1;continue}s=r.state>H5&&r.state<V5,r.state=Fp,r.timer.stop(),r.on.call(s?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[l]}i&&delete e.__transition}}function gY(e){return this.each(function(){mc(this,e)})}function xY(e,t){var n,r;return function(){var s=Ba(this,e),i=s.tween;if(i!==n){r=n=i;for(var l=0,a=r.length;l<a;++l)if(r[l].name===t){r=r.slice(),r.splice(l,1);break}}s.tween=r}}function yY(e,t,n){var r,s;if(typeof n!="function")throw new Error;return function(){var i=Ba(this,e),l=i.tween;if(l!==r){s=(r=l).slice();for(var a={name:t,value:n},c=0,d=s.length;c<d;++c)if(s[c].name===t){s[c]=a;break}c===d&&s.push(a)}i.tween=s}}function vY(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=ca(this.node(),n).tween,s=0,i=r.length,l;s<i;++s)if((l=r[s]).name===e)return l.value;return null}return this.each((t==null?xY:yY)(n,e,t))}function A3(e,t,n){var r=e._id;return e.each(function(){var s=Ba(this,r);(s.value||(s.value={}))[t]=n.apply(this,arguments)}),function(s){return ca(s,r).value[t]}}function WT(e,t){var n;return(typeof t=="number"?Ti:t instanceof gl?Nh:(n=gl(t))?(t=n,Nh):_3)(e,t)}function bY(e){return function(){this.removeAttribute(e)}}function wY(e){return function(){this.removeAttributeNS(e.space,e.local)}}function NY(e,t,n){var r,s=n+"",i;return function(){var l=this.getAttribute(e);return l===s?null:l===r?i:i=t(r=l,n)}}function jY(e,t,n){var r,s=n+"",i;return function(){var l=this.getAttributeNS(e.space,e.local);return l===s?null:l===r?i:i=t(r=l,n)}}function _Y(e,t,n){var r,s,i;return function(){var l,a=n(this),c;return a==null?void this.removeAttribute(e):(l=this.getAttribute(e),c=a+"",l===c?null:l===r&&c===s?i:(s=c,i=t(r=l,a)))}}function SY(e,t,n){var r,s,i;return function(){var l,a=n(this),c;return a==null?void this.removeAttributeNS(e.space,e.local):(l=this.getAttributeNS(e.space,e.local),c=a+"",l===c?null:l===r&&c===s?i:(s=c,i=t(r=l,a)))}}function AY(e,t){var n=Kh(e),r=n==="transform"?$T:WT;return this.attrTween(e,typeof t=="function"?(n.local?SY:_Y)(n,r,A3(this,"attr."+e,t)):t==null?(n.local?wY:bY)(n):(n.local?jY:NY)(n,r,t))}function kY(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function EY(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function CY(e,t){var n,r;function s(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&EY(e,i)),n}return s._value=t,s}function PY(e,t){var n,r;function s(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&kY(e,i)),n}return s._value=t,s}function IY(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=Kh(e);return this.tween(n,(r.local?CY:PY)(r,t))}function TY(e,t){return function(){S3(this,e).delay=+t.apply(this,arguments)}}function LY(e,t){return t=+t,function(){S3(this,e).delay=t}}function MY(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?TY:LY)(t,e)):ca(this.node(),t).delay}function RY(e,t){return function(){Ba(this,e).duration=+t.apply(this,arguments)}}function $Y(e,t){return t=+t,function(){Ba(this,e).duration=t}}function OY(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?RY:$Y)(t,e)):ca(this.node(),t).duration}function FY(e,t){if(typeof t!="function")throw new Error;return function(){Ba(this,e).ease=t}}function DY(e){var t=this._id;return arguments.length?this.each(FY(t,e)):ca(this.node(),t).ease}function qY(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Ba(this,e).ease=n}}function BY(e){if(typeof e!="function")throw new Error;return this.each(qY(this._id,e))}function zY(e){typeof e!="function"&&(e=g3(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var i=t[s],l=i.length,a=r[s]=[],c,d=0;d<l;++d)(c=i[d])&&e.call(c,c.__data__,d,i)&&a.push(c);return new Oa(r,this._parents,this._name,this._id)}function UY(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,s=n.length,i=Math.min(r,s),l=new Array(r),a=0;a<i;++a)for(var c=t[a],d=n[a],u=c.length,f=l[a]=new Array(u),m,h=0;h<u;++h)(m=c[h]||d[h])&&(f[h]=m);for(;a<r;++a)l[a]=t[a];return new Oa(l,this._parents,this._name,this._id)}function HY(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function VY(e,t,n){var r,s,i=HY(t)?S3:Ba;return function(){var l=i(this,e),a=l.on;a!==r&&(s=(r=a).copy()).on(t,n),l.on=s}}function WY(e,t){var n=this._id;return arguments.length<2?ca(this.node(),n).on.on(e):this.each(VY(n,e,t))}function GY(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function YY(){return this.on("end.remove",GY(this._id))}function XY(e){var t=this._name,n=this._id;typeof e!="function"&&(e=w0(e));for(var r=this._groups,s=r.length,i=new Array(s),l=0;l<s;++l)for(var a=r[l],c=a.length,d=i[l]=new Array(c),u,f,m=0;m<c;++m)(u=a[m])&&(f=e.call(u,u.__data__,m,a))&&("__data__"in u&&(f.__data__=u.__data__),d[m]=f,I0(d[m],t,n,m,d,ca(u,n)));return new Oa(i,this._parents,t,n)}function KY(e){var t=this._name,n=this._id;typeof e!="function"&&(e=p3(e));for(var r=this._groups,s=r.length,i=[],l=[],a=0;a<s;++a)for(var c=r[a],d=c.length,u,f=0;f<d;++f)if(u=c[f]){for(var m=e.call(u,u.__data__,f,c),h,g=ca(u,n),y=0,p=m.length;y<p;++y)(h=m[y])&&I0(h,t,n,y,m,g);i.push(m),l.push(u)}return new Oa(i,l,t,n)}var JY=Ic.prototype.constructor;function ZY(){return new JY(this._groups,this._parents)}function QY(e,t){var n,r,s;return function(){var i=yc(this,e),l=(this.style.removeProperty(e),yc(this,e));return i===l?null:i===n&&l===r?s:s=t(n=i,r=l)}}function GT(e){return function(){this.style.removeProperty(e)}}function eX(e,t,n){var r,s=n+"",i;return function(){var l=yc(this,e);return l===s?null:l===r?i:i=t(r=l,n)}}function tX(e,t,n){var r,s,i;return function(){var l=yc(this,e),a=n(this),c=a+"";return a==null&&(c=a=(this.style.removeProperty(e),yc(this,e))),l===c?null:l===r&&c===s?i:(s=c,i=t(r=l,a))}}function nX(e,t){var n,r,s,i="style."+t,l="end."+i,a;return function(){var c=Ba(this,e),d=c.on,u=c.value[i]==null?a||(a=GT(t)):void 0;(d!==n||s!==u)&&(r=(n=d).copy()).on(l,s=u),c.on=r}}function rX(e,t,n){var r=(e+="")=="transform"?RT:WT;return t==null?this.styleTween(e,QY(e,r)).on("end.style."+e,GT(e)):typeof t=="function"?this.styleTween(e,tX(e,r,A3(this,"style."+e,t))).each(nX(this._id,e)):this.styleTween(e,eX(e,r,t),n).on("end.style."+e,null)}function sX(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function iX(e,t,n){var r,s;function i(){var l=t.apply(this,arguments);return l!==s&&(r=(s=l)&&sX(e,l,n)),r}return i._value=t,i}function aX(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,iX(e,t,n??""))}function oX(e){return function(){this.textContent=e}}function lX(e){return function(){var t=e(this);this.textContent=t??""}}function cX(e){return this.tween("text",typeof e=="function"?lX(A3(this,"text",e)):oX(e==null?"":e+""))}function uX(e){return function(t){this.textContent=e.call(this,t)}}function dX(e){var t,n;function r(){var s=e.apply(this,arguments);return s!==n&&(t=(n=s)&&uX(s)),t}return r._value=e,r}function fX(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,dX(e))}function hX(){for(var e=this._name,t=this._id,n=XT(),r=this._groups,s=r.length,i=0;i<s;++i)for(var l=r[i],a=l.length,c,d=0;d<a;++d)if(c=l[d]){var u=ca(c,t);I0(c,e,n,d,l,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new Oa(r,this._parents,e,n)}function mX(){var e,t,n=this,r=n._id,s=n.size();return new Promise(function(i,l){var a={value:l},c={value:function(){--s===0&&i()}};n.each(function(){var d=Ba(this,r),u=d.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(a),t._.interrupt.push(a),t._.end.push(c)),d.on=t}),s===0&&i()})}var pX=0;function Oa(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function YT(e){return Ic().transition(e)}function XT(){return++pX}var Kl=Ic.prototype;Oa.prototype=YT.prototype={constructor:Oa,select:XY,selectAll:KY,filter:zY,merge:UY,selection:ZY,transition:hX,call:Kl.call,nodes:Kl.nodes,node:Kl.node,size:Kl.size,empty:Kl.empty,each:Kl.each,on:WY,attr:AY,attrTween:IY,style:rX,styleTween:aX,text:cX,textTween:fX,remove:YY,tween:vY,delay:MY,duration:OY,ease:DY,easeVarying:BY,end:mX,[Symbol.iterator]:Kl[Symbol.iterator]};const gX=e=>+e;function xX(e){return e*e}function yX(e){return e*(2-e)}function X_(e){return((e*=2)<=1?e*e:--e*(2-e)+1)/2}function vX(e){return e*e*e}function bX(e){return--e*e*e+1}function W5(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var k3=3,wX=function e(t){t=+t;function n(r){return Math.pow(r,t)}return n.exponent=e,n}(k3),NX=function e(t){t=+t;function n(r){return 1-Math.pow(1-r,t)}return n.exponent=e,n}(k3),K_=function e(t){t=+t;function n(r){return((r*=2)<=1?Math.pow(r,t):2-Math.pow(2-r,t))/2}return n.exponent=e,n}(k3),KT=Math.PI,JT=KT/2;function jX(e){return+e==1?1:1-Math.cos(e*JT)}function _X(e){return Math.sin(e*JT)}function J_(e){return(1-Math.cos(KT*e))/2}function xl(e){return(Math.pow(2,-10*e)-.0009765625)*1.0009775171065494}function SX(e){return xl(1-+e)}function AX(e){return 1-xl(e)}function Z_(e){return((e*=2)<=1?xl(1-e):2-xl(e-1))/2}function kX(e){return 1-Math.sqrt(1-e*e)}function EX(e){return Math.sqrt(1- --e*e)}function Q_(e){return((e*=2)<=1?1-Math.sqrt(1-e*e):Math.sqrt(1-(e-=2)*e)+1)/2}var G5=4/11,CX=6/11,PX=8/11,IX=3/4,TX=9/11,LX=10/11,MX=15/16,RX=21/22,$X=63/64,Wm=1/G5/G5;function OX(e){return 1-Sh(1-e)}function Sh(e){return(e=+e)<G5?Wm*e*e:e<PX?Wm*(e-=CX)*e+IX:e<LX?Wm*(e-=TX)*e+MX:Wm*(e-=RX)*e+$X}function FX(e){return((e*=2)<=1?1-Sh(1-e):Sh(e-1)+1)/2}var E3=1.70158,DX=function e(t){t=+t;function n(r){return(r=+r)*r*(t*(r-1)+r)}return n.overshoot=e,n}(E3),qX=function e(t){t=+t;function n(r){return--r*r*((r+1)*t+r)+1}return n.overshoot=e,n}(E3),e6=function e(t){t=+t;function n(r){return((r*=2)<1?r*r*((t+1)*r-t):(r-=2)*r*((t+1)*r+t)+2)/2}return n.overshoot=e,n}(E3),td=2*Math.PI,C3=1,P3=.3,BX=function e(t,n){var r=Math.asin(1/(t=Math.max(1,t)))*(n/=td);function s(i){return t*xl(- --i)*Math.sin((r-i)/n)}return s.amplitude=function(i){return e(i,n*td)},s.period=function(i){return e(t,i)},s}(C3,P3),t6=function e(t,n){var r=Math.asin(1/(t=Math.max(1,t)))*(n/=td);function s(i){return 1-t*xl(i=+i)*Math.sin((i+r)/n)}return s.amplitude=function(i){return e(i,n*td)},s.period=function(i){return e(t,i)},s}(C3,P3),zX=function e(t,n){var r=Math.asin(1/(t=Math.max(1,t)))*(n/=td);function s(i){return((i=i*2-1)<0?t*xl(-i)*Math.sin((r-i)/n):2-t*xl(i)*Math.sin((r+i)/n))/2}return s.amplitude=function(i){return e(i,n*td)},s.period=function(i){return e(t,i)},s}(C3,P3),UX={time:null,delay:0,duration:250,ease:W5};function HX(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function VX(e){var t,n;e instanceof Oa?(t=e._id,e=e._name):(t=XT(),(n=UX).time=Zh(),e=e==null?null:e+"");for(var r=this._groups,s=r.length,i=0;i<s;++i)for(var l=r[i],a=l.length,c,d=0;d<a;++d)(c=l[d])&&I0(c,e,t,d,l,n||HX(c,t));return new Oa(r,this._parents,e,t)}Ic.prototype.interrupt=gY;Ic.prototype.transition=VX;var WX=[null];function GX(e,t){var n=e.__transition,r,s;if(n){t=t==null?null:t+"";for(s in n)if((r=n[s]).state>U5&&r.name===t)return new Oa([[e]],WX,t,+s)}return null}const mx=e=>()=>e;function YX(e,{sourceEvent:t,target:n,selection:r,mode:s,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},selection:{value:r,enumerable:!0,configurable:!0},mode:{value:s,enumerable:!0,configurable:!0},_:{value:i}})}function XX(e){e.stopImmediatePropagation()}function px(e){e.preventDefault(),e.stopImmediatePropagation()}var n6={name:"drag"},gx={name:"space"},du={name:"handle"},fu={name:"center"};const{abs:r6,max:ys,min:vs}=Math;function s6(e){return[+e[0],+e[1]]}function Y5(e){return[s6(e[0]),s6(e[1])]}var Dp={name:"x",handles:["w","e"].map(Ah),input:function(e,t){return e==null?null:[[+e[0],t[0][1]],[+e[1],t[1][1]]]},output:function(e){return e&&[e[0][0],e[1][0]]}},qp={name:"y",handles:["n","s"].map(Ah),input:function(e,t){return e==null?null:[[t[0][0],+e[0]],[t[1][0],+e[1]]]},output:function(e){return e&&[e[0][1],e[1][1]]}},KX={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(Ah),input:function(e){return e==null?null:Y5(e)},output:function(e){return e}},so={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},i6={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},a6={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},JX={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},ZX={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function Ah(e){return{type:e}}function QX(e){return!e.ctrlKey&&!e.button}function eK(){var e=this.ownerSVGElement||this;return e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]}function tK(){return navigator.maxTouchPoints||"ontouchstart"in this}function xx(e){for(;!e.__brush;)if(!(e=e.parentNode))return;return e.__brush}function nK(e){return e[0][0]===e[1][0]||e[0][1]===e[1][1]}function rK(e){var t=e.__brush;return t?t.dim.output(t.selection):null}function sK(){return I3(Dp)}function iK(){return I3(qp)}function aK(){return I3(KX)}function I3(e){var t=eK,n=QX,r=tK,s=!0,i=Pc("start","brush","end"),l=6,a;function c(p){var x=p.property("__brush",y).selectAll(".overlay").data([Ah("overlay")]);x.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",so.overlay).merge(x).each(function(){var w=xx(this).extent;Es(this).attr("x",w[0][0]).attr("y",w[0][1]).attr("width",w[1][0]-w[0][0]).attr("height",w[1][1]-w[0][1])}),p.selectAll(".selection").data([Ah("selection")]).enter().append("rect").attr("class","selection").attr("cursor",so.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var b=p.selectAll(".handle").data(e.handles,function(w){return w.type});b.exit().remove(),b.enter().append("rect").attr("class",function(w){return"handle handle--"+w.type}).attr("cursor",function(w){return so[w.type]}),p.each(d).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",m).filter(r).on("touchstart.brush",m).on("touchmove.brush",h).on("touchend.brush touchcancel.brush",g).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}c.move=function(p,x){p.tween?p.on("start.brush",function(b){u(this,arguments).beforestart().start(b)}).on("interrupt.brush end.brush",function(b){u(this,arguments).end(b)}).tween("brush",function(){var b=this,w=b.__brush,N=u(b,arguments),k=w.selection,I=e.input(typeof x=="function"?x.apply(this,arguments):x,w.extent),R=_l(k,I);function T(S){w.selection=S===1&&I===null?null:R(S),d.call(b),N.brush()}return k!==null&&I!==null?T:T(1)}):p.each(function(){var b=this,w=arguments,N=b.__brush,k=e.input(typeof x=="function"?x.apply(b,w):x,N.extent),I=u(b,w).beforestart();mc(b),N.selection=k===null?null:k,d.call(b),I.start().brush().end()})},c.clear=function(p){c.move(p,null)};function d(){var p=Es(this),x=xx(this).selection;x?(p.selectAll(".selection").style("display",null).attr("x",x[0][0]).attr("y",x[0][1]).attr("width",x[1][0]-x[0][0]).attr("height",x[1][1]-x[0][1]),p.selectAll(".handle").style("display",null).attr("x",function(b){return b.type[b.type.length-1]==="e"?x[1][0]-l/2:x[0][0]-l/2}).attr("y",function(b){return b.type[0]==="s"?x[1][1]-l/2:x[0][1]-l/2}).attr("width",function(b){return b.type==="n"||b.type==="s"?x[1][0]-x[0][0]+l:l}).attr("height",function(b){return b.type==="e"||b.type==="w"?x[1][1]-x[0][1]+l:l})):p.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function u(p,x,b){var w=p.__brush.emitter;return w&&(!b||!w.clean)?w:new f(p,x,b)}function f(p,x,b){this.that=p,this.args=x,this.state=p.__brush,this.active=0,this.clean=b}f.prototype={beforestart:function(){return++this.active===1&&(this.state.emitter=this,this.starting=!0),this},start:function(p,x){return this.starting?(this.starting=!1,this.emit("start",p,x)):this.emit("brush",p),this},brush:function(p,x){return this.emit("brush",p,x),this},end:function(p,x){return--this.active===0&&(delete this.state.emitter,this.emit("end",p,x)),this},emit:function(p,x,b){var w=Es(this.that).datum();i.call(p,this.that,new YX(p,{sourceEvent:x,target:c,selection:e.output(this.state.selection),mode:b,dispatch:i}),w)}};function m(p){if(a&&!p.touches||!n.apply(this,arguments))return;var x=this,b=p.target.__data__.type,w=(s&&p.metaKey?b="overlay":b)==="selection"?n6:s&&p.altKey?fu:du,N=e===qp?null:JX[b],k=e===Dp?null:ZX[b],I=xx(x),R=I.extent,T=I.selection,S=R[0][0],E,_,M=R[0][1],A,P,B=R[1][0],L,D,V=R[1][1],O,H,W=0,$=0,z,q=N&&k&&s&&p.shiftKey,G,re,oe=Array.from(p.touches||[p],$e=>{const De=$e.identifier;return $e=gi($e,x),$e.point0=$e.slice(),$e.identifier=De,$e});if(b==="overlay"){T&&(z=!0);const $e=[oe[0],oe[1]||oe[0]];I.selection=T=[[E=e===qp?S:vs($e[0][0],$e[1][0]),A=e===Dp?M:vs($e[0][1],$e[1][1])],[L=e===qp?B:ys($e[0][0],$e[1][0]),O=e===Dp?V:ys($e[0][1],$e[1][1])]],oe.length>1&&Ee()}else E=T[0][0],A=T[0][1],L=T[1][0],O=T[1][1];_=E,P=A,D=L,H=O;var ie=Es(x).attr("pointer-events","none"),Y=ie.selectAll(".overlay").attr("cursor",so[b]);mc(x);var te=u(x,arguments,!0).beforestart();if(p.touches)te.moved=me,te.ended=pe;else{var we=Es(p.view).on("mousemove.brush",me,!0).on("mouseup.brush",pe,!0);s&&we.on("keydown.brush",ee,!0).on("keyup.brush",ft,!0),N0(p.view)}d.call(x),te.start(p,w.name);function me($e){for(const De of $e.changedTouches||[$e])for(const ge of oe)ge.identifier===De.identifier&&(ge.cur=gi(De,x));if(q&&!G&&!re&&oe.length===1){const De=oe[0];r6(De.cur[0]-De[0])>r6(De.cur[1]-De[1])?re=!0:G=!0}for(const De of oe)De.cur&&(De[0]=De.cur[0],De[1]=De.cur[1]);z=!0,px($e),Ee($e)}function Ee($e){const De=oe[0],ge=De.point0;var Me;switch(W=De[0]-ge[0],$=De[1]-ge[1],w){case gx:case n6:{N&&(W=ys(S-E,vs(B-L,W)),_=E+W,D=L+W),k&&($=ys(M-A,vs(V-O,$)),P=A+$,H=O+$);break}case du:{oe[1]?(N&&(_=ys(S,vs(B,oe[0][0])),D=ys(S,vs(B,oe[1][0])),N=1),k&&(P=ys(M,vs(V,oe[0][1])),H=ys(M,vs(V,oe[1][1])),k=1)):(N<0?(W=ys(S-E,vs(B-E,W)),_=E+W,D=L):N>0&&(W=ys(S-L,vs(B-L,W)),_=E,D=L+W),k<0?($=ys(M-A,vs(V-A,$)),P=A+$,H=O):k>0&&($=ys(M-O,vs(V-O,$)),P=A,H=O+$));break}case fu:{N&&(_=ys(S,vs(B,E-W*N)),D=ys(S,vs(B,L+W*N))),k&&(P=ys(M,vs(V,A-$*k)),H=ys(M,vs(V,O+$*k)));break}}D<_&&(N*=-1,Me=E,E=L,L=Me,Me=_,_=D,D=Me,b in i6&&Y.attr("cursor",so[b=i6[b]])),H<P&&(k*=-1,Me=A,A=O,O=Me,Me=P,P=H,H=Me,b in a6&&Y.attr("cursor",so[b=a6[b]])),I.selection&&(T=I.selection),G&&(_=T[0][0],D=T[1][0]),re&&(P=T[0][1],H=T[1][1]),(T[0][0]!==_||T[0][1]!==P||T[1][0]!==D||T[1][1]!==H)&&(I.selection=[[_,P],[D,H]],d.call(x),te.brush($e,w.name))}function pe($e){if(XX($e),$e.touches){if($e.touches.length)return;a&&clearTimeout(a),a=setTimeout(function(){a=null},500)}else j0($e.view,z),we.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);ie.attr("pointer-events","all"),Y.attr("cursor",so.overlay),I.selection&&(T=I.selection),nK(T)&&(I.selection=null,d.call(x)),te.end($e,w.name)}function ee($e){switch($e.keyCode){case 16:{q=N&&k;break}case 18:{w===du&&(N&&(L=D-W*N,E=_+W*N),k&&(O=H-$*k,A=P+$*k),w=fu,Ee());break}case 32:{(w===du||w===fu)&&(N<0?L=D-W:N>0&&(E=_-W),k<0?O=H-$:k>0&&(A=P-$),w=gx,Y.attr("cursor",so.selection),Ee());break}default:return}px($e)}function ft($e){switch($e.keyCode){case 16:{q&&(G=re=q=!1,Ee());break}case 18:{w===fu&&(N<0?L=D:N>0&&(E=_),k<0?O=H:k>0&&(A=P),w=du,Ee());break}case 32:{w===gx&&($e.altKey?(N&&(L=D-W*N,E=_+W*N),k&&(O=H-$*k,A=P+$*k),w=fu):(N<0?L=D:N>0&&(E=_),k<0?O=H:k>0&&(A=P),w=du),Y.attr("cursor",so[b]),Ee());break}default:return}px($e)}}function h(p){u(this,arguments).moved(p)}function g(p){u(this,arguments).ended(p)}function y(){var p=this.__brush||{selection:null};return p.extent=Y5(t.apply(this,arguments)),p.dim=e,p}return c.extent=function(p){return arguments.length?(t=typeof p=="function"?p:mx(Y5(p)),c):t},c.filter=function(p){return arguments.length?(n=typeof p=="function"?p:mx(!!p),c):n},c.touchable=function(p){return arguments.length?(r=typeof p=="function"?p:mx(!!p),c):r},c.handleSize=function(p){return arguments.length?(l=+p,c):l},c.keyModifiers=function(p){return arguments.length?(s=!!p,c):s},c.on=function(){var p=i.on.apply(i,arguments);return p===i?c:p},c}var o6=Math.abs,hu=Math.cos,mu=Math.sin,ZT=Math.PI,Gm=ZT/2,l6=ZT*2,c6=Math.max,yx=1e-12;function vx(e,t){return Array.from({length:t-e},(n,r)=>e+r)}function oK(e){return function(t,n){return e(t.source.value+t.target.value,n.source.value+n.target.value)}}function lK(){return T3(!1,!1)}function cK(){return T3(!1,!0)}function uK(){return T3(!0,!1)}function T3(e,t){var n=0,r=null,s=null,i=null;function l(a){var c=a.length,d=new Array(c),u=vx(0,c),f=new Array(c*c),m=new Array(c),h=0,g;a=Float64Array.from({length:c*c},t?(y,p)=>a[p%c][p/c|0]:(y,p)=>a[p/c|0][p%c]);for(let y=0;y<c;++y){let p=0;for(let x=0;x<c;++x)p+=a[y*c+x]+e*a[x*c+y];h+=d[y]=p}h=c6(0,l6-n*c)/h,g=h?n:l6/c;{let y=0;r&&u.sort((p,x)=>r(d[p],d[x]));for(const p of u){const x=y;if(e){const b=vx(~c+1,c).filter(w=>w<0?a[~w*c+p]:a[p*c+w]);s&&b.sort((w,N)=>s(w<0?-a[~w*c+p]:a[p*c+w],N<0?-a[~N*c+p]:a[p*c+N]));for(const w of b)if(w<0){const N=f[~w*c+p]||(f[~w*c+p]={source:null,target:null});N.target={index:p,startAngle:y,endAngle:y+=a[~w*c+p]*h,value:a[~w*c+p]}}else{const N=f[p*c+w]||(f[p*c+w]={source:null,target:null});N.source={index:p,startAngle:y,endAngle:y+=a[p*c+w]*h,value:a[p*c+w]}}m[p]={index:p,startAngle:x,endAngle:y,value:d[p]}}else{const b=vx(0,c).filter(w=>a[p*c+w]||a[w*c+p]);s&&b.sort((w,N)=>s(a[p*c+w],a[p*c+N]));for(const w of b){let N;if(p<w?(N=f[p*c+w]||(f[p*c+w]={source:null,target:null}),N.source={index:p,startAngle:y,endAngle:y+=a[p*c+w]*h,value:a[p*c+w]}):(N=f[w*c+p]||(f[w*c+p]={source:null,target:null}),N.target={index:p,startAngle:y,endAngle:y+=a[p*c+w]*h,value:a[p*c+w]},p===w&&(N.source=N.target)),N.source&&N.target&&N.source.value<N.target.value){const k=N.source;N.source=N.target,N.target=k}}m[p]={index:p,startAngle:x,endAngle:y,value:d[p]}}y+=g}}return f=Object.values(f),f.groups=m,i?f.sort(i):f}return l.padAngle=function(a){return arguments.length?(n=c6(0,a),l):n},l.sortGroups=function(a){return arguments.length?(r=a,l):r},l.sortSubgroups=function(a){return arguments.length?(s=a,l):s},l.sortChords=function(a){return arguments.length?(a==null?i=null:(i=oK(a))._=a,l):i&&i._},l}const X5=Math.PI,K5=2*X5,Ql=1e-6,dK=K5-Ql;function J5(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function Sl(){return new J5}J5.prototype=Sl.prototype={constructor:J5,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(e,t,n,r,s,i){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+s)+","+(this._y1=+i)},arcTo:function(e,t,n,r,s){e=+e,t=+t,n=+n,r=+r,s=+s;var i=this._x1,l=this._y1,a=n-e,c=r-t,d=i-e,u=l-t,f=d*d+u*u;if(s<0)throw new Error("negative radius: "+s);if(this._x1===null)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(f>Ql)if(!(Math.abs(u*a-c*d)>Ql)||!s)this._+="L"+(this._x1=e)+","+(this._y1=t);else{var m=n-i,h=r-l,g=a*a+c*c,y=m*m+h*h,p=Math.sqrt(g),x=Math.sqrt(f),b=s*Math.tan((X5-Math.acos((g+f-y)/(2*p*x)))/2),w=b/x,N=b/p;Math.abs(w-1)>Ql&&(this._+="L"+(e+w*d)+","+(t+w*u)),this._+="A"+s+","+s+",0,0,"+ +(u*m>d*h)+","+(this._x1=e+N*a)+","+(this._y1=t+N*c)}},arc:function(e,t,n,r,s,i){e=+e,t=+t,n=+n,i=!!i;var l=n*Math.cos(r),a=n*Math.sin(r),c=e+l,d=t+a,u=1^i,f=i?r-s:s-r;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+c+","+d:(Math.abs(this._x1-c)>Ql||Math.abs(this._y1-d)>Ql)&&(this._+="L"+c+","+d),n&&(f<0&&(f=f%K5+K5),f>dK?this._+="A"+n+","+n+",0,1,"+u+","+(e-l)+","+(t-a)+"A"+n+","+n+",0,1,"+u+","+(this._x1=c)+","+(this._y1=d):f>Ql&&(this._+="A"+n+","+n+",0,"+ +(f>=X5)+","+u+","+(this._x1=e+n*Math.cos(s))+","+(this._y1=t+n*Math.sin(s))))},rect:function(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var fK=Array.prototype.slice;function Jl(e){return function(){return e}}function hK(e){return e.source}function mK(e){return e.target}function u6(e){return e.radius}function pK(e){return e.startAngle}function gK(e){return e.endAngle}function xK(){return 0}function yK(){return 10}function QT(e){var t=hK,n=mK,r=u6,s=u6,i=pK,l=gK,a=xK,c=null;function d(){var u,f=t.apply(this,arguments),m=n.apply(this,arguments),h=a.apply(this,arguments)/2,g=fK.call(arguments),y=+r.apply(this,(g[0]=f,g)),p=i.apply(this,g)-Gm,x=l.apply(this,g)-Gm,b=+s.apply(this,(g[0]=m,g)),w=i.apply(this,g)-Gm,N=l.apply(this,g)-Gm;if(c||(c=u=Sl()),h>yx&&(o6(x-p)>h*2+yx?x>p?(p+=h,x-=h):(p-=h,x+=h):p=x=(p+x)/2,o6(N-w)>h*2+yx?N>w?(w+=h,N-=h):(w-=h,N+=h):w=N=(w+N)/2),c.moveTo(y*hu(p),y*mu(p)),c.arc(0,0,y,p,x),p!==w||x!==N)if(e){var k=+e.apply(this,arguments),I=b-k,R=(w+N)/2;c.quadraticCurveTo(0,0,I*hu(w),I*mu(w)),c.lineTo(b*hu(R),b*mu(R)),c.lineTo(I*hu(N),I*mu(N))}else c.quadraticCurveTo(0,0,b*hu(w),b*mu(w)),c.arc(0,0,b,w,N);if(c.quadraticCurveTo(0,0,y*hu(p),y*mu(p)),c.closePath(),u)return c=null,u+""||null}return e&&(d.headRadius=function(u){return arguments.length?(e=typeof u=="function"?u:Jl(+u),d):e}),d.radius=function(u){return arguments.length?(r=s=typeof u=="function"?u:Jl(+u),d):r},d.sourceRadius=function(u){return arguments.length?(r=typeof u=="function"?u:Jl(+u),d):r},d.targetRadius=function(u){return arguments.length?(s=typeof u=="function"?u:Jl(+u),d):s},d.startAngle=function(u){return arguments.length?(i=typeof u=="function"?u:Jl(+u),d):i},d.endAngle=function(u){return arguments.length?(l=typeof u=="function"?u:Jl(+u),d):l},d.padAngle=function(u){return arguments.length?(a=typeof u=="function"?u:Jl(+u),d):a},d.source=function(u){return arguments.length?(t=u,d):t},d.target=function(u){return arguments.length?(n=u,d):n},d.context=function(u){return arguments.length?(c=u??null,d):c},d}function vK(){return QT()}function bK(){return QT(yK)}var wK=Array.prototype,e9=wK.slice;function NK(e,t){return e-t}function jK(e){for(var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r}const tl=e=>()=>e;function _K(e,t){for(var n=-1,r=t.length,s;++n<r;)if(s=SK(e,t[n]))return s;return 0}function SK(e,t){for(var n=t[0],r=t[1],s=-1,i=0,l=e.length,a=l-1;i<l;a=i++){var c=e[i],d=c[0],u=c[1],f=e[a],m=f[0],h=f[1];if(AK(c,f,t))return 0;u>r!=h>r&&n<(m-d)*(r-u)/(h-u)+d&&(s=-s)}return s}function AK(e,t,n){var r;return kK(e,t,n)&&EK(e[r=+(e[0]===t[0])],n[r],t[r])}function kK(e,t,n){return(t[0]-e[0])*(n[1]-e[1])===(n[0]-e[0])*(t[1]-e[1])}function EK(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function CK(){}var io=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function t9(){var e=1,t=1,n=d3,r=c;function s(d){var u=n(d);if(Array.isArray(u))u=u.slice().sort(NK);else{var f=nh(d),m=f[0],h=f[1];u=Ju(m,h,u),u=Pa(Math.floor(m/u)*u,Math.floor(h/u)*u,u)}return u.map(function(g){return i(d,g)})}function i(d,u){var f=[],m=[];return l(d,u,function(h){r(h,d,u),jK(h)>0?f.push([h]):m.push(h)}),m.forEach(function(h){for(var g=0,y=f.length,p;g<y;++g)if(_K((p=f[g])[0],h)!==-1){p.push(h);return}}),{type:"MultiPolygon",value:u,coordinates:f}}function l(d,u,f){var m=new Array,h=new Array,g,y,p,x,b,w;for(g=y=-1,x=d[0]>=u,io[x<<1].forEach(N);++g<e-1;)p=x,x=d[g+1]>=u,io[p|x<<1].forEach(N);for(io[x<<0].forEach(N);++y<t-1;){for(g=-1,x=d[y*e+e]>=u,b=d[y*e]>=u,io[x<<1|b<<2].forEach(N);++g<e-1;)p=x,x=d[y*e+e+g+1]>=u,w=b,b=d[y*e+g+1]>=u,io[p|x<<1|b<<2|w<<3].forEach(N);io[x|b<<3].forEach(N)}for(g=-1,b=d[y*e]>=u,io[b<<2].forEach(N);++g<e-1;)w=b,b=d[y*e+g+1]>=u,io[b<<2|w<<3].forEach(N);io[b<<3].forEach(N);function N(k){var I=[k[0][0]+g,k[0][1]+y],R=[k[1][0]+g,k[1][1]+y],T=a(I),S=a(R),E,_;(E=h[T])?(_=m[S])?(delete h[E.end],delete m[_.start],E===_?(E.ring.push(R),f(E.ring)):m[E.start]=h[_.end]={start:E.start,end:_.end,ring:E.ring.concat(_.ring)}):(delete h[E.end],E.ring.push(R),h[E.end=S]=E):(E=m[S])?(_=h[T])?(delete m[E.start],delete h[_.end],E===_?(E.ring.push(R),f(E.ring)):m[_.start]=h[E.end]={start:_.start,end:E.end,ring:_.ring.concat(E.ring)}):(delete m[E.start],E.ring.unshift(I),m[E.start=T]=E):m[T]=h[S]={start:T,end:S,ring:[I,R]}}}function a(d){return d[0]*2+d[1]*(e+1)*4}function c(d,u,f){d.forEach(function(m){var h=m[0],g=m[1],y=h|0,p=g|0,x,b=u[p*e+y];h>0&&h<e&&y===h&&(x=u[p*e+y-1],m[0]=h+(f-x)/(b-x)-.5),g>0&&g<t&&p===g&&(x=u[(p-1)*e+y],m[1]=g+(f-x)/(b-x)-.5)})}return s.contour=i,s.size=function(d){if(!arguments.length)return[e,t];var u=Math.floor(d[0]),f=Math.floor(d[1]);if(!(u>=0&&f>=0))throw new Error("invalid size");return e=u,t=f,s},s.thresholds=function(d){return arguments.length?(n=typeof d=="function"?d:Array.isArray(d)?tl(e9.call(d)):tl(d),s):n},s.smooth=function(d){return arguments.length?(r=d?c:CK,s):r===c},s}function bx(e,t,n){for(var r=e.width,s=e.height,i=(n<<1)+1,l=0;l<s;++l)for(var a=0,c=0;a<r+n;++a)a<r&&(c+=e.data[a+l*r]),a>=n&&(a>=i&&(c-=e.data[a-i+l*r]),t.data[a-n+l*r]=c/Math.min(a+1,r-1+i-a,i))}function wx(e,t,n){for(var r=e.width,s=e.height,i=(n<<1)+1,l=0;l<r;++l)for(var a=0,c=0;a<s+n;++a)a<s&&(c+=e.data[l+a*r]),a>=n&&(a>=i&&(c-=e.data[l+(a-i)*r]),t.data[l+(a-n)*r]=c/Math.min(a+1,s-1+i-a,i))}function PK(e){return e[0]}function IK(e){return e[1]}function TK(){return 1}function LK(){var e=PK,t=IK,n=TK,r=960,s=500,i=20,l=2,a=i*3,c=r+a*2>>l,d=s+a*2>>l,u=tl(20);function f(x){var b=new Float32Array(c*d),w=new Float32Array(c*d);x.forEach(function(I,R,T){var S=+e(I,R,T)+a>>l,E=+t(I,R,T)+a>>l,_=+n(I,R,T);S>=0&&S<c&&E>=0&&E<d&&(b[S+E*c]+=_)}),bx({width:c,height:d,data:b},{data:w},i>>l),wx({width:c,height:d,data:w},{data:b},i>>l),bx({width:c,height:d,data:b},{data:w},i>>l),wx({width:c,height:d,data:w},{data:b},i>>l),bx({width:c,height:d,data:b},{data:w},i>>l),wx({width:c,height:d,data:w},{data:b},i>>l);var N=u(b);if(!Array.isArray(N)){var k=ig(b);N=Ju(0,k,N),N=Pa(0,Math.floor(k/N)*N,N),N.shift()}return t9().thresholds(N).size([c,d])(b).map(m)}function m(x){return x.value*=Math.pow(2,-2*l),x.coordinates.forEach(h),x}function h(x){x.forEach(g)}function g(x){x.forEach(y)}function y(x){x[0]=x[0]*Math.pow(2,l)-a,x[1]=x[1]*Math.pow(2,l)-a}function p(){return a=i*3,c=r+a*2>>l,d=s+a*2>>l,f}return f.x=function(x){return arguments.length?(e=typeof x=="function"?x:tl(+x),f):e},f.y=function(x){return arguments.length?(t=typeof x=="function"?x:tl(+x),f):t},f.weight=function(x){return arguments.length?(n=typeof x=="function"?x:tl(+x),f):n},f.size=function(x){if(!arguments.length)return[r,s];var b=+x[0],w=+x[1];if(!(b>=0&&w>=0))throw new Error("invalid size");return r=b,s=w,p()},f.cellSize=function(x){if(!arguments.length)return 1<<l;if(!((x=+x)>=1))throw new Error("invalid cell size");return l=Math.floor(Math.log(x)/Math.LN2),p()},f.thresholds=function(x){return arguments.length?(u=typeof x=="function"?x:Array.isArray(x)?tl(e9.call(x)):tl(x),f):u},f.bandwidth=function(x){if(!arguments.length)return Math.sqrt(i*(i+1));if(!((x=+x)>=0))throw new Error("invalid bandwidth");return i=Math.round((Math.sqrt(4*x*x+1)-1)/2),p()},f}const d6=Math.pow(2,-52),Ym=new Uint32Array(512);class mg{static from(t,n=FK,r=DK){const s=t.length,i=new Float64Array(s*2);for(let l=0;l<s;l++){const a=t[l];i[2*l]=n(a),i[2*l+1]=r(a)}return new mg(i)}constructor(t){const n=t.length>>1;if(n>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const r=Math.max(2*n-5,0);this._triangles=new Uint32Array(r*3),this._halfedges=new Int32Array(r*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:r,_hullTri:s,_hullHash:i}=this,l=t.length>>1;let a=1/0,c=1/0,d=-1/0,u=-1/0;for(let E=0;E<l;E++){const _=t[2*E],M=t[2*E+1];_<a&&(a=_),M<c&&(c=M),_>d&&(d=_),M>u&&(u=M),this._ids[E]=E}const f=(a+d)/2,m=(c+u)/2;let h=1/0,g,y,p;for(let E=0;E<l;E++){const _=Nx(f,m,t[2*E],t[2*E+1]);_<h&&(g=E,h=_)}const x=t[2*g],b=t[2*g+1];h=1/0;for(let E=0;E<l;E++){if(E===g)continue;const _=Nx(x,b,t[2*E],t[2*E+1]);_<h&&_>0&&(y=E,h=_)}let w=t[2*y],N=t[2*y+1],k=1/0;for(let E=0;E<l;E++){if(E===g||E===y)continue;const _=$K(x,b,w,N,t[2*E],t[2*E+1]);_<k&&(p=E,k=_)}let I=t[2*p],R=t[2*p+1];if(k===1/0){for(let M=0;M<l;M++)this._dists[M]=t[2*M]-t[0]||t[2*M+1]-t[1];Cu(this._ids,this._dists,0,l-1);const E=new Uint32Array(l);let _=0;for(let M=0,A=-1/0;M<l;M++){const P=this._ids[M];this._dists[P]>A&&(E[_++]=P,A=this._dists[P])}this.hull=E.subarray(0,_),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(Xm(x,b,w,N,I,R)){const E=y,_=w,M=N;y=p,w=I,N=R,p=E,I=_,R=M}const T=OK(x,b,w,N,I,R);this._cx=T.x,this._cy=T.y;for(let E=0;E<l;E++)this._dists[E]=Nx(t[2*E],t[2*E+1],T.x,T.y);Cu(this._ids,this._dists,0,l-1),this._hullStart=g;let S=3;r[g]=n[p]=y,r[y]=n[g]=p,r[p]=n[y]=g,s[g]=0,s[y]=1,s[p]=2,i.fill(-1),i[this._hashKey(x,b)]=g,i[this._hashKey(w,N)]=y,i[this._hashKey(I,R)]=p,this.trianglesLen=0,this._addTriangle(g,y,p,-1,-1,-1);for(let E=0,_,M;E<this._ids.length;E++){const A=this._ids[E],P=t[2*A],B=t[2*A+1];if(E>0&&Math.abs(P-_)<=d6&&Math.abs(B-M)<=d6||(_=P,M=B,A===g||A===y||A===p))continue;let L=0;for(let W=0,$=this._hashKey(P,B);W<this._hashSize&&(L=i[($+W)%this._hashSize],!(L!==-1&&L!==r[L]));W++);L=n[L];let D=L,V;for(;V=r[D],!Xm(P,B,t[2*D],t[2*D+1],t[2*V],t[2*V+1]);)if(D=V,D===L){D=-1;break}if(D===-1)continue;let O=this._addTriangle(D,A,r[D],-1,-1,s[D]);s[A]=this._legalize(O+2),s[D]=O,S++;let H=r[D];for(;V=r[H],Xm(P,B,t[2*H],t[2*H+1],t[2*V],t[2*V+1]);)O=this._addTriangle(H,A,V,s[A],-1,s[H]),s[A]=this._legalize(O+2),r[H]=H,S--,H=V;if(D===L)for(;V=n[D],Xm(P,B,t[2*V],t[2*V+1],t[2*D],t[2*D+1]);)O=this._addTriangle(V,A,D,-1,s[D],s[V]),this._legalize(O+2),s[V]=O,r[D]=D,S--,D=V;this._hullStart=n[A]=D,r[D]=n[H]=A,r[A]=H,i[this._hashKey(P,B)]=A,i[this._hashKey(t[2*D],t[2*D+1])]=D}this.hull=new Uint32Array(S);for(let E=0,_=this._hullStart;E<S;E++)this.hull[E]=_,_=r[_];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(MK(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:r,coords:s}=this;let i=0,l=0;for(;;){const a=r[t],c=t-t%3;if(l=c+(t+2)%3,a===-1){if(i===0)break;t=Ym[--i];continue}const d=a-a%3,u=c+(t+1)%3,f=d+(a+2)%3,m=n[l],h=n[t],g=n[u],y=n[f];if(RK(s[2*m],s[2*m+1],s[2*h],s[2*h+1],s[2*g],s[2*g+1],s[2*y],s[2*y+1])){n[t]=y,n[a]=m;const x=r[f];if(x===-1){let w=this._hullStart;do{if(this._hullTri[w]===f){this._hullTri[w]=t;break}w=this._hullPrev[w]}while(w!==this._hullStart)}this._link(t,x),this._link(a,r[l]),this._link(l,f);const b=d+(a+1)%3;i<Ym.length&&(Ym[i++]=b)}else{if(i===0)break;t=Ym[--i]}}return l}_link(t,n){this._halfedges[t]=n,n!==-1&&(this._halfedges[n]=t)}_addTriangle(t,n,r,s,i,l){const a=this.trianglesLen;return this._triangles[a]=t,this._triangles[a+1]=n,this._triangles[a+2]=r,this._link(a,s),this._link(a+1,i),this._link(a+2,l),this.trianglesLen+=3,a}}function MK(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function Nx(e,t,n,r){const s=e-n,i=t-r;return s*s+i*i}function jx(e,t,n,r,s,i){const l=(r-t)*(s-e),a=(n-e)*(i-t);return Math.abs(l-a)>=33306690738754716e-32*Math.abs(l+a)?l-a:0}function Xm(e,t,n,r,s,i){return(jx(s,i,e,t,n,r)||jx(e,t,n,r,s,i)||jx(n,r,s,i,e,t))<0}function RK(e,t,n,r,s,i,l,a){const c=e-l,d=t-a,u=n-l,f=r-a,m=s-l,h=i-a,g=c*c+d*d,y=u*u+f*f,p=m*m+h*h;return c*(f*p-y*h)-d*(u*p-y*m)+g*(u*h-f*m)<0}function $K(e,t,n,r,s,i){const l=n-e,a=r-t,c=s-e,d=i-t,u=l*l+a*a,f=c*c+d*d,m=.5/(l*d-a*c),h=(d*u-a*f)*m,g=(l*f-c*u)*m;return h*h+g*g}function OK(e,t,n,r,s,i){const l=n-e,a=r-t,c=s-e,d=i-t,u=l*l+a*a,f=c*c+d*d,m=.5/(l*d-a*c),h=e+(d*u-a*f)*m,g=t+(l*f-c*u)*m;return{x:h,y:g}}function Cu(e,t,n,r){if(r-n<=20)for(let s=n+1;s<=r;s++){const i=e[s],l=t[i];let a=s-1;for(;a>=n&&t[e[a]]>l;)e[a+1]=e[a--];e[a+1]=i}else{const s=n+r>>1;let i=n+1,l=r;gf(e,s,i),t[e[n]]>t[e[r]]&&gf(e,n,r),t[e[i]]>t[e[r]]&&gf(e,i,r),t[e[n]]>t[e[i]]&&gf(e,n,i);const a=e[i],c=t[a];for(;;){do i++;while(t[e[i]]<c);do l--;while(t[e[l]]>c);if(l<i)break;gf(e,i,l)}e[n+1]=e[l],e[l]=a,r-i+1>=l-n?(Cu(e,t,i,r),Cu(e,t,n,l-1)):(Cu(e,t,n,l-1),Cu(e,t,i,r))}}function gf(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function FK(e){return e[0]}function DK(e){return e[1]}const f6=1e-6;class lc{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,r){t=+t,n=+n,r=+r;const s=t+r,i=n;if(r<0)throw new Error("negative radius");this._x1===null?this._+=`M${s},${i}`:(Math.abs(this._x1-s)>f6||Math.abs(this._y1-i)>f6)&&(this._+="L"+s+","+i),r&&(this._+=`A${r},${r},0,1,1,${t-r},${n}A${r},${r},0,1,1,${this._x1=s},${this._y1=i}`)}rect(t,n,r,s){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+r}v${+s}h${-r}Z`}value(){return this._||null}}class Z5{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}class n9{constructor(t,[n,r,s,i]=[0,0,960,500]){if(!((s=+s)>=(n=+n))||!((i=+i)>=(r=+r)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=s,this.xmin=n,this.ymax=i,this.ymin=r,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:n,triangles:r},vectors:s}=this,i=this.circumcenters=this._circumcenters.subarray(0,r.length/3*2);for(let h=0,g=0,y=r.length,p,x;h<y;h+=3,g+=2){const b=r[h]*2,w=r[h+1]*2,N=r[h+2]*2,k=t[b],I=t[b+1],R=t[w],T=t[w+1],S=t[N],E=t[N+1],_=R-k,M=T-I,A=S-k,P=E-I,B=_*_+M*M,L=A*A+P*P,D=(_*P-M*A)*2;if(!D)p=(k+S)/2-1e8*P,x=(I+E)/2+1e8*A;else if(Math.abs(D)<1e-8)p=(k+S)/2,x=(I+E)/2;else{const V=1/D;p=k+(P*B-M*L)*V,x=I+(_*L-A*B)*V}i[g]=p,i[g+1]=x}let l=n[n.length-1],a,c=l*4,d,u=t[2*l],f,m=t[2*l+1];s.fill(0);for(let h=0;h<n.length;++h)l=n[h],a=c,d=u,f=m,c=l*4,u=t[2*l],m=t[2*l+1],s[a+2]=s[c]=f-m,s[a+3]=s[c+1]=u-d}render(t){const n=t==null?t=new lc:void 0,{delaunay:{halfedges:r,inedges:s,hull:i},circumcenters:l,vectors:a}=this;if(i.length<=1)return null;for(let u=0,f=r.length;u<f;++u){const m=r[u];if(m<u)continue;const h=Math.floor(u/3)*2,g=Math.floor(m/3)*2,y=l[h],p=l[h+1],x=l[g],b=l[g+1];this._renderSegment(y,p,x,b,t)}let c,d=i[i.length-1];for(let u=0;u<i.length;++u){c=d,d=i[u];const f=Math.floor(s[d]/3)*2,m=l[f],h=l[f+1],g=c*4,y=this._project(m,h,a[g+2],a[g+3]);y&&this._renderSegment(m,h,y[0],y[1],t)}return n&&n.value()}renderBounds(t){const n=t==null?t=new lc:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){const r=n==null?n=new lc:void 0,s=this._clip(t);if(s===null||!s.length)return;n.moveTo(s[0],s[1]);let i=s.length;for(;s[0]===s[i-2]&&s[1]===s[i-1]&&i>1;)i-=2;for(let l=2;l<i;l+=2)(s[l]!==s[l-2]||s[l+1]!==s[l-1])&&n.lineTo(s[l],s[l+1]);return n.closePath(),r&&r.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let n=0,r=t.length/2;n<r;++n){const s=this.cellPolygon(n);s&&(s.index=n,yield s)}}cellPolygon(t){const n=new Z5;return this.renderCell(t,n),n.value()}_renderSegment(t,n,r,s,i){let l;const a=this._regioncode(t,n),c=this._regioncode(r,s);a===0&&c===0?(i.moveTo(t,n),i.lineTo(r,s)):(l=this._clipSegment(t,n,r,s,a,c))&&(i.moveTo(l[0],l[1]),i.lineTo(l[2],l[3]))}contains(t,n,r){return n=+n,n!==n||(r=+r,r!==r)?!1:this.delaunay._step(t,n,r)===t}*neighbors(t){const n=this._clip(t);if(n)for(const r of this.delaunay.neighbors(t)){const s=this._clip(r);if(s){e:for(let i=0,l=n.length;i<l;i+=2)for(let a=0,c=s.length;a<c;a+=2)if(n[i]==s[a]&&n[i+1]==s[a+1]&&n[(i+2)%l]==s[(a+c-2)%c]&&n[(i+3)%l]==s[(a+c-1)%c]){yield r;break e}}}}_cell(t){const{circumcenters:n,delaunay:{inedges:r,halfedges:s,triangles:i}}=this,l=r[t];if(l===-1)return null;const a=[];let c=l;do{const d=Math.floor(c/3);if(a.push(n[d*2],n[d*2+1]),c=c%3===2?c-2:c+1,i[c]!==t)break;c=s[c]}while(c!==l&&c!==-1);return a}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(t);if(n===null)return null;const{vectors:r}=this,s=t*4;return r[s]||r[s+1]?this._clipInfinite(t,n,r[s],r[s+1],r[s+2],r[s+3]):this._clipFinite(t,n)}_clipFinite(t,n){const r=n.length;let s=null,i,l,a=n[r-2],c=n[r-1],d,u=this._regioncode(a,c),f,m;for(let h=0;h<r;h+=2)if(i=a,l=c,a=n[h],c=n[h+1],d=u,u=this._regioncode(a,c),d===0&&u===0)f=m,m=0,s?s.push(a,c):s=[a,c];else{let g,y,p,x,b;if(d===0){if((g=this._clipSegment(i,l,a,c,d,u))===null)continue;[y,p,x,b]=g}else{if((g=this._clipSegment(a,c,i,l,u,d))===null)continue;[x,b,y,p]=g,f=m,m=this._edgecode(y,p),f&&m&&this._edge(t,f,m,s,s.length),s?s.push(y,p):s=[y,p]}f=m,m=this._edgecode(x,b),f&&m&&this._edge(t,f,m,s,s.length),s?s.push(x,b):s=[x,b]}if(s)f=m,m=this._edgecode(s[0],s[1]),f&&m&&this._edge(t,f,m,s,s.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return s}_clipSegment(t,n,r,s,i,l){for(;;){if(i===0&&l===0)return[t,n,r,s];if(i&l)return null;let a,c,d=i||l;d&8?(a=t+(r-t)*(this.ymax-n)/(s-n),c=this.ymax):d&4?(a=t+(r-t)*(this.ymin-n)/(s-n),c=this.ymin):d&2?(c=n+(s-n)*(this.xmax-t)/(r-t),a=this.xmax):(c=n+(s-n)*(this.xmin-t)/(r-t),a=this.xmin),i?(t=a,n=c,i=this._regioncode(t,n)):(r=a,s=c,l=this._regioncode(r,s))}}_clipInfinite(t,n,r,s,i,l){let a=Array.from(n),c;if((c=this._project(a[0],a[1],r,s))&&a.unshift(c[0],c[1]),(c=this._project(a[a.length-2],a[a.length-1],i,l))&&a.push(c[0],c[1]),a=this._clipFinite(t,a))for(let d=0,u=a.length,f,m=this._edgecode(a[u-2],a[u-1]);d<u;d+=2)f=m,m=this._edgecode(a[d],a[d+1]),f&&m&&(d=this._edge(t,f,m,a,d),u=a.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(t,n,r,s,i){for(;n!==r;){let l,a;switch(n){case 5:n=4;continue;case 4:n=6,l=this.xmax,a=this.ymin;break;case 6:n=2;continue;case 2:n=10,l=this.xmax,a=this.ymax;break;case 10:n=8;continue;case 8:n=9,l=this.xmin,a=this.ymax;break;case 9:n=1;continue;case 1:n=5,l=this.xmin,a=this.ymin;break}(s[i]!==l||s[i+1]!==a)&&this.contains(t,l,a)&&(s.splice(i,0,l,a),i+=2)}if(s.length>4)for(let l=0;l<s.length;l+=2){const a=(l+2)%s.length,c=(l+4)%s.length;(s[l]===s[a]&&s[a]===s[c]||s[l+1]===s[a+1]&&s[a+1]===s[c+1])&&(s.splice(a,2),l-=2)}return i}_project(t,n,r,s){let i=1/0,l,a,c;if(s<0){if(n<=this.ymin)return null;(l=(this.ymin-n)/s)<i&&(c=this.ymin,a=t+(i=l)*r)}else if(s>0){if(n>=this.ymax)return null;(l=(this.ymax-n)/s)<i&&(c=this.ymax,a=t+(i=l)*r)}if(r>0){if(t>=this.xmax)return null;(l=(this.xmax-t)/r)<i&&(a=this.xmax,c=n+(i=l)*s)}else if(r<0){if(t<=this.xmin)return null;(l=(this.xmin-t)/r)<i&&(a=this.xmin,c=n+(i=l)*s)}return[a,c]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}}const qK=2*Math.PI,pu=Math.pow;function BK(e){return e[0]}function zK(e){return e[1]}function UK(e){const{triangles:t,coords:n}=e;for(let r=0;r<t.length;r+=3){const s=2*t[r],i=2*t[r+1],l=2*t[r+2];if((n[l]-n[s])*(n[i+1]-n[s+1])-(n[i]-n[s])*(n[l+1]-n[s+1])>1e-10)return!1}return!0}function HK(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class L3{static from(t,n=BK,r=zK,s){return new L3("length"in t?VK(t,n,r,s):Float64Array.from(WK(t,n,r,s)))}constructor(t){this._delaunator=new mg(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&UK(t)){this.collinear=Int32Array.from({length:n.length/2},(m,h)=>h).sort((m,h)=>n[2*m]-n[2*h]||n[2*m+1]-n[2*h+1]);const c=this.collinear[0],d=this.collinear[this.collinear.length-1],u=[n[2*c],n[2*c+1],n[2*d],n[2*d+1]],f=1e-8*Math.hypot(u[3]-u[1],u[2]-u[0]);for(let m=0,h=n.length/2;m<h;++m){const g=HK(n[2*m],n[2*m+1],f);n[2*m]=g[0],n[2*m+1]=g[1]}this._delaunator=new mg(n)}else delete this.collinear;const r=this.halfedges=this._delaunator.halfedges,s=this.hull=this._delaunator.hull,i=this.triangles=this._delaunator.triangles,l=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let c=0,d=r.length;c<d;++c){const u=i[c%3===2?c-2:c+1];(r[c]===-1||l[u]===-1)&&(l[u]=c)}for(let c=0,d=s.length;c<d;++c)a[s[c]]=c;s.length<=2&&s.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=s[0],this.triangles[1]=s[1],this.triangles[2]=s[1],l[s[0]]=1,s.length===2&&(l[s[1]]=0))}voronoi(t){return new n9(this,t)}*neighbors(t){const{inedges:n,hull:r,_hullIndex:s,halfedges:i,triangles:l,collinear:a}=this;if(a){const f=a.indexOf(t);f>0&&(yield a[f-1]),f<a.length-1&&(yield a[f+1]);return}const c=n[t];if(c===-1)return;let d=c,u=-1;do{if(yield u=l[d],d=d%3===2?d-2:d+1,l[d]!==t)return;if(d=i[d],d===-1){const f=r[(s[t]+1)%r.length];f!==u&&(yield f);return}}while(d!==c)}find(t,n,r=0){if(t=+t,t!==t||(n=+n,n!==n))return-1;const s=r;let i;for(;(i=this._step(r,t,n))>=0&&i!==r&&i!==s;)r=i;return i}_step(t,n,r){const{inedges:s,hull:i,_hullIndex:l,halfedges:a,triangles:c,points:d}=this;if(s[t]===-1||!d.length)return(t+1)%(d.length>>1);let u=t,f=pu(n-d[t*2],2)+pu(r-d[t*2+1],2);const m=s[t];let h=m;do{let g=c[h];const y=pu(n-d[g*2],2)+pu(r-d[g*2+1],2);if(y<f&&(f=y,u=g),h=h%3===2?h-2:h+1,c[h]!==t)break;if(h=a[h],h===-1){if(h=i[(l[t]+1)%i.length],h!==g&&pu(n-d[h*2],2)+pu(r-d[h*2+1],2)<f)return h;break}}while(h!==m);return u}render(t){const n=t==null?t=new lc:void 0,{points:r,halfedges:s,triangles:i}=this;for(let l=0,a=s.length;l<a;++l){const c=s[l];if(c<l)continue;const d=i[l]*2,u=i[c]*2;t.moveTo(r[d],r[d+1]),t.lineTo(r[u],r[u+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n=2){const r=t==null?t=new lc:void 0,{points:s}=this;for(let i=0,l=s.length;i<l;i+=2){const a=s[i],c=s[i+1];t.moveTo(a+n,c),t.arc(a,c,n,0,qK)}return r&&r.value()}renderHull(t){const n=t==null?t=new lc:void 0,{hull:r,points:s}=this,i=r[0]*2,l=r.length;t.moveTo(s[i],s[i+1]);for(let a=1;a<l;++a){const c=2*r[a];t.lineTo(s[c],s[c+1])}return t.closePath(),n&&n.value()}hullPolygon(){const t=new Z5;return this.renderHull(t),t.value()}renderTriangle(t,n){const r=n==null?n=new lc:void 0,{points:s,triangles:i}=this,l=i[t*=3]*2,a=i[t+1]*2,c=i[t+2]*2;return n.moveTo(s[l],s[l+1]),n.lineTo(s[a],s[a+1]),n.lineTo(s[c],s[c+1]),n.closePath(),r&&r.value()}*trianglePolygons(){const{triangles:t}=this;for(let n=0,r=t.length/3;n<r;++n)yield this.trianglePolygon(n)}trianglePolygon(t){const n=new Z5;return this.renderTriangle(t,n),n.value()}}function VK(e,t,n,r){const s=e.length,i=new Float64Array(s*2);for(let l=0;l<s;++l){const a=e[l];i[l*2]=t.call(r,a,l,e),i[l*2+1]=n.call(r,a,l,e)}return i}function*WK(e,t,n,r){let s=0;for(const i of e)yield t.call(r,i,s,e),yield n.call(r,i,s,e),++s}var h6={},_x={},Sx=34,xf=10,Ax=13;function r9(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function GK(e,t){var n=r9(e);return function(r,s){return t(n(r),s,e)}}function m6(e){var t=Object.create(null),n=[];return e.forEach(function(r){for(var s in r)s in t||n.push(t[s]=s)}),n}function Ys(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function YK(e){return e<0?"-"+Ys(-e,6):e>9999?"+"+Ys(e,6):Ys(e,4)}function XK(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),s=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":YK(e.getUTCFullYear())+"-"+Ys(e.getUTCMonth()+1,2)+"-"+Ys(e.getUTCDate(),2)+(s?"T"+Ys(t,2)+":"+Ys(n,2)+":"+Ys(r,2)+"."+Ys(s,3)+"Z":r?"T"+Ys(t,2)+":"+Ys(n,2)+":"+Ys(r,2)+"Z":n||t?"T"+Ys(t,2)+":"+Ys(n,2)+"Z":"")}function T0(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function r(f,m){var h,g,y=s(f,function(p,x){if(h)return h(p,x-1);g=p,h=m?GK(p,m):r9(p)});return y.columns=g||[],y}function s(f,m){var h=[],g=f.length,y=0,p=0,x,b=g<=0,w=!1;f.charCodeAt(g-1)===xf&&--g,f.charCodeAt(g-1)===Ax&&--g;function N(){if(b)return _x;if(w)return w=!1,h6;var I,R=y,T;if(f.charCodeAt(R)===Sx){for(;y++<g&&f.charCodeAt(y)!==Sx||f.charCodeAt(++y)===Sx;);return(I=y)>=g?b=!0:(T=f.charCodeAt(y++))===xf?w=!0:T===Ax&&(w=!0,f.charCodeAt(y)===xf&&++y),f.slice(R+1,I-1).replace(/""/g,'"')}for(;y<g;){if((T=f.charCodeAt(I=y++))===xf)w=!0;else if(T===Ax)w=!0,f.charCodeAt(y)===xf&&++y;else if(T!==n)continue;return f.slice(R,I)}return b=!0,f.slice(R,g)}for(;(x=N())!==_x;){for(var k=[];x!==h6&&x!==_x;)k.push(x),x=N();m&&(k=m(k,p++))==null||h.push(k)}return h}function i(f,m){return f.map(function(h){return m.map(function(g){return u(h[g])}).join(e)})}function l(f,m){return m==null&&(m=m6(f)),[m.map(u).join(e)].concat(i(f,m)).join(`
`)}function a(f,m){return m==null&&(m=m6(f)),i(f,m).join(`
`)}function c(f){return f.map(d).join(`
`)}function d(f){return f.map(u).join(e)}function u(f){return f==null?"":f instanceof Date?XK(f):t.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:r,parseRows:s,format:l,formatBody:a,formatRows:c,formatRow:d,formatValue:u}}var Tc=T0(","),s9=Tc.parse,KK=Tc.parseRows,JK=Tc.format,ZK=Tc.formatBody,QK=Tc.formatRows,eJ=Tc.formatRow,tJ=Tc.formatValue,Lc=T0("	"),i9=Lc.parse,nJ=Lc.parseRows,rJ=Lc.format,sJ=Lc.formatBody,iJ=Lc.formatRows,aJ=Lc.formatRow,oJ=Lc.formatValue;function lJ(e){for(var t in e){var n=e[t].trim(),r,s;if(!n)n=null;else if(n==="true")n=!0;else if(n==="false")n=!1;else if(n==="NaN")n=NaN;else if(!isNaN(r=+n))n=r;else if(s=n.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/))cJ&&s[4]&&!s[7]&&(n=n.replace(/-/g,"/").replace(/T/," ")),n=new Date(n);else continue;e[t]=n}return e}const cJ=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();function uJ(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.blob()}function dJ(e,t){return fetch(e,t).then(uJ)}function fJ(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.arrayBuffer()}function hJ(e,t){return fetch(e,t).then(fJ)}function mJ(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.text()}function L0(e,t){return fetch(e,t).then(mJ)}function a9(e){return function(t,n,r){return arguments.length===2&&typeof n=="function"&&(r=n,n=void 0),L0(t,n).then(function(s){return e(s,r)})}}function pJ(e,t,n,r){arguments.length===3&&typeof n=="function"&&(r=n,n=void 0);var s=T0(e);return L0(t,n).then(function(i){return s.parse(i,r)})}var gJ=a9(s9),xJ=a9(i9);function yJ(e,t){return new Promise(function(n,r){var s=new Image;for(var i in t)s[i]=t[i];s.onerror=r,s.onload=function(){n(s)},s.src=e})}function vJ(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);if(!(e.status===204||e.status===205))return e.json()}function bJ(e,t){return fetch(e,t).then(vJ)}function M3(e){return(t,n)=>L0(t,n).then(r=>new DOMParser().parseFromString(r,e))}const wJ=M3("application/xml");var NJ=M3("text/html"),jJ=M3("image/svg+xml");function _J(e,t){var n,r=1;e==null&&(e=0),t==null&&(t=0);function s(){var i,l=n.length,a,c=0,d=0;for(i=0;i<l;++i)a=n[i],c+=a.x,d+=a.y;for(c=(c/l-e)*r,d=(d/l-t)*r,i=0;i<l;++i)a=n[i],a.x-=c,a.y-=d}return s.initialize=function(i){n=i},s.x=function(i){return arguments.length?(e=+i,s):e},s.y=function(i){return arguments.length?(t=+i,s):t},s.strength=function(i){return arguments.length?(r=+i,s):r},s}function SJ(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return o9(this.cover(t,n),t,n,e)}function o9(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var s,i=e._root,l={data:r},a=e._x0,c=e._y0,d=e._x1,u=e._y1,f,m,h,g,y,p,x,b;if(!i)return e._root=l,e;for(;i.length;)if((y=t>=(f=(a+d)/2))?a=f:d=f,(p=n>=(m=(c+u)/2))?c=m:u=m,s=i,!(i=i[x=p<<1|y]))return s[x]=l,e;if(h=+e._x.call(null,i.data),g=+e._y.call(null,i.data),t===h&&n===g)return l.next=i,s?s[x]=l:e._root=l,e;do s=s?s[x]=new Array(4):e._root=new Array(4),(y=t>=(f=(a+d)/2))?a=f:d=f,(p=n>=(m=(c+u)/2))?c=m:u=m;while((x=p<<1|y)===(b=(g>=m)<<1|h>=f));return s[b]=i,s[x]=l,e}function AJ(e){var t,n,r=e.length,s,i,l=new Array(r),a=new Array(r),c=1/0,d=1/0,u=-1/0,f=-1/0;for(n=0;n<r;++n)isNaN(s=+this._x.call(null,t=e[n]))||isNaN(i=+this._y.call(null,t))||(l[n]=s,a[n]=i,s<c&&(c=s),s>u&&(u=s),i<d&&(d=i),i>f&&(f=i));if(c>u||d>f)return this;for(this.cover(c,d).cover(u,f),n=0;n<r;++n)o9(this,l[n],a[n],e[n]);return this}function kJ(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,s=this._x1,i=this._y1;if(isNaN(n))s=(n=Math.floor(e))+1,i=(r=Math.floor(t))+1;else{for(var l=s-n||1,a=this._root,c,d;n>e||e>=s||r>t||t>=i;)switch(d=(t<r)<<1|e<n,c=new Array(4),c[d]=a,a=c,l*=2,d){case 0:s=n+l,i=r+l;break;case 1:n=s-l,i=r+l;break;case 2:s=n+l,r=i-l;break;case 3:n=s-l,r=i-l;break}this._root&&this._root.length&&(this._root=a)}return this._x0=n,this._y0=r,this._x1=s,this._y1=i,this}function EJ(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function CJ(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Fs(e,t,n,r,s){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=s}function PJ(e,t,n){var r,s=this._x0,i=this._y0,l,a,c,d,u=this._x1,f=this._y1,m=[],h=this._root,g,y;for(h&&m.push(new Fs(h,s,i,u,f)),n==null?n=1/0:(s=e-n,i=t-n,u=e+n,f=t+n,n*=n);g=m.pop();)if(!(!(h=g.node)||(l=g.x0)>u||(a=g.y0)>f||(c=g.x1)<s||(d=g.y1)<i))if(h.length){var p=(l+c)/2,x=(a+d)/2;m.push(new Fs(h[3],p,x,c,d),new Fs(h[2],l,x,p,d),new Fs(h[1],p,a,c,x),new Fs(h[0],l,a,p,x)),(y=(t>=x)<<1|e>=p)&&(g=m[m.length-1],m[m.length-1]=m[m.length-1-y],m[m.length-1-y]=g)}else{var b=e-+this._x.call(null,h.data),w=t-+this._y.call(null,h.data),N=b*b+w*w;if(N<n){var k=Math.sqrt(n=N);s=e-k,i=t-k,u=e+k,f=t+k,r=h.data}}return r}function IJ(e){if(isNaN(u=+this._x.call(null,e))||isNaN(f=+this._y.call(null,e)))return this;var t,n=this._root,r,s,i,l=this._x0,a=this._y0,c=this._x1,d=this._y1,u,f,m,h,g,y,p,x;if(!n)return this;if(n.length)for(;;){if((g=u>=(m=(l+c)/2))?l=m:c=m,(y=f>=(h=(a+d)/2))?a=h:d=h,t=n,!(n=n[p=y<<1|g]))return this;if(!n.length)break;(t[p+1&3]||t[p+2&3]||t[p+3&3])&&(r=t,x=p)}for(;n.data!==e;)if(s=n,!(n=n.next))return this;return(i=n.next)&&delete n.next,s?(i?s.next=i:delete s.next,this):t?(i?t[p]=i:delete t[p],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[x]=n:this._root=n),this):(this._root=i,this)}function TJ(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function LJ(){return this._root}function MJ(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function RJ(e){var t=[],n,r=this._root,s,i,l,a,c;for(r&&t.push(new Fs(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,i=n.x0,l=n.y0,a=n.x1,c=n.y1)&&r.length){var d=(i+a)/2,u=(l+c)/2;(s=r[3])&&t.push(new Fs(s,d,u,a,c)),(s=r[2])&&t.push(new Fs(s,i,u,d,c)),(s=r[1])&&t.push(new Fs(s,d,l,a,u)),(s=r[0])&&t.push(new Fs(s,i,l,d,u))}return this}function $J(e){var t=[],n=[],r;for(this._root&&t.push(new Fs(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var s=r.node;if(s.length){var i,l=r.x0,a=r.y0,c=r.x1,d=r.y1,u=(l+c)/2,f=(a+d)/2;(i=s[0])&&t.push(new Fs(i,l,a,u,f)),(i=s[1])&&t.push(new Fs(i,u,a,c,f)),(i=s[2])&&t.push(new Fs(i,l,f,u,d)),(i=s[3])&&t.push(new Fs(i,u,f,c,d))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function OJ(e){return e[0]}function FJ(e){return arguments.length?(this._x=e,this):this._x}function DJ(e){return e[1]}function qJ(e){return arguments.length?(this._y=e,this):this._y}function M0(e,t,n){var r=new R3(t??OJ,n??DJ,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function R3(e,t,n,r,s,i){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=s,this._y1=i,this._root=void 0}function p6(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var Us=M0.prototype=R3.prototype;Us.copy=function(){var e=new R3(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=p6(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var s=0;s<4;++s)(r=t.source[s])&&(r.length?n.push({source:r,target:t.target[s]=new Array(4)}):t.target[s]=p6(r));return e};Us.add=SJ;Us.addAll=AJ;Us.cover=kJ;Us.data=EJ;Us.extent=CJ;Us.find=PJ;Us.remove=IJ;Us.removeAll=TJ;Us.root=LJ;Us.size=MJ;Us.visit=RJ;Us.visitAfter=$J;Us.x=FJ;Us.y=qJ;function Jr(e){return function(){return e}}function ol(e){return(e()-.5)*1e-6}function BJ(e){return e.x+e.vx}function zJ(e){return e.y+e.vy}function UJ(e){var t,n,r,s=1,i=1;typeof e!="function"&&(e=Jr(e==null?1:+e));function l(){for(var d,u=t.length,f,m,h,g,y,p,x=0;x<i;++x)for(f=M0(t,BJ,zJ).visitAfter(a),d=0;d<u;++d)m=t[d],y=n[m.index],p=y*y,h=m.x+m.vx,g=m.y+m.vy,f.visit(b);function b(w,N,k,I,R){var T=w.data,S=w.r,E=y+S;if(T){if(T.index>m.index){var _=h-T.x-T.vx,M=g-T.y-T.vy,A=_*_+M*M;A<E*E&&(_===0&&(_=ol(r),A+=_*_),M===0&&(M=ol(r),A+=M*M),A=(E-(A=Math.sqrt(A)))/A*s,m.vx+=(_*=A)*(E=(S*=S)/(p+S)),m.vy+=(M*=A)*E,T.vx-=_*(E=1-E),T.vy-=M*E)}return}return N>h+E||I<h-E||k>g+E||R<g-E}}function a(d){if(d.data)return d.r=n[d.data.index];for(var u=d.r=0;u<4;++u)d[u]&&d[u].r>d.r&&(d.r=d[u].r)}function c(){if(t){var d,u=t.length,f;for(n=new Array(u),d=0;d<u;++d)f=t[d],n[f.index]=+e(f,d,t)}}return l.initialize=function(d,u){t=d,r=u,c()},l.iterations=function(d){return arguments.length?(i=+d,l):i},l.strength=function(d){return arguments.length?(s=+d,l):s},l.radius=function(d){return arguments.length?(e=typeof d=="function"?d:Jr(+d),c(),l):e},l}function HJ(e){return e.index}function g6(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function VJ(e){var t=HJ,n=f,r,s=Jr(30),i,l,a,c,d,u=1;e==null&&(e=[]);function f(p){return 1/Math.min(a[p.source.index],a[p.target.index])}function m(p){for(var x=0,b=e.length;x<u;++x)for(var w=0,N,k,I,R,T,S,E;w<b;++w)N=e[w],k=N.source,I=N.target,R=I.x+I.vx-k.x-k.vx||ol(d),T=I.y+I.vy-k.y-k.vy||ol(d),S=Math.sqrt(R*R+T*T),S=(S-i[w])/S*p*r[w],R*=S,T*=S,I.vx-=R*(E=c[w]),I.vy-=T*E,k.vx+=R*(E=1-E),k.vy+=T*E}function h(){if(l){var p,x=l.length,b=e.length,w=new Map(l.map((k,I)=>[t(k,I,l),k])),N;for(p=0,a=new Array(x);p<b;++p)N=e[p],N.index=p,typeof N.source!="object"&&(N.source=g6(w,N.source)),typeof N.target!="object"&&(N.target=g6(w,N.target)),a[N.source.index]=(a[N.source.index]||0)+1,a[N.target.index]=(a[N.target.index]||0)+1;for(p=0,c=new Array(b);p<b;++p)N=e[p],c[p]=a[N.source.index]/(a[N.source.index]+a[N.target.index]);r=new Array(b),g(),i=new Array(b),y()}}function g(){if(l)for(var p=0,x=e.length;p<x;++p)r[p]=+n(e[p],p,e)}function y(){if(l)for(var p=0,x=e.length;p<x;++p)i[p]=+s(e[p],p,e)}return m.initialize=function(p,x){l=p,d=x,h()},m.links=function(p){return arguments.length?(e=p,h(),m):e},m.id=function(p){return arguments.length?(t=p,m):t},m.iterations=function(p){return arguments.length?(u=+p,m):u},m.strength=function(p){return arguments.length?(n=typeof p=="function"?p:Jr(+p),g(),m):n},m.distance=function(p){return arguments.length?(s=typeof p=="function"?p:Jr(+p),y(),m):s},m}const WJ=1664525,GJ=1013904223,x6=4294967296;function YJ(){let e=1;return()=>(e=(WJ*e+GJ)%x6)/x6}function XJ(e){return e.x}function KJ(e){return e.y}var JJ=10,ZJ=Math.PI*(3-Math.sqrt(5));function QJ(e){var t,n=1,r=.001,s=1-Math.pow(r,1/300),i=0,l=.6,a=new Map,c=P0(f),d=Pc("tick","end"),u=YJ();e==null&&(e=[]);function f(){m(),d.call("tick",t),n<r&&(c.stop(),d.call("end",t))}function m(y){var p,x=e.length,b;y===void 0&&(y=1);for(var w=0;w<y;++w)for(n+=(i-n)*s,a.forEach(function(N){N(n)}),p=0;p<x;++p)b=e[p],b.fx==null?b.x+=b.vx*=l:(b.x=b.fx,b.vx=0),b.fy==null?b.y+=b.vy*=l:(b.y=b.fy,b.vy=0);return t}function h(){for(var y=0,p=e.length,x;y<p;++y){if(x=e[y],x.index=y,x.fx!=null&&(x.x=x.fx),x.fy!=null&&(x.y=x.fy),isNaN(x.x)||isNaN(x.y)){var b=JJ*Math.sqrt(.5+y),w=y*ZJ;x.x=b*Math.cos(w),x.y=b*Math.sin(w)}(isNaN(x.vx)||isNaN(x.vy))&&(x.vx=x.vy=0)}}function g(y){return y.initialize&&y.initialize(e,u),y}return h(),t={tick:m,restart:function(){return c.restart(f),t},stop:function(){return c.stop(),t},nodes:function(y){return arguments.length?(e=y,h(),a.forEach(g),t):e},alpha:function(y){return arguments.length?(n=+y,t):n},alphaMin:function(y){return arguments.length?(r=+y,t):r},alphaDecay:function(y){return arguments.length?(s=+y,t):+s},alphaTarget:function(y){return arguments.length?(i=+y,t):i},velocityDecay:function(y){return arguments.length?(l=1-y,t):1-l},randomSource:function(y){return arguments.length?(u=y,a.forEach(g),t):u},force:function(y,p){return arguments.length>1?(p==null?a.delete(y):a.set(y,g(p)),t):a.get(y)},find:function(y,p,x){var b=0,w=e.length,N,k,I,R,T;for(x==null?x=1/0:x*=x,b=0;b<w;++b)R=e[b],N=y-R.x,k=p-R.y,I=N*N+k*k,I<x&&(T=R,x=I);return T},on:function(y,p){return arguments.length>1?(d.on(y,p),t):d.on(y)}}}function eZ(){var e,t,n,r,s=Jr(-30),i,l=1,a=1/0,c=.81;function d(h){var g,y=e.length,p=M0(e,XJ,KJ).visitAfter(f);for(r=h,g=0;g<y;++g)t=e[g],p.visit(m)}function u(){if(e){var h,g=e.length,y;for(i=new Array(g),h=0;h<g;++h)y=e[h],i[y.index]=+s(y,h,e)}}function f(h){var g=0,y,p,x=0,b,w,N;if(h.length){for(b=w=N=0;N<4;++N)(y=h[N])&&(p=Math.abs(y.value))&&(g+=y.value,x+=p,b+=p*y.x,w+=p*y.y);h.x=b/x,h.y=w/x}else{y=h,y.x=y.data.x,y.y=y.data.y;do g+=i[y.data.index];while(y=y.next)}h.value=g}function m(h,g,y,p){if(!h.value)return!0;var x=h.x-t.x,b=h.y-t.y,w=p-g,N=x*x+b*b;if(w*w/c<N)return N<a&&(x===0&&(x=ol(n),N+=x*x),b===0&&(b=ol(n),N+=b*b),N<l&&(N=Math.sqrt(l*N)),t.vx+=x*h.value*r/N,t.vy+=b*h.value*r/N),!0;if(h.length||N>=a)return;(h.data!==t||h.next)&&(x===0&&(x=ol(n),N+=x*x),b===0&&(b=ol(n),N+=b*b),N<l&&(N=Math.sqrt(l*N)));do h.data!==t&&(w=i[h.data.index]*r/N,t.vx+=x*w,t.vy+=b*w);while(h=h.next)}return d.initialize=function(h,g){e=h,n=g,u()},d.strength=function(h){return arguments.length?(s=typeof h=="function"?h:Jr(+h),u(),d):s},d.distanceMin=function(h){return arguments.length?(l=h*h,d):Math.sqrt(l)},d.distanceMax=function(h){return arguments.length?(a=h*h,d):Math.sqrt(a)},d.theta=function(h){return arguments.length?(c=h*h,d):Math.sqrt(c)},d}function tZ(e,t,n){var r,s=Jr(.1),i,l;typeof e!="function"&&(e=Jr(+e)),t==null&&(t=0),n==null&&(n=0);function a(d){for(var u=0,f=r.length;u<f;++u){var m=r[u],h=m.x-t||1e-6,g=m.y-n||1e-6,y=Math.sqrt(h*h+g*g),p=(l[u]-y)*i[u]*d/y;m.vx+=h*p,m.vy+=g*p}}function c(){if(r){var d,u=r.length;for(i=new Array(u),l=new Array(u),d=0;d<u;++d)l[d]=+e(r[d],d,r),i[d]=isNaN(l[d])?0:+s(r[d],d,r)}}return a.initialize=function(d){r=d,c()},a.strength=function(d){return arguments.length?(s=typeof d=="function"?d:Jr(+d),c(),a):s},a.radius=function(d){return arguments.length?(e=typeof d=="function"?d:Jr(+d),c(),a):e},a.x=function(d){return arguments.length?(t=+d,a):t},a.y=function(d){return arguments.length?(n=+d,a):n},a}function nZ(e){var t=Jr(.1),n,r,s;typeof e!="function"&&(e=Jr(e==null?0:+e));function i(a){for(var c=0,d=n.length,u;c<d;++c)u=n[c],u.vx+=(s[c]-u.x)*r[c]*a}function l(){if(n){var a,c=n.length;for(r=new Array(c),s=new Array(c),a=0;a<c;++a)r[a]=isNaN(s[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return i.initialize=function(a){n=a,l()},i.strength=function(a){return arguments.length?(t=typeof a=="function"?a:Jr(+a),l(),i):t},i.x=function(a){return arguments.length?(e=typeof a=="function"?a:Jr(+a),l(),i):e},i}function rZ(e){var t=Jr(.1),n,r,s;typeof e!="function"&&(e=Jr(e==null?0:+e));function i(a){for(var c=0,d=n.length,u;c<d;++c)u=n[c],u.vy+=(s[c]-u.y)*r[c]*a}function l(){if(n){var a,c=n.length;for(r=new Array(c),s=new Array(c),a=0;a<c;++a)r[a]=isNaN(s[a]=+e(n[a],a,n))?0:+t(n[a],a,n)}}return i.initialize=function(a){n=a,l()},i.strength=function(a){return arguments.length?(t=typeof a=="function"?a:Jr(+a),l(),i):t},i.y=function(a){return arguments.length?(e=typeof a=="function"?a:Jr(+a),l(),i):e},i}function sZ(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function pg(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function nd(e){return e=pg(Math.abs(e)),e?e[1]:NaN}function iZ(e,t){return function(n,r){for(var s=n.length,i=[],l=0,a=e[0],c=0;s>0&&a>0&&(c+a+1>r&&(a=Math.max(1,r-c)),i.push(n.substring(s-=a,s+a)),!((c+=a+1)>r));)a=e[l=(l+1)%e.length];return i.reverse().join(t)}}function aZ(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var oZ=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function kh(e){if(!(t=oZ.exec(e)))throw new Error("invalid format: "+e);var t;return new R0({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}kh.prototype=R0.prototype;function R0(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}R0.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function lZ(e){e:for(var t=e.length,n=1,r=-1,s;n<t;++n)switch(e[n]){case".":r=s=n;break;case"0":r===0&&(r=n),s=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(s+1):e}var l9;function cZ(e,t){var n=pg(e,t);if(!n)return e+"";var r=n[0],s=n[1],i=s-(l9=Math.max(-8,Math.min(8,Math.floor(s/3)))*3)+1,l=r.length;return i===l?r:i>l?r+new Array(i-l+1).join("0"):i>0?r.slice(0,i)+"."+r.slice(i):"0."+new Array(1-i).join("0")+pg(e,Math.max(0,t+i-1))[0]}function y6(e,t){var n=pg(e,t);if(!n)return e+"";var r=n[0],s=n[1];return s<0?"0."+new Array(-s).join("0")+r:r.length>s+1?r.slice(0,s+1)+"."+r.slice(s+1):r+new Array(s-r.length+2).join("0")}const v6={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:sZ,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>y6(e*100,t),r:y6,s:cZ,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function b6(e){return e}var w6=Array.prototype.map,N6=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function c9(e){var t=e.grouping===void 0||e.thousands===void 0?b6:iZ(w6.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",s=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?b6:aZ(w6.call(e.numerals,String)),l=e.percent===void 0?"%":e.percent+"",a=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function d(f){f=kh(f);var m=f.fill,h=f.align,g=f.sign,y=f.symbol,p=f.zero,x=f.width,b=f.comma,w=f.precision,N=f.trim,k=f.type;k==="n"?(b=!0,k="g"):v6[k]||(w===void 0&&(w=12),N=!0,k="g"),(p||m==="0"&&h==="=")&&(p=!0,m="0",h="=");var I=y==="$"?n:y==="#"&&/[boxX]/.test(k)?"0"+k.toLowerCase():"",R=y==="$"?r:/[%p]/.test(k)?l:"",T=v6[k],S=/[defgprs%]/.test(k);w=w===void 0?6:/[gprs]/.test(k)?Math.max(1,Math.min(21,w)):Math.max(0,Math.min(20,w));function E(_){var M=I,A=R,P,B,L;if(k==="c")A=T(_)+A,_="";else{_=+_;var D=_<0||1/_<0;if(_=isNaN(_)?c:T(Math.abs(_),w),N&&(_=lZ(_)),D&&+_==0&&g!=="+"&&(D=!1),M=(D?g==="("?g:a:g==="-"||g==="("?"":g)+M,A=(k==="s"?N6[8+l9/3]:"")+A+(D&&g==="("?")":""),S){for(P=-1,B=_.length;++P<B;)if(L=_.charCodeAt(P),48>L||L>57){A=(L===46?s+_.slice(P+1):_.slice(P))+A,_=_.slice(0,P);break}}}b&&!p&&(_=t(_,1/0));var V=M.length+_.length+A.length,O=V<x?new Array(x-V+1).join(m):"";switch(b&&p&&(_=t(O+_,O.length?x-A.length:1/0),O=""),h){case"<":_=M+_+A+O;break;case"=":_=M+O+_+A;break;case"^":_=O.slice(0,V=O.length>>1)+M+_+A+O.slice(V);break;default:_=O+M+_+A;break}return i(_)}return E.toString=function(){return f+""},E}function u(f,m){var h=d((f=kh(f),f.type="f",f)),g=Math.max(-8,Math.min(8,Math.floor(nd(m)/3)))*3,y=Math.pow(10,-g),p=N6[8+g/3];return function(x){return h(y*x)+p}}return{format:d,formatPrefix:u}}var Km,$0,$3;u9({thousands:",",grouping:[3],currency:["$",""]});function u9(e){return Km=c9(e),$0=Km.format,$3=Km.formatPrefix,Km}function d9(e){return Math.max(0,-nd(Math.abs(e)))}function f9(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(nd(t)/3)))*3-nd(Math.abs(e)))}function h9(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,nd(t)-nd(e))+1}var Wt=1e-6,Eh=1e-12,vn=Math.PI,wr=vn/2,gg=vn/4,qs=vn*2,Jn=180/vn,Gt=vn/180,Sn=Math.abs,wd=Math.atan,Bs=Math.atan2,Rt=Math.cos,Jm=Math.ceil,m9=Math.exp,Q5=Math.hypot,xg=Math.log,kx=Math.pow,kt=Math.sin,Mi=Math.sign||function(e){return e>0?1:e<0?-1:0},rs=Math.sqrt,O3=Math.tan;function p9(e){return e>1?0:e<-1?vn:Math.acos(e)}function zs(e){return e>1?wr:e<-1?-wr:Math.asin(e)}function j6(e){return(e=kt(e/2))*e}function hr(){}function yg(e,t){e&&S6.hasOwnProperty(e.type)&&S6[e.type](e,t)}var _6={Feature:function(e,t){yg(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,s=n.length;++r<s;)yg(n[r].geometry,t)}},S6={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,s=n.length;++r<s;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){eN(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,s=n.length;++r<s;)eN(n[r],t,0)},Polygon:function(e,t){A6(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,s=n.length;++r<s;)A6(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,s=n.length;++r<s;)yg(n[r],t)}};function eN(e,t,n){var r=-1,s=e.length-n,i;for(t.lineStart();++r<s;)i=e[r],t.point(i[0],i[1],i[2]);t.lineEnd()}function A6(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)eN(e[n],t,1);t.polygonEnd()}function Zi(e,t){e&&_6.hasOwnProperty(e.type)?_6[e.type](e,t):yg(e,t)}var vg=new Zr,bg=new Zr,g9,x9,tN,nN,rN,Fa={point:hr,lineStart:hr,lineEnd:hr,polygonStart:function(){vg=new Zr,Fa.lineStart=uZ,Fa.lineEnd=dZ},polygonEnd:function(){var e=+vg;bg.add(e<0?qs+e:e),this.lineStart=this.lineEnd=this.point=hr},sphere:function(){bg.add(qs)}};function uZ(){Fa.point=fZ}function dZ(){y9(g9,x9)}function fZ(e,t){Fa.point=y9,g9=e,x9=t,e*=Gt,t*=Gt,tN=e,nN=Rt(t=t/2+gg),rN=kt(t)}function y9(e,t){e*=Gt,t*=Gt,t=t/2+gg;var n=e-tN,r=n>=0?1:-1,s=r*n,i=Rt(t),l=kt(t),a=rN*l,c=nN*i+a*Rt(s),d=a*r*kt(s);vg.add(Bs(d,c)),tN=e,nN=i,rN=l}function hZ(e){return bg=new Zr,Zi(e,Fa),bg*2}function wg(e){return[Bs(e[1],e[0]),zs(e[2])]}function wc(e){var t=e[0],n=e[1],r=Rt(n);return[r*Rt(t),r*kt(t),kt(n)]}function Zm(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function rd(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Ex(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function Qm(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function Ng(e){var t=rs(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var fr,Ks,yr,yi,ec,v9,b9,Du,rh,nl,_o,co={point:sN,lineStart:k6,lineEnd:E6,polygonStart:function(){co.point=N9,co.lineStart=mZ,co.lineEnd=pZ,rh=new Zr,Fa.polygonStart()},polygonEnd:function(){Fa.polygonEnd(),co.point=sN,co.lineStart=k6,co.lineEnd=E6,vg<0?(fr=-(yr=180),Ks=-(yi=90)):rh>Wt?yi=90:rh<-Wt&&(Ks=-90),_o[0]=fr,_o[1]=yr},sphere:function(){fr=-(yr=180),Ks=-(yi=90)}};function sN(e,t){nl.push(_o=[fr=e,yr=e]),t<Ks&&(Ks=t),t>yi&&(yi=t)}function w9(e,t){var n=wc([e*Gt,t*Gt]);if(Du){var r=rd(Du,n),s=[r[1],-r[0],0],i=rd(s,r);Ng(i),i=wg(i);var l=e-ec,a=l>0?1:-1,c=i[0]*Jn*a,d,u=Sn(l)>180;u^(a*ec<c&&c<a*e)?(d=i[1]*Jn,d>yi&&(yi=d)):(c=(c+360)%360-180,u^(a*ec<c&&c<a*e)?(d=-i[1]*Jn,d<Ks&&(Ks=d)):(t<Ks&&(Ks=t),t>yi&&(yi=t))),u?e<ec?pi(fr,e)>pi(fr,yr)&&(yr=e):pi(e,yr)>pi(fr,yr)&&(fr=e):yr>=fr?(e<fr&&(fr=e),e>yr&&(yr=e)):e>ec?pi(fr,e)>pi(fr,yr)&&(yr=e):pi(e,yr)>pi(fr,yr)&&(fr=e)}else nl.push(_o=[fr=e,yr=e]);t<Ks&&(Ks=t),t>yi&&(yi=t),Du=n,ec=e}function k6(){co.point=w9}function E6(){_o[0]=fr,_o[1]=yr,co.point=sN,Du=null}function N9(e,t){if(Du){var n=e-ec;rh.add(Sn(n)>180?n+(n>0?360:-360):n)}else v9=e,b9=t;Fa.point(e,t),w9(e,t)}function mZ(){Fa.lineStart()}function pZ(){N9(v9,b9),Fa.lineEnd(),Sn(rh)>Wt&&(fr=-(yr=180)),_o[0]=fr,_o[1]=yr,Du=null}function pi(e,t){return(t-=e)<0?t+360:t}function gZ(e,t){return e[0]-t[0]}function C6(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function xZ(e){var t,n,r,s,i,l,a;if(yi=yr=-(fr=Ks=1/0),nl=[],Zi(e,co),n=nl.length){for(nl.sort(gZ),t=1,r=nl[0],i=[r];t<n;++t)s=nl[t],C6(r,s[0])||C6(r,s[1])?(pi(r[0],s[1])>pi(r[0],r[1])&&(r[1]=s[1]),pi(s[0],r[1])>pi(r[0],r[1])&&(r[0]=s[0])):i.push(r=s);for(l=-1/0,n=i.length-1,t=0,r=i[n];t<=n;r=s,++t)s=i[t],(a=pi(r[1],s[0]))>l&&(l=a,fr=s[0],yr=r[1])}return nl=_o=null,fr===1/0||Ks===1/0?[[NaN,NaN],[NaN,NaN]]:[[fr,Ks],[yr,yi]]}var $f,jg,_g,Sg,Ag,kg,Eg,Cg,iN,aN,oN,j9,_9,Rs,$s,Os,ea={sphere:hr,point:F3,lineStart:P6,lineEnd:I6,polygonStart:function(){ea.lineStart=bZ,ea.lineEnd=wZ},polygonEnd:function(){ea.lineStart=P6,ea.lineEnd=I6}};function F3(e,t){e*=Gt,t*=Gt;var n=Rt(t);Qh(n*Rt(e),n*kt(e),kt(t))}function Qh(e,t,n){++$f,_g+=(e-_g)/$f,Sg+=(t-Sg)/$f,Ag+=(n-Ag)/$f}function P6(){ea.point=yZ}function yZ(e,t){e*=Gt,t*=Gt;var n=Rt(t);Rs=n*Rt(e),$s=n*kt(e),Os=kt(t),ea.point=vZ,Qh(Rs,$s,Os)}function vZ(e,t){e*=Gt,t*=Gt;var n=Rt(t),r=n*Rt(e),s=n*kt(e),i=kt(t),l=Bs(rs((l=$s*i-Os*s)*l+(l=Os*r-Rs*i)*l+(l=Rs*s-$s*r)*l),Rs*r+$s*s+Os*i);jg+=l,kg+=l*(Rs+(Rs=r)),Eg+=l*($s+($s=s)),Cg+=l*(Os+(Os=i)),Qh(Rs,$s,Os)}function I6(){ea.point=F3}function bZ(){ea.point=NZ}function wZ(){S9(j9,_9),ea.point=F3}function NZ(e,t){j9=e,_9=t,e*=Gt,t*=Gt,ea.point=S9;var n=Rt(t);Rs=n*Rt(e),$s=n*kt(e),Os=kt(t),Qh(Rs,$s,Os)}function S9(e,t){e*=Gt,t*=Gt;var n=Rt(t),r=n*Rt(e),s=n*kt(e),i=kt(t),l=$s*i-Os*s,a=Os*r-Rs*i,c=Rs*s-$s*r,d=Q5(l,a,c),u=zs(d),f=d&&-u/d;iN.add(f*l),aN.add(f*a),oN.add(f*c),jg+=u,kg+=u*(Rs+(Rs=r)),Eg+=u*($s+($s=s)),Cg+=u*(Os+(Os=i)),Qh(Rs,$s,Os)}function jZ(e){$f=jg=_g=Sg=Ag=kg=Eg=Cg=0,iN=new Zr,aN=new Zr,oN=new Zr,Zi(e,ea);var t=+iN,n=+aN,r=+oN,s=Q5(t,n,r);return s<Eh&&(t=kg,n=Eg,r=Cg,jg<Wt&&(t=_g,n=Sg,r=Ag),s=Q5(t,n,r),s<Eh)?[NaN,NaN]:[Bs(n,t)*Jn,zs(r/s)*Jn]}function gu(e){return function(){return e}}function lN(e,t){function n(r,s){return r=e(r,s),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,s){return r=t.invert(r,s),r&&e.invert(r[0],r[1])}),n}function cN(e,t){return[Sn(e)>vn?e+Math.round(-e/qs)*qs:e,t]}cN.invert=cN;function D3(e,t,n){return(e%=qs)?t||n?lN(L6(e),M6(t,n)):L6(e):t||n?M6(t,n):cN}function T6(e){return function(t,n){return t+=e,[t>vn?t-qs:t<-vn?t+qs:t,n]}}function L6(e){var t=T6(e);return t.invert=T6(-e),t}function M6(e,t){var n=Rt(e),r=kt(e),s=Rt(t),i=kt(t);function l(a,c){var d=Rt(c),u=Rt(a)*d,f=kt(a)*d,m=kt(c),h=m*n+u*r;return[Bs(f*s-h*i,u*n-m*r),zs(h*s+f*i)]}return l.invert=function(a,c){var d=Rt(c),u=Rt(a)*d,f=kt(a)*d,m=kt(c),h=m*s-f*i;return[Bs(f*s+m*i,u*n+h*r),zs(h*n-u*r)]},l}function A9(e){e=D3(e[0]*Gt,e[1]*Gt,e.length>2?e[2]*Gt:0);function t(n){return n=e(n[0]*Gt,n[1]*Gt),n[0]*=Jn,n[1]*=Jn,n}return t.invert=function(n){return n=e.invert(n[0]*Gt,n[1]*Gt),n[0]*=Jn,n[1]*=Jn,n},t}function k9(e,t,n,r,s,i){if(n){var l=Rt(t),a=kt(t),c=r*n;s==null?(s=t+r*qs,i=t-c/2):(s=R6(l,s),i=R6(l,i),(r>0?s<i:s>i)&&(s+=r*qs));for(var d,u=s;r>0?u>i:u<i;u-=c)d=wg([l,-a*Rt(u),-a*kt(u)]),e.point(d[0],d[1])}}function R6(e,t){t=wc(t),t[0]-=e,Ng(t);var n=p9(-t[1]);return((-t[2]<0?-n:n)+qs-Wt)%qs}function _Z(){var e=gu([0,0]),t=gu(90),n=gu(6),r,s,i={point:l};function l(c,d){r.push(c=s(c,d)),c[0]*=Jn,c[1]*=Jn}function a(){var c=e.apply(this,arguments),d=t.apply(this,arguments)*Gt,u=n.apply(this,arguments)*Gt;return r=[],s=D3(-c[0]*Gt,-c[1]*Gt,0).invert,k9(i,d,u,1),c={type:"Polygon",coordinates:[r]},r=s=null,c}return a.center=function(c){return arguments.length?(e=typeof c=="function"?c:gu([+c[0],+c[1]]),a):e},a.radius=function(c){return arguments.length?(t=typeof c=="function"?c:gu(+c),a):t},a.precision=function(c){return arguments.length?(n=typeof c=="function"?c:gu(+c),a):n},a}function E9(){var e=[],t;return{point:function(n,r,s){t.push([n,r,s])},lineStart:function(){e.push(t=[])},lineEnd:hr,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function Bp(e,t){return Sn(e[0]-t[0])<Wt&&Sn(e[1]-t[1])<Wt}function ep(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function C9(e,t,n,r,s){var i=[],l=[],a,c;if(e.forEach(function(g){if(!((y=g.length-1)<=0)){var y,p=g[0],x=g[y],b;if(Bp(p,x)){if(!p[2]&&!x[2]){for(s.lineStart(),a=0;a<y;++a)s.point((p=g[a])[0],p[1]);s.lineEnd();return}x[0]+=2*Wt}i.push(b=new ep(p,g,null,!0)),l.push(b.o=new ep(p,null,b,!1)),i.push(b=new ep(x,g,null,!1)),l.push(b.o=new ep(x,null,b,!0))}}),!!i.length){for(l.sort(t),$6(i),$6(l),a=0,c=l.length;a<c;++a)l[a].e=n=!n;for(var d=i[0],u,f;;){for(var m=d,h=!0;m.v;)if((m=m.n)===d)return;u=m.z,s.lineStart();do{if(m.v=m.o.v=!0,m.e){if(h)for(a=0,c=u.length;a<c;++a)s.point((f=u[a])[0],f[1]);else r(m.x,m.n.x,1,s);m=m.n}else{if(h)for(u=m.p.z,a=u.length-1;a>=0;--a)s.point((f=u[a])[0],f[1]);else r(m.x,m.p.x,-1,s);m=m.p}m=m.o,u=m.z,h=!h}while(!m.v);s.lineEnd()}}}function $6(e){if(t=e.length){for(var t,n=0,r=e[0],s;++n<t;)r.n=s=e[n],s.p=r,r=s;r.n=s=e[0],s.p=r}}function Cx(e){return Sn(e[0])<=vn?e[0]:Mi(e[0])*((Sn(e[0])+vn)%qs-vn)}function P9(e,t){var n=Cx(t),r=t[1],s=kt(r),i=[kt(n),-Rt(n),0],l=0,a=0,c=new Zr;s===1?r=wr+Wt:s===-1&&(r=-wr-Wt);for(var d=0,u=e.length;d<u;++d)if(m=(f=e[d]).length)for(var f,m,h=f[m-1],g=Cx(h),y=h[1]/2+gg,p=kt(y),x=Rt(y),b=0;b<m;++b,g=N,p=I,x=R,h=w){var w=f[b],N=Cx(w),k=w[1]/2+gg,I=kt(k),R=Rt(k),T=N-g,S=T>=0?1:-1,E=S*T,_=E>vn,M=p*I;if(c.add(Bs(M*S*kt(E),x*R+M*Rt(E))),l+=_?T+S*qs:T,_^g>=n^N>=n){var A=rd(wc(h),wc(w));Ng(A);var P=rd(i,A);Ng(P);var B=(_^T>=0?-1:1)*zs(P[2]);(r>B||r===B&&(A[0]||A[1]))&&(a+=_^T>=0?1:-1)}}return(l<-Wt||l<Wt&&c<-Eh)^a&1}function I9(e,t,n,r){return function(s){var i=t(s),l=E9(),a=t(l),c=!1,d,u,f,m={point:h,lineStart:y,lineEnd:p,polygonStart:function(){m.point=x,m.lineStart=b,m.lineEnd=w,u=[],d=[]},polygonEnd:function(){m.point=h,m.lineStart=y,m.lineEnd=p,u=h3(u);var N=P9(d,r);u.length?(c||(s.polygonStart(),c=!0),C9(u,AZ,N,n,s)):N&&(c||(s.polygonStart(),c=!0),s.lineStart(),n(null,null,1,s),s.lineEnd()),c&&(s.polygonEnd(),c=!1),u=d=null},sphere:function(){s.polygonStart(),s.lineStart(),n(null,null,1,s),s.lineEnd(),s.polygonEnd()}};function h(N,k){e(N,k)&&s.point(N,k)}function g(N,k){i.point(N,k)}function y(){m.point=g,i.lineStart()}function p(){m.point=h,i.lineEnd()}function x(N,k){f.push([N,k]),a.point(N,k)}function b(){a.lineStart(),f=[]}function w(){x(f[0][0],f[0][1]),a.lineEnd();var N=a.clean(),k=l.result(),I,R=k.length,T,S,E;if(f.pop(),d.push(f),f=null,!!R){if(N&1){if(S=k[0],(T=S.length-1)>0){for(c||(s.polygonStart(),c=!0),s.lineStart(),I=0;I<T;++I)s.point((E=S[I])[0],E[1]);s.lineEnd()}return}R>1&&N&2&&k.push(k.pop().concat(k.shift())),u.push(k.filter(SZ))}}return m}}function SZ(e){return e.length>1}function AZ(e,t){return((e=e.x)[0]<0?e[1]-wr-Wt:wr-e[1])-((t=t.x)[0]<0?t[1]-wr-Wt:wr-t[1])}const uN=I9(function(){return!0},kZ,CZ,[-vn,-wr]);function kZ(e){var t=NaN,n=NaN,r=NaN,s;return{lineStart:function(){e.lineStart(),s=1},point:function(i,l){var a=i>0?vn:-vn,c=Sn(i-t);Sn(c-vn)<Wt?(e.point(t,n=(n+l)/2>0?wr:-wr),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(a,n),e.point(i,n),s=0):r!==a&&c>=vn&&(Sn(t-r)<Wt&&(t-=r*Wt),Sn(i-a)<Wt&&(i-=a*Wt),n=EZ(t,n,i,l),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(a,n),s=0),e.point(t=i,n=l),r=a},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-s}}}function EZ(e,t,n,r){var s,i,l=kt(e-n);return Sn(l)>Wt?wd((kt(t)*(i=Rt(r))*kt(n)-kt(r)*(s=Rt(t))*kt(e))/(s*i*l)):(t+r)/2}function CZ(e,t,n,r){var s;if(e==null)s=n*wr,r.point(-vn,s),r.point(0,s),r.point(vn,s),r.point(vn,0),r.point(vn,-s),r.point(0,-s),r.point(-vn,-s),r.point(-vn,0),r.point(-vn,s);else if(Sn(e[0]-t[0])>Wt){var i=e[0]<t[0]?vn:-vn;s=n*i/2,r.point(-i,s),r.point(0,s),r.point(i,s)}else r.point(t[0],t[1])}function T9(e){var t=Rt(e),n=6*Gt,r=t>0,s=Sn(t)>Wt;function i(u,f,m,h){k9(h,e,n,m,u,f)}function l(u,f){return Rt(u)*Rt(f)>t}function a(u){var f,m,h,g,y;return{lineStart:function(){g=h=!1,y=1},point:function(p,x){var b=[p,x],w,N=l(p,x),k=r?N?0:d(p,x):N?d(p+(p<0?vn:-vn),x):0;if(!f&&(g=h=N)&&u.lineStart(),N!==h&&(w=c(f,b),(!w||Bp(f,w)||Bp(b,w))&&(b[2]=1)),N!==h)y=0,N?(u.lineStart(),w=c(b,f),u.point(w[0],w[1])):(w=c(f,b),u.point(w[0],w[1],2),u.lineEnd()),f=w;else if(s&&f&&r^N){var I;!(k&m)&&(I=c(b,f,!0))&&(y=0,r?(u.lineStart(),u.point(I[0][0],I[0][1]),u.point(I[1][0],I[1][1]),u.lineEnd()):(u.point(I[1][0],I[1][1]),u.lineEnd(),u.lineStart(),u.point(I[0][0],I[0][1],3)))}N&&(!f||!Bp(f,b))&&u.point(b[0],b[1]),f=b,h=N,m=k},lineEnd:function(){h&&u.lineEnd(),f=null},clean:function(){return y|(g&&h)<<1}}}function c(u,f,m){var h=wc(u),g=wc(f),y=[1,0,0],p=rd(h,g),x=Zm(p,p),b=p[0],w=x-b*b;if(!w)return!m&&u;var N=t*x/w,k=-t*b/w,I=rd(y,p),R=Qm(y,N),T=Qm(p,k);Ex(R,T);var S=I,E=Zm(R,S),_=Zm(S,S),M=E*E-_*(Zm(R,R)-1);if(!(M<0)){var A=rs(M),P=Qm(S,(-E-A)/_);if(Ex(P,R),P=wg(P),!m)return P;var B=u[0],L=f[0],D=u[1],V=f[1],O;L<B&&(O=B,B=L,L=O);var H=L-B,W=Sn(H-vn)<Wt,$=W||H<Wt;if(!W&&V<D&&(O=D,D=V,V=O),$?W?D+V>0^P[1]<(Sn(P[0]-B)<Wt?D:V):D<=P[1]&&P[1]<=V:H>vn^(B<=P[0]&&P[0]<=L)){var z=Qm(S,(-E+A)/_);return Ex(z,R),[P,wg(z)]}}}function d(u,f){var m=r?e:vn-e,h=0;return u<-m?h|=1:u>m&&(h|=2),f<-m?h|=4:f>m&&(h|=8),h}return I9(l,a,i,r?[0,-e]:[-vn,e-vn])}function PZ(e,t,n,r,s,i){var l=e[0],a=e[1],c=t[0],d=t[1],u=0,f=1,m=c-l,h=d-a,g;if(g=n-l,!(!m&&g>0)){if(g/=m,m<0){if(g<u)return;g<f&&(f=g)}else if(m>0){if(g>f)return;g>u&&(u=g)}if(g=s-l,!(!m&&g<0)){if(g/=m,m<0){if(g>f)return;g>u&&(u=g)}else if(m>0){if(g<u)return;g<f&&(f=g)}if(g=r-a,!(!h&&g>0)){if(g/=h,h<0){if(g<u)return;g<f&&(f=g)}else if(h>0){if(g>f)return;g>u&&(u=g)}if(g=i-a,!(!h&&g<0)){if(g/=h,h<0){if(g>f)return;g>u&&(u=g)}else if(h>0){if(g<u)return;g<f&&(f=g)}return u>0&&(e[0]=l+u*m,e[1]=a+u*h),f<1&&(t[0]=l+f*m,t[1]=a+f*h),!0}}}}}var Of=1e9,tp=-Of;function O0(e,t,n,r){function s(d,u){return e<=d&&d<=n&&t<=u&&u<=r}function i(d,u,f,m){var h=0,g=0;if(d==null||(h=l(d,f))!==(g=l(u,f))||c(d,u)<0^f>0)do m.point(h===0||h===3?e:n,h>1?r:t);while((h=(h+f+4)%4)!==g);else m.point(u[0],u[1])}function l(d,u){return Sn(d[0]-e)<Wt?u>0?0:3:Sn(d[0]-n)<Wt?u>0?2:1:Sn(d[1]-t)<Wt?u>0?1:0:u>0?3:2}function a(d,u){return c(d.x,u.x)}function c(d,u){var f=l(d,1),m=l(u,1);return f!==m?f-m:f===0?u[1]-d[1]:f===1?d[0]-u[0]:f===2?d[1]-u[1]:u[0]-d[0]}return function(d){var u=d,f=E9(),m,h,g,y,p,x,b,w,N,k,I,R={point:T,lineStart:M,lineEnd:A,polygonStart:E,polygonEnd:_};function T(B,L){s(B,L)&&u.point(B,L)}function S(){for(var B=0,L=0,D=h.length;L<D;++L)for(var V=h[L],O=1,H=V.length,W=V[0],$,z,q=W[0],G=W[1];O<H;++O)$=q,z=G,W=V[O],q=W[0],G=W[1],z<=r?G>r&&(q-$)*(r-z)>(G-z)*(e-$)&&++B:G<=r&&(q-$)*(r-z)<(G-z)*(e-$)&&--B;return B}function E(){u=f,m=[],h=[],I=!0}function _(){var B=S(),L=I&&B,D=(m=h3(m)).length;(L||D)&&(d.polygonStart(),L&&(d.lineStart(),i(null,null,1,d),d.lineEnd()),D&&C9(m,a,B,i,d),d.polygonEnd()),u=d,m=h=g=null}function M(){R.point=P,h&&h.push(g=[]),k=!0,N=!1,b=w=NaN}function A(){m&&(P(y,p),x&&N&&f.rejoin(),m.push(f.result())),R.point=T,N&&u.lineEnd()}function P(B,L){var D=s(B,L);if(h&&g.push([B,L]),k)y=B,p=L,x=D,k=!1,D&&(u.lineStart(),u.point(B,L));else if(D&&N)u.point(B,L);else{var V=[b=Math.max(tp,Math.min(Of,b)),w=Math.max(tp,Math.min(Of,w))],O=[B=Math.max(tp,Math.min(Of,B)),L=Math.max(tp,Math.min(Of,L))];PZ(V,O,e,t,n,r)?(N||(u.lineStart(),u.point(V[0],V[1])),u.point(O[0],O[1]),D||u.lineEnd(),I=!1):D&&(u.lineStart(),u.point(B,L),I=!1)}b=B,w=L,N=D}return R}}function IZ(){var e=0,t=0,n=960,r=500,s,i,l;return l={stream:function(a){return s&&i===a?s:s=O0(e,t,n,r)(i=a)},extent:function(a){return arguments.length?(e=+a[0][0],t=+a[0][1],n=+a[1][0],r=+a[1][1],s=i=null,l):[[e,t],[n,r]]}}}var dN,fN,zp,Up,sd={sphere:hr,point:hr,lineStart:TZ,lineEnd:hr,polygonStart:hr,polygonEnd:hr};function TZ(){sd.point=MZ,sd.lineEnd=LZ}function LZ(){sd.point=sd.lineEnd=hr}function MZ(e,t){e*=Gt,t*=Gt,fN=e,zp=kt(t),Up=Rt(t),sd.point=RZ}function RZ(e,t){e*=Gt,t*=Gt;var n=kt(t),r=Rt(t),s=Sn(e-fN),i=Rt(s),l=kt(s),a=r*l,c=Up*n-zp*r*i,d=zp*n+Up*r*i;dN.add(Bs(rs(a*a+c*c),d)),fN=e,zp=n,Up=r}function L9(e){return dN=new Zr,Zi(e,sd),+dN}var hN=[null,null],$Z={type:"LineString",coordinates:hN};function Pg(e,t){return hN[0]=e,hN[1]=t,L9($Z)}var O6={Feature:function(e,t){return Ig(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,s=n.length;++r<s;)if(Ig(n[r].geometry,t))return!0;return!1}},F6={Sphere:function(){return!0},Point:function(e,t){return D6(e.coordinates,t)},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,s=n.length;++r<s;)if(D6(n[r],t))return!0;return!1},LineString:function(e,t){return q6(e.coordinates,t)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,s=n.length;++r<s;)if(q6(n[r],t))return!0;return!1},Polygon:function(e,t){return B6(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,s=n.length;++r<s;)if(B6(n[r],t))return!0;return!1},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,s=n.length;++r<s;)if(Ig(n[r],t))return!0;return!1}};function Ig(e,t){return e&&F6.hasOwnProperty(e.type)?F6[e.type](e,t):!1}function D6(e,t){return Pg(e,t)===0}function q6(e,t){for(var n,r,s,i=0,l=e.length;i<l;i++){if(r=Pg(e[i],t),r===0||i>0&&(s=Pg(e[i],e[i-1]),s>0&&n<=s&&r<=s&&(n+r-s)*(1-Math.pow((n-r)/s,2))<Eh*s))return!0;n=r}return!1}function B6(e,t){return!!P9(e.map(OZ),M9(t))}function OZ(e){return e=e.map(M9),e.pop(),e}function M9(e){return[e[0]*Gt,e[1]*Gt]}function FZ(e,t){return(e&&O6.hasOwnProperty(e.type)?O6[e.type]:Ig)(e,t)}function z6(e,t,n){var r=Pa(e,t-Wt,n).concat(t);return function(s){return r.map(function(i){return[s,i]})}}function U6(e,t,n){var r=Pa(e,t-Wt,n).concat(t);return function(s){return r.map(function(i){return[i,s]})}}function R9(){var e,t,n,r,s,i,l,a,c=10,d=c,u=90,f=360,m,h,g,y,p=2.5;function x(){return{type:"MultiLineString",coordinates:b()}}function b(){return Pa(Jm(r/u)*u,n,u).map(g).concat(Pa(Jm(a/f)*f,l,f).map(y)).concat(Pa(Jm(t/c)*c,e,c).filter(function(w){return Sn(w%u)>Wt}).map(m)).concat(Pa(Jm(i/d)*d,s,d).filter(function(w){return Sn(w%f)>Wt}).map(h))}return x.lines=function(){return b().map(function(w){return{type:"LineString",coordinates:w}})},x.outline=function(){return{type:"Polygon",coordinates:[g(r).concat(y(l).slice(1),g(n).reverse().slice(1),y(a).reverse().slice(1))]}},x.extent=function(w){return arguments.length?x.extentMajor(w).extentMinor(w):x.extentMinor()},x.extentMajor=function(w){return arguments.length?(r=+w[0][0],n=+w[1][0],a=+w[0][1],l=+w[1][1],r>n&&(w=r,r=n,n=w),a>l&&(w=a,a=l,l=w),x.precision(p)):[[r,a],[n,l]]},x.extentMinor=function(w){return arguments.length?(t=+w[0][0],e=+w[1][0],i=+w[0][1],s=+w[1][1],t>e&&(w=t,t=e,e=w),i>s&&(w=i,i=s,s=w),x.precision(p)):[[t,i],[e,s]]},x.step=function(w){return arguments.length?x.stepMajor(w).stepMinor(w):x.stepMinor()},x.stepMajor=function(w){return arguments.length?(u=+w[0],f=+w[1],x):[u,f]},x.stepMinor=function(w){return arguments.length?(c=+w[0],d=+w[1],x):[c,d]},x.precision=function(w){return arguments.length?(p=+w,m=z6(i,s,90),h=U6(t,e,p),g=z6(a,l,90),y=U6(r,n,p),x):p},x.extentMajor([[-180,-90+Wt],[180,90-Wt]]).extentMinor([[-180,-80-Wt],[180,80+Wt]])}function DZ(){return R9()()}function qZ(e,t){var n=e[0]*Gt,r=e[1]*Gt,s=t[0]*Gt,i=t[1]*Gt,l=Rt(r),a=kt(r),c=Rt(i),d=kt(i),u=l*Rt(n),f=l*kt(n),m=c*Rt(s),h=c*kt(s),g=2*zs(rs(j6(i-r)+l*c*j6(s-n))),y=kt(g),p=g?function(x){var b=kt(x*=g)/y,w=kt(g-x)/y,N=w*u+b*m,k=w*f+b*h,I=w*a+b*d;return[Bs(k,N)*Jn,Bs(I,rs(N*N+k*k))*Jn]}:function(){return[n*Jn,r*Jn]};return p.distance=g,p}const Ch=e=>e;var Px=new Zr,mN=new Zr,$9,O9,pN,gN,ho={point:hr,lineStart:hr,lineEnd:hr,polygonStart:function(){ho.lineStart=BZ,ho.lineEnd=UZ},polygonEnd:function(){ho.lineStart=ho.lineEnd=ho.point=hr,Px.add(Sn(mN)),mN=new Zr},result:function(){var e=Px/2;return Px=new Zr,e}};function BZ(){ho.point=zZ}function zZ(e,t){ho.point=F9,$9=pN=e,O9=gN=t}function F9(e,t){mN.add(gN*e-pN*t),pN=e,gN=t}function UZ(){F9($9,O9)}var id=1/0,Tg=id,Ph=-id,Lg=Ph,Mg={point:HZ,lineStart:hr,lineEnd:hr,polygonStart:hr,polygonEnd:hr,result:function(){var e=[[id,Tg],[Ph,Lg]];return Ph=Lg=-(Tg=id=1/0),e}};function HZ(e,t){e<id&&(id=e),e>Ph&&(Ph=e),t<Tg&&(Tg=t),t>Lg&&(Lg=t)}var xN=0,yN=0,Ff=0,Rg=0,$g=0,Pu=0,vN=0,bN=0,Df=0,D9,q9,Ea,Ca,Li={point:Nc,lineStart:H6,lineEnd:V6,polygonStart:function(){Li.lineStart=GZ,Li.lineEnd=YZ},polygonEnd:function(){Li.point=Nc,Li.lineStart=H6,Li.lineEnd=V6},result:function(){var e=Df?[vN/Df,bN/Df]:Pu?[Rg/Pu,$g/Pu]:Ff?[xN/Ff,yN/Ff]:[NaN,NaN];return xN=yN=Ff=Rg=$g=Pu=vN=bN=Df=0,e}};function Nc(e,t){xN+=e,yN+=t,++Ff}function H6(){Li.point=VZ}function VZ(e,t){Li.point=WZ,Nc(Ea=e,Ca=t)}function WZ(e,t){var n=e-Ea,r=t-Ca,s=rs(n*n+r*r);Rg+=s*(Ea+e)/2,$g+=s*(Ca+t)/2,Pu+=s,Nc(Ea=e,Ca=t)}function V6(){Li.point=Nc}function GZ(){Li.point=XZ}function YZ(){B9(D9,q9)}function XZ(e,t){Li.point=B9,Nc(D9=Ea=e,q9=Ca=t)}function B9(e,t){var n=e-Ea,r=t-Ca,s=rs(n*n+r*r);Rg+=s*(Ea+e)/2,$g+=s*(Ca+t)/2,Pu+=s,s=Ca*e-Ea*t,vN+=s*(Ea+e),bN+=s*(Ca+t),Df+=s*3,Nc(Ea=e,Ca=t)}function z9(e){this._context=e}z9.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,qs);break}}},result:hr};var wN=new Zr,Ix,U9,H9,qf,Bf,Ih={point:hr,lineStart:function(){Ih.point=KZ},lineEnd:function(){Ix&&V9(U9,H9),Ih.point=hr},polygonStart:function(){Ix=!0},polygonEnd:function(){Ix=null},result:function(){var e=+wN;return wN=new Zr,e}};function KZ(e,t){Ih.point=V9,U9=qf=e,H9=Bf=t}function V9(e,t){qf-=e,Bf-=t,wN.add(rs(qf*qf+Bf*Bf)),qf=e,Bf=t}function W9(){this._string=[]}W9.prototype={_radius:4.5,_circle:W6(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._string.push("M",e,",",t),this._point=1;break}case 1:{this._string.push("L",e,",",t);break}default:{this._circle==null&&(this._circle=W6(this._radius)),this._string.push("M",e,",",t,this._circle);break}}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}else return null}};function W6(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function JZ(e,t){var n=4.5,r,s;function i(l){return l&&(typeof n=="function"&&s.pointRadius(+n.apply(this,arguments)),Zi(l,r(s))),s.result()}return i.area=function(l){return Zi(l,r(ho)),ho.result()},i.measure=function(l){return Zi(l,r(Ih)),Ih.result()},i.bounds=function(l){return Zi(l,r(Mg)),Mg.result()},i.centroid=function(l){return Zi(l,r(Li)),Li.result()},i.projection=function(l){return arguments.length?(r=l==null?(e=null,Ch):(e=l).stream,i):e},i.context=function(l){return arguments.length?(s=l==null?(t=null,new W9):new z9(t=l),typeof n!="function"&&s.pointRadius(n),i):t},i.pointRadius=function(l){return arguments.length?(n=typeof l=="function"?l:(s.pointRadius(+l),+l),i):n},i.projection(e).context(t)}function ZZ(e){return{stream:em(e)}}function em(e){return function(t){var n=new NN;for(var r in e)n[r]=e[r];return n.stream=t,n}}function NN(){}NN.prototype={constructor:NN,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function q3(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),Zi(n,e.stream(Mg)),t(Mg.result()),r!=null&&e.clipExtent(r),e}function F0(e,t,n){return q3(e,function(r){var s=t[1][0]-t[0][0],i=t[1][1]-t[0][1],l=Math.min(s/(r[1][0]-r[0][0]),i/(r[1][1]-r[0][1])),a=+t[0][0]+(s-l*(r[1][0]+r[0][0]))/2,c=+t[0][1]+(i-l*(r[1][1]+r[0][1]))/2;e.scale(150*l).translate([a,c])},n)}function B3(e,t,n){return F0(e,[[0,0],t],n)}function z3(e,t,n){return q3(e,function(r){var s=+t,i=s/(r[1][0]-r[0][0]),l=(s-i*(r[1][0]+r[0][0]))/2,a=-i*r[0][1];e.scale(150*i).translate([l,a])},n)}function U3(e,t,n){return q3(e,function(r){var s=+t,i=s/(r[1][1]-r[0][1]),l=-i*r[0][0],a=(s-i*(r[1][1]+r[0][1]))/2;e.scale(150*i).translate([l,a])},n)}var G6=16,QZ=Rt(30*Gt);function Y6(e,t){return+t?tQ(e,t):eQ(e)}function eQ(e){return em({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function tQ(e,t){function n(r,s,i,l,a,c,d,u,f,m,h,g,y,p){var x=d-r,b=u-s,w=x*x+b*b;if(w>4*t&&y--){var N=l+m,k=a+h,I=c+g,R=rs(N*N+k*k+I*I),T=zs(I/=R),S=Sn(Sn(I)-1)<Wt||Sn(i-f)<Wt?(i+f)/2:Bs(k,N),E=e(S,T),_=E[0],M=E[1],A=_-r,P=M-s,B=b*A-x*P;(B*B/w>t||Sn((x*A+b*P)/w-.5)>.3||l*m+a*h+c*g<QZ)&&(n(r,s,i,l,a,c,_,M,S,N/=R,k/=R,I,y,p),p.point(_,M),n(_,M,S,N,k,I,d,u,f,m,h,g,y,p))}}return function(r){var s,i,l,a,c,d,u,f,m,h,g,y,p={point:x,lineStart:b,lineEnd:N,polygonStart:function(){r.polygonStart(),p.lineStart=k},polygonEnd:function(){r.polygonEnd(),p.lineStart=b}};function x(T,S){T=e(T,S),r.point(T[0],T[1])}function b(){f=NaN,p.point=w,r.lineStart()}function w(T,S){var E=wc([T,S]),_=e(T,S);n(f,m,u,h,g,y,f=_[0],m=_[1],u=T,h=E[0],g=E[1],y=E[2],G6,r),r.point(f,m)}function N(){p.point=x,r.lineEnd()}function k(){b(),p.point=I,p.lineEnd=R}function I(T,S){w(s=T,S),i=f,l=m,a=h,c=g,d=y,p.point=w}function R(){n(f,m,u,h,g,y,i,l,s,a,c,d,G6,r),p.lineEnd=N,N()}return p}}var nQ=em({point:function(e,t){this.stream.point(e*Gt,t*Gt)}});function rQ(e){return em({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function sQ(e,t,n,r,s){function i(l,a){return l*=r,a*=s,[t+e*l,n-e*a]}return i.invert=function(l,a){return[(l-t)/e*r,(n-a)/e*s]},i}function X6(e,t,n,r,s,i){if(!i)return sQ(e,t,n,r,s);var l=Rt(i),a=kt(i),c=l*e,d=a*e,u=l/e,f=a/e,m=(a*n-l*t)/e,h=(a*t+l*n)/e;function g(y,p){return y*=r,p*=s,[c*y-d*p+t,n-d*y-c*p]}return g.invert=function(y,p){return[r*(u*y-f*p+m),s*(h-f*y-u*p)]},g}function za(e){return H3(function(){return e})()}function H3(e){var t,n=150,r=480,s=250,i=0,l=0,a=0,c=0,d=0,u,f=0,m=1,h=1,g=null,y=uN,p=null,x,b,w,N=Ch,k=.5,I,R,T,S,E;function _(B){return T(B[0]*Gt,B[1]*Gt)}function M(B){return B=T.invert(B[0],B[1]),B&&[B[0]*Jn,B[1]*Jn]}_.stream=function(B){return S&&E===B?S:S=nQ(rQ(u)(y(I(N(E=B)))))},_.preclip=function(B){return arguments.length?(y=B,g=void 0,P()):y},_.postclip=function(B){return arguments.length?(N=B,p=x=b=w=null,P()):N},_.clipAngle=function(B){return arguments.length?(y=+B?T9(g=B*Gt):(g=null,uN),P()):g*Jn},_.clipExtent=function(B){return arguments.length?(N=B==null?(p=x=b=w=null,Ch):O0(p=+B[0][0],x=+B[0][1],b=+B[1][0],w=+B[1][1]),P()):p==null?null:[[p,x],[b,w]]},_.scale=function(B){return arguments.length?(n=+B,A()):n},_.translate=function(B){return arguments.length?(r=+B[0],s=+B[1],A()):[r,s]},_.center=function(B){return arguments.length?(i=B[0]%360*Gt,l=B[1]%360*Gt,A()):[i*Jn,l*Jn]},_.rotate=function(B){return arguments.length?(a=B[0]%360*Gt,c=B[1]%360*Gt,d=B.length>2?B[2]%360*Gt:0,A()):[a*Jn,c*Jn,d*Jn]},_.angle=function(B){return arguments.length?(f=B%360*Gt,A()):f*Jn},_.reflectX=function(B){return arguments.length?(m=B?-1:1,A()):m<0},_.reflectY=function(B){return arguments.length?(h=B?-1:1,A()):h<0},_.precision=function(B){return arguments.length?(I=Y6(R,k=B*B),P()):rs(k)},_.fitExtent=function(B,L){return F0(_,B,L)},_.fitSize=function(B,L){return B3(_,B,L)},_.fitWidth=function(B,L){return z3(_,B,L)},_.fitHeight=function(B,L){return U3(_,B,L)};function A(){var B=X6(n,0,0,m,h,f).apply(null,t(i,l)),L=X6(n,r-B[0],s-B[1],m,h,f);return u=D3(a,c,d),R=lN(t,L),T=lN(u,R),I=Y6(R,k),P()}function P(){return S=E=null,_}return function(){return t=e.apply(this,arguments),_.invert=t.invert&&M,A()}}function V3(e){var t=0,n=vn/3,r=H3(e),s=r(t,n);return s.parallels=function(i){return arguments.length?r(t=i[0]*Gt,n=i[1]*Gt):[t*Jn,n*Jn]},s}function iQ(e){var t=Rt(e);function n(r,s){return[r*t,kt(s)/t]}return n.invert=function(r,s){return[r/t,zs(s*t)]},n}function G9(e,t){var n=kt(e),r=(n+kt(t))/2;if(Sn(r)<Wt)return iQ(e);var s=1+n*(2*r-n),i=rs(s)/r;function l(a,c){var d=rs(s-2*r*kt(c))/r;return[d*kt(a*=r),i-d*Rt(a)]}return l.invert=function(a,c){var d=i-c,u=Bs(a,Sn(d))*Mi(d);return d*r<0&&(u-=vn*Mi(a)*Mi(d)),[u/r,zs((s-(a*a+d*d)*r*r)/(2*r))]},l}function Og(){return V3(G9).scale(155.424).center([0,33.6442])}function Y9(){return Og().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function aQ(e){var t=e.length;return{point:function(n,r){for(var s=-1;++s<t;)e[s].point(n,r)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function oQ(){var e,t,n=Y9(),r,s=Og().rotate([154,0]).center([-2,58.5]).parallels([55,65]),i,l=Og().rotate([157,0]).center([-3,19.9]).parallels([8,18]),a,c,d={point:function(m,h){c=[m,h]}};function u(m){var h=m[0],g=m[1];return c=null,r.point(h,g),c||(i.point(h,g),c)||(a.point(h,g),c)}u.invert=function(m){var h=n.scale(),g=n.translate(),y=(m[0]-g[0])/h,p=(m[1]-g[1])/h;return(p>=.12&&p<.234&&y>=-.425&&y<-.214?s:p>=.166&&p<.234&&y>=-.214&&y<-.115?l:n).invert(m)},u.stream=function(m){return e&&t===m?e:e=aQ([n.stream(t=m),s.stream(m),l.stream(m)])},u.precision=function(m){return arguments.length?(n.precision(m),s.precision(m),l.precision(m),f()):n.precision()},u.scale=function(m){return arguments.length?(n.scale(m),s.scale(m*.35),l.scale(m),u.translate(n.translate())):n.scale()},u.translate=function(m){if(!arguments.length)return n.translate();var h=n.scale(),g=+m[0],y=+m[1];return r=n.translate(m).clipExtent([[g-.455*h,y-.238*h],[g+.455*h,y+.238*h]]).stream(d),i=s.translate([g-.307*h,y+.201*h]).clipExtent([[g-.425*h+Wt,y+.12*h+Wt],[g-.214*h-Wt,y+.234*h-Wt]]).stream(d),a=l.translate([g-.205*h,y+.212*h]).clipExtent([[g-.214*h+Wt,y+.166*h+Wt],[g-.115*h-Wt,y+.234*h-Wt]]).stream(d),f()},u.fitExtent=function(m,h){return F0(u,m,h)},u.fitSize=function(m,h){return B3(u,m,h)},u.fitWidth=function(m,h){return z3(u,m,h)},u.fitHeight=function(m,h){return U3(u,m,h)};function f(){return e=t=null,u}return u.scale(1070)}function X9(e){return function(t,n){var r=Rt(t),s=Rt(n),i=e(r*s);return i===1/0?[2,0]:[i*s*kt(t),i*kt(n)]}}function tm(e){return function(t,n){var r=rs(t*t+n*n),s=e(r),i=kt(s),l=Rt(s);return[Bs(t*i,r*l),zs(r&&n*i/r)]}}var W3=X9(function(e){return rs(2/(1+e))});W3.invert=tm(function(e){return 2*zs(e/2)});function lQ(){return za(W3).scale(124.75).clipAngle(180-.001)}var G3=X9(function(e){return(e=p9(e))&&e/kt(e)});G3.invert=tm(function(e){return e});function cQ(){return za(G3).scale(79.4188).clipAngle(180-.001)}function nm(e,t){return[e,xg(O3((wr+t)/2))]}nm.invert=function(e,t){return[e,2*wd(m9(t))-wr]};function uQ(){return K9(nm).scale(961/qs)}function K9(e){var t=za(e),n=t.center,r=t.scale,s=t.translate,i=t.clipExtent,l=null,a,c,d;t.scale=function(f){return arguments.length?(r(f),u()):r()},t.translate=function(f){return arguments.length?(s(f),u()):s()},t.center=function(f){return arguments.length?(n(f),u()):n()},t.clipExtent=function(f){return arguments.length?(f==null?l=a=c=d=null:(l=+f[0][0],a=+f[0][1],c=+f[1][0],d=+f[1][1]),u()):l==null?null:[[l,a],[c,d]]};function u(){var f=vn*r(),m=t(A9(t.rotate()).invert([0,0]));return i(l==null?[[m[0]-f,m[1]-f],[m[0]+f,m[1]+f]]:e===nm?[[Math.max(m[0]-f,l),a],[Math.min(m[0]+f,c),d]]:[[l,Math.max(m[1]-f,a)],[c,Math.min(m[1]+f,d)]])}return u()}function np(e){return O3((wr+e)/2)}function J9(e,t){var n=Rt(e),r=e===t?kt(e):xg(n/Rt(t))/xg(np(t)/np(e)),s=n*kx(np(e),r)/r;if(!r)return nm;function i(l,a){s>0?a<-wr+Wt&&(a=-wr+Wt):a>wr-Wt&&(a=wr-Wt);var c=s/kx(np(a),r);return[c*kt(r*l),s-c*Rt(r*l)]}return i.invert=function(l,a){var c=s-a,d=Mi(r)*rs(l*l+c*c),u=Bs(l,Sn(c))*Mi(c);return c*r<0&&(u-=vn*Mi(l)*Mi(c)),[u/r,2*wd(kx(s/d,1/r))-wr]},i}function dQ(){return V3(J9).scale(109.5).parallels([30,30])}function Th(e,t){return[e,t]}Th.invert=Th;function fQ(){return za(Th).scale(152.63)}function Z9(e,t){var n=Rt(e),r=e===t?kt(e):(n-Rt(t))/(t-e),s=n/r+e;if(Sn(r)<Wt)return Th;function i(l,a){var c=s-a,d=r*l;return[c*kt(d),s-c*Rt(d)]}return i.invert=function(l,a){var c=s-a,d=Bs(l,Sn(c))*Mi(c);return c*r<0&&(d-=vn*Mi(l)*Mi(c)),[d/r,s-Mi(r)*rs(l*l+c*c)]},i}function hQ(){return V3(Z9).scale(131.154).center([0,13.9389])}var sh=1.340264,ih=-.081106,ah=893e-6,oh=.003796,Fg=rs(3)/2,mQ=12;function Y3(e,t){var n=zs(Fg*kt(t)),r=n*n,s=r*r*r;return[e*Rt(n)/(Fg*(sh+3*ih*r+s*(7*ah+9*oh*r))),n*(sh+ih*r+s*(ah+oh*r))]}Y3.invert=function(e,t){for(var n=t,r=n*n,s=r*r*r,i=0,l,a,c;i<mQ&&(a=n*(sh+ih*r+s*(ah+oh*r))-t,c=sh+3*ih*r+s*(7*ah+9*oh*r),n-=l=a/c,r=n*n,s=r*r*r,!(Sn(l)<Eh));++i);return[Fg*e*(sh+3*ih*r+s*(7*ah+9*oh*r))/Rt(n),zs(kt(n)/Fg)]};function pQ(){return za(Y3).scale(177.158)}function X3(e,t){var n=Rt(t),r=Rt(e)*n;return[n*kt(e)/r,kt(t)/r]}X3.invert=tm(wd);function gQ(){return za(X3).scale(144.049).clipAngle(60)}function xQ(){var e=1,t=0,n=0,r=1,s=1,i=0,l,a,c=null,d,u,f,m=1,h=1,g=em({point:function(N,k){var I=w([N,k]);this.stream.point(I[0],I[1])}}),y=Ch,p,x;function b(){return m=e*r,h=e*s,p=x=null,w}function w(N){var k=N[0]*m,I=N[1]*h;if(i){var R=I*l-k*a;k=k*l+I*a,I=R}return[k+t,I+n]}return w.invert=function(N){var k=N[0]-t,I=N[1]-n;if(i){var R=I*l+k*a;k=k*l-I*a,I=R}return[k/m,I/h]},w.stream=function(N){return p&&x===N?p:p=g(y(x=N))},w.postclip=function(N){return arguments.length?(y=N,c=d=u=f=null,b()):y},w.clipExtent=function(N){return arguments.length?(y=N==null?(c=d=u=f=null,Ch):O0(c=+N[0][0],d=+N[0][1],u=+N[1][0],f=+N[1][1]),b()):c==null?null:[[c,d],[u,f]]},w.scale=function(N){return arguments.length?(e=+N,b()):e},w.translate=function(N){return arguments.length?(t=+N[0],n=+N[1],b()):[t,n]},w.angle=function(N){return arguments.length?(i=N%360*Gt,a=kt(i),l=Rt(i),b()):i*Jn},w.reflectX=function(N){return arguments.length?(r=N?-1:1,b()):r<0},w.reflectY=function(N){return arguments.length?(s=N?-1:1,b()):s<0},w.fitExtent=function(N,k){return F0(w,N,k)},w.fitSize=function(N,k){return B3(w,N,k)},w.fitWidth=function(N,k){return z3(w,N,k)},w.fitHeight=function(N,k){return U3(w,N,k)},w}function K3(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),t*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}K3.invert=function(e,t){var n=t,r=25,s;do{var i=n*n,l=i*i;n-=s=(n*(1.007226+i*(.015085+l*(-.044475+.028874*i-.005916*l)))-t)/(1.007226+i*(.015085*3+l*(-.044475*7+.028874*9*i-.005916*11*l)))}while(Sn(s)>Wt&&--r>0);return[e/(.8707+(i=n*n)*(-.131979+i*(-.013791+i*i*i*(.003971-.001529*i)))),n]};function yQ(){return za(K3).scale(175.295)}function J3(e,t){return[Rt(t)*kt(e),kt(t)]}J3.invert=tm(zs);function vQ(){return za(J3).scale(249.5).clipAngle(90+Wt)}function Z3(e,t){var n=Rt(t),r=1+Rt(e)*n;return[n*kt(e)/r,kt(t)/r]}Z3.invert=tm(function(e){return 2*wd(e)});function bQ(){return za(Z3).scale(250).clipAngle(142)}function Q3(e,t){return[xg(O3((wr+t)/2)),-e]}Q3.invert=function(e,t){return[-t,2*wd(m9(e))-wr]};function wQ(){var e=K9(Q3),t=e.center,n=e.rotate;return e.center=function(r){return arguments.length?t([-r[1],r[0]]):(r=t(),[r[1],-r[0]])},e.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)}function NQ(e,t){return e.parent===t.parent?1:2}function jQ(e){return e.reduce(_Q,0)/e.length}function _Q(e,t){return e+t.x}function SQ(e){return 1+e.reduce(AQ,0)}function AQ(e,t){return Math.max(e,t.y)}function kQ(e){for(var t;t=e.children;)e=t[0];return e}function EQ(e){for(var t;t=e.children;)e=t[t.length-1];return e}function CQ(){var e=NQ,t=1,n=1,r=!1;function s(i){var l,a=0;i.eachAfter(function(m){var h=m.children;h?(m.x=jQ(h),m.y=SQ(h)):(m.x=l?a+=e(m,l):0,m.y=0,l=m)});var c=kQ(i),d=EQ(i),u=c.x-e(c,d)/2,f=d.x+e(d,c)/2;return i.eachAfter(r?function(m){m.x=(m.x-i.x)*t,m.y=(i.y-m.y)*n}:function(m){m.x=(m.x-u)/(f-u)*t,m.y=(1-(i.y?m.y/i.y:1))*n})}return s.separation=function(i){return arguments.length?(e=i,s):e},s.size=function(i){return arguments.length?(r=!1,t=+i[0],n=+i[1],s):r?null:[t,n]},s.nodeSize=function(i){return arguments.length?(r=!0,t=+i[0],n=+i[1],s):r?[t,n]:null},s}function PQ(e){var t=0,n=e.children,r=n&&n.length;if(!r)t=1;else for(;--r>=0;)t+=n[r].value;e.value=t}function IQ(){return this.eachAfter(PQ)}function TQ(e,t){let n=-1;for(const r of this)e.call(t,r,++n,this);return this}function LQ(e,t){for(var n=this,r=[n],s,i,l=-1;n=r.pop();)if(e.call(t,n,++l,this),s=n.children)for(i=s.length-1;i>=0;--i)r.push(s[i]);return this}function MQ(e,t){for(var n=this,r=[n],s=[],i,l,a,c=-1;n=r.pop();)if(s.push(n),i=n.children)for(l=0,a=i.length;l<a;++l)r.push(i[l]);for(;n=s.pop();)e.call(t,n,++c,this);return this}function RQ(e,t){let n=-1;for(const r of this)if(e.call(t,r,++n,this))return r}function $Q(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,r=t.children,s=r&&r.length;--s>=0;)n+=r[s].value;t.value=n})}function OQ(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function FQ(e){for(var t=this,n=DQ(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var s=r.length;e!==n;)r.splice(s,0,e),e=e.parent;return r}function DQ(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),s=null;for(e=n.pop(),t=r.pop();e===t;)s=e,e=n.pop(),t=r.pop();return s}function qQ(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function BQ(){return Array.from(this)}function zQ(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function UQ(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*HQ(){var e=this,t,n=[e],r,s,i;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,r=e.children)for(s=0,i=r.length;s<i;++s)n.push(r[s]);while(n.length)}function e4(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=GQ)):t===void 0&&(t=WQ);for(var n=new ad(e),r,s=[n],i,l,a,c;r=s.pop();)if((l=t(r.data))&&(c=(l=Array.from(l)).length))for(r.children=l,a=c-1;a>=0;--a)s.push(i=l[a]=new ad(l[a])),i.parent=r,i.depth=r.depth+1;return n.eachBefore(Q9)}function VQ(){return e4(this).eachBefore(YQ)}function WQ(e){return e.children}function GQ(e){return Array.isArray(e)?e[1]:null}function YQ(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function Q9(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function ad(e){this.data=e,this.depth=this.height=0,this.parent=null}ad.prototype=e4.prototype={constructor:ad,count:IQ,each:TQ,eachAfter:MQ,eachBefore:LQ,find:RQ,sum:$Q,sort:OQ,path:FQ,ancestors:qQ,descendants:BQ,leaves:zQ,links:UQ,copy:VQ,[Symbol.iterator]:HQ};function XQ(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function KQ(e){for(var t=e.length,n,r;t;)r=Math.random()*t--|0,n=e[t],e[t]=e[r],e[r]=n;return e}function eL(e){for(var t=0,n=(e=KQ(Array.from(e))).length,r=[],s,i;t<n;)s=e[t],i&&tL(i,s)?++t:(i=ZQ(r=JQ(r,s)),t=0);return i}function JQ(e,t){var n,r;if(Tx(t,e))return[t];for(n=0;n<e.length;++n)if(rp(t,e[n])&&Tx(zf(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(r=n+1;r<e.length;++r)if(rp(zf(e[n],e[r]),t)&&rp(zf(e[n],t),e[r])&&rp(zf(e[r],t),e[n])&&Tx(nL(e[n],e[r],t),e))return[e[n],e[r],t];throw new Error}function rp(e,t){var n=e.r-t.r,r=t.x-e.x,s=t.y-e.y;return n<0||n*n<r*r+s*s}function tL(e,t){var n=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,r=t.x-e.x,s=t.y-e.y;return n>0&&n*n>r*r+s*s}function Tx(e,t){for(var n=0;n<t.length;++n)if(!tL(e,t[n]))return!1;return!0}function ZQ(e){switch(e.length){case 1:return QQ(e[0]);case 2:return zf(e[0],e[1]);case 3:return nL(e[0],e[1],e[2])}}function QQ(e){return{x:e.x,y:e.y,r:e.r}}function zf(e,t){var n=e.x,r=e.y,s=e.r,i=t.x,l=t.y,a=t.r,c=i-n,d=l-r,u=a-s,f=Math.sqrt(c*c+d*d);return{x:(n+i+c/f*u)/2,y:(r+l+d/f*u)/2,r:(f+s+a)/2}}function nL(e,t,n){var r=e.x,s=e.y,i=e.r,l=t.x,a=t.y,c=t.r,d=n.x,u=n.y,f=n.r,m=r-l,h=r-d,g=s-a,y=s-u,p=c-i,x=f-i,b=r*r+s*s-i*i,w=b-l*l-a*a+c*c,N=b-d*d-u*u+f*f,k=h*g-m*y,I=(g*N-y*w)/(k*2)-r,R=(y*p-g*x)/k,T=(h*w-m*N)/(k*2)-s,S=(m*x-h*p)/k,E=R*R+S*S-1,_=2*(i+I*R+T*S),M=I*I+T*T-i*i,A=-(E?(_+Math.sqrt(_*_-4*E*M))/(2*E):M/_);return{x:r+I+R*A,y:s+T+S*A,r:A}}function K6(e,t,n){var r=e.x-t.x,s,i,l=e.y-t.y,a,c,d=r*r+l*l;d?(i=t.r+n.r,i*=i,c=e.r+n.r,c*=c,i>c?(s=(d+c-i)/(2*d),a=Math.sqrt(Math.max(0,c/d-s*s)),n.x=e.x-s*r-a*l,n.y=e.y-s*l+a*r):(s=(d+i-c)/(2*d),a=Math.sqrt(Math.max(0,i/d-s*s)),n.x=t.x+s*r-a*l,n.y=t.y+s*l+a*r)):(n.x=t.x+n.r,n.y=t.y)}function J6(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,s=t.y-e.y;return n>0&&n*n>r*r+s*s}function Z6(e){var t=e._,n=e.next._,r=t.r+n.r,s=(t.x*n.r+n.x*t.r)/r,i=(t.y*n.r+n.y*t.r)/r;return s*s+i*i}function sp(e){this._=e,this.next=null,this.previous=null}function rL(e){if(!(s=(e=XQ(e)).length))return 0;var t,n,r,s,i,l,a,c,d,u,f;if(t=e[0],t.x=0,t.y=0,!(s>1))return t.r;if(n=e[1],t.x=-n.r,n.x=t.r,n.y=0,!(s>2))return t.r+n.r;K6(n,t,r=e[2]),t=new sp(t),n=new sp(n),r=new sp(r),t.next=r.previous=n,n.next=t.previous=r,r.next=n.previous=t;e:for(a=3;a<s;++a){K6(t._,n._,r=e[a]),r=new sp(r),c=n.next,d=t.previous,u=n._.r,f=t._.r;do if(u<=f){if(J6(c._,r._)){n=c,t.next=n,n.previous=t,--a;continue e}u+=c._.r,c=c.next}else{if(J6(d._,r._)){t=d,t.next=n,n.previous=t,--a;continue e}f+=d._.r,d=d.previous}while(c!==d.next);for(r.previous=t,r.next=n,t.next=n.previous=n=r,i=Z6(t);(r=r.next)!==n;)(l=Z6(r))<i&&(t=r,i=l);n=t.next}for(t=[n._],r=n;(r=r.next)!==n;)t.push(r._);for(r=eL(t),a=0;a<s;++a)t=e[a],t.x-=r.x,t.y-=r.y;return r.r}function eee(e){return rL(e),e}function tee(e){return e==null?null:Dg(e)}function Dg(e){if(typeof e!="function")throw new Error;return e}function rc(){return 0}function Su(e){return function(){return e}}function nee(e){return Math.sqrt(e.value)}function ree(){var e=null,t=1,n=1,r=rc;function s(i){return i.x=t/2,i.y=n/2,e?i.eachBefore(Q6(e)).eachAfter(Lx(r,.5)).eachBefore(eS(1)):i.eachBefore(Q6(nee)).eachAfter(Lx(rc,1)).eachAfter(Lx(r,i.r/Math.min(t,n))).eachBefore(eS(Math.min(t,n)/(2*i.r))),i}return s.radius=function(i){return arguments.length?(e=tee(i),s):e},s.size=function(i){return arguments.length?(t=+i[0],n=+i[1],s):[t,n]},s.padding=function(i){return arguments.length?(r=typeof i=="function"?i:Su(+i),s):r},s}function Q6(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function Lx(e,t){return function(n){if(r=n.children){var r,s,i=r.length,l=e(n)*t||0,a;if(l)for(s=0;s<i;++s)r[s].r+=l;if(a=rL(r),l)for(s=0;s<i;++s)r[s].r-=l;n.r=a+l}}}function eS(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function sL(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function rm(e,t,n,r,s){for(var i=e.children,l,a=-1,c=i.length,d=e.value&&(r-t)/e.value;++a<c;)l=i[a],l.y0=n,l.y1=s,l.x0=t,l.x1=t+=l.value*d}function see(){var e=1,t=1,n=0,r=!1;function s(l){var a=l.height+1;return l.x0=l.y0=n,l.x1=e,l.y1=t/a,l.eachBefore(i(t,a)),r&&l.eachBefore(sL),l}function i(l,a){return function(c){c.children&&rm(c,c.x0,l*(c.depth+1)/a,c.x1,l*(c.depth+2)/a);var d=c.x0,u=c.y0,f=c.x1-n,m=c.y1-n;f<d&&(d=f=(d+f)/2),m<u&&(u=m=(u+m)/2),c.x0=d,c.y0=u,c.x1=f,c.y1=m}}return s.round=function(l){return arguments.length?(r=!!l,s):r},s.size=function(l){return arguments.length?(e=+l[0],t=+l[1],s):[e,t]},s.padding=function(l){return arguments.length?(n=+l,s):n},s}var iee={depth:-1},tS={};function aee(e){return e.id}function oee(e){return e.parentId}function lee(){var e=aee,t=oee;function n(r){var s=Array.from(r),i=s.length,l,a,c,d,u,f,m,h=new Map;for(a=0;a<i;++a)l=s[a],u=s[a]=new ad(l),(f=e(l,a,r))!=null&&(f+="")&&(m=u.id=f,h.set(m,h.has(m)?tS:u)),(f=t(l,a,r))!=null&&(f+="")&&(u.parent=f);for(a=0;a<i;++a)if(u=s[a],f=u.parent){if(d=h.get(f),!d)throw new Error("missing: "+f);if(d===tS)throw new Error("ambiguous: "+f);d.children?d.children.push(u):d.children=[u],u.parent=d}else{if(c)throw new Error("multiple roots");c=u}if(!c)throw new Error("no root");if(c.parent=iee,c.eachBefore(function(g){g.depth=g.parent.depth+1,--i}).eachBefore(Q9),c.parent=null,i>0)throw new Error("cycle");return c}return n.id=function(r){return arguments.length?(e=Dg(r),n):e},n.parentId=function(r){return arguments.length?(t=Dg(r),n):t},n}function cee(e,t){return e.parent===t.parent?1:2}function Mx(e){var t=e.children;return t?t[0]:e.t}function Rx(e){var t=e.children;return t?t[t.length-1]:e.t}function uee(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function dee(e){for(var t=0,n=0,r=e.children,s=r.length,i;--s>=0;)i=r[s],i.z+=t,i.m+=t,t+=i.s+(n+=i.c)}function fee(e,t,n){return e.a.parent===t.parent?e.a:n}function Hp(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}Hp.prototype=Object.create(ad.prototype);function hee(e){for(var t=new Hp(e,0),n,r=[t],s,i,l,a;n=r.pop();)if(i=n._.children)for(n.children=new Array(a=i.length),l=a-1;l>=0;--l)r.push(s=n.children[l]=new Hp(i[l],l)),s.parent=n;return(t.parent=new Hp(null,0)).children=[t],t}function mee(){var e=cee,t=1,n=1,r=null;function s(d){var u=hee(d);if(u.eachAfter(i),u.parent.m=-u.z,u.eachBefore(l),r)d.eachBefore(c);else{var f=d,m=d,h=d;d.eachBefore(function(b){b.x<f.x&&(f=b),b.x>m.x&&(m=b),b.depth>h.depth&&(h=b)});var g=f===m?1:e(f,m)/2,y=g-f.x,p=t/(m.x+g+y),x=n/(h.depth||1);d.eachBefore(function(b){b.x=(b.x+y)*p,b.y=b.depth*x})}return d}function i(d){var u=d.children,f=d.parent.children,m=d.i?f[d.i-1]:null;if(u){dee(d);var h=(u[0].z+u[u.length-1].z)/2;m?(d.z=m.z+e(d._,m._),d.m=d.z-h):d.z=h}else m&&(d.z=m.z+e(d._,m._));d.parent.A=a(d,m,d.parent.A||f[0])}function l(d){d._.x=d.z+d.parent.m,d.m+=d.parent.m}function a(d,u,f){if(u){for(var m=d,h=d,g=u,y=m.parent.children[0],p=m.m,x=h.m,b=g.m,w=y.m,N;g=Rx(g),m=Mx(m),g&&m;)y=Mx(y),h=Rx(h),h.a=d,N=g.z+b-m.z-p+e(g._,m._),N>0&&(uee(fee(g,d,f),d,N),p+=N,x+=N),b+=g.m,p+=m.m,w+=y.m,x+=h.m;g&&!Rx(h)&&(h.t=g,h.m+=b-x),m&&!Mx(y)&&(y.t=m,y.m+=p-w,f=d)}return f}function c(d){d.x*=t,d.y=d.depth*n}return s.separation=function(d){return arguments.length?(e=d,s):e},s.size=function(d){return arguments.length?(r=!1,t=+d[0],n=+d[1],s):r?null:[t,n]},s.nodeSize=function(d){return arguments.length?(r=!0,t=+d[0],n=+d[1],s):r?[t,n]:null},s}function D0(e,t,n,r,s){for(var i=e.children,l,a=-1,c=i.length,d=e.value&&(s-n)/e.value;++a<c;)l=i[a],l.x0=t,l.x1=r,l.y0=n,l.y1=n+=l.value*d}var iL=(1+Math.sqrt(5))/2;function aL(e,t,n,r,s,i){for(var l=[],a=t.children,c,d,u=0,f=0,m=a.length,h,g,y=t.value,p,x,b,w,N,k,I;u<m;){h=s-n,g=i-r;do p=a[f++].value;while(!p&&f<m);for(x=b=p,k=Math.max(g/h,h/g)/(y*e),I=p*p*k,N=Math.max(b/I,I/x);f<m;++f){if(p+=d=a[f].value,d<x&&(x=d),d>b&&(b=d),I=p*p*k,w=Math.max(b/I,I/x),w>N){p-=d;break}N=w}l.push(c={value:p,dice:h<g,children:a.slice(u,f)}),c.dice?rm(c,n,r,s,y?r+=g*p/y:i):D0(c,n,r,y?n+=h*p/y:s,i),y-=p,u=f}return l}const oL=function e(t){function n(r,s,i,l,a){aL(t,r,s,i,l,a)}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(iL);function pee(){var e=oL,t=!1,n=1,r=1,s=[0],i=rc,l=rc,a=rc,c=rc,d=rc;function u(m){return m.x0=m.y0=0,m.x1=n,m.y1=r,m.eachBefore(f),s=[0],t&&m.eachBefore(sL),m}function f(m){var h=s[m.depth],g=m.x0+h,y=m.y0+h,p=m.x1-h,x=m.y1-h;p<g&&(g=p=(g+p)/2),x<y&&(y=x=(y+x)/2),m.x0=g,m.y0=y,m.x1=p,m.y1=x,m.children&&(h=s[m.depth+1]=i(m)/2,g+=d(m)-h,y+=l(m)-h,p-=a(m)-h,x-=c(m)-h,p<g&&(g=p=(g+p)/2),x<y&&(y=x=(y+x)/2),e(m,g,y,p,x))}return u.round=function(m){return arguments.length?(t=!!m,u):t},u.size=function(m){return arguments.length?(n=+m[0],r=+m[1],u):[n,r]},u.tile=function(m){return arguments.length?(e=Dg(m),u):e},u.padding=function(m){return arguments.length?u.paddingInner(m).paddingOuter(m):u.paddingInner()},u.paddingInner=function(m){return arguments.length?(i=typeof m=="function"?m:Su(+m),u):i},u.paddingOuter=function(m){return arguments.length?u.paddingTop(m).paddingRight(m).paddingBottom(m).paddingLeft(m):u.paddingTop()},u.paddingTop=function(m){return arguments.length?(l=typeof m=="function"?m:Su(+m),u):l},u.paddingRight=function(m){return arguments.length?(a=typeof m=="function"?m:Su(+m),u):a},u.paddingBottom=function(m){return arguments.length?(c=typeof m=="function"?m:Su(+m),u):c},u.paddingLeft=function(m){return arguments.length?(d=typeof m=="function"?m:Su(+m),u):d},u}function gee(e,t,n,r,s){var i=e.children,l,a=i.length,c,d=new Array(a+1);for(d[0]=c=l=0;l<a;++l)d[l+1]=c+=i[l].value;u(0,a,e.value,t,n,r,s);function u(f,m,h,g,y,p,x){if(f>=m-1){var b=i[f];b.x0=g,b.y0=y,b.x1=p,b.y1=x;return}for(var w=d[f],N=h/2+w,k=f+1,I=m-1;k<I;){var R=k+I>>>1;d[R]<N?k=R+1:I=R}N-d[k-1]<d[k]-N&&f+1<k&&--k;var T=d[k]-w,S=h-T;if(p-g>x-y){var E=h?(g*S+p*T)/h:p;u(f,k,T,g,y,E,x),u(k,m,S,E,y,p,x)}else{var _=h?(y*S+x*T)/h:x;u(f,k,T,g,y,p,_),u(k,m,S,g,_,p,x)}}}function xee(e,t,n,r,s){(e.depth&1?D0:rm)(e,t,n,r,s)}const yee=function e(t){function n(r,s,i,l,a){if((c=r._squarify)&&c.ratio===t)for(var c,d,u,f,m=-1,h,g=c.length,y=r.value;++m<g;){for(d=c[m],u=d.children,f=d.value=0,h=u.length;f<h;++f)d.value+=u[f].value;d.dice?rm(d,s,i,l,y?i+=(a-i)*d.value/y:a):D0(d,s,i,y?s+=(l-s)*d.value/y:l,a),y-=d.value}else r._squarify=c=aL(t,r,s,i,l,a),c.ratio=t}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(iL);function vee(e){for(var t=-1,n=e.length,r,s=e[n-1],i=0;++t<n;)r=s,s=e[t],i+=r[1]*s[0]-r[0]*s[1];return i/2}function bee(e){for(var t=-1,n=e.length,r=0,s=0,i,l=e[n-1],a,c=0;++t<n;)i=l,l=e[t],c+=a=i[0]*l[1]-l[0]*i[1],r+=(i[0]+l[0])*a,s+=(i[1]+l[1])*a;return c*=3,[r/c,s/c]}function wee(e,t,n){return(t[0]-e[0])*(n[1]-e[1])-(t[1]-e[1])*(n[0]-e[0])}function Nee(e,t){return e[0]-t[0]||e[1]-t[1]}function nS(e){const t=e.length,n=[0,1];let r=2,s;for(s=2;s<t;++s){for(;r>1&&wee(e[n[r-2]],e[n[r-1]],e[s])<=0;)--r;n[r++]=s}return n.slice(0,r)}function jee(e){if((n=e.length)<3)return null;var t,n,r=new Array(n),s=new Array(n);for(t=0;t<n;++t)r[t]=[+e[t][0],+e[t][1],t];for(r.sort(Nee),t=0;t<n;++t)s[t]=[r[t][0],-r[t][1]];var i=nS(r),l=nS(s),a=l[0]===i[0],c=l[l.length-1]===i[i.length-1],d=[];for(t=i.length-1;t>=0;--t)d.push(e[r[i[t]][2]]);for(t=+a;t<l.length-c;++t)d.push(e[r[l[t]][2]]);return d}function _ee(e,t){for(var n=e.length,r=e[n-1],s=t[0],i=t[1],l=r[0],a=r[1],c,d,u=!1,f=0;f<n;++f)r=e[f],c=r[0],d=r[1],d>i!=a>i&&s<(l-c)*(i-d)/(a-d)+c&&(u=!u),l=c,a=d;return u}function See(e){for(var t=-1,n=e.length,r=e[n-1],s,i,l=r[0],a=r[1],c=0;++t<n;)s=l,i=a,r=e[t],l=r[0],a=r[1],s-=l,i-=a,c+=Math.hypot(s,i);return c}const ms=Math.random,Aee=function e(t){function n(r,s){return r=r==null?0:+r,s=s==null?1:+s,arguments.length===1?(s=r,r=0):s-=r,function(){return t()*s+r}}return n.source=e,n}(ms),kee=function e(t){function n(r,s){return arguments.length<2&&(s=r,r=0),r=Math.floor(r),s=Math.floor(s)-r,function(){return Math.floor(t()*s+r)}}return n.source=e,n}(ms),t4=function e(t){function n(r,s){var i,l;return r=r==null?0:+r,s=s==null?1:+s,function(){var a;if(i!=null)a=i,i=null;else do i=t()*2-1,a=t()*2-1,l=i*i+a*a;while(!l||l>1);return r+s*a*Math.sqrt(-2*Math.log(l)/l)}}return n.source=e,n}(ms),Eee=function e(t){var n=t4.source(t);function r(){var s=n.apply(this,arguments);return function(){return Math.exp(s())}}return r.source=e,r}(ms),lL=function e(t){function n(r){return(r=+r)<=0?()=>0:function(){for(var s=0,i=r;i>1;--i)s+=t();return s+i*t()}}return n.source=e,n}(ms),Cee=function e(t){var n=lL.source(t);function r(s){if((s=+s)==0)return t;var i=n(s);return function(){return i()/s}}return r.source=e,r}(ms),Pee=function e(t){function n(r){return function(){return-Math.log1p(-t())/r}}return n.source=e,n}(ms),Iee=function e(t){function n(r){if((r=+r)<0)throw new RangeError("invalid alpha");return r=1/-r,function(){return Math.pow(1-t(),r)}}return n.source=e,n}(ms),Tee=function e(t){function n(r){if((r=+r)<0||r>1)throw new RangeError("invalid p");return function(){return Math.floor(t()+r)}}return n.source=e,n}(ms),cL=function e(t){function n(r){if((r=+r)<0||r>1)throw new RangeError("invalid p");return r===0?()=>1/0:r===1?()=>1:(r=Math.log1p(-r),function(){return 1+Math.floor(Math.log1p(-t())/r)})}return n.source=e,n}(ms),n4=function e(t){var n=t4.source(t)();function r(s,i){if((s=+s)<0)throw new RangeError("invalid k");if(s===0)return()=>0;if(i=i==null?1:+i,s===1)return()=>-Math.log1p(-t())*i;var l=(s<1?s+1:s)-1/3,a=1/(3*Math.sqrt(l)),c=s<1?()=>Math.pow(t(),1/s):()=>1;return function(){do{do var d=n(),u=1+a*d;while(u<=0);u*=u*u;var f=1-t()}while(f>=1-.0331*d*d*d*d&&Math.log(f)>=.5*d*d+l*(1-u+Math.log(u)));return l*u*c()*i}}return r.source=e,r}(ms),uL=function e(t){var n=n4.source(t);function r(s,i){var l=n(s),a=n(i);return function(){var c=l();return c===0?0:c/(c+a())}}return r.source=e,r}(ms),dL=function e(t){var n=cL.source(t),r=uL.source(t);function s(i,l){return i=+i,(l=+l)>=1?()=>i:l<=0?()=>0:function(){for(var a=0,c=i,d=l;c*d>16&&c*(1-d)>16;){var u=Math.floor((c+1)*d),f=r(u,c-u+1)();f<=d?(a+=u,c-=u,d=(d-f)/(1-f)):(c=u-1,d/=f)}for(var m=d<.5,h=m?d:1-d,g=n(h),y=g(),p=0;y<=c;++p)y+=g();return a+(m?p:c-p)}}return s.source=e,s}(ms),Lee=function e(t){function n(r,s,i){var l;return(r=+r)==0?l=a=>-Math.log(a):(r=1/r,l=a=>Math.pow(a,r)),s=s==null?0:+s,i=i==null?1:+i,function(){return s+i*l(-Math.log1p(-t()))}}return n.source=e,n}(ms),Mee=function e(t){function n(r,s){return r=r==null?0:+r,s=s==null?1:+s,function(){return r+s*Math.tan(Math.PI*t())}}return n.source=e,n}(ms),Ree=function e(t){function n(r,s){return r=r==null?0:+r,s=s==null?1:+s,function(){var i=t();return r+s*Math.log(i/(1-i))}}return n.source=e,n}(ms),$ee=function e(t){var n=n4.source(t),r=dL.source(t);function s(i){return function(){for(var l=0,a=i;a>16;){var c=Math.floor(.875*a),d=n(c)();if(d>a)return l+r(c-1,a/d)();l+=c,a-=d}for(var u=-Math.log1p(-t()),f=0;u<=a;++f)u-=Math.log1p(-t());return l+f}}return s.source=e,s}(ms),Oee=1664525,Fee=1013904223,rS=1/4294967296;function Dee(e=Math.random()){let t=(0<=e&&e<1?e/rS:Math.abs(e))|0;return()=>(t=Oee*t+Fee|0,rS*(t>>>0))}function Bi(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function ko(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const jN=Symbol("implicit");function r4(){var e=new Map,t=[],n=[],r=jN;function s(i){var l=i+"",a=e.get(l);if(!a){if(r!==jN)return r;e.set(l,a=t.push(i))}return n[(a-1)%n.length]}return s.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new Map;for(const l of i){const a=l+"";e.has(a)||e.set(a,t.push(l))}return s},s.range=function(i){return arguments.length?(n=Array.from(i),s):n.slice()},s.unknown=function(i){return arguments.length?(r=i,s):r},s.copy=function(){return r4(t,n).unknown(r)},Bi.apply(s,arguments),s}function s4(){var e=r4().unknown(void 0),t=e.domain,n=e.range,r=0,s=1,i,l,a=!1,c=0,d=0,u=.5;delete e.unknown;function f(){var m=t().length,h=s<r,g=h?s:r,y=h?r:s;i=(y-g)/Math.max(1,m-c+d*2),a&&(i=Math.floor(i)),g+=(y-g-i*(m-c))*u,l=i*(1-c),a&&(g=Math.round(g),l=Math.round(l));var p=Pa(m).map(function(x){return g+i*x});return n(h?p.reverse():p)}return e.domain=function(m){return arguments.length?(t(m),f()):t()},e.range=function(m){return arguments.length?([r,s]=m,r=+r,s=+s,f()):[r,s]},e.rangeRound=function(m){return[r,s]=m,r=+r,s=+s,a=!0,f()},e.bandwidth=function(){return l},e.step=function(){return i},e.round=function(m){return arguments.length?(a=!!m,f()):a},e.padding=function(m){return arguments.length?(c=Math.min(1,d=+m),f()):c},e.paddingInner=function(m){return arguments.length?(c=Math.min(1,m),f()):c},e.paddingOuter=function(m){return arguments.length?(d=+m,f()):d},e.align=function(m){return arguments.length?(u=Math.max(0,Math.min(1,m)),f()):u},e.copy=function(){return s4(t(),[r,s]).round(a).paddingInner(c).paddingOuter(d).align(u)},Bi.apply(f(),arguments)}function fL(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return fL(t())},e}function qee(){return fL(s4.apply(null,arguments).paddingInner(1))}function Bee(e){return function(){return e}}function qg(e){return+e}var sS=[0,1];function Ds(e){return e}function _N(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:Bee(isNaN(t)?NaN:.5)}function zee(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function Uee(e,t,n){var r=e[0],s=e[1],i=t[0],l=t[1];return s<r?(r=_N(s,r),i=n(l,i)):(r=_N(r,s),i=n(i,l)),function(a){return i(r(a))}}function Hee(e,t,n){var r=Math.min(e.length,t.length)-1,s=new Array(r),i=new Array(r),l=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++l<r;)s[l]=_N(e[l],e[l+1]),i[l]=n(t[l],t[l+1]);return function(a){var c=pl(e,a,1,r)-1;return i[c](s[c](a))}}function sm(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function q0(){var e=sS,t=sS,n=_l,r,s,i,l=Ds,a,c,d;function u(){var m=Math.min(e.length,t.length);return l!==Ds&&(l=zee(e[0],e[m-1])),a=m>2?Hee:Uee,c=d=null,f}function f(m){return m==null||isNaN(m=+m)?i:(c||(c=a(e.map(r),t,n)))(r(l(m)))}return f.invert=function(m){return l(s((d||(d=a(t,e.map(r),Ti)))(m)))},f.domain=function(m){return arguments.length?(e=Array.from(m,qg),u()):e.slice()},f.range=function(m){return arguments.length?(t=Array.from(m),u()):t.slice()},f.rangeRound=function(m){return t=Array.from(m),n=k0,u()},f.clamp=function(m){return arguments.length?(l=m?!0:Ds,u()):l!==Ds},f.interpolate=function(m){return arguments.length?(n=m,u()):n},f.unknown=function(m){return arguments.length?(i=m,f):i},function(m,h){return r=m,s=h,u()}}function i4(){return q0()(Ds,Ds)}function hL(e,t,n,r){var s=Ju(e,t,n),i;switch(r=kh(r??",f"),r.type){case"s":{var l=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(i=f9(s,l))&&(r.precision=i),$3(r,l)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(i=h9(s,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=i-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(i=d9(s))&&(r.precision=i-(r.type==="%")*2);break}}return $0(r)}function Al(e){var t=e.domain;return e.ticks=function(n){var r=t();return yh(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var s=t();return hL(s[0],s[s.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),s=0,i=r.length-1,l=r[s],a=r[i],c,d,u=10;for(a<l&&(d=l,l=a,a=d,d=s,s=i,i=d);u-- >0;){if(d=Xh(l,a,n),d===c)return r[s]=l,r[i]=a,t(r);if(d>0)l=Math.floor(l/d)*d,a=Math.ceil(a/d)*d;else if(d<0)l=Math.ceil(l*d)/d,a=Math.floor(a*d)/d;else break;c=d}return e},e}function mL(){var e=i4();return e.copy=function(){return sm(e,mL())},Bi.apply(e,arguments),Al(e)}function pL(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,qg),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return pL(e).unknown(t)},e=arguments.length?Array.from(e,qg):[0,1],Al(n)}function gL(e,t){e=e.slice();var n=0,r=e.length-1,s=e[n],i=e[r],l;return i<s&&(l=n,n=r,r=l,l=s,s=i,i=l),e[n]=t.floor(s),e[r]=t.ceil(i),e}function iS(e){return Math.log(e)}function aS(e){return Math.exp(e)}function Vee(e){return-Math.log(-e)}function Wee(e){return-Math.exp(-e)}function Gee(e){return isFinite(e)?+("1e"+e):e<0?0:e}function Yee(e){return e===10?Gee:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function Xee(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function oS(e){return function(t){return-e(-t)}}function a4(e){var t=e(iS,aS),n=t.domain,r=10,s,i;function l(){return s=Xee(r),i=Yee(r),n()[0]<0?(s=oS(s),i=oS(i),e(Vee,Wee)):e(iS,aS),t}return t.base=function(a){return arguments.length?(r=+a,l()):r},t.domain=function(a){return arguments.length?(n(a),l()):n()},t.ticks=function(a){var c=n(),d=c[0],u=c[c.length-1],f;(f=u<d)&&(m=d,d=u,u=m);var m=s(d),h=s(u),g,y,p,x=a==null?10:+a,b=[];if(!(r%1)&&h-m<x){if(m=Math.floor(m),h=Math.ceil(h),d>0){for(;m<=h;++m)for(y=1,g=i(m);y<r;++y)if(p=g*y,!(p<d)){if(p>u)break;b.push(p)}}else for(;m<=h;++m)for(y=r-1,g=i(m);y>=1;--y)if(p=g*y,!(p<d)){if(p>u)break;b.push(p)}b.length*2<x&&(b=yh(d,u,x))}else b=yh(m,h,Math.min(h-m,x)).map(i);return f?b.reverse():b},t.tickFormat=function(a,c){if(c==null&&(c=r===10?".0e":","),typeof c!="function"&&(c=$0(c)),a===1/0)return c;a==null&&(a=10);var d=Math.max(1,r*a/t.ticks().length);return function(u){var f=u/i(Math.round(s(u)));return f*r<r-.5&&(f*=r),f<=d?c(u):""}},t.nice=function(){return n(gL(n(),{floor:function(a){return i(Math.floor(s(a)))},ceil:function(a){return i(Math.ceil(s(a)))}}))},t}function xL(){var e=a4(q0()).domain([1,10]);return e.copy=function(){return sm(e,xL()).base(e.base())},Bi.apply(e,arguments),e}function lS(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function cS(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function o4(e){var t=1,n=e(lS(t),cS(t));return n.constant=function(r){return arguments.length?e(lS(t=+r),cS(t)):t},Al(n)}function yL(){var e=o4(q0());return e.copy=function(){return sm(e,yL()).constant(e.constant())},Bi.apply(e,arguments)}function uS(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function Kee(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function Jee(e){return e<0?-e*e:e*e}function l4(e){var t=e(Ds,Ds),n=1;function r(){return n===1?e(Ds,Ds):n===.5?e(Kee,Jee):e(uS(n),uS(1/n))}return t.exponent=function(s){return arguments.length?(n=+s,r()):n},Al(t)}function c4(){var e=l4(q0());return e.copy=function(){return sm(e,c4()).exponent(e.exponent())},Bi.apply(e,arguments),e}function Zee(){return c4.apply(null,arguments).exponent(.5)}function dS(e){return Math.sign(e)*e*e}function Qee(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function vL(){var e=i4(),t=[0,1],n=!1,r;function s(i){var l=Qee(e(i));return isNaN(l)?r:n?Math.round(l):l}return s.invert=function(i){return e.invert(dS(i))},s.domain=function(i){return arguments.length?(e.domain(i),s):e.domain()},s.range=function(i){return arguments.length?(e.range((t=Array.from(i,qg)).map(dS)),s):t.slice()},s.rangeRound=function(i){return s.range(i).round(!0)},s.round=function(i){return arguments.length?(n=!!i,s):n},s.clamp=function(i){return arguments.length?(e.clamp(i),s):e.clamp()},s.unknown=function(i){return arguments.length?(r=i,s):r},s.copy=function(){return vL(e.domain(),t).round(n).clamp(e.clamp()).unknown(r)},Bi.apply(s,arguments),Al(s)}function bL(){var e=[],t=[],n=[],r;function s(){var l=0,a=Math.max(1,t.length);for(n=new Array(a-1);++l<a;)n[l-1]=XI(e,l/a);return i}function i(l){return l==null||isNaN(l=+l)?r:t[pl(n,l)]}return i.invertExtent=function(l){var a=t.indexOf(l);return a<0?[NaN,NaN]:[a>0?n[a-1]:e[0],a<n.length?n[a]:e[e.length-1]]},i.domain=function(l){if(!arguments.length)return e.slice();e=[];for(let a of l)a!=null&&!isNaN(a=+a)&&e.push(a);return e.sort(Br),s()},i.range=function(l){return arguments.length?(t=Array.from(l),s()):t.slice()},i.unknown=function(l){return arguments.length?(r=l,i):r},i.quantiles=function(){return n.slice()},i.copy=function(){return bL().domain(e).range(t).unknown(r)},Bi.apply(i,arguments)}function wL(){var e=0,t=1,n=1,r=[.5],s=[0,1],i;function l(c){return c!=null&&c<=c?s[pl(r,c,0,n)]:i}function a(){var c=-1;for(r=new Array(n);++c<n;)r[c]=((c+1)*t-(c-n)*e)/(n+1);return l}return l.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,a()):[e,t]},l.range=function(c){return arguments.length?(n=(s=Array.from(c)).length-1,a()):s.slice()},l.invertExtent=function(c){var d=s.indexOf(c);return d<0?[NaN,NaN]:d<1?[e,r[0]]:d>=n?[r[n-1],t]:[r[d-1],r[d]]},l.unknown=function(c){return arguments.length&&(i=c),l},l.thresholds=function(){return r.slice()},l.copy=function(){return wL().domain([e,t]).range(s).unknown(i)},Bi.apply(Al(l),arguments)}function NL(){var e=[.5],t=[0,1],n,r=1;function s(i){return i!=null&&i<=i?t[pl(e,i,0,r)]:n}return s.domain=function(i){return arguments.length?(e=Array.from(i),r=Math.min(e.length,t.length-1),s):e.slice()},s.range=function(i){return arguments.length?(t=Array.from(i),r=Math.min(e.length,t.length-1),s):t.slice()},s.invertExtent=function(i){var l=t.indexOf(i);return[e[l-1],e[l]]},s.unknown=function(i){return arguments.length?(n=i,s):n},s.copy=function(){return NL().domain(e).range(t).unknown(n)},Bi.apply(s,arguments)}var $x=new Date,Ox=new Date;function Qr(e,t,n,r){function s(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return s.floor=function(i){return e(i=new Date(+i)),i},s.ceil=function(i){return e(i=new Date(i-1)),t(i,1),e(i),i},s.round=function(i){var l=s(i),a=s.ceil(i);return i-l<a-i?l:a},s.offset=function(i,l){return t(i=new Date(+i),l==null?1:Math.floor(l)),i},s.range=function(i,l,a){var c=[],d;if(i=s.ceil(i),a=a==null?1:Math.floor(a),!(i<l)||!(a>0))return c;do c.push(d=new Date(+i)),t(i,a),e(i);while(d<i&&i<l);return c},s.filter=function(i){return Qr(function(l){if(l>=l)for(;e(l),!i(l);)l.setTime(l-1)},function(l,a){if(l>=l)if(a<0)for(;++a<=0;)for(;t(l,-1),!i(l););else for(;--a>=0;)for(;t(l,1),!i(l););})},n&&(s.count=function(i,l){return $x.setTime(+i),Ox.setTime(+l),e($x),e(Ox),Math.floor(n($x,Ox))},s.every=function(i){return i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?s.filter(r?function(l){return r(l)%i===0}:function(l){return s.count(0,l)%i===0}):s}),s}var od=Qr(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});od.every=function(e){return e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Qr(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):od};var fS=od.range;const po=1e3,Ri=po*60,go=Ri*60,jc=go*24,u4=jc*7,hS=jc*30,Fx=jc*365;var xo=Qr(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+t*po)},function(e,t){return(t-e)/po},function(e){return e.getUTCSeconds()}),mS=xo.range,B0=Qr(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*po)},function(e,t){e.setTime(+e+t*Ri)},function(e,t){return(t-e)/Ri},function(e){return e.getMinutes()}),ete=B0.range,z0=Qr(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*po-e.getMinutes()*Ri)},function(e,t){e.setTime(+e+t*go)},function(e,t){return(t-e)/go},function(e){return e.getHours()}),tte=z0.range,Nd=Qr(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Ri)/jc,e=>e.getDate()-1),nte=Nd.range;function Mc(e){return Qr(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+n*7)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Ri)/u4})}var ld=Mc(0),Lh=Mc(1),jL=Mc(2),_L=Mc(3),_c=Mc(4),SL=Mc(5),AL=Mc(6),pS=ld.range,rte=Lh.range,ste=jL.range,ite=_L.range,ate=_c.range,ote=SL.range,lte=AL.range,U0=Qr(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()}),cte=U0.range,Da=Qr(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});Da.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:Qr(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)})};var ute=Da.range,H0=Qr(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*Ri)},function(e,t){return(t-e)/Ri},function(e){return e.getUTCMinutes()}),dte=H0.range,V0=Qr(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+t*go)},function(e,t){return(t-e)/go},function(e){return e.getUTCHours()}),fte=V0.range,jd=Qr(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/jc},function(e){return e.getUTCDate()-1}),hte=jd.range;function Rc(e){return Qr(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+n*7)},function(t,n){return(n-t)/u4})}var cd=Rc(0),Mh=Rc(1),kL=Rc(2),EL=Rc(3),Sc=Rc(4),CL=Rc(5),PL=Rc(6),gS=cd.range,mte=Mh.range,pte=kL.range,gte=EL.range,xte=Sc.range,yte=CL.range,vte=PL.range,W0=Qr(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12},function(e){return e.getUTCMonth()}),bte=W0.range,qa=Qr(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});qa.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:Qr(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})};var wte=qa.range;function IL(e,t,n,r,s,i){const l=[[xo,1,po],[xo,5,5*po],[xo,15,15*po],[xo,30,30*po],[i,1,Ri],[i,5,5*Ri],[i,15,15*Ri],[i,30,30*Ri],[s,1,go],[s,3,3*go],[s,6,6*go],[s,12,12*go],[r,1,jc],[r,2,2*jc],[n,1,u4],[t,1,hS],[t,3,3*hS],[e,1,Fx]];function a(d,u,f){const m=u<d;m&&([d,u]=[u,d]);const h=f&&typeof f.range=="function"?f:c(d,u,f),g=h?h.range(d,+u+1):[];return m?g.reverse():g}function c(d,u,f){const m=Math.abs(u-d)/f,h=x0(([,,p])=>p).right(l,m);if(h===l.length)return e.every(Ju(d/Fx,u/Fx,f));if(h===0)return od.every(Math.max(Ju(d,u,f),1));const[g,y]=l[m/l[h-1][2]<l[h][2]/m?h-1:h];return g.every(y)}return[a,c]}const[TL,LL]=IL(qa,W0,cd,jd,V0,H0),[ML,RL]=IL(Da,U0,ld,Nd,z0,B0);function Dx(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function qx(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function yf(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function $L(e){var t=e.dateTime,n=e.date,r=e.time,s=e.periods,i=e.days,l=e.shortDays,a=e.months,c=e.shortMonths,d=vf(s),u=bf(s),f=vf(i),m=bf(i),h=vf(l),g=bf(l),y=vf(a),p=bf(a),x=vf(c),b=bf(c),w={a:D,A:V,b:O,B:H,c:null,d:NS,e:NS,f:Hte,g:ene,G:nne,H:Bte,I:zte,j:Ute,L:OL,m:Vte,M:Wte,p:W,q:$,Q:SS,s:AS,S:Gte,u:Yte,U:Xte,V:Kte,w:Jte,W:Zte,x:null,X:null,y:Qte,Y:tne,Z:rne,"%":_S},N={a:z,A:q,b:G,B:re,c:null,d:jS,e:jS,f:one,g:xne,G:vne,H:sne,I:ine,j:ane,L:DL,m:lne,M:cne,p:oe,q:ie,Q:SS,s:AS,S:une,u:dne,U:fne,V:hne,w:mne,W:pne,x:null,X:null,y:gne,Y:yne,Z:bne,"%":_S},k={a:E,A:_,b:M,B:A,c:P,d:bS,e:bS,f:Ote,g:vS,G:yS,H:wS,I:wS,j:Lte,L:$te,m:Tte,M:Mte,p:S,q:Ite,Q:Dte,s:qte,S:Rte,u:Ate,U:kte,V:Ete,w:Ste,W:Cte,x:B,X:L,y:vS,Y:yS,Z:Pte,"%":Fte};w.x=I(n,w),w.X=I(r,w),w.c=I(t,w),N.x=I(n,N),N.X=I(r,N),N.c=I(t,N);function I(Y,te){return function(we){var me=[],Ee=-1,pe=0,ee=Y.length,ft,$e,De;for(we instanceof Date||(we=new Date(+we));++Ee<ee;)Y.charCodeAt(Ee)===37&&(me.push(Y.slice(pe,Ee)),($e=xS[ft=Y.charAt(++Ee)])!=null?ft=Y.charAt(++Ee):$e=ft==="e"?" ":"0",(De=te[ft])&&(ft=De(we,$e)),me.push(ft),pe=Ee+1);return me.push(Y.slice(pe,Ee)),me.join("")}}function R(Y,te){return function(we){var me=yf(1900,void 0,1),Ee=T(me,Y,we+="",0),pe,ee;if(Ee!=we.length)return null;if("Q"in me)return new Date(me.Q);if("s"in me)return new Date(me.s*1e3+("L"in me?me.L:0));if(te&&!("Z"in me)&&(me.Z=0),"p"in me&&(me.H=me.H%12+me.p*12),me.m===void 0&&(me.m="q"in me?me.q:0),"V"in me){if(me.V<1||me.V>53)return null;"w"in me||(me.w=1),"Z"in me?(pe=qx(yf(me.y,0,1)),ee=pe.getUTCDay(),pe=ee>4||ee===0?Mh.ceil(pe):Mh(pe),pe=jd.offset(pe,(me.V-1)*7),me.y=pe.getUTCFullYear(),me.m=pe.getUTCMonth(),me.d=pe.getUTCDate()+(me.w+6)%7):(pe=Dx(yf(me.y,0,1)),ee=pe.getDay(),pe=ee>4||ee===0?Lh.ceil(pe):Lh(pe),pe=Nd.offset(pe,(me.V-1)*7),me.y=pe.getFullYear(),me.m=pe.getMonth(),me.d=pe.getDate()+(me.w+6)%7)}else("W"in me||"U"in me)&&("w"in me||(me.w="u"in me?me.u%7:"W"in me?1:0),ee="Z"in me?qx(yf(me.y,0,1)).getUTCDay():Dx(yf(me.y,0,1)).getDay(),me.m=0,me.d="W"in me?(me.w+6)%7+me.W*7-(ee+5)%7:me.w+me.U*7-(ee+6)%7);return"Z"in me?(me.H+=me.Z/100|0,me.M+=me.Z%100,qx(me)):Dx(me)}}function T(Y,te,we,me){for(var Ee=0,pe=te.length,ee=we.length,ft,$e;Ee<pe;){if(me>=ee)return-1;if(ft=te.charCodeAt(Ee++),ft===37){if(ft=te.charAt(Ee++),$e=k[ft in xS?te.charAt(Ee++):ft],!$e||(me=$e(Y,we,me))<0)return-1}else if(ft!=we.charCodeAt(me++))return-1}return me}function S(Y,te,we){var me=d.exec(te.slice(we));return me?(Y.p=u.get(me[0].toLowerCase()),we+me[0].length):-1}function E(Y,te,we){var me=h.exec(te.slice(we));return me?(Y.w=g.get(me[0].toLowerCase()),we+me[0].length):-1}function _(Y,te,we){var me=f.exec(te.slice(we));return me?(Y.w=m.get(me[0].toLowerCase()),we+me[0].length):-1}function M(Y,te,we){var me=x.exec(te.slice(we));return me?(Y.m=b.get(me[0].toLowerCase()),we+me[0].length):-1}function A(Y,te,we){var me=y.exec(te.slice(we));return me?(Y.m=p.get(me[0].toLowerCase()),we+me[0].length):-1}function P(Y,te,we){return T(Y,t,te,we)}function B(Y,te,we){return T(Y,n,te,we)}function L(Y,te,we){return T(Y,r,te,we)}function D(Y){return l[Y.getDay()]}function V(Y){return i[Y.getDay()]}function O(Y){return c[Y.getMonth()]}function H(Y){return a[Y.getMonth()]}function W(Y){return s[+(Y.getHours()>=12)]}function $(Y){return 1+~~(Y.getMonth()/3)}function z(Y){return l[Y.getUTCDay()]}function q(Y){return i[Y.getUTCDay()]}function G(Y){return c[Y.getUTCMonth()]}function re(Y){return a[Y.getUTCMonth()]}function oe(Y){return s[+(Y.getUTCHours()>=12)]}function ie(Y){return 1+~~(Y.getUTCMonth()/3)}return{format:function(Y){var te=I(Y+="",w);return te.toString=function(){return Y},te},parse:function(Y){var te=R(Y+="",!1);return te.toString=function(){return Y},te},utcFormat:function(Y){var te=I(Y+="",N);return te.toString=function(){return Y},te},utcParse:function(Y){var te=R(Y+="",!0);return te.toString=function(){return Y},te}}}var xS={"-":"",_:" ",0:"0"},is=/^\s*\d+/,Nte=/^%/,jte=/[\\^$*+?|[\]().{}]/g;function In(e,t,n){var r=e<0?"-":"",s=(r?-e:e)+"",i=s.length;return r+(i<n?new Array(n-i+1).join(t)+s:s)}function _te(e){return e.replace(jte,"\\$&")}function vf(e){return new RegExp("^(?:"+e.map(_te).join("|")+")","i")}function bf(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function Ste(e,t,n){var r=is.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function Ate(e,t,n){var r=is.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function kte(e,t,n){var r=is.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function Ete(e,t,n){var r=is.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function Cte(e,t,n){var r=is.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function yS(e,t,n){var r=is.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function vS(e,t,n){var r=is.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Pte(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Ite(e,t,n){var r=is.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function Tte(e,t,n){var r=is.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function bS(e,t,n){var r=is.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function Lte(e,t,n){var r=is.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function wS(e,t,n){var r=is.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function Mte(e,t,n){var r=is.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function Rte(e,t,n){var r=is.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function $te(e,t,n){var r=is.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function Ote(e,t,n){var r=is.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Fte(e,t,n){var r=Nte.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function Dte(e,t,n){var r=is.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function qte(e,t,n){var r=is.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function NS(e,t){return In(e.getDate(),t,2)}function Bte(e,t){return In(e.getHours(),t,2)}function zte(e,t){return In(e.getHours()%12||12,t,2)}function Ute(e,t){return In(1+Nd.count(Da(e),e),t,3)}function OL(e,t){return In(e.getMilliseconds(),t,3)}function Hte(e,t){return OL(e,t)+"000"}function Vte(e,t){return In(e.getMonth()+1,t,2)}function Wte(e,t){return In(e.getMinutes(),t,2)}function Gte(e,t){return In(e.getSeconds(),t,2)}function Yte(e){var t=e.getDay();return t===0?7:t}function Xte(e,t){return In(ld.count(Da(e)-1,e),t,2)}function FL(e){var t=e.getDay();return t>=4||t===0?_c(e):_c.ceil(e)}function Kte(e,t){return e=FL(e),In(_c.count(Da(e),e)+(Da(e).getDay()===4),t,2)}function Jte(e){return e.getDay()}function Zte(e,t){return In(Lh.count(Da(e)-1,e),t,2)}function Qte(e,t){return In(e.getFullYear()%100,t,2)}function ene(e,t){return e=FL(e),In(e.getFullYear()%100,t,2)}function tne(e,t){return In(e.getFullYear()%1e4,t,4)}function nne(e,t){var n=e.getDay();return e=n>=4||n===0?_c(e):_c.ceil(e),In(e.getFullYear()%1e4,t,4)}function rne(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+In(t/60|0,"0",2)+In(t%60,"0",2)}function jS(e,t){return In(e.getUTCDate(),t,2)}function sne(e,t){return In(e.getUTCHours(),t,2)}function ine(e,t){return In(e.getUTCHours()%12||12,t,2)}function ane(e,t){return In(1+jd.count(qa(e),e),t,3)}function DL(e,t){return In(e.getUTCMilliseconds(),t,3)}function one(e,t){return DL(e,t)+"000"}function lne(e,t){return In(e.getUTCMonth()+1,t,2)}function cne(e,t){return In(e.getUTCMinutes(),t,2)}function une(e,t){return In(e.getUTCSeconds(),t,2)}function dne(e){var t=e.getUTCDay();return t===0?7:t}function fne(e,t){return In(cd.count(qa(e)-1,e),t,2)}function qL(e){var t=e.getUTCDay();return t>=4||t===0?Sc(e):Sc.ceil(e)}function hne(e,t){return e=qL(e),In(Sc.count(qa(e),e)+(qa(e).getUTCDay()===4),t,2)}function mne(e){return e.getUTCDay()}function pne(e,t){return In(Mh.count(qa(e)-1,e),t,2)}function gne(e,t){return In(e.getUTCFullYear()%100,t,2)}function xne(e,t){return e=qL(e),In(e.getUTCFullYear()%100,t,2)}function yne(e,t){return In(e.getUTCFullYear()%1e4,t,4)}function vne(e,t){var n=e.getUTCDay();return e=n>=4||n===0?Sc(e):Sc.ceil(e),In(e.getUTCFullYear()%1e4,t,4)}function bne(){return"+0000"}function _S(){return"%"}function SS(e){return+e}function AS(e){return Math.floor(+e/1e3)}var xu,d4,BL,G0,f4;zL({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function zL(e){return xu=$L(e),d4=xu.format,BL=xu.parse,G0=xu.utcFormat,f4=xu.utcParse,xu}var UL="%Y-%m-%dT%H:%M:%S.%LZ";function wne(e){return e.toISOString()}var Nne=Date.prototype.toISOString?wne:G0(UL);function jne(e){var t=new Date(e);return isNaN(t)?null:t}var _ne=+new Date("2000-01-01T00:00:00.000Z")?jne:f4(UL);function Sne(e){return new Date(e)}function Ane(e){return e instanceof Date?+e:+new Date(+e)}function h4(e,t,n,r,s,i,l,a,c,d){var u=i4(),f=u.invert,m=u.domain,h=d(".%L"),g=d(":%S"),y=d("%I:%M"),p=d("%I %p"),x=d("%a %d"),b=d("%b %d"),w=d("%B"),N=d("%Y");function k(I){return(c(I)<I?h:a(I)<I?g:l(I)<I?y:i(I)<I?p:r(I)<I?s(I)<I?x:b:n(I)<I?w:N)(I)}return u.invert=function(I){return new Date(f(I))},u.domain=function(I){return arguments.length?m(Array.from(I,Ane)):m().map(Sne)},u.ticks=function(I){var R=m();return e(R[0],R[R.length-1],I??10)},u.tickFormat=function(I,R){return R==null?k:d(R)},u.nice=function(I){var R=m();return(!I||typeof I.range!="function")&&(I=t(R[0],R[R.length-1],I??10)),I?m(gL(R,I)):u},u.copy=function(){return sm(u,h4(e,t,n,r,s,i,l,a,c,d))},u}function kne(){return Bi.apply(h4(ML,RL,Da,U0,ld,Nd,z0,B0,xo,d4).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function Ene(){return Bi.apply(h4(TL,LL,qa,W0,cd,jd,V0,H0,xo,G0).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function Y0(){var e=0,t=1,n,r,s,i,l=Ds,a=!1,c;function d(f){return f==null||isNaN(f=+f)?c:l(s===0?.5:(f=(i(f)-n)*s,a?Math.max(0,Math.min(1,f)):f))}d.domain=function(f){return arguments.length?([e,t]=f,n=i(e=+e),r=i(t=+t),s=n===r?0:1/(r-n),d):[e,t]},d.clamp=function(f){return arguments.length?(a=!!f,d):a},d.interpolator=function(f){return arguments.length?(l=f,d):l};function u(f){return function(m){var h,g;return arguments.length?([h,g]=m,l=f(h,g),d):[l(0),l(1)]}}return d.range=u(_l),d.rangeRound=u(k0),d.unknown=function(f){return arguments.length?(c=f,d):c},function(f){return i=f,n=f(e),r=f(t),s=n===r?0:1/(r-n),d}}function kl(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function HL(){var e=Al(Y0()(Ds));return e.copy=function(){return kl(e,HL())},ko.apply(e,arguments)}function VL(){var e=a4(Y0()).domain([1,10]);return e.copy=function(){return kl(e,VL()).base(e.base())},ko.apply(e,arguments)}function WL(){var e=o4(Y0());return e.copy=function(){return kl(e,WL()).constant(e.constant())},ko.apply(e,arguments)}function m4(){var e=l4(Y0());return e.copy=function(){return kl(e,m4()).exponent(e.exponent())},ko.apply(e,arguments)}function Cne(){return m4.apply(null,arguments).exponent(.5)}function GL(){var e=[],t=Ds;function n(r){if(r!=null&&!isNaN(r=+r))return t((pl(e,r,1)-1)/(e.length-1))}return n.domain=function(r){if(!arguments.length)return e.slice();e=[];for(let s of r)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(Br),n},n.interpolator=function(r){return arguments.length?(t=r,n):t},n.range=function(){return e.map((r,s)=>t(s/(e.length-1)))},n.quantiles=function(r){return Array.from({length:r+1},(s,i)=>vh(e,i/r))},n.copy=function(){return GL(t).domain(e)},ko.apply(n,arguments)}function X0(){var e=0,t=.5,n=1,r=1,s,i,l,a,c,d=Ds,u,f=!1,m;function h(y){return isNaN(y=+y)?m:(y=.5+((y=+u(y))-i)*(r*y<r*i?a:c),d(f?Math.max(0,Math.min(1,y)):y))}h.domain=function(y){return arguments.length?([e,t,n]=y,s=u(e=+e),i=u(t=+t),l=u(n=+n),a=s===i?0:.5/(i-s),c=i===l?0:.5/(l-i),r=i<s?-1:1,h):[e,t,n]},h.clamp=function(y){return arguments.length?(f=!!y,h):f},h.interpolator=function(y){return arguments.length?(d=y,h):d};function g(y){return function(p){var x,b,w;return arguments.length?([x,b,w]=p,d=BT(y,[x,b,w]),h):[d(0),d(.5),d(1)]}}return h.range=g(_l),h.rangeRound=g(k0),h.unknown=function(y){return arguments.length?(m=y,h):m},function(y){return u=y,s=y(e),i=y(t),l=y(n),a=s===i?0:.5/(i-s),c=i===l?0:.5/(l-i),r=i<s?-1:1,h}}function YL(){var e=Al(X0()(Ds));return e.copy=function(){return kl(e,YL())},ko.apply(e,arguments)}function XL(){var e=a4(X0()).domain([.1,1,10]);return e.copy=function(){return kl(e,XL()).base(e.base())},ko.apply(e,arguments)}function KL(){var e=o4(X0());return e.copy=function(){return kl(e,KL()).constant(e.constant())},ko.apply(e,arguments)}function p4(){var e=l4(X0());return e.copy=function(){return kl(e,p4()).exponent(e.exponent())},ko.apply(e,arguments)}function Pne(){return p4.apply(null,arguments).exponent(.5)}function yn(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}const Ine=yn("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),Tne=yn("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),Lne=yn("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),Mne=yn("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),Rne=yn("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),$ne=yn("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),One=yn("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),Fne=yn("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),Dne=yn("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),qne=yn("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab"),Zn=e=>ET(e[e.length-1]);var JL=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(yn);const Bne=Zn(JL);var ZL=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(yn);const zne=Zn(ZL);var QL=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(yn);const Une=Zn(QL);var eM=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(yn);const Hne=Zn(eM);var tM=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(yn);const Vne=Zn(tM);var nM=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(yn);const Wne=Zn(nM);var rM=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(yn);const Gne=Zn(rM);var sM=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(yn);const Yne=Zn(sM);var iM=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(yn);const Xne=Zn(iM);var aM=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(yn);const Kne=Zn(aM);var oM=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(yn);const Jne=Zn(oM);var lM=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(yn);const Zne=Zn(lM);var cM=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(yn);const Qne=Zn(cM);var uM=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(yn);const ere=Zn(uM);var dM=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(yn);const tre=Zn(dM);var fM=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(yn);const nre=Zn(fM);var hM=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(yn);const rre=Zn(hM);var mM=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(yn);const sre=Zn(mM);var pM=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(yn);const ire=Zn(pM);var gM=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(yn);const are=Zn(gM);var xM=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(yn);const ore=Zn(xM);var yM=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(yn);const lre=Zn(yM);var vM=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(yn);const cre=Zn(vM);var bM=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(yn);const ure=Zn(bM);var wM=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(yn);const dre=Zn(wM);var NM=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(yn);const fre=Zn(NM);var jM=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(yn);const hre=Zn(jM);function mre(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-e*(35.34-e*(2381.73-e*(6402.7-e*(7024.72-e*2710.57)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+e*(170.73+e*(52.82-e*(131.46-e*(176.58-e*67.37)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+e*(442.36-e*(2482.43-e*(6167.24-e*(6614.94-e*2475.67)))))))+")"}const pre=E0(aa(300,.5,0),aa(-240,.5,1));var gre=E0(aa(-100,.75,.35),aa(80,1.5,.8)),xre=E0(aa(260,.75,.35),aa(80,1.5,.8)),ip=aa();function yre(e){(e<0||e>1)&&(e-=Math.floor(e));var t=Math.abs(e-.5);return ip.h=360*e-100,ip.s=1.5-1.5*t,ip.l=.8-.9*t,ip+""}var ap=Qu(),vre=Math.PI/3,bre=Math.PI*2/3;function wre(e){var t;return e=(.5-e)*Math.PI,ap.r=255*(t=Math.sin(e))*t,ap.g=255*(t=Math.sin(e+vre))*t,ap.b=255*(t=Math.sin(e+bre))*t,ap+""}function Nre(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+e*(1172.33-e*(10793.56-e*(33300.12-e*(38394.49-e*14825.05)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+e*(557.33+e*(1225.33-e*(3574.96-e*(1073.77+e*707.56)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+e*(3211.1-e*(15327.97-e*(27814-e*(22569.18-e*6838.66)))))))+")"}function K0(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}const jre=K0(yn("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));var _re=K0(yn("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),Sre=K0(yn("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),Are=K0(yn("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function hn(e){return function(){return e}}var kS=Math.abs,bs=Math.atan2,Zl=Math.cos,kre=Math.max,Bx=Math.min,Na=Math.sin,Iu=Math.sqrt,Ss=1e-12,yl=Math.PI,Bg=yl/2,cl=2*yl;function Ere(e){return e>1?0:e<-1?yl:Math.acos(e)}function ES(e){return e>=1?Bg:e<=-1?-Bg:Math.asin(e)}function Cre(e){return e.innerRadius}function Pre(e){return e.outerRadius}function Ire(e){return e.startAngle}function Tre(e){return e.endAngle}function Lre(e){return e&&e.padAngle}function Mre(e,t,n,r,s,i,l,a){var c=n-e,d=r-t,u=l-s,f=a-i,m=f*c-u*d;if(!(m*m<Ss))return m=(u*(t-i)-f*(e-s))/m,[e+m*c,t+m*d]}function op(e,t,n,r,s,i,l){var a=e-n,c=t-r,d=(l?i:-i)/Iu(a*a+c*c),u=d*c,f=-d*a,m=e+u,h=t+f,g=n+u,y=r+f,p=(m+g)/2,x=(h+y)/2,b=g-m,w=y-h,N=b*b+w*w,k=s-i,I=m*y-g*h,R=(w<0?-1:1)*Iu(kre(0,k*k*N-I*I)),T=(I*w-b*R)/N,S=(-I*b-w*R)/N,E=(I*w+b*R)/N,_=(-I*b+w*R)/N,M=T-p,A=S-x,P=E-p,B=_-x;return M*M+A*A>P*P+B*B&&(T=E,S=_),{cx:T,cy:S,x01:-u,y01:-f,x11:T*(s/k-1),y11:S*(s/k-1)}}function Rre(){var e=Cre,t=Pre,n=hn(0),r=null,s=Ire,i=Tre,l=Lre,a=null;function c(){var d,u,f=+e.apply(this,arguments),m=+t.apply(this,arguments),h=s.apply(this,arguments)-Bg,g=i.apply(this,arguments)-Bg,y=kS(g-h),p=g>h;if(a||(a=d=Sl()),m<f&&(u=m,m=f,f=u),!(m>Ss))a.moveTo(0,0);else if(y>cl-Ss)a.moveTo(m*Zl(h),m*Na(h)),a.arc(0,0,m,h,g,!p),f>Ss&&(a.moveTo(f*Zl(g),f*Na(g)),a.arc(0,0,f,g,h,p));else{var x=h,b=g,w=h,N=g,k=y,I=y,R=l.apply(this,arguments)/2,T=R>Ss&&(r?+r.apply(this,arguments):Iu(f*f+m*m)),S=Bx(kS(m-f)/2,+n.apply(this,arguments)),E=S,_=S,M,A;if(T>Ss){var P=ES(T/f*Na(R)),B=ES(T/m*Na(R));(k-=P*2)>Ss?(P*=p?1:-1,w+=P,N-=P):(k=0,w=N=(h+g)/2),(I-=B*2)>Ss?(B*=p?1:-1,x+=B,b-=B):(I=0,x=b=(h+g)/2)}var L=m*Zl(x),D=m*Na(x),V=f*Zl(N),O=f*Na(N);if(S>Ss){var H=m*Zl(b),W=m*Na(b),$=f*Zl(w),z=f*Na(w),q;if(y<yl&&(q=Mre(L,D,$,z,H,W,V,O))){var G=L-q[0],re=D-q[1],oe=H-q[0],ie=W-q[1],Y=1/Na(Ere((G*oe+re*ie)/(Iu(G*G+re*re)*Iu(oe*oe+ie*ie)))/2),te=Iu(q[0]*q[0]+q[1]*q[1]);E=Bx(S,(f-te)/(Y-1)),_=Bx(S,(m-te)/(Y+1))}}I>Ss?_>Ss?(M=op($,z,L,D,m,_,p),A=op(H,W,V,O,m,_,p),a.moveTo(M.cx+M.x01,M.cy+M.y01),_<S?a.arc(M.cx,M.cy,_,bs(M.y01,M.x01),bs(A.y01,A.x01),!p):(a.arc(M.cx,M.cy,_,bs(M.y01,M.x01),bs(M.y11,M.x11),!p),a.arc(0,0,m,bs(M.cy+M.y11,M.cx+M.x11),bs(A.cy+A.y11,A.cx+A.x11),!p),a.arc(A.cx,A.cy,_,bs(A.y11,A.x11),bs(A.y01,A.x01),!p))):(a.moveTo(L,D),a.arc(0,0,m,x,b,!p)):a.moveTo(L,D),!(f>Ss)||!(k>Ss)?a.lineTo(V,O):E>Ss?(M=op(V,O,H,W,f,-E,p),A=op(L,D,$,z,f,-E,p),a.lineTo(M.cx+M.x01,M.cy+M.y01),E<S?a.arc(M.cx,M.cy,E,bs(M.y01,M.x01),bs(A.y01,A.x01),!p):(a.arc(M.cx,M.cy,E,bs(M.y01,M.x01),bs(M.y11,M.x11),!p),a.arc(0,0,f,bs(M.cy+M.y11,M.cx+M.x11),bs(A.cy+A.y11,A.cx+A.x11),p),a.arc(A.cx,A.cy,E,bs(A.y11,A.x11),bs(A.y01,A.x01),!p))):a.arc(0,0,f,N,w,p)}if(a.closePath(),d)return a=null,d+""||null}return c.centroid=function(){var d=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,u=(+s.apply(this,arguments)+ +i.apply(this,arguments))/2-yl/2;return[Zl(u)*d,Na(u)*d]},c.innerRadius=function(d){return arguments.length?(e=typeof d=="function"?d:hn(+d),c):e},c.outerRadius=function(d){return arguments.length?(t=typeof d=="function"?d:hn(+d),c):t},c.cornerRadius=function(d){return arguments.length?(n=typeof d=="function"?d:hn(+d),c):n},c.padRadius=function(d){return arguments.length?(r=d==null?null:typeof d=="function"?d:hn(+d),c):r},c.startAngle=function(d){return arguments.length?(s=typeof d=="function"?d:hn(+d),c):s},c.endAngle=function(d){return arguments.length?(i=typeof d=="function"?d:hn(+d),c):i},c.padAngle=function(d){return arguments.length?(l=typeof d=="function"?d:hn(+d),c):l},c.context=function(d){return arguments.length?(a=d??null,c):a},c}var $re=Array.prototype.slice;function J0(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function _M(e){this._context=e}_M.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function Z0(e){return new _M(e)}function g4(e){return e[0]}function x4(e){return e[1]}function y4(e,t){var n=hn(!0),r=null,s=Z0,i=null;e=typeof e=="function"?e:e===void 0?g4:hn(e),t=typeof t=="function"?t:t===void 0?x4:hn(t);function l(a){var c,d=(a=J0(a)).length,u,f=!1,m;for(r==null&&(i=s(m=Sl())),c=0;c<=d;++c)!(c<d&&n(u=a[c],c,a))===f&&((f=!f)?i.lineStart():i.lineEnd()),f&&i.point(+e(u,c,a),+t(u,c,a));if(m)return i=null,m+""||null}return l.x=function(a){return arguments.length?(e=typeof a=="function"?a:hn(+a),l):e},l.y=function(a){return arguments.length?(t=typeof a=="function"?a:hn(+a),l):t},l.defined=function(a){return arguments.length?(n=typeof a=="function"?a:hn(!!a),l):n},l.curve=function(a){return arguments.length?(s=a,r!=null&&(i=s(r)),l):s},l.context=function(a){return arguments.length?(a==null?r=i=null:i=s(r=a),l):r},l}function SM(e,t,n){var r=null,s=hn(!0),i=null,l=Z0,a=null;e=typeof e=="function"?e:e===void 0?g4:hn(+e),t=typeof t=="function"?t:hn(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?x4:hn(+n);function c(u){var f,m,h,g=(u=J0(u)).length,y,p=!1,x,b=new Array(g),w=new Array(g);for(i==null&&(a=l(x=Sl())),f=0;f<=g;++f){if(!(f<g&&s(y=u[f],f,u))===p)if(p=!p)m=f,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),h=f-1;h>=m;--h)a.point(b[h],w[h]);a.lineEnd(),a.areaEnd()}p&&(b[f]=+e(y,f,u),w[f]=+t(y,f,u),a.point(r?+r(y,f,u):b[f],n?+n(y,f,u):w[f]))}if(x)return a=null,x+""||null}function d(){return y4().defined(s).curve(l).context(i)}return c.x=function(u){return arguments.length?(e=typeof u=="function"?u:hn(+u),r=null,c):e},c.x0=function(u){return arguments.length?(e=typeof u=="function"?u:hn(+u),c):e},c.x1=function(u){return arguments.length?(r=u==null?null:typeof u=="function"?u:hn(+u),c):r},c.y=function(u){return arguments.length?(t=typeof u=="function"?u:hn(+u),n=null,c):t},c.y0=function(u){return arguments.length?(t=typeof u=="function"?u:hn(+u),c):t},c.y1=function(u){return arguments.length?(n=u==null?null:typeof u=="function"?u:hn(+u),c):n},c.lineX0=c.lineY0=function(){return d().x(e).y(t)},c.lineY1=function(){return d().x(e).y(n)},c.lineX1=function(){return d().x(r).y(t)},c.defined=function(u){return arguments.length?(s=typeof u=="function"?u:hn(!!u),c):s},c.curve=function(u){return arguments.length?(l=u,i!=null&&(a=l(i)),c):l},c.context=function(u){return arguments.length?(u==null?i=a=null:a=l(i=u),c):i},c}function Ore(e,t){return t<e?-1:t>e?1:t>=e?0:NaN}function Fre(e){return e}function Dre(){var e=Fre,t=Ore,n=null,r=hn(0),s=hn(cl),i=hn(0);function l(a){var c,d=(a=J0(a)).length,u,f,m=0,h=new Array(d),g=new Array(d),y=+r.apply(this,arguments),p=Math.min(cl,Math.max(-cl,s.apply(this,arguments)-y)),x,b=Math.min(Math.abs(p)/d,i.apply(this,arguments)),w=b*(p<0?-1:1),N;for(c=0;c<d;++c)(N=g[h[c]=c]=+e(a[c],c,a))>0&&(m+=N);for(t!=null?h.sort(function(k,I){return t(g[k],g[I])}):n!=null&&h.sort(function(k,I){return n(a[k],a[I])}),c=0,f=m?(p-d*w)/m:0;c<d;++c,y=x)u=h[c],N=g[u],x=y+(N>0?N*f:0)+w,g[u]={data:a[u],index:c,value:N,startAngle:y,endAngle:x,padAngle:b};return g}return l.value=function(a){return arguments.length?(e=typeof a=="function"?a:hn(+a),l):e},l.sortValues=function(a){return arguments.length?(t=a,n=null,l):t},l.sort=function(a){return arguments.length?(n=a,t=null,l):n},l.startAngle=function(a){return arguments.length?(r=typeof a=="function"?a:hn(+a),l):r},l.endAngle=function(a){return arguments.length?(s=typeof a=="function"?a:hn(+a),l):s},l.padAngle=function(a){return arguments.length?(i=typeof a=="function"?a:hn(+a),l):i},l}var AM=v4(Z0);function kM(e){this._curve=e}kM.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(e,t){this._curve.point(t*Math.sin(e),t*-Math.cos(e))}};function v4(e){function t(n){return new kM(e(n))}return t._curve=e,t}function Uf(e){var t=e.curve;return e.angle=e.x,delete e.x,e.radius=e.y,delete e.y,e.curve=function(n){return arguments.length?t(v4(n)):t()._curve},e}function CS(){return Uf(y4().curve(AM))}function PS(){var e=SM().curve(AM),t=e.curve,n=e.lineX0,r=e.lineX1,s=e.lineY0,i=e.lineY1;return e.angle=e.x,delete e.x,e.startAngle=e.x0,delete e.x0,e.endAngle=e.x1,delete e.x1,e.radius=e.y,delete e.y,e.innerRadius=e.y0,delete e.y0,e.outerRadius=e.y1,delete e.y1,e.lineStartAngle=function(){return Uf(n())},delete e.lineX0,e.lineEndAngle=function(){return Uf(r())},delete e.lineX1,e.lineInnerRadius=function(){return Uf(s())},delete e.lineY0,e.lineOuterRadius=function(){return Uf(i())},delete e.lineY1,e.curve=function(l){return arguments.length?t(v4(l)):t()._curve},e}function Hf(e,t){return[(t=+t)*Math.cos(e-=Math.PI/2),t*Math.sin(e)]}function qre(e){return e.source}function Bre(e){return e.target}function b4(e){var t=qre,n=Bre,r=g4,s=x4,i=null;function l(){var a,c=$re.call(arguments),d=t.apply(this,c),u=n.apply(this,c);if(i||(i=a=Sl()),e(i,+r.apply(this,(c[0]=d,c)),+s.apply(this,c),+r.apply(this,(c[0]=u,c)),+s.apply(this,c)),a)return i=null,a+""||null}return l.source=function(a){return arguments.length?(t=a,l):t},l.target=function(a){return arguments.length?(n=a,l):n},l.x=function(a){return arguments.length?(r=typeof a=="function"?a:hn(+a),l):r},l.y=function(a){return arguments.length?(s=typeof a=="function"?a:hn(+a),l):s},l.context=function(a){return arguments.length?(i=a??null,l):i},l}function zre(e,t,n,r,s){e.moveTo(t,n),e.bezierCurveTo(t=(t+r)/2,n,t,s,r,s)}function Ure(e,t,n,r,s){e.moveTo(t,n),e.bezierCurveTo(t,n=(n+s)/2,r,n,r,s)}function Hre(e,t,n,r,s){var i=Hf(t,n),l=Hf(t,n=(n+s)/2),a=Hf(r,n),c=Hf(r,s);e.moveTo(i[0],i[1]),e.bezierCurveTo(l[0],l[1],a[0],a[1],c[0],c[1])}function Vre(){return b4(zre)}function Wre(){return b4(Ure)}function Gre(){var e=b4(Hre);return e.angle=e.x,delete e.x,e.radius=e.y,delete e.y,e}const w4={draw:function(e,t){var n=Math.sqrt(t/yl);e.moveTo(n,0),e.arc(0,0,n,0,cl)}},EM={draw:function(e,t){var n=Math.sqrt(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}};var CM=Math.sqrt(1/3),Yre=CM*2;const PM={draw:function(e,t){var n=Math.sqrt(t/Yre),r=n*CM;e.moveTo(0,-n),e.lineTo(r,0),e.lineTo(0,n),e.lineTo(-r,0),e.closePath()}};var Xre=.8908130915292852,IM=Math.sin(yl/10)/Math.sin(7*yl/10),Kre=Math.sin(cl/10)*IM,Jre=-Math.cos(cl/10)*IM;const TM={draw:function(e,t){var n=Math.sqrt(t*Xre),r=Kre*n,s=Jre*n;e.moveTo(0,-n),e.lineTo(r,s);for(var i=1;i<5;++i){var l=cl*i/5,a=Math.cos(l),c=Math.sin(l);e.lineTo(c*n,-a*n),e.lineTo(a*r-c*s,c*r+a*s)}e.closePath()}},LM={draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}};var zx=Math.sqrt(3);const MM={draw:function(e,t){var n=-Math.sqrt(t/(zx*3));e.moveTo(0,n*2),e.lineTo(-zx*n,-n),e.lineTo(zx*n,-n),e.closePath()}};var Pi=-.5,Ii=Math.sqrt(3)/2,SN=1/Math.sqrt(12),Zre=(SN/2+1)*3;const RM={draw:function(e,t){var n=Math.sqrt(t/Zre),r=n/2,s=n*SN,i=r,l=n*SN+n,a=-i,c=l;e.moveTo(r,s),e.lineTo(i,l),e.lineTo(a,c),e.lineTo(Pi*r-Ii*s,Ii*r+Pi*s),e.lineTo(Pi*i-Ii*l,Ii*i+Pi*l),e.lineTo(Pi*a-Ii*c,Ii*a+Pi*c),e.lineTo(Pi*r+Ii*s,Pi*s-Ii*r),e.lineTo(Pi*i+Ii*l,Pi*l-Ii*i),e.lineTo(Pi*a+Ii*c,Pi*c-Ii*a),e.closePath()}};var Qre=[w4,EM,PM,LM,TM,MM,RM];function ese(e,t){var n=null;e=typeof e=="function"?e:hn(e||w4),t=typeof t=="function"?t:hn(t===void 0?64:+t);function r(){var s;if(n||(n=s=Sl()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),s)return n=null,s+""||null}return r.type=function(s){return arguments.length?(e=typeof s=="function"?s:hn(s),r):e},r.size=function(s){return arguments.length?(t=typeof s=="function"?s:hn(+s),r):t},r.context=function(s){return arguments.length?(n=s??null,r):n},r}function vl(){}function zg(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function Q0(e){this._context=e}Q0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:zg(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:zg(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function tse(e){return new Q0(e)}function $M(e){this._context=e}$M.prototype={areaStart:vl,areaEnd:vl,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:zg(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function nse(e){return new $M(e)}function OM(e){this._context=e}OM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:zg(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function rse(e){return new OM(e)}class FM{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function sse(e){return new FM(e,!0)}function ise(e){return new FM(e,!1)}function DM(e,t){this._basis=new Q0(e),this._beta=t}DM.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],s=t[0],i=e[n]-r,l=t[n]-s,a=-1,c;++a<=n;)c=a/n,this._basis.point(this._beta*e[a]+(1-this._beta)*(r+c*i),this._beta*t[a]+(1-this._beta)*(s+c*l));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const ase=function e(t){function n(r){return t===1?new Q0(r):new DM(r,t)}return n.beta=function(r){return e(+r)},n}(.85);function Ug(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function N4(e,t){this._context=e,this._k=(1-t)/6}N4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Ug(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:Ug(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const ose=function e(t){function n(r){return new N4(r,t)}return n.tension=function(r){return e(+r)},n}(0);function j4(e,t){this._context=e,this._k=(1-t)/6}j4.prototype={areaStart:vl,areaEnd:vl,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Ug(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const lse=function e(t){function n(r){return new j4(r,t)}return n.tension=function(r){return e(+r)},n}(0);function _4(e,t){this._context=e,this._k=(1-t)/6}_4.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Ug(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const cse=function e(t){function n(r){return new _4(r,t)}return n.tension=function(r){return e(+r)},n}(0);function S4(e,t,n){var r=e._x1,s=e._y1,i=e._x2,l=e._y2;if(e._l01_a>Ss){var a=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,c=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*a-e._x0*e._l12_2a+e._x2*e._l01_2a)/c,s=(s*a-e._y0*e._l12_2a+e._y2*e._l01_2a)/c}if(e._l23_a>Ss){var d=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,u=3*e._l23_a*(e._l23_a+e._l12_a);i=(i*d+e._x1*e._l23_2a-t*e._l12_2a)/u,l=(l*d+e._y1*e._l23_2a-n*e._l12_2a)/u}e._context.bezierCurveTo(r,s,i,l,e._x2,e._y2)}function qM(e,t){this._context=e,this._alpha=t}qM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:S4(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const use=function e(t){function n(r){return t?new qM(r,t):new N4(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function BM(e,t){this._context=e,this._alpha=t}BM.prototype={areaStart:vl,areaEnd:vl,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:S4(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const dse=function e(t){function n(r){return t?new BM(r,t):new j4(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function zM(e,t){this._context=e,this._alpha=t}zM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:S4(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const fse=function e(t){function n(r){return t?new zM(r,t):new _4(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function UM(e){this._context=e}UM.prototype={areaStart:vl,areaEnd:vl,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function hse(e){return new UM(e)}function IS(e){return e<0?-1:1}function TS(e,t,n){var r=e._x1-e._x0,s=t-e._x1,i=(e._y1-e._y0)/(r||s<0&&-0),l=(n-e._y1)/(s||r<0&&-0),a=(i*s+l*r)/(r+s);return(IS(i)+IS(l))*Math.min(Math.abs(i),Math.abs(l),.5*Math.abs(a))||0}function LS(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function Ux(e,t,n){var r=e._x0,s=e._y0,i=e._x1,l=e._y1,a=(i-r)/3;e._context.bezierCurveTo(r+a,s+a*t,i-a,l-a*n,i,l)}function Hg(e){this._context=e}Hg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Ux(this,this._t0,LS(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,Ux(this,LS(this,n=TS(this,e,t)),n);break;default:Ux(this,this._t0,n=TS(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function HM(e){this._context=new VM(e)}(HM.prototype=Object.create(Hg.prototype)).point=function(e,t){Hg.prototype.point.call(this,t,e)};function VM(e){this._context=e}VM.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,s,i){this._context.bezierCurveTo(t,e,r,n,i,s)}};function mse(e){return new Hg(e)}function pse(e){return new HM(e)}function WM(e){this._context=e}WM.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=MS(e),s=MS(t),i=0,l=1;l<n;++i,++l)this._context.bezierCurveTo(r[0][i],s[0][i],r[1][i],s[1][i],e[l],t[l]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function MS(e){var t,n=e.length-1,r,s=new Array(n),i=new Array(n),l=new Array(n);for(s[0]=0,i[0]=2,l[0]=e[0]+2*e[1],t=1;t<n-1;++t)s[t]=1,i[t]=4,l[t]=4*e[t]+2*e[t+1];for(s[n-1]=2,i[n-1]=7,l[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=s[t]/i[t-1],i[t]-=r,l[t]-=r*l[t-1];for(s[n-1]=l[n-1]/i[n-1],t=n-2;t>=0;--t)s[t]=(l[t]-s[t+1])/i[t];for(i[n-1]=(e[n]+s[n-1])/2,t=0;t<n-1;++t)i[t]=2*e[t+1]-s[t+1];return[s,i]}function gse(e){return new WM(e)}function e1(e,t){this._context=e,this._t=t}e1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function xse(e){return new e1(e,.5)}function yse(e){return new e1(e,0)}function vse(e){return new e1(e,1)}function ud(e,t){if((l=e.length)>1)for(var n=1,r,s,i=e[t[0]],l,a=i.length;n<l;++n)for(s=i,i=e[t[n]],r=0;r<a;++r)i[r][1]+=i[r][0]=isNaN(s[r][1])?s[r][0]:s[r][1]}function dd(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function bse(e,t){return e[t]}function wse(e){const t=[];return t.key=e,t}function Nse(){var e=hn([]),t=dd,n=ud,r=bse;function s(i){var l=Array.from(e.apply(this,arguments),wse),a,c=l.length,d=-1,u;for(const f of i)for(a=0,++d;a<c;++a)(l[a][d]=[0,+r(f,l[a].key,d,i)]).data=f;for(a=0,u=J0(t(l));a<c;++a)l[u[a]].index=a;return n(l,u),l}return s.keys=function(i){return arguments.length?(e=typeof i=="function"?i:hn(Array.from(i)),s):e},s.value=function(i){return arguments.length?(r=typeof i=="function"?i:hn(+i),s):r},s.order=function(i){return arguments.length?(t=i==null?dd:typeof i=="function"?i:hn(Array.from(i)),s):t},s.offset=function(i){return arguments.length?(n=i??ud,s):n},s}function jse(e,t){if((r=e.length)>0){for(var n,r,s=0,i=e[0].length,l;s<i;++s){for(l=n=0;n<r;++n)l+=e[n][s][1]||0;if(l)for(n=0;n<r;++n)e[n][s][1]/=l}ud(e,t)}}function _se(e,t){if((c=e.length)>0)for(var n,r=0,s,i,l,a,c,d=e[t[0]].length;r<d;++r)for(l=a=0,n=0;n<c;++n)(i=(s=e[t[n]][r])[1]-s[0])>0?(s[0]=l,s[1]=l+=i):i<0?(s[1]=a,s[0]=a+=i):(s[0]=0,s[1]=i)}function Sse(e,t){if((s=e.length)>0){for(var n=0,r=e[t[0]],s,i=r.length;n<i;++n){for(var l=0,a=0;l<s;++l)a+=e[l][n][1]||0;r[n][1]+=r[n][0]=-a/2}ud(e,t)}}function Ase(e,t){if(!(!((l=e.length)>0)||!((i=(s=e[t[0]]).length)>0))){for(var n=0,r=1,s,i,l;r<i;++r){for(var a=0,c=0,d=0;a<l;++a){for(var u=e[t[a]],f=u[r][1]||0,m=u[r-1][1]||0,h=(f-m)/2,g=0;g<a;++g){var y=e[t[g]],p=y[r][1]||0,x=y[r-1][1]||0;h+=p-x}c+=f,d+=h*f}s[r-1][1]+=s[r-1][0]=n,c&&(n-=d/c)}s[r-1][1]+=s[r-1][0]=n,ud(e,t)}}function GM(e){var t=e.map(kse);return dd(e).sort(function(n,r){return t[n]-t[r]})}function kse(e){for(var t=-1,n=0,r=e.length,s,i=-1/0;++t<r;)(s=+e[t][1])>i&&(i=s,n=t);return n}function YM(e){var t=e.map(XM);return dd(e).sort(function(n,r){return t[n]-t[r]})}function XM(e){for(var t=0,n=-1,r=e.length,s;++n<r;)(s=+e[n][1])&&(t+=s);return t}function Ese(e){return YM(e).reverse()}function Cse(e){var t=e.length,n,r,s=e.map(XM),i=GM(e),l=0,a=0,c=[],d=[];for(n=0;n<t;++n)r=i[n],l<a?(l+=s[r],c.push(r)):(a+=s[r],d.push(r));return d.reverse().concat(c)}function Pse(e){return dd(e).reverse()}const lp=e=>()=>e;function Ise(e,{sourceEvent:t,target:n,transform:r,dispatch:s}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:s}})}function yo(e,t,n){this.k=e,this.x=t,this.y=n}yo.prototype={constructor:yo,scale:function(e){return e===1?this:new yo(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new yo(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var t1=new yo(1,0,0);KM.prototype=yo.prototype;function KM(e){for(;!e.__zoom;)if(!(e=e.parentNode))return t1;return e.__zoom}function Hx(e){e.stopImmediatePropagation()}function wf(e){e.preventDefault(),e.stopImmediatePropagation()}function Tse(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Lse(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function RS(){return this.__zoom||t1}function Mse(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Rse(){return navigator.maxTouchPoints||"ontouchstart"in this}function $se(e,t,n){var r=e.invertX(t[0][0])-n[0][0],s=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],l=e.invertY(t[1][1])-n[1][1];return e.translate(s>r?(r+s)/2:Math.min(0,r)||Math.max(0,s),l>i?(i+l)/2:Math.min(0,i)||Math.max(0,l))}function Ose(){var e=Tse,t=Lse,n=$se,r=Mse,s=Rse,i=[0,1/0],l=[[-1/0,-1/0],[1/0,1/0]],a=250,c=OT,d=Pc("start","zoom","end"),u,f,m,h=500,g=150,y=0,p=10;function x(P){P.property("__zoom",RS).on("wheel.zoom",T).on("mousedown.zoom",S).on("dblclick.zoom",E).filter(s).on("touchstart.zoom",_).on("touchmove.zoom",M).on("touchend.zoom touchcancel.zoom",A).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}x.transform=function(P,B,L,D){var V=P.selection?P.selection():P;V.property("__zoom",RS),P!==V?k(P,B,L,D):V.interrupt().each(function(){I(this,arguments).event(D).start().zoom(null,typeof B=="function"?B.apply(this,arguments):B).end()})},x.scaleBy=function(P,B,L,D){x.scaleTo(P,function(){var V=this.__zoom.k,O=typeof B=="function"?B.apply(this,arguments):B;return V*O},L,D)},x.scaleTo=function(P,B,L,D){x.transform(P,function(){var V=t.apply(this,arguments),O=this.__zoom,H=L==null?N(V):typeof L=="function"?L.apply(this,arguments):L,W=O.invert(H),$=typeof B=="function"?B.apply(this,arguments):B;return n(w(b(O,$),H,W),V,l)},L,D)},x.translateBy=function(P,B,L,D){x.transform(P,function(){return n(this.__zoom.translate(typeof B=="function"?B.apply(this,arguments):B,typeof L=="function"?L.apply(this,arguments):L),t.apply(this,arguments),l)},null,D)},x.translateTo=function(P,B,L,D,V){x.transform(P,function(){var O=t.apply(this,arguments),H=this.__zoom,W=D==null?N(O):typeof D=="function"?D.apply(this,arguments):D;return n(t1.translate(W[0],W[1]).scale(H.k).translate(typeof B=="function"?-B.apply(this,arguments):-B,typeof L=="function"?-L.apply(this,arguments):-L),O,l)},D,V)};function b(P,B){return B=Math.max(i[0],Math.min(i[1],B)),B===P.k?P:new yo(B,P.x,P.y)}function w(P,B,L){var D=B[0]-L[0]*P.k,V=B[1]-L[1]*P.k;return D===P.x&&V===P.y?P:new yo(P.k,D,V)}function N(P){return[(+P[0][0]+ +P[1][0])/2,(+P[0][1]+ +P[1][1])/2]}function k(P,B,L,D){P.on("start.zoom",function(){I(this,arguments).event(D).start()}).on("interrupt.zoom end.zoom",function(){I(this,arguments).event(D).end()}).tween("zoom",function(){var V=this,O=arguments,H=I(V,O).event(D),W=t.apply(V,O),$=L==null?N(W):typeof L=="function"?L.apply(V,O):L,z=Math.max(W[1][0]-W[0][0],W[1][1]-W[0][1]),q=V.__zoom,G=typeof B=="function"?B.apply(V,O):B,re=c(q.invert($).concat(z/q.k),G.invert($).concat(z/G.k));return function(oe){if(oe===1)oe=G;else{var ie=re(oe),Y=z/ie[2];oe=new yo(Y,$[0]-ie[0]*Y,$[1]-ie[1]*Y)}H.zoom(null,oe)}})}function I(P,B,L){return!L&&P.__zooming||new R(P,B)}function R(P,B){this.that=P,this.args=B,this.active=0,this.sourceEvent=null,this.extent=t.apply(P,B),this.taps=0}R.prototype={event:function(P){return P&&(this.sourceEvent=P),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(P,B){return this.mouse&&P!=="mouse"&&(this.mouse[1]=B.invert(this.mouse[0])),this.touch0&&P!=="touch"&&(this.touch0[1]=B.invert(this.touch0[0])),this.touch1&&P!=="touch"&&(this.touch1[1]=B.invert(this.touch1[0])),this.that.__zoom=B,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(P){var B=Es(this.that).datum();d.call(P,this.that,new Ise(P,{sourceEvent:this.sourceEvent,target:x,transform:this.that.__zoom,dispatch:d}),B)}};function T(P,...B){if(!e.apply(this,arguments))return;var L=I(this,B).event(P),D=this.__zoom,V=Math.max(i[0],Math.min(i[1],D.k*Math.pow(2,r.apply(this,arguments)))),O=gi(P);if(L.wheel)(L.mouse[0][0]!==O[0]||L.mouse[0][1]!==O[1])&&(L.mouse[1]=D.invert(L.mouse[0]=O)),clearTimeout(L.wheel);else{if(D.k===V)return;L.mouse=[O,D.invert(O)],mc(this),L.start()}wf(P),L.wheel=setTimeout(H,g),L.zoom("mouse",n(w(b(D,V),L.mouse[0],L.mouse[1]),L.extent,l));function H(){L.wheel=null,L.end()}}function S(P,...B){if(m||!e.apply(this,arguments))return;var L=I(this,B,!0).event(P),D=Es(P.view).on("mousemove.zoom",$,!0).on("mouseup.zoom",z,!0),V=gi(P,O),O=P.currentTarget,H=P.clientX,W=P.clientY;N0(P.view),Hx(P),L.mouse=[V,this.__zoom.invert(V)],mc(this),L.start();function $(q){if(wf(q),!L.moved){var G=q.clientX-H,re=q.clientY-W;L.moved=G*G+re*re>y}L.event(q).zoom("mouse",n(w(L.that.__zoom,L.mouse[0]=gi(q,O),L.mouse[1]),L.extent,l))}function z(q){D.on("mousemove.zoom mouseup.zoom",null),j0(q.view,L.moved),wf(q),L.event(q).end()}}function E(P,...B){if(e.apply(this,arguments)){var L=this.__zoom,D=gi(P.changedTouches?P.changedTouches[0]:P,this),V=L.invert(D),O=L.k*(P.shiftKey?.5:2),H=n(w(b(L,O),D,V),t.apply(this,B),l);wf(P),a>0?Es(this).transition().duration(a).call(k,H,D,P):Es(this).call(x.transform,H,D,P)}}function _(P,...B){if(e.apply(this,arguments)){var L=P.touches,D=L.length,V=I(this,B,P.changedTouches.length===D).event(P),O,H,W,$;for(Hx(P),H=0;H<D;++H)W=L[H],$=gi(W,this),$=[$,this.__zoom.invert($),W.identifier],V.touch0?!V.touch1&&V.touch0[2]!==$[2]&&(V.touch1=$,V.taps=0):(V.touch0=$,O=!0,V.taps=1+!!u);u&&(u=clearTimeout(u)),O&&(V.taps<2&&(f=$[0],u=setTimeout(function(){u=null},h)),mc(this),V.start())}}function M(P,...B){if(this.__zooming){var L=I(this,B).event(P),D=P.changedTouches,V=D.length,O,H,W,$;for(wf(P),O=0;O<V;++O)H=D[O],W=gi(H,this),L.touch0&&L.touch0[2]===H.identifier?L.touch0[0]=W:L.touch1&&L.touch1[2]===H.identifier&&(L.touch1[0]=W);if(H=L.that.__zoom,L.touch1){var z=L.touch0[0],q=L.touch0[1],G=L.touch1[0],re=L.touch1[1],oe=(oe=G[0]-z[0])*oe+(oe=G[1]-z[1])*oe,ie=(ie=re[0]-q[0])*ie+(ie=re[1]-q[1])*ie;H=b(H,Math.sqrt(oe/ie)),W=[(z[0]+G[0])/2,(z[1]+G[1])/2],$=[(q[0]+re[0])/2,(q[1]+re[1])/2]}else if(L.touch0)W=L.touch0[0],$=L.touch0[1];else return;L.zoom("touch",n(w(H,W,$),L.extent,l))}}function A(P,...B){if(this.__zooming){var L=I(this,B).event(P),D=P.changedTouches,V=D.length,O,H;for(Hx(P),m&&clearTimeout(m),m=setTimeout(function(){m=null},h),O=0;O<V;++O)H=D[O],L.touch0&&L.touch0[2]===H.identifier?delete L.touch0:L.touch1&&L.touch1[2]===H.identifier&&delete L.touch1;if(L.touch1&&!L.touch0&&(L.touch0=L.touch1,delete L.touch1),L.touch0)L.touch0[1]=this.__zoom.invert(L.touch0[0]);else if(L.end(),L.taps===2&&(H=gi(H,this),Math.hypot(f[0]-H[0],f[1]-H[1])<p)){var W=Es(this).on("dblclick.zoom");W&&W.apply(this,arguments)}}}return x.wheelDelta=function(P){return arguments.length?(r=typeof P=="function"?P:lp(+P),x):r},x.filter=function(P){return arguments.length?(e=typeof P=="function"?P:lp(!!P),x):e},x.touchable=function(P){return arguments.length?(s=typeof P=="function"?P:lp(!!P),x):s},x.extent=function(P){return arguments.length?(t=typeof P=="function"?P:lp([[+P[0][0],+P[0][1]],[+P[1][0],+P[1][1]]]),x):t},x.scaleExtent=function(P){return arguments.length?(i[0]=+P[0],i[1]=+P[1],x):[i[0],i[1]]},x.translateExtent=function(P){return arguments.length?(l[0][0]=+P[0][0],l[1][0]=+P[1][0],l[0][1]=+P[0][1],l[1][1]=+P[1][1],x):[[l[0][0],l[0][1]],[l[1][0],l[1][1]]]},x.constrain=function(P){return arguments.length?(n=P,x):n},x.duration=function(P){return arguments.length?(a=+P,x):a},x.interpolate=function(P){return arguments.length?(c=P,x):c},x.on=function(){var P=d.on.apply(d,arguments);return P===d?x:P},x.clickDistance=function(P){return arguments.length?(y=(P=+P)*P,x):Math.sqrt(y)},x.tapDistance=function(P){return arguments.length?(p=+P,x):p},x}const Fse=Object.freeze(Object.defineProperty({__proto__:null,Adder:Zr,Delaunay:L3,FormatSpecifier:R0,InternMap:qI,InternSet:ZH,Voronoi:n9,active:GX,arc:Rre,area:SM,areaRadial:PS,ascending:Br,autoType:lJ,axisBottom:BV,axisLeft:zV,axisRight:qV,axisTop:DV,bin:T_,bisect:pl,bisectCenter:zH,bisectLeft:BH,bisectRight:pl,bisector:x0,blob:dJ,brush:aK,brushSelection:rK,brushX:sK,brushY:iK,buffer:hJ,chord:lK,chordDirected:uK,chordTranspose:cK,cluster:CQ,color:gl,contourDensity:LK,contours:t9,count:y0,create:NG,creator:b0,cross:GH,csv:gJ,csvFormat:JK,csvFormatBody:ZK,csvFormatRow:eJ,csvFormatRows:QK,csvFormatValue:tJ,csvParse:s9,csvParseRows:KK,cubehelix:aa,cumsum:YH,curveBasis:tse,curveBasisClosed:nse,curveBasisOpen:rse,curveBumpX:sse,curveBumpY:ise,curveBundle:ase,curveCardinal:ose,curveCardinalClosed:lse,curveCardinalOpen:cse,curveCatmullRom:use,curveCatmullRomClosed:dse,curveCatmullRomOpen:fse,curveLinear:Z0,curveLinearClosed:hse,curveMonotoneX:mse,curveMonotoneY:pse,curveNatural:gse,curveStep:xse,curveStepAfter:vse,curveStepBefore:yse,descending:XH,deviation:DI,difference:kV,disjoint:EV,dispatch:Pc,drag:PG,dragDisable:N0,dragEnable:j0,dsv:pJ,dsvFormat:T0,easeBack:e6,easeBackIn:DX,easeBackInOut:e6,easeBackOut:qX,easeBounce:Sh,easeBounceIn:OX,easeBounceInOut:FX,easeBounceOut:Sh,easeCircle:Q_,easeCircleIn:kX,easeCircleInOut:Q_,easeCircleOut:EX,easeCubic:W5,easeCubicIn:vX,easeCubicInOut:W5,easeCubicOut:bX,easeElastic:t6,easeElasticIn:BX,easeElasticInOut:zX,easeElasticOut:t6,easeExp:Z_,easeExpIn:SX,easeExpInOut:Z_,easeExpOut:AX,easeLinear:gX,easePoly:K_,easePolyIn:wX,easePolyInOut:K_,easePolyOut:NX,easeQuad:X_,easeQuadIn:xX,easeQuadInOut:X_,easeQuadOut:yX,easeSin:J_,easeSinIn:jX,easeSinInOut:J_,easeSinOut:_X,every:wV,extent:nh,fcumsum:JH,filter:jV,forceCenter:_J,forceCollide:UJ,forceLink:VJ,forceManyBody:eZ,forceRadial:tZ,forceSimulation:QJ,forceX:nZ,forceY:rZ,get format(){return $0},formatDefaultLocale:u9,formatLocale:c9,get formatPrefix(){return $3},formatSpecifier:kh,fsum:KH,geoAlbers:Y9,geoAlbersUsa:oQ,geoArea:hZ,geoAzimuthalEqualArea:lQ,geoAzimuthalEqualAreaRaw:W3,geoAzimuthalEquidistant:cQ,geoAzimuthalEquidistantRaw:G3,geoBounds:xZ,geoCentroid:jZ,geoCircle:_Z,geoClipAntimeridian:uN,geoClipCircle:T9,geoClipExtent:IZ,geoClipRectangle:O0,geoConicConformal:dQ,geoConicConformalRaw:J9,geoConicEqualArea:Og,geoConicEqualAreaRaw:G9,geoConicEquidistant:hQ,geoConicEquidistantRaw:Z9,geoContains:FZ,geoDistance:Pg,geoEqualEarth:pQ,geoEqualEarthRaw:Y3,geoEquirectangular:fQ,geoEquirectangularRaw:Th,geoGnomonic:gQ,geoGnomonicRaw:X3,geoGraticule:R9,geoGraticule10:DZ,geoIdentity:xQ,geoInterpolate:qZ,geoLength:L9,geoMercator:uQ,geoMercatorRaw:nm,geoNaturalEarth1:yQ,geoNaturalEarth1Raw:K3,geoOrthographic:vQ,geoOrthographicRaw:J3,geoPath:JZ,geoProjection:za,geoProjectionMutator:H3,geoRotation:A9,geoStereographic:bQ,geoStereographicRaw:Z3,geoStream:Zi,geoTransform:ZZ,geoTransverseMercator:wQ,geoTransverseMercatorRaw:Q3,gray:qG,greatest:mV,greatestIndex:pV,group:HI,groupSort:rV,groups:QH,hcl:dg,hierarchy:e4,histogram:T_,hsl:lg,html:NJ,image:yJ,index:tV,indexes:nV,interpolate:_l,interpolateArray:WG,interpolateBasis:_T,interpolateBasisClosed:ST,interpolateBlues:lre,interpolateBrBG:Bne,interpolateBuGn:Kne,interpolateBuPu:Jne,interpolateCividis:mre,interpolateCool:xre,interpolateCubehelix:oY,interpolateCubehelixDefault:pre,interpolateCubehelixLong:E0,interpolateDate:IT,interpolateDiscrete:XG,interpolateGnBu:Zne,interpolateGreens:cre,interpolateGreys:ure,interpolateHcl:iY,interpolateHclLong:aY,interpolateHsl:nY,interpolateHslLong:rY,interpolateHue:KG,interpolateInferno:Sre,interpolateLab:sY,interpolateMagma:_re,interpolateNumber:Ti,interpolateNumberArray:j3,interpolateObject:TT,interpolateOrRd:Qne,interpolateOranges:hre,interpolatePRGn:zne,interpolatePiYG:Une,interpolatePlasma:Are,interpolatePuBu:tre,interpolatePuBuGn:ere,interpolatePuOr:Hne,interpolatePuRd:nre,interpolatePurples:dre,interpolateRainbow:yre,interpolateRdBu:Vne,interpolateRdGy:Wne,interpolateRdPu:rre,interpolateRdYlBu:Gne,interpolateRdYlGn:Yne,interpolateReds:fre,interpolateRgb:Nh,interpolateRgbBasis:ET,interpolateRgbBasisClosed:VG,interpolateRound:k0,interpolateSinebow:wre,interpolateSpectral:Xne,interpolateString:_3,interpolateTransformCss:RT,interpolateTransformSvg:$T,interpolateTurbo:Nre,interpolateViridis:jre,interpolateWarm:gre,interpolateYlGn:ire,interpolateYlGnBu:sre,interpolateYlOrBr:are,interpolateYlOrRd:ore,interpolateZoom:OT,interrupt:mc,intersection:PV,interval:fY,isoFormat:Nne,isoParse:_ne,json:bJ,lab:ug,lch:BG,least:hV,leastIndex:ZI,line:y4,lineRadial:CS,linkHorizontal:Vre,linkRadial:Gre,linkVertical:Wre,local:cT,map:_V,matcher:g3,max:ig,maxIndex:KI,mean:lV,median:cV,merge:h3,min:ag,minIndex:JI,namespace:Kh,namespaces:$5,nice:YI,now:Zh,pack:ree,packEnclose:eL,packSiblings:eee,pairs:dV,partition:see,path:Sl,permute:GI,pie:Dre,piecewise:BT,pointRadial:Hf,pointer:gi,pointers:_G,polygonArea:vee,polygonCentroid:bee,polygonContains:_ee,polygonHull:jee,polygonLength:See,precisionFixed:d9,precisionPrefix:f9,precisionRound:h9,quadtree:M0,quantile:vh,quantileSorted:XI,quantize:lY,quickselect:f3,radialArea:PS,radialLine:CS,randomBates:Cee,randomBernoulli:Tee,randomBeta:uL,randomBinomial:dL,randomCauchy:Mee,randomExponential:Pee,randomGamma:n4,randomGeometric:cL,randomInt:kee,randomIrwinHall:lL,randomLcg:Dee,randomLogNormal:Eee,randomLogistic:Ree,randomNormal:t4,randomPareto:Iee,randomPoisson:$ee,randomUniform:Aee,randomWeibull:Lee,range:Pa,reduce:SV,reverse:AV,rgb:Qu,ribbon:vK,ribbonArrow:bK,rollup:VI,rollups:eV,scaleBand:s4,scaleDiverging:YL,scaleDivergingLog:XL,scaleDivergingPow:p4,scaleDivergingSqrt:Pne,scaleDivergingSymlog:KL,scaleIdentity:pL,scaleImplicit:jN,scaleLinear:mL,scaleLog:xL,scaleOrdinal:r4,scalePoint:qee,scalePow:c4,scaleQuantile:bL,scaleQuantize:wL,scaleRadial:vL,scaleSequential:HL,scaleSequentialLog:VL,scaleSequentialPow:m4,scaleSequentialQuantile:GL,scaleSequentialSqrt:Cne,scaleSequentialSymlog:WL,scaleSqrt:Zee,scaleSymlog:yL,scaleThreshold:NL,scaleTime:kne,scaleUtc:Ene,scan:gV,schemeAccent:Tne,schemeBlues:yM,schemeBrBG:JL,schemeBuGn:aM,schemeBuPu:oM,schemeCategory10:Ine,schemeDark2:Lne,schemeGnBu:lM,schemeGreens:vM,schemeGreys:bM,schemeOrRd:cM,schemeOranges:jM,schemePRGn:ZL,schemePaired:Mne,schemePastel1:Rne,schemePastel2:$ne,schemePiYG:QL,schemePuBu:dM,schemePuBuGn:uM,schemePuOr:eM,schemePuRd:fM,schemePurples:wM,schemeRdBu:tM,schemeRdGy:nM,schemeRdPu:hM,schemeRdYlBu:rM,schemeRdYlGn:sM,schemeReds:NM,schemeSet1:One,schemeSet2:Fne,schemeSet3:Dne,schemeSpectral:iM,schemeTableau10:qne,schemeYlGn:pM,schemeYlGnBu:mM,schemeYlOrBr:gM,schemeYlOrRd:xM,select:Es,selectAll:SG,selection:Ic,selector:w0,selectorAll:p3,shuffle:xV,shuffler:QI,some:NV,sort:P5,stack:Nse,stackOffsetDiverging:_se,stackOffsetExpand:jse,stackOffsetNone:ud,stackOffsetSilhouette:Sse,stackOffsetWiggle:Ase,stackOrderAppearance:GM,stackOrderAscending:YM,stackOrderDescending:Ese,stackOrderInsideOut:Cse,stackOrderNone:dd,stackOrderReverse:Pse,stratify:lee,style:yc,subset:IV,sum:yV,superset:tT,svg:jJ,symbol:ese,symbolCircle:w4,symbolCross:EM,symbolDiamond:PM,symbolSquare:LM,symbolStar:TM,symbolTriangle:MM,symbolWye:RM,symbols:Qre,text:L0,thresholdFreedmanDiaconis:aV,thresholdScott:oV,thresholdSturges:d3,tickFormat:hL,tickIncrement:Xh,tickStep:Ju,ticks:yh,timeDay:Nd,timeDays:nte,get timeFormat(){return d4},timeFormatDefaultLocale:zL,timeFormatLocale:$L,timeFriday:SL,timeFridays:ote,timeHour:z0,timeHours:tte,timeInterval:Qr,timeMillisecond:od,timeMilliseconds:fS,timeMinute:B0,timeMinutes:ete,timeMonday:Lh,timeMondays:rte,timeMonth:U0,timeMonths:cte,get timeParse(){return BL},timeSaturday:AL,timeSaturdays:lte,timeSecond:xo,timeSeconds:mS,timeSunday:ld,timeSundays:pS,timeThursday:_c,timeThursdays:ate,timeTickInterval:RL,timeTicks:ML,timeTuesday:jL,timeTuesdays:ste,timeWednesday:_L,timeWednesdays:ite,timeWeek:ld,timeWeeks:pS,timeYear:Da,timeYears:ute,timeout:z5,timer:P0,timerFlush:HT,transition:YT,transpose:eT,tree:mee,treemap:pee,treemapBinary:gee,treemapDice:rm,treemapResquarify:yee,treemapSlice:D0,treemapSliceDice:xee,treemapSquarify:oL,tsv:xJ,tsvFormat:rJ,tsvFormatBody:sJ,tsvFormatRow:aJ,tsvFormatRows:iJ,tsvFormatValue:oJ,tsvParse:i9,tsvParseRows:nJ,union:TV,utcDay:jd,utcDays:hte,get utcFormat(){return G0},utcFriday:CL,utcFridays:yte,utcHour:V0,utcHours:fte,utcMillisecond:od,utcMilliseconds:fS,utcMinute:H0,utcMinutes:dte,utcMonday:Mh,utcMondays:mte,utcMonth:W0,utcMonths:bte,get utcParse(){return f4},utcSaturday:PL,utcSaturdays:vte,utcSecond:xo,utcSeconds:mS,utcSunday:cd,utcSundays:gS,utcThursday:Sc,utcThursdays:xte,utcTickInterval:LL,utcTicks:TL,utcTuesday:kL,utcTuesdays:pte,utcWednesday:EL,utcWednesdays:gte,utcWeek:cd,utcWeeks:gS,utcYear:qa,utcYears:wte,variance:FI,version:FH,window:x3,xml:wJ,zip:bV,zoom:Ose,zoomIdentity:t1,zoomTransform:KM},Symbol.toStringTag,{value:"Module"}));var Ze=typeof window=="object"&&window.d3?window.d3:Fse;function Dse(e,t,n){if(!t.rels.children)return;const r=t.rels.spouses||[];return e.sort((s,i)=>{const l=$S(s,t,n)||{},a=$S(i,t,n)||{},c=r.indexOf(l.id),d=r.indexOf(a.id);return t.data.gender==="M"?c-d:d-c})}function qse(e){return e.sort((t,n)=>{const r=t._new_rel_data,s=n._new_rel_data;return r&&!s?1:!r&&s?-1:0})}function $S(e,t,n){return n.find(r=>r.id!==t.id&&(r.id===e.rels.mother||r.id===e.rels.father))}function fd(e,t,n){if(e.exiting=n,t)e.depth===0&&!e.spouse?(e._x=e.x,e._y=e.y):e.spouse?(e._x=e.spouse.x,e._y=e.spouse.y):e.is_ancestry?(e._x=e.parent.x,e._y=e.parent.y):(e._x=e.psx,e._y=e.psy);else if(n){const r=e.x>0?1:-1,s=e.y>0?1:-1;e._x=e.x+400*r,e._y=e.y+400*s}}function JM(e,t){const n=t?"rels":"_rels",r=t?"_rels":"rels";e.is_ancestry||e.data.main?(s("father"),s("mother")):i();function s(l){!e.data[n]||!e.data[n][l]||(e.data[r]||(e.data[r]={}),e.data[r][l]=e.data[n][l],delete e.data[n][l])}function i(){if(!e.data[n]||!e.data[n].children)return;const l=e.data[n].children.slice(0),a=e.spouse?[e.spouse]:e.spouses||[];[e,...a].forEach(c=>l.forEach(d=>{c.data[n].children.includes(d)&&(c.data[r]||(c.data[r]={}),c.data[r].children||(c.data[r].children=[]),c.data[r].children.push(d),c.data[n].children.splice(c.data[n].children.indexOf(d),1))}))}}function Bse(e,t){e.forEach(n=>{n.data.hide_rels=t,JM(n,t)})}function zse({tree:e,data_stash:t,node_separation:n,sortChildrenFunction:r}){const s=e.find(m=>m.data.main),i=s.data.rels.father,l=s.data.rels.mother,a=d(),c=u();f();function d(){return t.filter(m=>m.id===s.data.id?!1:!!(i&&m.rels.father===i||l&&m.rels.mother===l))}function u(){const m=[];for(let h=0;h<a.length;h++){const g={data:a[h],sibling:!0};g.parents=[];const y=s.parents.find(x=>x.data.id===g.data.rels.father),p=s.parents.find(x=>x.data.id===g.data.rels.mother);y&&g.parents.push(y),p&&g.parents.push(p),g.x=void 0,g.y=s.y,g.depth=s.depth-1,e.push(g),m.push(g)}return m}function f(){const m=[s,...c];r&&m.sort((x,b)=>r(x.data,b.data)),m.sort((x,b)=>{const w=s.parents.find(R=>R.data.id===x.data.rels.father),N=s.parents.find(R=>R.data.id===x.data.rels.mother),k=s.parents.find(R=>R.data.id===b.data.rels.father),I=s.parents.find(R=>R.data.id===b.data.rels.mother);return!N&&I?-1:N&&!I||!w&&k?1:w&&!k?-1:0});const h=s.x,g=(s.spouses||[]).map(x=>x.x),y=Ze.extent([h,...g]),p=m.findIndex(x=>x.data.id===s.data.id);for(let x=0;x<m.length;x++){if(x===p)continue;const b=m[x];x<p?b.x=y[0]-n*(p-x):b.x=y[1]+n*(x-p)}}}function Use({tree:e,data_stash:t,private_cards_config:n}){const r={},s=n.condition;if(!s)return console.error("private_cards_config.condition is not set");e.forEach(l=>{if(l.data._new_rel_data)return;const a=i(l.data.id);a&&(l.is_private=a)});function i(l){const a=[];let c=!1;return d(l),r[l]=c,c;function d(u){if(c)return;if(r.hasOwnProperty(u))return c=r[u],c;const f=t.find(h=>h.id===u);if(f._new_rel_data)return;if(s(f))return c=!0,!0;const m=f.rels;[m.father,m.mother,...m.spouses||[]].forEach(h=>{h&&(a.includes(h)||(a.push(h),d(h)))})}}}function Hse(e,t){const n=t.find(a=>a.id===e),r=Ze.hierarchy(n,l),s=Ze.hierarchy(n,i);return{ancestry:r.height,progeny:s.height};function i(a){return[...a.rels.children||[]].map(c=>t.find(d=>d.id===c)).filter(c=>c&&!c._new_rel_data&&!c.to_add)}function l(a){return[a.rels.father,a.rels.mother].filter(c=>c).map(c=>t.find(d=>d.id===c)).filter(c=>c&&!c._new_rel_data&&!c.to_add)}}function ZM(e,t){const n=e.rels,r=[n.father,n.mother,...n.spouses||[],...n.children||[]].filter(s=>!!s);for(const s of r){const i=t.find(l=>l.id===s);if(!A4(i,t,[e.id]))return!1}return!0}function A4(e,t,n=[]){const r=t[0];if(e.id===r.id)return!0;const s=[...n];let i=!1;return l(e),i;function l(a){if(i)return;const c=a.rels;[c.father,c.mother,...c.spouses||[],...c.children||[]].filter(u=>!!u).forEach(u=>{if(s.includes(u))return;s.push(u);const f=t.find(m=>m.id===u);f.id===r.id?i=!0:l(f)})}}function QM(e,t,n){const r=e.id;n.forEach(l=>{l.rels.father===r&&(l.rels.father=t),l.rels.mother===r&&(l.rels.mother=t),(l.rels.spouses||[]).includes(r)&&(l.rels.spouses=l.rels.spouses.filter(a=>a!==r),l.rels.spouses.includes(t)||l.rels.spouses.push(t)),(l.rels.children||[]).includes(r)&&(l.rels.children=l.rels.children.filter(a=>a!==r),l.rels.children.includes(t)||l.rels.children.push(t))});const s=n.find(l=>l.id===t),i=n.find(l=>l.id===r);(i.rels.children||[]).forEach(l=>{s.rels.children||(s.rels.children=[]),s.rels.children.includes(l)||s.rels.children.push(l)}),(i.rels.spouses||[]).forEach(l=>{s.rels.spouses||(s.rels.spouses=[]),s.rels.spouses.includes(l)||s.rels.spouses.push(l)}),s.rels.father&&i.rels.father&&console.error("link rel already has father"),s.rels.mother&&i.rels.mother&&console.error("link rel already has mother"),i.rels.father&&(s.rels.father=i.rels.father),i.rels.mother&&(s.rels.mother=i.rels.mother),n.splice(n.findIndex(l=>l.id===r),1)}function Vse(e,t){const n=e._new_rel_data?t.find(a=>a.id===e._new_rel_data.rel_id):null,r=i(e,t),s=l(e,t);return e._new_rel_data&&["son","daughter"].includes(e._new_rel_data.rel_type)&&s.push(...l(n,t)),t.filter(a=>a.id!==e.id&&a.id!==(n==null?void 0:n.id)&&!a._new_rel_data&&!a.to_add&&!a.unknown).filter(a=>!r.includes(a.id)).filter(a=>!s.includes(a.id)).filter(a=>!(a.rels.spouses||[]).includes(e.id));function i(a,c){const d=[];return u(a),d;function u(f){[f.rels.father,f.rels.mother].forEach(h=>{h&&(d.push(h),u(c.find(g=>g.id===h)))})}}function l(a,c){const d=[];return u(a),d;function u(f){(f.rels.children?[...f.rels.children]:[]).forEach(h=>{d.push(h),u(c.find(g=>g.id===h))})}}}function Wse({datum:e,store:t,fields:n,postSubmit:r,addRelative:s,removeRelative:i,deletePerson:l,onCancel:a,editFirst:c,link_existing_rel_config:d,getKinshipInfo:u,onFormCreation:f}){const m={datum_id:e.id,fields:[],onSubmit:x,getKinshipInfo:u,onFormCreation:f};e._new_rel_data||(m.onDelete=w,m.addRelative=()=>s.activate(e),m.addRelativeCancel=()=>s.onCancel(),m.addRelativeActive=s.is_active,m.removeRelative=()=>i.activate(e),m.removeRelativeCancel=()=>i.onCancel(),m.removeRelativeActive=i.is_active,m.editable=!1),e._new_rel_data&&(m.title=e._new_rel_data.label,m.new_rel=!0,m.editable=!0,m.onCancel=a),(e._new_rel_data||e.to_add||e.unknown)&&d&&(m.linkExistingRelative=p(e,t.getData(),d)),m.onDelete&&(m.can_delete=!0),c&&(m.editable=!0);const h=(e.rels.children||[]).some(N=>!t.getDatum(N)._new_rel_data);return m.gender_field={id:"gender",type:"switch",label:"Gender",initial_value:e.data.gender,disabled:["father","mother"].some(N=>{var k;return N===((k=e._new_rel_data)==null?void 0:k.rel_type)})||h,options:[{value:"M",label:"Male"},{value:"F",label:"Female"}]},n.forEach(N=>{N.type==="rel_reference"?g(N):N.type==="select"?y(N):m.fields.push({id:N.id,type:N.type,label:N.label,initial_value:e.data[N.id]})}),m;function g(N){N.getRelLabel||console.error("getRelLabel is not set"),N.rel_type==="spouse"&&(e.rels.spouses||[]).forEach(k=>{const I=t.getDatum(k),R=`${N.id}__ref__${k}`;m.fields.push({id:R,type:"rel_reference",label:N.label,rel_id:k,rel_label:N.getRelLabel(I),initial_value:e.data[R]})})}function y(N){if(!N.optionCreator&&!N.options)return console.error("optionCreator or options is not set for field",N);m.fields.push({id:N.id,type:N.type,label:N.label,initial_value:e.data[N.id],placeholder:N.placeholder,options:N.options||N.optionCreator(e)})}function p(N,k,I){return{label:I.label,options:Vse(N,k).map(T=>({value:T.id,label:I.linkRelLabel(T)})).sort((T,S)=>typeof T.label=="string"&&typeof S.label=="string"?T.label.localeCompare(S.label):T.label<S.label?-1:1),onSelect:b}}function x(N){N.preventDefault(),new FormData(N.target).forEach((I,R)=>e.data[R]=I),eR(e,t.getData()),e.to_add&&delete e.to_add,e.unknown&&delete e.unknown,r()}function b(N){const k=N.target.value;r({link_rel_id:k})}function w(){l(),r({delete:!0})}}function eR(e,t){Object.keys(e.data).forEach(n=>{if(n.includes("__ref__")){const r=n.split("__ref__")[1],s=t.find(l=>l.id===r);if(!s)return;const i=n.split("__ref__")[0]+"__ref__"+e.id;s.data[i]=e.data[n]}})}function AN(e,t){Object.keys(e.data).forEach(n=>{if(n.includes("__ref__")){const r=n.split("__ref__")[1],s=t.find(l=>l.id===r);if(!s)return;const i=n.split("__ref__")[0]+"__ref__"+e.id;delete s.data[i]}})}function tR(e,t){return delete e.to_add,e}function Vg(e,t){return n1(e,t),!1}function n1(e,t){if(ZM(e,t))return n(),{success:!0};return r(),{success:!0};function n(){t.forEach(s=>{for(let i in s.rels)s.rels.hasOwnProperty(i)&&(s.rels[i]===e.id?delete s.rels[i]:Array.isArray(s.rels[i])&&s.rels[i].includes(e.id)&&s.rels[i].splice(s.rels[i].findIndex(l=>l===e.id),1))}),AN(e,t),t.splice(t.findIndex(s=>s.id===e.id),1),t.length===0&&t.push(iR({}).data[0])}function r(){AN(e,t),e.data={gender:e.data.gender},e.unknown=!0}}function Gse(e){return nR(e),e.forEach(t=>{delete t.main,delete t._tgdp,delete t._tgdp_sp,delete t.__tgdp_sp}),e.forEach(t=>{Object.keys(t).forEach(n=>{n[0]==="_"&&console.error("key starts with _",n)})}),e}function nR(e){for(let t=e.length-1;t>=0;t--)e[t].to_add&&Vg(e[t],e)}function rR({datum:e,data_stash:t,rel_type:n,rel_datum:r}){n==="daughter"||n==="son"?s(e):n==="father"||n==="mother"?i(e):n==="spouse"&&l(e);function s(a){return a.data.other_parent&&(c(a.data.other_parent),delete a.data.other_parent),a.rels[r.data.gender==="M"?"father":"mother"]=r.id,r.rels.children||(r.rels.children=[]),r.rels.children.push(a.id),a;function c(d){d==="_new"&&(d=f().id);const u=t.find(m=>m.id===d);a.rels[u.data.gender==="M"?"father":"mother"]=u.id,u.rels.hasOwnProperty("children")||(u.rels.children=[]),u.rels.children.push(a.id);function f(){const m=sR({rel_type:"spouse",rel_datum:r});return l(m),k4({data_stash:t,datum:m}),m}}}function i(a){const c=a.data.gender==="M",d=r.rels[c?"father":"mother"];d&&Vg(t.find(f=>f.id===d),t),u();function u(){return r.rels[c?"father":"mother"]=a.id,f(),a.rels.children=[r.id],a;function f(){const m=r.rels[c?"mother":"father"];if(!m)return;const h=t.find(g=>g.id===m);return a.rels.spouses=[m],h.rels.spouses||(h.rels.spouses=[]),h.rels.spouses.push(a.id),h}}}function l(a){c(),r.rels.spouses||(r.rels.spouses=[]),r.rels.spouses.push(a.id),a.rels.spouses=[r.id];function c(){r.rels.spouses&&r.rels.spouses.forEach(d=>{const u=t.find(f=>f.id===d);u.to_add&&Vg(u,t)})}}}function Ji({data:e,rels:t}){return{id:Xse(),data:e||{},rels:t||{}}}function sR({data:e,rel_type:t,rel_datum:n}){const r=s(n,t);return e=Object.assign(e||{},{gender:r}),Ji({data:e});function s(i,l){return["daughter","mother"].includes(l)||l==="spouse"&&i.data.gender==="M"?"F":"M"}}function k4({data_stash:e,datum:t}){e.push(t)}function iR({data:e,version:t}){return{data:[Ji({data:e})],version:t}}function Yse({datum:e,data_stash:t,rel_type:n,rel_datum:r}){k4({data_stash:t,datum:e}),rR({datum:e,data_stash:t,rel_type:n,rel_datum:r})}function Xse(){var e=new Date().getTime(),t=performance&&performance.now&&performance.now()*1e3||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var r=Math.random()*16;return e>0?(r=(e+r)%16|0,e=Math.floor(e/16)):(r=(t+r)%16|0,t=Math.floor(t/16)),(n==="x"?r:r&3|8).toString(16)})}function aR({amount:e,svg:t,transition_time:n=500}){const r=t.__zoomObj?t:t.parentNode,s=r.__zoomObj;Ze.select(r).transition().duration(n||0).delay(n?100:0).call(s.scaleBy,e)}function Kse(e){const t=e.__zoomObj?e:e.parentNode;return Ze.zoomTransform(t)}function Jse(e,t){const n=e.__zoomObj?e:e.parentNode,r=Ze.zoomTransform(n);aR({amount:t/r.k,svg:e})}function oR(e,t){const n=e.data.rels;return[n.father,n.mother,...n.spouses||[],...n.children||[]].filter(s=>s).every(s=>t.some(i=>i.data.id===s))}function Zse(e){e.forEach(t=>{var r;if(!t.spouse)return;const n=t.spouse;if(t.duplicate&&n.data._tgdp_sp){const s=n.data.main?"main":n.parent.data.id;(r=n.data._tgdp_sp[s])!=null&&r.hasOwnProperty(t.data.id)&&(t._toggle=n.data._tgdp_sp[s][t.data.id])}})}function Qse(e,t,n=!0){const r=[];s(e),m(r);function s(h){if(!h.children)return;const g=h.data,y=(h.data.rels.spouses||[]).map(x=>t.find(b=>b.id===x)),p=f(h);y.forEach(x=>{if(r.some(w=>w.some(N=>u([g,x],[N.p1,N.p2]))))return;const b=d(h,g,x);if(b.length>0){const w=[{d:h,p1:g,p2:x},...b];r.push(w),i(w),l(w)}else{let w=e===h?"main":h.parent.data.id;a(h,w,x),(p[x.id]||[]).forEach(N=>{s(N)})}})}function i(h){if(h.forEach(({d:g,p1:y,p2:p},x)=>{g.data._tgdp_sp||(g.data._tgdp_sp={});let b=e===g?"main":g.parent.data.id;c(g,b,p),g.data._tgdp_sp[b]||(g.data._tgdp_sp[b]={});let w=1;g.data._tgdp_sp[b].hasOwnProperty(p.id)?w=g.data._tgdp_sp[b][p.id]:g.data._tgdp_sp[b][p.id]=w,h[x].val=w}),n){if(h.every(g=>g.val<0)){const g=h.sort((w,N)=>N.val-w.val)[0],{d:y,p1:p,p2:x}=g,b=e===y?"main":y.parent.data.id;y.data._tgdp_sp[b][x.id]=1}if(h.filter(g=>g.val>0).length>1){const g=h.sort((y,p)=>p.val-y.val)[0];h.forEach(y=>{if(y===g)return;const{d:p,p1:x,p2:b}=y,w=e===p?"main":p.parent.data.id;p.data._tgdp_sp[w][b.id]=-1})}}}function l(h){h.forEach(({d:g,p1:y,p2:p})=>{const x=e===g?"main":g.parent.data.id;if(g.data._tgdp_sp[x][p.id]<0){const b=f(g);b[p.id]&&(g.children=g.children.filter(w=>!b[p.id].includes(w)),g.children.length===0&&delete g.children)}})}function a(h,g,y){h.data._tgdp_sp&&h.data._tgdp_sp[g]&&h.data._tgdp_sp[g].hasOwnProperty(y.id)&&(h.data.__tgdp_sp||(h.data.__tgdp_sp={}),h.data.__tgdp_sp[g]||(h.data.__tgdp_sp[g]={}),h.data.__tgdp_sp[g][y.id]=h.data._tgdp_sp[g][y.id],delete h.data._tgdp_sp[g][y.id])}function c(h,g,y){h.data.__tgdp_sp&&h.data.__tgdp_sp[g]&&h.data.__tgdp_sp[g].hasOwnProperty(y.id)&&(h.data._tgdp_sp[g][y.id]=h.data.__tgdp_sp[g][y.id],delete h.data.__tgdp_sp[g][y.id])}function d(h,g,y){const p=[];return x(e),p;function x(b){if(b!==h&&b.children){const w=b.data,N=(b.data.rels.spouses||[]).map(I=>t.find(R=>R.id===I)),k=f(b);N.forEach(I=>{u([g,y],[w,I])?p.push({d:b,p1:w,p2:I}):(k[I.id]||[]).forEach(R=>{x(R)})})}}}function u(h,g){return h.every(y=>g.some(p=>y.id===p.id))}function f(h){const g={},y=h;return(h.children||[]).forEach(p=>{const x=p.data.rels,b=x.father===y.data.id?x.mother:x.father;g[b]||(g[b]=[]),g[b].push(p)}),g}function m(h){let g=0;h.forEach(y=>{g=g+1,y.forEach(p=>{p.d._toggle_id_sp||(p.d._toggle_id_sp={}),p.d._toggle_id_sp[p.p2.id]=g})})}}function eie(e,t=!0){const n=[];r(e),c(n);function r(d){if(d.children){if(n.some(f=>f.includes(d)))return;const u=l(d.children);if(u.length>0){const f=[d,...u];n.push(f),s(f),i(f)}else d.children.forEach(f=>{r(f)})}}function s(d){if(d.forEach(u=>{u.data._tgdp||(u.data._tgdp={});const f=e===u?"main":u.parent.data.id;u.data._tgdp[f]||(u.data._tgdp[f]=-1),u._toggle=u.data._tgdp[f]}),t){if(d.every(u=>u._toggle<0)){const f=d.sort((h,g)=>g._toggle-h._toggle)[0],m=e===f?"main":f.parent.data.id;f.data._tgdp[m]=1}if(d.filter(u=>u._toggle>0).length>1){const u=d.sort((f,m)=>m._toggle-f._toggle)[0];d.forEach(f=>{if(f===u)return;const m=f,h=e===m?"main":m.parent.data.id;m.data._tgdp[h]=-1})}}}function i(d){d.forEach(u=>{const f=e===u?"main":u.parent.data.id;u.data._tgdp[f]<0&&delete u.children})}function l(d){const u=[];return f(e),u;function f(m){m.children&&(a(d,m.children)?u.push(m):m.children.forEach(h=>{f(h)}))}}function a(d,u){return d!==u&&d.every(f=>u.some(m=>f.data.id===m.data.id))}function c(d){let u=0;d.forEach(f=>{u=u+1,f.forEach(m=>{m._toggle_id=u})})}}function lR({data:e,main_id:t=null,node_separation:n=250,level_separation:r=150,single_parent_empty_card:s=!0,is_horizontal:i=!1,one_level_rels:l=!1,sortChildrenFunction:a=void 0,sortSpousesFunction:c=void 0,ancestry_depth:d=void 0,progeny_depth:u=void 0,show_siblings_of_main:f=!1,modifyTreeHierarchy:m=void 0,private_cards_config:h=void 0,duplicate_branch_toggle:g=!1,on_toggle_one_close_others:y=!0}){if(!e||!e.length)return{data:[],data_stash:[],dim:{width:0,height:0},main_id:null};i&&([n,r]=[r,n]);const p=s?P(e):e,x=t!==null&&p.find(O=>O.id===t)||p[0],b=I(x,"children",!1),w=I(x,"parents",!0);p.forEach(O=>O.main=O===x),R(w,b);const N=T(w,b);M({tree:N}),E({tree:N,node_separation:n}),f&&!l&&zse({tree:N,data_stash:p,node_separation:n,sortChildrenFunction:a}),_({tree:N}),S({tree:N}),N.forEach(O=>O.all_rels_displayed=oR(O,N)),h&&Use({tree:N,data_stash:p,private_cards_config:h}),tie({tree:N}),D(N),g&&Zse(N);const k=A(N,n,r);return{data:N,data_stash:p,dim:k,main_id:x.id,is_horizontal:i};function I(O,H,W){const $=H==="children"?te:we,z=Ze.tree().nodeSize([n,r]).separation(G),q=Ze.hierarchy(O,$);return W&&L(q),B(q,W),g&&V(q,p,W),m&&m(q,W),z(q),q.descendants();function G(Ee,pe){let ee=1;return W||(re(Ee,pe)||(ee+=.25),l||Y(Ee,pe)&&(ee+=me(Ee,pe)),re(Ee,pe)&&!oe(Ee,pe)&&(ee+=.125)),ee}function re(Ee,pe){return Ee.parent==pe.parent}function oe(Ee,pe){return Ee.data.rels.father===pe.data.rels.father&&Ee.data.rels.mother===pe.data.rels.mother}function ie(Ee){return Ee.data.rels.spouses&&Ee.data.rels.spouses.length>0}function Y(Ee,pe){return ie(Ee)||ie(pe)}function te(Ee){const pe=[...Ee.rels.children||[]].map(ee=>p.find(ft=>ft.id===ee));return a&&pe.sort(a),qse(pe),c&&c(Ee,p),Dse(pe,Ee,p),pe}function we(Ee){return[Ee.rels.father,Ee.rels.mother].filter(pe=>pe).map(pe=>p.find(ee=>ee.id===pe))}function me(Ee,pe){return((Ee.data.rels.spouses||[]).length+(pe.data.rels.spouses||[]).length)*.5}}function R(O,H){const W=(O[0].x-H[0].x)/2;O.forEach($=>$.x-=W),H.forEach($=>$.x+=W)}function T(O,H){return O.forEach(W=>{W.is_ancestry=!0}),O.forEach(W=>W.depth===1?W.parent=H[0]:null),[...H,...O.slice(1)]}function S({tree:O}){O.forEach(H=>{if(H.y*=H.is_ancestry?-1:1,i){const W=H.x;H.x=H.y,H.y=W}})}function E({tree:O,node_separation:H}){for(let W=O.length;W--;){const $=O[W];if(!$.is_ancestry){let z=$.data.rels.spouses;if($._ignore_spouses&&(z=z.filter(q=>!$._ignore_spouses.includes(q))),z&&z.length>0){if(l&&$.depth>0)continue;const q=$.data.data.gender==="M"?-1:1;$.x+=z.length/2*H*q,z.forEach((G,re)=>{if($._ignore_spouses&&$._ignore_spouses.includes(G))return;const oe={data:p.find(ie=>ie.id===G),added:!0};oe.x=$.x-H*(re+1)*q,oe.y=$.y,oe.sx=re>0?oe.x:oe.x+H/2*q,oe.sy=re>0?oe.y:oe.y+H/2*q,oe.depth=$.depth,oe.spouse=$,$.spouses||($.spouses=[]),$.spouses.push(oe),O.push(oe)})}}if($.parents&&$.parents.length===2){const z=$.parents[0],q=$.parents[1],G=z.x-(z.x-q.x)/2,re=(oe,ie)=>G+H/2*(oe.x<ie.x?1:-1);q.x=re(z,q),z.x=re(q,z)}}}function _({tree:O}){O.forEach(H=>{if(H.is_ancestry||H.depth===0||H.added||H.sibling)return;const W=H.parent,$=(W.spouses||[]).find(q=>q.data.id===H.data.rels.father||q.data.id===H.data.rels.mother);if(W&&$){!W.added&&!$.added&&console.error("no added spouse",W,$);const q=W.added?W:$;z(H,q)}else if(W||$){const q=W||$;q.sx=q.x,q.sy=q.y,z(H,q)}function z(q,G){q.psx=i?G.y:G.sx,q.psy=i?G.sx:G.y}})}function M({tree:O}){O.forEach(H=>{delete H.children,O.forEach(W=>{W.parent===H&&(W.is_ancestry?(H.parents||(H.parents=[]),H.parents.push(W)):(H.children||(H.children=[]),H.children.push(W)))})})}function A(O,H,W){i&&([H,W]=[W,H]);const $=Ze.extent(O,q=>q.x),z=Ze.extent(O,q=>q.y);return{width:$[1]-$[0]+H,height:z[1]-z[0]+W,x_off:-$[0]+H/2,y_off:-z[0]+W/2}}function P(O){const H=[];for(let z=0;z<O.length;z++){const q=O[z];if(q.rels.children&&q.rels.children.length>0){q.rels.spouses||(q.rels.spouses=[]);const G=q.data.gender==="M";let re;q.rels.children.forEach(oe=>{const ie=O.find(Y=>Y.id===oe);ie.rels[G?"father":"mother"]===q.id&&(ie.rels[G?"mother":"father"]||(re||(re=W(q)),re.rels.children.push(ie.id),ie.rels[G?"mother":"father"]=re.id))})}}return H.forEach(z=>O.push(z)),O;function W(z){return z.rels.spouses.map(G=>O.find(re=>re.id===G)).find(G=>G.to_add)||$(z)}function $(z){const q=Ji({data:{gender:z.data.gender==="M"?"F":"M"},rels:{spouses:[z.id],children:[]}});return q.to_add=!0,H.push(q),z.rels.spouses.push(q.id),q}}function B(O,H){let W=H?d:u;if(l&&(W=1),!W&&W!==0)return O;return $(O,0),O;function $(z,q){q===W?z.children&&delete z.children:z.children&&z.children.forEach(G=>{$(G,q+1)})}}function L(O){H(O);function H(W){W.children&&W.children.length===2&&(W.children[0]._spouse=W.children[1],W.children[1]._spouse=W.children[0]),W.children&&W.children.forEach($=>H($))}}function D(O){O.forEach(H=>{if(H.data.main)H.from=[],H.to=[],H.to_ancestry=H.parents;else if(H.is_ancestry)H.from=[H.parent],H.to=H.parents;else{if(H.added){H.from=[],H.from_spouse=H.spouse,H.to=[];return}if(H.sibling)return;const W=H.parent,$=(H.parent.spouses||[]).find(z=>z.data.id===H.data.rels.father||z.data.id===H.data.rels.mother);H.from=[W],$&&H.from.push($),W.to||(W.to=[]),W.to.push(H),$&&($.to||($.to=[]),$.to.push(H))}})}function V(O,H,W){W?eie(O,y):Qse(O,H,y)}}function tie({tree:e}){const t=[];e.forEach(n=>{if(t.includes(n.data.id)){const r=e.filter(s=>s.data.id===n.data.id);r.forEach((s,i)=>{s.tid=`${n.data.id}--x${i+1}`,s.duplicate=r.length,t.push(n.data.id)})}else n.tid=n.data.id,t.push(n.data.id)})}function nie(e){let t;const n=e;return n.main_id_history=[],{state:n,updateTree:f=>{n.tree=s(),n.main_id||d(n.tree.main_id),t&&t(f)},updateData:f=>n.data=f,updateMainId:d,getMainId:()=>n.main_id,getData:()=>n.data,getTree:()=>n.tree,setOnUpdate:f=>t=f,getMainDatum:i,getDatum:l,getTreeMainDatum:a,getTreeDatum:c,getLastAvailableMainDatum:u,methods:{}};function s(){return lR({data:n.data,main_id:n.main_id,node_separation:n.node_separation,level_separation:n.level_separation,single_parent_empty_card:n.single_parent_empty_card,is_horizontal:n.is_horizontal,one_level_rels:n.one_level_rels,sortChildrenFunction:n.sortChildrenFunction,sortSpousesFunction:n.sortSpousesFunction,ancestry_depth:n.ancestry_depth,progeny_depth:n.progeny_depth,show_siblings_of_main:n.show_siblings_of_main,modifyTreeHierarchy:n.modifyTreeHierarchy,private_cards_config:n.private_cards_config,duplicate_branch_toggle:n.duplicate_branch_toggle})}function i(){return n.data.find(f=>f.id===n.main_id)}function l(f){return n.data.find(m=>m.id===f)}function a(){return n.tree?n.tree.data.find(f=>f.data.id===n.main_id):null}function c(f){return n.tree?n.tree.data.find(m=>m.data.id===f):null}function d(f){f!==n.main_id&&(n.main_id_history=n.main_id_history.filter(m=>m!==f).slice(-10),n.main_id_history.push(f),n.main_id=f)}function u(){let f=n.main_id_history.slice(0).reverse().find(m=>l(m));return f||(f=n.data[0].id),f!==n.main_id&&d(f),l(f)}}function cR({t:e,svg:t,transition_time:n=2e3}){const r=t.__zoomObj?t:t.parentNode,s=r.__zoomObj;Ze.select(r).transition().duration(n||0).delay(n?100:0).call(s.transform,Ze.zoomIdentity.scale(e.k).translate(e.x,e.y))}function kN({svg:e,svg_dim:t,tree_dim:n,with_transition:r,transition_time:s}){const i=uR(t,n);cR({t:i,svg:e,transition_time:s})}function uR(e,t){let n=Math.min(e.width/t.width,e.height/t.height);n>1&&(n=1);const r=t.x_off+(e.width-t.width*n)/n/2,s=t.y_off+(e.height-t.height*n)/n/2;return{k:n,x:r,y:s}}function dR({datum:e,svg:t,svg_dim:n,scale:r,transition_time:s}){const i=r||1,l=n.width/2-e.x*i,a=n.height/2-e.y,c={k:i,x:l/i,y:a/i};cR({t:c,svg:t,transition_time:s})}function rie({d:e,tree:t,is_horizontal:n=!1}){const r=[];return(e.spouses||e._spouse)&&l({d:e}),s({d:e}),i({d:e}),r;function s({d:g}){if(!g.parents)return;const y=g.parents[0],p=g.parents[1]||y,x={x:a(y,p,"x"),y:a(y,p,"y")};r.push({d:d(g,x),_d:()=>{const b={x:g.x,y:g.y},w={x:g.x,y:g.y};return d(b,w)},curve:!0,id:m(g,y,p),depth:g.depth+1,is_ancestry:!0,source:g,target:[y,p]})}function i({d:g}){!g.children||g.children.length===0||g.children.forEach((y,p)=>{const x=h(y,g)||g,b=x.sx,w=n?{x:g.x,y:b}:{x:b,y:g.y};r.push({d:d(y,w),_d:()=>d(w,{x:c(w,"x"),y:c(w,"y")}),curve:!0,id:m(y,g,x),depth:g.depth+1,is_ancestry:!1,source:[g,x],target:y})})}function l({d:g}){g.spouses?g.spouses.forEach(p=>r.push(y(g,p))):g._spouse&&r.push(y(g,g._spouse));function y(p,x){return{d:[[p.x,p.y],[x.x,x.y]],_d:()=>[p.is_ancestry?[c(p,"x")-1e-4,c(p,"y")]:[p.x,p.y],p.is_ancestry?[c(x,"x"),c(x,"y")]:[p.x-1e-4,p.y]],curve:!1,id:m(p,x),depth:p.depth,spouse:!0,is_ancestry:x.is_ancestry,source:p,target:x}}}function a(g,y,p,x){return g[p]-(g[p]-y[p])/2}function c(g,y){return g.hasOwnProperty("_"+y)?g["_"+y]:g[y]}function d(g,y){return n?f(g,y):u(g,y)}function u(g,y){const p=g.y+(y.y-g.y)/2;return[[g.x,g.y],[g.x,p],[g.x,p],[y.x,p],[y.x,p],[y.x,y.y]]}function f(g,y){const p=g.x+(y.x-g.x)/2;return[[g.x,g.y],[p,g.y],[p,g.y],[p,y.y],[p,y.y],[y.x,y.y]]}function m(...g){return g.map(y=>y.tid).sort().join(", ")}function h(g,y){return(y.spouses||[]).find(x=>x.data.id===g.data.rels.mother||x.data.id===g.data.rels.father)}}function sie(e,t,n,r){const s=n.is_ancestry,i=t.data();let l=[],a=[];if(s){const f=[];let m=n,h=0;for(;m!==r.data&&h<100;){h++;const y=i.find(p=>p.spouse===!0&&(p.source===m||p.target===m));if(y){const p=i.filter(b=>Array.isArray(b.target)&&b.target.includes(y.source)&&b.target.includes(y.target)),x=u(p,r);if(!x)break;f.push(y),f.push(x),m=x.source}else{const p=i.filter(b=>Array.isArray(b.target)&&b.target.includes(m)),x=u(p,r);if(!x)break;f.push(x),m=x.source}}t.each(function(y){f.includes(y)&&l.push({link:y,node:this})});const g=d(n,f);e.each(function(y){g.includes(y)&&a.push({card:y,node:this})})}else if(n.spouse&&n.spouse.data===r.data){t.each(function(m){m.target===n&&l.push({link:m,node:this})});const f=[r,n];e.each(function(m){f.includes(m)&&a.push({card:m,node:this})})}else if(n.sibling){t.each(function(m){m.source===n&&l.push({link:m,node:this}),m.source===r&&m.target.length===2&&l.push({link:m,node:this}),n.parents.includes(m.source)&&n.parents.includes(m.target)&&l.push({link:m,node:this})});const f=[r,n,...n.parents];e.each(function(m){f.includes(m)&&a.push({card:m,node:this})})}else{let f=[],m=n,h=0;for(;m!==r.data&&h<100;){h++;const y=i.find(p=>p.target===m&&Array.isArray(p.source));if(y){const p=i.find(x=>x.spouse===!0&&c([x.source,x.target],y.source));f.push(y),f.push(p),p?m=p.source:m=y.source[0]}else{const p=i.find(x=>x.target===m&&!Array.isArray(x.source));if(!p)break;f.push(p),m=p.source}}t.each(function(y){f.includes(y)&&l.push({link:y,node:this})});const g=d(r,f);e.each(function(y){g.includes(y)&&a.push({card:y,node:this})})}return[a,l];function c(f,m){return f.every(h=>m.some(g=>h===g))}function d(f,m){const h=m.filter(p=>p).reduce((p,x)=>(Array.isArray(x.target)?p.push(...x.target):p.push(x.target),Array.isArray(x.source)?p.push(...x.source):p.push(x.source),p),[]),g=[r,n];return y(f),g;function y(p){p.data.rels.children&&p.data.rels.children.forEach(x=>{const b=h.find(w=>w.data.id===x);b&&(g.push(b),y(b))})}}function u(f,m){return f.length===0?null:f.length===1?f[0]:f.find(h=>h.source===m)}}function Vx(e,t){const n=Ze.line().curve(Ze.curveMonotoneY),r=Ze.line().curve(Ze.curveBasis),s=t?e._d():e.d;if(e.curve){if(e.curve===!0)return r(s)}else return n(s)}function iie(e,t,n={}){const r=t.data.reduce((m,h)=>(rie({d:h,tree:t.data,is_horizontal:t.is_horizontal}).forEach(g=>m[g.id]=g),m),{}),s=Object.values(r),i=Ze.select(e).select(".links_view").selectAll("path.link").data(s,m=>m.id),l=i.exit(),a=i.enter().append("path").attr("class","link"),c=a.merge(i);l.each(f),a.each(d),c.each(u);function d(m){Ze.select(this).attr("fill","none").attr("stroke","#fff").attr("stroke-width",1).style("opacity",0).attr("d",Vx(m,!0))}function u(m){const h=Ze.select(this),g=n.initial?im(t,m,n.transition_time):0;h.transition("path").duration(n.transition_time).delay(g).attr("d",Vx(m)).style("opacity",1)}function f(m){const h=Ze.select(this);h.transition("op").duration(800).style("opacity",0),h.transition("path").duration(n.transition_time).attr("d",Vx(m,!0)).on("end",()=>h.remove())}}function aie(e,t,n,r={}){const s=Ze.select(e).select(".cards_view").selectAll("g.card_cont").data(t.data,m=>m.data.id),i=s.exit(),l=s.enter().append("g").attr("class","card_cont"),a=l.merge(s);i.each(m=>fd(m,!1,!0)),l.each(m=>fd(m,!0,!1)),i.each(f),s.each(d),l.each(c),a.each(u);function c(m){Ze.select(this).attr("transform",`translate(${m._x}, ${m._y})`).style("opacity",0),n.call(this,m)}function d(m){}function u(m){n.call(this,m);const h=r.initial?im(t,m,r.transition_time):0;Ze.select(this).transition().duration(r.transition_time).delay(h).attr("transform",`translate(${m.x}, ${m.y})`).style("opacity",1)}function f(m){const h=Ze.select(this);h.transition().duration(r.transition_time).style("opacity",0).attr("transform",`translate(${m._x}, ${m._y})`).on("end",()=>h.remove())}}function oie(e,t,n,r={}){const s=Ze.select(e).select(".cards_view").selectAll("div.card_cont").data(t.data,m=>m.tid),i=s.exit(),l=s.enter().append("div").attr("class","card_cont").style("pointer-events","none"),a=l.merge(s);i.each(m=>fd(m,!1,!0)),l.each(m=>fd(m,!0,!1)),i.each(f),s.each(d),l.each(c),a.each(u);function c(m){Ze.select(this).style("position","absolute").style("top","0").style("left","0").style("transform",`translate(${m._x}px, ${m._y}px)`).style("opacity",0),n.call(this,m)}function d(m){}function u(m){n.call(this,m);const h=r.initial?im(t,m,r.transition_time):0;Ze.select(this).transition().duration(r.transition_time).delay(h).style("transform",`translate(${m.x}px, ${m.y}px)`).style("opacity",1)}function f(m){const h=Ze.select(this);h.transition().duration(r.transition_time).style("opacity",0).style("transform",`translate(${m._x}px, ${m._y}px)`).on("end",()=>h.remove())}}function fR(e,t){const n=Ze.select(e).selectAll("div.card_cont_2fake").data(t,d=>d.data.id),r=n.exit(),s=n.enter().append("div").attr("class","card_cont_2fake").style("display","none").attr("data-id",()=>Math.random()),i=s.merge(n);r.each(c),s.each(l),i.each(a);function l(d){d.unique_id=Ze.select(this).attr("data-id")}function a(d){d.unique_id=Ze.select(this).attr("data-id")}function c(d){d.unique_id=Ze.select(this).attr("data-id"),Ze.select(this).remove()}}function hR(e){Ze.select(e()).append("div").attr("class","cards_view_fake").style("display","none")}function E4(e){return Ze.select(e()).select("div.cards_view_fake").node()}function lie(e,t){return function(r){const s=r.transform;Ze.select(e()).style("transform",`translate(${s.x}px, ${s.y}px) scale(${s.k}) `),Ze.select(t()).style("transform",`translate(${s.x}px, ${s.y}px) scale(${s.k}) `)}}function cie(e){let t=[];return function(r){const s=die(r,t);return t=[...r,...s],fR(E4(e),t),t}}function uie(e){const n=Ze.select(e).select("#f3Canvas").append("div").attr("id","htmlSvg").attr("style","position: absolute; width: 100%; height: 100%; z-index: 2; top: 0; left: 0");return n.append("div").attr("class","cards_view").style("transform-origin","0 0"),hR(()=>n.node()),n.node()}function die(e,t){return t.length>0?t.filter(n=>!e.find(r=>r.data.id===n.data.id)):[]}function fie(e){return e.unique_id}var hie=Object.freeze({__proto__:null,assignUniqueIdToTreeData:fR,setupHtmlSvg:hR,getCardsViewFake:E4,onZoomSetup:lie,setupReactiveTreeData:cie,createHtmlSvg:uie,getUniqueId:fie});function mie(e,t,n,r={}){const s=Ze.select(E4(()=>e)).selectAll("div.card_cont_fake").data(t.data,m=>m.data.id),i=s.exit(),l=s.enter().append("div").attr("class","card_cont_fake").style("display","none"),a=l.merge(s);i.each(m=>fd(m,!1,!0)),l.each(m=>fd(m,!0,!1)),i.each(f),s.each(d),l.each(c),a.each(u);function c(m){Ze.select(n(m)).style("position","absolute").style("top","0").style("left","0").style("opacity",0).style("transform",`translate(${m._x}px, ${m._y}px)`)}function d(m){}function u(m){const h=Ze.select(n(m)),g=r.initial?im(t,m,r.transition_time):0;h.transition().duration(r.transition_time).delay(g).style("transform",`translate(${m.x}px, ${m.y}px)`).style("opacity",1)}function f(m){const h=Ze.select(n(m)),g=Ze.select(this);h.transition().duration(r.transition_time).style("opacity",0).style("transform",`translate(${m._x}px, ${m._y}px)`).on("end",()=>g.remove())}}function pie(e,t,n,r={}){r.initial=r.hasOwnProperty("initial")?r.initial:!Ze.select(t.parentNode).select(".card_cont").node(),r.transition_time=r.hasOwnProperty("transition_time")?r.transition_time:2e3,r.cardComponent?mie(r.cardComponent,e,n,r):r.cardHtml?oie(r.cardHtml,e,n,r):aie(t,e,n,r),iie(t,e,r);const s=r.tree_position||"fit";return r.initial?kN({svg:t,svg_dim:t.getBoundingClientRect(),tree_dim:e.dim,transition_time:0}):s==="fit"?kN({svg:t,svg_dim:t.getBoundingClientRect(),tree_dim:e.dim,transition_time:r.transition_time}):s==="main_to_middle"&&dR({datum:e.data[0],svg:t,svg_dim:t.getBoundingClientRect(),scale:r.scale,transition_time:r.transition_time}),!0}function im(e,t,n){const r=n*.4,s=Math.max(...e.data.map(l=>l.is_ancestry?l.depth:0));let i=t.depth*r;return(t.depth!==0||t.spouse)&&!t.is_ancestry&&(i+=s*r,t.spouse&&(i+=r),i+=t.depth*r),i}function gie(e,t={}){const n=e.getBoundingClientRect(),r=`
    <svg class="main_svg">
      <rect width="${n.width}" height="${n.height}" fill="transparent" />
      <g class="view">
        <g class="links_view"></g>
        <g class="cards_view"></g>
      </g>
      <g style="transform: translate(100%, 100%)">
        <g class="fit_screen_icon cursor-pointer" style="transform: translate(-50px, -50px); display: none">
          <rect width="27" height="27" stroke-dasharray="${27/2}" stroke-dashoffset="${27/4}" 
            style="stroke:#fff;stroke-width:4px;fill:transparent;"/>
          <circle r="5" cx="${27/2}" cy="${27/2}" style="fill:#fff" />          
        </g>
      </g>
    </svg>
  `,s=a(e),i=Ze.create("div").node();i.innerHTML=r;const l=i.querySelector("svg");return s.appendChild(l),e.appendChild(s),xie(s,t),l;function a(c){let d=c.querySelector("#f3Canvas");return d||(d=Ze.create("div").attr("id","f3Canvas").attr("style","position: relative; overflow: hidden; width: 100%; height: 100%;").node()),d}}function xie(e,t={}){if(e.__zoom)return;const n=e.querySelector(".view"),r=Ze.zoom().on("zoom",t.onZoom||s);Ze.select(e).call(r),e.__zoomObj=r,t.zoom_polite&&r.filter(i);function s(l){Ze.select(n).attr("transform",l.transform)}function i(l){return l.type==="wheel"&&!l.ctrlKey?!1:!(l.touches&&l.touches.length<2)}}function C4(e,{d:t}){return Bse(e.getTree().data,!1),e.updateMainId(t.data.id),e.updateTree({tree_position:e.state.tree_fit_on_change}),!0}function P4(e,{d:t,cardEditForm:n}){const r=t.data;n({datum:r,postSubmit:i=>{r.to_add&&tR(r,e.getData()),i&&i.delete&&(r.main&&e.updateMainId(null),n1(r,e.getData())),e.updateTree()},store:e})}function mR(e,{d:t}){t.data.hide_rels=!t.data.hide_rels,JM(t,t.data.hide_rels),e.updateTree({tree_position:e.state.tree_fit_on_change})}function pR(){return`
    <g data-icon="user">
      ${Ps()}
      <path d="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z" />
    </g>
  `}function gR(){return`
    <g data-icon="user-edit">
      ${Ps()}
      <path d="M21.7,13.35L20.7,14.35L18.65,12.3L19.65,11.3C19.86,11.09 20.21,11.09 20.42,11.3L21.7,12.58C21.91,
      12.79 21.91,13.14 21.7,13.35M12,18.94L18.06,12.88L20.11,14.93L14.06,21H12V18.94M12,14C7.58,14 4,15.79 4,
      18V20H10V18.11L14,14.11C13.34,14.03 12.67,14 12,14M12,4A4,4 0 0,0 8,8A4,4 0 0,0 12,12A4,4 0 0,0 16,8A4,4 0 0,0 12,4Z" />
    </g>
  `}function xR(){return`
    <g data-icon="user-plus">
      ${Ps()}
      <path d="M15,14C12.33,14 7,15.33 7,18V20H23V18C23,15.33 17.67,14 15,14M6,10V7H4V10H1V12H4V15H6V12H9V10M15,12A4,4 0 0,0 19,8A4,4 0 0,0 15,4A4,4 0 0,0 11,8A4,4 0 0,0 15,12Z" />
    </g>
  `}function yR(){return`
    <g data-icon="user-plus-close">
      ${Ps()}
      <path d="M15,14C12.33,14 7,15.33 7,18V20H23V18C23,15.33 17.67,14 15,14M6,10V7H4V10H1V12H4V15H6V12H9V10M15,12A4,4 0 0,0 19,8A4,4 0 0,0 15,4A4,4 0 0,0 11,8A4,4 0 0,0 15,12Z" />
      <line x1="3" y1="3" x2="24" y2="24" stroke="currentColor" stroke-width="2" />
    </g>
  `}function I4(){return`
    <g data-icon="plus">
      ${Ps()}
      <path d="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z" />
    </g>
  `}function vR(){return`
    <g data-icon="pencil">
      ${Ps()}
      <path d="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z" />
    </g>
  `}function bR(){return`
    <g data-icon="pencil-off">
      ${Ps()}
      <path d="M18.66,2C18.4,2 18.16,2.09 17.97,2.28L16.13,4.13L19.88,7.88L21.72,6.03C22.11,5.64 22.11,5 21.72,4.63L19.38,2.28C19.18,2.09 18.91,2 18.66,2M3.28,4L2,5.28L8.5,11.75L4,16.25V20H7.75L12.25,15.5L18.72,22L20,20.72L13.5,14.25L9.75,10.5L3.28,4M15.06,5.19L11.03,9.22L14.78,12.97L18.81,8.94L15.06,5.19Z" />
    </g>
  `}function wR(){return`
    <g data-icon="trash">
      ${Ps()}
      <path d="M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19M8,9H16V19H8V9M15.5,4L14.5,3H9.5L8.5,4H5V6H19V4H15.5Z" />
    </g>
  `}function NR(){return`
    <g data-icon="history-back">
      ${Ps()}
      <path d="M20 13.5C20 17.09 17.09 20 13.5 20H6V18H13.5C16 18 18 16 18 13.5S16 9 13.5 9H7.83L10.91 12.09L9.5 13.5L4 8L9.5 2.5L10.92 3.91L7.83 7H13.5C17.09 7 20 9.91 20 13.5Z" />
    </g>
  `}function jR(){return`
    <g data-icon="history-forward">
      ${Ps()}
      <path d="M10.5 18H18V20H10.5C6.91 20 4 17.09 4 13.5S6.91 7 10.5 7H16.17L13.08 3.91L14.5 2.5L20 8L14.5 13.5L13.09 12.09L16.17 9H10.5C8 9 6 11 6 13.5S8 18 10.5 18Z" />
    </g>
  `}function _R(){return`
    <g data-icon="person">
      <path d="M256 288c79.5 0 144-64.5 144-144S335.5 0 256 0 112 
        64.5 112 144s64.5 144 144 144zm128 32h-55.1c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16H128C57.3 320 0 377.3 
        0 448v16c0 26.5 21.5 48 48 48h416c26.5 0 48-21.5 48-48v-16c0-70.7-57.3-128-128-128z" />
    </g>
  `}function SR(){return`
    <g transform="translate(31,25)" data-icon="mini-tree">
      <rect x="-31" y="-25" width="72" height="15" fill="rgba(0,0,0,0)"></rect>
      <g>
        <rect x="-31" y="-25" width="72" height="15" fill="rgba(0,0,0,0)"></rect>
        <line y2="-17.5" stroke="#fff" />
        <line x1="-20" x2="20" y1="-17.5" y2="-17.5" stroke="#fff" />
        <rect x="-31" y="-25" width="25" height="15" rx="5" ry="5" class="card-male" />
        <rect x="6" y="-25" width="25" height="15" rx="5" ry="5" class="card-female" />
      </g>
    </g>
  `}function AR(){return`
    <g data-icon="toggle-on">
      ${Ps()}
      <circle class="f3-small-circle" r="4" cx="18" cy="12" />
      <path d="M17,7H7A5,5 0 0,0 2,12A5,5 0 0,0 7,17H17A5,5 0 0,0 22,12A5,5 0 0,0 17,7M17,15A3,3 0 0,1 14,12A3,3 0 0,1 17,9A3,3 0 0,1 20,12A3,3 0 0,1 17,15Z" />
    </g>
  `}function kR(){return`
    <g data-icon="toggle-off">
      ${Ps()}
      <circle class="f3-small-circle" r="4" cx="6" cy="12" />
      <path d="M17,7H7A5,5 0 0,0 2,12A5,5 0 0,0 7,17H17A5,5 0 0,0 22,12A5,5 0 0,0 17,7M7,15A3,3 0 0,1 4,12A3,3 0 0,1 7,9A3,3 0 0,1 10,12A3,3 0 0,1 7,15Z" />
    </g>
  `}function ER(){return`
    <g data-icon="chevron-down">
      ${Ps()}
      <path d="M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z" />
    </g>
  `}function CR(){return`
    <g data-icon="chevron-up">
      ${Ps()}
      <path d="M7.41,15.41L12,10.83L16.59,15.41L18,14L12,8L6,14L7.41,15.41Z" />
    </g>
  `}function PR(){return`
    <g data-icon="link-off">
      ${Ps()}
      <path d="M17,7H13V8.9H17C18.71,8.9 20.1,10.29 20.1,12C20.1,13.43 19.12,14.63 17.79,15L19.25,16.44C20.88,15.61 22,13.95 
      22,12A5,5 0 0,0 17,7M16,11H13.81L15.81,13H16V11M2,4.27L5.11,7.38C3.29,8.12 2,9.91 2,12A5,5 0 0,0 7,17H11V15.1H7C5.29,15.1 
      3.9,13.71 3.9,12C3.9,10.41 5.11,9.1 6.66,8.93L8.73,11H8V13H10.73L13,15.27V17H14.73L18.74,21L20,19.74L3.27,3L2,4.27Z" />
    </g>
  `}function IR(){return`
    <g data-icon="info">
      ${Ps()}
      <path d="M13,9H11V7H13M13,17H11V11H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z" />
    </g>
  `}function yie(){return as(pR())}function vie(){return as(gR())}function TR(){return as(xR())}function LR(){return as(yR())}function MR(){return as(I4())}function RR(){return as(vR())}function $R(){return as(bR())}function bie(){return as(wR())}function OR(){return as(NR())}function FR(){return as(jR())}function T4(){return as(_R(),"0 0 512 512")}function L4(){return as(SR(),"0 0 72 25")}function DR(){return as(AR())}function qR(){return as(kR())}function BR(){return as(ER())}function wie(){return as(CR())}function zR(){return as(PR())}function UR(){return as(IR())}function as(e,t="0 0 24 24"){const n=e.match(/data-icon="([^"]+)"/),r=n?`data-icon="${n[1]}"`:"";return`
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="${t}" style="fill: currentColor" ${r}>
      ${e}
    </svg>
  `}function Ps(){return`
    <circle r="12" cx="12" cy="12" style="fill: rgba(0,0,0,0)" />
  `}var Nie=Object.freeze({__proto__:null,userIcon:pR,userEditIcon:gR,userPlusIcon:xR,userPlusCloseIcon:yR,plusIcon:I4,pencilIcon:vR,pencilOffIcon:bR,trashIcon:wR,historyBackIcon:NR,historyForwardIcon:jR,personIcon:_R,miniTreeIcon:SR,toggleIconOn:AR,toggleIconOff:kR,chevronDownIcon:ER,chevronUpIcon:CR,linkOffIcon:PR,infoIcon:IR,userSvgIcon:yie,userEditSvgIcon:vie,userPlusSvgIcon:TR,userPlusCloseSvgIcon:LR,plusSvgIcon:MR,pencilSvgIcon:RR,pencilOffSvgIcon:$R,trashSvgIcon:bie,historyBackSvgIcon:OR,historyForwardSvgIcon:FR,personSvgIcon:T4,miniTreeSvgIcon:L4,toggleSvgIconOn:DR,toggleSvgIconOff:qR,chevronDownSvgIcon:BR,chevronUpSvgIcon:wie,linkOffSvgIcon:zR,infoSvgIcon:UR});function jie(e,t){const n=document.createElement("div");return r(),n;function r(){const i=_ie(e);return n.innerHTML=i,s(),n}function s(){const i=n.querySelector("form");i.addEventListener("submit",e.onSubmit),i.querySelector(".f3-cancel-btn").addEventListener("click",h);const a=i.querySelector(".f3-edit-btn");a&&a.addEventListener("click",g);const c=i.querySelector(".f3-delete-btn");c&&e.onDelete&&c.addEventListener("click",e.onDelete);const d=i.querySelector(".f3-add-relative-btn");d&&e.addRelative&&d.addEventListener("click",()=>{e.addRelativeActive?e.addRelativeCancel():e.addRelative(),e.addRelativeActive=!e.addRelativeActive,r()});const u=i.querySelector(".f3-remove-relative-btn");u&&e.removeRelative&&u.addEventListener("click",()=>{e.removeRelativeActive?e.removeRelativeCancel():e.removeRelative(),e.removeRelativeActive=!e.removeRelativeActive,r()}),i.querySelector(".f3-close-btn").addEventListener("click",t);const m=i.querySelector(".f3-link-existing-relative select");if(m&&m.addEventListener("change",e.linkExistingRelative.onSelect),e.onFormCreation&&e.onFormCreation({cont:n,form_creator:e}),e.getKinshipInfo){const y=e.getKinshipInfo();y&&n.appendChild(y)}function h(){e.editable=!1,e.onCancel&&e.onCancel(),r()}function g(){e.editable=!e.editable,r()}}}function _ie(e){return` 
    <form id="familyForm" class="f3-form ${e.editable?"":"non-editable"}">
      ${c()}
      ${e.title?`<h3 class="f3-form-title">${e.title}</h3>`:""}
      <div style="text-align: right; display: ${e.new_rel?"none":"block"}">
        ${e.addRelative&&!e.no_edit?r():""}
        ${e.no_edit?d():s()}
      </div>

      ${i()}

      ${l()}
      
      <div class="f3-form-buttons">
        <button type="button" class="f3-cancel-btn">Cancel</button>
        <button type="submit">Submit</button>
      </div>

      ${e.linkExistingRelative?a():""}

      <hr>

      ${e.onDelete?t():""}

      ${e.removeRelative?n():""}
    </form>
  `;function t(){return`
      <div>
        <button type="button" class="f3-delete-btn" ${e.can_delete?"":"disabled"}>
          Delete
        </button>
      </div>
    `}function n(){return`
      <div>
        <button type="button" class="f3-remove-relative-btn${e.removeRelativeActive?" active":""}">
          ${e.removeRelativeActive?"Cancel Remove Relation":"Remove Relation"}
        </button>
      </div>
    `}function r(){return`
      <span class="f3-add-relative-btn">
        ${e.addRelativeActive?LR():TR()}
      </span>
    `}function s(){return`
      <span class="f3-edit-btn">
        ${e.editable?$R():RR()}
      </span>
    `}function i(){return e.editable?`
      <div class="f3-radio-group">
        ${e.gender_field.options.map(u=>`
          <label>
            <input type="radio" name="${e.gender_field.id}" 
              value="${u.value}" 
              ${u.value===e.gender_field.initial_value?"checked":""}
              ${e.gender_field.disabled?"disabled":""}
            >
            ${u.label}
          </label>
        `).join("")}
      </div>
    `:""}function l(){if(!e.editable)return f();let u="";return e.fields.forEach(m=>{m.type==="text"?u+=`
        <div class="f3-form-field">
          <label>${m.label}</label>
          <input type="${m.type}" 
            name="${m.id}" 
            value="${m.initial_value||""}"
            placeholder="${m.label}">
        </div>`:m.type==="textarea"?u+=`
        <div class="f3-form-field">
          <label>${m.label}</label>
          <textarea name="${m.id}" 
            placeholder="${m.label}">${m.initial_value||""}</textarea>
        </div>`:m.type==="select"?u+=`
        <div class="f3-form-field">
          <label>${m.label}</label>
          <select name="${m.id}" value="${m.initial_value||""}">
            <option value="">${m.placeholder||`Select ${m.label}`}</option>
            ${m.options.map(h=>`<option ${h.value===m.initial_value?"selected":""} value="${h.value}">${h.label}</option>`).join("")}
          </select>
        </div>`:m.type==="rel_reference"&&(u+=`
        <div class="f3-form-field">
          <label>${m.label} - <i>${m.rel_label}</i></label>
          <input type="text" 
            name="${m.id}" 
            value="${m.initial_value||""}"
            placeholder="${m.label}">
        </div>`)}),u;function f(){let m="";return e.fields.forEach(h=>{var g;if(h.type==="rel_reference"){if(!h.initial_value)return;m+=`
          <div class="f3-info-field">
            <span class="f3-info-field-label">${h.label} - <i>${h.rel_label}</i></span>
            <span class="f3-info-field-value">${h.initial_value||""}</span>
          </div>`}else if(h.type==="select"){if(!h.initial_value)return;m+=`
          <div class="f3-info-field">
            <span class="f3-info-field-label">${h.label}</span>
            <span class="f3-info-field-value">${((g=h.options.find(y=>y.value===h.initial_value))==null?void 0:g.label)||""}</span>
          </div>`}else m+=`
          <div class="f3-info-field">
            <span class="f3-info-field-label">${h.label}</span>
            <span class="f3-info-field-value">${h.initial_value||""}</span>
          </div>`}),m}}function a(){const u=e.linkExistingRelative.hasOwnProperty("title")?e.linkExistingRelative.title:"Profile already exists?",f=e.linkExistingRelative.hasOwnProperty("select_placeholder")?e.linkExistingRelative.select_placeholder:"Select profile",m=e.linkExistingRelative.options;return`
      <div>
        <hr>
        <div class="f3-link-existing-relative">
          <label>${u}</label>
          <select>
            <option value="">${f}</option>
            ${m.map(h=>`<option value="${h.value}">${h.label}</option>`).join("")}
          </select>
        </div>
      </div>
    `}function c(){return`
      <span class="f3-close-btn">
        
      </span>
    `}function d(){return'<div style="height: 24px;"></div>'}}function Sie(e,t,n){let r=[],s=-1;return{changed:i,back:l,forward:a,canForward:c,canBack:d};function i(){s<r.length-1&&(r=r.slice(0,s+1));const f=t();f.main_id=e.getMainId(),r.push(f),s++}function l(){d()&&(s--,u(r[s]))}function a(){c()&&(s++,u(r[s]))}function c(){return s<r.length-1}function d(){return s>0}function u(f){const m=e.getMainId();f=JSON.parse(JSON.stringify(f)),f.find(h=>h.id===m)||e.updateMainId(f.main_id),e.updateData(f),n()}}function Aie(e,t){const n=Ze.select(e).append("div").attr("class","f3-history-controls");e.insertBefore(n.node(),e.firstChild);const r=n.append("button").attr("class","f3-back-button").on("click",()=>{t.back(),i()}),s=n.append("button").attr("class","f3-forward-button").on("click",()=>{t.forward(),i()});return r.html(OR()),s.html(FR()),{back_btn:r.node(),forward_btn:s.node(),updateButtons:i,destroy:l};function i(){r.classed("disabled",!t.canBack()),s.classed("disabled",!t.canForward()),!t.canBack()&&!t.canForward()?n.style("opacity",0).style("pointer-events","none"):n.style("opacity",1).style("pointer-events","auto")}function l(){t=null,Ze.select(e).select(".f3-history-controls").remove()}}var kie=Object.freeze({__proto__:null,manualZoom:aR,getCurrentZoom:Kse,zoomTo:Jse,isAllRelativeDisplayed:oR,cardChangeMain:C4,cardEdit:P4,cardShowHideRels:mR,handleRelsOfNewDatum:rR,createNewPerson:Ji,createNewPersonWithGenderFromRel:sR,addNewPerson:k4,createTreeDataWithMainNode:iR,addNewPersonAndHandleRels:Yse,checkIfRelativesConnectedWithoutPerson:ZM,checkIfConnectedToFirstPerson:A4,createForm:Wse,syncRelReference:eR,onDeleteSyncRelReference:AN,moveToAddToAdded:tR,removeToAdd:Vg,deletePerson:n1,cleanupDataJson:Gse,removeToAddFromData:nR,formInfoSetup:jie,createHistory:Sie,createHistoryControls:Aie,treeFit:kN,calculateTreeFit:uR,cardToMiddle:dR});function HR({d:e,card_dim:t,card_display:n}){return{template:`
    <g class="card-body">
      <rect width="${t.w}" height="${t.h}" class="card-body-rect" />
      ${Eie({d:e,card_dim:t,card_display:n}).template}
    </g>
  `}}function Eie({d:e,card_dim:t,card_display:n}){return{template:`
    <g>
      <g class="card-text" clip-path="url(#card_text_clip)">
        <g transform="translate(${t.text_x}, ${t.text_y})">
          <text>
            ${Array.isArray(n)?n.map(r=>`<tspan x="0" dy="14">${r(e.data)}</tspan>`).join(`
`):n(e.data)}
          </text>
        </g>
      </g>
      <rect width="${t.w-10}" height="${t.h}" style="mask: url(#fade)" class="text-overflow-mask" /> 
    </g>
  `}}function Cie({d:e,card_dim:t,card_add:n,label:r}){return{template:`
    <g class="card-body ${n?"card_add":"card-unknown"}">
      <rect class="card-body-rect" width="${t.w}" height="${t.h}" fill="rgb(59, 85, 96)" />
      <text transform="translate(${t.w/2}, ${t.h/2})" text-anchor="middle" fill="#fff">
        <tspan font-size="18" dy="8">${r}</tspan>
      </text>
    </g>
  `}}function Pie({d:e,card_dim:t,label:n}){return{template:`
    <g class="card-body">
      <rect class="card-body-rect" width="${t.w}" height="${t.h}" />
      <text transform="translate(${t.img_w+5}, ${t.h/2})">
        <tspan font-size="18" dy="8" pointer-events="none">${n}</tspan>
      </text>
    </g>
  `}}function EN({d:e,card_dim:t,is_new:n}){return{template:`
    <rect width="${t.w}" height="${t.h}" rx="4" ry="4" class="card-outline ${e.data.main&&!n?"card-main-outline":""} ${n?"card-new-outline":""}" />
  `}}function Iie({d:e,card_dim:t,x:n,y:r}){return{template:`
    <g transform="translate(${n||t.w-20},${r||t.h-20})scale(.6)" style="cursor: pointer" class="card_edit pencil_icon">
      <circle fill="rgba(0,0,0,0)" r="17" cx="8.5" cy="8.5" />
      <path fill="currentColor" transform="translate(-1.5, -1.5)"
         d="M19.082,2.123L17.749,0.79c-1.052-1.052-2.766-1.054-3.819,0L1.925,12.794c-0.06,0.06-0.104,0.135-0.127,0.216
          l-1.778,6.224c-0.05,0.175-0.001,0.363,0.127,0.491c0.095,0.095,0.223,0.146,0.354,0.146c0.046,0,0.092-0.006,0.137-0.02
          l6.224-1.778c0.082-0.023,0.156-0.066,0.216-0.127L19.082,5.942C20.134,4.89,20.134,3.176,19.082,2.123z M3.076,13.057l9.428-9.428
          l3.738,3.739l-9.428,9.428L3.076,13.057z M2.566,13.961l3.345,3.344l-4.683,1.339L2.566,13.961z M18.375,5.235L16.95,6.66
          l-3.738-3.739l1.425-1.425c0.664-0.663,1.741-0.664,2.405,0l1.333,1.333C19.038,3.493,19.038,4.572,18.375,5.235z"/>
    </g>
  `}}function Tie({d:e,card_dim:t}){return{template:`
    <g class="card_family_tree" style="cursor: pointer">
      <rect x="-31" y="-25" width="72" height="15" fill="rgba(0,0,0,0)"></rect>
      <g transform="translate(${t.w*.8},6)scale(.9)">
        <rect x="-31" y="-25" width="72" height="15" fill="rgba(0,0,0,0)"></rect>
        <line y2="-17.5" stroke="#fff" />
        <line x1="-20" x2="20" y1="-17.5" y2="-17.5" stroke="#fff" />
        <rect x="-31" y="-25" width="25" height="15" rx="5" ry="5" class="card-male" />
        <rect x="6" y="-25" width="25" height="15" rx="5" ry="5" class="card-female" />
      </g>
    </g>
  `}}function Lie({d:e,card_dim:t,x:n,y:r}){return{template:`
    <g class="card_add_relative">
      <g transform="translate(${n||t.w/2},${r||t.h})scale(.13)">
        <circle r="80" cx="40" cy="40" fill="rgba(0,0,0,0)" />
        <g transform="translate(-10, -8)">
          <line
            x1="10" x2="90" y1="50" y2="50"
            stroke="currentColor" stroke-width="15" stroke-linecap="round"
          />
          <line
            x1="50" x2="50" y1="10" y2="90"
            stroke="currentColor" stroke-width="15" stroke-linecap="round"
          />
        </g>
      </g>
    </g>
  `}}function OS({x:e,y:t,rt:n,closed:r}){return{template:`
    <g style="
          transform: translate(-12.2px, -.5px);
          cursor: pointer;
        " 
        fill="currentColor" class="card_break_link${r?" closed":""}"
      >
      <g style="transform: translate(${e}px,${t}px)scale(.02)rotate(${n+"deg"})">
        <rect width="1000" height="700" y="150" style="opacity: 0" />
        <g class="link_upper">
          <g>
            <path d="M616.3,426.4c19,4.5,38.1-7.4,42.6-26.4c4.4-19-7.4-38-26.5-42.5L522.5,332c-18,11.1-53.9,33.4-53.9,33.4l80.4,18.6c-7.8,4.9-19.5,12.1-31.3,19.4L616.3,426.4L616.3,426.4z"/>
            <path d="M727.4,244.2c-50.2-11.6-100.3,3.3-135.7,35.4c28.6,22.6,64.5,30.2,116.4,51.3l141,32.6c23.9,5.6,56.6,47.2,51.1,71l-4.1,17c-5.6,23.7-47.3,56.4-71.2,51l-143.4-33.2c-66.8-8.6-104.1-16.6-132.9-7.5c17.4,44.9,55.9,80.8,106.5,92.4L800.9,588c81.3,18.8,162.3-31.5,181.2-112.4l4-17c18.8-81.1-31.7-161.8-112.9-180.6L727.4,244.2z"/>
          </g>
        </g>
        <g class="link_lower">
          <path d="M421.2,384.9l-128,127.6c-13.9,13.8-13.9,36.2,0,50s36.3,13.8,50.2,0.1l136.2-135.8v-36.7l-58.4,58.1V384.9L421.2,384.9z"/>
          <path d="M204.6,742.8c-17.4,17.3-63.3,17.2-80.6,0.1l-12.3-12.3c-17.3-17.3,0.6-81.2,17.9-98.5l100.2-99.9c12.5-14.9,45.8-40.8,66.1-103.7c-47.7-9.4-98.9,4.2-135.8,40.9L54.2,575c-58.9,58.8-58.9,154,0,212.8L66.6,800c58.9,58.8,154.5,58.8,213.4,0l105.8-105.6c38.4-38.3,51.3-91.9,39.7-141c-44,22.7-89,62.3-116,84.8L204.6,742.8z"/>
        </g>
        <g class="link_particles">
          <path d="M351.9,248.4l-26.5,63.4l80.6,30.1L351.9,248.4z"/>
          <path d="M529.3,208l-43,26.6l35.4,52.3L529.3,208z"/>
          <path d="M426.6,158.8l-44-2.9l61.7,134.6L426.6,158.8z"/>
        </g>
      </g>
    </g>
  `}}function Mie({d:e,card_dim:t}){let n="",r=e.data.rels,s=e.data._rels||{},i=e.data.hide_rels,l=c=>c.father||c.mother,a=c=>c.children&&c.children.length>0;if((e.is_ancestry||e.data.main)&&(l(r)||l(s))&&(n+=OS({x:t.w/2,y:0,rt:-45,closed:i}).template),!e.is_ancestry&&e.added){const c=e.spouse,d=c.data.rels,u=c.data._rels||{};(a(r)||a(s))&&(a(d)||a(u))&&(n+=OS({x:e.sx-e.x+t.w/2+24.4,y:(e.x!==e.sx?t.h/2:t.h)+1,rt:135,closed:i}).template)}return{template:n}}function Rie({d:e,image:t,card_dim:n,maleIcon:r,femaleIcon:s}){return{template:`
    <g style="transform: translate(${n.img_x}px,${n.img_y}px);" class="card_image" clip-path="url(#card_image_clip)">
      ${t?`<image href="${t}" height="${n.img_h}" width="${n.img_w}" preserveAspectRatio="xMidYMin slice" />`:(e.data.data.gender,e.data.data.gender,i())}      
    </g>
  `};function i(){return`
      <g class="genderless-icon">
        <rect height="${n.img_h}" width="${n.img_w}" fill="rgb(59, 85, 96)" />
        <g transform="scale(${n.img_w*.001616})">
         <path transform="translate(50,40)" fill="lightgrey" d="M256 288c79.5 0 144-64.5 144-144S335.5 0 256 0 112 
            64.5 112 144s64.5 144 144 144zm128 32h-55.1c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16H128C57.3 320 0 377.3 
            0 448v16c0 26.5 21.5 48 48 48h416c26.5 0 48-21.5 48-48v-16c0-70.7-57.3-128-128-128z" />
        </g>
      </g>
    `}}function Vf(e,t,n){const r=document.createElementNS("http://www.w3.org/2000/svg","g");r.innerHTML=e,n?t.insertBefore(r,t.firstChild):t.appendChild(r)}const uo={miniTree:$ie,lineBreak:Oie,cardBody:Fie,cardImage:Die,cardEdit:qie,cardAdd:Bie};function $ie(e,t){if(e.data.to_add)return;const n=t.card_dim;if(e.all_rels_displayed)return;const r=Ze.create("svg:g").html(Tie({d:e,card_dim:n}).template);return r.on("click",function(s){s.stopPropagation(),t.onMiniTreeClick?t.onMiniTreeClick.call(this,s,e):C4(t.store,{d:e})}),r.node()}function Oie(e,t){if(e.data.to_add)return;const n=t.card_dim,r=Ze.create("svg:g").html(Mie({d:e,card_dim:n}).template);return r.on("click",s=>{s.stopPropagation(),mR(t.store,{d:e})}),r.node()}function Fie(e,t){const n=t.cardEditForm?"ADD":"UNKNOWN",r=t.card_dim;let s;return e.data.to_add?(s=Ze.create("svg:g").html(Cie({d:e,card_dim:r,card_add:t.cardEditForm,label:n}).template),s.on("click",i=>{i.stopPropagation(),P4(t.store,{d:e,cardEditForm:t.cardEditForm})})):(s=Ze.create("svg:g").html(HR({d:e,card_dim:r,card_display:t.card_display}).template),s.on("click",function(i){i.stopPropagation(),t.onCardClick?t.onCardClick.call(this,i,e):C4(t.store,{d:e})})),s.node()}function Die(e,t){if(e.data.to_add)return;const n=t.card_dim;return Ze.create("svg:g").html(Rie({d:e,image:e.data.data.avatar||null,card_dim:n,maleIcon:null,femaleIcon:null}).template).node()}function qie(e,t){if(e.data.to_add)return;const n=t.card_dim,r=Ze.create("svg:g").html(Iie({card_dim:n,x:n.w-46,y:n.h-20}).template);return r.on("click",s=>{s.stopPropagation(),P4(t.store,{d:e,cardEditForm:t.cardEditForm})}),r.node()}function Bie(e,t){if(e.data.to_add)return;const n=t.card_dim,r=Ze.create("svg:g").html(Lie({card_dim:n,x:n.w-26,y:n.h-20}).template);return r.on("click",s=>{s.stopPropagation(),t.addRelative({d:e})}),r.node()}function Sa(e,t,n){e&&(n?t.insertBefore(e,t.firstChild):t.appendChild(e))}function M4(e,t){if(e.querySelector("defs#f3CardDef"))return;e.insertAdjacentHTML("afterbegin",`
      <defs id="f3CardDef">
        <linearGradient id="fadeGrad">
          <stop offset="0.9" stop-color="white" stop-opacity="0"/>
          <stop offset=".91" stop-color="white" stop-opacity=".5"/>
          <stop offset="1" stop-color="white" stop-opacity="1"/>
        </linearGradient>
        <mask id="fade" maskContentUnits="objectBoundingBox"><rect width="1" height="1" fill="url(#fadeGrad)"/></mask>
        <clipPath id="card_clip"><path d="${n({w:t.w,h:t.h},5)}"></clipPath>
        <clipPath id="card_text_clip"><rect width="${t.w-10}" height="${t.h}"></rect></clipPath>
        <clipPath id="card_image_clip"><path d="M0,0 Q 0,0 0,0 H${t.img_w} V${t.img_h} H0 Q 0,${t.img_h} 0,${t.img_h} z"></clipPath>
        <clipPath id="card_image_clip_curved"><path d="${n({w:t.img_w,h:t.img_h},5,["rx","ry"])}"></clipPath>
      </defs>
    `);function n(r,s,i){const{w:l,h:a}=r,c=s,d=i||[],u=y=>d.includes(y),f=u("lx")?"M0,0":`M0,${c} Q 0,0 5,0`,m=u("rx")?`H${l}`:`H${l-c} Q ${l},0 ${l},5`,h=u("ry")?`V${a}`:`V${a-c} Q ${l},${a} ${l-c},${a}`,g=u("ly")?"H0":`H${c} Q 0,${a} 0,${a-c}`;return`${f} ${m} ${h} ${g} z`}}function zie(e,t){e.querySelector("defs#f3CardDef")&&e.querySelector("defs#f3CardDef").remove(),M4(e,t)}function Uie(e){return e=t(e),M4(e.svg,e.card_dim),function(n){const r=n.data.data.gender==="M"?"card-male":n.data.data.gender==="F"?"card-female":"card-genderless",s=e.card_dim,i=Ze.create("svg:g").attr("class",`card ${r}`).attr("transform",`translate(${[-s.w/2,-s.h/2]})`);i.append("g").attr("class","card-inner").attr("clip-path","url(#card_clip)"),this.innerHTML="",this.appendChild(i.node()),Vf(EN({d:n,card_dim:s,is_new:n.data.to_add}).template,i.node(),!0),Sa(uo.cardBody(n,e),this.querySelector(".card-inner")),e.img&&Sa(uo.cardImage(n,e),this.querySelector(".card")),e.mini_tree&&Sa(uo.miniTree(n,e),this.querySelector(".card"),!0),e.link_break&&Sa(uo.lineBreak(n,e),this.querySelector(".card")),e.cardEditForm&&(Sa(uo.cardEdit(n,e),this.querySelector(".card-inner")),Sa(uo.cardAdd(n,e),this.querySelector(".card-inner"))),e.onCardUpdates&&e.onCardUpdates.map(l=>l.call(this,n)),e.onCardUpdate&&e.onCardUpdate.call(this,n)};function t(n){const r={img:!0,mini_tree:!0,link_break:!1,card_dim:{w:220,h:70,text_x:75,text_y:15,img_w:60,img_h:60,img_x:5,img_y:5}};n||(n={});for(const s in r)typeof n[s]>"u"&&(n[s]=r[s]);return n}}function Hie(e,t,n,r){if(!t.hasOwnProperty("_toggle"))return;const s=e.querySelector(".card"),i=s.querySelector(".card-inner"),l=e.querySelector(".card").offsetWidth;e.querySelector(".card").offsetHeight;let a,c;const d={};if(t.spouse){const f=t.spouse,m=f.data.main?"main":f.parent.data.id;if(a=f.data._tgdp_sp[m][t.data.id]<0,d.top=60,d.left=t.sx-t.x-30+l/2,n&&(d.top=t.sy-t.x+4,d.left=l/2+4,Math.abs(t.sx-t.y)<10&&(d.left=l-4)),c=f._toggle_id_sp?f._toggle_id_sp[t.data.id]:-1,c===-1)return}else{const f=t.data.main?"main":t.parent.data.id;a=t.data._tgdp[f]<0,d.top=-65,d.left=-30+l/2,n&&(d.top=5,d.left=-55),c=t._toggle_id}if(i.style.zIndex=1,Ze.select(s).append("div").attr("class","f3-toggle-div").attr("style","cursor: pointer; width: 60px; height: 60px;position: absolute; z-index: -1;").style("top",d.top+"px").style("left",d.left+"px").on("click",f=>{if(f.stopPropagation(),t.spouse){const m=t.spouse,h=m.data.main?"main":m.parent.data.id;m.data._tgdp_sp[h].hasOwnProperty(t.data.id)||console.error("no toggle",t,m);let g=m.data._tgdp_sp[h][t.data.id];g<0?g=new Date().getTime():g=-new Date().getTime(),m.data._tgdp_sp[h][t.data.id]=g}else{const m=t.data.main?"main":t.parent.data.id;let h=t.data._tgdp[m];h<0?h=new Date().getTime():h=-new Date().getTime(),t.data._tgdp[m]=h}r()}).append("div").html(a?qR():DR()).select("svg").classed("f3-toggle-icon",!0).style("color",a?"#585656":"#61bf52").style("padding","0"),Ze.select(s).select(".f3-toggle-icon .f3-small-circle").style("fill","#fff"),Ze.select(s).select(".f3-toggle-icon").append("text").attr("transform",a?"translate(10.6, 14.5)":"translate(4.1, 14.5)").attr("fill","#fff").attr("font-size","7px").text("C"+c),a){let f;t.is_ancestry?n?f="translate(5, -30)rotate(-90)":f="translate(0, -10)":n?f="translate(11, -22)rotate(90)":f="translate(-7, -32)rotate(180)",Ze.select(s).select(".f3-toggle-div").insert("div").html(L4()).select("svg").attr("style","position: absolute; z-index: -1;top: 0;left: 0;border-radius: 0;").style("width","66px").style("height","112px").attr("transform",f).attr("viewBox","0 0 72 125").select("line").attr("y1",t.is_ancestry?"62":"92")}}function Vie(e){const t=e.style==="default"?d:e.style==="imageCircleRect"?c:e.style==="imageCircle"?u:e.style==="imageRect"?f:e.style==="rect"?m:d;return function(w){if(this.innerHTML=`
    <div class="card ${h(w).join(" ")}" data-id="${w.tid}" style="transform: translate(-50%, -50%); pointer-events: auto;">
      ${e.mini_tree?a(w):""}
      ${e.cardInnerHtmlCreator&&!w.data._new_rel_data?e.cardInnerHtmlCreator(w):t(w)}
    </div>
    `,this.querySelector(".card").addEventListener("click",N=>e.onCardClick(N,w)),e.onCardUpdate&&e.onCardUpdate.call(this,w),e.onCardMouseenter&&Ze.select(this).select(".card").on("mouseenter",N=>e.onCardMouseenter(N,w)),e.onCardMouseleave&&Ze.select(this).select(".card").on("mouseleave",N=>e.onCardMouseleave(N,w)),w.duplicate&&b(this,w),e.duplicate_branch_toggle&&Hie(this,w,e.store.state.is_horizontal,e.store.updateTree),location.origin.includes("localhost")&&(w.__node=this.querySelector(".card"),w.__label=w.data.data["first name"],w.data.to_add)){const N=w.spouse||w._spouse||null;N&&Ze.select(this).select(".card").attr("data-to-add",N.data.data["first name"])}};function n(w){return`
    <div class="card-inner card-image-circle" ${g()}>
      ${w.data.data[e.cardImageField]?`<img src="${w.data.data[e.cardImageField]}" ${y()}>`:p(w)}
      <div class="card-label">${i(w)}</div>
      ${w.duplicate?x(w):""}
    </div>
    `}function r(w){return`
    <div class="card-inner card-image-rect" ${g()}>
      ${w.data.data[e.cardImageField]?`<img src="${w.data.data[e.cardImageField]}" ${y()}>`:p(w)}
      <div class="card-label">${i(w)}</div>
      ${w.duplicate?x(w):""}
    </div>
    `}function s(w){return`
    <div class="card-inner card-rect" ${g()}>
      ${i(w)}
      ${w.duplicate?x(w):""}
    </div>
    `}function i(w){return w.data._new_rel_data?l(w):w.data.to_add?`<div>${e.empty_card_label||"ADD"}</div>`:w.data.unknown?`<div>${e.unknown_card_label||"UNKNOWN"}</div>`:`
      ${e.card_display.map(N=>`<div>${N(w.data)}</div>`).join("")}
    `}function l(w){const N=[];return N.push(`data-rel-type="${w.data._new_rel_data.rel_type}"`),["son","daughter"].includes(w.data._new_rel_data.rel_type)&&N.push(`data-other-parent-id="${w.data._new_rel_data.other_parent_id}"`),`<div ${N.join(" ")}>${w.data._new_rel_data.label}</div>`}function a(w){return!e.mini_tree||w.data.to_add||w.data._new_rel_data||w.all_rels_displayed?"":`<div class="mini-tree">${L4()}</div>`}function c(w){return w.data.data[e.cardImageField]?u(w):m(w)}function d(w){return r(w)}function u(w){return n(w)}function f(w){return r(w)}function m(w){return s(w)}function h(w){const N=[];return w.data.data.gender==="M"?N.push("card-male"):w.data.data.gender==="F"?N.push("card-female"):N.push("card-genderless"),N.push(`card-depth-${w.is_ancestry?-w.depth:w.depth}`),w.data.main&&N.push("card-main"),w.data._new_rel_data&&N.push("card-new-rel"),w.data.to_add&&N.push("card-to-add"),w.data.unknown&&N.push("card-unknown"),N}function g(){let w='style="';if(e.card_dim.w||e.card_dim.h)w+=`width: ${e.card_dim.w}px; min-height: ${e.card_dim.h}px;`,e.card_dim.height_auto?w+="height: auto;":w+=`height: ${e.card_dim.h}px;`;else return"";return w+='"',w}function y(){let w='style="position: relative;';if(e.card_dim.img_w||e.card_dim.img_h||e.card_dim.img_x||e.card_dim.img_y)w+=`width: ${e.card_dim.img_w}px; height: ${e.card_dim.img_h}px;`,w+=`left: ${e.card_dim.img_x}px; top: ${e.card_dim.img_y}px;`;else return"";return w+='"',w}function p(w){return w.data._new_rel_data?`<div class="person-icon" ${y()}>${MR()}</div>`:`<div class="person-icon" ${y()}>${e.defaultPersonIcon?e.defaultPersonIcon(w):T4()}</div>`}function x(w){return`<div class="f3-card-duplicate-tag">x${w.duplicate}</div>`}function b(w,N){Ze.select(w).on("mouseenter",k=>{Ze.select(w.closest(".cards_view")).selectAll(".card_cont").select(".card").classed("f3-card-duplicate-hover",I=>I.data.id===N.data.id)}),Ze.select(w).on("mouseleave",k=>{Ze.select(w.closest(".cards_view")).selectAll(".card_cont").select(".card").classed("f3-card-duplicate-hover",!1)})}}function Wie(e){return e=t(e),M4(e.svg,e.card_dim),function(n){const r=n.data.data.gender==="M"?"card-male":n.data.data.gender==="F"?"card-female":"card-genderless",s=e.card_dim,i=Ze.create("svg:g").attr("class",`card ${r}`).attr("transform",`translate(${[-s.w/2,-s.h/2]})`);i.append("g").attr("class","card-inner").attr("clip-path","url(#card_clip)"),this.innerHTML="",this.appendChild(i.node()),i.on("click",function(l){l.stopPropagation(),e.onCardClick.call(this,l,n)}),n.data._new_rel_data?(Vf(EN({d:n,card_dim:s,is_new:n.data.to_add}).template,i.node(),!0),Vf(Pie({d:n,card_dim:s,label:n.data._new_rel_data.label}).template,this.querySelector(".card-inner"),!0),Ze.select(this.querySelector(".card-inner")).append("g").attr("class","card-edit-icon").attr("fill","currentColor").attr("transform",`translate(-1,2)scale(${s.img_h/22})`).html(I4())):(Vf(EN({d:n,card_dim:s,is_new:n.data.to_add}).template,i.node(),!0),Vf(HR({d:n,card_dim:s,card_display:e.card_display}).template,this.querySelector(".card-inner")),e.img&&Sa(uo.cardImage(n,e),this.querySelector(".card")),e.mini_tree&&Sa(uo.miniTree(n,e),this.querySelector(".card"),!0),e.link_break&&Sa(uo.lineBreak(n,e),this.querySelector(".card"))),e.onCardUpdate&&e.onCardUpdate.call(this,n)};function t(n){const r={img:!0,mini_tree:!0,link_break:!1,card_dim:{w:220,h:70,text_x:75,text_y:15,img_w:60,img_h:60,img_x:5,img_y:5}};n||(n={});for(const s in r)typeof n[s]>"u"&&(n[s]=r[s]);return n}}function Gie(...e){return new _d(...e)}function _d(e,t){this.cont=e,this.popup_cont=null,this.active=!1,this.onClose=t,this.init()}_d.prototype.init=function(){this.popup_cont=Ze.select(this.cont).append("div").attr("class","f3-popup").node(),this.create()};_d.prototype.create=function(){const e=Ze.select(this.popup_cont);e.html(`
    <div class="f3-popup-content">
      <span class="f3-popup-close">&times;</span>
      <div class="f3-popup-content-inner"></div>
    </div>
  `),e.select(".f3-popup-close").on("click",()=>{this.close()}),e.on("click",t=>{t.target==e.node()&&this.close()})};_d.prototype.activate=function(e){e&&Ze.select(this.popup_cont).select(".f3-popup-content-inner").node().appendChild(e),this.open()};_d.prototype.open=function(){this.active=!0};_d.prototype.close=function(){this.popup_cont.remove(),this.active=!1,this.onClose&&this.onClose()};var Yie=Object.freeze({__proto__:null,infoPopup:Gie,appendElement:Sa,Card:Uie,CardHtml:Vie,CardSvg:Wie}),Xie=(...e)=>new Sd(...e);function Sd(e,t,n){return this.store=e,this.onActivate=t,this.cancelCallback=n,this.datum=null,this.onChange=null,this.onCancel=null,this.is_active=!1,this.addRelLabels=this.addRelLabelsDefault(),this}Sd.prototype.activate=function(e){this.is_active&&this.onCancel(),this.onActivate(),this.is_active=!0,this.store.state.one_level_rels=!0;const t=this.store;this.datum=e;let n=this.datum.data.gender;Kie(e,this.getStoreData(),this.addRelLabels),t.updateTree({}),this.onChange=r.bind(this),this.onCancel=s.bind(this);function r(i,l){i!=null&&i._new_rel_data?l!=null&&l.link_rel_id?QM(i,l.link_rel_id,t.getData()):delete i._new_rel_data:i.id===e.id?i.data.gender!==n&&a():console.error("Something went wrong");function a(){n=i.data.gender,t.getData().forEach(d=>{const u=d._new_rel_data;u&&(u.rel_type==="spouse"&&(d.data.gender=d.data.gender==="M"?"F":"M"),["son","daughter"].includes(u.rel_type)&&([d.rels.father,d.rels.mother]=[d.rels.mother,d.rels.father]))})}}function s(){this.is_active&&(this.is_active=!1,this.store.state.one_level_rels=!1,this.cleanUp(),this.cancelCallback(this.datum),this.datum=null,this.onChange=null,this.onCancel=null)}};Sd.prototype.setAddRelLabels=function(e){if(typeof e!="object"){console.error("add_rel_labels must be an object");return}for(let t in e)this.addRelLabels[t]=e[t];return this};Sd.prototype.addRelLabelsDefault=function(){return{father:"Add Father",mother:"Add Mother",spouse:"Add Spouse",son:"Add Son",daughter:"Add Daughter"}};Sd.prototype.getStoreData=function(){return this.store.getData()};Sd.prototype.cleanUp=function(e){e||(e=this.store.getData());for(let t=e.length-1;t>=0;t--){const n=e[t];n._new_rel_data&&(e.forEach(r=>{r.rels.father===n.id&&delete r.rels.father,r.rels.mother===n.id&&delete r.rels.mother,(r.rels.children||[]).includes(n.id)&&r.rels.children.splice(r.rels.children.indexOf(n.id),1),(r.rels.spouses||[]).includes(n.id)&&r.rels.spouses.splice(r.rels.spouses.indexOf(n.id),1)}),e.splice(t,1))}return e};function Kie(e,t,n){if(!e.rels.father){const a=Ji({data:{gender:"M"},rels:{children:[e.id]}});a._new_rel_data={rel_type:"father",label:n.father,rel_id:e.id},e.rels.father=a.id,t.push(a)}if(!e.rels.mother){const a=Ji({data:{gender:"F"},rels:{children:[e.id]}});a._new_rel_data={rel_type:"mother",label:n.mother,rel_id:e.id},e.rels.mother=a.id,t.push(a)}const r=t.find(a=>a.id===e.rels.mother),s=t.find(a=>a.id===e.rels.father);if(r.rels.spouses||(r.rels.spouses=[]),s.rels.spouses||(s.rels.spouses=[]),r.rels.spouses.includes(s.id)||r.rels.spouses.push(s.id),s.rels.spouses.includes(r.id)||s.rels.spouses.push(r.id),r.rels.children||(r.rels.children=[]),s.rels.children||(s.rels.children=[]),r.rels.children.includes(e.id)||r.rels.children.push(e.id),s.rels.children.includes(e.id)||s.rels.children.push(e.id),e.rels.spouses||(e.rels.spouses=[]),e.rels.children){let a;e.rels.children.forEach(c=>{const d=t.find(u=>u.id===c);d.rels.mother||(a||(a=Ji({data:{gender:"F"},rels:{spouses:[e.id],children:[]}})),a._new_rel_data={rel_type:"spouse",label:n.spouse,rel_id:e.id},a.rels.children.push(d.id),e.rels.spouses.push(a.id),d.rels.mother=a.id,t.push(a)),d.rels.father||(a||(a=Ji({data:{gender:"M"},rels:{spouses:[e.id],children:[]}})),a._new_rel_data={rel_type:"spouse",label:n.spouse,rel_id:e.id},a.rels.children.push(d.id),e.rels.spouses.push(a.id),d.rels.father=a.id,t.push(a))})}const i=e.data.gender==="M"?"F":"M",l=Ji({data:{gender:i},rels:{spouses:[e.id]}});return l._new_rel_data={rel_type:"spouse",label:n.spouse,rel_id:e.id},e.rels.spouses.push(l.id),t.push(l),e.rels.children||(e.rels.children=[]),e.rels.spouses.forEach(a=>{const c=t.find(h=>h.id===a),d=e.data.gender==="M"?c.id:e.id,u=e.data.gender==="F"?c.id:e.id;c.rels.children||(c.rels.children=[]);const f=Ji({data:{gender:"M"},rels:{father:u,mother:d}});f._new_rel_data={rel_type:"son",label:n.son,other_parent_id:c.id,rel_id:e.id},c.rels.children.push(f.id),e.rels.children.push(f.id),t.push(f);const m=Ji({data:{gender:"F"},rels:{mother:d,father:u}});m._new_rel_data={rel_type:"daughter",label:n.daughter,other_parent_id:c.id,rel_id:e.id},c.rels.children.push(m.id),e.rels.children.push(m.id),t.push(m)}),t}var Jie=(...e)=>new VR(...e);function VR(e,t,n,r){return this.store=e,this.onActivate=t,this.cancelCallback=n,this.modal=r,this.datum=null,this.onChange=null,this.onCancel=null,this.is_active=!1,this}VR.prototype.activate=function(e){this.is_active&&this.onCancel(),this.onActivate(),this.is_active=!0,this.store.state.one_level_rels=!0;const t=this.store;this.datum=e,t.updateTree({}),this.onChange=n.bind(this),this.onCancel=r.bind(this);function n(s,i){const l=m(s),a=e.rels;l==="father"?c.call(this):l==="mother"?d.call(this):l==="spouse"?u.call(this):l==="children"&&f.call(this);function c(){const h=t.getDatum(a.father);h.rels.children=h.rels.children.filter(g=>g!==e.id),a.father=null,i()}function d(){const h=t.getDatum(a.mother);h.rels.children=h.rels.children.filter(g=>g!==e.id),a.mother=null,i()}function u(){const h=s.data;g()?y.call(this):p.call(this,!0);function g(){return(h.rels.children||[]).some(b=>{const w=t.getDatum(b);return w.rels.father===h.id||w.rels.mother===h.id})}function y(){const x=e.data.gender==="M"?"f3-male-bg":e.data.gender==="F"?"f3-female-bg":null,b=h.data.gender==="M"?"f3-male-bg":h.data.gender==="F"?"f3-female-bg":null,w=Ze.create("div").html(`
          <p>You are removing a spouse relationship. Since there are shared children, please choose which parent should keep them in the family tree.</p>
          <div class="f3-modal-options">
            <button data-option="assign-to-current" class="f3-btn ${x}">Keep children with current person</button>
            <button data-option="assign-to-spouse" class="f3-btn ${b}">Keep children with spouse</button>
          </div>
        `);w.selectAll('[data-option="assign-to-current"]').on("click",()=>{p(!0),this.modal.close()}),w.selectAll('[data-option="assign-to-spouse"]').on("click",()=>{p(!1),this.modal.close()}),this.modal.activate(w.node())}function p(x){s.data.rels.spouses=s.data.rels.spouses.filter(N=>N!==e.id),a.spouses=a.spouses.filter(N=>N!==s.data.id);const b=x?e:s.data,w=x?s.data:e;(a.children||[]).forEach(N=>{const k=t.getDatum(N);k.rels.father===w.id&&(k.rels.father=null),k.rels.mother===w.id&&(k.rels.mother=null)}),w.rels.children&&(w.rels.children=w.rels.children.filter(N=>!(b.rels.children||[]).includes(N))),i()}}function f(){a.children=a.children.filter(g=>g!==s.data.id);const h=s.data.rels.father===e.id?"father":"mother";s.data.rels[h]=null,i()}function m(h){if(h.is_ancestry){if(e.rels.father===h.data.id)return"father";if(e.rels.mother===h.data.id)return"mother"}else if(h.spouse){if(e.rels.spouses.includes(h.data.id))return"spouse"}else if(e.rels.children.includes(h.data.id))return"children";return null}}function r(){this.is_active&&(this.is_active=!1,this.store.state.one_level_rels=!1,this.cancelCallback(this.datum),this.datum=null,this.onChange=null,this.onCancel=null)}};function Zie(...e){return new $c(...e)}function $c(e){this.cont=e,this.modal_cont=null,this.active=!1,this.onClose=null,this.init()}$c.prototype.init=function(){this.modal_cont=Ze.select(this.cont).append("div").attr("class","f3-modal").node(),Ze.select(this.modal_cont).style("display","none"),this.create()};$c.prototype.create=function(){const e=Ze.select(this.modal_cont);e.html(`
    <div class="f3-modal-content">
      <span class="f3-modal-close">&times;</span>
      <div class="f3-modal-content-inner"></div>
      <div class="f3-modal-content-bottom"></div>
    </div>
  `),e.select(".f3-modal-close").on("click",()=>{this.close()}),e.on("click",t=>{t.target==e.node()&&this.close()})};$c.prototype.activate=function(e,{boolean:t,onAccept:n,onCancel:r}={}){this.reset(),typeof e=="string"?Ze.select(this.modal_cont).select(".f3-modal-content-inner").html(e):Ze.select(this.modal_cont).select(".f3-modal-content-inner").node().appendChild(e),t&&(Ze.select(this.modal_cont).select(".f3-modal-content-bottom").html(`
      <button class="f3-modal-accept f3-btn">Accept</button>
      <button class="f3-modal-cancel f3-btn">Cancel</button>
    `),Ze.select(this.modal_cont).select(".f3-modal-accept").on("click",()=>{n(),this.reset(),this.close()}),Ze.select(this.modal_cont).select(".f3-modal-cancel").on("click",()=>{this.close()}),this.onClose=r),this.open()};$c.prototype.reset=function(){this.onClose=null,Ze.select(this.modal_cont).select(".f3-modal-content-inner").html(""),Ze.select(this.modal_cont).select(".f3-modal-content-bottom").html("")};$c.prototype.open=function(){this.modal_cont.style.display="block",this.active=!0};$c.prototype.close=function(){this.modal_cont.style.display="none",this.active=!1,this.onClose&&this.onClose()};function WR(e,t,n={}){const r=t.find(u=>u.id===e),s={};return i(r.id,"self",0),l(s),n.show_in_law&&a(s,t),c(s),s;function i(u,f,m,h=void 0){if(!u||(s[u]&&s[u]!==f&&console.error("kinship mismatch, kinship 1: ",s[u],"kinship 2: ",f),s[u]))return;f&&(s[u]=f);const y=t.find(p=>p.id===u).rels;if(f==="self")i(y.father,"parent",m-1,u),i(y.mother,"parent",m-1,u),(y.spouses||[]).forEach(p=>i(p,"spouse",m)),(y.children||[]).forEach(p=>i(p,"child",m+1));else if(f==="parent")i(y.father,"grandparent",m-1,u),i(y.mother,"grandparent",m-1,u),(y.children||[]).forEach(p=>{h&&h===p||i(p,"sibling",m+1)});else if(f!=="spouse")if(f==="child")(y.children||[]).forEach(p=>i(p,"grandchild",m+1));else if(f==="sibling")(y.children||[]).forEach(p=>i(p,"nephew",m+1));else if(f==="grandparent")h||console.error(`${f} should have prev_rel_id`),i(y.father,"great-grandparent",m-1,u),i(y.mother,"great-grandparent",m-1,u),(y.children||[]).forEach(p=>{h&&h===p||i(p,"uncle",m+1)});else if(f.includes("grandchild"))(y.children||[]).forEach(p=>i(p,Nf(f,m+1),m+1));else if(f.includes("great-grandparent"))h||console.error(`${f} should have prev_rel_id`),i(y.father,Nf(f,m-1),m-1,u),i(y.mother,Nf(f,m-1),m-1,u),(y.children||[]).forEach(p=>{if(h&&h===p)return;const x=XR(m+1);x===0?i(p,"granduncle",m+1):x>0?i(p,Nf("granduncle",m+1),m+1):console.error(`${f} should have great_count > -1`)});else if(f==="nephew")(y.children||[]).forEach(p=>i(p,"grandnephew",m+1));else if(f.includes("grandnephew"))(y.children||[]).forEach(p=>i(p,Nf(f,m+1),m+1));else if(f==="uncle")(y.children||[]).forEach(p=>i(p,"1st Cousin",m+1));else if(f==="granduncle")(y.children||[]).forEach(p=>i(p,"1st Cousin 1x removed",m+1));else if(f.includes("great-granduncle")){const p=m+1,x=Math.abs(p);(y.children||[]).forEach(b=>i(b,`1st Cousin ${x}x removed`,p))}else f.slice(4).startsWith("Cousin")?(y.children||[]).forEach(p=>{const x=m+1,b=Math.abs(x),w=+f[0];x===0?i(p,`${Wx(w+1)} Cousin`,x):x<0?i(p,`${Wx(w+1)} Cousin ${b}x removed`,x):x>0&&i(p,`${Wx(w)} Cousin ${b}x removed`,x)}):console.error(`${f} not found`)}function l(u){const f=[];Object.keys(u).forEach(m=>{const h=u[m];if(h.includes("child")||h==="spouse")return;const g=GR(r.id,m,t);if(!g)return console.error(`${t.find(y=>y.id===m).data} not found in main_ancestry`);g.is_half_kin&&f.push(m)}),f.forEach(m=>{u[m]=`Half ${u[m]}`})}function a(u,f){Object.keys(u).forEach(m=>{const h=u[m],g=f.find(y=>y.id===m);if(h==="spouse"){const y=[];g.rels.mother&&(d(g.rels.mother).rels.children||[]).forEach(p=>y.push(p)),g.rels.father&&(d(g.rels.father).rels.children||[]).forEach(p=>y.push(p)),y.forEach(p=>{u[p]||(u[p]="sibling-in-law")})}h==="sibling"&&(g.rels.spouses||[]).forEach(y=>{u[y]||(u[y]="sibling-in-law")}),h==="child"&&(g.rels.spouses||[]).forEach(y=>{u[y]||(u[y]="child-in-law")}),h==="uncle"&&(g.rels.spouses||[]).forEach(y=>{u[y]||(u[y]="uncle-in-law")}),h.includes("Cousin")&&(g.rels.spouses||[]).forEach(y=>{u[y]||(u[y]=`${h} in-law`)})})}function c(u){Object.keys(u).forEach(f=>{const m=u[f],g=t.find(y=>y.id===f).data.gender;if(m.includes("parent")){const p=g==="M"?"father":g==="F"?"mother":"parent";u[f]=u[f].replace("parent",p)}else if(m.includes("sibling")){const p=g==="M"?"brother":g==="F"?"sister":"sibling";u[f]=u[f].replace("sibling",p)}else if(m.includes("child")){const p=g==="M"?"son":g==="F"?"daughter":"child";u[f]=u[f].replace("child",p)}else if(m.includes("uncle")){const p=g==="M"?"uncle":g==="F"?"aunt":"aunt/uncle";u[f]=u[f].replace("uncle",p)}else if(m.includes("nephew")){const p=g==="M"?"nephew":g==="F"?"niece":"neice/nephew";u[f]=u[f].replace("nephew",p)}})}function d(u){return t.find(f=>f.id===u)}}function GR(e,t,n){const r=c(e);let s,i,l;if(u(t),f(t),a(t),!s)return null;return{found:s,is_ancestor:i,is_half_kin:l};function a(h){if(s)return;if(h===e){i=!0,s=h,l=!1;return}const y=n.find(b=>b.id===h).rels,p=d(y),x=r.find(b=>b[0]&&p[0]&&b[0]===p[0]||b[1]&&p[1]&&b[1]===p[1]);if(x){s=p.filter((b,w)=>b===x[w]),l=m(p,x);return}y.father&&a(y.father),y.mother&&a(y.mother)}function c(h){const g=[];return y(h),g;function y(p){const b=n.find(w=>w.id===p).rels;g.push(d(b)),b.father&&y(b.father),b.mother&&y(b.mother)}}function d(h){return[h.father,h.mother]}function u(h){const g=n.find(p=>p.id===h);r.find(p=>p[0]===g.id||p[1]===g.id)&&(i=!0,s=h,l=!1)}function f(h){(n.find(y=>y.id===e).rels.spouses||[]).includes(h)&&(s=[e,h])}function m(h,g){return h[0]!==g[0]||h[1]!==g[1]}}function YR(e,t,n,r){let s;const i=r[t].toLowerCase();if(i.includes("in-law")){s=t;const I=n.find(R=>R.id===s);i.includes("sister")||i.includes("brother")?t=e:t=I.rels.spouses.find(R=>r[R]&&!r[R].includes("in-law"))}const l=GR(e,t,n);if(!l)return console.error(`${t} not found in main_ancestry`);const a=l.is_ancestor?l.found:l.found[0],c=n.find(I=>I.id===a),d=Ze.hierarchy(c,y),u=d.descendants().map(I=>I.data.id),f=p(e,u),m=p(t,u);g(d);const h=d.descendants().map(I=>{const R={id:I.data.id,data:JSON.parse(JSON.stringify(I.data.data)),kinship:r[I.data.id],rels:{}};return I.children&&I.children.length>0&&(R.rels.children=I.children.map(T=>T.data.id)),R});return h.length>0&&!l.is_ancestor&&!l.is_half_kin&&x(h),s&&b(h),h;function g(I){I.children=(I.children||[]).filter(R=>!!(f.includes(R.data.id)||m.includes(R.data.id))),I.children.forEach(R=>g(R)),I.children.length===0&&delete I.children}function y(I){return[...I.rels.children||[]].map(T=>n.find(S=>S.id===T))}function p(I,R){const T=[I];return S(I),T;function S(E){const M=n.find(A=>A.id===E).rels;R.includes(M.mother)&&(T.push(M.mother),S(M.mother)),R.includes(M.father)&&(T.push(M.father),S(M.father))}}function x(I){const R=I[0],T=a===l.found[0]?l.found[1]:l.found[0];R.rels.spouses=[T];const S=n.find(_=>_.id===T),E={id:S.id,data:JSON.parse(JSON.stringify(S.data)),kinship:r[S.id],rels:{spouses:[R.id],children:R.rels.children}};I.push(E),(R.rels.children||[]).forEach(_=>{const M=n.find(P=>P.id===_),A=I.find(P=>P.id===_);A.rels.father=M.rels.father,A.rels.mother=M.rels.mother})}function b(I){i.includes("sister")||i.includes("brother")?N(I):w(I)}function w(I){const R=I.find(_=>_.id===t),T=s;R.rels.spouses=[T];const S=n.find(_=>_.id===T),E={id:S.id,data:JSON.parse(JSON.stringify(S.data)),kinship:r[S.id],rels:{spouses:[R.id],children:[]}};I.push(E)}function N(I){const R=I.find(A=>A.id===t),T=k(s);I.push({id:s,data:JSON.parse(JSON.stringify(T.data)),kinship:r[s],rels:{spouses:[],children:[]}});const S=[];T.rels.mother&&(k(T.rels.mother).rels.children||[]).forEach(A=>S.push(A)),T.rels.father&&(k(T.rels.father).rels.children||[]).forEach(A=>S.push(A));const E=k(t).rels.spouses.find(A=>S.includes(A));R.rels.spouses=[E];const _=k(E),M={id:_.id,data:JSON.parse(JSON.stringify(_.data)),kinship:r[_.id],rels:{spouses:[R.id],children:[]}};if(I.push(M),T.rels.father){const A=T.rels.father,P=k(A),B={id:P.id,data:JSON.parse(JSON.stringify(P.data)),kinship:"Father-in-law",rels:{spouses:[],children:[E,s]}};T.rels.mother&&B.rels.spouses.push(T.rels.mother),I.unshift(B)}if(T.rels.mother){const A=T.rels.mother,P=k(A),B={id:P.id,data:JSON.parse(JSON.stringify(P.data)),kinship:"Mother-in-law",rels:{spouses:[],children:[E,s]}};T.rels.father&&B.rels.spouses.push(T.rels.father),I.unshift(B)}}function k(I){return n.find(R=>R.id===I)}}function Wx(e){const t=["st","nd","rd"];return t[e-1]?e+t[e-1]:e+"th"}function XR(e){return Math.abs(e)-2}function Nf(e,t){const n=XR(t);return e.includes("great-")&&(e=e.split("great-")[1]),n===1?`great-${e}`:n>1?`${n}x-great-${e}`:(console.error(`${e} should have great_count > 1`),e)}function Qie(e,t,n){const{self_id:r,getLabel:s,title:i}=e,l=WR(r,n,e),a=l[t];if(!a)return;let c=a;a==="self"?c="You":c=KR(c);const d=`
    <div class="f3-kinship-info">
      <div class="f3-info-field">
        <span class="f3-info-field-label">${i}</span>
        <span class="f3-info-field-value">
          <span>${c}</span>
          <span class="f3-kinship-info-icon">${UR()}</span>
        </span>
      </div>
    </div>
  `,u=Ze.create("div").html(d).select("div").node();let f;return Ze.select(u).select(".f3-kinship-info-icon").on("click",h=>m(h,u)),u;function m(h,g){let x=h.clientX-250-10,b=h.clientY-400-10;if(x+250>window.innerWidth&&(x=window.innerWidth-250-10),b<0&&(b=10),f&&f.active){f.close(),f=null;return}f=Dr.elements.infoPopup(g),Ze.select(f.popup_cont).style("width","250px").style("height","400px").style("left",`${x}px`).style("top",`${b}px`);const w=f.popup_cont.querySelector(".f3-popup-content-inner");f.activate(),eae(r,t,n,l,w,s)}}function eae(e,t,n,r,s,i){Ze.select(s).select("#SmallChart").node()||Ze.select(s).append("div").attr("id","SmallChart").attr("class","f3");const l=Ze.select("#SmallChart");l.selectAll("*").remove();const a=YR(e,t,n,r);let c=!0;const d=l.append("div");u(a);function u(f){const m=Dr.createChart("#SmallChart",f).setTransitionTime(500).setCardXSpacing(170).setCardYSpacing(70).setSingleParentEmptyCard(!1),h=m.setCard(Dr.CardHtml).setStyle("rect").setCardInnerHtmlCreator(x=>g(x)).setOnCardUpdate(function(x){Ze.select(this).select(".card").classed("card-main",!1)});h.onCardClick=(x,b)=>{},m.updateTree({initial:!0}),setTimeout(()=>p(.65),100),y();function g(x){let b=x.data.kinship==="self"?"You":x.data.kinship;return b=KR(b),c||(b=i(x.data)),`
        <div class="card-inner card-rect ${w()}">
          <div class="card-label">${b}</div>
        </div>
      `;function w(){return x.data.kinship==="self"?"card-kinship-self"+(c?"":" f3-real-label"):x.data.id===t?"card-kinship-rel":"card-kinship-default"}}function y(){d.classed("f3-kinship-labels-toggle",!0),d.append("label").text("Kinship labels").append("input").attr("type","checkbox").attr("checked",!0).on("change",x=>{c=!c,m.updateTree({initial:!1,tree_position:"inherit"})})}function p(x){const b=m.cont.querySelector("svg.main_svg");Dr.handlers.getCurrentZoom(b).k>x&&Dr.handlers.zoomTo(b,x)}}}function KR(e){return e=e[0].toUpperCase()+e.slice(1),e.includes("great-")&&(e=e.replace("great-","Great-")),e}function tae(...e){return new Tn(...e)}function Tn(e,t){return this.cont=e,this.store=t,this.fields=[{type:"text",label:"first name",id:"first name"},{type:"text",label:"last name",id:"last name"},{type:"text",label:"birthday",id:"birthday"},{type:"text",label:"avatar",id:"avatar"}],this.form_cont=null,this.is_fixed=!0,this.history=null,this.no_edit=!1,this.onChange=null,this.editFirst=!1,this.postSubmit=null,this.link_existing_rel_config=null,this.onFormCreation=null,this.kinship_info_config=null,this.init(),this}Tn.prototype.init=function(){this.form_cont=Ze.select(this.cont).append("div").classed("f3-form-cont",!0).node(),this.modal=this.setupModal(),this.addRelativeInstance=this.setupAddRelative(),this.removeRelativeInstance=this.setupRemoveRelative(),this.createHistory()};Tn.prototype.open=function(e){e.data.data&&typeof e.data.data=="object"&&(e=e.data);const t=this.store.getTreeDatum(e.id);this.addRelativeInstance.is_active?n.call(this,e):this.removeRelativeInstance.is_active?r.call(this,t):this.cardEditForm(e);function n(){e._new_rel_data?this.cardEditForm(e):(this.addRelativeInstance.onCancel(),this.cardEditForm(e),this.store.updateMainId(e.id),this.store.updateTree({}))}function r(){if(e.id===this.removeRelativeInstance.datum.id)this.removeRelativeInstance.onCancel(),this.cardEditForm(e);else{let s=function(){this.removeRelativeInstance.onCancel(),this.updateHistory(),this.store.updateTree({})};this.removeRelativeInstance.onChange(t,s.bind(this))}}};Tn.prototype.openWithoutRelCancel=function(e){this.cardEditForm(e)};Tn.prototype.cardEditForm=function(e){const t={};(e==null?void 0:e._new_rel_data)?t.onCancel=()=>this.addRelativeInstance.onCancel():(t.addRelative=this.addRelativeInstance,t.removeRelative=this.removeRelativeInstance,t.deletePerson=()=>{n1(e,this.store.getData()),this.openFormWithId(this.store.getLastAvailableMainDatum().id),this.store.updateTree({})});const r=Dr.handlers.createForm({store:this.store,datum:e,postSubmit:i.bind(this),fields:this.fields,addRelative:null,onCancel:()=>{},editFirst:this.editFirst,link_existing_rel_config:this.link_existing_rel_config,getKinshipInfo:this.kinship_info_config?()=>Qie(this.kinship_info_config,e.id,this.store.getData()):null,onFormCreation:this.onFormCreation,...t});r.no_edit=this.no_edit,this.no_edit&&(r.editable=!1);const s=Dr.handlers.formInfoSetup(r,this.closeForm.bind(this));this.form_cont.innerHTML="",this.form_cont.appendChild(s),this.openForm();function i(l){if(this.addRelativeInstance.is_active){this.addRelativeInstance.onChange(e,l),this.postSubmit&&this.postSubmit(e,this.store.getData());const a=this.addRelativeInstance.datum;this.store.updateMainId(a.id),this.openWithoutRelCancel(a)}else(e.to_add||e.unknown)&&(l!=null&&l.link_rel_id)?(QM(e,l.link_rel_id,this.store.getData()),this.store.updateMainId(l.link_rel_id),this.openFormWithId(l.link_rel_id)):l!=null&&l.delete||(this.postSubmit&&this.postSubmit(e,this.store.getData()),this.openFormWithId(e.id));this.is_fixed||this.closeForm(),this.store.updateTree({}),this.updateHistory()}};Tn.prototype.openForm=function(){Ze.select(this.form_cont).classed("opened",!0)};Tn.prototype.closeForm=function(){Ze.select(this.form_cont).classed("opened",!1).html(""),this.store.updateTree({})};Tn.prototype.fixed=function(){return this.is_fixed=!0,Ze.select(this.form_cont).style("position","relative"),this};Tn.prototype.absolute=function(){return this.is_fixed=!1,Ze.select(this.form_cont).style("position","absolute"),this};Tn.prototype.setCardClickOpen=function(e){return e.setOnCardClick((t,n)=>{this.isAddingRelative()?this.open(n.data):this.isRemovingRelative()?this.open(n.data):(this.open(n.data),e.onCardClickDefault(t,n))}),this};Tn.prototype.openFormWithId=function(e){if(e){const t=this.store.getDatum(e);this.openWithoutRelCancel(t)}else{const t=this.store.getMainDatum();this.openWithoutRelCancel(t)}};Tn.prototype.createHistory=function(){return this.history=Dr.handlers.createHistory(this.store,this.getStoreDataCopy.bind(this),e.bind(this)),this.history.controls=Dr.handlers.createHistoryControls(this.cont.querySelector(".f3-nav-cont"),this.history),this.history.changed(),this.history.controls.updateButtons(),this;function e(){var t;this.addRelativeInstance.is_active&&this.addRelativeInstance.onCancel(),this.removeRelativeInstance.is_active&&this.removeRelativeInstance.onCancel(),this.store.updateTree({initial:!1}),this.history.controls.updateButtons(),this.openFormWithId((t=this.store.getMainDatum())==null?void 0:t.id),this.onChange&&this.onChange()}};Tn.prototype.setNoEdit=function(){return this.no_edit=!0,this};Tn.prototype.setEdit=function(){return this.no_edit=!1,this};Tn.prototype.setFields=function(e){const t=[];if(!Array.isArray(e))return console.error("fields must be an array"),this;for(const n of e)typeof n=="string"?t.push({type:"text",label:n,id:n}):typeof n=="object"?n.id?t.push(n):console.error("fields must be an array of objects with id property"):console.error("fields must be an array of strings or objects");return this.fields=t,this};Tn.prototype.setOnChange=function(e){return this.onChange=e,this};Tn.prototype.addRelative=function(e){return e||(e=this.store.getMainDatum()),this.addRelativeInstance.activate(e),this};Tn.prototype.setupAddRelative=function(){return Xie(this.store,e.bind(this),t.bind(this));function e(){this.removeRelativeInstance.is_active&&this.removeRelativeInstance.onCancel()}function t(n){this.store.updateMainId(n.id),this.store.updateTree({}),this.openFormWithId(n.id)}};Tn.prototype.setupRemoveRelative=function(){return Jie(this.store,e.bind(this),t.bind(this),this.modal);function e(){this.addRelativeInstance.is_active&&this.addRelativeInstance.onCancel(),n(this.cont,!0)}function t(r){n(this.cont,!1),this.store.updateMainId(r.id),this.store.updateTree({}),this.openFormWithId(r.id)}function n(r,s){Ze.select(r).select("#f3Canvas").classed("f3-remove-relative-active",s)}};Tn.prototype.setupModal=function(){return Zie(this.cont)};Tn.prototype.setEditFirst=function(e){return this.editFirst=e,this};Tn.prototype.isAddingRelative=function(){return this.addRelativeInstance.is_active};Tn.prototype.isRemovingRelative=function(){return this.removeRelativeInstance.is_active};Tn.prototype.setAddRelLabels=function(e){return this.addRelativeInstance.setAddRelLabels(e),this};Tn.prototype.setLinkExistingRelConfig=function(e){return this.link_existing_rel_config=e,this};Tn.prototype.setOnFormCreation=function(e){return this.onFormCreation=e,this};Tn.prototype.setKinshipInfo=function(e){return this.kinship_info_config=e,this};Tn.prototype.getStoreDataCopy=function(){let e=JSON.parse(JSON.stringify(this.store.getData()));return this.addRelativeInstance.is_active&&(e=this.addRelativeInstance.cleanUp(e)),e=Dr.handlers.cleanupDataJson(e),e};Tn.prototype.getDataJson=function(){return JSON.stringify(this.getStoreDataCopy(),null,2)};Tn.prototype.updateHistory=function(){this.history&&(this.history.changed(),this.history.controls.updateButtons()),this.onChange&&this.onChange()};Tn.prototype.setPostSubmit=function(e){return this.postSubmit=e,this};Tn.prototype.destroy=function(){return this.history.controls.destroy(),this.history=null,Ze.select(this.cont).select(".f3-form-cont").remove(),this.addRelativeInstance.onCancel&&this.addRelativeInstance.onCancel(),this.store.updateTree({}),this};function nae(e,t,n={}){const r=[];t.data.forEach(m=>{m._spouse&&m.data.data.gender==="F"&&r.push({nodes:[m,m._spouse],id:`${m.data.id}--${m._spouse.data.id}`}),m.spouses&&m.spouses.forEach(h=>r.push({nodes:[h,m],id:`${h.data.id}--${m.data.id}`}))});const s=Ze.select(e).select(".links_view").selectAll("g.link-text").data(r,m=>m.id),i=s.exit(),l=s.enter().append("g").attr("class","link-text"),a=l.merge(s),c=(m,h)=>m.spouse&&m.data.data.gender==="F"?m.x-n.node_separation/2:h.spouse&&h.data.data.gender==="M"?h.x+n.node_separation/2:Math.min(m.x,h.x)+n.node_separation/2;i.each(f),l.each(d),a.each(u);function d(m){const[h,g]=m.nodes,y=Ze.select(this);y.attr("transform",`translate(${c(h,g)}, ${h.y-3})`).style("opacity",0),y.append("text").style("font-size","12px").style("fill","#fff").style("text-anchor","middle")}function u(m){const[h,g]=m.nodes,y=Ze.select(this),p=n.initial?im(t,h,n.transition_time):0;y.select("text").text(n.linkSpouseText(h,g)),y.transition("text").duration(n.transition_time).delay(p).attr("transform",`translate(${c(h,g)}, ${h.y-3})`),y.transition("text-op").duration(100).delay(p+n.transition_time).style("opacity",1)}function f(m){const h=Ze.select(this);h.transition("text").duration(100).style("opacity",0).on("end",()=>h.remove())}}function rae(...e){return new Ad(...e)}function Ad(e,t){this.cont=e,this.autocomplete_cont=null,this.options=[],this.onSelect=t,this.init()}Ad.prototype.init=function(){this.autocomplete_cont=Ze.select(this.cont).append("div").attr("class","f3-autocomplete-cont").node(),Ze.select(this.autocomplete_cont),this.create()};Ad.prototype.create=function(){const e=this;Ze.select(this.autocomplete_cont).html(`
    <div class="f3-autocomplete">
      <div class="f3-autocomplete-input-cont">
        <input type="text" placeholder="Search">
        <span class="f3-autocomplete-toggle">${BR()}</span>
      </div>
      <div class="f3-autocomplete-items" tabindex="0"></div>
    </div>
  `);const t=Ze.select(this.autocomplete_cont).select(".f3-autocomplete"),n=t.select("input"),r=t.select(".f3-autocomplete-items");t.on("focusout",()=>{setTimeout(()=>{t.node().contains(document.activeElement)||i()},200)}),n.on("focus",()=>{a(),s()}).on("input",s).on("keydown",c),r.on("wheel",d=>d.stopPropagation()),t.select(".f3-autocomplete-toggle").on("click",d=>{d.stopPropagation();const u=t.classed("active");t.classed("active",!u),u?i():(n.node().focus(),s())});function s(){t.classed("active",!0);const d=n.property("value"),u=e.options.filter(h=>h.label.toLowerCase().includes(d.toLowerCase()));u.forEach(f),u.sort(m),l(u);function f(h){const g=h.label.toLowerCase().indexOf(d.toLowerCase());g!==-1?h.label_html=y():h.label_html=h.label;function y(){return h.label.substring(0,g)+"<strong>"+h.label.substring(g,g+d.length)+"</strong>"+h.label.substring(g+d.length)}}function m(h,g){return h.label<g.label?-1:h.label>g.label?1:0}}function i(){t.classed("active",!1),l([])}function l(d){r.selectAll("div.f3-autocomplete-item").data(d,f=>f==null?void 0:f.value).join("div").attr("class","f3-autocomplete-item").on("click",(f,m)=>{e.onSelect(m.value)}).html(f=>f.optionHtml?f.optionHtml(f):u(f));function u(f){return`<div class="${f.class?f.class:""}">${f.label_html}</div>`}}function a(){e.options=e.getOptions()}function c(d){const u=r.selectAll("div.f3-autocomplete-item").nodes(),f=u.findIndex(h=>Ze.select(h).classed("f3-selected"));if(d.key==="ArrowDown"){d.preventDefault();const h=f<u.length-1?f+1:0;m(u,h)}else if(d.key==="ArrowUp"){d.preventDefault();const h=f>0?f-1:u.length-1;m(u,h)}else if(d.key==="Enter"&&f!==-1){d.preventDefault();const h=Ze.select(u[f]).datum();h&&e.onSelect(h.value)}function m(h,g){h.forEach(y=>Ze.select(y).classed("f3-selected",!1)),h[g]&&(Ze.select(h[g]).classed("f3-selected",!0),h[g].scrollIntoView({block:"nearest"}))}}};Ad.prototype.setOptionsGetter=function(e){return this.getOptions=e,this};Ad.prototype.setOptionsGetterPerson=function(e,t){return this.getOptions=()=>{const s=[];return e().forEach(l=>{l.to_add||l.unknown||l._new_rel_data||s.find(a=>a.value===l.id)||s.push({label:t(l),value:l.id,optionHtml:n(l)})}),s},this;function n(s){const i=!A4(s,e());return l=>`
      <div>
        <span style="float: left; width: 10px; height: 10px; margin-right: 10px;" class="f3-${r(s)}-color">${T4()}</span>
        <span>${l.label_html}</span>
        ${i?`<span style="float: right; width: 10px; height: 10px; margin-left: 5px;" title="This profile is not connected to the main profile">${zR()}</span>`:""}
      </div>
    `}function r(s){return s.data.gender==="M"?"male":s.data.gender==="F"?"female":"genderless"}};Ad.prototype.destroy=function(){this.autocomplete_cont.remove()};function sae(...e){return new Ln(...e)}function Ln(e,t){return this.cont=null,this.store=null,this.svg=null,this.getCard=null,this.node_separation=250,this.level_separation=150,this.is_horizontal=!1,this.single_parent_empty_card=!0,this.transition_time=2e3,this.linkSpouseText=!1,this.personSearch=null,this.is_card_html=!1,this.beforeUpdate=null,this.afterUpdate=null,this.init(e,t),this}Ln.prototype.init=function(e,t){this.cont=e=iae(e);const n=()=>e.querySelector("svg .view"),r=()=>e.querySelector("#htmlSvg"),s=()=>e.querySelector("#htmlSvg .cards_view");this.svg=Dr.createSvg(e,{onZoom:Dr.htmlHandlers.onZoomSetup(n,s)}),Dr.htmlHandlers.createHtmlSvg(e),aae(this.cont),this.store=Dr.createStore({data:t,node_separation:this.node_separation,level_separation:this.level_separation,single_parent_empty_card:this.single_parent_empty_card,is_horizontal:this.is_horizontal}),this.store.setOnUpdate(i=>{this.beforeUpdate&&this.beforeUpdate(i),i=Object.assign({transition_time:this.transition_time},i||{}),this.is_card_html&&(i=Object.assign({},i||{},{cardHtml:r()})),Dr.view(this.store.getTree(),this.svg,this.getCard(),i||{}),this.linkSpouseText&&nae(this.svg,this.store.getTree(),Object.assign({},i||{},{linkSpouseText:this.linkSpouseText,node_separation:this.node_separation})),this.afterUpdate&&this.afterUpdate(i)})};Ln.prototype.updateTree=function(e={initial:!1}){return this.store.updateTree(e),this};Ln.prototype.updateData=function(e){return this.store.updateData(e),this};Ln.prototype.setCardYSpacing=function(e){return typeof e!="number"?(console.error("card_y_spacing must be a number"),this):(this.level_separation=e,this.store.state.level_separation=e,this)};Ln.prototype.setCardXSpacing=function(e){return typeof e!="number"?(console.error("card_x_spacing must be a number"),this):(this.node_separation=e,this.store.state.node_separation=e,this)};Ln.prototype.setOrientationVertical=function(){return this.is_horizontal=!1,this.store.state.is_horizontal=!1,this};Ln.prototype.setOrientationHorizontal=function(){return this.is_horizontal=!0,this.store.state.is_horizontal=!0,this};Ln.prototype.setShowSiblingsOfMain=function(e){return this.store.state.show_siblings_of_main=e,this};Ln.prototype.setModifyTreeHierarchy=function(e){return this.store.state.modifyTreeHierarchy=e,this};Ln.prototype.setPrivateCardsConfig=function(e){return this.store.state.private_cards_config=e,this};Ln.prototype.setLinkSpouseText=function(e){return this.linkSpouseText=e,this};Ln.prototype.setSingleParentEmptyCard=function(e,{label:t="Unknown"}={}){return this.single_parent_empty_card=e,this.store.state.single_parent_empty_card=e,this.store.state.single_parent_empty_card_label=t,this.editTreeInstance&&this.editTreeInstance.addRelativeInstance.is_active&&this.editTreeInstance.addRelativeInstance.onCancel(),Dr.handlers.removeToAddFromData(this.store.getData()||[]),this};Ln.prototype.setCard=function(e){this.is_card_html=e.is_html,this.is_card_html?(this.svg.querySelector(".cards_view").innerHTML="",this.cont.querySelector("#htmlSvg").style.display="block"):(this.cont.querySelector("#htmlSvg .cards_view").innerHTML="",this.cont.querySelector("#htmlSvg").style.display="none");const t=e(this.cont,this.store);return this.getCard=()=>t.getCard(),t};Ln.prototype.setTransitionTime=function(e){return this.transition_time=e,this};Ln.prototype.setSortChildrenFunction=function(e){return this.store.state.sortChildrenFunction=e,this};Ln.prototype.setSortSpousesFunction=function(e){return this.store.state.sortSpousesFunction=e,this};Ln.prototype.setAncestryDepth=function(e){return this.store.state.ancestry_depth=e,this};Ln.prototype.setProgenyDepth=function(e){return this.store.state.progeny_depth=e,this};Ln.prototype.getMaxDepth=function(e){return Hse(e,this.store.getData())};Ln.prototype.calculateKinships=function(e,t){return WR(e,this.store.getData(),t)};Ln.prototype.getKinshipsDataStash=function(e,t){return YR(e,t,this.store.getData(),this.calculateKinships(e))};Ln.prototype.setDuplicateBranchToggle=function(e){return this.store.state.duplicate_branch_toggle=e,this};Ln.prototype.editTree=function(){return this.editTreeInstance=tae(this.cont,this.store)};Ln.prototype.updateMain=function(e){return this.store.updateMainId(e.data.id),this.store.updateTree({}),this};Ln.prototype.updateMainId=function(e){return this.store.updateMainId(e),this};Ln.prototype.getMainDatum=function(){return this.store.getMainDatum()};Ln.prototype.updateData=function(e){this.store.updateData(e)};Ln.prototype.setBeforeUpdate=function(e){return this.beforeUpdate=e,this};Ln.prototype.setAfterUpdate=function(e){return this.afterUpdate=e,this};Ln.prototype.setPersonDropdown=function(e,t=this.cont.querySelector(".f3-nav-cont")){this.personSearch=rae(t,n.bind(this)),this.personSearch.setOptionsGetterPerson(this.store.getData,e);function n(r){this.editTreeInstance&&this.editTreeInstance.open(this.store.getDatum(r)),this.updateMainId(r),this.updateTree({initial:!1})}return this};Ln.prototype.unSetPersonSearch=function(){return this.personSearch.destroy(),this.personSearch=null,this};function iae(e){return typeof e=="string"&&(e=document.querySelector(e)),e}function aae(e){Ze.select(e).append("div").attr("class","f3-nav-cont")}function JR(e){const t=[];return Array.isArray(e)?e.forEach(n=>{typeof n=="function"?t.push(n):typeof n=="string"?t.push(r=>r.data[n]):Array.isArray(n)&&t.push(r=>n.map(s=>r.data[s]).join(" "))}):typeof e=="function"?t.push(e):typeof e=="string"&&t.push(n=>n.data[e]),t}ZR.is_html=!1;function ZR(...e){return new Eo(...e)}function Eo(e,t){return this.cont=e,this.store=t,this.svg=null,this.getCard=null,this.card_dim={w:220,h:70,text_x:75,text_y:15,img_w:60,img_h:60,img_x:5,img_y:5},this.card_display=[n=>`${n.data["first name"]} ${n.data["last name"]}`],this.mini_tree=!0,this.link_break=!1,this.onCardClick=this.onCardClickDefault.bind(this),this.onCardUpdate=null,this.init(),this}Eo.prototype.init=function(){this.svg=this.cont.querySelector("svg.main_svg"),this.getCard=()=>Dr.elements.CardSvg({store:this.store,svg:this.svg,card_dim:this.card_dim,card_display:this.card_display,mini_tree:this.mini_tree,link_break:this.link_break,onCardClick:this.onCardClick,onCardUpdate:this.onCardUpdate})};Eo.prototype.setCardDisplay=function(e){return this.card_display=JR(e),this};Eo.prototype.setCardDim=function(e){if(typeof e!="object")return console.error("card_dim must be an object"),this;for(let t in e){const n=e[t];if(typeof n!="number"&&typeof n!="boolean")return console.error(`card_dim.${t} must be a number or boolean`),this;t==="width"&&(t="w"),t==="height"&&(t="h"),t==="img_width"&&(t="img_w"),t==="img_height"&&(t="img_h"),t==="img_x"&&(t="img_x"),t==="img_y"&&(t="img_y"),this.card_dim[t]=n}return zie(this.svg,this.card_dim),this};Eo.prototype.setOnCardUpdate=function(e){return this.onCardUpdate=e,this};Eo.prototype.setMiniTree=function(e){return this.mini_tree=e,this};Eo.prototype.setLinkBreak=function(e){return this.link_break=e,this};Eo.prototype.onCardClickDefault=function(e,t){this.store.updateMainId(t.data.id),this.store.updateTree({})};Eo.prototype.setOnCardClick=function(e){return this.onCardClick=e,this};QR.is_html=!0;function QR(...e){return new os(...e)}os.prototype.is_html=!0;function os(e,t){return this.cont=e,this.store=t,this.getCard=null,this.card_display=[n=>`${n.data["first name"]} ${n.data["last name"]}`],this.cardImageField="avatar",this.onCardClick=this.onCardClickDefault,this.style="default",this.mini_tree=!1,this.onCardUpdate=null,this.card_dim={},this.cardInnerHtmlCreator=null,this.init(),this}os.prototype.init=function(){this.svg=this.cont.querySelector("svg.main_svg"),this.getCard=()=>Dr.elements.CardHtml({store:this.store,card_display:this.card_display,cardImageField:this.cardImageField,defaultPersonIcon:this.defaultPersonIcon,onCardClick:this.onCardClick,style:this.style,mini_tree:this.mini_tree,onCardUpdate:this.onCardUpdate,card_dim:this.card_dim,empty_card_label:this.store.state.single_parent_empty_card_label,cardInnerHtmlCreator:this.cardInnerHtmlCreator,duplicate_branch_toggle:this.store.state.duplicate_branch_toggle,onCardMouseenter:this.onCardMouseenter?this.onCardMouseenter.bind(this):null,onCardMouseleave:this.onCardMouseleave?this.onCardMouseleave.bind(this):null})};os.prototype.setCardDisplay=function(e){return this.card_display=JR(e),this};os.prototype.setCardImageField=function(e){return this.cardImageField=e,this};os.prototype.setDefaultPersonIcon=function(e){return this.defaultPersonIcon=e,this};os.prototype.setOnCardClick=function(e){return this.onCardClick=e,this};os.prototype.onCardClickDefault=function(e,t){this.store.updateMainId(t.data.id),this.store.updateTree({})};os.prototype.setStyle=function(e){return this.style=e,this};os.prototype.setMiniTree=function(e){return this.mini_tree=e,this};os.prototype.setOnCardUpdate=function(e){return this.onCardUpdate=e,this};os.prototype.setCardDim=function(e){if(typeof e!="object")return console.error("card_dim must be an object"),this;for(let t in e){const n=e[t];if(typeof n!="number"&&typeof n!="boolean")return console.error(`card_dim.${t} must be a number or boolean`),this;t==="width"&&(t="w"),t==="height"&&(t="h"),t==="img_width"&&(t="img_w"),t==="img_height"&&(t="img_h"),t==="img_x"&&(t="img_x"),t==="img_y"&&(t="img_y"),this.card_dim[t]=n}return this};os.prototype.resetCardDim=function(){return this.card_dim={},this};os.prototype.setCardInnerHtmlCreator=function(e){return this.cardInnerHtmlCreator=e,this};os.prototype.setOnHoverPathToMain=function(){return this.onCardMouseenter=this.onEnterPathToMain.bind(this),this.onCardMouseleave=this.onLeavePathToMain.bind(this),this};os.prototype.unsetOnHoverPathToMain=function(){return this.onCardMouseenter=null,this.onCardMouseleave=null,this};os.prototype.onEnterPathToMain=function(e,t){this.to_transition=t.data.id;const n=this.store.getTreeMainDatum(),r=Ze.select(this.cont).select("div.cards_view").selectAll(".card_cont"),s=Ze.select(this.cont).select("svg.main_svg .links_view").selectAll(".link"),[i,l]=sie(r,s,t,n);return i.forEach(a=>{const c=Math.abs(t.depth-a.card.depth)*200;Ze.select(a.node.querySelector("div.card-inner")).transition().duration(0).delay(c).on("end",()=>this.to_transition===t.data.id&&Ze.select(a.node.querySelector("div.card-inner")).classed("f3-path-to-main",!0))}),l.forEach(a=>{const c=Math.abs(t.depth-a.link.depth)*200;Ze.select(a.node).transition().duration(0).delay(c).on("end",()=>this.to_transition===t.data.id&&Ze.select(a.node).classed("f3-path-to-main",!0))}),this};os.prototype.onLeavePathToMain=function(e,t){return this.to_transition=!1,Ze.select(this.cont).select("div.cards_view").selectAll("div.card-inner").classed("f3-path-to-main",!1),Ze.select(this.cont).select("svg.main_svg .links_view").selectAll(".link").classed("f3-path-to-main",!1),this};var Dr={CalculateTree:lR,createStore:nie,view:pie,createSvg:gie,handlers:kie,elements:Yie,htmlHandlers:hie,icons:Nie,createChart:sae,CardSvg:ZR,CardHtml:QR};const oae={w:220,h:70,text_x:75,text_y:15,img_w:60,img_h:60,img_x:5,img_y:5},lae=({isRTL:e=!1})=>{const t=be.useRef(null);return be.useEffect(()=>{if(!t.current)return;const n=Dr.createChart(t.current,r()).setTransitionTime(500).setCardXSpacing(250).setCardYSpacing(150);return n.setCard(Dr.CardSvg).setCardDim(oae).setCardDisplay([s=>`${s.data["first name"]||""}`,s=>`${s.data["last name"]||""}`,s=>`${s.data.birthday||""}`]).setMiniTree(!0),n.updateTree({initial:!0}),()=>{};function r(){return[{id:"0",rels:{spouses:["ninapopova"],father:"0c09cfa0-5e7c-4073-8beb-94f6c69ada19",mother:"0fa5c6bc-5b58-40f5-a07e-d787e26d8b56",children:["popovKonstantinViktorovich","f626d086-e2d6-4722-b4f3-ca4f15b109ab"]},data:{"first name":" ","last name":"",birthday:"1939",avatar:"https://static8.depositphotos.com/1009634/988/v/950/depositphotos_9883921-stock-illustration-no-user-profile-picture.jpg",gender:"M"}},{id:"ninapopova",data:{gender:"F","first name":"","last name":"()",birthday:"",avatar:""},rels:{spouses:["0"],children:["popovKonstantinViktorovich","f626d086-e2d6-4722-b4f3-ca4f15b109ab"]}},{id:"0c09cfa0-5e7c-4073-8beb-94f6c69ada19",data:{gender:"M","first name":" ","last name":"",birthday:"",avatar:""},rels:{children:["0"],spouses:["0fa5c6bc-5b58-40f5-a07e-d787e26d8b56"]}},{id:"0fa5c6bc-5b58-40f5-a07e-d787e26d8b56",data:{gender:"F","first name":"?","last name":"",birthday:"",avatar:""},rels:{spouses:["0c09cfa0-5e7c-4073-8beb-94f6c69ada19"],children:["0"],father:"12a9bddf-855a-4583-a695-c73fa8c0e9b2",mother:"bd56a527-b613-474d-9f38-fcac0aae218b"}},{id:"popovKonstantinViktorovich",data:{gender:"M","first name":" ","last name":"",birthday:"",avatar:""},rels:{mother:"ninapopova",father:"0",spouses:["popovaVera"],children:["vityapopov98","nadiapopova","lilinpo"]}},{id:"f626d086-e2d6-4722-b4f3-ca4f15b109ab",data:{gender:"M","first name":"","last name":"",birthday:"",avatar:""},rels:{mother:"ninapopova",father:"0"}},{id:"vityapopov98",data:{gender:"M","first name":"","last name":"",birthday:"",avatar:""},rels:{mother:"popovaVera",father:"popovKonstantinViktorovich"}},{id:"popovaVera",data:{gender:"F","first name":"","last name":"",birthday:"",avatar:""},rels:{spouses:["popovKonstantinViktorovich"],children:["vityapopov98","nadiapopova"]}},{id:"nadiapopova",data:{gender:"F","first name":"","last name":"",birthday:"",avatar:""},rels:{mother:"popovaVera",father:"popovKonstantinViktorovich"}},{id:"lilinpo",data:{gender:"F","first name":"","last name":"",birthday:"",avatar:""},rels:{mother:"popovaVera",father:"popovKonstantinViktorovich"}},{id:"12a9bddf-855a-4583-a695-c73fa8c0e9b2",data:{gender:"M","first name":"Yvo","last name":"",birthday:"",avatar:""},rels:{children:["0fa5c6bc-5b58-40f5-a07e-d787e26d8b56"],spouses:["bd56a527-b613-474d-9f38-fcac0aae218b"]}},{id:"bd56a527-b613-474d-9f38-fcac0aae218b",data:{gender:"F","first name":"Yva","last name":"",birthday:"",avatar:""},rels:{spouses:["12a9bddf-855a-4583-a695-c73fa8c0e9b2"],children:["0fa5c6bc-5b58-40f5-a07e-d787e26d8b56"]}}]}},[]),o.jsx("div",{className:"f3",ref:t,style:{direction:e?"rtl":"ltr"}})},cae=()=>{const{language:e}=Ft(),{publicTrees:t,fetchPublicTrees:n}=As(),[r,s]=J.useState(1),[i,l]=J.useState(!0),a=10,c=e==="ar";J.useEffect(()=>{(async()=>{try{l(!0),await n()}catch{}finally{l(!1)}})()},[n]);const d=r*a,u=d-a,f=t.slice(u,d),m=Math.ceil(t.length/a),h=p=>{s(p),window.scrollTo({top:0,behavior:"smooth"})},g=[{icon:kn,title:"Build Your Family Tree",titleAr:"  ",description:"Create detailed family trees with photos, documents, and life stories.",descriptionAr:"        ."},{icon:Qi,title:"Smart Search & Suggestions",titleAr:"  ",description:"Find relatives and get intelligent suggestions to complete your tree.",descriptionAr:"        ."},{icon:p0,title:"Collaborate with Family",titleAr:"  ",description:"Share your trees and work together with family members.",descriptionAr:"     ."},{icon:g0,title:"Privacy & Security",titleAr:" ",description:"Your family data is secure with advanced privacy controls.",descriptionAr:"      ."},{icon:jo,title:"Bilingual Support",titleAr:"  ",description:"Full support for Arabic and English languages.",descriptionAr:"    ."},{icon:AH,title:"Modern Interface",titleAr:" ",description:"Beautiful, intuitive interface that works on all devices.",descriptionAr:"      ."}],y=[{name:"Basic",nameAr:"",price:"$9.99",period:"/month",periodAr:"/",description:"Perfect for individuals",descriptionAr:" ",features:["1 family tree","Up to 5 people per tree","1GB storage","Email support"],featuresAr:["  "," 5   ","1  ","  "],popular:!1},{name:"Premium",nameAr:"",price:"$19.99",period:"/month",periodAr:"/",description:"Great for growing families",descriptionAr:"  ",features:["3 family trees","Up to 150 people per tree","10GB storage","Smart suggestions","Priority support"],featuresAr:["3  "," 150   ","10  "," "," "],popular:!0},{name:"Family",nameAr:"",price:"$29.99",period:"/month",periodAr:"/",description:"Perfect for large families",descriptionAr:"  ",features:["Unlimited trees & people","Unlimited storage","Smart suggestions","Priority support","Custom themes","Advanced search"],featuresAr:["   ","  "," "," "," "," "],popular:!1}];return o.jsxs("div",{className:"min-h-screen",children:[o.jsxs("section",{className:"relative min-h-[80vh] sm:min-h-screen flex items-center justify-center bg-gradient-to-br from-primary/10 via-primary/5 to-background overflow-hidden",children:[o.jsxs("div",{className:"absolute inset-0 z-0",children:[o.jsx("div",{className:"w-full h-full bg-cover bg-center animate-zoomEffect",style:{backgroundImage:`url(${OH})`}}),o.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-background/80 to-background/40"})]}),o.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 relative z-10",children:o.jsxs("div",{className:"text-center max-w-4xl mx-auto",children:[o.jsxs("h1",{className:"text-4xl md:text-5xl lg:text-6xl font-bold text-foreground mb-6",children:[c?"  ":"Discover Your",o.jsx("span",{className:"text-primary",children:c?"":" Heritage"})]}),o.jsx("p",{className:"text-lg sm:text-xl text-muted-foreground mb-8 max-w-2xl mx-auto",children:c?"         .       .":"Build, explore, and share your family tree with our comprehensive genealogy platform. Connect with your roots and preserve your family's story for future generations."}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[o.jsx(ye,{asChild:!0,size:"lg",className:"text-base sm:text-lg px-6 sm:px-8",children:o.jsxs(_t,{to:"/register",className:"flex items-center",children:[c?" ":"Get Started Free",o.jsx(Ki,{className:`ml-2 h-5 w-5 ${c?"rotate-180":""}`})]})}),o.jsx(ye,{asChild:!0,variant:"outline",size:"lg",className:"text-base sm:text-lg px-6 sm:px-8",children:o.jsx(_t,{to:"/pricing",children:c?" ":"View Plans"})})]})]})})]}),o.jsx("section",{className:"py-20 bg-background",children:o.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[o.jsxs("div",{className:"text-center mb-12",children:[o.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-foreground mb-4",children:c?"  ":"Interactive Family Tree"}),o.jsx("p",{className:"text-xl text-muted-foreground max-w-2xl mx-auto",children:c?"             .":"Explore our interactive family tree that allows you to easily add and modify family members."})]}),o.jsx("div",{className:"bg-muted p-6 rounded-lg shadow-lg",children:o.jsx(lae,{isRTL:c})}),o.jsx("div",{className:"text-center mt-12",children:o.jsx(ye,{asChild:!0,size:"lg",children:o.jsxs(_t,{to:"/tree",className:"flex items-center justify-center",children:[c?"   ":"Start Building Your Tree",o.jsx(Ki,{className:`ml-2 h-4 w-4 ${c?"rotate-180":""}`})]})})})]})}),o.jsx("section",{className:"py-16 bg-muted/30",children:o.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[o.jsxs("div",{className:"text-center mb-12",children:[o.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-foreground mb-4",children:c?"  ":"Family Tree Archive"}),o.jsx("p",{className:"text-xl text-muted-foreground max-w-2xl mx-auto",children:c?"        .        .":"Explore public family trees created by thousands of users. Discover new families and join our genealogy community."})]}),i?o.jsx("div",{className:"flex justify-center items-center h-64",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):o.jsx(o.Fragment,{children:f.length>0?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4 sm:gap-6",children:f.map(p=>{var x;return o.jsxs(et,{className:"hover:shadow-lg transition-shadow h-full flex flex-col",children:[o.jsxs(ht,{className:"pb-3 flex-grow",children:[o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsx(gt,{className:"text-base sm:text-lg line-clamp-2",children:p.name}),o.jsx(qn,{className:"h-4 w-4 sm:h-5 w-5 text-primary flex-shrink-0 ml-2 mt-1"})]}),o.jsx(qr,{className:"text-xs sm:text-sm mt-2 line-clamp-2",children:c?p.description||"  ":p.description||"No description"})]}),o.jsxs(rt,{className:"mt-auto",children:[o.jsx("div",{className:"space-y-2 text-xs sm:text-sm",children:o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:"text-muted-foreground",children:c?"":"Members"}),o.jsx("span",{className:"font-medium",children:((x=p.stats)==null?void 0:x.totalPeople)||0})]})}),o.jsx(ye,{asChild:!0,variant:"outline",size:"sm",className:"w-full mt-4 text-xs sm:text-sm",children:o.jsx(_t,{to:`/shared/${p.id}`,children:c?" ":"View Tree"})})]})]},p.id)})}),m>1&&o.jsx("div",{className:"flex justify-center mt-12",children:o.jsxs("nav",{className:"flex items-center gap-2",children:[o.jsx(ye,{variant:"outline",size:"sm",onClick:()=>h(Math.max(1,r-1)),disabled:r===1,className:c?"rotate-180":"",children:o.jsx(Ki,{className:"h-4 w-4"})}),Array.from({length:Math.min(5,m)},(p,x)=>{let b;return m<=5||r<=3?b=x+1:r>=m-2?b=m-4+x:b=r-2+x,o.jsx(ye,{variant:r===b?"default":"outline",size:"sm",onClick:()=>h(b),children:b},b)}),o.jsx(ye,{variant:"outline",size:"sm",onClick:()=>h(Math.min(m,r+1)),disabled:r===m,className:c?"rotate-180":"",children:o.jsx(Ki,{className:"h-4 w-4"})})]})})]}):o.jsxs("div",{className:"text-center py-12",children:[o.jsx(qn,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),o.jsx("h3",{className:"text-xl font-medium text-foreground mb-2",children:c?"    ":"No Public Family Trees"}),o.jsx("p",{className:"text-muted-foreground mb-6",children:c?"      !":"Be the first to publish a public family tree!"}),o.jsx(ye,{asChild:!0,children:o.jsx(_t,{to:"/register",children:c?" ":"Get Started"})})]})})]})}),o.jsx("section",{className:"py-20 bg-background",children:o.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[o.jsxs("div",{className:"text-center mb-16",children:[o.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-foreground mb-4",children:c?"     ":"Everything You Need to Build Your Family Tree"}),o.jsx("p",{className:"text-xl text-muted-foreground max-w-2xl mx-auto",children:c?"         .":"Powerful features designed to help you discover, document, and share your family history."})]}),o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 sm:gap-8",children:g.map((p,x)=>o.jsxs(et,{className:"text-center hover:shadow-lg transition-shadow h-full flex flex-col",children:[o.jsxs(ht,{children:[o.jsx("div",{className:"mx-auto w-10 h-10 sm:w-12 sm:h-12 bg-primary/10 rounded-lg flex items-center justify-center mb-3 sm:mb-4",children:o.jsx(p.icon,{className:"h-5 w-5 sm:h-6 sm:w-6 text-primary"})}),o.jsx(gt,{className:"text-lg sm:text-xl",children:c?p.titleAr:p.title})]}),o.jsx(rt,{className:"flex-grow",children:o.jsx(qr,{className:"text-sm sm:text-base",children:c?p.descriptionAr:p.description})})]},x))}),o.jsx("div",{className:"text-center mt-12",children:o.jsx(ye,{asChild:!0,variant:"outline",size:"lg",children:o.jsxs(_t,{to:"/features",className:"flex items-center justify-center",children:[c?"  ":"View All Features",o.jsx(Ki,{className:`ml-2 h-4 w-4 ${c?"rotate-180":""}`})]})})})]})}),o.jsx("section",{className:"py-20 bg-muted/30",children:o.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[o.jsxs("div",{className:"text-center mb-16",children:[o.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-foreground mb-4",children:c?" ":"Choose Your Plan"}),o.jsx("p",{className:"text-xl text-muted-foreground max-w-2xl mx-auto",children:c?"     .     .":"Choose the plan that fits your family needs. All plans include our core features."})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 sm:gap-8 max-w-5xl mx-auto",children:y.map((p,x)=>o.jsxs(et,{className:`relative ${p.popular?"ring-2 ring-primary shadow-lg":""} h-full flex flex-col`,children:[p.popular&&o.jsx("div",{className:`absolute -top-3 left-1/2 transform -translate-x-1/2 ${c?"flex-row-reverse":""}`,children:o.jsxs("div",{className:"bg-primary text-primary-foreground px-3 py-1 rounded-full text-xs sm:text-sm font-medium flex items-center",children:[o.jsx(u3,{className:`h-3 w-3 sm:h-4 sm:w-4 ${c?"ml-1":"mr-1"}`}),c?" ":"Most Popular"]})}),o.jsxs(ht,{className:"text-center pt-8",children:[o.jsx(gt,{className:"text-xl sm:text-2xl",children:c?p.nameAr:p.name}),o.jsxs("div",{className:"mt-3 sm:mt-4",children:[o.jsx("span",{className:"text-3xl sm:text-4xl font-bold text-foreground",children:p.price}),o.jsx("span",{className:"text-muted-foreground text-sm sm:text-base",children:c?p.periodAr:p.period})]}),o.jsx(qr,{className:"mt-2 text-sm",children:c?p.descriptionAr:p.description})]}),o.jsxs(rt,{className:"flex-grow flex flex-col",children:[o.jsx("ul",{className:"space-y-2 sm:space-3 mb-6 flex-grow",children:(c?p.featuresAr:p.features).map((b,w)=>o.jsxs("li",{className:"flex items-start",children:[o.jsx(rH,{className:`h-4 w-4 sm:h-5 w-5 text-primary flex-shrink-0 ${c?"ml-2 sm:ml-3":"mr-2 sm:mr-3"} mt-0.5`}),o.jsx("span",{className:"text-xs sm:text-sm",children:b})]},w))}),o.jsx(ye,{asChild:!0,className:"w-full text-sm sm:text-base",variant:p.popular?"default":"outline",children:o.jsx(_t,{to:"/register",children:c?" ":"Choose Plan"})})]})]},x))})]})}),o.jsx("section",{className:"py-20 bg-muted/50",children:o.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 md:gap-12 items-center",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl sm:text-3xl md:text-4xl font-bold text-foreground mb-4 sm:mb-6",children:c?"  Nasabna":"Why Choose Nasabna?"}),o.jsx("p",{className:"text-base sm:text-lg text-muted-foreground mb-4 sm:mb-6",children:c?"         .             .":"We're passionate about helping families preserve their heritage and connect across generations. Our platform combines cutting-edge technology with intuitive design to make genealogy accessible to everyone."}),o.jsxs("ul",{className:"space-y-3 mb-6",children:[o.jsxs("li",{className:"flex items-start",children:[o.jsx(vi,{className:`h-5 w-5 text-primary flex-shrink-0 ${c?"ml-3":"mr-3"} mt-0.5`}),o.jsx("span",{className:"text-sm sm:text-base",children:c?"      ":"Trusted by thousands of families worldwide"})]}),o.jsxs("li",{className:"flex items-start",children:[o.jsx(vi,{className:`h-5 w-5 text-primary flex-shrink-0 ${c?"ml-3":"mr-3"} mt-0.5`}),o.jsx("span",{className:"text-sm sm:text-base",children:c?"     ":"Bank-level security for your family data"})]}),o.jsxs("li",{className:"flex items-start",children:[o.jsx(vi,{className:`h-5 w-5 text-primary flex-shrink-0 ${c?"ml-3":"mr-3"} mt-0.5`}),o.jsx("span",{className:"text-sm sm:text-base",children:c?"   ":"Continuous updates and new features"})]}),o.jsxs("li",{className:"flex items-start",children:[o.jsx(vi,{className:`h-5 w-5 text-primary flex-shrink-0 ${c?"ml-3":"mr-3"} mt-0.5`}),o.jsx("span",{className:"text-sm sm:text-base",children:c?"   ":"Dedicated customer support team"})]})]}),o.jsx(ye,{asChild:!0,variant:"outline",size:"lg",className:"px-6",children:o.jsxs(_t,{to:"/about",className:"flex items-center justify-center",children:[c?"  ":"Learn More About Us",o.jsx(Ki,{className:`ml-2 h-4 w-4 ${c?"rotate-180":""}`})]})})]}),o.jsx("div",{className:"relative flex items-center justify-center",children:o.jsx("img",{src:RI,alt:c?" ":"Happy family",className:"rounded-2xl shadow-lg w-full max-w-[280px] sm:max-w-xs md:max-w-sm lg:max-w-md h-auto object-cover"})})]})})}),o.jsx("section",{className:"py-20 bg-muted/50",children:o.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[o.jsx("h2",{className:"text-3xl sm:text-4xl font-bold mb-4 text-foreground",children:c?"     ":"Start Building Your Family Tree Today"}),o.jsx("p",{className:"text-xl mb-8 max-w-2xl mx-auto text-muted-foreground",children:c?"         Nasabna.     .":"Join thousands of families who are preserving their heritage with Nasabna. Choose the plan that fits your needs."}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[o.jsx(ye,{asChild:!0,size:"lg",className:"text-base sm:text-lg px-6 sm:px-8",children:o.jsxs(_t,{to:"/register",className:"flex items-center",children:[c?"  ":"Create Your Free Account",o.jsx(Ki,{className:`ml-2 h-5 w-5 ${c?"rotate-180":""}`})]})}),o.jsx(ye,{asChild:!0,size:"lg",variant:"outline",className:"text-base sm:text-lg px-6 sm:px-8",children:o.jsx(_t,{to:"/features",children:c?" ":"Explore Features"})})]})]})})]})};var uae=function(e,t){for(var n={};e.length;){var r=e[0],s=r.code,i=r.message,l=r.path.join(".");if(!n[l])if("unionErrors"in r){var a=r.unionErrors[0].errors[0];n[l]={message:a.message,type:a.code}}else n[l]={message:i,type:s};if("unionErrors"in r&&r.unionErrors.forEach(function(u){return u.errors.forEach(function(f){return e.push(f)})}),t){var c=n[l].types,d=c&&c[r.code];n[l]=gq(l,t,n,s,d?[].concat(d,r.message):r.message)}e.shift()}return n},r1=function(e,t,n){return n===void 0&&(n={}),function(r,s,i){try{return Promise.resolve(function(l,a){try{var c=Promise.resolve(e[n.mode==="sync"?"parse":"parseAsync"](r,t)).then(function(d){return i.shouldUseNativeValidation&&mq({},i),{errors:{},values:n.raw?r:d}})}catch(d){return a(d)}return c&&c.then?c.then(void 0,a):c}(0,function(l){if(function(a){return Array.isArray(a==null?void 0:a.errors)}(l))return{values:{},errors:pq(uae(l.errors,!i.shouldUseNativeValidation&&i.criteriaMode==="all"),i)};throw l}))}catch(l){return Promise.reject(l)}}};const dae=(e,t)=>{if(!(e!=null&&e.message))return{en:"Registration failed. Please try again.",ar:"  .    ."};const n=e.message.toLowerCase();return n.includes("email")&&(n.includes("exists")||n.includes("taken")||n.includes("duplicate"))?{en:"This email address is already registered. Please use a different email or try logging in.",ar:"    .         ."}:n.includes("username")&&(n.includes("exists")||n.includes("taken")||n.includes("duplicate"))?{en:"This username is already taken. Please choose a different username.",ar:"   .     ."}:n.includes("invalid email")||n.includes("email format")?{en:"Please enter a valid email address (example@domain.com).",ar:"      (@.com)."}:n.includes("password")&&(n.includes("requirements")||n.includes("weak")||n.includes("short"))?{en:"Password must be at least 8 characters long and contain uppercase letters, lowercase letters, and numbers.",ar:"       8         ."}:n.includes("network")||n.includes("connection")||n.includes("timeout")?{en:"Network connection error. Please check your internet connection and try again.",ar:"   .        ."}:n.includes("server")||n.includes("500")||n.includes("internal")?{en:"Server is temporarily unavailable. Please try again in a few minutes.",ar:"   .       ."}:n.includes("validation")||n.includes("invalid data")||n.includes("bad request")?{en:"Please check all fields and make sure they are filled correctly.",ar:"         ."}:n.includes("terms")||n.includes("conditions")?{en:"You must accept the terms and conditions to create an account.",ar:"       ."}:{en:e.message||"Registration failed. Please try again.",ar:e.message||"  .    ."}},fae=(e,t)=>{if(!(e!=null&&e.message))return{en:"Login failed. Please try again.",ar:"  .    ."};const n=e.message.toLowerCase();return n.includes("invalid")&&(n.includes("email")||n.includes("password")||n.includes("credentials"))?{en:"Invalid email or password. Please check your credentials and try again.",ar:"      .       ."}:n.includes("disabled")||n.includes("suspended")||n.includes("blocked")?{en:"Your account has been disabled. Please contact support for assistance.",ar:"  .      ."}:n.includes("too many")||n.includes("attempts")||n.includes("rate limit")?{en:"Too many failed login attempts. Please wait a few minutes before trying again.",ar:"    .        ."}:n.includes("network")||n.includes("connection")||n.includes("timeout")?{en:"Network connection error. Please check your internet connection and try again.",ar:"   .        ."}:n.includes("server")||n.includes("500")||n.includes("internal")?{en:"Server is temporarily unavailable. Please try again in a few minutes.",ar:"   .       ."}:{en:e.message||"Login failed. Please try again.",ar:e.message||"  .    ."}},Bt=be.forwardRef(({className:e,type:t="text",leftIcon:n,rightIcon:r,showPasswordToggle:s,error:i,...l},a)=>{const[c,d]=be.useState(!1),[u,f]=be.useState(t);be.useEffect(()=>{f(s&&t==="password"?c?"text":"password":t)},[c,t,s]);const m=()=>{d(!c)};return o.jsxs("div",{className:"relative",children:[n&&o.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground",children:n}),o.jsx("input",{type:u,className:wi("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",n&&"pl-10",(r||s)&&"pr-10",i&&"border-red-500 focus-visible:ring-red-500",e),ref:a,...l}),s&&t==="password"&&o.jsx("button",{type:"button",onClick:m,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground hover:text-foreground",children:c?o.jsx(kI,{className:"h-4 w-4"}):o.jsx(ra,{className:"h-4 w-4"})}),r&&!s&&o.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground",children:r}),i&&o.jsx("p",{className:"mt-1 text-sm text-red-600",children:i})]})});Bt.displayName="Input";const tn={success:(e,t)=>{const{showSuccess:n}=Ft.getState();return n(e,""),{dismiss:()=>{}}},error:(e,t)=>{const{showError:n,showErrorWithAction:r}=Ft.getState();return t!=null&&t.action?r(e,"",t.action):n(e,""),{dismiss:()=>{}}},warning:(e,t)=>{const{showWarning:n}=Ft.getState();return n(e,""),{dismiss:()=>{}}},info:(e,t)=>{const{showInfo:n}=Ft.getState();return n(e,""),{dismiss:()=>{}}},custom:(e,t)=>{const{showInfo:n}=Ft.getState();return n(typeof e=="string"?e:"Custom notification",""),{dismiss:()=>{}}},dismiss:()=>{},promise:async(e,t,n)=>{const r=tn.loading(t.loading);try{const s=await e;return r.dismiss(),tn.success(t.success),s}catch(s){throw tn.error(t.error),s}},loading:(e,t)=>{const{showInfo:n}=Ft.getState();return n(e,""),{dismiss:()=>{}}}};function _r(){const[e,t]=J.useState(!1);return J.useEffect(()=>{const n=()=>{t(window.innerWidth<768)};return n(),window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n)}},[]),{isMobile:e}}const hae=r0({email:mo().email("Please enter a valid email address"),password:mo().min(6,"Password must be at least 6 characters")}),mae=()=>{var y,p;const e=jr(),{setAuthData:t,clearAuth:n}=Mr(),{language:r}=Ft(),[s,i]=be.useState(!1),[l,a]=be.useState(!1),[c,d]=be.useState(""),{isMobile:u}=_r(),{register:f,handleSubmit:m,formState:{errors:h}}=zh({resolver:r1(hae)}),g=async x=>{if(!l){a(!0),d("");try{const b=await Vn.login(x);if(!b||!b.token||!b.user)throw new Error(r==="ar"?"    ":"Invalid login response");t(b.user,b.token),tn.success({en:"Welcome back! Login successful",ar:" !    "});const w=localStorage.getItem("attemptedPlan"),N=localStorage.getItem("attemptedBillingCycle");if(w&&N)localStorage.removeItem("attemptedPlan"),localStorage.removeItem("attemptedBillingCycle"),e(`/subscription/checkout?plan=${w}&billing=${N}`);else{const k=localStorage.getItem("attemptedUrl");k?(localStorage.removeItem("attemptedUrl"),e(k)):e("/dashboard")}}catch(b){n();const w=fae(b);tn.error(w),d(r==="ar"?w.ar:w.en)}finally{a(!1)}}};return o.jsxs(et,{className:`w-full ${u?"max-w-md mx-4":"max-w-md"}`,children:[o.jsxs(ht,{className:"space-y-1",children:[o.jsx(gt,{className:`text-2xl font-bold text-center ${u?"text-xl":""}`,children:r==="ar"?" ":"Sign In"}),o.jsx(qr,{className:"text-center",children:r==="ar"?"    ":"Enter your credentials to access your account"})]}),o.jsxs(rt,{children:[o.jsxs("form",{onSubmit:m(g),className:"space-y-4",children:[c&&o.jsx("div",{className:"p-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded-md",children:c}),o.jsx("div",{className:"space-y-2",children:o.jsx(Bt,{...f("email"),type:"email",placeholder:r==="ar"?" ":"Email address",leftIcon:o.jsx(Ra,{className:"h-4 w-4"}),error:(y=h.email)==null?void 0:y.message,disabled:l,className:u?"text-sm":""})}),o.jsx("div",{className:"space-y-2",children:o.jsx(Bt,{...f("password"),type:"password",placeholder:r==="ar"?" ":"Password",leftIcon:o.jsx(Di,{className:"h-4 w-4"}),showPasswordToggle:!0,error:(p=h.password)==null?void 0:p.message,disabled:l,className:u?"text-sm":""})}),o.jsx("div",{className:`flex justify-end ${u?"text-sm":""}`,children:o.jsx(_t,{to:"/forgot-password",className:"text-sm text-primary hover:text-primary/80 underline",children:r==="ar"?"  ":"Forgot password?"})}),o.jsx(ye,{type:"submit",className:`w-full ${u?"h-10 text-sm":""}`,loading:l,disabled:l,loadingText:r==="ar"?"  ...":"Signing in...",children:r==="ar"?" ":"Sign In"})]}),o.jsxs("div",{className:"relative my-6",children:[o.jsx("div",{className:"absolute inset-0 flex items-center",children:o.jsx("span",{className:"w-full border-t border-border"})}),o.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:o.jsx("span",{className:"bg-background px-2 text-muted-foreground",children:r==="ar"?"":"or"})})]}),o.jsx("div",{className:`text-center ${u?"text-sm":""}`,children:o.jsxs("p",{className:"text-sm text-muted-foreground",children:[r==="ar"?"   ":"Don't have an account? ",o.jsx(_t,{to:"/register",className:"text-primary hover:text-primary/80 underline font-medium",children:r==="ar"?"  ":"Sign up"})]})}),!1]})]})},pae=e=>r0({name:mo().min(2,e==="ar"?"        ":"Name must be at least 2 characters"),email:mo().email(e==="ar"?"     ":"Please enter a valid email address"),password:mo().min(8,e==="ar"?"       8   ":"Password must be at least 8 characters").regex(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/,e==="ar"?"             ":"Password must contain at least one uppercase letter, one lowercase letter, and one number"),confirmPassword:mo(),acceptTerms:xq({required_error:e==="ar"?"     ":"You must accept the terms and conditions"}).refine(t=>t===!0,{message:e==="ar"?"     ":"You must accept the terms and conditions"})}).refine(t=>t.password===t.confirmPassword,{message:e==="ar"?"   ":"Passwords don't match",path:["confirmPassword"]}),gae=()=>{var k,I,R,T;const e=jr(),[t]=t3(),{setAuthData:n,clearAuth:r}=Mr(),{language:s}=Ft(),{isMobile:i}=_r(),[l,a]=be.useState(!1),[c,d]=be.useState(""),u=t.get("plan"),f=pae(s),{register:m,handleSubmit:h,formState:{errors:g},watch:y}=zh({resolver:r1(f),defaultValues:{acceptTerms:!1}}),p=y("password"),x=y("acceptTerms"),b=async S=>{if(!l){a(!0),d("");try{const E=await Vn.register({name:S.name,firstName:S.name,lastName:"",email:S.email,password:S.password,confirmPassword:S.confirmPassword,language:s,acceptTerms:S.acceptTerms});if(!E||!E.token||!E.user)throw new Error(s==="ar"?"   ":"Invalid registration response");n(E.user,E.token),tn.success({en:"Welcome! Your account has been created successfully",ar:"!    "}),e(u?`/subscription?plan=${u}`:"/dashboard")}catch(E){r();const _=dae(E);tn.error(_),d(s==="ar"?_.ar:_.en)}finally{a(!1)}}},N=(S=>{if(!S)return{strength:0,label:""};let E=0;return E=[S.length>=8,/[a-z]/.test(S),/[A-Z]/.test(S),/\d/.test(S),/[!@#$%^&*(),.?":{}|<>]/.test(S)].filter(Boolean).length,{strength:E,label:{en:["Very Weak","Weak","Fair","Good","Strong"],ar:[" ","","","",""]}[s][Math.max(0,E-1)]||""}})(p||"");return o.jsxs(et,{className:`w-full ${i?"max-w-md mx-4":"max-w-md"}`,children:[o.jsxs(ht,{className:"space-y-1",children:[o.jsx(gt,{className:`text-2xl font-bold text-center ${i?"text-xl":""}`,children:s==="ar"?"  ":"Create Account"}),o.jsx(qr,{className:"text-center",children:s==="ar"?"    ":"Enter your information to create a new account"})]}),o.jsxs(rt,{children:[o.jsxs("form",{onSubmit:h(b),className:"space-y-4",children:[c&&o.jsx("div",{className:"p-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded-md",children:c}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Bt,{...m("name"),placeholder:s==="ar"?" ":"Full name",leftIcon:o.jsx(Xt,{className:"h-4 w-4"}),error:(k=g.name)==null?void 0:k.message,disabled:l,className:i?"text-sm":""}),o.jsxs("div",{className:"flex items-start space-x-2",children:[o.jsx(Qs,{className:"h-4 w-4 text-muted-foreground flex-shrink-0 mt-0.5"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:s==="ar"?"    ":"Name should be unique"})]})]}),o.jsx(Bt,{...m("email"),type:"email",placeholder:s==="ar"?" ":"Email address",leftIcon:o.jsx(Ra,{className:"h-4 w-4"}),error:(I=g.email)==null?void 0:I.message,disabled:l,className:i?"text-sm":""}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(Bt,{...m("password"),type:"password",placeholder:s==="ar"?" ":"Password",leftIcon:o.jsx(Di,{className:"h-4 w-4"}),showPasswordToggle:!0,error:(R=g.password)==null?void 0:R.message,disabled:l,className:i?"text-sm":""}),p&&o.jsx("div",{className:"space-y-2",children:o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("div",{className:"flex-1 bg-muted rounded-full h-2",children:o.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${N.strength<=2?"bg-destructive":N.strength<=3?"bg-yellow-500":"bg-green-500"}`,style:{width:`${N.strength/5*100}%`}})}),o.jsx("span",{className:`text-xs text-muted-foreground min-w-0 ${i?"text-xs":""}`,children:N.label})]})})]}),o.jsx(Bt,{...m("confirmPassword"),type:"password",placeholder:s==="ar"?"  ":"Confirm password",leftIcon:o.jsx(Di,{className:"h-4 w-4"}),showPasswordToggle:!0,error:(T=g.confirmPassword)==null?void 0:T.message,disabled:l,className:i?"text-sm":""}),o.jsxs("div",{className:`flex items-start space-x-2 ${i?"text-sm":""}`,children:[o.jsx("div",{className:"flex items-center h-5",children:o.jsx("input",{...m("acceptTerms"),type:"checkbox",className:"h-4 w-4 rounded border-border text-primary focus:ring-primary focus:ring-offset-0",disabled:l})}),o.jsxs("div",{className:"text-sm",children:[o.jsxs("label",{className:"text-muted-foreground",children:[s==="ar"?"  ":"I agree to the ",o.jsx(_t,{to:"/terms",className:"text-primary hover:text-primary/80 underline",children:s==="ar"?" ":"Terms and Conditions"}),s==="ar"?" ":" and ",o.jsx(_t,{to:"/privacy",className:"text-primary hover:text-primary/80 underline",children:s==="ar"?" ":"Privacy Policy"})]}),g.acceptTerms&&o.jsx("p",{className:"text-sm text-destructive mt-1",children:g.acceptTerms.message})]})]}),o.jsx(ye,{type:"submit",className:`w-full ${i?"h-10 text-sm":""}`,loading:l,disabled:l||!x,loadingText:s==="ar"?"  ...":"Creating account...",children:s==="ar"?" ":"Create Account"})]}),o.jsxs("div",{className:"relative my-6",children:[o.jsx("div",{className:"absolute inset-0 flex items-center",children:o.jsx("span",{className:"w-full border-t border-border"})}),o.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:o.jsx("span",{className:"bg-background px-2 text-muted-foreground",children:s==="ar"?"":"or"})})]}),o.jsx("div",{className:`text-center ${i?"text-sm":""}`,children:o.jsxs("p",{className:"text-sm text-muted-foreground",children:[s==="ar"?"   ":"Already have an account? ",o.jsx(_t,{to:"/login",className:"text-primary hover:text-primary/80 underline font-medium",children:s==="ar"?" ":"Sign in"})]})})]})]})},xae=r0({email:mo().email("Please enter a valid email address")}),yae=()=>{var f;const{language:e}=Ft(),[t,n]=be.useState(!1),[r,s]=be.useState(!1),{isMobile:i}=_r(),{register:l,handleSubmit:a,formState:{errors:c},getValues:d}=zh({resolver:r1(xae)}),u=async m=>{n(!0);try{await Vn.forgotPassword(m.email),s(!0),tn.success({en:"Password reset link sent to your email",ar:"         "})}catch{s(!0)}finally{n(!1)}};return r?o.jsxs(et,{className:`w-full ${i?"max-w-md mx-4":"max-w-md"}`,children:[o.jsxs(ht,{className:"space-y-1 text-center",children:[o.jsx("div",{className:"mx-auto w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mb-4",children:o.jsx(vi,{className:"h-6 w-6 text-green-600"})}),o.jsx(gt,{className:`text-2xl font-bold ${i?"text-xl":""}`,children:e==="ar"?"   ":"Email Sent"}),o.jsx(qr,{children:e==="ar"?"          ":"Check your email for a password reset link"})]}),o.jsxs(rt,{className:"space-y-4",children:[o.jsxs("div",{className:`text-center space-y-4 ${i?"text-sm":""}`,children:[o.jsx("p",{className:"text-sm text-muted-foreground",children:e==="ar"?"       :":"We sent a password reset link to:"}),o.jsx("p",{className:"font-medium text-foreground",children:d("email")}),o.jsx("p",{className:"text-sm text-muted-foreground",children:e==="ar"?"           .":"If you don't see the email, check your spam folder."})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsx(ye,{onClick:()=>s(!1),variant:"outline",className:`w-full ${i?"h-10 text-sm":""}`,children:e==="ar"?"  ":"Send Again"}),o.jsx(ye,{asChild:!0,variant:"ghost",className:`w-full ${i?"h-10 text-sm":""}`,children:o.jsxs(_t,{to:"/login",className:"flex items-center justify-center",children:[o.jsx(fl,{className:`w-4 h-4 ${i?"mr-1":"mr-2"}`}),e==="ar"?"  ":"Back to Sign In"]})})]})]})]}):o.jsxs(et,{className:`w-full ${i?"max-w-md mx-4":"max-w-md"}`,children:[o.jsxs(ht,{className:"space-y-1",children:[o.jsx(gt,{className:`text-2xl font-bold text-center ${i?"text-xl":""}`,children:e==="ar"?"  ":"Forgot Password?"}),o.jsx(qr,{className:"text-center",children:e==="ar"?"         ":"Enter your email address and we'll send you a password reset link"})]}),o.jsxs(rt,{children:[o.jsxs("form",{onSubmit:a(u),className:"space-y-4",children:[o.jsx(Bt,{...l("email"),type:"email",placeholder:e==="ar"?" ":"Email address",leftIcon:o.jsx(Ra,{className:"h-4 w-4"}),error:(f=c.email)==null?void 0:f.message,disabled:t,className:i?"text-sm":""}),o.jsx(ye,{type:"submit",className:`w-full ${i?"h-10 text-sm":""}`,loading:t,loadingText:e==="ar"?" ...":"Sending...",children:e==="ar"?"   ":"Send Reset Link"})]}),o.jsx("div",{className:"mt-6 text-center",children:o.jsx(ye,{asChild:!0,variant:"ghost",className:`w-full ${i?"h-10 text-sm":""}`,children:o.jsxs(_t,{to:"/login",className:"flex items-center justify-center",children:[o.jsx(fl,{className:`w-4 h-4 ${i?"mr-1":"mr-2"}`}),e==="ar"?"  ":"Back to Sign In"]})})}),o.jsx("div",{className:`mt-6 text-center ${i?"text-sm":""}`,children:o.jsxs("p",{className:"text-sm text-muted-foreground",children:[e==="ar"?"   ":"Remember your password? ",o.jsx(_t,{to:"/login",className:"text-primary hover:text-primary/80 underline font-medium",children:e==="ar"?" ":"Sign in"})]})})]})]})},vae=r0({password:mo().min(8,"Password must be at least 8 characters").regex(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/,"Password must contain at least one uppercase letter, one lowercase letter, and one number"),confirmPassword:mo()}).refine(e=>e.password===e.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]}),bae=()=>{var w,N;const e=jr(),[t]=t3(),{language:n}=Ft(),[r,s]=be.useState(!1),[i,l]=be.useState(!1),[a,c]=be.useState(!0),{isMobile:d}=_r(),u=t.get("token"),{register:f,handleSubmit:m,formState:{errors:h},watch:g}=zh({resolver:r1(vae)}),y=g("password");be.useEffect(()=>{u||c(!1)},[u]);const p=async k=>{var I,R;if(u){s(!0);try{await Vn.resetPassword("",u,k.password,k.confirmPassword),l(!0),tn.success({en:"Password reset successfully",ar:"     "})}catch(T){const S=(T==null?void 0:T.message)||(n==="ar"?"      ":"Failed to reset password");tn.error({en:S,ar:S}),((I=T==null?void 0:T.message)!=null&&I.includes("invalid")||(R=T==null?void 0:T.message)!=null&&R.includes("expired"))&&c(!1)}finally{s(!1)}}},b=(k=>{if(!k)return{strength:0,label:""};let I=0;return I=[k.length>=8,/[a-z]/.test(k),/[A-Z]/.test(k),/\d/.test(k),/[!@#$%^&*(),.?":{}|<>]/.test(k)].filter(Boolean).length,{strength:I,label:{en:["Very Weak","Weak","Fair","Good","Strong"],ar:[" ","","","",""]}[n][Math.max(0,I-1)]||""}})(y||"");return a?i?o.jsxs(et,{className:`w-full ${d?"max-w-md mx-4":"max-w-md"}`,children:[o.jsxs(ht,{className:"space-y-1 text-center",children:[o.jsx("div",{className:"mx-auto w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mb-4",children:o.jsx(vi,{className:"h-6 w-6 text-green-600"})}),o.jsx(gt,{className:`text-2xl font-bold ${d?"text-xl":""}`,children:n==="ar"?"    ":"Password Reset Complete"}),o.jsx(qr,{children:n==="ar"?"     .       .":"Your password has been successfully reset. You can now sign in with your new password."})]}),o.jsx(rt,{children:o.jsx(ye,{asChild:!0,className:`w-full ${d?"h-10 text-sm":""}`,onClick:()=>e("/login"),children:o.jsx(_t,{to:"/login",children:n==="ar"?" ":"Sign In"})})})]}):o.jsxs(et,{className:`w-full ${d?"max-w-md mx-4":"max-w-md"}`,children:[o.jsxs(ht,{className:"space-y-1",children:[o.jsx(gt,{className:`text-2xl font-bold text-center ${d?"text-xl":""}`,children:n==="ar"?"   ":"Reset Password"}),o.jsx(qr,{className:"text-center",children:n==="ar"?"   ":"Enter your new password"})]}),o.jsxs(rt,{children:[o.jsxs("form",{onSubmit:m(p),className:"space-y-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(Bt,{...f("password"),type:"password",placeholder:n==="ar"?"  ":"New password",leftIcon:o.jsx(Di,{className:"h-4 w-4"}),showPasswordToggle:!0,error:(w=h.password)==null?void 0:w.message,disabled:r,className:d?"text-sm":""}),y&&o.jsx("div",{className:"space-y-2",children:o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx("div",{className:"flex-1 bg-muted rounded-full h-2",children:o.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${b.strength<=2?"bg-destructive":b.strength<=3?"bg-yellow-500":"bg-green-500"}`,style:{width:`${b.strength/5*100}%`}})}),o.jsx("span",{className:`text-xs text-muted-foreground min-w-0 ${d?"text-xs":""}`,children:b.label})]})})]}),o.jsx(Bt,{...f("confirmPassword"),type:"password",placeholder:n==="ar"?"  ":"Confirm new password",leftIcon:o.jsx(Di,{className:"h-4 w-4"}),showPasswordToggle:!0,error:(N=h.confirmPassword)==null?void 0:N.message,disabled:r,className:d?"text-sm":""}),o.jsx(ye,{type:"submit",className:`w-full ${d?"h-10 text-sm":""}`,loading:r,loadingText:n==="ar"?"  ...":"Resetting...",children:n==="ar"?"   ":"Reset Password"})]}),o.jsx("div",{className:"mt-6 text-center",children:o.jsx(ye,{asChild:!0,variant:"ghost",className:`w-full ${d?"h-10 text-sm":""}`,children:o.jsx(_t,{to:"/login",children:n==="ar"?"  ":"Back to Sign In"})})})]})]}):o.jsxs(et,{className:`w-full ${d?"max-w-md mx-4":"max-w-md"}`,children:[o.jsxs(ht,{className:"space-y-1 text-center",children:[o.jsx("div",{className:"mx-auto w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mb-4",children:o.jsx(Qs,{className:"h-6 w-6 text-red-600"})}),o.jsx(gt,{className:`text-2xl font-bold ${d?"text-xl":""}`,children:n==="ar"?"  ":"Invalid Link"}),o.jsx(qr,{children:n==="ar"?"         ":"The password reset link is invalid or has expired"})]}),o.jsxs(rt,{className:"space-y-4",children:[o.jsx("div",{className:`text-center space-y-4 ${d?"text-sm":""}`,children:o.jsx("p",{className:"text-sm text-muted-foreground",children:n==="ar"?"       .":"Please request a new password reset link."})}),o.jsxs("div",{className:"space-y-3",children:[o.jsx(ye,{asChild:!0,className:`w-full ${d?"h-10 text-sm":""}`,children:o.jsx(_t,{to:"/forgot-password",children:n==="ar"?"  ":"Request New Link"})}),o.jsx(ye,{asChild:!0,variant:"outline",className:`w-full ${d?"h-10 text-sm":""}`,children:o.jsx(_t,{to:"/login",children:n==="ar"?"  ":"Back to Sign In"})})]})]})]})},wae=()=>{const[e]=t3(),{language:t}=Ft(),[n,r]=be.useState(!0),[s,i]=be.useState(!1),[l,a]=be.useState(!1),[c,d]=be.useState(""),[u,f]=be.useState(!1),{isMobile:m}=_r(),h=e.get("token");be.useEffect(()=>{h?g(h):(r(!1),a(!0),d(t==="ar"?"  ":"Verification token is missing"))},[h,t]);const g=async p=>{try{await Vn.verifyEmail(p),i(!0),tn.success({en:"Email verified successfully",ar:"    "})}catch(x){a(!0);const b=(x==null?void 0:x.message)||(t==="ar"?"    ":"Email verification failed");d(b),tn.error({en:b,ar:b})}finally{r(!1)}},y=async()=>{f(!0);try{await Vn.resendVerificationEmail(),tn.success({en:"Verification email sent again",ar:"     "})}catch(p){const x=(p==null?void 0:p.message)||(t==="ar"?"    ":"Failed to send verification email");tn.error({en:x,ar:x})}finally{f(!1)}};return n?o.jsx(et,{className:`w-full ${m?"max-w-md mx-4":"max-w-md"}`,children:o.jsxs(ht,{className:"space-y-1 text-center",children:[o.jsx("div",{className:"mx-auto w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center mb-4",children:o.jsx(mr,{className:"h-6 w-6 text-primary animate-spin"})}),o.jsx(gt,{className:`text-2xl font-bold ${m?"text-xl":""}`,children:t==="ar"?" ...":"Verifying..."}),o.jsx(qr,{children:t==="ar"?"      ":"Please wait while we verify your email address"})]})}):s?o.jsxs(et,{className:`w-full ${m?"max-w-md mx-4":"max-w-md"}`,children:[o.jsxs(ht,{className:"space-y-1 text-center",children:[o.jsx("div",{className:"mx-auto w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mb-4",children:o.jsx(vi,{className:"h-6 w-6 text-green-600"})}),o.jsx(gt,{className:`text-2xl font-bold ${m?"text-xl":""}`,children:t==="ar"?"  !":"Email Verified!"}),o.jsx(qr,{children:t==="ar"?"    .       .":"Your email has been successfully verified. You can now access all features."})]}),o.jsxs(rt,{className:"space-y-4",children:[o.jsx("div",{className:`text-center space-y-4 ${m?"text-sm":""}`,children:o.jsx("p",{className:"text-sm text-muted-foreground",children:t==="ar"?"   Nasabna!      .":"Welcome to Nasabna! Start building your family tree now."})}),o.jsxs("div",{className:"space-y-3",children:[o.jsx(ye,{asChild:!0,className:`w-full ${m?"h-10 text-sm":""}`,children:o.jsx(_t,{to:"/dashboard",children:t==="ar"?"   ":"Go to Dashboard"})}),o.jsx(ye,{asChild:!0,variant:"outline",className:`w-full ${m?"h-10 text-sm":""}`,children:o.jsx(_t,{to:"/login",children:t==="ar"?" ":"Sign In"})})]})]})]}):l?o.jsxs(et,{className:`w-full ${m?"max-w-md mx-4":"max-w-md"}`,children:[o.jsxs(ht,{className:"space-y-1 text-center",children:[o.jsx("div",{className:"mx-auto w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mb-4",children:o.jsx(Qs,{className:"h-6 w-6 text-red-600"})}),o.jsx(gt,{className:`text-2xl font-bold ${m?"text-xl":""}`,children:t==="ar"?" ":"Verification Failed"}),o.jsx(qr,{children:c})]}),o.jsxs(rt,{className:"space-y-4",children:[o.jsx("div",{className:`text-center space-y-4 ${m?"text-sm":""}`,children:o.jsx("p",{className:"text-sm text-muted-foreground",children:t==="ar"?"         .":"The verification link may have expired or already been used."})}),o.jsxs("div",{className:"space-y-3",children:[o.jsxs(ye,{onClick:y,className:`w-full ${m?"h-10 text-sm":""}`,loading:u,loadingText:t==="ar"?" ...":"Sending...",children:[o.jsx(Ra,{className:`w-4 h-4 ${m?"mr-1":"mr-2"}`}),t==="ar"?"   ":"Send New Verification Email"]}),o.jsx(ye,{asChild:!0,variant:"outline",className:`w-full ${m?"h-10 text-sm":""}`,children:o.jsx(_t,{to:"/login",children:t==="ar"?"  ":"Back to Sign In"})})]}),o.jsx("div",{className:`mt-6 text-center ${m?"text-sm":""}`,children:o.jsxs("p",{className:"text-sm text-muted-foreground",children:[t==="ar"?"  ":"Need help? ",o.jsx(_t,{to:"/contact",className:"text-primary hover:text-primary/80 underline",children:t==="ar"?" ":"Contact support"})]})})]})]}):null},Nae=()=>{const[e,t]=J.useState({}),[n,r]=J.useState(!1);return J.useEffect(()=>{const s="deviceMemory"in navigator||"memory"in performance&&performance.memory;if(r(!!s),!s)return;const i=()=>{const a={};if("deviceMemory"in navigator&&(a.deviceMemory=navigator.deviceMemory),"memory"in performance&&performance.memory){const c=performance.memory;a.totalJSHeapSize=c.totalJSHeapSize,a.usedJSHeapSize=c.usedJSHeapSize,a.jsHeapSizeLimit=c.jsHeapSizeLimit,a.isLowMemory=c.usedJSHeapSize>c.jsHeapSizeLimit*.8}t(a)};i();const l=setInterval(i,5e3);return()=>clearInterval(l)},[]),{memoryInfo:e,isSupported:n}},kd=be.forwardRef(({className:e,...t},n)=>o.jsx("textarea",{className:wi("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:n,...t}));kd.displayName="Textarea";const am=({isOpen:e,onClose:t,title:n,children:r,size:s="md"})=>{if(!e)return null;const i={sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl"};return o.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[o.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:t}),o.jsx("div",{className:"flex min-h-screen items-center justify-center p-4",children:o.jsxs("div",{className:`relative bg-background rounded-lg shadow-xl w-full ${i[s]} max-h-[90vh] overflow-y-auto`,onClick:l=>l.stopPropagation(),children:[o.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[n&&o.jsx("h3",{className:"text-lg font-semibold text-foreground",children:n}),o.jsx(ye,{variant:"ghost",size:"icon",onClick:t,className:"text-muted-foreground hover:text-foreground",children:o.jsx(ia,{className:"h-5 w-5"})})]}),o.jsx("div",{className:"p-4",children:r})]})})]})},R4=({isOpen:e,onClose:t,onSubmit:n,initialData:r,mode:s})=>{const{language:i}=Ft(),{trees:l}=As(),{isMobile:a}=_r(),c=i==="ar",[d,u]=J.useState(!1),[f,m]=J.useState(null),[h,g]=J.useState({name:(r==null?void 0:r.name)||"",description:(r==null?void 0:r.description)||"",descriptionEn:(r==null?void 0:r.descriptionEn)||"",isPublic:(r==null?void 0:r.isPublic)!==void 0?r.isPublic:!0}),y=async p=>{var x,b;p.preventDefault(),u(!0),m(null);try{if(!h.name.trim())throw new Error(c?"  ":"Tree name is required");let w;if(s==="create")w=await At.createTree(h.name,!h.isPublic,h.description);else{if(!(r!=null&&r.id))throw new Error(c?"  ":"Tree ID is missing");w=await At.updateTree(parseInt(r.id),h.name,!h.isPublic,h.description)}n({...w,description:h.description,descriptionEn:h.descriptionEn}),t()}catch(w){let N=c?"   ":"Failed to save tree";if(w.response)if(w.response.status===400)if((x=w.response.data)!=null&&x.message){const k=w.response.data.message.toLowerCase();k.includes("duplicate")||k.includes("already exists")||k.includes("in use")||k.includes("unique")?N=c?"   .    .":"Tree name is already in use. Please choose a different name.":N+=`: ${w.response.data.message}`}else N=c?"   .    .":"Tree name is already in use. Please choose a different name.";else(b=w.response.data)!=null&&b.message&&(N+=`: ${w.response.data.message}`);else w.message&&(N+=`: ${w.message}`);m(N)}finally{u(!1)}};return o.jsx(am,{isOpen:e,onClose:t,title:s==="create"?a?c?" ":"New Tree":c?"  ":"Create New Tree":c?" ":"Edit Tree",size:a?"xl":"md",children:o.jsxs("form",{onSubmit:y,className:"space-y-4",children:[f&&o.jsx("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-3",children:o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx(No,{className:"h-5 w-5 text-destructive flex-shrink-0 mt-0.5"}),o.jsx("p",{className:"text-destructive text-sm",children:f})]})}),o.jsx("div",{className:`grid grid-cols-1 ${a?"gap-3":"md:grid-cols-2 gap-4"}`,children:o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-sm font-medium",children:a?c?"":"Name":c?"  *":"Tree Name *"}),o.jsx(Bt,{value:h.name,onChange:p=>g(x=>({...x,name:p.target.value})),placeholder:c?" ":"Tree Name",required:!0,disabled:d,className:a?"text-sm py-2":""})]})}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-sm font-medium",children:a?c?"":"Description":c?" ":"Tree Description"}),o.jsx(kd,{value:h.description,onChange:p=>g(x=>({...x,description:p.target.value,descriptionEn:p.target.value})),placeholder:c?" ":"Tree Description",rows:3,disabled:d,className:a?"text-sm py-2":""})]}),o.jsxs("div",{className:`flex ${a?"flex-col gap-2":"gap-3 pt-4"}`,children:[o.jsxs(ye,{type:"submit",className:`flex items-center gap-2 ${a?"w-full":""}`,disabled:d,size:a?"sm":"default",children:[d?o.jsx(mr,{className:`animate-spin ${a?"h-3 w-3":"h-4 w-4"}`}):null,s==="create"?a?c?"":"Create":c?" ":"Create Tree":a?c?"":"Save":c?" ":"Save Changes"]}),o.jsx(ye,{variant:"outline",onClick:t,disabled:d,type:"button",className:a?"w-full":"",size:a?"sm":"default",children:c?"":"Cancel"})]})]})})},cp={getUserTreeLimit:async e=>{try{const n=await fetch(`https://qabael.premiumasp.net/api/FamilyTree/UserTreeLimit/${e}`);if(!n.ok)throw new Error(`Failed to fetch user limits: ${n.status} ${n.statusText}`);return await n.json()}catch(t){throw console.error("Error fetching user limits:",t),t}},getDefaultLimits:()=>({trees:1,people:10,photos:0,documents:0,storage:1073741824,collaborators:1})},Oc=()=>{const{user:e,isAuthenticated:t}=Mr(),[n,r]=J.useState(null),[s,i]=J.useState(null),[l,a]=J.useState(!0),[c,d]=J.useState(null),u=(e==null?void 0:e.role)==="admin",f=J.useCallback(async()=>{try{if(!t||!e){r(cp.getDefaultLimits()),i({trees:0,people:0,photos:0,documents:0,storage:0,collaborators:0}),a(!1);return}if(u){r({trees:0,people:0,photos:0,documents:0,storage:0,collaborators:0}),i({trees:0,people:0,photos:0,documents:0,storage:0,collaborators:0}),a(!1);return}const p=e.id;if(!p)throw new Error("User ID not found");const x=await cp.getUserTreeLimit(p);x.plan&&x.limits?r(x.limits):r(cp.getDefaultLimits());try{const b=await E5.getUsage();i({trees:b.trees,people:b.members,photos:b.photos,documents:b.documents,storage:b.storage,collaborators:0})}catch{i({trees:0,people:0,photos:0,documents:0,storage:0,collaborators:0})}}catch(p){r(cp.getDefaultLimits());try{const x=await E5.getUsage();i({trees:x.trees,people:x.members,photos:x.photos,documents:x.documents,storage:x.storage,collaborators:0})}catch{i({trees:0,people:0,photos:0,documents:0,storage:0,collaborators:0})}d(p.message||"Failed to fetch subscription limits")}finally{a(!1)}},[t,e,u]),m=J.useCallback(()=>{f()},[f]);return J.useEffect(()=>{f()},[f]),{limits:n,usage:s,isLoading:l,error:c,isLimitReached:(p,x)=>{if(u||!n)return!1;const b=n[p];return b===0?!1:x>=b},getRemainingCount:(p,x)=>{if(u)return 999999;if(!n)return 0;const b=n[p];return b===0?999999:Math.max(0,b-x)},canPerformAction:p=>!0,refreshLimits:m}},e$=({trees:e=[],onCancel:t,onSuccess:n})=>{const[r,s]=J.useState([]),[i,l]=J.useState(!1),[a,c]=J.useState(!1),[d,u]=J.useState(null),{isMobile:f}=_r(),{limits:m,isLimitReached:h}=Oc(),{register:g,handleSubmit:y,watch:p,setValue:x,formState:{errors:b}}=zh({defaultValues:{treeId:"",relatedPersonId:"",relationship:"son",fullName:"",gender:"male",birthDate:"",birthPlace:"",occupation:"",isDeceased:!1,deathDate:""}}),w=p("treeId"),N=p("gender"),k=p("isDeceased");J.useEffect(()=>{(async()=>{if(!w){s([]);return}try{c(!0);const S=await At.getPersonsInTree(Number(w));let E=[];if(Array.isArray(S))E=S;else if(S&&typeof S=="object"){const M=S;M.data&&Array.isArray(M.data)&&(E=M.data)}const _=E.map(M=>{var W,$,z,q;const A=((W=M.id)==null?void 0:W.toString())||(($=M.ID)==null?void 0:$.toString())||((z=M.Id)==null?void 0:z.toString())||((q=M.personId)==null?void 0:q.toString())||"",P=M.firstName||M.FirstName||M.firstname||M.firstNameEn||M.firstName_en||"",B=M.lastName||M.LastName||M.lastname||M.lastNameEn||M.lastName_en||"",L=M.fullName||M.FullName||M.fullname||M.name||"",D=M.displayName||M.DisplayName||M.displayname||"",V=M.fullArabicName||M.FullArabicName||M.fullarabicname||"",O=M.arabicName||M.ArabicName||M.arabicname||null;return{id:A,firstName:P||void 0,lastName:B||void 0,fullName:L||void 0,displayName:D||void 0,fullArabicName:V||void 0,arabicName:O||void 0}});s(_)}catch(S){console.error("Error loading persons:",S),u("Failed to load persons in selected tree")}finally{c(!1)}})()},[w]);const I=()=>N==="male"?[{value:"son",label:"Son"},{value:"husband",label:"Husband"}]:N==="female"?[{value:"daughter",label:"Daughter"},{value:"wife",label:"Wife"}]:[{value:"son",label:"Son"},{value:"daughter",label:"Daughter"},{value:"husband",label:"Husband"},{value:"wife",label:"Wife"}],R=async T=>{try{l(!0),u(null);let S=0;if(w)try{const _=await At.getPersonsInTree(Number(w));S=Array.isArray(_)?_.length:0}catch{console.warn("Could not fetch current person count, using usage data as fallback")}if(m&&h("people",S))throw new Error(`You've reached your person limit of ${m.people}. Please upgrade your subscription to add more people.`);const E=await At.addPersonToTree(T.fullName,T.birthDate,T.birthPlace,T.occupation,T.gender,T.deathDate,T.isDeceased,Number(T.treeId));if(T.relatedPersonId&&T.relationship)try{let _="";switch(T.relationship){case"son":_="Child";break;case"daughter":_="Child";break;case"husband":_="Spouse";break;case"wife":_="Spouse";break;default:_=T.relationship}await At.addRelationship(Number(T.relatedPersonId),Number(E.id),_)}catch{}n==null||n(E.id)}catch(S){u(S.message||"Failed to create person")}finally{l(!1)}};return o.jsxs("form",{onSubmit:y(R),className:"space-y-6",children:[o.jsxs("div",{className:`grid grid-cols-1 ${f?"gap-4":"md:grid-cols-2 gap-6"}`,children:[o.jsxs("div",{className:f?"":"md:col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Select Tree"}),o.jsxs("select",{...g("treeId",{required:"Tree is required"}),className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",disabled:i,children:[o.jsx("option",{value:"",children:"Select a tree"}),e.map(T=>o.jsx("option",{value:T.id,children:T.name},T.id))]}),b.treeId&&o.jsx("p",{className:"mt-1 text-sm text-red-500",children:b.treeId.message})]}),o.jsxs("div",{className:f?"":"md:col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:f?"Related Person":"Related Person (Optional)"}),o.jsxs("select",{...g("relatedPersonId"),className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",disabled:i||a||!w,children:[o.jsx("option",{value:"",children:"Select a person"}),r.map(T=>{let S=`Person ${T.id||"Unknown"}`;const E=T.firstName||T.FirstName||T.firstname||"",_=T.lastName||T.LastName||T.lastname||"",M=T.fullName||T.FullName||T.fullname||T.name||"",A=T.displayName||T.DisplayName||T.displayname||"",P=T.fullArabicName||T.FullArabicName||T.fullarabicname||"",B=T.arabicName||T.ArabicName||T.arabicname||null;if(M&&typeof M=="string"&&M.trim()!=="")S=M;else if(A&&typeof A=="string"&&A.trim()!=="")S=A;else if(E&&typeof E=="string"&&E.trim()!==""||_&&typeof _=="string"&&_.trim()!=="")S=`${E||""} ${_||""}`.trim();else if(P&&typeof P=="string"&&P.trim()!=="")S=P;else if(B&&typeof B=="object"){const L=B.firstName||B.FirstName||B.firstname||"",D=B.lastName||B.LastName||B.lastname||"",V=`${L||""} ${D||""}`.trim();V&&(S=V)}return o.jsx("option",{value:T.id,children:S},T.id)})]}),a&&o.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Loading persons..."})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Gender *"}),o.jsxs("select",{...g("gender",{required:"Gender is required"}),className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",disabled:i,children:[o.jsx("option",{value:"male",children:"Male"}),o.jsx("option",{value:"female",children:"Female"}),o.jsx("option",{value:"unknown",children:"Unknown"})]}),b.gender&&o.jsx("p",{className:"mt-1 text-sm text-red-500",children:b.gender.message})]}),o.jsxs("div",{className:f?"":"md:col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:f?"Relationship":"Relationship (Optional)"}),o.jsx("select",{...g("relationship"),className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",disabled:i,children:I().map(T=>o.jsx("option",{value:T.value,children:T.label},T.value))})]}),o.jsxs("div",{className:f?"":"md:col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Full Name *"}),o.jsx(Bt,{...g("fullName",{required:"Full name is required"}),placeholder:"Enter full name",disabled:i}),b.fullName&&o.jsx("p",{className:"mt-1 text-sm text-red-500",children:b.fullName.message})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Birth Date"}),o.jsx(Bt,{type:"date",...g("birthDate"),disabled:i})]}),o.jsxs("div",{className:f?"":"md:col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Birth Place"}),o.jsx(Bt,{...g("birthPlace"),placeholder:"Enter birth place",disabled:i})]}),o.jsxs("div",{className:f?"":"md:col-span-2",children:[o.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Occupation"}),o.jsx(Bt,{...g("occupation"),placeholder:"Enter occupation",disabled:i})]}),o.jsxs("div",{className:`flex items-center ${f?"":"md:col-span-2"}`,children:[o.jsx("input",{type:"checkbox",...g("isDeceased"),id:"isDeceased",className:"h-4 w-4 rounded border-input text-primary focus:ring-primary",disabled:i}),o.jsx("label",{htmlFor:"isDeceased",className:"ml-2 block text-sm text-foreground",children:"Is Deceased"})]}),k&&o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Death Date"}),o.jsx(Bt,{type:"date",...g("deathDate"),disabled:i})]})]}),d&&o.jsx("div",{className:"rounded-md bg-red-50 p-4",children:o.jsxs("div",{className:"flex",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),o.jsxs("div",{className:"ml-3",children:[o.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),o.jsx("div",{className:"mt-2 text-sm text-red-700",children:o.jsx("p",{children:d})})]})]})}),o.jsxs("div",{className:`flex ${f?"flex-col gap-2":"justify-end space-x-3"}`,children:[o.jsx(ye,{type:"button",variant:"outline",onClick:t,disabled:i,className:f?"w-full":"",children:"Cancel"}),o.jsx(ye,{type:"submit",loading:i,className:f?"w-full":"",children:"Create Person"})]})]})},jae=({isOpen:e,onClose:t,trees:n,onSuccess:r})=>o.jsx(am,{isOpen:e,onClose:t,title:"Add New Person",size:"lg",children:o.jsx("div",{className:"p-4",children:o.jsx(e$,{trees:n,onCancel:t,onSuccess:s=>{r==null||r(s),t()}})})}),Gx=({current:e,limit:t,label:n,showPercentage:r=!0})=>{const s=t>0?Math.min(100,e/t*100):0,i=e>t&&t>0,l=s>=80&&s<100;return o.jsxs("div",{className:"mb-3",children:[o.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[o.jsx("span",{className:"text-muted-foreground",children:n}),o.jsxs("span",{className:"font-medium",children:[e," ",t>0?`/ ${t}`:"/ ",r&&t>0&&o.jsxs("span",{className:"ml-2 text-xs",children:["(",Math.round(s),"%)"]})]})]}),o.jsx("div",{className:"w-full bg-muted rounded-full h-2",children:o.jsx("div",{className:`h-2 rounded-full ${i?"bg-destructive":l?"bg-yellow-500 dark:bg-yellow-600":"bg-primary"}`,style:{width:`${Math.min(100,s)}%`}})})]})},_ae=()=>{const{limits:e,usage:t,isLoading:n,error:r}=Oc(),{language:s}=Ft();if(n)return o.jsx(et,{children:o.jsx(rt,{className:"p-4",children:o.jsxs("div",{className:"space-y-3",children:[o.jsx("div",{className:"h-4 bg-muted rounded animate-pulse"}),o.jsx("div",{className:"h-4 bg-muted rounded animate-pulse w-3/4"}),o.jsx("div",{className:"h-4 bg-muted rounded animate-pulse w-1/2"})]})})});if(r)return o.jsx(et,{className:"border-destructive",children:o.jsx(rt,{className:"p-4",children:o.jsxs("div",{className:"flex items-center text-destructive",children:[o.jsx(Qs,{className:"h-5 w-5 mr-2"}),o.jsx("span",{children:s==="ar"?"    ":"Failed to load subscription status"})]})})});if(!e||!t)return null;const i=e.trees>0?Math.min(100,t.trees/e.trees*100):0,l=e.people>0?Math.min(100,t.people/e.people*100):0,a=e.storage>0?Math.min(100,t.storage/e.storage*100):0,c=i>100||l>100||a>100,d=!c&&(i>=80||l>=80||a>=80);return o.jsx(et,{children:o.jsxs(rt,{className:"p-4",children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsx("h3",{className:"font-medium",children:s==="ar"?" ":"Subscription Usage"}),c?o.jsxs("div",{className:"flex items-center text-destructive text-sm",children:[o.jsx(Qs,{className:"h-4 w-4 mr-1"}),s==="ar"?" ":"Over limit"]}):d?o.jsxs("div",{className:"flex items-center text-yellow-600 dark:text-yellow-500 text-sm",children:[o.jsx(Wu,{className:"h-4 w-4 mr-1"}),s==="ar"?" ":"Near limit"]}):o.jsxs("div",{className:"flex items-center text-green-600 dark:text-green-500 text-sm",children:[o.jsx(vi,{className:"h-4 w-4 mr-1"}),s==="ar"?"":"Good"]})]}),o.jsx(Gx,{current:t.trees,limit:e.trees,label:s==="ar"?"":"Trees"}),o.jsx(Gx,{current:t.people,limit:e.people,label:s==="ar"?" ":"Family Members"}),o.jsx(Gx,{current:Math.round(t.storage/(1024*1024)),limit:Math.round(e.storage/(1024*1024)),label:s==="ar"?" ()":"Storage (MB)"}),(c||d)&&o.jsx("div",{className:`mt-3 p-3 rounded-md text-sm ${c?"bg-destructive/10 text-destructive":"bg-yellow-500/10 text-yellow-700 dark:text-yellow-500"}`,children:c?s==="ar"?"   .      .":"You have exceeded your subscription limits. Please upgrade your subscription plan.":s==="ar"?"    .        .":"You are approaching your subscription limits. Please consider upgrading your subscription plan."})]})})},Sae=()=>{const{user:e,getCurrentUser:t}=Mr(),{language:n,showError:r}=Ft(),{trees:s,fetchTrees:i}=As(),{limits:l,usage:a}=Oc();jr();const{memoryInfo:c,isSupported:d}=Nae(),[u,f]=J.useState({trees:0,people:0,photos:0,documents:0}),[m,h]=J.useState([]),[g,y]=J.useState([]),[p,x]=J.useState(!0),[b,w]=J.useState(null),[N,k]=J.useState(!0),[I,R]=J.useState(!1),[T,S]=J.useState(!1),E=J.useCallback(async()=>{try{await t()}catch{r({en:"Failed to update user data",ar:"    "},{en:"An error occurred while updating your user information",ar:"       "})}},[t,r]);J.useEffect(()=>{e!=null&&e.firstName||E()},[E,e==null?void 0:e.firstName]);const _=J.useCallback(async(L=0)=>{var D,V,O;try{w(null),navigator.deviceMemory&&navigator.deviceMemory<2,N&&x(!0),await Promise.race([i(),new Promise((re,oe)=>setTimeout(()=>oe(new Error("Request timeout")),35e3))]);const H=s.length;let W=0,$=0,z=0;s.forEach(re=>{var oe,ie,Y;W+=((oe=re.stats)==null?void 0:oe.totalPeople)||0,$+=((ie=re.stats)==null?void 0:ie.totalPhotos)||0,z+=((Y=re.stats)==null?void 0:Y.totalDocuments)||0}),f({trees:H,people:W,photos:$,documents:z}),h([{id:1,type:"person_added",message:n==="ar"?"      ":"Added Ahmed Mohamed to Family Tree",time:"2 hours ago",icon:kn},{id:2,type:"photo_uploaded",message:n==="ar"?"     ":"Uploaded new photo for Fatima Ali",time:"1 day ago",icon:Yh},{id:3,type:"tree_created",message:n==="ar"?"    ":"Created new family tree",time:"3 days ago",icon:Yu}]),y([{id:1,type:"missing_parent",title:n==="ar"?"  ":"Add Parent Information",description:n==="ar"?"    ":"Add parent information for Ahmed Mohamed",priority:"high"},{id:2,type:"missing_photo",title:n==="ar"?"  ":"Add Profile Photo",description:n==="ar"?"   ":"Add a photo for Fatima Ali",priority:"medium"},{id:3,type:"missing_birth_date",title:n==="ar"?"  ":"Add Birth Date",description:n==="ar"?"    ":"Add birth date for Mohamed Ahmed",priority:"low"}])}catch(H){H.code==="ECONNABORTED"||H.message.includes("timeout")?(w(n==="ar"?"  .         .":"Connection timeout. Please check your internet connection and try again."),r({en:"Connection Timeout",ar:"  "},{en:"Connection timeout. Please check your internet connection and try again.",ar:"  .         ."})):H.code==="ERR_NETWORK"||H.message.includes("ERR_INSUFFICIENT_RESOURCES")?(w(n==="ar"?"  .       .":"Your system is low on resources. Please close other tabs and try again."),r({en:"Low System Resources",ar:"  "},{en:"Your system is low on resources. Please close other tabs and try again.",ar:"  .       ."})):((D=H.response)==null?void 0:D.status)===401?(w(n==="ar"?"   .     .":"Unauthorized access. Please log in again."),r({en:"Unauthorized Access",ar:"  "},{en:"Unauthorized access. Please log in again.",ar:"   .     ."})):((V=H.response)==null?void 0:V.status)>=500?(w(n==="ar"?"  .     .":"Server error. Please try again later."),r({en:"Server Error",ar:"  "},{en:"Server error. Please try again later.",ar:"  .     ."})):((O=H.response)==null?void 0:O.status)>=400?(w(n==="ar"?"  .    .":"Invalid request. Please try again."),r({en:"Invalid Request",ar:"  "},{en:"Invalid request. Please try again.",ar:"  .    ."})):navigator.onLine?(w(n==="ar"?"   .    .":"Failed to load data. Please try again."),r({en:"Failed to Load Data",ar:"   "},{en:"Failed to load data. Please try again.",ar:"   .    ."})):(w(n==="ar"?"   .    .":"You are offline. Please check your internet connection."),r({en:"Offline",ar:"  "},{en:"You are offline. Please check your internet connection.",ar:"   .    ."}))}finally{x(!1),k(!1)}},[n,i,s.length,r]);J.useEffect(()=>{_()},[_]);const M=[{title:n==="ar"?"  ":"Add New Person",description:n==="ar"?"     ":"Add a new family member to your tree",icon:rg,action:()=>S(!0),color:"bg-blue-500",disabled:!l||l.people>0&&a&&a.people>=l.people},{title:n==="ar"?"  ":"Create New Tree",description:n==="ar"?"   ":"Start a new family tree",icon:qn,action:()=>R(!0),color:"bg-green-500",disabled:l&&l.trees>0&&u.trees>=l.trees}],A=()=>o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:[...Array(4)].map((L,D)=>o.jsxs(et,{children:[o.jsxs(ht,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[o.jsx("div",{className:"h-4 w-24 bg-muted rounded animate-pulse"}),o.jsx("div",{className:"h-4 w-4 bg-muted rounded-full animate-pulse"})]}),o.jsxs(rt,{children:[o.jsx("div",{className:"h-6 w-8 bg-muted rounded animate-pulse mb-1"}),o.jsx("div",{className:"h-3 w-16 bg-muted rounded animate-pulse"})]})]},D))}),P=()=>o.jsxs("div",{children:[o.jsx("div",{className:"h-6 w-32 bg-muted rounded animate-pulse mb-4"}),o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[...Array(4)].map((L,D)=>o.jsx(et,{className:"h-24",children:o.jsxs("div",{className:"p-4 space-y-3",children:[o.jsx("div",{className:"h-6 w-6 bg-muted rounded animate-pulse"}),o.jsx("div",{className:"h-4 w-20 bg-muted rounded animate-pulse"}),o.jsx("div",{className:"h-3 w-16 bg-muted rounded animate-pulse"})]})},D))})]}),B=()=>o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[o.jsxs(et,{children:[o.jsx(ht,{children:o.jsx("div",{className:"h-5 w-32 bg-muted rounded animate-pulse"})}),o.jsx(rt,{children:o.jsx("div",{className:"space-y-4",children:[...Array(3)].map((L,D)=>o.jsxs("div",{className:"flex items-start space-x-3",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx("div",{className:"w-8 h-8 bg-muted rounded-full animate-pulse"})}),o.jsxs("div",{className:"flex-1 min-w-0 space-y-2",children:[o.jsx("div",{className:"h-4 w-48 bg-muted rounded animate-pulse"}),o.jsx("div",{className:"h-3 w-20 bg-muted rounded animate-pulse"})]})]},D))})})]}),o.jsxs(et,{children:[o.jsx(ht,{children:o.jsx("div",{className:"h-5 w-32 bg-muted rounded animate-pulse"})}),o.jsx(rt,{children:o.jsx("div",{className:"space-y-4",children:[...Array(3)].map((L,D)=>o.jsxs("div",{className:"flex items-start justify-between p-3 bg-muted/30 rounded-lg",children:[o.jsxs("div",{className:"flex-1 space-y-2",children:[o.jsx("div",{className:"h-4 w-32 bg-muted rounded animate-pulse"}),o.jsx("div",{className:"h-3 w-40 bg-muted rounded animate-pulse"})]}),o.jsx("div",{className:"h-6 w-6 bg-muted rounded animate-pulse"})]},D))})})]})]});return p&&N?o.jsxs("div",{className:"space-y-8",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[o.jsxs("div",{children:[o.jsx("div",{className:"h-8 w-48 bg-muted rounded animate-pulse mb-2"}),o.jsx("div",{className:"h-4 w-64 bg-muted rounded animate-pulse"})]}),o.jsx("div",{className:"mt-4 sm:mt-0",children:o.jsx("div",{className:"h-10 w-32 bg-muted rounded animate-pulse"})})]}),o.jsx(A,{}),o.jsx(P,{}),o.jsx(B,{})]}):b?o.jsxs("div",{className:"flex flex-col items-center justify-center h-64 space-y-4",children:[o.jsx(Qs,{className:"h-12 w-12 text-red-500"}),o.jsx("h3",{className:"text-xl font-medium text-foreground",children:n==="ar"?" ":"An error occurred"}),o.jsx("p",{className:"text-muted-foreground text-center max-w-md",children:b}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs(ye,{onClick:()=>_(),children:[o.jsx(ml,{className:"mr-2 h-4 w-4"}),n==="ar"?" ":"Try Again"]}),o.jsx(ye,{variant:"outline",asChild:!0,children:o.jsx(_t,{to:"/trees",children:n==="ar"?" ":"View Trees"})})]})]}):o.jsxs("div",{className:"space-y-8",children:[d&&c.isLowMemory&&o.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4",children:o.jsxs("div",{className:"flex",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx(Qs,{className:"h-5 w-5 text-yellow-400"})}),o.jsx("div",{className:"ml-3",children:o.jsx("p",{className:"text-sm text-yellow-700",children:n==="ar"?"  .       .":"Your system is low on resources. Please close other tabs to improve performance."})})]})}),o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-foreground",children:n==="ar"?` ${(e==null?void 0:e.firstName)||(e==null?void 0:e.email)||""}!`:`Welcome back, ${(e==null?void 0:e.firstName)||(e==null?void 0:e.email)||"User"}!`}),o.jsx("p",{className:"mt-2 text-muted-foreground",children:n==="ar"?"     ":"Here's an overview of your family tree"})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 mt-4 sm:mt-0",children:[(e==null?void 0:e.role)==="admin"&&o.jsx(ye,{asChild:!0,variant:"outline",children:o.jsxs(_t,{to:"/admin/dashboard",children:[o.jsx(gh,{className:"mr-2 h-4 w-4"}),n==="ar"?" ":"Admin Dashboard"]})}),o.jsx(ye,{asChild:!0,children:o.jsxs(_t,{to:"/trees",children:[n==="ar"?"  ":"View All Trees",o.jsx(Ki,{className:"mr-2 h-4 w-4"})]})})]})]}),p?o.jsx(A,{}):o.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:[o.jsxs(et,{children:[o.jsxs(ht,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[o.jsx(gt,{className:"text-sm font-medium",children:n==="ar"?" ":"Family Trees"}),o.jsx(qn,{className:"h-4 w-4 text-muted-foreground"})]}),o.jsxs(rt,{children:[o.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:u.trees}),o.jsxs("div",{className:"flex items-center justify-between mt-2",children:[o.jsxs("p",{className:"text-xs text-muted-foreground",children:[n==="ar"?" ":"of"," ",(l==null?void 0:l.trees)===0?"":(l==null?void 0:l.trees)||"1"," ",n==="ar"?"":"allowed"]}),l&&l.trees>0&&o.jsx("div",{className:"w-16 bg-muted rounded-full h-1.5",children:o.jsx("div",{className:"bg-primary h-1.5 rounded-full",style:{width:`${Math.min(100,u.trees/l.trees*100)}%`}})})]})]})]}),o.jsxs(et,{children:[o.jsxs(ht,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[o.jsx(gt,{className:"text-sm font-medium",children:n==="ar"?" ":"Family Members"}),o.jsx(kn,{className:"h-4 w-4 text-muted-foreground"})]}),o.jsxs(rt,{children:[o.jsx("div",{className:"text-xl sm:text-2xl font-bold",children:u.people}),o.jsxs("div",{className:"flex items-center justify-between mt-2",children:[o.jsxs("p",{className:"text-xs text-muted-foreground",children:[n==="ar"?" ":"of"," ",(l==null?void 0:l.people)===0?"":(l==null?void 0:l.people)||"10"," ",n==="ar"?"":"per tree"]}),a&&l&&l.people>0&&o.jsx("div",{className:"w-16 bg-muted rounded-full h-1.5",children:o.jsx("div",{className:"bg-primary h-1.5 rounded-full",style:{width:`${Math.min(100,a.people/l.people*100)}%`}})})]})]})]})]}),o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:M.map((L,D)=>o.jsx(et,{className:`cursor-pointer hover:shadow-md transition-shadow ${L.disabled?"opacity-50 cursor-not-allowed":""}`,onClick:L.disabled?void 0:L.action,children:o.jsxs(rt,{className:"p-6 flex flex-col items-center text-center",children:[o.jsx("div",{className:`w-12 h-12 ${L.color} rounded-full flex items-center justify-center mb-4`,children:o.jsx(L.icon,{className:"h-6 w-6 text-white"})}),o.jsx("h3",{className:`font-semibold ${L.disabled?"text-muted-foreground":"text-foreground"} mb-2`,children:L.title}),o.jsx("p",{className:"text-sm text-muted-foreground",children:L.description}),L.disabled&&o.jsx("p",{className:"text-xs text-destructive mt-2",children:n==="ar"?"   ":"Limit reached"})]})},D))}),o.jsx(R4,{isOpen:I,onClose:()=>R(!1),mode:"create",onSubmit:()=>{R(!1),_()}}),o.jsx(jae,{isOpen:T,onClose:()=>S(!1),trees:s,onSuccess:()=>{_()}}),(e==null?void 0:e.subscription)&&o.jsxs(et,{children:[o.jsx(ht,{children:o.jsxs(gt,{className:"flex items-center justify-between",children:[o.jsxs("span",{className:"flex items-center",children:[o.jsx(ng,{className:"h-5 w-5 mr-2"}),n==="ar"?" ":"Subscription Status"]}),o.jsx("span",{className:`px-3 py-1 text-xs rounded-full ${e.subscription.status==="active"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-100":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-100"}`,children:e.subscription.status==="active"?n==="ar"?"":"Active":n==="ar"?"":"Expired"})]})}),o.jsxs(rt,{children:[o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[o.jsxs("div",{children:[o.jsxs("p",{className:"text-sm text-foreground",children:[n==="ar"?" :":"Current Plan:",o.jsx("span",{className:"font-medium ml-1 capitalize",children:e.subscription.plan})]}),o.jsxs("p",{className:"text-xs text-muted-foreground",children:[n==="ar"?" :":"Expires on:",new Date(e.subscription.currentPeriodEnd).toLocaleDateString()]})]}),o.jsx(ye,{asChild:!0,variant:"outline",className:"mt-4 sm:mt-0",children:o.jsx(_t,{to:"/subscription",children:n==="ar"?" ":"Manage Subscription"})})]}),o.jsxs("div",{className:"mt-4 pt-4 border-t grid grid-cols-2 sm:grid-cols-4 gap-4",children:[o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-sm font-medium",children:n==="ar"?"":"Trees"}),o.jsxs("p",{className:"text-lg font-bold",children:[u.trees," ",o.jsxs("span",{className:"text-sm font-normal text-muted-foreground",children:["/ ",(l==null?void 0:l.trees)===0?"":(l==null?void 0:l.trees)||1]})]}),l&&l.trees>0&&o.jsx("div",{className:"w-full bg-muted rounded-full h-1.5 mt-1",children:o.jsx("div",{className:"bg-primary h-1.5 rounded-full",style:{width:`${Math.min(100,u.trees/l.trees*100)}%`}})})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-sm font-medium",children:n==="ar"?"":"People"}),o.jsxs("p",{className:"text-lg font-bold",children:[(a==null?void 0:a.people)||0," ",o.jsxs("span",{className:"text-sm font-normal text-muted-foreground",children:["/ ",(l==null?void 0:l.people)===0?"":(l==null?void 0:l.people)||10]})]}),a&&l&&l.people>0&&o.jsx("div",{className:"w-full bg-muted rounded-full h-1.5 mt-1",children:o.jsx("div",{className:"bg-primary h-1.5 rounded-full",style:{width:`${Math.min(100,a.people/l.people*100)}%`}})})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-sm font-medium",children:n==="ar"?"":"Photos"}),o.jsxs("p",{className:"text-lg font-bold",children:[(a==null?void 0:a.photos)||0," ",o.jsxs("span",{className:"text-sm font-normal text-muted-foreground",children:["/ ",(l==null?void 0:l.photos)===0?"":(l==null?void 0:l.photos)||0]})]}),a&&l&&l.photos>0&&o.jsx("div",{className:"w-full bg-muted rounded-full h-1.5 mt-1",children:o.jsx("div",{className:"bg-primary h-1.5 rounded-full",style:{width:`${Math.min(100,a.photos/l.photos*100)}%`}})})]}),o.jsxs("div",{className:"text-center",children:[o.jsx("p",{className:"text-sm font-medium",children:n==="ar"?"":"Storage"}),o.jsxs("p",{className:"text-lg font-bold",children:[a!=null&&a.storage?`${(a.storage/(1024*1024)).toFixed(0)}MB`:"0MB"," ",o.jsxs("span",{className:"text-sm font-normal text-muted-foreground",children:["/ ",(l==null?void 0:l.storage)===0?"":`${(((l==null?void 0:l.storage)||1073741824)/(1024*1024*1024)).toFixed(1)}GB`]})]}),a&&l&&l.storage>0&&o.jsx("div",{className:"w-full bg-muted rounded-full h-1.5 mt-1",children:o.jsx("div",{className:"bg-primary h-1.5 rounded-full",style:{width:`${Math.min(100,a.storage/l.storage*100)}%`}})})]})]}),o.jsx("div",{className:"mt-4 pt-4 border-t",children:o.jsx(_ae,{})})]})]})]})},Gn=({variant:e="default",className:t,children:n,...r})=>{const s={default:"bg-primary text-primary-foreground hover:bg-primary/80",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground border border-input bg-background hover:bg-accent hover:text-accent-foreground"};return o.jsx("div",{className:wi("inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",s[e],t),...r,children:n})},$4=({isOpen:e,onClose:t,onConfirm:n,title:r,message:s,confirmText:i,cancelText:l,variant:a="default"})=>{const{language:c}=Ft(),d=f=>f?typeof f=="string"?f:f[c]:"",u=()=>{n(),t()};return o.jsx(am,{isOpen:e,onClose:t,title:d(r),size:"sm",children:o.jsxs("div",{className:"space-y-6",children:[o.jsx("p",{className:"text-foreground",children:d(s)}),o.jsxs("div",{className:"flex justify-end space-x-3",children:[o.jsx(ye,{variant:"outline",onClick:t,children:d(l)||(c==="ar"?"":"Cancel")}),o.jsx(ye,{variant:a,onClick:u,children:d(i)||(c==="ar"?"":"Confirm")})]})]})})},Aae=()=>{const{language:e}=Ft(),{trees:t,publicTrees:n,fetchTrees:r,fetchPublicTrees:s,deleteTree:i,isLoading:l,error:a}=As(),{limits:c,isLimitReached:d}=Oc(),{isMobile:u}=_r(),f=jr(),[m,h]=J.useState(""),[g,y]=J.useState(null),[p,x]=J.useState(null),[b,w]=J.useState("myTrees"),[N,k]=J.useState(!1),[I,R]=J.useState(!1),[T,S]=J.useState(null),E=e==="ar",_=d("trees",t.length);J.useEffect(()=>{r(),s()},[r,s]);const M=async q=>{S(q),R(!0)},A=async()=>{if(T)try{x(T),await i(T)}catch{y(e==="ar"?"   ":"Failed to delete tree"),setTimeout(()=>y(null),3e3)}finally{x(null),S(null)}},P=t.filter(q=>{var G,re;return((G=q.name)==null?void 0:G.toLowerCase().includes(m.toLowerCase()))||((re=q.description)==null?void 0:re.toLowerCase().includes(m.toLowerCase()))}),B=n.filter(q=>{var G,re;return((G=q.name)==null?void 0:G.toLowerCase().includes(m.toLowerCase()))||((re=q.description)==null?void 0:re.toLowerCase().includes(m.toLowerCase()))}),L=q=>({family:e==="ar"?"":"Family",research:e==="ar"?"":"Research",historical:e==="ar"?"":"Historical",other:e==="ar"?"":"Other"})[q]||q,D=q=>{const G={family:"bg-blue-100 text-blue-800",research:"bg-purple-100 text-purple-800",historical:"bg-green-100 text-green-800",other:"bg-gray-100 text-gray-800"};return G[q]||G.other},V=a||g,O=b==="myTrees"?P:B,H=l&&b==="myTrees",W=l&&b==="publicTrees",$=q=>{r()},z=()=>{if(_){const q=(c==null?void 0:c.trees)||1,G=E?`       (${q} ).     .`:`You've reached the maximum number of trees (${q} trees). Please upgrade your subscription to create more.`;tn.error({en:G,ar:G},{action:{label:E?" ":"Upgrade Subscription",onClick:()=>window.location.assign("/subscription/plans")}});return}k(!0)};return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:`flex ${u?"flex-col gap-4":"flex-col sm:flex-row sm:items-center sm:justify-between"}`,children:[o.jsxs("div",{children:[o.jsx("h1",{className:`font-bold text-foreground ${u?"text-2xl":"text-3xl"}`,children:e==="ar"?" ":"Family Trees"}),o.jsx("p",{className:`mt-2 text-muted-foreground ${u?"text-sm":""}`,children:e==="ar"?"        ":"Manage and view all your family trees and public trees"})]}),o.jsxs("div",{className:u?"w-full":"mt-4 sm:mt-0",children:[_&&o.jsxs("div",{className:"mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg flex items-start gap-2",children:[o.jsx(No,{className:"h-5 w-5 text-yellow-600 flex-shrink-0 mt-0.5"}),o.jsx("p",{className:"text-sm text-yellow-800",children:E?"      .     .":"You've reached the maximum number of trees. Please upgrade your subscription to create more."})]}),o.jsxs(ye,{onClick:z,className:"w-full",size:u?"sm":"default",disabled:_,children:[o.jsx(Yu,{className:`mr-2 h-4 w-4 ${u?"h-3 w-3":""}`}),u?e==="ar"?"":"Create":e==="ar"?"  ":"Create New Tree"]})]})]}),o.jsx("div",{className:`border-b border-border ${u?"overflow-x-auto":""}`,children:o.jsxs("nav",{className:`flex ${u?"space-x-4 min-w-max":"space-x-8"}`,children:[o.jsxs("button",{onClick:()=>w("myTrees"),className:`py-3 px-1 border-b-2 font-medium text-sm ${b==="myTrees"?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground hover:border-muted"} ${u?"text-xs py-2":""}`,children:[e==="ar"?"":"My Trees",o.jsx("span",{className:`ml-2 text-xs rounded-full px-2 py-0.5 ${u?"text-xs px-1.5 py-0.5":""} bg-muted text-muted-foreground`,children:t.length})]}),o.jsxs("button",{onClick:()=>w("publicTrees"),className:`py-3 px-1 border-b-2 font-medium text-sm ${b==="publicTrees"?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground hover:border-muted"} ${u?"text-xs py-2":""}`,children:[e==="ar"?" ":"Public Trees",o.jsx("span",{className:`ml-2 text-xs rounded-full px-2 py-0.5 ${u?"text-xs px-1.5 py-0.5":""} bg-muted text-muted-foreground`,children:n.length})]})]})}),o.jsxs("div",{className:"relative",children:[o.jsx(Qi,{className:`absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground ${u?"left-2 h-3 w-3":""}`}),o.jsx(Bt,{placeholder:e==="ar"?"  ...":"Search trees...",value:m,onChange:q=>h(q.target.value),className:`pl-10 ${u?"pl-8 text-sm":""}`})]}),V&&o.jsx("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-3",children:o.jsx("p",{className:"text-destructive text-sm",children:V})}),(H||W)&&b==="myTrees"&&o.jsx("div",{className:"flex items-center justify-center py-12",children:o.jsx(mr,{className:"h-8 w-8 animate-spin text-primary"})}),!l&&o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:O.length===0?o.jsxs("div",{className:"col-span-full text-center py-12",children:[o.jsx(qn,{className:"mx-auto h-12 w-12 text-muted-foreground"}),o.jsx("h3",{className:"mt-4 font-medium",children:b==="myTrees"?e==="ar"?"   ":"No trees yet":e==="ar"?"   ":"No public trees"}),o.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:b==="myTrees"?e==="ar"?"    ":"Get started by creating a new family tree":e==="ar"?"     ":"No public trees available at the moment"})]}):O.map(q=>{var G,re;return o.jsxs(et,{className:"overflow-hidden",children:[o.jsxs("div",{className:"relative",children:[q.photoUrl?o.jsx("img",{src:q.photoUrl,alt:e==="ar"?" ":"Tree photo",className:"w-full h-48 object-cover"}):o.jsx("div",{className:"w-full h-48 bg-gradient-to-br from-primary/20 to-primary/40 flex items-center justify-center",children:o.jsx(qn,{className:"h-16 w-16 text-primary/30"})}),o.jsx("div",{className:"absolute top-3 right-3",children:o.jsx(Gn,{className:D(q.category||"other"),children:L(q.category||"other")})}),q.isPrivate&&o.jsx("div",{className:"absolute top-3 left-3",children:o.jsx(Di,{className:"h-5 w-5 text-white drop-shadow"})})]}),o.jsxs(ht,{className:"pb-2",children:[o.jsxs(gt,{className:"flex items-center justify-between",children:[o.jsx("span",{className:"truncate",children:q.name}),((G=q.owner)==null?void 0:G.id)&&o.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[o.jsx(Xt,{className:"h-3 w-3"}),o.jsxs("span",{children:[q.owner.firstName," ",q.owner.lastName]})]})]}),o.jsx(qr,{className:"line-clamp-2 text-sm",children:q.description||(e==="ar"?"  ":"No description")})]}),o.jsxs(rt,{children:[o.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground mb-4",children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(kn,{className:"h-4 w-4"}),o.jsxs("span",{children:[((re=q.stats)==null?void 0:re.totalPeople)||0," ",e==="ar"?"":"people"]})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(Lr,{className:"h-4 w-4"}),o.jsx("span",{children:new Date(q.createdAt||"").toLocaleDateString()})]})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs(ye,{size:"sm",variant:"outline",className:"flex-1",onClick:()=>f(`/trees/${q.id}`),children:[o.jsx(ra,{className:"h-4 w-4 mr-2"}),e==="ar"?"":"View"]}),b==="myTrees"&&o.jsxs(o.Fragment,{children:[o.jsx(ye,{size:"sm",variant:"outline",onClick:()=>f(`/trees/${q.id}/edit`),children:o.jsx(sa,{className:"h-4 w-4"})}),o.jsx(ye,{size:"sm",variant:"outline",onClick:()=>M(q.id),disabled:p===q.id,children:p===q.id?o.jsx(mr,{className:"h-4 w-4 animate-spin"}):o.jsx($a,{className:"h-4 w-4"})})]})]})]})]},q.id)})}),o.jsx($4,{isOpen:I,onClose:()=>R(!1),onConfirm:A,title:e==="ar"?" ":"Confirm Deletion",message:e==="ar"?"              .":"Are you sure you want to delete this tree?you will lose all data associated with this tree.",confirmText:e==="ar"?"":"Delete",cancelText:e==="ar"?"":"Cancel",variant:"destructive"}),o.jsx(R4,{isOpen:N,onClose:()=>k(!1),mode:"create",onSubmit:$})]})},kae="modulepreload",Eae=function(e){return"/"+e},FS={},Vp=function(t,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),a=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));s=Promise.allSettled(n.map(c=>{if(c=Eae(c),c in FS)return;FS[c]=!0;const d=c.endsWith(".css"),u=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${u}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":kae,d||(f.as="script"),f.crossOrigin="",f.href=c,a&&f.setAttribute("nonce",a),document.head.appendChild(f),d)return new Promise((m,h)=>{f.addEventListener("load",m),f.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(l){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=l,window.dispatchEvent(a),!a.defaultPrevented)throw l}return s.then(l=>{for(const a of l||[])a.status==="rejected"&&i(a.reason);return t().catch(i)})},Rh=({isOpen:e,onClose:t,onSubmit:n,familyTreeId:r,familyMembers:s,relationships:i=[],initialData:l,initialRelationshipData:a,mode:c})=>{const{language:d,theme:u}=Ft(),{limits:f,isLimitReached:m}=Oc(),{isMobile:h}=_r(),g=d==="ar",[y,p]=J.useState(!1),[x,b]=J.useState(null),[w,N]=J.useState({name:(l==null?void 0:l.name)||"",gender:(l==null?void 0:l.gender)||"male",birthDate:(l==null?void 0:l.birthDate)||"",deathDate:(l==null?void 0:l.deathDate)||"",birthPlace:(l==null?void 0:l.birthPlace)||"",birthPlaceEn:(l==null?void 0:l.birthPlaceEn)||"",occupation:(l==null?void 0:l.occupation)||"",occupationEn:(l==null?void 0:l.occupationEn)||"",isAlive:(l==null?void 0:l.isAlive)!==void 0?l.isAlive:!0,parentId:(a==null?void 0:a.parentId)||"",relationshipType:(a==null?void 0:a.relationshipType)||"",motherId:"",fatherId:"",motherSelection:""}),[k,I]=J.useState([]),[R,T]=J.useState(!1),[S,E]=J.useState(""),_=D=>{const V=[];return i&&Array.isArray(i)&&i.filter(H=>{var re,oe;const W=["Spouse","spouse","Husband","husband","Wife","wife"].includes(H.relationshipType),$=D.toString(),z=(re=H.personId)==null?void 0:re.toString(),q=(oe=H.relatedPersonId)==null?void 0:oe.toString();return W&&(z===$||q===$)}).forEach(H=>{var re,oe;const W=(re=H.personId)==null?void 0:re.toString(),$=(oe=H.relatedPersonId)==null?void 0:oe.toString(),z=D.toString(),q=W===z?$:W,G=s.find(ie=>ie.id.toString()===q);G&&V.push(G)}),V.length===0&&s.forEach(O=>{var W,$;let H=!1;if((W=O.relationships)!=null&&W.spouses&&(H=O.relationships.spouses.some(z=>typeof z=="string"?z===D:typeof z=="object"&&z.id?z.id===D:!1)),!H&&(($=O.relationships)!=null&&$.spouse)){const z=O.relationships.spouse;typeof z=="string"?H=z===D:typeof z=="object"&&z.id&&(H=z.id===D)}!H&&O.relationships&&Array.isArray(O.relationships)&&(H=O.relationships.some(z=>(z.type==="spouse"||z.relationshipType==="spouse")&&(z.personId===D||z.id===D))),!H&&O.spouseIds&&Array.isArray(O.spouseIds)&&(H=O.spouseIds.includes(D)),H&&V.push(O)}),V},M=D=>{let V=null,O=null,H=null,W=null;return i&&Array.isArray(i)&&i.filter(z=>{var oe;const q=z.relationshipType==="Child",G=D.toString(),re=(oe=z.relatedPersonId)==null?void 0:oe.toString();return q&&re===G}).forEach(z=>{var re;const q=(re=z.personId)==null?void 0:re.toString(),G=s.find(oe=>oe.id.toString()===q);G&&(G.gender==="male"?(V=G,H=z.id):G.gender==="female"&&(O=G,W=z.id))}),{father:V,mother:O,fatherRelationshipId:H,motherRelationshipId:W}};J.useEffect(()=>{if(w.parentId&&(w.relationshipType==="son"||w.relationshipType==="daughter")){const D=_(w.parentId);I(D),T(D.length>0),E("")}else I([]),T(!1),E("")},[w.parentId,w.relationshipType,s]),J.useEffect(()=>{if(l&&N(D=>({...D,name:l.name||"",gender:l.gender||"male",birthDate:l.birthDate||"",deathDate:l.deathDate||"",birthPlace:l.birthPlace||"",birthPlaceEn:l.birthPlaceEn||"",occupation:l.occupation||"",occupationEn:l.occupationEn||"",isAlive:l.isAlive!==void 0?l.isAlive:!0})),a&&N(D=>({...D,parentId:a.parentId||"",relationshipType:a.relationshipType||""})),c==="edit"&&(l!=null&&l.id)){const{father:D,mother:V}=M(l.id);D&&N(O=>({...O,fatherId:D.id})),V&&(N(O=>({...O,motherId:V.id})),E(V.id))}},[l,a,c]);const A=D=>{E(""),N(V=>({...V,parentId:D}))},P=()=>w.gender==="male"?[{value:"son",label:g?"":"Son"},{value:"husband",label:g?"":"Husband"}]:w.gender==="female"?[{value:"daughter",label:g?"":"Daughter"},{value:"wife",label:g?"":"Wife"}]:[{value:"son",label:g?"":"Son"},{value:"daughter",label:g?"":"Daughter"},{value:"husband",label:g?"":"Husband"},{value:"wife",label:g?"":"Wife"}],B=async D=>{var V,O,H,W,$;D.preventDefault(),p(!0),b(null);try{if(!w.name.trim())throw new Error(g?"   ":"Please enter a member name");if(c==="create"&&f&&m("people",s.length)){const q=f.people;throw new Error(g?`          (${q} ).     .`:`You've reached the maximum number of people in this tree (${q} people). Please upgrade your subscription to add more.`)}if(c==="create"&&w.parentId&&(w.relationshipType==="father"||w.relationshipType==="mother")){const q=s.find(G=>G.id===w.parentId);if(q&&q.relationships){if(w.relationshipType==="father"&&q.relationships.father)throw new Error(g?"     .":" This person already has a father.");if(w.relationshipType==="mother"&&q.relationships.mother)throw new Error(g?"     .":" This person already has a mother.")}}let z;if(c==="create"){if(z=await At.addPersonToTree(w.name,w.birthDate||"",g?w.birthPlace||"":w.birthPlaceEn||"",g?w.occupation||"":w.occupationEn||"",w.gender||"unknown",w.deathDate||"",!w.isAlive,parseInt(r)),w.parentId&&w.relationshipType)try{let q="";switch(w.relationshipType){case"son":q="Child";break;case"daughter":q="Child";break;case"husband":q="Spouse";break;case"wife":q="Spouse";break;default:q=w.relationshipType}w.relationshipType==="son"||w.relationshipType==="daughter"?(await At.addRelationship(parseInt(w.parentId),parseInt(z.id),q),S&&await At.addRelationship(parseInt(S),parseInt(z.id),q)):w.relationshipType==="father"||w.relationshipType==="mother"?await At.addRelationship(parseInt(z.id),parseInt(w.parentId),q):await At.addRelationship(parseInt(w.parentId),parseInt(z.id),q)}catch(q){console.error("Error adding relationship:",q)}}else{if(!(l!=null&&l.id))throw new Error(g?"     .    ":"Error updating member data. Please try again");if(z=await At.updatePerson(parseInt(l.id),w.name,w.birthDate||"",g?w.birthPlace||"":w.birthPlaceEn||"",g?w.occupation||"":w.occupationEn||"",w.gender||"unknown",parseInt(r)),l.id)try{const{father:q,mother:G,fatherRelationshipId:re,motherRelationshipId:oe}=M(l.id);if(w.fatherId!==((q==null?void 0:q.id)||"")){if(re)try{await At.deleteRelationship(re)}catch(ie){console.error("Error deleting father relationship:",ie)}w.fatherId&&await At.addRelationship(parseInt(w.fatherId),parseInt(l.id),"Child")}if(w.motherId!==((G==null?void 0:G.id)||"")){if(oe)try{await At.deleteRelationship(oe)}catch(ie){console.error("Error deleting mother relationship:",ie)}w.motherId&&await At.addRelationship(parseInt(w.motherId),parseInt(l.id),"Child")}}catch(q){console.error("Error updating parent relationships:",q)}}n(z),t()}catch(z){let q=g?"     .    ":"Error saving member data. Please try again";((V=z.response)==null?void 0:V.status)===400?q=g?"    ":"Please check the entered data":((O=z.response)==null?void 0:O.status)===401?q=g?"     ":"You must be logged in to perform this action":((H=z.response)==null?void 0:H.status)===403?q=g?"     ":"You do not have permission to perform this action":((W=z.response)==null?void 0:W.status)===404?q=g?"     ":"The requested member was not found":(($=z.response)==null?void 0:$.status)===500?q=g?"   .     ":"Server error. Please try again later":z.message&&(z.message.includes("Network Error")?q=g?"  .     ":"Network error. Please check your internet connection":z.message.includes("timeout")?q=g?"  .    ":"Request timeout. Please try again":q=z.message),b(q)}finally{p(!1)}};if(!e)return null;const L=h?"95vw":"600px";return o.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:D=>{D.target===D.currentTarget&&t()},children:o.jsxs("div",{className:"relative rounded-3xl shadow-2xl max-h-[95vh] overflow-hidden animate-in fade-in-0 zoom-in-95 duration-300",style:{width:L,background:u==="dark"?"linear-gradient(135deg, #1f2937 0%, #111827 100%)":"linear-gradient(135deg, #ffffff 0%, #f8fafc 100%)",border:`2px solid ${u==="dark"?"#374151":"#e2e8f0"}`},onClick:D=>D.stopPropagation(),children:[o.jsxs("div",{className:"relative px-6 py-4 overflow-hidden",style:{background:w.gender==="male"?"linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)":w.gender==="female"?"linear-gradient(135deg, #ec4899 0%, #be185d 100%)":"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)"},children:[o.jsx("button",{onClick:D=>{D.preventDefault(),D.stopPropagation(),t()},className:"absolute top-4 right-4 w-10 h-10 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center hover:bg-white/30 transition-all duration-200 group z-10",type:"button",children:o.jsx(ia,{size:20,className:"text-white group-hover:scale-110 transition-transform"})}),o.jsxs("div",{className:"flex items-center space-x-3 text-white",children:[o.jsx("div",{className:"w-12 h-12 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center",children:c==="create"?o.jsx(kn,{size:24,className:"text-white"}):o.jsx(Xt,{size:24,className:"text-white"})}),o.jsxs("div",{children:[o.jsx("h2",{className:"text-xl font-bold",children:c==="create"?g?"  ":"Add New Member":g?" ":"Edit Member"}),o.jsx("p",{className:"text-white/80 text-sm",children:c==="create"?g?"     ":"Add a new member to the family tree":g?"  ":"Edit member information"})]})]}),o.jsx("div",{className:"absolute -top-10 -right-10 w-32 h-32 rounded-full bg-white/5"}),o.jsx("div",{className:"absolute -bottom-5 -left-5 w-20 h-20 rounded-full bg-white/10"})]}),o.jsx("div",{className:"px-6 py-6 max-h-[calc(95vh-120px)] overflow-y-auto",children:o.jsxs("form",{onSubmit:B,className:"space-y-6",children:[x&&o.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-4",children:o.jsxs("div",{className:"flex items-start",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx("svg",{className:"h-5 w-5 text-red-500",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),o.jsx("div",{className:"ml-3 flex-1",children:x.includes("maximum number of people")||x.includes("   ")?o.jsxs("div",{className:"space-y-3",children:[o.jsx("h3",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:x}),o.jsxs("button",{type:"button",onClick:()=>window.location.assign("/subscription"),className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-lg text-white bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 focus:outline-none transition-all duration-200",children:[o.jsx("svg",{className:"-ml-0.5 mr-1 h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:o.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),g?" ":"Upgrade Subscription"]})]}):o.jsx("h3",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:x})})]})}),o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center space-x-2 pb-2 border-b border-gray-200 dark:border-gray-700",children:[o.jsx(Xt,{size:18,className:"text-blue-500"}),o.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100",children:g?" ":"Personal Information"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"md:col-span-2 space-y-2",children:[o.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300",children:[o.jsx(Xt,{size:14,className:"mr-2 text-gray-500"}),g?"  *":"Member Name *"]}),o.jsxs("div",{className:"relative",children:[o.jsx(Bt,{value:w.name,onChange:D=>N(V=>({...V,name:D.target.value})),placeholder:g?"  ":"Enter member name",required:!0,disabled:y,className:"pl-10 h-12 rounded-xl border-2 focus:border-blue-500 transition-all duration-200"}),o.jsx(Xt,{size:16,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300",children:[o.jsx(kn,{size:14,className:"mr-2 text-gray-500"}),g?"":"Gender"]}),o.jsxs("div",{className:"relative",children:[o.jsxs("select",{value:w.gender,onChange:D=>N(V=>({...V,gender:D.target.value})),className:`w-full h-12 px-4 pl-10 border-2 rounded-xl bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none transition-all duration-200 ${w.gender==="female"?"focus:border-pink-500 border-pink-300":w.gender==="male"?"focus:border-blue-500 border-blue-300":"focus:border-purple-500 border-gray-300"}`,disabled:y,children:[o.jsx("option",{value:"male",children:g?"":"Male"}),o.jsx("option",{value:"female",children:g?"":"Female"})]}),o.jsx(kn,{size:16,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none"})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300",children:[o.jsx(Lr,{size:14,className:"mr-2 text-gray-500"}),g?" ":"Birth Date"]}),o.jsxs("div",{className:"relative",children:[o.jsx(Bt,{type:"date",value:w.birthDate,onChange:D=>N(V=>({...V,birthDate:D.target.value})),disabled:y,className:"pl-10 h-12 rounded-xl border-2 focus:border-blue-500 transition-all duration-200"}),o.jsx(Lr,{size:16,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]})]}),!w.isAlive&&o.jsxs("div",{className:"space-y-2",children:[o.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300",children:[o.jsx(Lr,{size:14,className:"mr-2 text-gray-500"}),g?" ":"Death Date"]}),o.jsxs("div",{className:"relative",children:[o.jsx(Bt,{type:"date",value:w.deathDate,onChange:D=>N(V=>({...V,deathDate:D.target.value})),disabled:y,className:"pl-10 h-12 rounded-xl border-2 focus:border-red-500 transition-all duration-200"}),o.jsx(Lr,{size:16,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300",children:[o.jsx(ei,{size:14,className:"mr-2 text-gray-500"}),g?" ":"Birth Place"]}),o.jsxs("div",{className:"relative",children:[o.jsx(Bt,{value:g?w.birthPlace:w.birthPlaceEn,onChange:D=>N(V=>({...V,[g?"birthPlace":"birthPlaceEn"]:D.target.value})),placeholder:g?"  ":"Enter birth place",disabled:y,className:"pl-10 h-12 rounded-xl border-2 focus:border-green-500 transition-all duration-200"}),o.jsx(ei,{size:16,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300",children:[o.jsx(hl,{size:14,className:"mr-2 text-gray-500"}),g?"":"Occupation"]}),o.jsxs("div",{className:"relative",children:[o.jsx(Bt,{value:g?w.occupation:w.occupationEn,onChange:D=>N(V=>({...V,[g?"occupation":"occupationEn"]:D.target.value})),placeholder:g?" ":"Enter occupation",disabled:y,className:"pl-10 h-12 rounded-xl border-2 focus:border-purple-500 transition-all duration-200"}),o.jsx(hl,{size:16,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300",children:[o.jsx(br,{size:14,className:"mr-2 text-gray-500"}),g?"":"Status"]}),o.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-xl",children:[o.jsx("input",{type:"checkbox",checked:w.isAlive,onChange:D=>N(V=>({...V,isAlive:D.target.checked})),disabled:y,className:"h-5 w-5 text-green-600 focus:ring-green-500 border-gray-300 rounded"}),o.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:g?"  ":"Living"})]})]})]})]}),c==="create"&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center space-x-2 pb-2 border-b border-gray-200 dark:border-gray-700",children:[o.jsx(br,{size:18,className:"text-pink-500"}),o.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100",children:w.relationshipType==="father"?g?" ":"Add Father":w.relationshipType==="mother"?g?" ":"Add Mother":g?" ":"Family Relationships"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300",children:[o.jsx(kn,{size:14,className:"mr-2 text-gray-500"}),w.relationshipType==="father"||w.relationshipType==="mother"?g?"":"Child":g?"":"Parent"]}),o.jsxs("select",{value:w.parentId,onChange:D=>A(D.target.value),className:"w-full h-12 px-4 border-2 rounded-xl bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:border-blue-500 transition-all duration-200",disabled:y,children:[o.jsx("option",{value:"",children:g?" ":"Select Person"}),s.map(D=>o.jsx("option",{value:D.id,children:g?`${D.firstName} ${D.lastName}`:`${D.firstNameEn} ${D.lastNameEn}`},D.id))]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300",children:[o.jsx(br,{size:14,className:"mr-2 text-gray-500"}),g?" ":"Relationship Type"]}),o.jsxs("select",{value:w.relationshipType,onChange:D=>{const V=D.target.value;N(O=>({...O,relationshipType:V}))},className:"w-full h-12 px-4 border-2 rounded-xl bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:border-pink-500 transition-all duration-200",disabled:y||!w.parentId,children:[o.jsx("option",{value:"",children:g?"  ":"Select Relationship Type"}),P().map(D=>o.jsx("option",{value:D.value,children:D.label},D.value))]})]}),(w.relationshipType==="son"||w.relationshipType==="daughter")&&w.parentId&&o.jsx(o.Fragment,{children:k.length>0?o.jsxs("div",{className:"md:col-span-2 space-y-2",children:[o.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300",children:[o.jsx(br,{size:14,className:"mr-2 text-pink-500"}),g?" ":"Select Mother"]}),o.jsxs("select",{value:S,onChange:D=>{E(D.target.value),N(V=>({...V,motherId:D.target.value}))},className:"w-full h-12 px-4 border-2 rounded-xl bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:border-pink-500 transition-all duration-200",disabled:y,children:[o.jsx("option",{value:"",children:g?"     ":"Select mother from father's wives"}),k.filter(D=>D.gender==="female").map(D=>o.jsx("option",{value:D.id,children:g?`${D.firstName} ${D.lastName}`:`${D.firstNameEn} ${D.lastNameEn}`},D.id))]}),o.jsxs("p",{className:"text-sm text-gray-500 bg-pink-50 dark:bg-pink-900/20 p-3 rounded-lg border border-pink-200 dark:border-pink-800",children:[o.jsx(br,{size:16,className:"inline mr-2 text-pink-500"}),g?"           ":"The selected father has multiple wives, please choose the mother to connect the child to both parents"]})]}):o.jsx("div",{className:"md:col-span-2 space-y-2",children:o.jsxs("p",{className:"text-sm text-amber-600 bg-amber-50 dark:bg-amber-900/20 p-3 rounded-lg border border-amber-200 dark:border-amber-800",children:[o.jsx(br,{size:16,className:"inline mr-2 text-amber-500"}),g?"     .           .":"The selected father has no registered wives. You can add the child without specifying the mother, or add a wife to the father first."]})})})]})]}),c==="edit"&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center space-x-2 pb-2 border-b border-gray-200 dark:border-gray-700",children:[o.jsx(kn,{size:18,className:"text-blue-500"}),o.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100",children:g?" ":"Change Parents"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300",children:[o.jsx(Xt,{size:14,className:"mr-2 text-blue-500"}),g?"":"Father"]}),o.jsxs("select",{value:w.fatherId,onChange:D=>N(V=>({...V,fatherId:D.target.value})),className:"w-full h-12 px-4 border-2 rounded-xl bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:border-blue-500 transition-all duration-200",disabled:y,children:[o.jsx("option",{value:"",children:g?" ":"Select Father"}),s.filter(D=>D.gender==="male").map(D=>o.jsx("option",{value:D.id,children:g?`${D.firstName} ${D.lastName}`:`${D.firstNameEn} ${D.lastNameEn}`},D.id))]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300",children:[o.jsx(Xt,{size:14,className:"mr-2 text-pink-500"}),g?"":"Mother"]}),o.jsxs("select",{value:w.motherId,onChange:D=>{N(V=>({...V,motherId:D.target.value})),E(D.target.value)},className:"w-full h-12 px-4 border-2 rounded-xl bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:border-pink-500 transition-all duration-200",disabled:y,children:[o.jsx("option",{value:"",children:g?" ":"Select Mother"}),s.filter(D=>D.gender==="female").map(D=>o.jsx("option",{value:D.id,children:g?`${D.firstName} ${D.lastName}`:`${D.firstNameEn} ${D.lastNameEn}`},D.id))]})]})]})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-6 border-t border-gray-200 dark:border-gray-700",children:[o.jsxs(ye,{type:"submit",className:"flex-1 h-12 rounded-xl bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white font-medium transition-all duration-200 transform hover:scale-105",disabled:y,children:[y?o.jsx(mr,{className:"animate-spin h-5 w-5 mr-2"}):c==="create"?o.jsx(kn,{className:"h-5 w-5 mr-2"}):o.jsx(Xt,{className:"h-5 w-5 mr-2"}),c==="create"?g?" ":"Add Member":g?" ":"Save Changes"]}),o.jsx(ye,{variant:"outline",onClick:t,disabled:y,type:"button",className:"flex-1 sm:flex-none h-12 rounded-xl border-2 hover:bg-gray-50 dark:hover:bg-gray-800 transition-all duration-200",children:g?"":"Cancel"})]})]})})]})})};function ps(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=ps(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}const{useDebugValue:Cae}=be,{useSyncExternalStoreWithSelector:Pae}=WP,Iae=e=>e;function t$(e,t=Iae,n){const r=Pae(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return Cae(r),r}const DS=(e,t)=>{const n=BP(e),r=(s,i=t)=>t$(n,s,i);return Object.assign(r,n),r},Tae=(e,t)=>e?DS(e,t):DS;function ss(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,s]of e)if(!Object.is(s,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}const s1=J.createContext(null),Lae=s1.Provider,So={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},n$=So.error001();function tr(e,t){const n=J.useContext(s1);if(n===null)throw new Error(n$);return t$(n,e,t)}const es=()=>{const e=J.useContext(s1);if(e===null)throw new Error(n$);return J.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},Mae=e=>e.userSelectionActive?"none":"all";function O4({position:e,children:t,className:n,style:r,...s}){const i=tr(Mae),l=`${e}`.split("-");return be.createElement("div",{className:ps(["react-flow__panel",n,...l]),style:{...r,pointerEvents:i},...s},t)}function Rae({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:be.createElement(O4,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},be.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const $ae=({x:e,y:t,label:n,labelStyle:r={},labelShowBg:s=!0,labelBgStyle:i={},labelBgPadding:l=[2,4],labelBgBorderRadius:a=2,children:c,className:d,...u})=>{const f=J.useRef(null),[m,h]=J.useState({x:0,y:0,width:0,height:0}),g=ps(["react-flow__edge-textwrapper",d]);return J.useEffect(()=>{if(f.current){const y=f.current.getBBox();h({x:y.x,y:y.y,width:y.width,height:y.height})}},[n]),typeof n>"u"||!n?null:be.createElement("g",{transform:`translate(${e-m.width/2} ${t-m.height/2})`,className:g,visibility:m.width?"visible":"hidden",...u},s&&be.createElement("rect",{width:m.width+2*l[0],x:-l[0],y:-l[1],height:m.height+2*l[1],className:"react-flow__edge-textbg",style:i,rx:a,ry:a}),be.createElement("text",{className:"react-flow__edge-text",y:m.height/2,dy:"0.3em",ref:f,style:r},n),c)};var Oae=J.memo($ae);const F4=e=>({width:e.offsetWidth,height:e.offsetHeight}),hd=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),D4=(e={x:0,y:0},t)=>({x:hd(e.x,t[0][0],t[1][0]),y:hd(e.y,t[0][1],t[1][1])}),qS=(e,t,n)=>e<t?hd(Math.abs(e-t),1,50)/50:e>n?-hd(Math.abs(e-n),1,50)/50:0,r$=(e,t)=>{const n=qS(e.x,35,t.width-35)*20,r=qS(e.y,35,t.height-35)*20;return[n,r]},s$=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},i$=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),$h=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),a$=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),BS=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),Fae=(e,t)=>a$(i$($h(e),$h(t))),CN=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},Dae=e=>$i(e.width)&&$i(e.height)&&$i(e.x)&&$i(e.y),$i=e=>!isNaN(e)&&isFinite(e),Nr=Symbol.for("internals"),o$=["Enter"," ","Escape"],qae=(e,t)=>{},Bae=e=>"nativeEvent"in e;function PN(e){var s,i;const t=Bae(e)?e.nativeEvent:e,n=((i=(s=t.composedPath)==null?void 0:s.call(t))==null?void 0:i[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n==null?void 0:n.nodeName)||(n==null?void 0:n.hasAttribute("contenteditable"))||!!(n!=null&&n.closest(".nokey"))}const l$=e=>"clientX"in e,ul=(e,t)=>{var i,l;const n=l$(e),r=n?e.clientX:(i=e.touches)==null?void 0:i[0].clientX,s=n?e.clientY:(l=e.touches)==null?void 0:l[0].clientY;return{x:r-((t==null?void 0:t.left)??0),y:s-((t==null?void 0:t.top)??0)}},Wg=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0},om=({id:e,path:t,labelX:n,labelY:r,label:s,labelStyle:i,labelShowBg:l,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:f,markerStart:m,interactionWidth:h=20})=>be.createElement(be.Fragment,null,be.createElement("path",{id:e,style:u,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:f,markerStart:m}),h&&be.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:h,className:"react-flow__edge-interaction"}),s&&$i(n)&&$i(r)?be.createElement(Oae,{x:n,y:r,label:s,labelStyle:i,labelShowBg:l,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:d}):null);om.displayName="BaseEdge";function jf(e,t,n){return n===void 0?n:r=>{const s=t().edges.find(i=>i.id===e);s&&n(r,{...s})}}function c$({sourceX:e,sourceY:t,targetX:n,targetY:r}){const s=Math.abs(n-e)/2,i=n<e?n+s:n-s,l=Math.abs(r-t)/2,a=r<t?r+l:r-l;return[i,a,s,l]}function u$({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:s,sourceControlY:i,targetControlX:l,targetControlY:a}){const c=e*.125+s*.375+l*.375+n*.125,d=t*.125+i*.375+a*.375+r*.125,u=Math.abs(c-e),f=Math.abs(d-t);return[c,d,u,f]}var Ac;(function(e){e.Strict="strict",e.Loose="loose"})(Ac||(Ac={}));var cc;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(cc||(cc={}));var Oh;(function(e){e.Partial="partial",e.Full="full"})(Oh||(Oh={}));var il;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(il||(il={}));var mi;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(mi||(mi={}));var Tt;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(Tt||(Tt={}));function zS({pos:e,x1:t,y1:n,x2:r,y2:s}){return e===Tt.Left||e===Tt.Right?[.5*(t+r),n]:[t,.5*(n+s)]}function d$({sourceX:e,sourceY:t,sourcePosition:n=Tt.Bottom,targetX:r,targetY:s,targetPosition:i=Tt.Top}){const[l,a]=zS({pos:n,x1:e,y1:t,x2:r,y2:s}),[c,d]=zS({pos:i,x1:r,y1:s,x2:e,y2:t}),[u,f,m,h]=u$({sourceX:e,sourceY:t,targetX:r,targetY:s,sourceControlX:l,sourceControlY:a,targetControlX:c,targetControlY:d});return[`M${e},${t} C${l},${a} ${c},${d} ${r},${s}`,u,f,m,h]}const q4=J.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:s=Tt.Bottom,targetPosition:i=Tt.Top,label:l,labelStyle:a,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:m,markerEnd:h,markerStart:g,interactionWidth:y})=>{const[p,x,b]=d$({sourceX:e,sourceY:t,sourcePosition:s,targetX:n,targetY:r,targetPosition:i});return be.createElement(om,{path:p,labelX:x,labelY:b,label:l,labelStyle:a,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:m,markerEnd:h,markerStart:g,interactionWidth:y})});q4.displayName="SimpleBezierEdge";const US={[Tt.Left]:{x:-1,y:0},[Tt.Right]:{x:1,y:0},[Tt.Top]:{x:0,y:-1},[Tt.Bottom]:{x:0,y:1}},zae=({source:e,sourcePosition:t=Tt.Bottom,target:n})=>t===Tt.Left||t===Tt.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},HS=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function Uae({source:e,sourcePosition:t=Tt.Bottom,target:n,targetPosition:r=Tt.Top,center:s,offset:i}){const l=US[t],a=US[r],c={x:e.x+l.x*i,y:e.y+l.y*i},d={x:n.x+a.x*i,y:n.y+a.y*i},u=zae({source:c,sourcePosition:t,target:d}),f=u.x!==0?"x":"y",m=u[f];let h=[],g,y;const p={x:0,y:0},x={x:0,y:0},[b,w,N,k]=c$({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(l[f]*a[f]===-1){g=s.x??b,y=s.y??w;const R=[{x:g,y:c.y},{x:g,y:d.y}],T=[{x:c.x,y},{x:d.x,y}];l[f]===m?h=f==="x"?R:T:h=f==="x"?T:R}else{const R=[{x:c.x,y:d.y}],T=[{x:d.x,y:c.y}];if(f==="x"?h=l.x===m?T:R:h=l.y===m?R:T,t===r){const A=Math.abs(e[f]-n[f]);if(A<=i){const P=Math.min(i-1,i-A);l[f]===m?p[f]=(c[f]>e[f]?-1:1)*P:x[f]=(d[f]>n[f]?-1:1)*P}}if(t!==r){const A=f==="x"?"y":"x",P=l[f]===a[A],B=c[A]>d[A],L=c[A]<d[A];(l[f]===1&&(!P&&B||P&&L)||l[f]!==1&&(!P&&L||P&&B))&&(h=f==="x"?R:T)}const S={x:c.x+p.x,y:c.y+p.y},E={x:d.x+x.x,y:d.y+x.y},_=Math.max(Math.abs(S.x-h[0].x),Math.abs(E.x-h[0].x)),M=Math.max(Math.abs(S.y-h[0].y),Math.abs(E.y-h[0].y));_>=M?(g=(S.x+E.x)/2,y=h[0].y):(g=h[0].x,y=(S.y+E.y)/2)}return[[e,{x:c.x+p.x,y:c.y+p.y},...h,{x:d.x+x.x,y:d.y+x.y},n],g,y,N,k]}function Hae(e,t,n,r){const s=Math.min(HS(e,t)/2,HS(t,n)/2,r),{x:i,y:l}=t;if(e.x===i&&i===n.x||e.y===l&&l===n.y)return`L${i} ${l}`;if(e.y===l){const d=e.x<n.x?-1:1,u=e.y<n.y?1:-1;return`L ${i+s*d},${l}Q ${i},${l} ${i},${l+s*u}`}const a=e.x<n.x?1:-1,c=e.y<n.y?-1:1;return`L ${i},${l+s*c}Q ${i},${l} ${i+s*a},${l}`}function IN({sourceX:e,sourceY:t,sourcePosition:n=Tt.Bottom,targetX:r,targetY:s,targetPosition:i=Tt.Top,borderRadius:l=5,centerX:a,centerY:c,offset:d=20}){const[u,f,m,h,g]=Uae({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:s},targetPosition:i,center:{x:a,y:c},offset:d});return[u.reduce((p,x,b)=>{let w="";return b>0&&b<u.length-1?w=Hae(u[b-1],x,u[b+1],l):w=`${b===0?"M":"L"}${x.x} ${x.y}`,p+=w,p},""),f,m,h,g]}const i1=J.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,label:s,labelStyle:i,labelShowBg:l,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:d,style:u,sourcePosition:f=Tt.Bottom,targetPosition:m=Tt.Top,markerEnd:h,markerStart:g,pathOptions:y,interactionWidth:p})=>{const[x,b,w]=IN({sourceX:e,sourceY:t,sourcePosition:f,targetX:n,targetY:r,targetPosition:m,borderRadius:y==null?void 0:y.borderRadius,offset:y==null?void 0:y.offset});return be.createElement(om,{path:x,labelX:b,labelY:w,label:s,labelStyle:i,labelShowBg:l,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:h,markerStart:g,interactionWidth:p})});i1.displayName="SmoothStepEdge";const B4=J.memo(e=>{var t;return be.createElement(i1,{...e,pathOptions:J.useMemo(()=>{var n;return{borderRadius:0,offset:(n=e.pathOptions)==null?void 0:n.offset}},[(t=e.pathOptions)==null?void 0:t.offset])})});B4.displayName="StepEdge";function Vae({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[s,i,l,a]=c$({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,s,i,l,a]}const z4=J.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,label:s,labelStyle:i,labelShowBg:l,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:f,markerStart:m,interactionWidth:h})=>{const[g,y,p]=Vae({sourceX:e,sourceY:t,targetX:n,targetY:r});return be.createElement(om,{path:g,labelX:y,labelY:p,label:s,labelStyle:i,labelShowBg:l,labelBgStyle:a,labelBgPadding:c,labelBgBorderRadius:d,style:u,markerEnd:f,markerStart:m,interactionWidth:h})});z4.displayName="StraightEdge";function up(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function VS({pos:e,x1:t,y1:n,x2:r,y2:s,c:i}){switch(e){case Tt.Left:return[t-up(t-r,i),n];case Tt.Right:return[t+up(r-t,i),n];case Tt.Top:return[t,n-up(n-s,i)];case Tt.Bottom:return[t,n+up(s-n,i)]}}function U4({sourceX:e,sourceY:t,sourcePosition:n=Tt.Bottom,targetX:r,targetY:s,targetPosition:i=Tt.Top,curvature:l=.25}){const[a,c]=VS({pos:n,x1:e,y1:t,x2:r,y2:s,c:l}),[d,u]=VS({pos:i,x1:r,y1:s,x2:e,y2:t,c:l}),[f,m,h,g]=u$({sourceX:e,sourceY:t,targetX:r,targetY:s,sourceControlX:a,sourceControlY:c,targetControlX:d,targetControlY:u});return[`M${e},${t} C${a},${c} ${d},${u} ${r},${s}`,f,m,h,g]}const Gg=J.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:s=Tt.Bottom,targetPosition:i=Tt.Top,label:l,labelStyle:a,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:m,markerEnd:h,markerStart:g,pathOptions:y,interactionWidth:p})=>{const[x,b,w]=U4({sourceX:e,sourceY:t,sourcePosition:s,targetX:n,targetY:r,targetPosition:i,curvature:y==null?void 0:y.curvature});return be.createElement(om,{path:x,labelX:b,labelY:w,label:l,labelStyle:a,labelShowBg:c,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:m,markerEnd:h,markerStart:g,interactionWidth:p})});Gg.displayName="BezierEdge";const H4=J.createContext(null),Wae=H4.Provider;H4.Consumer;const Gae=()=>J.useContext(H4),Yae=e=>"id"in e&&"source"in e&&"target"in e,Xae=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`reactflow__edge-${e}${t||""}-${n}${r||""}`,TN=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(r=>`${r}=${e[r]}`).join("&")}`,Kae=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),f$=(e,t)=>{if(!e.source||!e.target)return t;let n;return Yae(e)?n={...e}:n={...e,id:Xae(e)},Kae(n,t)?t:t.concat(n)},LN=({x:e,y:t},[n,r,s],i,[l,a])=>{const c={x:(e-n)/s,y:(t-r)/s};return i?{x:l*Math.round(c.x/l),y:a*Math.round(c.y/a)}:c},h$=({x:e,y:t},[n,r,s])=>({x:e*s+n,y:t*s+r}),pc=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const n=(e.width??0)*t[0],r=(e.height??0)*t[1],s={x:e.position.x-n,y:e.position.y-r};return{...s,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-n,y:e.positionAbsolute.y-r}:s}},a1=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,s)=>{const{x:i,y:l}=pc(s,t).positionAbsolute;return i$(r,$h({x:i,y:l,width:s.width||0,height:s.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return a$(n)},m$=(e,t,[n,r,s]=[0,0,1],i=!1,l=!1,a=[0,0])=>{const c={x:(t.x-n)/s,y:(t.y-r)/s,width:t.width/s,height:t.height/s},d=[];return e.forEach(u=>{const{width:f,height:m,selectable:h=!0,hidden:g=!1}=u;if(l&&!h||g)return!1;const{positionAbsolute:y}=pc(u,a),p={x:y.x,y:y.y,width:f||0,height:m||0},x=CN(c,p),b=typeof f>"u"||typeof m>"u"||f===null||m===null,w=i&&x>0,N=(f||0)*(m||0);(b||w||x>=N||u.dragging)&&d.push(u)}),d},p$=(e,t)=>{const n=e.map(r=>r.id);return t.filter(r=>n.includes(r.source)||n.includes(r.target))},g$=(e,t,n,r,s,i=.1)=>{const l=t/(e.width*(1+i)),a=n/(e.height*(1+i)),c=Math.min(l,a),d=hd(c,r,s),u=e.x+e.width/2,f=e.y+e.height/2,m=t/2-u*d,h=n/2-f*d;return{x:m,y:h,zoom:d}},tc=(e,t=0)=>e.transition().duration(t);function WS(e,t,n,r){return(t[n]||[]).reduce((s,i)=>{var l,a;return`${e.id}-${i.id}-${n}`!==r&&s.push({id:i.id||null,type:n,nodeId:e.id,x:(((l=e.positionAbsolute)==null?void 0:l.x)??0)+i.x+i.width/2,y:(((a=e.positionAbsolute)==null?void 0:a.y)??0)+i.y+i.height/2}),s},[])}function Jae(e,t,n,r,s,i){const{x:l,y:a}=ul(e),d=t.elementsFromPoint(l,a).find(g=>g.classList.contains("react-flow__handle"));if(d){const g=d.getAttribute("data-nodeid");if(g){const y=V4(void 0,d),p=d.getAttribute("data-handleid"),x=i({nodeId:g,id:p,type:y});if(x){const b=s.find(w=>w.nodeId===g&&w.type===y&&w.id===p);return{handle:{id:p,type:y,nodeId:g,x:(b==null?void 0:b.x)||n.x,y:(b==null?void 0:b.y)||n.y},validHandleResult:x}}}}let u=[],f=1/0;if(s.forEach(g=>{const y=Math.sqrt((g.x-n.x)**2+(g.y-n.y)**2);if(y<=r){const p=i(g);y<=f&&(y<f?u=[{handle:g,validHandleResult:p}]:y===f&&u.push({handle:g,validHandleResult:p}),f=y)}}),!u.length)return{handle:null,validHandleResult:x$()};if(u.length===1)return u[0];const m=u.some(({validHandleResult:g})=>g.isValid),h=u.some(({handle:g})=>g.type==="target");return u.find(({handle:g,validHandleResult:y})=>h?g.type==="target":m?y.isValid:!0)||u[0]}const Zae={source:null,target:null,sourceHandle:null,targetHandle:null},x$=()=>({handleDomNode:null,isValid:!1,connection:Zae,endHandle:null});function y$(e,t,n,r,s,i,l){const a=s==="target",c=l.querySelector(`.react-flow__handle[data-id="${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`),d={...x$(),handleDomNode:c};if(c){const u=V4(void 0,c),f=c.getAttribute("data-nodeid"),m=c.getAttribute("data-handleid"),h=c.classList.contains("connectable"),g=c.classList.contains("connectableend"),y={source:a?f:n,sourceHandle:a?m:r,target:a?n:f,targetHandle:a?r:m};d.connection=y,h&&g&&(t===Ac.Strict?a&&u==="source"||!a&&u==="target":f!==n||m!==r)&&(d.endHandle={nodeId:f,handleId:m,type:u},d.isValid=i(y))}return d}function Qae({nodes:e,nodeId:t,handleId:n,handleType:r}){return e.reduce((s,i)=>{if(i[Nr]){const{handleBounds:l}=i[Nr];let a=[],c=[];l&&(a=WS(i,l,"source",`${t}-${n}-${r}`),c=WS(i,l,"target",`${t}-${n}-${r}`)),s.push(...a,...c)}return s},[])}function V4(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function Yx(e){e==null||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function eoe(e,t){let n=null;return t?n="valid":e&&!t&&(n="invalid"),n}function v$({event:e,handleId:t,nodeId:n,onConnect:r,isTarget:s,getState:i,setState:l,isValidConnection:a,edgeUpdaterType:c,onReconnectEnd:d}){const u=s$(e.target),{connectionMode:f,domNode:m,autoPanOnConnect:h,connectionRadius:g,onConnectStart:y,panBy:p,getNodes:x,cancelConnection:b}=i();let w=0,N;const{x:k,y:I}=ul(e),R=u==null?void 0:u.elementFromPoint(k,I),T=V4(c,R),S=m==null?void 0:m.getBoundingClientRect();if(!S||!T)return;let E,_=ul(e,S),M=!1,A=null,P=!1,B=null;const L=Qae({nodes:x(),nodeId:n,handleId:t,handleType:T}),D=()=>{if(!h)return;const[H,W]=r$(_,S);p({x:H,y:W}),w=requestAnimationFrame(D)};l({connectionPosition:_,connectionStatus:null,connectionNodeId:n,connectionHandleId:t,connectionHandleType:T,connectionStartHandle:{nodeId:n,handleId:t,type:T},connectionEndHandle:null}),y==null||y(e,{nodeId:n,handleId:t,handleType:T});function V(H){const{transform:W}=i();_=ul(H,S);const{handle:$,validHandleResult:z}=Jae(H,u,LN(_,W,!1,[1,1]),g,L,q=>y$(q,f,n,t,s?"target":"source",a,u));if(N=$,M||(D(),M=!0),B=z.handleDomNode,A=z.connection,P=z.isValid,l({connectionPosition:N&&P?h$({x:N.x,y:N.y},W):_,connectionStatus:eoe(!!N,P),connectionEndHandle:z.endHandle}),!N&&!P&&!B)return Yx(E);A.source!==A.target&&B&&(Yx(E),E=B,B.classList.add("connecting","react-flow__handle-connecting"),B.classList.toggle("valid",P),B.classList.toggle("react-flow__handle-valid",P))}function O(H){var W,$;(N||B)&&A&&P&&(r==null||r(A)),($=(W=i()).onConnectEnd)==null||$.call(W,H),c&&(d==null||d(H)),Yx(E),b(),cancelAnimationFrame(w),M=!1,P=!1,A=null,B=null,u.removeEventListener("mousemove",V),u.removeEventListener("mouseup",O),u.removeEventListener("touchmove",V),u.removeEventListener("touchend",O)}u.addEventListener("mousemove",V),u.addEventListener("mouseup",O),u.addEventListener("touchmove",V),u.addEventListener("touchend",O)}const GS=()=>!0,toe=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),noe=(e,t,n)=>r=>{const{connectionStartHandle:s,connectionEndHandle:i,connectionClickStartHandle:l}=r;return{connecting:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.handleId)===t&&(s==null?void 0:s.type)===n||(i==null?void 0:i.nodeId)===e&&(i==null?void 0:i.handleId)===t&&(i==null?void 0:i.type)===n,clickConnecting:(l==null?void 0:l.nodeId)===e&&(l==null?void 0:l.handleId)===t&&(l==null?void 0:l.type)===n}},b$=J.forwardRef(({type:e="source",position:t=Tt.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:s=!0,isConnectableEnd:i=!0,id:l,onConnect:a,children:c,className:d,onMouseDown:u,onTouchStart:f,...m},h)=>{var S,E;const g=l||null,y=e==="target",p=es(),x=Gae(),{connectOnClick:b,noPanClassName:w}=tr(toe,ss),{connecting:N,clickConnecting:k}=tr(noe(x,g,e),ss);x||(E=(S=p.getState()).onError)==null||E.call(S,"010",So.error010());const I=_=>{const{defaultEdgeOptions:M,onConnect:A,hasDefaultEdges:P}=p.getState(),B={...M,..._};if(P){const{edges:L,setEdges:D}=p.getState();D(f$(B,L))}A==null||A(B),a==null||a(B)},R=_=>{if(!x)return;const M=l$(_);s&&(M&&_.button===0||!M)&&v$({event:_,handleId:g,nodeId:x,onConnect:I,isTarget:y,getState:p.getState,setState:p.setState,isValidConnection:n||p.getState().isValidConnection||GS}),M?u==null||u(_):f==null||f(_)},T=_=>{const{onClickConnectStart:M,onClickConnectEnd:A,connectionClickStartHandle:P,connectionMode:B,isValidConnection:L}=p.getState();if(!x||!P&&!s)return;if(!P){M==null||M(_,{nodeId:x,handleId:g,handleType:e}),p.setState({connectionClickStartHandle:{nodeId:x,type:e,handleId:g}});return}const D=s$(_.target),V=n||L||GS,{connection:O,isValid:H}=y$({nodeId:x,id:g,type:e},B,P.nodeId,P.handleId||null,P.type,V,D);H&&I(O),A==null||A(_),p.setState({connectionClickStartHandle:null})};return be.createElement("div",{"data-handleid":g,"data-nodeid":x,"data-handlepos":t,"data-id":`${x}-${g}-${e}`,className:ps(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",w,d,{source:!y,target:y,connectable:r,connectablestart:s,connectableend:i,connecting:k,connectionindicator:r&&(s&&!N||i&&N)}]),onMouseDown:R,onTouchStart:R,onClick:b?T:void 0,ref:h,...m},c)});b$.displayName="Handle";var Oi=J.memo(b$);const w$=({data:e,isConnectable:t,targetPosition:n=Tt.Top,sourcePosition:r=Tt.Bottom})=>be.createElement(be.Fragment,null,be.createElement(Oi,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,be.createElement(Oi,{type:"source",position:r,isConnectable:t}));w$.displayName="DefaultNode";var MN=J.memo(w$);const N$=({data:e,isConnectable:t,sourcePosition:n=Tt.Bottom})=>be.createElement(be.Fragment,null,e==null?void 0:e.label,be.createElement(Oi,{type:"source",position:n,isConnectable:t}));N$.displayName="InputNode";var j$=J.memo(N$);const _$=({data:e,isConnectable:t,targetPosition:n=Tt.Top})=>be.createElement(be.Fragment,null,be.createElement(Oi,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label);_$.displayName="OutputNode";var S$=J.memo(_$);const W4=()=>null;W4.displayName="GroupNode";const roe=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),dp=e=>e.id;function soe(e,t){return ss(e.selectedNodes.map(dp),t.selectedNodes.map(dp))&&ss(e.selectedEdges.map(dp),t.selectedEdges.map(dp))}const A$=J.memo(({onSelectionChange:e})=>{const t=es(),{selectedNodes:n,selectedEdges:r}=tr(roe,soe);return J.useEffect(()=>{const s={nodes:n,edges:r};e==null||e(s),t.getState().onSelectionChange.forEach(i=>i(s))},[n,r,e]),null});A$.displayName="SelectionListener";const ioe=e=>!!e.onSelectionChange;function aoe({onSelectionChange:e}){const t=tr(ioe);return e||t?be.createElement(A$,{onSelectionChange:e}):null}const ooe=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function yu(e,t){J.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function Nn(e,t,n){J.useEffect(()=>{typeof t<"u"&&n({[e]:t})},[t])}const loe=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:s,onConnectStart:i,onConnectEnd:l,onClickConnectStart:a,onClickConnectEnd:c,nodesDraggable:d,nodesConnectable:u,nodesFocusable:f,edgesFocusable:m,edgesUpdatable:h,elevateNodesOnSelect:g,minZoom:y,maxZoom:p,nodeExtent:x,onNodesChange:b,onEdgesChange:w,elementsSelectable:N,connectionMode:k,snapGrid:I,snapToGrid:R,translateExtent:T,connectOnClick:S,defaultEdgeOptions:E,fitView:_,fitViewOptions:M,onNodesDelete:A,onEdgesDelete:P,onNodeDrag:B,onNodeDragStart:L,onNodeDragStop:D,onSelectionDrag:V,onSelectionDragStart:O,onSelectionDragStop:H,noPanClassName:W,nodeOrigin:$,rfId:z,autoPanOnConnect:q,autoPanOnNodeDrag:G,onError:re,connectionRadius:oe,isValidConnection:ie,nodeDragThreshold:Y})=>{const{setNodes:te,setEdges:we,setDefaultNodesAndEdges:me,setMinZoom:Ee,setMaxZoom:pe,setTranslateExtent:ee,setNodeExtent:ft,reset:$e}=tr(ooe,ss),De=es();return J.useEffect(()=>{const ge=r==null?void 0:r.map(Me=>({...Me,...E}));return me(n,ge),()=>{$e()}},[]),Nn("defaultEdgeOptions",E,De.setState),Nn("connectionMode",k,De.setState),Nn("onConnect",s,De.setState),Nn("onConnectStart",i,De.setState),Nn("onConnectEnd",l,De.setState),Nn("onClickConnectStart",a,De.setState),Nn("onClickConnectEnd",c,De.setState),Nn("nodesDraggable",d,De.setState),Nn("nodesConnectable",u,De.setState),Nn("nodesFocusable",f,De.setState),Nn("edgesFocusable",m,De.setState),Nn("edgesUpdatable",h,De.setState),Nn("elementsSelectable",N,De.setState),Nn("elevateNodesOnSelect",g,De.setState),Nn("snapToGrid",R,De.setState),Nn("snapGrid",I,De.setState),Nn("onNodesChange",b,De.setState),Nn("onEdgesChange",w,De.setState),Nn("connectOnClick",S,De.setState),Nn("fitViewOnInit",_,De.setState),Nn("fitViewOnInitOptions",M,De.setState),Nn("onNodesDelete",A,De.setState),Nn("onEdgesDelete",P,De.setState),Nn("onNodeDrag",B,De.setState),Nn("onNodeDragStart",L,De.setState),Nn("onNodeDragStop",D,De.setState),Nn("onSelectionDrag",V,De.setState),Nn("onSelectionDragStart",O,De.setState),Nn("onSelectionDragStop",H,De.setState),Nn("noPanClassName",W,De.setState),Nn("nodeOrigin",$,De.setState),Nn("rfId",z,De.setState),Nn("autoPanOnConnect",q,De.setState),Nn("autoPanOnNodeDrag",G,De.setState),Nn("onError",re,De.setState),Nn("connectionRadius",oe,De.setState),Nn("isValidConnection",ie,De.setState),Nn("nodeDragThreshold",Y,De.setState),yu(e,te),yu(t,we),yu(y,Ee),yu(p,pe),yu(T,ee),yu(x,ft),null},YS={display:"none"},coe={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},k$="react-flow__node-desc",E$="react-flow__edge-desc",uoe="react-flow__aria-live",doe=e=>e.ariaLiveMessage;function foe({rfId:e}){const t=tr(doe);return be.createElement("div",{id:`${uoe}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:coe},t)}function hoe({rfId:e,disableKeyboardA11y:t}){return be.createElement(be.Fragment,null,be.createElement("div",{id:`${k$}-${e}`,style:YS},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),be.createElement("div",{id:`${E$}-${e}`,style:YS},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&be.createElement(foe,{rfId:e}))}var Fh=(e=null,t={actInsideInputWithModifier:!0})=>{const[n,r]=J.useState(!1),s=J.useRef(!1),i=J.useRef(new Set([])),[l,a]=J.useMemo(()=>{if(e!==null){const d=(Array.isArray(e)?e:[e]).filter(f=>typeof f=="string").map(f=>f.split("+")),u=d.reduce((f,m)=>f.concat(...m),[]);return[d,u]}return[[],[]]},[e]);return J.useEffect(()=>{const c=typeof document<"u"?document:null,d=(t==null?void 0:t.target)||c;if(e!==null){const u=h=>{if(s.current=h.ctrlKey||h.metaKey||h.shiftKey,(!s.current||s.current&&!t.actInsideInputWithModifier)&&PN(h))return!1;const y=KS(h.code,a);i.current.add(h[y]),XS(l,i.current,!1)&&(h.preventDefault(),r(!0))},f=h=>{if((!s.current||s.current&&!t.actInsideInputWithModifier)&&PN(h))return!1;const y=KS(h.code,a);XS(l,i.current,!0)?(r(!1),i.current.clear()):i.current.delete(h[y]),h.key==="Meta"&&i.current.clear(),s.current=!1},m=()=>{i.current.clear(),r(!1)};return d==null||d.addEventListener("keydown",u),d==null||d.addEventListener("keyup",f),window.addEventListener("blur",m),()=>{d==null||d.removeEventListener("keydown",u),d==null||d.removeEventListener("keyup",f),window.removeEventListener("blur",m)}}},[e,r]),n};function XS(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(s=>t.has(s)))}function KS(e,t){return t.includes(e)?"code":"key"}function C$(e,t,n,r){var a,c;const s=e.parentNode||e.parentId;if(!s)return n;const i=t.get(s),l=pc(i,r);return C$(i,t,{x:(n.x??0)+l.x,y:(n.y??0)+l.y,z:(((a=i[Nr])==null?void 0:a.z)??0)>(n.z??0)?((c=i[Nr])==null?void 0:c.z)??0:n.z??0},r)}function P$(e,t,n){e.forEach(r=>{var i;const s=r.parentNode||r.parentId;if(s&&!e.has(s))throw new Error(`Parent node ${s} not found`);if(s||n!=null&&n[r.id]){const{x:l,y:a,z:c}=C$(r,e,{...r.position,z:((i=r[Nr])==null?void 0:i.z)??0},t);r.positionAbsolute={x:l,y:a},r[Nr].z=c,n!=null&&n[r.id]&&(r[Nr].isParent=!0)}})}function Xx(e,t,n,r){const s=new Map,i={},l=r?1e3:0;return e.forEach(a=>{var h;const c=($i(a.zIndex)?a.zIndex:0)+(a.selected?l:0),d=t.get(a.id),u={...a,positionAbsolute:{x:a.position.x,y:a.position.y}},f=a.parentNode||a.parentId;f&&(i[f]=!0);const m=(d==null?void 0:d.type)&&(d==null?void 0:d.type)!==a.type;Object.defineProperty(u,Nr,{enumerable:!1,value:{handleBounds:m||(h=d==null?void 0:d[Nr])==null?void 0:h.handleBounds,z:c}}),s.set(a.id,u)}),P$(s,n,i),s}function I$(e,t={}){const{getNodes:n,width:r,height:s,minZoom:i,maxZoom:l,d3Zoom:a,d3Selection:c,fitViewOnInitDone:d,fitViewOnInit:u,nodeOrigin:f}=e(),m=t.initial&&!d&&u;if(a&&c&&(m||!t.initial)){const g=n().filter(p=>{var b;const x=t.includeHiddenNodes?p.width&&p.height:!p.hidden;return(b=t.nodes)!=null&&b.length?x&&t.nodes.some(w=>w.id===p.id):x}),y=g.every(p=>p.width&&p.height);if(g.length>0&&y){const p=a1(g,f),{x,y:b,zoom:w}=g$(p,r,s,t.minZoom??i,t.maxZoom??l,t.padding??.1),N=dc.translate(x,b).scale(w);return typeof t.duration=="number"&&t.duration>0?a.transform(tc(c,t.duration),N):a.transform(c,N),!0}}return!1}function moe(e,t){return e.forEach(n=>{const r=t.get(n.id);r&&t.set(r.id,{...r,[Nr]:r[Nr],selected:n.selected})}),new Map(t)}function poe(e,t){return t.map(n=>{const r=e.find(s=>s.id===n.id);return r&&(n.selected=r.selected),n})}function fp({changedNodes:e,changedEdges:t,get:n,set:r}){const{nodeInternals:s,edges:i,onNodesChange:l,onEdgesChange:a,hasDefaultNodes:c,hasDefaultEdges:d}=n();e!=null&&e.length&&(c&&r({nodeInternals:moe(e,s)}),l==null||l(e)),t!=null&&t.length&&(d&&r({edges:poe(t,i)}),a==null||a(t))}const vu=()=>{},goe={zoomIn:vu,zoomOut:vu,zoomTo:vu,getZoom:()=>1,setViewport:vu,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:vu,fitBounds:vu,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},xoe=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),yoe=()=>{const e=es(),{d3Zoom:t,d3Selection:n}=tr(xoe,ss);return J.useMemo(()=>n&&t?{zoomIn:s=>t.scaleBy(tc(n,s==null?void 0:s.duration),1.2),zoomOut:s=>t.scaleBy(tc(n,s==null?void 0:s.duration),1/1.2),zoomTo:(s,i)=>t.scaleTo(tc(n,i==null?void 0:i.duration),s),getZoom:()=>e.getState().transform[2],setViewport:(s,i)=>{const[l,a,c]=e.getState().transform,d=dc.translate(s.x??l,s.y??a).scale(s.zoom??c);t.transform(tc(n,i==null?void 0:i.duration),d)},getViewport:()=>{const[s,i,l]=e.getState().transform;return{x:s,y:i,zoom:l}},fitView:s=>I$(e.getState,s),setCenter:(s,i,l)=>{const{width:a,height:c,maxZoom:d}=e.getState(),u=typeof(l==null?void 0:l.zoom)<"u"?l.zoom:d,f=a/2-s*u,m=c/2-i*u,h=dc.translate(f,m).scale(u);t.transform(tc(n,l==null?void 0:l.duration),h)},fitBounds:(s,i)=>{const{width:l,height:a,minZoom:c,maxZoom:d}=e.getState(),{x:u,y:f,zoom:m}=g$(s,l,a,c,d,(i==null?void 0:i.padding)??.1),h=dc.translate(u,f).scale(m);t.transform(tc(n,i==null?void 0:i.duration),h)},project:s=>{const{transform:i,snapToGrid:l,snapGrid:a}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),LN(s,i,l,a)},screenToFlowPosition:s=>{const{transform:i,snapToGrid:l,snapGrid:a,domNode:c}=e.getState();if(!c)return s;const{x:d,y:u}=c.getBoundingClientRect(),f={x:s.x-d,y:s.y-u};return LN(f,i,l,a)},flowToScreenPosition:s=>{const{transform:i,domNode:l}=e.getState();if(!l)return s;const{x:a,y:c}=l.getBoundingClientRect(),d=h$(s,i);return{x:d.x+a,y:d.y+c}},viewportInitialized:!0}:goe,[t,n])};function G4(){const e=yoe(),t=es(),n=J.useCallback(()=>t.getState().getNodes().map(y=>({...y})),[]),r=J.useCallback(y=>t.getState().nodeInternals.get(y),[]),s=J.useCallback(()=>{const{edges:y=[]}=t.getState();return y.map(p=>({...p}))},[]),i=J.useCallback(y=>{const{edges:p=[]}=t.getState();return p.find(x=>x.id===y)},[]),l=J.useCallback(y=>{const{getNodes:p,setNodes:x,hasDefaultNodes:b,onNodesChange:w}=t.getState(),N=p(),k=typeof y=="function"?y(N):y;if(b)x(k);else if(w){const I=k.length===0?N.map(R=>({type:"remove",id:R.id})):k.map(R=>({item:R,type:"reset"}));w(I)}},[]),a=J.useCallback(y=>{const{edges:p=[],setEdges:x,hasDefaultEdges:b,onEdgesChange:w}=t.getState(),N=typeof y=="function"?y(p):y;if(b)x(N);else if(w){const k=N.length===0?p.map(I=>({type:"remove",id:I.id})):N.map(I=>({item:I,type:"reset"}));w(k)}},[]),c=J.useCallback(y=>{const p=Array.isArray(y)?y:[y],{getNodes:x,setNodes:b,hasDefaultNodes:w,onNodesChange:N}=t.getState();if(w){const I=[...x(),...p];b(I)}else if(N){const k=p.map(I=>({item:I,type:"add"}));N(k)}},[]),d=J.useCallback(y=>{const p=Array.isArray(y)?y:[y],{edges:x=[],setEdges:b,hasDefaultEdges:w,onEdgesChange:N}=t.getState();if(w)b([...x,...p]);else if(N){const k=p.map(I=>({item:I,type:"add"}));N(k)}},[]),u=J.useCallback(()=>{const{getNodes:y,edges:p=[],transform:x}=t.getState(),[b,w,N]=x;return{nodes:y().map(k=>({...k})),edges:p.map(k=>({...k})),viewport:{x:b,y:w,zoom:N}}},[]),f=J.useCallback(({nodes:y,edges:p})=>{const{nodeInternals:x,getNodes:b,edges:w,hasDefaultNodes:N,hasDefaultEdges:k,onNodesDelete:I,onEdgesDelete:R,onNodesChange:T,onEdgesChange:S}=t.getState(),E=(y||[]).map(B=>B.id),_=(p||[]).map(B=>B.id),M=b().reduce((B,L)=>{const D=L.parentNode||L.parentId,V=!E.includes(L.id)&&D&&B.find(H=>H.id===D);return(typeof L.deletable=="boolean"?L.deletable:!0)&&(E.includes(L.id)||V)&&B.push(L),B},[]),A=w.filter(B=>typeof B.deletable=="boolean"?B.deletable:!0),P=A.filter(B=>_.includes(B.id));if(M||P){const B=p$(M,A),L=[...P,...B],D=L.reduce((V,O)=>(V.includes(O.id)||V.push(O.id),V),[]);if((k||N)&&(k&&t.setState({edges:w.filter(V=>!D.includes(V.id))}),N&&(M.forEach(V=>{x.delete(V.id)}),t.setState({nodeInternals:new Map(x)}))),D.length>0&&(R==null||R(L),S&&S(D.map(V=>({id:V,type:"remove"})))),M.length>0&&(I==null||I(M),T)){const V=M.map(O=>({id:O.id,type:"remove"}));T(V)}}},[]),m=J.useCallback(y=>{const p=Dae(y),x=p?null:t.getState().nodeInternals.get(y.id);return!p&&!x?[null,null,p]:[p?y:BS(x),x,p]},[]),h=J.useCallback((y,p=!0,x)=>{const[b,w,N]=m(y);return b?(x||t.getState().getNodes()).filter(k=>{if(!N&&(k.id===w.id||!k.positionAbsolute))return!1;const I=BS(k),R=CN(I,b);return p&&R>0||R>=b.width*b.height}):[]},[]),g=J.useCallback((y,p,x=!0)=>{const[b]=m(y);if(!b)return!1;const w=CN(b,p);return x&&w>0||w>=b.width*b.height},[]);return J.useMemo(()=>({...e,getNodes:n,getNode:r,getEdges:s,getEdge:i,setNodes:l,setEdges:a,addNodes:c,addEdges:d,toObject:u,deleteElements:f,getIntersectingNodes:h,isNodeIntersecting:g}),[e,n,r,s,i,l,a,c,d,u,f,h,g])}const voe={actInsideInputWithModifier:!1};var boe=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const n=es(),{deleteElements:r}=G4(),s=Fh(e,voe),i=Fh(t);J.useEffect(()=>{if(s){const{edges:l,getNodes:a}=n.getState(),c=a().filter(u=>u.selected),d=l.filter(u=>u.selected);r({nodes:c,edges:d}),n.setState({nodesSelectionActive:!1})}},[s]),J.useEffect(()=>{n.setState({multiSelectionActive:i})},[i])};function woe(e){const t=es();J.useEffect(()=>{let n;const r=()=>{var i,l;if(!e.current)return;const s=F4(e.current);(s.height===0||s.width===0)&&((l=(i=t.getState()).onError)==null||l.call(i,"004",So.error004())),t.setState({width:s.width||500,height:s.height||500})};return r(),window.addEventListener("resize",r),e.current&&(n=new ResizeObserver(()=>r()),n.observe(e.current)),()=>{window.removeEventListener("resize",r),n&&e.current&&n.unobserve(e.current)}},[])}const Y4={position:"absolute",width:"100%",height:"100%",top:0,left:0},Noe=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,hp=e=>({x:e.x,y:e.y,zoom:e.k}),bu=(e,t)=>e.target.closest(`.${t}`),JS=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),ZS=e=>{const t=e.ctrlKey&&Wg()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},joe=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),_oe=({onMove:e,onMoveStart:t,onMoveEnd:n,onPaneContextMenu:r,zoomOnScroll:s=!0,zoomOnPinch:i=!0,panOnScroll:l=!1,panOnScrollSpeed:a=.5,panOnScrollMode:c=cc.Free,zoomOnDoubleClick:d=!0,elementsSelectable:u,panOnDrag:f=!0,defaultViewport:m,translateExtent:h,minZoom:g,maxZoom:y,zoomActivationKeyCode:p,preventScrolling:x=!0,children:b,noWheelClassName:w,noPanClassName:N})=>{const k=J.useRef(),I=es(),R=J.useRef(!1),T=J.useRef(!1),S=J.useRef(null),E=J.useRef({x:0,y:0,zoom:0}),{d3Zoom:_,d3Selection:M,d3ZoomHandler:A,userSelectionActive:P}=tr(joe,ss),B=Fh(p),L=J.useRef(0),D=J.useRef(!1),V=J.useRef();return woe(S),J.useEffect(()=>{if(S.current){const O=S.current.getBoundingClientRect(),H=RP().scaleExtent([g,y]).translateExtent(h),W=n3(S.current).call(H),$=dc.translate(m.x,m.y).scale(hd(m.zoom,g,y)),z=[[0,0],[O.width,O.height]],q=H.constrain()($,z,h);H.transform(W,q),H.wheelDelta(ZS),I.setState({d3Zoom:H,d3Selection:W,d3ZoomHandler:W.on("wheel.zoom"),transform:[q.x,q.y,q.k],domNode:S.current.closest(".react-flow")})}},[]),J.useEffect(()=>{M&&_&&(l&&!B&&!P?M.on("wheel.zoom",O=>{if(bu(O,w))return!1;O.preventDefault(),O.stopImmediatePropagation();const H=M.property("__zoom").k||1;if(O.ctrlKey&&i){const ie=$P(O),Y=ZS(O),te=H*Math.pow(2,Y);_.scaleTo(M,te,ie,O);return}const W=O.deltaMode===1?20:1;let $=c===cc.Vertical?0:O.deltaX*W,z=c===cc.Horizontal?0:O.deltaY*W;!Wg()&&O.shiftKey&&c!==cc.Vertical&&($=O.deltaY*W,z=0),_.translateBy(M,-($/H)*a,-(z/H)*a,{internal:!0});const q=hp(M.property("__zoom")),{onViewportChangeStart:G,onViewportChange:re,onViewportChangeEnd:oe}=I.getState();clearTimeout(V.current),D.current||(D.current=!0,t==null||t(O,q),G==null||G(q)),D.current&&(e==null||e(O,q),re==null||re(q),V.current=setTimeout(()=>{n==null||n(O,q),oe==null||oe(q),D.current=!1},150))},{passive:!1}):typeof A<"u"&&M.on("wheel.zoom",function(O,H){if(!x&&O.type==="wheel"&&!O.ctrlKey||bu(O,w))return null;O.preventDefault(),A.call(this,O,H)},{passive:!1}))},[P,l,c,M,_,A,B,i,x,w,t,e,n]),J.useEffect(()=>{_&&_.on("start",O=>{var $,z;if(!O.sourceEvent||O.sourceEvent.internal)return null;L.current=($=O.sourceEvent)==null?void 0:$.button;const{onViewportChangeStart:H}=I.getState(),W=hp(O.transform);R.current=!0,E.current=W,((z=O.sourceEvent)==null?void 0:z.type)==="mousedown"&&I.setState({paneDragging:!0}),H==null||H(W),t==null||t(O.sourceEvent,W)})},[_,t]),J.useEffect(()=>{_&&(P&&!R.current?_.on("zoom",null):P||_.on("zoom",O=>{var W;const{onViewportChange:H}=I.getState();if(I.setState({transform:[O.transform.x,O.transform.y,O.transform.k]}),T.current=!!(r&&JS(f,L.current??0)),(e||H)&&!((W=O.sourceEvent)!=null&&W.internal)){const $=hp(O.transform);H==null||H($),e==null||e(O.sourceEvent,$)}}))},[P,_,e,f,r]),J.useEffect(()=>{_&&_.on("end",O=>{if(!O.sourceEvent||O.sourceEvent.internal)return null;const{onViewportChangeEnd:H}=I.getState();if(R.current=!1,I.setState({paneDragging:!1}),r&&JS(f,L.current??0)&&!T.current&&r(O.sourceEvent),T.current=!1,(n||H)&&Noe(E.current,O.transform)){const W=hp(O.transform);E.current=W,clearTimeout(k.current),k.current=setTimeout(()=>{H==null||H(W),n==null||n(O.sourceEvent,W)},l?150:0)}})},[_,l,f,n,r]),J.useEffect(()=>{_&&_.filter(O=>{const H=B||s,W=i&&O.ctrlKey;if((f===!0||Array.isArray(f)&&f.includes(1))&&O.button===1&&O.type==="mousedown"&&(bu(O,"react-flow__node")||bu(O,"react-flow__edge")))return!0;if(!f&&!H&&!l&&!d&&!i||P||!d&&O.type==="dblclick"||bu(O,w)&&O.type==="wheel"||bu(O,N)&&(O.type!=="wheel"||l&&O.type==="wheel"&&!B)||!i&&O.ctrlKey&&O.type==="wheel"||!H&&!l&&!W&&O.type==="wheel"||!f&&(O.type==="mousedown"||O.type==="touchstart")||Array.isArray(f)&&!f.includes(O.button)&&O.type==="mousedown")return!1;const $=Array.isArray(f)&&f.includes(O.button)||!O.button||O.button<=1;return(!O.ctrlKey||O.type==="wheel")&&$})},[P,_,s,i,l,d,f,u,B]),be.createElement("div",{className:"react-flow__renderer",ref:S,style:Y4},b)},Soe=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Aoe(){const{userSelectionActive:e,userSelectionRect:t}=tr(Soe,ss);return e&&t?be.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function QS(e,t){const n=t.parentNode||t.parentId,r=e.find(s=>s.id===n);if(r){const s=t.position.x+t.width-r.width,i=t.position.y+t.height-r.height;if(s>0||i>0||t.position.x<0||t.position.y<0){if(r.style={...r.style},r.style.width=r.style.width??r.width,r.style.height=r.style.height??r.height,s>0&&(r.style.width+=s),i>0&&(r.style.height+=i),t.position.x<0){const l=Math.abs(t.position.x);r.position.x=r.position.x-l,r.style.width+=l,t.position.x=0}if(t.position.y<0){const l=Math.abs(t.position.y);r.position.y=r.position.y-l,r.style.height+=l,t.position.y=0}r.width=r.style.width,r.height=r.style.height}}}function T$(e,t){if(e.some(r=>r.type==="reset"))return e.filter(r=>r.type==="reset").map(r=>r.item);const n=e.filter(r=>r.type==="add").map(r=>r.item);return t.reduce((r,s)=>{const i=e.filter(a=>a.id===s.id);if(i.length===0)return r.push(s),r;const l={...s};for(const a of i)if(a)switch(a.type){case"select":{l.selected=a.selected;break}case"position":{typeof a.position<"u"&&(l.position=a.position),typeof a.positionAbsolute<"u"&&(l.positionAbsolute=a.positionAbsolute),typeof a.dragging<"u"&&(l.dragging=a.dragging),l.expandParent&&QS(r,l);break}case"dimensions":{typeof a.dimensions<"u"&&(l.width=a.dimensions.width,l.height=a.dimensions.height),typeof a.updateStyle<"u"&&(l.style={...l.style||{},...a.dimensions}),typeof a.resizing=="boolean"&&(l.resizing=a.resizing),l.expandParent&&QS(r,l);break}case"remove":return r}return r.push(l),r},n)}function L$(e,t){return T$(e,t)}function koe(e,t){return T$(e,t)}const rl=(e,t)=>({id:e,type:"select",selected:t});function Tu(e,t){return e.reduce((n,r)=>{const s=t.includes(r.id);return!r.selected&&s?(r.selected=!0,n.push(rl(r.id,!0))):r.selected&&!s&&(r.selected=!1,n.push(rl(r.id,!1))),n},[])}const Kx=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},Eoe=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),M$=J.memo(({isSelecting:e,selectionMode:t=Oh.Full,panOnDrag:n,onSelectionStart:r,onSelectionEnd:s,onPaneClick:i,onPaneContextMenu:l,onPaneScroll:a,onPaneMouseEnter:c,onPaneMouseMove:d,onPaneMouseLeave:u,children:f})=>{const m=J.useRef(null),h=es(),g=J.useRef(0),y=J.useRef(0),p=J.useRef(),{userSelectionActive:x,elementsSelectable:b,dragging:w}=tr(Eoe,ss),N=()=>{h.setState({userSelectionActive:!1,userSelectionRect:null}),g.current=0,y.current=0},k=A=>{i==null||i(A),h.getState().resetSelectedElements(),h.setState({nodesSelectionActive:!1})},I=A=>{if(Array.isArray(n)&&(n!=null&&n.includes(2))){A.preventDefault();return}l==null||l(A)},R=a?A=>a(A):void 0,T=A=>{const{resetSelectedElements:P,domNode:B}=h.getState();if(p.current=B==null?void 0:B.getBoundingClientRect(),!b||!e||A.button!==0||A.target!==m.current||!p.current)return;const{x:L,y:D}=ul(A,p.current);P(),h.setState({userSelectionRect:{width:0,height:0,startX:L,startY:D,x:L,y:D}}),r==null||r(A)},S=A=>{const{userSelectionRect:P,nodeInternals:B,edges:L,transform:D,onNodesChange:V,onEdgesChange:O,nodeOrigin:H,getNodes:W}=h.getState();if(!e||!p.current||!P)return;h.setState({userSelectionActive:!0,nodesSelectionActive:!1});const $=ul(A,p.current),z=P.startX??0,q=P.startY??0,G={...P,x:$.x<z?$.x:z,y:$.y<q?$.y:q,width:Math.abs($.x-z),height:Math.abs($.y-q)},re=W(),oe=m$(B,G,D,t===Oh.Partial,!0,H),ie=p$(oe,L).map(te=>te.id),Y=oe.map(te=>te.id);if(g.current!==Y.length){g.current=Y.length;const te=Tu(re,Y);te.length&&(V==null||V(te))}if(y.current!==ie.length){y.current=ie.length;const te=Tu(L,ie);te.length&&(O==null||O(te))}h.setState({userSelectionRect:G})},E=A=>{if(A.button!==0)return;const{userSelectionRect:P}=h.getState();!x&&P&&A.target===m.current&&(k==null||k(A)),h.setState({nodesSelectionActive:g.current>0}),N(),s==null||s(A)},_=A=>{x&&(h.setState({nodesSelectionActive:g.current>0}),s==null||s(A)),N()},M=b&&(e||x);return be.createElement("div",{className:ps(["react-flow__pane",{dragging:w,selection:e}]),onClick:M?void 0:Kx(k,m),onContextMenu:Kx(I,m),onWheel:Kx(R,m),onMouseEnter:M?void 0:c,onMouseDown:M?T:void 0,onMouseMove:M?S:d,onMouseUp:M?E:void 0,onMouseLeave:M?_:u,ref:m,style:Y4},f,be.createElement(Aoe,null))});M$.displayName="Pane";function R$(e,t){const n=e.parentNode||e.parentId;if(!n)return!1;const r=t.get(n);return r?r.selected?!0:R$(r,t):!1}function e8(e,t,n){let r=e;do{if(r!=null&&r.matches(t))return!0;if(r===n.current)return!1;r=r.parentElement}while(r);return!1}function Coe(e,t,n,r){return Array.from(e.values()).filter(s=>(s.selected||s.id===r)&&(!s.parentNode||s.parentId||!R$(s,e))&&(s.draggable||t&&typeof s.draggable>"u")).map(s=>{var i,l;return{id:s.id,position:s.position||{x:0,y:0},positionAbsolute:s.positionAbsolute||{x:0,y:0},distance:{x:n.x-(((i=s.positionAbsolute)==null?void 0:i.x)??0),y:n.y-(((l=s.positionAbsolute)==null?void 0:l.y)??0)},delta:{x:0,y:0},extent:s.extent,parentNode:s.parentNode||s.parentId,parentId:s.parentNode||s.parentId,width:s.width,height:s.height,expandParent:s.expandParent}})}function Poe(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function $$(e,t,n,r,s=[0,0],i){const l=Poe(e,e.extent||r);let a=l;const c=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(c&&e.width&&e.height){const f=n.get(c),{x:m,y:h}=pc(f,s).positionAbsolute;a=f&&$i(m)&&$i(h)&&$i(f.width)&&$i(f.height)?[[m+e.width*s[0],h+e.height*s[1]],[m+f.width-e.width+e.width*s[0],h+f.height-e.height+e.height*s[1]]]:a}else i==null||i("005",So.error005()),a=l;else if(e.extent&&c&&e.extent!=="parent"){const f=n.get(c),{x:m,y:h}=pc(f,s).positionAbsolute;a=[[e.extent[0][0]+m,e.extent[0][1]+h],[e.extent[1][0]+m,e.extent[1][1]+h]]}let d={x:0,y:0};if(c){const f=n.get(c);d=pc(f,s).positionAbsolute}const u=a&&a!=="parent"?D4(t,a):t;return{position:{x:u.x-d.x,y:u.y-d.y},positionAbsolute:u}}function Jx({nodeId:e,dragItems:t,nodeInternals:n}){const r=t.map(s=>({...n.get(s.id),position:s.position,positionAbsolute:s.positionAbsolute}));return[e?r.find(s=>s.id===e):r[0],r]}const t8=(e,t,n,r)=>{const s=t.querySelectorAll(e);if(!s||!s.length)return null;const i=Array.from(s),l=t.getBoundingClientRect(),a={x:l.width*r[0],y:l.height*r[1]};return i.map(c=>{const d=c.getBoundingClientRect();return{id:c.getAttribute("data-handleid"),position:c.getAttribute("data-handlepos"),x:(d.left-l.left-a.x)/n,y:(d.top-l.top-a.y)/n,...F4(c)}})};function _f(e,t,n){return n===void 0?n:r=>{const s=t().nodeInternals.get(e);s&&n(r,{...s})}}function RN({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:s,unselectNodesAndEdges:i,multiSelectionActive:l,nodeInternals:a,onError:c}=t.getState(),d=a.get(e);if(!d){c==null||c("012",So.error012(e));return}t.setState({nodesSelectionActive:!1}),d.selected?(n||d.selected&&l)&&(i({nodes:[d],edges:[]}),requestAnimationFrame(()=>{var u;return(u=r==null?void 0:r.current)==null?void 0:u.blur()})):s([e])}function Ioe(){const e=es();return J.useCallback(({sourceEvent:n})=>{const{transform:r,snapGrid:s,snapToGrid:i}=e.getState(),l=n.touches?n.touches[0].clientX:n.clientX,a=n.touches?n.touches[0].clientY:n.clientY,c={x:(l-r[0])/r[2],y:(a-r[1])/r[2]};return{xSnapped:i?s[0]*Math.round(c.x/s[0]):c.x,ySnapped:i?s[1]*Math.round(c.y/s[1]):c.y,...c}},[])}function Zx(e){return(t,n,r)=>e==null?void 0:e(t,r)}function O$({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:s,isSelectable:i,selectNodesOnDrag:l}){const a=es(),[c,d]=J.useState(!1),u=J.useRef([]),f=J.useRef({x:null,y:null}),m=J.useRef(0),h=J.useRef(null),g=J.useRef({x:0,y:0}),y=J.useRef(null),p=J.useRef(!1),x=J.useRef(!1),b=J.useRef(!1),w=Ioe();return J.useEffect(()=>{if(e!=null&&e.current){const N=n3(e.current),k=({x:T,y:S})=>{const{nodeInternals:E,onNodeDrag:_,onSelectionDrag:M,updateNodePositions:A,nodeExtent:P,snapGrid:B,snapToGrid:L,nodeOrigin:D,onError:V}=a.getState();f.current={x:T,y:S};let O=!1,H={x:0,y:0,x2:0,y2:0};if(u.current.length>1&&P){const $=a1(u.current,D);H=$h($)}if(u.current=u.current.map($=>{const z={x:T-$.distance.x,y:S-$.distance.y};L&&(z.x=B[0]*Math.round(z.x/B[0]),z.y=B[1]*Math.round(z.y/B[1]));const q=[[P[0][0],P[0][1]],[P[1][0],P[1][1]]];u.current.length>1&&P&&!$.extent&&(q[0][0]=$.positionAbsolute.x-H.x+P[0][0],q[1][0]=$.positionAbsolute.x+($.width??0)-H.x2+P[1][0],q[0][1]=$.positionAbsolute.y-H.y+P[0][1],q[1][1]=$.positionAbsolute.y+($.height??0)-H.y2+P[1][1]);const G=$$($,z,E,q,D,V);return O=O||$.position.x!==G.position.x||$.position.y!==G.position.y,$.position=G.position,$.positionAbsolute=G.positionAbsolute,$}),!O)return;A(u.current,!0,!0),d(!0);const W=s?_:Zx(M);if(W&&y.current){const[$,z]=Jx({nodeId:s,dragItems:u.current,nodeInternals:E});W(y.current,$,z)}},I=()=>{if(!h.current)return;const[T,S]=r$(g.current,h.current);if(T!==0||S!==0){const{transform:E,panBy:_}=a.getState();f.current.x=(f.current.x??0)-T/E[2],f.current.y=(f.current.y??0)-S/E[2],_({x:T,y:S})&&k(f.current)}m.current=requestAnimationFrame(I)},R=T=>{var D;const{nodeInternals:S,multiSelectionActive:E,nodesDraggable:_,unselectNodesAndEdges:M,onNodeDragStart:A,onSelectionDragStart:P}=a.getState();x.current=!0;const B=s?A:Zx(P);(!l||!i)&&!E&&s&&((D=S.get(s))!=null&&D.selected||M()),s&&i&&l&&RN({id:s,store:a,nodeRef:e});const L=w(T);if(f.current=L,u.current=Coe(S,_,L,s),B&&u.current){const[V,O]=Jx({nodeId:s,dragItems:u.current,nodeInternals:S});B(T.sourceEvent,V,O)}};if(t)N.on(".drag",null);else{const T=yq().on("start",S=>{const{domNode:E,nodeDragThreshold:_}=a.getState();_===0&&R(S),b.current=!1;const M=w(S);f.current=M,h.current=(E==null?void 0:E.getBoundingClientRect())||null,g.current=ul(S.sourceEvent,h.current)}).on("drag",S=>{var A,P;const E=w(S),{autoPanOnNodeDrag:_,nodeDragThreshold:M}=a.getState();if(S.sourceEvent.type==="touchmove"&&S.sourceEvent.touches.length>1&&(b.current=!0),!b.current){if(!p.current&&x.current&&_&&(p.current=!0,I()),!x.current){const B=E.xSnapped-(((A=f==null?void 0:f.current)==null?void 0:A.x)??0),L=E.ySnapped-(((P=f==null?void 0:f.current)==null?void 0:P.y)??0);Math.sqrt(B*B+L*L)>M&&R(S)}(f.current.x!==E.xSnapped||f.current.y!==E.ySnapped)&&u.current&&x.current&&(y.current=S.sourceEvent,g.current=ul(S.sourceEvent,h.current),k(E))}}).on("end",S=>{if(!(!x.current||b.current)&&(d(!1),p.current=!1,x.current=!1,cancelAnimationFrame(m.current),u.current)){const{updateNodePositions:E,nodeInternals:_,onNodeDragStop:M,onSelectionDragStop:A}=a.getState(),P=s?M:Zx(A);if(E(u.current,!1,!1),P){const[B,L]=Jx({nodeId:s,dragItems:u.current,nodeInternals:_});P(S.sourceEvent,B,L)}}}).filter(S=>{const E=S.target;return!S.button&&(!n||!e8(E,`.${n}`,e))&&(!r||e8(E,r,e))});return N.call(T),()=>{N.on(".drag",null)}}}},[e,t,n,r,i,a,s,l,w]),c}function F$(){const e=es();return J.useCallback(n=>{const{nodeInternals:r,nodeExtent:s,updateNodePositions:i,getNodes:l,snapToGrid:a,snapGrid:c,onError:d,nodesDraggable:u}=e.getState(),f=l().filter(b=>b.selected&&(b.draggable||u&&typeof b.draggable>"u")),m=a?c[0]:5,h=a?c[1]:5,g=n.isShiftPressed?4:1,y=n.x*m*g,p=n.y*h*g,x=f.map(b=>{if(b.positionAbsolute){const w={x:b.positionAbsolute.x+y,y:b.positionAbsolute.y+p};a&&(w.x=c[0]*Math.round(w.x/c[0]),w.y=c[1]*Math.round(w.y/c[1]));const{positionAbsolute:N,position:k}=$$(b,w,r,s,void 0,d);b.position=k,b.positionAbsolute=N}return b});i(x,!0,!1)},[])}const qu={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var Sf=e=>{const t=({id:n,type:r,data:s,xPos:i,yPos:l,xPosOrigin:a,yPosOrigin:c,selected:d,onClick:u,onMouseEnter:f,onMouseMove:m,onMouseLeave:h,onContextMenu:g,onDoubleClick:y,style:p,className:x,isDraggable:b,isSelectable:w,isConnectable:N,isFocusable:k,selectNodesOnDrag:I,sourcePosition:R,targetPosition:T,hidden:S,resizeObserver:E,dragHandle:_,zIndex:M,isParent:A,noDragClassName:P,noPanClassName:B,initialized:L,disableKeyboardA11y:D,ariaLabel:V,rfId:O,hasHandleBounds:H})=>{const W=es(),$=J.useRef(null),z=J.useRef(null),q=J.useRef(R),G=J.useRef(T),re=J.useRef(r),oe=w||b||u||f||m||h,ie=F$(),Y=_f(n,W.getState,f),te=_f(n,W.getState,m),we=_f(n,W.getState,h),me=_f(n,W.getState,g),Ee=_f(n,W.getState,y),pe=$e=>{const{nodeDragThreshold:De}=W.getState();if(w&&(!I||!b||De>0)&&RN({id:n,store:W,nodeRef:$}),u){const ge=W.getState().nodeInternals.get(n);ge&&u($e,{...ge})}},ee=$e=>{if(!PN($e)&&!D)if(o$.includes($e.key)&&w){const De=$e.key==="Escape";RN({id:n,store:W,unselect:De,nodeRef:$})}else b&&d&&Object.prototype.hasOwnProperty.call(qu,$e.key)&&(W.setState({ariaLiveMessage:`Moved selected node ${$e.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~i}, y: ${~~l}`}),ie({x:qu[$e.key].x,y:qu[$e.key].y,isShiftPressed:$e.shiftKey}))};J.useEffect(()=>()=>{z.current&&(E==null||E.unobserve(z.current),z.current=null)},[]),J.useEffect(()=>{if($.current&&!S){const $e=$.current;(!L||!H||z.current!==$e)&&(z.current&&(E==null||E.unobserve(z.current)),E==null||E.observe($e),z.current=$e)}},[S,L,H]),J.useEffect(()=>{const $e=re.current!==r,De=q.current!==R,ge=G.current!==T;$.current&&($e||De||ge)&&($e&&(re.current=r),De&&(q.current=R),ge&&(G.current=T),W.getState().updateNodeDimensions([{id:n,nodeElement:$.current,forceUpdate:!0}]))},[n,r,R,T]);const ft=O$({nodeRef:$,disabled:S||!b,noDragClassName:P,handleSelector:_,nodeId:n,isSelectable:w,selectNodesOnDrag:I});return S?null:be.createElement("div",{className:ps(["react-flow__node",`react-flow__node-${r}`,{[B]:b},x,{selected:d,selectable:w,parent:A,dragging:ft}]),ref:$,style:{zIndex:M,transform:`translate(${a}px,${c}px)`,pointerEvents:oe?"all":"none",visibility:L?"visible":"hidden",...p},"data-id":n,"data-testid":`rf__node-${n}`,onMouseEnter:Y,onMouseMove:te,onMouseLeave:we,onContextMenu:me,onClick:pe,onDoubleClick:Ee,onKeyDown:k?ee:void 0,tabIndex:k?0:void 0,role:k?"button":void 0,"aria-describedby":D?void 0:`${k$}-${O}`,"aria-label":V},be.createElement(Wae,{value:n},be.createElement(e,{id:n,data:s,type:r,xPos:i,yPos:l,selected:d,isConnectable:N,sourcePosition:R,targetPosition:T,dragging:ft,dragHandle:_,zIndex:M})))};return t.displayName="NodeWrapper",J.memo(t)};const Toe=e=>{const t=e.getNodes().filter(n=>n.selected);return{...a1(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function Loe({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=es(),{width:s,height:i,x:l,y:a,transformString:c,userSelectionActive:d}=tr(Toe,ss),u=F$(),f=J.useRef(null);if(J.useEffect(()=>{var g;n||(g=f.current)==null||g.focus({preventScroll:!0})},[n]),O$({nodeRef:f}),d||!s||!i)return null;const m=e?g=>{const y=r.getState().getNodes().filter(p=>p.selected);e(g,y)}:void 0,h=g=>{Object.prototype.hasOwnProperty.call(qu,g.key)&&u({x:qu[g.key].x,y:qu[g.key].y,isShiftPressed:g.shiftKey})};return be.createElement("div",{className:ps(["react-flow__nodesselection","react-flow__container",t]),style:{transform:c}},be.createElement("div",{ref:f,className:"react-flow__nodesselection-rect",onContextMenu:m,tabIndex:n?void 0:-1,onKeyDown:n?void 0:h,style:{width:s,height:i,top:a,left:l}}))}var Moe=J.memo(Loe);const Roe=e=>e.nodesSelectionActive,D$=({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:s,onPaneContextMenu:i,onPaneScroll:l,deleteKeyCode:a,onMove:c,onMoveStart:d,onMoveEnd:u,selectionKeyCode:f,selectionOnDrag:m,selectionMode:h,onSelectionStart:g,onSelectionEnd:y,multiSelectionKeyCode:p,panActivationKeyCode:x,zoomActivationKeyCode:b,elementsSelectable:w,zoomOnScroll:N,zoomOnPinch:k,panOnScroll:I,panOnScrollSpeed:R,panOnScrollMode:T,zoomOnDoubleClick:S,panOnDrag:E,defaultViewport:_,translateExtent:M,minZoom:A,maxZoom:P,preventScrolling:B,onSelectionContextMenu:L,noWheelClassName:D,noPanClassName:V,disableKeyboardA11y:O})=>{const H=tr(Roe),W=Fh(f),$=Fh(x),z=$||E,q=$||I,G=W||m&&z!==!0;return boe({deleteKeyCode:a,multiSelectionKeyCode:p}),be.createElement(_oe,{onMove:c,onMoveStart:d,onMoveEnd:u,onPaneContextMenu:i,elementsSelectable:w,zoomOnScroll:N,zoomOnPinch:k,panOnScroll:q,panOnScrollSpeed:R,panOnScrollMode:T,zoomOnDoubleClick:S,panOnDrag:!W&&z,defaultViewport:_,translateExtent:M,minZoom:A,maxZoom:P,zoomActivationKeyCode:b,preventScrolling:B,noWheelClassName:D,noPanClassName:V},be.createElement(M$,{onSelectionStart:g,onSelectionEnd:y,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:s,onPaneContextMenu:i,onPaneScroll:l,panOnDrag:z,isSelecting:!!G,selectionMode:h},e,H&&be.createElement(Moe,{onSelectionContextMenu:L,noPanClassName:V,disableKeyboardA11y:O})))};D$.displayName="FlowRenderer";var $oe=J.memo(D$);function Ooe(e){return tr(J.useCallback(n=>e?m$(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):n.getNodes(),[e]))}function Foe(e){const t={input:Sf(e.input||j$),default:Sf(e.default||MN),output:Sf(e.output||S$),group:Sf(e.group||W4)},n={},r=Object.keys(e).filter(s=>!["input","default","output","group"].includes(s)).reduce((s,i)=>(s[i]=Sf(e[i]||MN),s),n);return{...t,...r}}const Doe=({x:e,y:t,width:n,height:r,origin:s})=>!n||!r?{x:e,y:t}:s[0]<0||s[1]<0||s[0]>1||s[1]>1?{x:e,y:t}:{x:e-n*s[0],y:t-r*s[1]},qoe=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),q$=e=>{const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:s,updateNodeDimensions:i,onError:l}=tr(qoe,ss),a=Ooe(e.onlyRenderVisibleElements),c=J.useRef(),d=J.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const u=new ResizeObserver(f=>{const m=f.map(h=>({id:h.target.getAttribute("data-id"),nodeElement:h.target,forceUpdate:!0}));i(m)});return c.current=u,u},[]);return J.useEffect(()=>()=>{var u;(u=c==null?void 0:c.current)==null||u.disconnect()},[]),be.createElement("div",{className:"react-flow__nodes",style:Y4},a.map(u=>{var k,I,R;let f=u.type||"default";e.nodeTypes[f]||(l==null||l("003",So.error003(f)),f="default");const m=e.nodeTypes[f]||e.nodeTypes.default,h=!!(u.draggable||t&&typeof u.draggable>"u"),g=!!(u.selectable||s&&typeof u.selectable>"u"),y=!!(u.connectable||n&&typeof u.connectable>"u"),p=!!(u.focusable||r&&typeof u.focusable>"u"),x=e.nodeExtent?D4(u.positionAbsolute,e.nodeExtent):u.positionAbsolute,b=(x==null?void 0:x.x)??0,w=(x==null?void 0:x.y)??0,N=Doe({x:b,y:w,width:u.width??0,height:u.height??0,origin:e.nodeOrigin});return be.createElement(m,{key:u.id,id:u.id,className:u.className,style:u.style,type:f,data:u.data,sourcePosition:u.sourcePosition||Tt.Bottom,targetPosition:u.targetPosition||Tt.Top,hidden:u.hidden,xPos:b,yPos:w,xPosOrigin:N.x,yPosOrigin:N.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!u.selected,isDraggable:h,isSelectable:g,isConnectable:y,isFocusable:p,resizeObserver:d,dragHandle:u.dragHandle,zIndex:((k=u[Nr])==null?void 0:k.z)??0,isParent:!!((I=u[Nr])!=null&&I.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!u.width&&!!u.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:u.ariaLabel,hasHandleBounds:!!((R=u[Nr])!=null&&R.handleBounds)})}))};q$.displayName="NodeRenderer";var Boe=J.memo(q$);const zoe=(e,t,n)=>n===Tt.Left?e-t:n===Tt.Right?e+t:e,Uoe=(e,t,n)=>n===Tt.Top?e-t:n===Tt.Bottom?e+t:e,n8="react-flow__edgeupdater",r8=({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:s,onMouseEnter:i,onMouseOut:l,type:a})=>be.createElement("circle",{onMouseDown:s,onMouseEnter:i,onMouseOut:l,className:ps([n8,`${n8}-${a}`]),cx:zoe(t,r,e),cy:Uoe(n,r,e),r,stroke:"transparent",fill:"transparent"}),Hoe=()=>!0;var wu=e=>{const t=({id:n,className:r,type:s,data:i,onClick:l,onEdgeDoubleClick:a,selected:c,animated:d,label:u,labelStyle:f,labelShowBg:m,labelBgStyle:h,labelBgPadding:g,labelBgBorderRadius:y,style:p,source:x,target:b,sourceX:w,sourceY:N,targetX:k,targetY:I,sourcePosition:R,targetPosition:T,elementsSelectable:S,hidden:E,sourceHandleId:_,targetHandleId:M,onContextMenu:A,onMouseEnter:P,onMouseMove:B,onMouseLeave:L,reconnectRadius:D,onReconnect:V,onReconnectStart:O,onReconnectEnd:H,markerEnd:W,markerStart:$,rfId:z,ariaLabel:q,isFocusable:G,isReconnectable:re,pathOptions:oe,interactionWidth:ie,disableKeyboardA11y:Y})=>{const te=J.useRef(null),[we,me]=J.useState(!1),[Ee,pe]=J.useState(!1),ee=es(),ft=J.useMemo(()=>`url('#${TN($,z)}')`,[$,z]),$e=J.useMemo(()=>`url('#${TN(W,z)}')`,[W,z]);if(E)return null;const De=Te=>{var tt;const{edges:at,addSelectedEdges:je,unselectNodesAndEdges:he,multiSelectionActive:Pe}=ee.getState(),ot=at.find(qe=>qe.id===n);ot&&(S&&(ee.setState({nodesSelectionActive:!1}),ot.selected&&Pe?(he({nodes:[],edges:[ot]}),(tt=te.current)==null||tt.blur()):je([n])),l&&l(Te,ot))},ge=jf(n,ee.getState,a),Me=jf(n,ee.getState,A),_e=jf(n,ee.getState,P),ke=jf(n,ee.getState,B),se=jf(n,ee.getState,L),Ae=(Te,at)=>{if(Te.button!==0)return;const{edges:je,isValidConnection:he}=ee.getState(),Pe=at?b:x,ot=(at?M:_)||null,tt=at?"target":"source",qe=he||Hoe,ze=at,it=je.find(ut=>ut.id===n);pe(!0),O==null||O(Te,it,tt);const st=ut=>{pe(!1),H==null||H(ut,it,tt)};v$({event:Te,handleId:ot,nodeId:Pe,onConnect:ut=>V==null?void 0:V(it,ut),isTarget:ze,getState:ee.getState,setState:ee.setState,isValidConnection:qe,edgeUpdaterType:tt,onReconnectEnd:st})},Re=Te=>Ae(Te,!0),Ce=Te=>Ae(Te,!1),ve=()=>me(!0),Be=()=>me(!1),le=!S&&!l,fe=Te=>{var at;if(!Y&&o$.includes(Te.key)&&S){const{unselectNodesAndEdges:je,addSelectedEdges:he,edges:Pe}=ee.getState();Te.key==="Escape"?((at=te.current)==null||at.blur(),je({edges:[Pe.find(tt=>tt.id===n)]})):he([n])}};return be.createElement("g",{className:ps(["react-flow__edge",`react-flow__edge-${s}`,r,{selected:c,animated:d,inactive:le,updating:we}]),onClick:De,onDoubleClick:ge,onContextMenu:Me,onMouseEnter:_e,onMouseMove:ke,onMouseLeave:se,onKeyDown:G?fe:void 0,tabIndex:G?0:void 0,role:G?"button":"img","data-testid":`rf__edge-${n}`,"aria-label":q===null?void 0:q||`Edge from ${x} to ${b}`,"aria-describedby":G?`${E$}-${z}`:void 0,ref:te},!Ee&&be.createElement(e,{id:n,source:x,target:b,selected:c,animated:d,label:u,labelStyle:f,labelShowBg:m,labelBgStyle:h,labelBgPadding:g,labelBgBorderRadius:y,data:i,style:p,sourceX:w,sourceY:N,targetX:k,targetY:I,sourcePosition:R,targetPosition:T,sourceHandleId:_,targetHandleId:M,markerStart:ft,markerEnd:$e,pathOptions:oe,interactionWidth:ie}),re&&be.createElement(be.Fragment,null,(re==="source"||re===!0)&&be.createElement(r8,{position:R,centerX:w,centerY:N,radius:D,onMouseDown:Re,onMouseEnter:ve,onMouseOut:Be,type:"source"}),(re==="target"||re===!0)&&be.createElement(r8,{position:T,centerX:k,centerY:I,radius:D,onMouseDown:Ce,onMouseEnter:ve,onMouseOut:Be,type:"target"})))};return t.displayName="EdgeWrapper",J.memo(t)};function Voe(e){const t={default:wu(e.default||Gg),straight:wu(e.bezier||z4),step:wu(e.step||B4),smoothstep:wu(e.step||i1),simplebezier:wu(e.simplebezier||q4)},n={},r=Object.keys(e).filter(s=>!["default","bezier"].includes(s)).reduce((s,i)=>(s[i]=wu(e[i]||Gg),s),n);return{...t,...r}}function s8(e,t,n=null){const r=((n==null?void 0:n.x)||0)+t.x,s=((n==null?void 0:n.y)||0)+t.y,i=(n==null?void 0:n.width)||t.width,l=(n==null?void 0:n.height)||t.height;switch(e){case Tt.Top:return{x:r+i/2,y:s};case Tt.Right:return{x:r+i,y:s+l/2};case Tt.Bottom:return{x:r+i/2,y:s+l};case Tt.Left:return{x:r,y:s+l/2}}}function i8(e,t){return e?e.length===1||!t?e[0]:t&&e.find(n=>n.id===t)||null:null}const Woe=(e,t,n,r,s,i)=>{const l=s8(n,e,t),a=s8(i,r,s);return{sourceX:l.x,sourceY:l.y,targetX:a.x,targetY:a.y}};function Goe({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:r,targetWidth:s,targetHeight:i,width:l,height:a,transform:c}){const d={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+s),y2:Math.max(e.y+r,t.y+i)};d.x===d.x2&&(d.x2+=1),d.y===d.y2&&(d.y2+=1);const u=$h({x:(0-c[0])/c[2],y:(0-c[1])/c[2],width:l/c[2],height:a/c[2]}),f=Math.max(0,Math.min(u.x2,d.x2)-Math.max(u.x,d.x)),m=Math.max(0,Math.min(u.y2,d.y2)-Math.max(u.y,d.y));return Math.ceil(f*m)>0}function a8(e){var r,s,i,l,a;const t=((r=e==null?void 0:e[Nr])==null?void 0:r.handleBounds)||null,n=t&&(e==null?void 0:e.width)&&(e==null?void 0:e.height)&&typeof((s=e==null?void 0:e.positionAbsolute)==null?void 0:s.x)<"u"&&typeof((i=e==null?void 0:e.positionAbsolute)==null?void 0:i.y)<"u";return[{x:((l=e==null?void 0:e.positionAbsolute)==null?void 0:l.x)||0,y:((a=e==null?void 0:e.positionAbsolute)==null?void 0:a.y)||0,width:(e==null?void 0:e.width)||0,height:(e==null?void 0:e.height)||0},t,!!n]}const Yoe=[{level:0,isMaxLevel:!0,edges:[]}];function Xoe(e,t,n=!1){let r=-1;const s=e.reduce((l,a)=>{var u,f;const c=$i(a.zIndex);let d=c?a.zIndex:0;if(n){const m=t.get(a.target),h=t.get(a.source),g=a.selected||(m==null?void 0:m.selected)||(h==null?void 0:h.selected),y=Math.max(((u=h==null?void 0:h[Nr])==null?void 0:u.z)||0,((f=m==null?void 0:m[Nr])==null?void 0:f.z)||0,1e3);d=(c?a.zIndex:0)+(g?y:0)}return l[d]?l[d].push(a):l[d]=[a],r=d>r?d:r,l},{}),i=Object.entries(s).map(([l,a])=>{const c=+l;return{edges:a,level:c,isMaxLevel:c===r}});return i.length===0?Yoe:i}function Koe(e,t,n){const r=tr(J.useCallback(s=>e?s.edges.filter(i=>{const l=t.get(i.source),a=t.get(i.target);return(l==null?void 0:l.width)&&(l==null?void 0:l.height)&&(a==null?void 0:a.width)&&(a==null?void 0:a.height)&&Goe({sourcePos:l.positionAbsolute||{x:0,y:0},targetPos:a.positionAbsolute||{x:0,y:0},sourceWidth:l.width,sourceHeight:l.height,targetWidth:a.width,targetHeight:a.height,width:s.width,height:s.height,transform:s.transform})}):s.edges,[e,t]));return Xoe(r,t,n)}const Joe=({color:e="none",strokeWidth:t=1})=>be.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),Zoe=({color:e="none",strokeWidth:t=1})=>be.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),o8={[mi.Arrow]:Joe,[mi.ArrowClosed]:Zoe};function Qoe(e){const t=es();return J.useMemo(()=>{var s,i;return Object.prototype.hasOwnProperty.call(o8,e)?o8[e]:((i=(s=t.getState()).onError)==null||i.call(s,"009",So.error009(e)),null)},[e])}const ele=({id:e,type:t,color:n,width:r=12.5,height:s=12.5,markerUnits:i="strokeWidth",strokeWidth:l,orient:a="auto-start-reverse"})=>{const c=Qoe(t);return c?be.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${s}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:a,refX:"0",refY:"0"},be.createElement(c,{color:n,strokeWidth:l})):null},tle=({defaultColor:e,rfId:t})=>n=>{const r=[];return n.edges.reduce((s,i)=>([i.markerStart,i.markerEnd].forEach(l=>{if(l&&typeof l=="object"){const a=TN(l,t);r.includes(a)||(s.push({id:a,color:l.color||e,...l}),r.push(a))}}),s),[]).sort((s,i)=>s.id.localeCompare(i.id))},B$=({defaultColor:e,rfId:t})=>{const n=tr(J.useCallback(tle({defaultColor:e,rfId:t}),[e,t]),(r,s)=>!(r.length!==s.length||r.some((i,l)=>i.id!==s[l].id)));return be.createElement("defs",null,n.map(r=>be.createElement(ele,{id:r.id,key:r.id,type:r.type,color:r.color,width:r.width,height:r.height,markerUnits:r.markerUnits,strokeWidth:r.strokeWidth,orient:r.orient})))};B$.displayName="MarkerDefinitions";var nle=J.memo(B$);const rle=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),z$=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:n,rfId:r,edgeTypes:s,noPanClassName:i,onEdgeContextMenu:l,onEdgeMouseEnter:a,onEdgeMouseMove:c,onEdgeMouseLeave:d,onEdgeClick:u,onEdgeDoubleClick:f,onReconnect:m,onReconnectStart:h,onReconnectEnd:g,reconnectRadius:y,children:p,disableKeyboardA11y:x})=>{const{edgesFocusable:b,edgesUpdatable:w,elementsSelectable:N,width:k,height:I,connectionMode:R,nodeInternals:T,onError:S}=tr(rle,ss),E=Koe(t,T,n);return k?be.createElement(be.Fragment,null,E.map(({level:_,edges:M,isMaxLevel:A})=>be.createElement("svg",{key:_,style:{zIndex:_},width:k,height:I,className:"react-flow__edges react-flow__container"},A&&be.createElement(nle,{defaultColor:e,rfId:r}),be.createElement("g",null,M.map(P=>{const[B,L,D]=a8(T.get(P.source)),[V,O,H]=a8(T.get(P.target));if(!D||!H)return null;let W=P.type||"default";s[W]||(S==null||S("011",So.error011(W)),W="default");const $=s[W]||s.default,z=R===Ac.Strict?O.target:(O.target??[]).concat(O.source??[]),q=i8(L.source,P.sourceHandle),G=i8(z,P.targetHandle),re=(q==null?void 0:q.position)||Tt.Bottom,oe=(G==null?void 0:G.position)||Tt.Top,ie=!!(P.focusable||b&&typeof P.focusable>"u"),Y=P.reconnectable||P.updatable,te=typeof m<"u"&&(Y||w&&typeof Y>"u");if(!q||!G)return S==null||S("008",So.error008(q,P)),null;const{sourceX:we,sourceY:me,targetX:Ee,targetY:pe}=Woe(B,q,re,V,G,oe);return be.createElement($,{key:P.id,id:P.id,className:ps([P.className,i]),type:W,data:P.data,selected:!!P.selected,animated:!!P.animated,hidden:!!P.hidden,label:P.label,labelStyle:P.labelStyle,labelShowBg:P.labelShowBg,labelBgStyle:P.labelBgStyle,labelBgPadding:P.labelBgPadding,labelBgBorderRadius:P.labelBgBorderRadius,style:P.style,source:P.source,target:P.target,sourceHandleId:P.sourceHandle,targetHandleId:P.targetHandle,markerEnd:P.markerEnd,markerStart:P.markerStart,sourceX:we,sourceY:me,targetX:Ee,targetY:pe,sourcePosition:re,targetPosition:oe,elementsSelectable:N,onContextMenu:l,onMouseEnter:a,onMouseMove:c,onMouseLeave:d,onClick:u,onEdgeDoubleClick:f,onReconnect:m,onReconnectStart:h,onReconnectEnd:g,reconnectRadius:y,rfId:r,ariaLabel:P.ariaLabel,isFocusable:ie,isReconnectable:te,pathOptions:"pathOptions"in P?P.pathOptions:void 0,interactionWidth:P.interactionWidth,disableKeyboardA11y:x})})))),p):null};z$.displayName="EdgeRenderer";var sle=J.memo(z$);const ile=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function ale({children:e}){const t=tr(ile);return be.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function ole(e){const t=G4(),n=J.useRef(!1);J.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const lle={[Tt.Left]:Tt.Right,[Tt.Right]:Tt.Left,[Tt.Top]:Tt.Bottom,[Tt.Bottom]:Tt.Top},U$=({nodeId:e,handleType:t,style:n,type:r=il.Bezier,CustomComponent:s,connectionStatus:i})=>{var I,R,T;const{fromNode:l,handleId:a,toX:c,toY:d,connectionMode:u}=tr(J.useCallback(S=>({fromNode:S.nodeInternals.get(e),handleId:S.connectionHandleId,toX:(S.connectionPosition.x-S.transform[0])/S.transform[2],toY:(S.connectionPosition.y-S.transform[1])/S.transform[2],connectionMode:S.connectionMode}),[e]),ss),f=(I=l==null?void 0:l[Nr])==null?void 0:I.handleBounds;let m=f==null?void 0:f[t];if(u===Ac.Loose&&(m=m||(f==null?void 0:f[t==="source"?"target":"source"])),!l||!m)return null;const h=a?m.find(S=>S.id===a):m[0],g=h?h.x+h.width/2:(l.width??0)/2,y=h?h.y+h.height/2:l.height??0,p=(((R=l.positionAbsolute)==null?void 0:R.x)??0)+g,x=(((T=l.positionAbsolute)==null?void 0:T.y)??0)+y,b=h==null?void 0:h.position,w=b?lle[b]:null;if(!b||!w)return null;if(s)return be.createElement(s,{connectionLineType:r,connectionLineStyle:n,fromNode:l,fromHandle:h,fromX:p,fromY:x,toX:c,toY:d,fromPosition:b,toPosition:w,connectionStatus:i});let N="";const k={sourceX:p,sourceY:x,sourcePosition:b,targetX:c,targetY:d,targetPosition:w};return r===il.Bezier?[N]=U4(k):r===il.Step?[N]=IN({...k,borderRadius:0}):r===il.SmoothStep?[N]=IN(k):r===il.SimpleBezier?[N]=d$(k):N=`M${p},${x} ${c},${d}`,be.createElement("path",{d:N,fill:"none",className:"react-flow__connection-path",style:n})};U$.displayName="ConnectionLine";const cle=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function ule({containerStyle:e,style:t,type:n,component:r}){const{nodeId:s,handleType:i,nodesConnectable:l,width:a,height:c,connectionStatus:d}=tr(cle,ss);return!(s&&i&&a&&l)?null:be.createElement("svg",{style:e,width:a,height:c,className:"react-flow__edges react-flow__connectionline react-flow__container"},be.createElement("g",{className:ps(["react-flow__connection",d])},be.createElement(U$,{nodeId:s,handleType:i,style:t,type:n,CustomComponent:r,connectionStatus:d})))}function l8(e,t){return J.useRef(null),es(),J.useMemo(()=>t(e),[e])}const H$=({nodeTypes:e,edgeTypes:t,onMove:n,onMoveStart:r,onMoveEnd:s,onInit:i,onNodeClick:l,onEdgeClick:a,onNodeDoubleClick:c,onEdgeDoubleClick:d,onNodeMouseEnter:u,onNodeMouseMove:f,onNodeMouseLeave:m,onNodeContextMenu:h,onSelectionContextMenu:g,onSelectionStart:y,onSelectionEnd:p,connectionLineType:x,connectionLineStyle:b,connectionLineComponent:w,connectionLineContainerStyle:N,selectionKeyCode:k,selectionOnDrag:I,selectionMode:R,multiSelectionKeyCode:T,panActivationKeyCode:S,zoomActivationKeyCode:E,deleteKeyCode:_,onlyRenderVisibleElements:M,elementsSelectable:A,selectNodesOnDrag:P,defaultViewport:B,translateExtent:L,minZoom:D,maxZoom:V,preventScrolling:O,defaultMarkerColor:H,zoomOnScroll:W,zoomOnPinch:$,panOnScroll:z,panOnScrollSpeed:q,panOnScrollMode:G,zoomOnDoubleClick:re,panOnDrag:oe,onPaneClick:ie,onPaneMouseEnter:Y,onPaneMouseMove:te,onPaneMouseLeave:we,onPaneScroll:me,onPaneContextMenu:Ee,onEdgeContextMenu:pe,onEdgeMouseEnter:ee,onEdgeMouseMove:ft,onEdgeMouseLeave:$e,onReconnect:De,onReconnectStart:ge,onReconnectEnd:Me,reconnectRadius:_e,noDragClassName:ke,noWheelClassName:se,noPanClassName:Ae,elevateEdgesOnSelect:Re,disableKeyboardA11y:Ce,nodeOrigin:ve,nodeExtent:Be,rfId:le})=>{const fe=l8(e,Foe),Te=l8(t,Voe);return ole(i),be.createElement($oe,{onPaneClick:ie,onPaneMouseEnter:Y,onPaneMouseMove:te,onPaneMouseLeave:we,onPaneContextMenu:Ee,onPaneScroll:me,deleteKeyCode:_,selectionKeyCode:k,selectionOnDrag:I,selectionMode:R,onSelectionStart:y,onSelectionEnd:p,multiSelectionKeyCode:T,panActivationKeyCode:S,zoomActivationKeyCode:E,elementsSelectable:A,onMove:n,onMoveStart:r,onMoveEnd:s,zoomOnScroll:W,zoomOnPinch:$,zoomOnDoubleClick:re,panOnScroll:z,panOnScrollSpeed:q,panOnScrollMode:G,panOnDrag:oe,defaultViewport:B,translateExtent:L,minZoom:D,maxZoom:V,onSelectionContextMenu:g,preventScrolling:O,noDragClassName:ke,noWheelClassName:se,noPanClassName:Ae,disableKeyboardA11y:Ce},be.createElement(ale,null,be.createElement(sle,{edgeTypes:Te,onEdgeClick:a,onEdgeDoubleClick:d,onlyRenderVisibleElements:M,onEdgeContextMenu:pe,onEdgeMouseEnter:ee,onEdgeMouseMove:ft,onEdgeMouseLeave:$e,onReconnect:De,onReconnectStart:ge,onReconnectEnd:Me,reconnectRadius:_e,defaultMarkerColor:H,noPanClassName:Ae,elevateEdgesOnSelect:!!Re,disableKeyboardA11y:Ce,rfId:le},be.createElement(ule,{style:b,type:x,component:w,containerStyle:N})),be.createElement("div",{className:"react-flow__edgelabel-renderer"}),be.createElement(Boe,{nodeTypes:fe,onNodeClick:l,onNodeDoubleClick:c,onNodeMouseEnter:u,onNodeMouseMove:f,onNodeMouseLeave:m,onNodeContextMenu:h,selectNodesOnDrag:P,onlyRenderVisibleElements:M,noPanClassName:Ae,noDragClassName:ke,disableKeyboardA11y:Ce,nodeOrigin:ve,nodeExtent:Be,rfId:le})))};H$.displayName="GraphView";var dle=J.memo(H$);const $N=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Jo={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:$N,nodeExtent:$N,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:Ac.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:qae,isValidConnection:void 0},fle=()=>Tae((e,t)=>({...Jo,setNodes:n=>{const{nodeInternals:r,nodeOrigin:s,elevateNodesOnSelect:i}=t();e({nodeInternals:Xx(n,r,s,i)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:r={}}=t();e({edges:n.map(s=>({...r,...s}))})},setDefaultNodesAndEdges:(n,r)=>{const s=typeof n<"u",i=typeof r<"u",l=s?Xx(n,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:l,edges:i?r:[],hasDefaultNodes:s,hasDefaultEdges:i})},updateNodeDimensions:n=>{const{onNodesChange:r,nodeInternals:s,fitViewOnInit:i,fitViewOnInitDone:l,fitViewOnInitOptions:a,domNode:c,nodeOrigin:d}=t(),u=c==null?void 0:c.querySelector(".react-flow__viewport");if(!u)return;const f=window.getComputedStyle(u),{m22:m}=new window.DOMMatrixReadOnly(f.transform),h=n.reduce((y,p)=>{const x=s.get(p.id);if(x!=null&&x.hidden)s.set(x.id,{...x,[Nr]:{...x[Nr],handleBounds:void 0}});else if(x){const b=F4(p.nodeElement);!!(b.width&&b.height&&(x.width!==b.width||x.height!==b.height||p.forceUpdate))&&(s.set(x.id,{...x,[Nr]:{...x[Nr],handleBounds:{source:t8(".source",p.nodeElement,m,d),target:t8(".target",p.nodeElement,m,d)}},...b}),y.push({id:x.id,type:"dimensions",dimensions:b}))}return y},[]);P$(s,d);const g=l||i&&!l&&I$(t,{initial:!0,...a});e({nodeInternals:new Map(s),fitViewOnInitDone:g}),(h==null?void 0:h.length)>0&&(r==null||r(h))},updateNodePositions:(n,r=!0,s=!1)=>{const{triggerNodeChanges:i}=t(),l=n.map(a=>{const c={id:a.id,type:"position",dragging:s};return r&&(c.positionAbsolute=a.positionAbsolute,c.position=a.position),c});i(l)},triggerNodeChanges:n=>{const{onNodesChange:r,nodeInternals:s,hasDefaultNodes:i,nodeOrigin:l,getNodes:a,elevateNodesOnSelect:c}=t();if(n!=null&&n.length){if(i){const d=L$(n,a()),u=Xx(d,s,l,c);e({nodeInternals:u})}r==null||r(n)}},addSelectedNodes:n=>{const{multiSelectionActive:r,edges:s,getNodes:i}=t();let l,a=null;r?l=n.map(c=>rl(c,!0)):(l=Tu(i(),n),a=Tu(s,[])),fp({changedNodes:l,changedEdges:a,get:t,set:e})},addSelectedEdges:n=>{const{multiSelectionActive:r,edges:s,getNodes:i}=t();let l,a=null;r?l=n.map(c=>rl(c,!0)):(l=Tu(s,n),a=Tu(i(),[])),fp({changedNodes:a,changedEdges:l,get:t,set:e})},unselectNodesAndEdges:({nodes:n,edges:r}={})=>{const{edges:s,getNodes:i}=t(),l=n||i(),a=r||s,c=l.map(u=>(u.selected=!1,rl(u.id,!1))),d=a.map(u=>rl(u.id,!1));fp({changedNodes:c,changedEdges:d,get:t,set:e})},setMinZoom:n=>{const{d3Zoom:r,maxZoom:s}=t();r==null||r.scaleExtent([n,s]),e({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:r,minZoom:s}=t();r==null||r.scaleExtent([s,n]),e({maxZoom:n})},setTranslateExtent:n=>{var r;(r=t().d3Zoom)==null||r.translateExtent(n),e({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:r}=t(),i=r().filter(a=>a.selected).map(a=>rl(a.id,!1)),l=n.filter(a=>a.selected).map(a=>rl(a.id,!1));fp({changedNodes:i,changedEdges:l,get:t,set:e})},setNodeExtent:n=>{const{nodeInternals:r}=t();r.forEach(s=>{s.positionAbsolute=D4(s.position,n)}),e({nodeExtent:n,nodeInternals:new Map(r)})},panBy:n=>{const{transform:r,width:s,height:i,d3Zoom:l,d3Selection:a,translateExtent:c}=t();if(!l||!a||!n.x&&!n.y)return!1;const d=dc.translate(r[0]+n.x,r[1]+n.y).scale(r[2]),u=[[0,0],[s,i]],f=l==null?void 0:l.constrain()(d,u,c);return l.transform(a,f),r[0]!==f.x||r[1]!==f.y||r[2]!==f.k},cancelConnection:()=>e({connectionNodeId:Jo.connectionNodeId,connectionHandleId:Jo.connectionHandleId,connectionHandleType:Jo.connectionHandleType,connectionStatus:Jo.connectionStatus,connectionStartHandle:Jo.connectionStartHandle,connectionEndHandle:Jo.connectionEndHandle}),reset:()=>e({...Jo})}),Object.is),X4=({children:e})=>{const t=J.useRef(null);return t.current||(t.current=fle()),be.createElement(Lae,{value:t.current},e)};X4.displayName="ReactFlowProvider";const V$=({children:e})=>J.useContext(s1)?be.createElement(be.Fragment,null,e):be.createElement(X4,null,e);V$.displayName="ReactFlowWrapper";const hle={input:j$,default:MN,output:S$,group:W4},mle={default:Gg,straight:z4,step:B4,smoothstep:i1,simplebezier:q4},ple=[0,0],gle=[15,15],xle={x:0,y:0,zoom:1},yle={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},W$=J.forwardRef(({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:s,nodeTypes:i=hle,edgeTypes:l=mle,onNodeClick:a,onEdgeClick:c,onInit:d,onMove:u,onMoveStart:f,onMoveEnd:m,onConnect:h,onConnectStart:g,onConnectEnd:y,onClickConnectStart:p,onClickConnectEnd:x,onNodeMouseEnter:b,onNodeMouseMove:w,onNodeMouseLeave:N,onNodeContextMenu:k,onNodeDoubleClick:I,onNodeDragStart:R,onNodeDrag:T,onNodeDragStop:S,onNodesDelete:E,onEdgesDelete:_,onSelectionChange:M,onSelectionDragStart:A,onSelectionDrag:P,onSelectionDragStop:B,onSelectionContextMenu:L,onSelectionStart:D,onSelectionEnd:V,connectionMode:O=Ac.Strict,connectionLineType:H=il.Bezier,connectionLineStyle:W,connectionLineComponent:$,connectionLineContainerStyle:z,deleteKeyCode:q="Backspace",selectionKeyCode:G="Shift",selectionOnDrag:re=!1,selectionMode:oe=Oh.Full,panActivationKeyCode:ie="Space",multiSelectionKeyCode:Y=Wg()?"Meta":"Control",zoomActivationKeyCode:te=Wg()?"Meta":"Control",snapToGrid:we=!1,snapGrid:me=gle,onlyRenderVisibleElements:Ee=!1,selectNodesOnDrag:pe=!0,nodesDraggable:ee,nodesConnectable:ft,nodesFocusable:$e,nodeOrigin:De=ple,edgesFocusable:ge,edgesUpdatable:Me,elementsSelectable:_e,defaultViewport:ke=xle,minZoom:se=.5,maxZoom:Ae=2,translateExtent:Re=$N,preventScrolling:Ce=!0,nodeExtent:ve,defaultMarkerColor:Be="#b1b1b7",zoomOnScroll:le=!0,zoomOnPinch:fe=!0,panOnScroll:Te=!1,panOnScrollSpeed:at=.5,panOnScrollMode:je=cc.Free,zoomOnDoubleClick:he=!0,panOnDrag:Pe=!0,onPaneClick:ot,onPaneMouseEnter:tt,onPaneMouseMove:qe,onPaneMouseLeave:ze,onPaneScroll:it,onPaneContextMenu:st,children:Ve,onEdgeContextMenu:ut,onEdgeDoubleClick:mt,onEdgeMouseEnter:Ht,onEdgeMouseMove:Kt,onEdgeMouseLeave:jn,onEdgeUpdate:wn,onEdgeUpdateStart:It,onEdgeUpdateEnd:Rr,onReconnect:Vr,onReconnectStart:Sr,onReconnectEnd:We,reconnectRadius:Ue=10,edgeUpdaterRadius:pt=10,onNodesChange:wt,onEdgesChange:Vt,noDragClassName:St="nodrag",noWheelClassName:bt="nowheel",noPanClassName:jt="nopan",fitView:an=!1,fitViewOptions:Mn,connectOnClick:Xe=!0,attributionPosition:Zt,proOptions:yt,defaultEdgeOptions:on,elevateNodesOnSelect:rn=!0,elevateEdgesOnSelect:Qt=!1,disableKeyboardA11y:vt=!1,autoPanOnConnect:$t=!0,autoPanOnNodeDrag:Yt=!0,connectionRadius:zt=20,isValidConnection:Pn,onError:ln,style:Fn,id:En,nodeDragThreshold:Bn,...Ni},ji)=>{const $r=En||"1";return be.createElement("div",{...Ni,style:{...Fn,...yle},ref:ji,className:ps(["react-flow",s]),"data-testid":"rf__wrapper",id:En},be.createElement(V$,null,be.createElement(dle,{onInit:d,onMove:u,onMoveStart:f,onMoveEnd:m,onNodeClick:a,onEdgeClick:c,onNodeMouseEnter:b,onNodeMouseMove:w,onNodeMouseLeave:N,onNodeContextMenu:k,onNodeDoubleClick:I,nodeTypes:i,edgeTypes:l,connectionLineType:H,connectionLineStyle:W,connectionLineComponent:$,connectionLineContainerStyle:z,selectionKeyCode:G,selectionOnDrag:re,selectionMode:oe,deleteKeyCode:q,multiSelectionKeyCode:Y,panActivationKeyCode:ie,zoomActivationKeyCode:te,onlyRenderVisibleElements:Ee,selectNodesOnDrag:pe,defaultViewport:ke,translateExtent:Re,minZoom:se,maxZoom:Ae,preventScrolling:Ce,zoomOnScroll:le,zoomOnPinch:fe,zoomOnDoubleClick:he,panOnScroll:Te,panOnScrollSpeed:at,panOnScrollMode:je,panOnDrag:Pe,onPaneClick:ot,onPaneMouseEnter:tt,onPaneMouseMove:qe,onPaneMouseLeave:ze,onPaneScroll:it,onPaneContextMenu:st,onSelectionContextMenu:L,onSelectionStart:D,onSelectionEnd:V,onEdgeContextMenu:ut,onEdgeDoubleClick:mt,onEdgeMouseEnter:Ht,onEdgeMouseMove:Kt,onEdgeMouseLeave:jn,onReconnect:Vr??wn,onReconnectStart:Sr??It,onReconnectEnd:We??Rr,reconnectRadius:Ue??pt,defaultMarkerColor:Be,noDragClassName:St,noWheelClassName:bt,noPanClassName:jt,elevateEdgesOnSelect:Qt,rfId:$r,disableKeyboardA11y:vt,nodeOrigin:De,nodeExtent:ve}),be.createElement(loe,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:h,onConnectStart:g,onConnectEnd:y,onClickConnectStart:p,onClickConnectEnd:x,nodesDraggable:ee,nodesConnectable:ft,nodesFocusable:$e,edgesFocusable:ge,edgesUpdatable:Me,elementsSelectable:_e,elevateNodesOnSelect:rn,minZoom:se,maxZoom:Ae,nodeExtent:ve,onNodesChange:wt,onEdgesChange:Vt,snapToGrid:we,snapGrid:me,connectionMode:O,translateExtent:Re,connectOnClick:Xe,defaultEdgeOptions:on,fitView:an,fitViewOptions:Mn,onNodesDelete:E,onEdgesDelete:_,onNodeDragStart:R,onNodeDrag:T,onNodeDragStop:S,onSelectionDrag:P,onSelectionDragStart:A,onSelectionDragStop:B,noPanClassName:jt,nodeOrigin:De,rfId:$r,autoPanOnConnect:$t,autoPanOnNodeDrag:Yt,onError:ln,connectionRadius:zt,isValidConnection:Pn,nodeDragThreshold:Bn}),be.createElement(aoe,{onSelectionChange:M}),Ve,be.createElement(Rae,{proOptions:yt,position:Zt}),be.createElement(hoe,{rfId:$r,disableKeyboardA11y:vt})))});W$.displayName="ReactFlow";function G$(e){return t=>{const[n,r]=J.useState(t),s=J.useCallback(i=>r(l=>e(i,l)),[]);return[n,r,s]}}const vle=G$(L$),ble=G$(koe),Y$=({id:e,x:t,y:n,width:r,height:s,style:i,color:l,strokeColor:a,strokeWidth:c,className:d,borderRadius:u,shapeRendering:f,onClick:m,selected:h})=>{const{background:g,backgroundColor:y}=i||{},p=l||g||y;return be.createElement("rect",{className:ps(["react-flow__minimap-node",{selected:h},d]),x:t,y:n,rx:u,ry:u,width:r,height:s,fill:p,stroke:a,strokeWidth:c,shapeRendering:f,onClick:m?x=>m(x,e):void 0})};Y$.displayName="MiniMapNode";var wle=J.memo(Y$);const Nle=e=>e.nodeOrigin,jle=e=>e.getNodes().filter(t=>!t.hidden&&t.width&&t.height),Qx=e=>e instanceof Function?e:()=>e;function _le({nodeStrokeColor:e="transparent",nodeColor:t="#e2e2e2",nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:s=2,nodeComponent:i=wle,onClick:l}){const a=tr(jle,ss),c=tr(Nle),d=Qx(t),u=Qx(e),f=Qx(n),m=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return be.createElement(be.Fragment,null,a.map(h=>{const{x:g,y}=pc(h,c).positionAbsolute;return be.createElement(i,{key:h.id,x:g,y,width:h.width,height:h.height,style:h.style,selected:h.selected,className:f(h),color:d(h),borderRadius:r,strokeColor:u(h),strokeWidth:s,shapeRendering:m,onClick:l,id:h.id})}))}var Sle=J.memo(_le);const Ale=200,kle=150,Ele=e=>{const t=e.getNodes(),n={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:n,boundingRect:t.length>0?Fae(a1(t,e.nodeOrigin),n):n,rfId:e.rfId}},Cle="react-flow__minimap-desc";function X$({style:e,className:t,nodeStrokeColor:n="transparent",nodeColor:r="#e2e2e2",nodeClassName:s="",nodeBorderRadius:i=5,nodeStrokeWidth:l=2,nodeComponent:a,maskColor:c="rgb(240, 240, 240, 0.6)",maskStrokeColor:d="none",maskStrokeWidth:u=1,position:f="bottom-right",onClick:m,onNodeClick:h,pannable:g=!1,zoomable:y=!1,ariaLabel:p="React Flow mini map",inversePan:x=!1,zoomStep:b=10,offsetScale:w=5}){const N=es(),k=J.useRef(null),{boundingRect:I,viewBB:R,rfId:T}=tr(Ele,ss),S=(e==null?void 0:e.width)??Ale,E=(e==null?void 0:e.height)??kle,_=I.width/S,M=I.height/E,A=Math.max(_,M),P=A*S,B=A*E,L=w*A,D=I.x-(P-I.width)/2-L,V=I.y-(B-I.height)/2-L,O=P+L*2,H=B+L*2,W=`${Cle}-${T}`,$=J.useRef(0);$.current=A,J.useEffect(()=>{if(k.current){const G=n3(k.current),re=Y=>{const{transform:te,d3Selection:we,d3Zoom:me}=N.getState();if(Y.sourceEvent.type!=="wheel"||!we||!me)return;const Ee=-Y.sourceEvent.deltaY*(Y.sourceEvent.deltaMode===1?.05:Y.sourceEvent.deltaMode?1:.002)*b,pe=te[2]*Math.pow(2,Ee);me.scaleTo(we,pe)},oe=Y=>{const{transform:te,d3Selection:we,d3Zoom:me,translateExtent:Ee,width:pe,height:ee}=N.getState();if(Y.sourceEvent.type!=="mousemove"||!we||!me)return;const ft=$.current*Math.max(1,te[2])*(x?-1:1),$e={x:te[0]-Y.sourceEvent.movementX*ft,y:te[1]-Y.sourceEvent.movementY*ft},De=[[0,0],[pe,ee]],ge=dc.translate($e.x,$e.y).scale(te[2]),Me=me.constrain()(ge,De,Ee);me.transform(we,Me)},ie=RP().on("zoom",g?oe:null).on("zoom.wheel",y?re:null);return G.call(ie),()=>{G.on("zoom",null)}}},[g,y,x,b]);const z=m?G=>{const re=$P(G);m(G,{x:re[0],y:re[1]})}:void 0,q=h?(G,re)=>{const oe=N.getState().nodeInternals.get(re);h(G,oe)}:void 0;return be.createElement(O4,{position:f,style:e,className:ps(["react-flow__minimap",t]),"data-testid":"rf__minimap"},be.createElement("svg",{width:S,height:E,viewBox:`${D} ${V} ${O} ${H}`,role:"img","aria-labelledby":W,ref:k,onClick:z},p&&be.createElement("title",{id:W},p),be.createElement(Sle,{onClick:q,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:i,nodeClassName:s,nodeStrokeWidth:l,nodeComponent:a}),be.createElement("path",{className:"react-flow__minimap-mask",d:`M${D-L},${V-L}h${O+L*2}v${H+L*2}h${-O-L*2}z
        M${R.x},${R.y}h${R.width}v${R.height}h${-R.width}z`,fill:c,fillRule:"evenodd",stroke:d,strokeWidth:u,pointerEvents:"none"})))}X$.displayName="MiniMap";var Ple=J.memo(X$);function Ile(){return be.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},be.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function Tle(){return be.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},be.createElement("path",{d:"M0 0h32v4.2H0z"}))}function Lle(){return be.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},be.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function Mle(){return be.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},be.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function Rle(){return be.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},be.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}const Wf=({children:e,className:t,...n})=>be.createElement("button",{type:"button",className:ps(["react-flow__controls-button",t]),...n},e);Wf.displayName="ControlButton";const $le=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom}),K$=({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:s,onZoomIn:i,onZoomOut:l,onFitView:a,onInteractiveChange:c,className:d,children:u,position:f="bottom-left"})=>{const m=es(),[h,g]=J.useState(!1),{isInteractive:y,minZoomReached:p,maxZoomReached:x}=tr($le,ss),{zoomIn:b,zoomOut:w,fitView:N}=G4();if(J.useEffect(()=>{g(!0)},[]),!h)return null;const k=()=>{b(),i==null||i()},I=()=>{w(),l==null||l()},R=()=>{N(s),a==null||a()},T=()=>{m.setState({nodesDraggable:!y,nodesConnectable:!y,elementsSelectable:!y}),c==null||c(!y)};return be.createElement(O4,{className:ps(["react-flow__controls",d]),position:f,style:e,"data-testid":"rf__controls"},t&&be.createElement(be.Fragment,null,be.createElement(Wf,{onClick:k,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:x},be.createElement(Ile,null)),be.createElement(Wf,{onClick:I,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:p},be.createElement(Tle,null))),n&&be.createElement(Wf,{className:"react-flow__controls-fitview",onClick:R,title:"fit view","aria-label":"fit view"},be.createElement(Lle,null)),r&&be.createElement(Wf,{className:"react-flow__controls-interactive",onClick:T,title:"toggle interactivity","aria-label":"toggle interactivity"},y?be.createElement(Rle,null):be.createElement(Mle,null)),u)};K$.displayName="Controls";var Ole=J.memo(K$),Fi;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(Fi||(Fi={}));function Fle({color:e,dimensions:t,lineWidth:n}){return be.createElement("path",{stroke:e,strokeWidth:n,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`})}function Dle({color:e,radius:t}){return be.createElement("circle",{cx:t,cy:t,r:t,fill:e})}const qle={[Fi.Dots]:"#91919a",[Fi.Lines]:"#eee",[Fi.Cross]:"#e2e2e2"},Ble={[Fi.Dots]:1,[Fi.Lines]:1,[Fi.Cross]:6},zle=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function J$({id:e,variant:t=Fi.Dots,gap:n=20,size:r,lineWidth:s=1,offset:i=2,color:l,style:a,className:c}){const d=J.useRef(null),{transform:u,patternId:f}=tr(zle,ss),m=l||qle[t],h=r||Ble[t],g=t===Fi.Dots,y=t===Fi.Cross,p=Array.isArray(n)?n:[n,n],x=[p[0]*u[2]||1,p[1]*u[2]||1],b=h*u[2],w=y?[b,b]:x,N=g?[b/i,b/i]:[w[0]/i,w[1]/i];return be.createElement("svg",{className:ps(["react-flow__background",c]),style:{...a,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:d,"data-testid":"rf__background"},be.createElement("pattern",{id:f+e,x:u[0]%x[0],y:u[1]%x[1],width:x[0],height:x[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${N[0]},-${N[1]})`},g?be.createElement(Dle,{color:m,radius:b/i}):be.createElement(Fle,{dimensions:w,color:m,lineWidth:s})),be.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${f+e})`}))}J$.displayName="Background";var Ule=J.memo(J$);const Hle=()=>{const[e,t]=J.useState({isOpen:!1,options:null,resolve:null}),{language:n}=Ft(),r=c=>new Promise(d=>{t({isOpen:!0,options:c,resolve:d})}),s=()=>{e.resolve&&e.resolve(!0),t({isOpen:!1,options:null,resolve:null})},i=()=>{e.resolve&&e.resolve(!1),t({isOpen:!1,options:null,resolve:null})},l=c=>typeof c=="string"?c:c[n],a=c=>c?typeof c=="string"?c:c[n]:"";return{confirm:r,isOpen:e.isOpen,options:e.options,handleConfirm:s,handleCancel:i,getMessage:l,getTitle:a}};function Wn(e){"@babel/helpers - typeof";return Wn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Wn(e)}var oa=Uint8Array,bi=Uint16Array,K4=Int32Array,J4=new oa([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Z4=new oa([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),c8=new oa([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Z$=function(e,t){for(var n=new bi(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];for(var s=new K4(n[30]),r=1;r<30;++r)for(var i=n[r];i<n[r+1];++i)s[i]=i-n[r]<<5|r;return{b:n,r:s}},Q$=Z$(J4,2),Vle=Q$.b,ON=Q$.r;Vle[28]=258,ON[258]=28;var Wle=Z$(Z4,0),u8=Wle.r,FN=new bi(32768);for(var sr=0;sr<32768;++sr){var Zo=(sr&43690)>>1|(sr&21845)<<1;Zo=(Zo&52428)>>2|(Zo&13107)<<2,Zo=(Zo&61680)>>4|(Zo&3855)<<4,FN[sr]=((Zo&65280)>>8|(Zo&255)<<8)>>1}var lh=function(e,t,n){for(var r=e.length,s=0,i=new bi(t);s<r;++s)e[s]&&++i[e[s]-1];var l=new bi(t);for(s=1;s<t;++s)l[s]=l[s-1]+i[s-1]<<1;var a;if(n){a=new bi(1<<t);var c=15-t;for(s=0;s<r;++s)if(e[s])for(var d=s<<4|e[s],u=t-e[s],f=l[e[s]-1]++<<u,m=f|(1<<u)-1;f<=m;++f)a[FN[f]>>c]=d}else for(a=new bi(r),s=0;s<r;++s)e[s]&&(a[s]=FN[l[e[s]-1]++]>>15-e[s]);return a},kc=new oa(288);for(var sr=0;sr<144;++sr)kc[sr]=8;for(var sr=144;sr<256;++sr)kc[sr]=9;for(var sr=256;sr<280;++sr)kc[sr]=7;for(var sr=280;sr<288;++sr)kc[sr]=8;var Yg=new oa(32);for(var sr=0;sr<32;++sr)Yg[sr]=5;var Gle=lh(kc,9,0),Yle=lh(Yg,5,0),eO=function(e){return(e+7)/8|0},Xle=function(e,t,n){return(n==null||n>e.length)&&(n=e.length),new oa(e.subarray(t,n))},ao=function(e,t,n){n<<=t&7;var r=t/8|0;e[r]|=n,e[r+1]|=n>>8},Af=function(e,t,n){n<<=t&7;var r=t/8|0;e[r]|=n,e[r+1]|=n>>8,e[r+2]|=n>>16},ey=function(e,t){for(var n=[],r=0;r<e.length;++r)e[r]&&n.push({s:r,f:e[r]});var s=n.length,i=n.slice();if(!s)return{t:nO,l:0};if(s==1){var l=new oa(n[0].s+1);return l[n[0].s]=1,{t:l,l:1}}n.sort(function(k,I){return k.f-I.f}),n.push({s:-1,f:25001});var a=n[0],c=n[1],d=0,u=1,f=2;for(n[0]={s:-1,f:a.f+c.f,l:a,r:c};u!=s-1;)a=n[n[d].f<n[f].f?d++:f++],c=n[d!=u&&n[d].f<n[f].f?d++:f++],n[u++]={s:-1,f:a.f+c.f,l:a,r:c};for(var m=i[0].s,r=1;r<s;++r)i[r].s>m&&(m=i[r].s);var h=new bi(m+1),g=DN(n[u-1],h,0);if(g>t){var r=0,y=0,p=g-t,x=1<<p;for(i.sort(function(I,R){return h[R.s]-h[I.s]||I.f-R.f});r<s;++r){var b=i[r].s;if(h[b]>t)y+=x-(1<<g-h[b]),h[b]=t;else break}for(y>>=p;y>0;){var w=i[r].s;h[w]<t?y-=1<<t-h[w]++-1:++r}for(;r>=0&&y;--r){var N=i[r].s;h[N]==t&&(--h[N],++y)}g=t}return{t:new oa(h),l:g}},DN=function(e,t,n){return e.s==-1?Math.max(DN(e.l,t,n+1),DN(e.r,t,n+1)):t[e.s]=n},d8=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new bi(++t),r=0,s=e[0],i=1,l=function(c){n[r++]=c},a=1;a<=t;++a)if(e[a]==s&&a!=t)++i;else{if(!s&&i>2){for(;i>138;i-=138)l(32754);i>2&&(l(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(l(s),--i;i>6;i-=6)l(8304);i>2&&(l(i-3<<5|8208),i=0)}for(;i--;)l(s);i=1,s=e[a]}return{c:n.subarray(0,r),n:t}},kf=function(e,t){for(var n=0,r=0;r<t.length;++r)n+=e[r]*t[r];return n},tO=function(e,t,n){var r=n.length,s=eO(t+2);e[s]=r&255,e[s+1]=r>>8,e[s+2]=e[s]^255,e[s+3]=e[s+1]^255;for(var i=0;i<r;++i)e[s+i+4]=n[i];return(s+4+r)*8},f8=function(e,t,n,r,s,i,l,a,c,d,u){ao(t,u++,n),++s[256];for(var f=ey(s,15),m=f.t,h=f.l,g=ey(i,15),y=g.t,p=g.l,x=d8(m),b=x.c,w=x.n,N=d8(y),k=N.c,I=N.n,R=new bi(19),T=0;T<b.length;++T)++R[b[T]&31];for(var T=0;T<k.length;++T)++R[k[T]&31];for(var S=ey(R,7),E=S.t,_=S.l,M=19;M>4&&!E[c8[M-1]];--M);var A=d+5<<3,P=kf(s,kc)+kf(i,Yg)+l,B=kf(s,m)+kf(i,y)+l+14+3*M+kf(R,E)+2*R[16]+3*R[17]+7*R[18];if(c>=0&&A<=P&&A<=B)return tO(t,u,e.subarray(c,c+d));var L,D,V,O;if(ao(t,u,1+(B<P)),u+=2,B<P){L=lh(m,h,0),D=m,V=lh(y,p,0),O=y;var H=lh(E,_,0);ao(t,u,w-257),ao(t,u+5,I-1),ao(t,u+10,M-4),u+=14;for(var T=0;T<M;++T)ao(t,u+3*T,E[c8[T]]);u+=3*M;for(var W=[b,k],$=0;$<2;++$)for(var z=W[$],T=0;T<z.length;++T){var q=z[T]&31;ao(t,u,H[q]),u+=E[q],q>15&&(ao(t,u,z[T]>>5&127),u+=z[T]>>12)}}else L=Gle,D=kc,V=Yle,O=Yg;for(var T=0;T<a;++T){var G=r[T];if(G>255){var q=G>>18&31;Af(t,u,L[q+257]),u+=D[q+257],q>7&&(ao(t,u,G>>23&31),u+=J4[q]);var re=G&31;Af(t,u,V[re]),u+=O[re],re>3&&(Af(t,u,G>>5&8191),u+=Z4[re])}else Af(t,u,L[G]),u+=D[G]}return Af(t,u,L[256]),u+D[256]},Kle=new K4([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),nO=new oa(0),Jle=function(e,t,n,r,s,i){var l=i.z||e.length,a=new oa(r+l+5*(1+Math.ceil(l/7e3))+s),c=a.subarray(r,a.length-s),d=i.l,u=(i.r||0)&7;if(t){u&&(c[0]=i.r>>3);for(var f=Kle[t-1],m=f>>13,h=f&8191,g=(1<<n)-1,y=i.p||new bi(32768),p=i.h||new bi(g+1),x=Math.ceil(n/3),b=2*x,w=function(pe){return(e[pe]^e[pe+1]<<x^e[pe+2]<<b)&g},N=new K4(25e3),k=new bi(288),I=new bi(32),R=0,T=0,S=i.i||0,E=0,_=i.w||0,M=0;S+2<l;++S){var A=w(S),P=S&32767,B=p[A];if(y[P]=B,p[A]=P,_<=S){var L=l-S;if((R>7e3||E>24576)&&(L>423||!d)){u=f8(e,c,0,N,k,I,T,E,M,S-M,u),E=R=T=0,M=S;for(var D=0;D<286;++D)k[D]=0;for(var D=0;D<30;++D)I[D]=0}var V=2,O=0,H=h,W=P-B&32767;if(L>2&&A==w(S-W))for(var $=Math.min(m,L)-1,z=Math.min(32767,S),q=Math.min(258,L);W<=z&&--H&&P!=B;){if(e[S+V]==e[S+V-W]){for(var G=0;G<q&&e[S+G]==e[S+G-W];++G);if(G>V){if(V=G,O=W,G>$)break;for(var re=Math.min(W,G-2),oe=0,D=0;D<re;++D){var ie=S-W+D&32767,Y=y[ie],te=ie-Y&32767;te>oe&&(oe=te,B=ie)}}}P=B,B=y[P],W+=P-B&32767}if(O){N[E++]=268435456|ON[V]<<18|u8[O];var we=ON[V]&31,me=u8[O]&31;T+=J4[we]+Z4[me],++k[257+we],++I[me],_=S+V,++R}else N[E++]=e[S],++k[e[S]]}}for(S=Math.max(S,_);S<l;++S)N[E++]=e[S],++k[e[S]];u=f8(e,c,d,N,k,I,T,E,M,S-M,u),d||(i.r=u&7|c[u/8|0]<<3,u-=7,i.h=p,i.p=y,i.i=S,i.w=_)}else{for(var S=i.w||0;S<l+d;S+=65535){var Ee=S+65535;Ee>=l&&(c[u/8|0]=d,Ee=l),u=tO(c,u+1,e.subarray(S,Ee))}i.i=l}return Xle(a,0,r+eO(u)+s)},rO=function(){var e=1,t=0;return{p:function(n){for(var r=e,s=t,i=n.length|0,l=0;l!=i;){for(var a=Math.min(l+2655,i);l<a;++l)s+=r+=n[l];r=(r&65535)+15*(r>>16),s=(s&65535)+15*(s>>16)}e=r,t=s},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},Zle=function(e,t,n,r,s){if(!s&&(s={l:1},t.dictionary)){var i=t.dictionary.subarray(-32768),l=new oa(i.length+e.length);l.set(i),l.set(e,i.length),e=l,s.w=i.length}return Jle(e,t.level==null?6:t.level,t.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,n,r,s)},sO=function(e,t,n){for(;n;++t)e[t]=n,n>>>=8},Qle=function(e,t){var n=t.level,r=n==0?0:n<6?1:n==9?3:2;if(e[0]=120,e[1]=r<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var s=rO();s.p(t.dictionary),sO(e,2,s.d())}};function qN(e,t){t||(t={});var n=rO();n.p(e);var r=Zle(e,t,t.dictionary?6:2,4);return Qle(r,t),sO(r,r.length-4,n.d()),r}var ece=typeof TextDecoder<"u"&&new TextDecoder,tce=0;try{ece.decode(nO,{stream:!0}),tce=1}catch{}function nce(e){if(Array.isArray(e))return e}function rce(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,s,i,l,a=[],c=!0,d=!1;try{if(i=(n=n.call(e)).next,t!==0)for(;!(c=(r=i.call(n)).done)&&(a.push(r.value),a.length!==t);c=!0);}catch(u){d=!0,s=u}finally{try{if(!c&&n.return!=null&&(l=n.return(),Object(l)!==l))return}finally{if(d)throw s}}return a}}function h8(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function sce(e,t){if(e){if(typeof e=="string")return h8(e,t);var n={}.toString.call(e).slice(8,-1);return n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set"?Array.from(e):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h8(e,t):void 0}}function ice(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function m8(e,t){return nce(e)||rce(e,t)||sce(e,t)||ice()}function p8(e,t="utf8"){return new TextDecoder(t).decode(e)}const ace=new TextEncoder;function oce(e){return ace.encode(e)}const lce=1024*8,cce=(()=>{const e=new Uint8Array(4),t=new Uint32Array(e.buffer);return!((t[0]=1)&e[0])})(),ty={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class Q4{constructor(t=lce,n={}){Hn(this,"buffer");Hn(this,"byteLength");Hn(this,"byteOffset");Hn(this,"length");Hn(this,"offset");Hn(this,"lastWrittenByte");Hn(this,"littleEndian");Hn(this,"_data");Hn(this,"_mark");Hn(this,"_marks");let r=!1;typeof t=="number"?t=new ArrayBuffer(t):(r=!0,this.lastWrittenByte=t.byteLength);const s=n.offset?n.offset>>>0:0,i=t.byteLength-s;let l=s;(ArrayBuffer.isView(t)||t instanceof Q4)&&(t.byteLength!==t.buffer.byteLength&&(l=t.byteOffset+s),t=t.buffer),r?this.lastWrittenByte=i:this.lastWrittenByte=0,this.buffer=t,this.length=i,this.byteLength=i,this.byteOffset=l,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,l,i),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const r=(this.offset+t)*2,s=new Uint8Array(r);s.set(new Uint8Array(this.buffer)),this.buffer=s.buffer,this.length=r,this.byteLength=r,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,n){const r=ty[n].BYTES_PER_ELEMENT*t,s=this.byteOffset+this.offset,i=this.buffer.slice(s,s+r);if(this.littleEndian===cce&&n!=="uint8"&&n!=="int8"){const a=new Uint8Array(this.buffer.slice(s,s+r));a.reverse();const c=new ty[n](a.buffer);return this.offset+=r,c.reverse(),c}const l=new ty[n](i);return this.offset+=r,l}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let n="";for(let r=0;r<t;r++)n+=this.readChar();return n}readUtf8(t=1){return p8(this.readBytes(t))}decodeText(t=1,n="utf8"){return p8(this.readBytes(t),n)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let n=0;n<t.length;n++)this._data.setUint8(this.offset++,t[n]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let n=0;n<t.length;n++)this.writeUint8(t.charCodeAt(n));return this}writeUtf8(t){return this.writeBytes(oce(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function Ed(e){let t=e.length;for(;--t>=0;)e[t]=0}const uce=3,dce=258,iO=29,fce=256,hce=fce+1+iO,aO=30,mce=512,pce=new Array((hce+2)*2);Ed(pce);const gce=new Array(aO*2);Ed(gce);const xce=new Array(mce);Ed(xce);const yce=new Array(dce-uce+1);Ed(yce);const vce=new Array(iO);Ed(vce);const bce=new Array(aO);Ed(bce);const wce=(e,t,n,r)=>{let s=e&65535|0,i=e>>>16&65535|0,l=0;for(;n!==0;){l=n>2e3?2e3:n,n-=l;do s=s+t[r++]|0,i=i+s|0;while(--l);s%=65521,i%=65521}return s|i<<16|0};var BN=wce;const Nce=()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=e&1?3988292384^e>>>1:e>>>1;t[n]=e}return t},jce=new Uint32Array(Nce()),_ce=(e,t,n,r)=>{const s=jce,i=r+n;e^=-1;for(let l=r;l<i;l++)e=e>>>8^s[(e^t[l])&255];return e^-1};var ja=_ce,zN={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},oO={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const Sce=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var Ace=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if(typeof n!="object")throw new TypeError(n+"must be non-object");for(const r in n)Sce(n,r)&&(e[r]=n[r])}}return e},kce=e=>{let t=0;for(let r=0,s=e.length;r<s;r++)t+=e[r].length;const n=new Uint8Array(t);for(let r=0,s=0,i=e.length;r<i;r++){let l=e[r];n.set(l,s),s+=l.length}return n},lO={assign:Ace,flattenChunks:kce};let cO=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{cO=!1}const Dh=new Uint8Array(256);for(let e=0;e<256;e++)Dh[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;Dh[254]=Dh[254]=1;var Ece=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,n,r,s,i,l=e.length,a=0;for(s=0;s<l;s++)n=e.charCodeAt(s),(n&64512)===55296&&s+1<l&&(r=e.charCodeAt(s+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),s++)),a+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(a),i=0,s=0;i<a;s++)n=e.charCodeAt(s),(n&64512)===55296&&s+1<l&&(r=e.charCodeAt(s+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),s++)),n<128?t[i++]=n:n<2048?(t[i++]=192|n>>>6,t[i++]=128|n&63):n<65536?(t[i++]=224|n>>>12,t[i++]=128|n>>>6&63,t[i++]=128|n&63):(t[i++]=240|n>>>18,t[i++]=128|n>>>12&63,t[i++]=128|n>>>6&63,t[i++]=128|n&63);return t};const Cce=(e,t)=>{if(t<65534&&e.subarray&&cO)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n};var Pce=(e,t)=>{const n=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let r,s;const i=new Array(n*2);for(s=0,r=0;r<n;){let l=e[r++];if(l<128){i[s++]=l;continue}let a=Dh[l];if(a>4){i[s++]=65533,r+=a-1;continue}for(l&=a===2?31:a===3?15:7;a>1&&r<n;)l=l<<6|e[r++]&63,a--;if(a>1){i[s++]=65533;continue}l<65536?i[s++]=l:(l-=65536,i[s++]=55296|l>>10&1023,i[s++]=56320|l&1023)}return Cce(i,s)},Ice=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let n=t-1;for(;n>=0&&(e[n]&192)===128;)n--;return n<0||n===0?t:n+Dh[e[n]]>t?n:t},UN={string2buf:Ece,buf2string:Pce,utf8border:Ice};function Tce(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Lce=Tce;const mp=16209,Mce=16191;var Rce=function(t,n){let r,s,i,l,a,c,d,u,f,m,h,g,y,p,x,b,w,N,k,I,R,T,S,E;const _=t.state;r=t.next_in,S=t.input,s=r+(t.avail_in-5),i=t.next_out,E=t.output,l=i-(n-t.avail_out),a=i+(t.avail_out-257),c=_.dmax,d=_.wsize,u=_.whave,f=_.wnext,m=_.window,h=_.hold,g=_.bits,y=_.lencode,p=_.distcode,x=(1<<_.lenbits)-1,b=(1<<_.distbits)-1;e:do{g<15&&(h+=S[r++]<<g,g+=8,h+=S[r++]<<g,g+=8),w=y[h&x];t:for(;;){if(N=w>>>24,h>>>=N,g-=N,N=w>>>16&255,N===0)E[i++]=w&65535;else if(N&16){k=w&65535,N&=15,N&&(g<N&&(h+=S[r++]<<g,g+=8),k+=h&(1<<N)-1,h>>>=N,g-=N),g<15&&(h+=S[r++]<<g,g+=8,h+=S[r++]<<g,g+=8),w=p[h&b];n:for(;;){if(N=w>>>24,h>>>=N,g-=N,N=w>>>16&255,N&16){if(I=w&65535,N&=15,g<N&&(h+=S[r++]<<g,g+=8,g<N&&(h+=S[r++]<<g,g+=8)),I+=h&(1<<N)-1,I>c){t.msg="invalid distance too far back",_.mode=mp;break e}if(h>>>=N,g-=N,N=i-l,I>N){if(N=I-N,N>u&&_.sane){t.msg="invalid distance too far back",_.mode=mp;break e}if(R=0,T=m,f===0){if(R+=d-N,N<k){k-=N;do E[i++]=m[R++];while(--N);R=i-I,T=E}}else if(f<N){if(R+=d+f-N,N-=f,N<k){k-=N;do E[i++]=m[R++];while(--N);if(R=0,f<k){N=f,k-=N;do E[i++]=m[R++];while(--N);R=i-I,T=E}}}else if(R+=f-N,N<k){k-=N;do E[i++]=m[R++];while(--N);R=i-I,T=E}for(;k>2;)E[i++]=T[R++],E[i++]=T[R++],E[i++]=T[R++],k-=3;k&&(E[i++]=T[R++],k>1&&(E[i++]=T[R++]))}else{R=i-I;do E[i++]=E[R++],E[i++]=E[R++],E[i++]=E[R++],k-=3;while(k>2);k&&(E[i++]=E[R++],k>1&&(E[i++]=E[R++]))}}else if(N&64){t.msg="invalid distance code",_.mode=mp;break e}else{w=p[(w&65535)+(h&(1<<N)-1)];continue n}break}}else if(N&64)if(N&32){_.mode=Mce;break e}else{t.msg="invalid literal/length code",_.mode=mp;break e}else{w=y[(w&65535)+(h&(1<<N)-1)];continue t}break}}while(r<s&&i<a);k=g>>3,r-=k,g-=k<<3,h&=(1<<g)-1,t.next_in=r,t.next_out=i,t.avail_in=r<s?5+(s-r):5-(r-s),t.avail_out=i<a?257+(a-i):257-(i-a),_.hold=h,_.bits=g};const Nu=15,g8=852,x8=592,y8=0,ny=1,v8=2,$ce=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),Oce=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Fce=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Dce=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),qce=(e,t,n,r,s,i,l,a)=>{const c=a.bits;let d=0,u=0,f=0,m=0,h=0,g=0,y=0,p=0,x=0,b=0,w,N,k,I,R,T=null,S;const E=new Uint16Array(Nu+1),_=new Uint16Array(Nu+1);let M=null,A,P,B;for(d=0;d<=Nu;d++)E[d]=0;for(u=0;u<r;u++)E[t[n+u]]++;for(h=c,m=Nu;m>=1&&E[m]===0;m--);if(h>m&&(h=m),m===0)return s[i++]=1<<24|64<<16|0,s[i++]=1<<24|64<<16|0,a.bits=1,0;for(f=1;f<m&&E[f]===0;f++);for(h<f&&(h=f),p=1,d=1;d<=Nu;d++)if(p<<=1,p-=E[d],p<0)return-1;if(p>0&&(e===y8||m!==1))return-1;for(_[1]=0,d=1;d<Nu;d++)_[d+1]=_[d]+E[d];for(u=0;u<r;u++)t[n+u]!==0&&(l[_[t[n+u]]++]=u);if(e===y8?(T=M=l,S=20):e===ny?(T=$ce,M=Oce,S=257):(T=Fce,M=Dce,S=0),b=0,u=0,d=f,R=i,g=h,y=0,k=-1,x=1<<h,I=x-1,e===ny&&x>g8||e===v8&&x>x8)return 1;for(;;){A=d-y,l[u]+1<S?(P=0,B=l[u]):l[u]>=S?(P=M[l[u]-S],B=T[l[u]-S]):(P=96,B=0),w=1<<d-y,N=1<<g,f=N;do N-=w,s[R+(b>>y)+N]=A<<24|P<<16|B|0;while(N!==0);for(w=1<<d-1;b&w;)w>>=1;if(w!==0?(b&=w-1,b+=w):b=0,u++,--E[d]===0){if(d===m)break;d=t[n+l[u]]}if(d>h&&(b&I)!==k){for(y===0&&(y=h),R+=f,g=d-y,p=1<<g;g+y<m&&(p-=E[g+y],!(p<=0));)g++,p<<=1;if(x+=1<<g,e===ny&&x>g8||e===v8&&x>x8)return 1;k=b&I,s[k]=h<<24|g<<16|R-i|0}}return b!==0&&(s[R+b]=d-y<<24|64<<16|0),a.bits=h,0};var ch=qce;const Bce=0,uO=1,dO=2,{Z_FINISH:b8,Z_BLOCK:zce,Z_TREES:pp,Z_OK:Ec,Z_STREAM_END:Uce,Z_NEED_DICT:Hce,Z_STREAM_ERROR:qi,Z_DATA_ERROR:fO,Z_MEM_ERROR:hO,Z_BUF_ERROR:Vce,Z_DEFLATED:w8}=oO,o1=16180,N8=16181,j8=16182,_8=16183,S8=16184,A8=16185,k8=16186,E8=16187,C8=16188,P8=16189,Xg=16190,oo=16191,ry=16192,I8=16193,sy=16194,T8=16195,L8=16196,M8=16197,R8=16198,gp=16199,xp=16200,$8=16201,O8=16202,F8=16203,D8=16204,q8=16205,iy=16206,B8=16207,z8=16208,ar=16209,mO=16210,pO=16211,Wce=852,Gce=592,Yce=15,Xce=Yce,U8=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function Kce(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Fc=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<o1||t.mode>pO?1:0},gO=e=>{if(Fc(e))return qi;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=o1,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(Wce),t.distcode=t.distdyn=new Int32Array(Gce),t.sane=1,t.back=-1,Ec},xO=e=>{if(Fc(e))return qi;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,gO(e)},yO=(e,t)=>{let n;if(Fc(e))return qi;const r=e.state;return t<0?(n=0,t=-t):(n=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?qi:(r.window!==null&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,xO(e))},vO=(e,t)=>{if(!e)return qi;const n=new Kce;e.state=n,n.strm=e,n.window=null,n.mode=o1;const r=yO(e,t);return r!==Ec&&(e.state=null),r},Jce=e=>vO(e,Xce);let H8=!0,ay,oy;const Zce=e=>{if(H8){ay=new Int32Array(512),oy=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(ch(uO,e.lens,0,288,ay,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;ch(dO,e.lens,0,32,oy,0,e.work,{bits:5}),H8=!1}e.lencode=ay,e.lenbits=9,e.distcode=oy,e.distbits=5},bO=(e,t,n,r)=>{let s;const i=e.state;return i.window===null&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),r>=i.wsize?(i.window.set(t.subarray(n-i.wsize,n),0),i.wnext=0,i.whave=i.wsize):(s=i.wsize-i.wnext,s>r&&(s=r),i.window.set(t.subarray(n-r,n-r+s),i.wnext),r-=s,r?(i.window.set(t.subarray(n-r,n),0),i.wnext=r,i.whave=i.wsize):(i.wnext+=s,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=s))),0},Qce=(e,t)=>{let n,r,s,i,l,a,c,d,u,f,m,h,g,y,p=0,x,b,w,N,k,I,R,T;const S=new Uint8Array(4);let E,_;const M=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Fc(e)||!e.output||!e.input&&e.avail_in!==0)return qi;n=e.state,n.mode===oo&&(n.mode=ry),l=e.next_out,s=e.output,c=e.avail_out,i=e.next_in,r=e.input,a=e.avail_in,d=n.hold,u=n.bits,f=a,m=c,T=Ec;e:for(;;)switch(n.mode){case o1:if(n.wrap===0){n.mode=ry;break}for(;u<16;){if(a===0)break e;a--,d+=r[i++]<<u,u+=8}if(n.wrap&2&&d===35615){n.wbits===0&&(n.wbits=15),n.check=0,S[0]=d&255,S[1]=d>>>8&255,n.check=ja(n.check,S,2,0),d=0,u=0,n.mode=N8;break}if(n.head&&(n.head.done=!1),!(n.wrap&1)||(((d&255)<<8)+(d>>8))%31){e.msg="incorrect header check",n.mode=ar;break}if((d&15)!==w8){e.msg="unknown compression method",n.mode=ar;break}if(d>>>=4,u-=4,R=(d&15)+8,n.wbits===0&&(n.wbits=R),R>15||R>n.wbits){e.msg="invalid window size",n.mode=ar;break}n.dmax=1<<n.wbits,n.flags=0,e.adler=n.check=1,n.mode=d&512?P8:oo,d=0,u=0;break;case N8:for(;u<16;){if(a===0)break e;a--,d+=r[i++]<<u,u+=8}if(n.flags=d,(n.flags&255)!==w8){e.msg="unknown compression method",n.mode=ar;break}if(n.flags&57344){e.msg="unknown header flags set",n.mode=ar;break}n.head&&(n.head.text=d>>8&1),n.flags&512&&n.wrap&4&&(S[0]=d&255,S[1]=d>>>8&255,n.check=ja(n.check,S,2,0)),d=0,u=0,n.mode=j8;case j8:for(;u<32;){if(a===0)break e;a--,d+=r[i++]<<u,u+=8}n.head&&(n.head.time=d),n.flags&512&&n.wrap&4&&(S[0]=d&255,S[1]=d>>>8&255,S[2]=d>>>16&255,S[3]=d>>>24&255,n.check=ja(n.check,S,4,0)),d=0,u=0,n.mode=_8;case _8:for(;u<16;){if(a===0)break e;a--,d+=r[i++]<<u,u+=8}n.head&&(n.head.xflags=d&255,n.head.os=d>>8),n.flags&512&&n.wrap&4&&(S[0]=d&255,S[1]=d>>>8&255,n.check=ja(n.check,S,2,0)),d=0,u=0,n.mode=S8;case S8:if(n.flags&1024){for(;u<16;){if(a===0)break e;a--,d+=r[i++]<<u,u+=8}n.length=d,n.head&&(n.head.extra_len=d),n.flags&512&&n.wrap&4&&(S[0]=d&255,S[1]=d>>>8&255,n.check=ja(n.check,S,2,0)),d=0,u=0}else n.head&&(n.head.extra=null);n.mode=A8;case A8:if(n.flags&1024&&(h=n.length,h>a&&(h=a),h&&(n.head&&(R=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(i,i+h),R)),n.flags&512&&n.wrap&4&&(n.check=ja(n.check,r,h,i)),a-=h,i+=h,n.length-=h),n.length))break e;n.length=0,n.mode=k8;case k8:if(n.flags&2048){if(a===0)break e;h=0;do R=r[i+h++],n.head&&R&&n.length<65536&&(n.head.name+=String.fromCharCode(R));while(R&&h<a);if(n.flags&512&&n.wrap&4&&(n.check=ja(n.check,r,h,i)),a-=h,i+=h,R)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=E8;case E8:if(n.flags&4096){if(a===0)break e;h=0;do R=r[i+h++],n.head&&R&&n.length<65536&&(n.head.comment+=String.fromCharCode(R));while(R&&h<a);if(n.flags&512&&n.wrap&4&&(n.check=ja(n.check,r,h,i)),a-=h,i+=h,R)break e}else n.head&&(n.head.comment=null);n.mode=C8;case C8:if(n.flags&512){for(;u<16;){if(a===0)break e;a--,d+=r[i++]<<u,u+=8}if(n.wrap&4&&d!==(n.check&65535)){e.msg="header crc mismatch",n.mode=ar;break}d=0,u=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=oo;break;case P8:for(;u<32;){if(a===0)break e;a--,d+=r[i++]<<u,u+=8}e.adler=n.check=U8(d),d=0,u=0,n.mode=Xg;case Xg:if(n.havedict===0)return e.next_out=l,e.avail_out=c,e.next_in=i,e.avail_in=a,n.hold=d,n.bits=u,Hce;e.adler=n.check=1,n.mode=oo;case oo:if(t===zce||t===pp)break e;case ry:if(n.last){d>>>=u&7,u-=u&7,n.mode=iy;break}for(;u<3;){if(a===0)break e;a--,d+=r[i++]<<u,u+=8}switch(n.last=d&1,d>>>=1,u-=1,d&3){case 0:n.mode=I8;break;case 1:if(Zce(n),n.mode=gp,t===pp){d>>>=2,u-=2;break e}break;case 2:n.mode=L8;break;case 3:e.msg="invalid block type",n.mode=ar}d>>>=2,u-=2;break;case I8:for(d>>>=u&7,u-=u&7;u<32;){if(a===0)break e;a--,d+=r[i++]<<u,u+=8}if((d&65535)!==(d>>>16^65535)){e.msg="invalid stored block lengths",n.mode=ar;break}if(n.length=d&65535,d=0,u=0,n.mode=sy,t===pp)break e;case sy:n.mode=T8;case T8:if(h=n.length,h){if(h>a&&(h=a),h>c&&(h=c),h===0)break e;s.set(r.subarray(i,i+h),l),a-=h,i+=h,c-=h,l+=h,n.length-=h;break}n.mode=oo;break;case L8:for(;u<14;){if(a===0)break e;a--,d+=r[i++]<<u,u+=8}if(n.nlen=(d&31)+257,d>>>=5,u-=5,n.ndist=(d&31)+1,d>>>=5,u-=5,n.ncode=(d&15)+4,d>>>=4,u-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=ar;break}n.have=0,n.mode=M8;case M8:for(;n.have<n.ncode;){for(;u<3;){if(a===0)break e;a--,d+=r[i++]<<u,u+=8}n.lens[M[n.have++]]=d&7,d>>>=3,u-=3}for(;n.have<19;)n.lens[M[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,E={bits:n.lenbits},T=ch(Bce,n.lens,0,19,n.lencode,0,n.work,E),n.lenbits=E.bits,T){e.msg="invalid code lengths set",n.mode=ar;break}n.have=0,n.mode=R8;case R8:for(;n.have<n.nlen+n.ndist;){for(;p=n.lencode[d&(1<<n.lenbits)-1],x=p>>>24,b=p>>>16&255,w=p&65535,!(x<=u);){if(a===0)break e;a--,d+=r[i++]<<u,u+=8}if(w<16)d>>>=x,u-=x,n.lens[n.have++]=w;else{if(w===16){for(_=x+2;u<_;){if(a===0)break e;a--,d+=r[i++]<<u,u+=8}if(d>>>=x,u-=x,n.have===0){e.msg="invalid bit length repeat",n.mode=ar;break}R=n.lens[n.have-1],h=3+(d&3),d>>>=2,u-=2}else if(w===17){for(_=x+3;u<_;){if(a===0)break e;a--,d+=r[i++]<<u,u+=8}d>>>=x,u-=x,R=0,h=3+(d&7),d>>>=3,u-=3}else{for(_=x+7;u<_;){if(a===0)break e;a--,d+=r[i++]<<u,u+=8}d>>>=x,u-=x,R=0,h=11+(d&127),d>>>=7,u-=7}if(n.have+h>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=ar;break}for(;h--;)n.lens[n.have++]=R}}if(n.mode===ar)break;if(n.lens[256]===0){e.msg="invalid code -- missing end-of-block",n.mode=ar;break}if(n.lenbits=9,E={bits:n.lenbits},T=ch(uO,n.lens,0,n.nlen,n.lencode,0,n.work,E),n.lenbits=E.bits,T){e.msg="invalid literal/lengths set",n.mode=ar;break}if(n.distbits=6,n.distcode=n.distdyn,E={bits:n.distbits},T=ch(dO,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,E),n.distbits=E.bits,T){e.msg="invalid distances set",n.mode=ar;break}if(n.mode=gp,t===pp)break e;case gp:n.mode=xp;case xp:if(a>=6&&c>=258){e.next_out=l,e.avail_out=c,e.next_in=i,e.avail_in=a,n.hold=d,n.bits=u,Rce(e,m),l=e.next_out,s=e.output,c=e.avail_out,i=e.next_in,r=e.input,a=e.avail_in,d=n.hold,u=n.bits,n.mode===oo&&(n.back=-1);break}for(n.back=0;p=n.lencode[d&(1<<n.lenbits)-1],x=p>>>24,b=p>>>16&255,w=p&65535,!(x<=u);){if(a===0)break e;a--,d+=r[i++]<<u,u+=8}if(b&&!(b&240)){for(N=x,k=b,I=w;p=n.lencode[I+((d&(1<<N+k)-1)>>N)],x=p>>>24,b=p>>>16&255,w=p&65535,!(N+x<=u);){if(a===0)break e;a--,d+=r[i++]<<u,u+=8}d>>>=N,u-=N,n.back+=N}if(d>>>=x,u-=x,n.back+=x,n.length=w,b===0){n.mode=q8;break}if(b&32){n.back=-1,n.mode=oo;break}if(b&64){e.msg="invalid literal/length code",n.mode=ar;break}n.extra=b&15,n.mode=$8;case $8:if(n.extra){for(_=n.extra;u<_;){if(a===0)break e;a--,d+=r[i++]<<u,u+=8}n.length+=d&(1<<n.extra)-1,d>>>=n.extra,u-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=O8;case O8:for(;p=n.distcode[d&(1<<n.distbits)-1],x=p>>>24,b=p>>>16&255,w=p&65535,!(x<=u);){if(a===0)break e;a--,d+=r[i++]<<u,u+=8}if(!(b&240)){for(N=x,k=b,I=w;p=n.distcode[I+((d&(1<<N+k)-1)>>N)],x=p>>>24,b=p>>>16&255,w=p&65535,!(N+x<=u);){if(a===0)break e;a--,d+=r[i++]<<u,u+=8}d>>>=N,u-=N,n.back+=N}if(d>>>=x,u-=x,n.back+=x,b&64){e.msg="invalid distance code",n.mode=ar;break}n.offset=w,n.extra=b&15,n.mode=F8;case F8:if(n.extra){for(_=n.extra;u<_;){if(a===0)break e;a--,d+=r[i++]<<u,u+=8}n.offset+=d&(1<<n.extra)-1,d>>>=n.extra,u-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=ar;break}n.mode=D8;case D8:if(c===0)break e;if(h=m-c,n.offset>h){if(h=n.offset-h,h>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=ar;break}h>n.wnext?(h-=n.wnext,g=n.wsize-h):g=n.wnext-h,h>n.length&&(h=n.length),y=n.window}else y=s,g=l-n.offset,h=n.length;h>c&&(h=c),c-=h,n.length-=h;do s[l++]=y[g++];while(--h);n.length===0&&(n.mode=xp);break;case q8:if(c===0)break e;s[l++]=n.length,c--,n.mode=xp;break;case iy:if(n.wrap){for(;u<32;){if(a===0)break e;a--,d|=r[i++]<<u,u+=8}if(m-=c,e.total_out+=m,n.total+=m,n.wrap&4&&m&&(e.adler=n.check=n.flags?ja(n.check,s,m,l-m):BN(n.check,s,m,l-m)),m=c,n.wrap&4&&(n.flags?d:U8(d))!==n.check){e.msg="incorrect data check",n.mode=ar;break}d=0,u=0}n.mode=B8;case B8:if(n.wrap&&n.flags){for(;u<32;){if(a===0)break e;a--,d+=r[i++]<<u,u+=8}if(n.wrap&4&&d!==(n.total&4294967295)){e.msg="incorrect length check",n.mode=ar;break}d=0,u=0}n.mode=z8;case z8:T=Uce;break e;case ar:T=fO;break e;case mO:return hO;case pO:default:return qi}return e.next_out=l,e.avail_out=c,e.next_in=i,e.avail_in=a,n.hold=d,n.bits=u,(n.wsize||m!==e.avail_out&&n.mode<ar&&(n.mode<iy||t!==b8))&&bO(e,e.output,e.next_out,m-e.avail_out),f-=e.avail_in,m-=e.avail_out,e.total_in+=f,e.total_out+=m,n.total+=m,n.wrap&4&&m&&(e.adler=n.check=n.flags?ja(n.check,s,m,e.next_out-m):BN(n.check,s,m,e.next_out-m)),e.data_type=n.bits+(n.last?64:0)+(n.mode===oo?128:0)+(n.mode===gp||n.mode===sy?256:0),(f===0&&m===0||t===b8)&&T===Ec&&(T=Vce),T},eue=e=>{if(Fc(e))return qi;let t=e.state;return t.window&&(t.window=null),e.state=null,Ec},tue=(e,t)=>{if(Fc(e))return qi;const n=e.state;return n.wrap&2?(n.head=t,t.done=!1,Ec):qi},nue=(e,t)=>{const n=t.length;let r,s,i;return Fc(e)||(r=e.state,r.wrap!==0&&r.mode!==Xg)?qi:r.mode===Xg&&(s=1,s=BN(s,t,n,0),s!==r.check)?fO:(i=bO(e,t,n,n),i?(r.mode=mO,hO):(r.havedict=1,Ec))};var rue=xO,sue=yO,iue=gO,aue=Jce,oue=vO,lue=Qce,cue=eue,uue=tue,due=nue,fue="pako inflate (from Nodeca project)",fo={inflateReset:rue,inflateReset2:sue,inflateResetKeep:iue,inflateInit:aue,inflateInit2:oue,inflate:lue,inflateEnd:cue,inflateGetHeader:uue,inflateSetDictionary:due,inflateInfo:fue};function hue(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var mue=hue;const wO=Object.prototype.toString,{Z_NO_FLUSH:pue,Z_FINISH:gue,Z_OK:qh,Z_STREAM_END:ly,Z_NEED_DICT:cy,Z_STREAM_ERROR:xue,Z_DATA_ERROR:V8,Z_MEM_ERROR:yue}=oO;function lm(e){this.options=lO.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Lce,this.strm.avail_out=0;let n=fo.inflateInit2(this.strm,t.windowBits);if(n!==qh)throw new Error(zN[n]);if(this.header=new mue,fo.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=UN.string2buf(t.dictionary):wO.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=fo.inflateSetDictionary(this.strm,t.dictionary),n!==qh)))throw new Error(zN[n])}lm.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize,s=this.options.dictionary;let i,l,a;if(this.ended)return!1;for(t===~~t?l=t:l=t===!0?gue:pue,wO.call(e)==="[object ArrayBuffer]"?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),i=fo.inflate(n,l),i===cy&&s&&(i=fo.inflateSetDictionary(n,s),i===qh?i=fo.inflate(n,l):i===V8&&(i=cy));n.avail_in>0&&i===ly&&n.state.wrap>0&&e[n.next_in]!==0;)fo.inflateReset(n),i=fo.inflate(n,l);switch(i){case xue:case V8:case cy:case yue:return this.onEnd(i),this.ended=!0,!1}if(a=n.avail_out,n.next_out&&(n.avail_out===0||i===ly))if(this.options.to==="string"){let c=UN.utf8border(n.output,n.next_out),d=n.next_out-c,u=UN.buf2string(n.output,c);n.next_out=d,n.avail_out=r-d,d&&n.output.set(n.output.subarray(c,c+d),0),this.onData(u)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(!(i===qh&&a===0)){if(i===ly)return i=fo.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(n.avail_in===0)break}}return!0};lm.prototype.onData=function(e){this.chunks.push(e)};lm.prototype.onEnd=function(e){e===qh&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=lO.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function vue(e,t){const n=new lm(t);if(n.push(e),n.err)throw n.msg||zN[n.err];return n.result}var bue=lm,wue=vue,Nue={Inflate:bue,inflate:wue};const{Inflate:jue,inflate:_ue}=Nue;var W8=jue,Sue=_ue;const NO=[];for(let e=0;e<256;e++){let t=e;for(let n=0;n<8;n++)t&1?t=3988292384^t>>>1:t=t>>>1;NO[e]=t}const G8=4294967295;function Aue(e,t,n){let r=e;for(let s=0;s<n;s++)r=NO[(r^t[s])&255]^r>>>8;return r}function kue(e,t){return(Aue(G8,e,t)^G8)>>>0}function Y8(e,t,n){const r=e.readUint32(),s=kue(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(s!==r)throw new Error(`CRC mismatch for chunk ${n}. Expected ${r}, found ${s}`)}function jO(e,t,n){for(let r=0;r<n;r++)t[r]=e[r]}function _O(e,t,n,r){let s=0;for(;s<r;s++)t[s]=e[s];for(;s<n;s++)t[s]=e[s]+t[s-r]&255}function SO(e,t,n,r){let s=0;if(n.length===0)for(;s<r;s++)t[s]=e[s];else for(;s<r;s++)t[s]=e[s]+n[s]&255}function AO(e,t,n,r,s){let i=0;if(n.length===0){for(;i<s;i++)t[i]=e[i];for(;i<r;i++)t[i]=e[i]+(t[i-s]>>1)&255}else{for(;i<s;i++)t[i]=e[i]+(n[i]>>1)&255;for(;i<r;i++)t[i]=e[i]+(t[i-s]+n[i]>>1)&255}}function kO(e,t,n,r,s){let i=0;if(n.length===0){for(;i<s;i++)t[i]=e[i];for(;i<r;i++)t[i]=e[i]+t[i-s]&255}else{for(;i<s;i++)t[i]=e[i]+n[i]&255;for(;i<r;i++)t[i]=e[i]+Eue(t[i-s],n[i],n[i-s])&255}}function Eue(e,t,n){const r=e+t-n,s=Math.abs(r-e),i=Math.abs(r-t),l=Math.abs(r-n);return s<=i&&s<=l?e:i<=l?t:n}function Cue(e,t,n,r,s,i){switch(e){case 0:jO(t,n,s);break;case 1:_O(t,n,s,i);break;case 2:SO(t,n,r,s);break;case 3:AO(t,n,r,s,i);break;case 4:kO(t,n,r,s,i);break;default:throw new Error(`Unsupported filter: ${e}`)}}const Pue=new Uint16Array([255]),Iue=new Uint8Array(Pue.buffer),Tue=Iue[0]===255;function Lue(e){const{data:t,width:n,height:r,channels:s,depth:i}=e,l=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],a=Math.ceil(i/8)*s,c=new Uint8Array(r*n*a);let d=0;for(let u=0;u<7;u++){const f=l[u],m=Math.ceil((n-f.x)/f.xStep),h=Math.ceil((r-f.y)/f.yStep);if(m<=0||h<=0)continue;const g=m*a,y=new Uint8Array(g);for(let p=0;p<h;p++){const x=t[d++],b=t.subarray(d,d+g);d+=g;const w=new Uint8Array(g);Cue(x,b,w,y,g,a),y.set(w);for(let N=0;N<m;N++){const k=f.x+N*f.xStep,I=f.y+p*f.yStep;if(!(k>=n||I>=r))for(let R=0;R<a;R++)c[(I*n+k)*a+R]=w[N*a+R]}}}if(i===16){const u=new Uint16Array(c.buffer);if(Tue)for(let f=0;f<u.length;f++)u[f]=Mue(u[f]);return u}else return c}function Mue(e){return(e&255)<<8|e>>8&255}const Rue=new Uint16Array([255]),$ue=new Uint8Array(Rue.buffer),Oue=$ue[0]===255,Fue=new Uint8Array(0);function X8(e){const{data:t,width:n,height:r,channels:s,depth:i}=e,l=Math.ceil(i/8)*s,a=Math.ceil(i/8*s*n),c=new Uint8Array(r*a);let d=Fue,u=0,f,m;for(let h=0;h<r;h++){switch(f=t.subarray(u+1,u+1+a),m=c.subarray(h*a,(h+1)*a),t[u]){case 0:jO(f,m,a);break;case 1:_O(f,m,a,l);break;case 2:SO(f,m,d,a);break;case 3:AO(f,m,d,a,l);break;case 4:kO(f,m,d,a,l);break;default:throw new Error(`Unsupported filter: ${t[u]}`)}d=m,u+=a+1}if(i===16){const h=new Uint16Array(c.buffer);if(Oue)for(let g=0;g<h.length;g++)h[g]=Due(h[g]);return h}else return c}function Due(e){return(e&255)<<8|e>>8&255}const Wp=Uint8Array.of(137,80,78,71,13,10,26,10);function K8(e){if(!que(e.readBytes(Wp.length)))throw new Error("wrong PNG signature")}function que(e){if(e.length<Wp.length)return!1;for(let t=0;t<Wp.length;t++)if(e[t]!==Wp[t])return!1;return!0}const Bue="tEXt",zue=0,EO=new TextDecoder("latin1");function Uue(e){if(Vue(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const Hue=/^[\u0000-\u00FF]*$/;function Vue(e){if(!Hue.test(e))throw new Error("invalid latin1 text")}function Wue(e,t,n){const r=CO(t);e[r]=Gue(t,n-r.length-1)}function CO(e){for(e.mark();e.readByte()!==zue;);const t=e.offset;e.reset();const n=EO.decode(e.readBytes(t-e.offset-1));return e.skip(1),Uue(n),n}function Gue(e,t){return EO.decode(e.readBytes(t))}const fi={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},uy={UNKNOWN:-1,DEFLATE:0},J8={UNKNOWN:-1,ADAPTIVE:0},dy={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},yp={NONE:0,BACKGROUND:1,PREVIOUS:2},fy={SOURCE:0,OVER:1};class Yue extends Q4{constructor(n,r={}){super(n);Hn(this,"_checkCrc");Hn(this,"_inflator");Hn(this,"_png");Hn(this,"_apng");Hn(this,"_end");Hn(this,"_hasPalette");Hn(this,"_palette");Hn(this,"_hasTransparency");Hn(this,"_transparency");Hn(this,"_compressionMethod");Hn(this,"_filterMethod");Hn(this,"_interlaceMethod");Hn(this,"_colorType");Hn(this,"_isAnimated");Hn(this,"_numberOfFrames");Hn(this,"_numberOfPlays");Hn(this,"_frames");Hn(this,"_writingDataChunks");const{checkCrc:s=!1}=r;this._checkCrc=s,this._inflator=new W8,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=uy.UNKNOWN,this._filterMethod=J8.UNKNOWN,this._interlaceMethod=dy.UNKNOWN,this._colorType=fi.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(K8(this);!this._end;){const n=this.readUint32(),r=this.readChars(4);this.decodeChunk(n,r)}return this.decodeImage(),this._png}decodeApng(){for(K8(this);!this._end;){const n=this.readUint32(),r=this.readChars(4);this.decodeApngChunk(n,r)}return this.decodeApngImage(),this._apng}decodeChunk(n,r){const s=this.offset;switch(r){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(n);break;case"IDAT":this.decodeIDAT(n);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(n);break;case"iCCP":this.decodeiCCP(n);break;case Bue:Wue(this._png.text,this,n);break;case"pHYs":this.decodepHYs();break;default:this.skip(n);break}if(this.offset-s!==n)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?Y8(this,n+4,r):this.skip(4)}decodeApngChunk(n,r){const s=this.offset;switch(r!=="fdAT"&&r!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),r){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(n);break;default:this.decodeChunk(n,r),this.offset=s+n;break}if(this.offset-s!==n)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?Y8(this,n+4,r):this.skip(4)}decodeIHDR(){const n=this._png;n.width=this.readUint32(),n.height=this.readUint32(),n.depth=Xue(this.readUint8());const r=this.readUint8();this._colorType=r;let s;switch(r){case fi.GREYSCALE:s=1;break;case fi.TRUECOLOUR:s=3;break;case fi.INDEXED_COLOUR:s=1;break;case fi.GREYSCALE_ALPHA:s=2;break;case fi.TRUECOLOUR_ALPHA:s=4;break;case fi.UNKNOWN:default:throw new Error(`Unknown color type: ${r}`)}if(this._png.channels=s,this._compressionMethod=this.readUint8(),this._compressionMethod!==uy.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const n={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(n)}decodePLTE(n){if(n%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${n}`);const r=n/3;this._hasPalette=!0;const s=[];this._palette=s;for(let i=0;i<r;i++)s.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(n){this._writingDataChunks=!0;const r=n,s=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,s,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(n)}decodeFDAT(n){this._writingDataChunks=!0;let r=n,s=this.offset+this.byteOffset;if(s+=4,r-=4,this._inflator.push(new Uint8Array(this.buffer,s,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(n)}decodetRNS(n){switch(this._colorType){case fi.GREYSCALE:case fi.TRUECOLOUR:{if(n%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${n}`);if(n/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${n/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(n/2);for(let r=0;r<n/2;r++)this._transparency[r]=this.readUint16();break}case fi.INDEXED_COLOUR:{if(n>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${n} vs ${this._palette.length})`);let r=0;for(;r<n;r++){const s=this.readByte();this._palette[r].push(s)}for(;r<this._palette.length;r++)this._palette[r].push(255);break}case fi.UNKNOWN:case fi.GREYSCALE_ALPHA:case fi.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(n){const r=CO(this),s=this.readUint8();if(s!==uy.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${s}`);const i=this.readBytes(n-r.length-2);this._png.iccEmbeddedProfile={name:r,profile:Sue(i)}}decodepHYs(){const n=this.readUint32(),r=this.readUint32(),s=this.readByte();this._png.resolution={x:n,y:r,unit:s}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let n=0;n<this._numberOfFrames;n++){const r={sequenceNumber:this._frames[n].sequenceNumber,delayNumber:this._frames[n].delayNumber,delayDenominator:this._frames[n].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},s=this._frames.at(n);if(s){if(s.data=X8({data:s.data,width:s.width,height:s.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),n===0||s.xOffset===0&&s.yOffset===0&&s.width===this._png.width&&s.height===this._png.height)r.data=s.data;else{const i=this._apng.frames.at(n-1);this.disposeFrame(s,i,r),this.addFrameDataToCanvas(r,s)}this._apng.frames.push(r)}}return this._apng}disposeFrame(n,r,s){switch(n.disposeOp){case yp.NONE:break;case yp.BACKGROUND:for(let i=0;i<this._png.height;i++)for(let l=0;l<this._png.width;l++){const a=(i*n.width+l)*this._png.channels;for(let c=0;c<this._png.channels;c++)s.data[a+c]=0}break;case yp.PREVIOUS:s.data.set(r.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(n,r){const s=1<<this._png.depth,i=(l,a)=>{const c=((l+r.yOffset)*this._png.width+r.xOffset+a)*this._png.channels,d=(l*r.width+a)*this._png.channels;return{index:c,frameIndex:d}};switch(r.blendOp){case fy.SOURCE:for(let l=0;l<r.height;l++)for(let a=0;a<r.width;a++){const{index:c,frameIndex:d}=i(l,a);for(let u=0;u<this._png.channels;u++)n.data[c+u]=r.data[d+u]}break;case fy.OVER:for(let l=0;l<r.height;l++)for(let a=0;a<r.width;a++){const{index:c,frameIndex:d}=i(l,a);for(let u=0;u<this._png.channels;u++){const f=r.data[d+this._png.channels-1]/s,m=u%(this._png.channels-1)===0?1:r.data[d+u],h=Math.floor(f*m+(1-f)*n.data[c+u]);n.data[c+u]+=h}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var r;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const n=this._isAnimated?((r=this._frames)==null?void 0:r.at(0)).data:this._inflator.result;if(this._filterMethod!==J8.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===dy.NO_INTERLACE)this._png.data=X8({data:n,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===dy.ADAM7)this._png.data=Lue({data:n,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const n=this._inflator.result,r=this._frames.at(-1);r?r.data=n:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:yp.NONE,blendOp:fy.SOURCE,data:n}),this._inflator=new W8,this._writingDataChunks=!1}}function Xue(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}var Z8;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(Z8||(Z8={}));function Kue(e,t){return new Yue(e,t).decode()}var nn=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function hy(){nn.console&&typeof nn.console.log=="function"&&nn.console.log.apply(nn.console,arguments)}var Kn={log:hy,warn:function(e){nn.console&&(typeof nn.console.warn=="function"?nn.console.warn.apply(nn.console,arguments):hy.call(null,arguments))},error:function(e){nn.console&&(typeof nn.console.error=="function"?nn.console.error.apply(nn.console,arguments):hy(e))}};function my(e,t,n){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onload=function(){nc(r.response,t,n)},r.onerror=function(){Kn.error("could not download file")},r.send()}function Q8(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function vp(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var nc=nn.saveAs||((typeof window>"u"?"undefined":Wn(window))!=="object"||window!==nn?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,n){var r=nn.URL||nn.webkitURL,s=document.createElement("a");t=t||e.name||"download",s.download=t,s.rel="noopener",typeof e=="string"?(s.href=e,s.origin!==location.origin?Q8(s.href)?my(e,t,n):vp(s,s.target="_blank"):vp(s)):(s.href=r.createObjectURL(e),setTimeout(function(){r.revokeObjectURL(s.href)},4e4),setTimeout(function(){vp(s)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,n){if(t=t||e.name||"download",typeof e=="string")if(Q8(e))my(e,t,n);else{var r=document.createElement("a");r.href=e,r.target="_blank",setTimeout(function(){vp(r)})}else navigator.msSaveOrOpenBlob(function(s,i){return i===void 0?i={autoBom:!1}:Wn(i)!=="object"&&(Kn.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s}(e,n),t)}:function(e,t,n,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),typeof e=="string")return my(e,t,n);var s=e.type==="application/octet-stream",i=/constructor/i.test(nn.HTMLElement)||nn.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||s&&i)&&(typeof FileReader>"u"?"undefined":Wn(FileReader))==="object"){var a=new FileReader;a.onloadend=function(){var u=a.result;u=l?u:u.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=u:location=u,r=null},a.readAsDataURL(e)}else{var c=nn.URL||nn.webkitURL,d=c.createObjectURL(e);r?r.location=d:location.href=d,r=null,setTimeout(function(){c.revokeObjectURL(d)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function PO(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var n=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(a){return[parseInt(a[1]),parseInt(a[2]),parseInt(a[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}}],r=0;r<n.length;r++){var s=n[r].re,i=n[r].process,l=s.exec(e);l&&(t=i(l),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var a=this.r.toString(16),c=this.g.toString(16),d=this.b.toString(16);return a.length==1&&(a="0"+a),c.length==1&&(c="0"+c),d.length==1&&(d="0"+d),"#"+a+c+d}}var Gp=nn.atob.bind(nn),eA=nn.btoa.bind(nn);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function py(e,t){var n=e[0],r=e[1],s=e[2],i=e[3];n=ws(n,r,s,i,t[0],7,-680876936),i=ws(i,n,r,s,t[1],12,-389564586),s=ws(s,i,n,r,t[2],17,606105819),r=ws(r,s,i,n,t[3],22,-1044525330),n=ws(n,r,s,i,t[4],7,-176418897),i=ws(i,n,r,s,t[5],12,1200080426),s=ws(s,i,n,r,t[6],17,-1473231341),r=ws(r,s,i,n,t[7],22,-45705983),n=ws(n,r,s,i,t[8],7,1770035416),i=ws(i,n,r,s,t[9],12,-1958414417),s=ws(s,i,n,r,t[10],17,-42063),r=ws(r,s,i,n,t[11],22,-1990404162),n=ws(n,r,s,i,t[12],7,1804603682),i=ws(i,n,r,s,t[13],12,-40341101),s=ws(s,i,n,r,t[14],17,-1502002290),n=Ns(n,r=ws(r,s,i,n,t[15],22,1236535329),s,i,t[1],5,-165796510),i=Ns(i,n,r,s,t[6],9,-1069501632),s=Ns(s,i,n,r,t[11],14,643717713),r=Ns(r,s,i,n,t[0],20,-373897302),n=Ns(n,r,s,i,t[5],5,-701558691),i=Ns(i,n,r,s,t[10],9,38016083),s=Ns(s,i,n,r,t[15],14,-660478335),r=Ns(r,s,i,n,t[4],20,-405537848),n=Ns(n,r,s,i,t[9],5,568446438),i=Ns(i,n,r,s,t[14],9,-1019803690),s=Ns(s,i,n,r,t[3],14,-187363961),r=Ns(r,s,i,n,t[8],20,1163531501),n=Ns(n,r,s,i,t[13],5,-1444681467),i=Ns(i,n,r,s,t[2],9,-51403784),s=Ns(s,i,n,r,t[7],14,1735328473),n=js(n,r=Ns(r,s,i,n,t[12],20,-1926607734),s,i,t[5],4,-378558),i=js(i,n,r,s,t[8],11,-2022574463),s=js(s,i,n,r,t[11],16,1839030562),r=js(r,s,i,n,t[14],23,-35309556),n=js(n,r,s,i,t[1],4,-1530992060),i=js(i,n,r,s,t[4],11,1272893353),s=js(s,i,n,r,t[7],16,-155497632),r=js(r,s,i,n,t[10],23,-1094730640),n=js(n,r,s,i,t[13],4,681279174),i=js(i,n,r,s,t[0],11,-358537222),s=js(s,i,n,r,t[3],16,-722521979),r=js(r,s,i,n,t[6],23,76029189),n=js(n,r,s,i,t[9],4,-640364487),i=js(i,n,r,s,t[12],11,-421815835),s=js(s,i,n,r,t[15],16,530742520),n=_s(n,r=js(r,s,i,n,t[2],23,-995338651),s,i,t[0],6,-198630844),i=_s(i,n,r,s,t[7],10,1126891415),s=_s(s,i,n,r,t[14],15,-1416354905),r=_s(r,s,i,n,t[5],21,-57434055),n=_s(n,r,s,i,t[12],6,1700485571),i=_s(i,n,r,s,t[3],10,-1894986606),s=_s(s,i,n,r,t[10],15,-1051523),r=_s(r,s,i,n,t[1],21,-2054922799),n=_s(n,r,s,i,t[8],6,1873313359),i=_s(i,n,r,s,t[15],10,-30611744),s=_s(s,i,n,r,t[6],15,-1560198380),r=_s(r,s,i,n,t[13],21,1309151649),n=_s(n,r,s,i,t[4],6,-145523070),i=_s(i,n,r,s,t[11],10,-1120210379),s=_s(s,i,n,r,t[2],15,718787259),r=_s(r,s,i,n,t[9],21,-343485551),e[0]=ll(n,e[0]),e[1]=ll(r,e[1]),e[2]=ll(s,e[2]),e[3]=ll(i,e[3])}function l1(e,t,n,r,s,i){return t=ll(ll(t,e),ll(r,i)),ll(t<<s|t>>>32-s,n)}function ws(e,t,n,r,s,i,l){return l1(t&n|~t&r,e,t,s,i,l)}function Ns(e,t,n,r,s,i,l){return l1(t&r|n&~r,e,t,s,i,l)}function js(e,t,n,r,s,i,l){return l1(t^n^r,e,t,s,i,l)}function _s(e,t,n,r,s,i,l){return l1(n^(t|~r),e,t,s,i,l)}function IO(e){var t,n=e.length,r=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)py(r,Jue(e.substring(t-64,t)));e=e.substring(t-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)s[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(s[t>>2]|=128<<(t%4<<3),t>55)for(py(r,s),t=0;t<16;t++)s[t]=0;return s[14]=8*n,py(r,s),r}function Jue(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}var tA="0123456789abcdef".split("");function Zue(e){for(var t="",n=0;n<4;n++)t+=tA[e>>8*n+4&15]+tA[e>>8*n&15];return t}function Que(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function HN(e){return IO(e).map(Que).join("")}var ede=function(e){for(var t=0;t<e.length;t++)e[t]=Zue(e[t]);return e.join("")}(IO("hello"))!="5d41402abc4b2a76b9719d911017c592";function ll(e,t){if(ede){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function VN(e,t){var n,r,s,i;if(e!==n){for(var l=(s=e,i=1+(256/e.length|0),new Array(i+1).join(s)),a=[],c=0;c<256;c++)a[c]=c;var d=0;for(c=0;c<256;c++){var u=a[c];d=(d+u+l.charCodeAt(c))%256,a[c]=a[d],a[d]=u}n=e,r=a}else a=r;var f=t.length,m=0,h=0,g="";for(c=0;c<f;c++)h=(h+(u=a[m=(m+1)%256]))%256,a[m]=a[h],a[h]=u,l=a[(a[m]+a[h])%256],g+=String.fromCharCode(t.charCodeAt(c)^l);return g}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var nA={print:4,modify:8,copy:16,"annot-forms":32};function Au(e,t,n,r){this.v=1,this.r=2;var s=192;e.forEach(function(a){if(nA.perm!==void 0)throw new Error("Invalid permission: "+a);s+=nA[a]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var i=(t+this.padding).substr(0,32),l=(n+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,l),this.P=-(1+(255^s)),this.encryptionKey=HN(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=VN(this.encryptionKey,this.padding)}function ku(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",n=e.length,r=0;r<n;r++){var s=e.charCodeAt(r);t+=s<33||s===35||s===37||s===40||s===41||s===47||s===60||s===62||s===91||s===93||s===123||s===125||s>126?"#"+("0"+s.toString(16)).slice(-2):e[r]}return t}function rA(e){if(Wn(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(n,r,s){if(s=s||!1,typeof n!="string"||typeof r!="function"||typeof s!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(n)||(t[n]={});var i=Math.random().toString(35);return t[n][i]=[r,!!s],i},this.unsubscribe=function(n){for(var r in t)if(t[r][n])return delete t[r][n],Object.keys(t[r]).length===0&&delete t[r],!0;return!1},this.publish=function(n){if(t.hasOwnProperty(n)){var r=Array.prototype.slice.call(arguments,1),s=[];for(var i in t[n]){var l=t[n][i];try{l[0].apply(e,r)}catch(a){nn.console&&Kn.error("jsPDF PubSub Error",a.message,a)}l[1]&&s.push(i)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function Kg(e){if(!(this instanceof Kg))return new Kg(e);var t="opacity,stroke-opacity".split(",");for(var n in e)e.hasOwnProperty(n)&&t.indexOf(n)>=0&&(this[n]=e[n]);this.id="",this.objectNumber=-1}function TO(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function sc(e,t,n,r,s){if(!(this instanceof sc))return new sc(e,t,n,r,s);this.type=e==="axial"?2:3,this.coords=t,this.colors=n,TO.call(this,r,s)}function Lu(e,t,n,r,s){if(!(this instanceof Lu))return new Lu(e,t,n,r,s);this.boundingBox=e,this.xStep=t,this.yStep=n,this.stream="",this.cloneIndex=0,TO.call(this,r,s)}function qt(e){var t,n=typeof arguments[0]=="string"?arguments[0]:"p",r=arguments[1],s=arguments[2],i=arguments[3],l=[],a=1,c=16,d="S",u=null;Wn(e=e||{})==="object"&&(n=e.orientation,r=e.unit||r,s=e.format||s,i=e.compress||e.compressPdf||i,(u=e.encryption||null)!==null&&(u.userPassword=u.userPassword||"",u.ownerPassword=u.ownerPassword||"",u.userPermissions=u.userPermissions||[]),a=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(c=e.floatPrecision),d=e.defaultPathOperation||"S"),l=e.filters||(i===!0?["FlateEncode"]:l),r=r||"mm",n=(""+(n||"P")).toLowerCase();var f=e.putOnlyUsedFonts||!1,m={},h={internal:{},__private__:{}};h.__private__.PubSub=rA;var g="1.3",y=h.__private__.getPdfVersion=function(){return g};h.__private__.setPdfVersion=function(C){g=C};var p={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};h.__private__.getPageFormats=function(){return p};var x=h.__private__.getPageFormat=function(C){return p[C]};s=s||"a4";var b="compat",w="advanced",N=b;function k(){this.saveGraphicsState(),ee(new It(fe,0,0,-fe,0,Ol()*fe).toString()+" cm"),this.setFontSize(this.getFontSize()/fe),d="n",N=w}function I(){this.restoreGraphicsState(),d="S",N=b}var R=h.__private__.combineFontStyleAndFontWeight=function(C,X){if(C=="bold"&&X=="normal"||C=="bold"&&X==400||C=="normal"&&X=="italic"||C=="bold"&&X=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return X&&(C=X==400||X==="normal"?C==="italic"?"italic":"normal":X!=700&&X!=="bold"||C!=="normal"?(X==700?"bold":X)+""+C:"bold"),C};h.advancedAPI=function(C){var X=N===b;return X&&k.call(this),typeof C!="function"||(C(this),X&&I.call(this)),this},h.compatAPI=function(C){var X=N===w;return X&&I.call(this),typeof C!="function"||(C(this),X&&k.call(this)),this},h.isAdvancedAPI=function(){return N===w};var T,S=function(C){if(N!==w)throw new Error(C+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},E=h.roundToPrecision=h.__private__.roundToPrecision=function(C,X){var de=t||X;if(isNaN(C)||isNaN(de))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return C.toFixed(de).replace(/0+$/,"")};T=h.hpf=h.__private__.hpf=typeof c=="number"?function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.hpf");return E(C,c)}:c==="smart"?function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.hpf");return E(C,C>-1&&C<1?16:5)}:function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.hpf");return E(C,16)};var _=h.f2=h.__private__.f2=function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.f2");return E(C,2)},M=h.__private__.f3=function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.f3");return E(C,3)},A=h.scale=h.__private__.scale=function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.scale");return N===b?C*fe:N===w?C:void 0},P=function(C){return A(function(X){return N===b?Ol()-X:N===w?X:void 0}(C))};h.__private__.setPrecision=h.setPrecision=function(C){typeof parseInt(C,10)=="number"&&(t=parseInt(C,10))};var B,L="00000000000000000000000000000000",D=h.__private__.getFileId=function(){return L},V=h.__private__.setFileId=function(C){return L=C!==void 0&&/^[a-fA-F0-9]{32}$/.test(C)?C.toUpperCase():L.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),u!==null&&(ir=new Au(u.userPermissions,u.userPassword,u.ownerPassword,L)),L};h.setFileId=function(C){return V(C),this},h.getFileId=function(){return D()};var O=h.__private__.convertDateToPDFDate=function(C){var X=C.getTimezoneOffset(),de=X<0?"+":"-",xe=Math.floor(Math.abs(X/60)),Ie=Math.abs(X%60),Je=[de,q(xe),"'",q(Ie),"'"].join("");return["D:",C.getFullYear(),q(C.getMonth()+1),q(C.getDate()),q(C.getHours()),q(C.getMinutes()),q(C.getSeconds()),Je].join("")},H=h.__private__.convertPDFDateToDate=function(C){var X=parseInt(C.substr(2,4),10),de=parseInt(C.substr(6,2),10)-1,xe=parseInt(C.substr(8,2),10),Ie=parseInt(C.substr(10,2),10),Je=parseInt(C.substr(12,2),10),ct=parseInt(C.substr(14,2),10);return new Date(X,de,xe,Ie,Je,ct,0)},W=h.__private__.setCreationDate=function(C){var X;if(C===void 0&&(C=new Date),C instanceof Date)X=O(C);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(C))throw new Error("Invalid argument passed to jsPDF.setCreationDate");X=C}return B=X},$=h.__private__.getCreationDate=function(C){var X=B;return C==="jsDate"&&(X=H(B)),X};h.setCreationDate=function(C){return W(C),this},h.getCreationDate=function(C){return $(C)};var z,q=h.__private__.padd2=function(C){return("0"+parseInt(C)).slice(-2)},G=h.__private__.padd2Hex=function(C){return("00"+(C=C.toString())).substr(C.length)},re=0,oe=[],ie=[],Y=0,te=[],we=[],me=!1,Ee=ie;h.__private__.setCustomOutputDestination=function(C){me=!0,Ee=C};var pe=function(C){me||(Ee=C)};h.__private__.resetCustomOutputDestination=function(){me=!1,Ee=ie};var ee=h.__private__.out=function(C){return C=C.toString(),Y+=C.length+1,Ee.push(C),Ee},ft=h.__private__.write=function(C){return ee(arguments.length===1?C.toString():Array.prototype.join.call(arguments," "))},$e=h.__private__.getArrayBuffer=function(C){for(var X=C.length,de=new ArrayBuffer(X),xe=new Uint8Array(de);X--;)xe[X]=C.charCodeAt(X);return de},De=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];h.__private__.getStandardFonts=function(){return De};var ge=e.fontSize||16;h.__private__.setFontSize=h.setFontSize=function(C){return ge=N===w?C/fe:C,this};var Me,_e=h.__private__.getFontSize=h.getFontSize=function(){return N===b?ge:ge*fe},ke=e.R2L||!1;h.__private__.setR2L=h.setR2L=function(C){return ke=C,this},h.__private__.getR2L=h.getR2L=function(){return ke};var se,Ae=h.__private__.setZoomMode=function(C){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(C))Me=C;else if(isNaN(C)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(C)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+C+'" is not recognized.');Me=C}else Me=parseInt(C,10)};h.__private__.getZoomMode=function(){return Me};var Re,Ce=h.__private__.setPageMode=function(C){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(C)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+C+'" is not recognized.');se=C};h.__private__.getPageMode=function(){return se};var ve=h.__private__.setLayoutMode=function(C){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(C)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+C+'" is not recognized.');Re=C};h.__private__.getLayoutMode=function(){return Re},h.__private__.setDisplayMode=h.setDisplayMode=function(C,X,de){return Ae(C),ve(X),Ce(de),this};var Be={title:"",subject:"",author:"",keywords:"",creator:""};h.__private__.getDocumentProperty=function(C){if(Object.keys(Be).indexOf(C)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return Be[C]},h.__private__.getDocumentProperties=function(){return Be},h.__private__.setDocumentProperties=h.setProperties=h.setDocumentProperties=function(C){for(var X in Be)Be.hasOwnProperty(X)&&C[X]&&(Be[X]=C[X]);return this},h.__private__.setDocumentProperty=function(C,X){if(Object.keys(Be).indexOf(C)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return Be[C]=X};var le,fe,Te,at,je,he={},Pe={},ot=[],tt={},qe={},ze={},it={},st=null,Ve=0,ut=[],mt=new rA(h),Ht=e.hotfixes||[],Kt={},jn={},wn=[],It=function C(X,de,xe,Ie,Je,ct){if(!(this instanceof C))return new C(X,de,xe,Ie,Je,ct);isNaN(X)&&(X=1),isNaN(de)&&(de=0),isNaN(xe)&&(xe=0),isNaN(Ie)&&(Ie=1),isNaN(Je)&&(Je=0),isNaN(ct)&&(ct=0),this._matrix=[X,de,xe,Ie,Je,ct]};Object.defineProperty(It.prototype,"sx",{get:function(){return this._matrix[0]},set:function(C){this._matrix[0]=C}}),Object.defineProperty(It.prototype,"shy",{get:function(){return this._matrix[1]},set:function(C){this._matrix[1]=C}}),Object.defineProperty(It.prototype,"shx",{get:function(){return this._matrix[2]},set:function(C){this._matrix[2]=C}}),Object.defineProperty(It.prototype,"sy",{get:function(){return this._matrix[3]},set:function(C){this._matrix[3]=C}}),Object.defineProperty(It.prototype,"tx",{get:function(){return this._matrix[4]},set:function(C){this._matrix[4]=C}}),Object.defineProperty(It.prototype,"ty",{get:function(){return this._matrix[5]},set:function(C){this._matrix[5]=C}}),Object.defineProperty(It.prototype,"a",{get:function(){return this._matrix[0]},set:function(C){this._matrix[0]=C}}),Object.defineProperty(It.prototype,"b",{get:function(){return this._matrix[1]},set:function(C){this._matrix[1]=C}}),Object.defineProperty(It.prototype,"c",{get:function(){return this._matrix[2]},set:function(C){this._matrix[2]=C}}),Object.defineProperty(It.prototype,"d",{get:function(){return this._matrix[3]},set:function(C){this._matrix[3]=C}}),Object.defineProperty(It.prototype,"e",{get:function(){return this._matrix[4]},set:function(C){this._matrix[4]=C}}),Object.defineProperty(It.prototype,"f",{get:function(){return this._matrix[5]},set:function(C){this._matrix[5]=C}}),Object.defineProperty(It.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(It.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(It.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(It.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),It.prototype.join=function(C){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(T).join(C)},It.prototype.multiply=function(C){var X=C.sx*this.sx+C.shy*this.shx,de=C.sx*this.shy+C.shy*this.sy,xe=C.shx*this.sx+C.sy*this.shx,Ie=C.shx*this.shy+C.sy*this.sy,Je=C.tx*this.sx+C.ty*this.shx+this.tx,ct=C.tx*this.shy+C.ty*this.sy+this.ty;return new It(X,de,xe,Ie,Je,ct)},It.prototype.decompose=function(){var C=this.sx,X=this.shy,de=this.shx,xe=this.sy,Ie=this.tx,Je=this.ty,ct=Math.sqrt(C*C+X*X),Pt=(C/=ct)*de+(X/=ct)*xe;de-=C*Pt,xe-=X*Pt;var Ot=Math.sqrt(de*de+xe*xe);return Pt/=Ot,C*(xe/=Ot)<X*(de/=Ot)&&(C=-C,X=-X,Pt=-Pt,ct=-ct),{scale:new It(ct,0,0,Ot,0,0),translate:new It(1,0,0,1,Ie,Je),rotate:new It(C,X,-X,C,0,0),skew:new It(1,0,Pt,1,0,0)}},It.prototype.toString=function(C){return this.join(" ")},It.prototype.inversed=function(){var C=this.sx,X=this.shy,de=this.shx,xe=this.sy,Ie=this.tx,Je=this.ty,ct=1/(C*xe-X*de),Pt=xe*ct,Ot=-X*ct,sn=-de*ct,cn=C*ct;return new It(Pt,Ot,sn,cn,-Pt*Ie-sn*Je,-Ot*Ie-cn*Je)},It.prototype.applyToPoint=function(C){var X=C.x*this.sx+C.y*this.shx+this.tx,de=C.x*this.shy+C.y*this.sy+this.ty;return new Rl(X,de)},It.prototype.applyToRectangle=function(C){var X=this.applyToPoint(C),de=this.applyToPoint(new Rl(C.x+C.w,C.y+C.h));return new Fd(X.x,X.y,de.x-X.x,de.y-X.y)},It.prototype.clone=function(){var C=this.sx,X=this.shy,de=this.shx,xe=this.sy,Ie=this.tx,Je=this.ty;return new It(C,X,de,xe,Ie,Je)},h.Matrix=It;var Rr=h.matrixMult=function(C,X){return X.multiply(C)},Vr=new It(1,0,0,1,0,0);h.unitMatrix=h.identityMatrix=Vr;var Sr=function(C,X){if(!qe[C]){var de=(X instanceof sc?"Sh":"P")+(Object.keys(tt).length+1).toString(10);X.id=de,qe[C]=de,tt[de]=X,mt.publish("addPattern",X)}};h.ShadingPattern=sc,h.TilingPattern=Lu,h.addShadingPattern=function(C,X){return S("addShadingPattern()"),Sr(C,X),this},h.beginTilingPattern=function(C){S("beginTilingPattern()"),Dd(C.boundingBox[0],C.boundingBox[1],C.boundingBox[2]-C.boundingBox[0],C.boundingBox[3]-C.boundingBox[1],C.matrix)},h.endTilingPattern=function(C,X){S("endTilingPattern()"),X.stream=we[z].join(`
`),Sr(C,X),mt.publish("endTilingPattern",X),wn.pop().restore()};var We,Ue=h.__private__.newObject=function(){var C=pt();return wt(C,!0),C},pt=h.__private__.newObjectDeferred=function(){return re++,oe[re]=function(){return Y},re},wt=function(C,X){return X=typeof X=="boolean"&&X,oe[C]=Y,X&&ee(C+" 0 obj"),C},Vt=h.__private__.newAdditionalObject=function(){var C={objId:pt(),content:""};return te.push(C),C},St=pt(),bt=pt(),jt=h.__private__.decodeColorString=function(C){var X=C.split(" ");if(X.length!==2||X[1]!=="g"&&X[1]!=="G")X.length!==5||X[4]!=="k"&&X[4]!=="K"||(X=[(1-X[0])*(1-X[3]),(1-X[1])*(1-X[3]),(1-X[2])*(1-X[3]),"r"]);else{var de=parseFloat(X[0]);X=[de,de,de,"r"]}for(var xe="#",Ie=0;Ie<3;Ie++)xe+=("0"+Math.floor(255*parseFloat(X[Ie])).toString(16)).slice(-2);return xe},an=h.__private__.encodeColorString=function(C){var X;typeof C=="string"&&(C={ch1:C});var de=C.ch1,xe=C.ch2,Ie=C.ch3,Je=C.ch4,ct=C.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof de=="string"&&de.charAt(0)!=="#"){var Pt=new PO(de);if(Pt.ok)de=Pt.toHex();else if(!/^\d*\.?\d*$/.test(de))throw new Error('Invalid color "'+de+'" passed to jsPDF.encodeColorString.')}if(typeof de=="string"&&/^#[0-9A-Fa-f]{3}$/.test(de)&&(de="#"+de[1]+de[1]+de[2]+de[2]+de[3]+de[3]),typeof de=="string"&&/^#[0-9A-Fa-f]{6}$/.test(de)){var Ot=parseInt(de.substr(1),16);de=Ot>>16&255,xe=Ot>>8&255,Ie=255&Ot}if(xe===void 0||Je===void 0&&de===xe&&xe===Ie)X=typeof de=="string"?de+" "+ct[0]:C.precision===2?_(de/255)+" "+ct[0]:M(de/255)+" "+ct[0];else if(Je===void 0||Wn(Je)==="object"){if(Je&&!isNaN(Je.a)&&Je.a===0)return["1.","1.","1.",ct[1]].join(" ");X=typeof de=="string"?[de,xe,Ie,ct[1]].join(" "):C.precision===2?[_(de/255),_(xe/255),_(Ie/255),ct[1]].join(" "):[M(de/255),M(xe/255),M(Ie/255),ct[1]].join(" ")}else X=typeof de=="string"?[de,xe,Ie,Je,ct[2]].join(" "):C.precision===2?[_(de),_(xe),_(Ie),_(Je),ct[2]].join(" "):[M(de),M(xe),M(Ie),M(Je),ct[2]].join(" ");return X},Mn=h.__private__.getFilters=function(){return l},Xe=h.__private__.putStream=function(C){var X=(C=C||{}).data||"",de=C.filters||Mn(),xe=C.alreadyAppliedFilters||[],Ie=C.addLength1||!1,Je=X.length,ct=C.objectId,Pt=function(Wr){return Wr};if(u!==null&&ct===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");u!==null&&(Pt=ir.encryptor(ct,0));var Ot={};de===!0&&(de=["FlateEncode"]);var sn=C.additionalKeyValues||[],cn=(Ot=qt.API.processDataByFilters!==void 0?qt.API.processDataByFilters(X,de):{data:X,reverseChain:[]}).reverseChain+(Array.isArray(xe)?xe.join(" "):xe.toString());if(Ot.data.length!==0&&(sn.push({key:"Length",value:Ot.data.length}),Ie===!0&&sn.push({key:"Length1",value:Je})),cn.length!=0)if(cn.split("/").length-1==1)sn.push({key:"Filter",value:cn});else{sn.push({key:"Filter",value:"["+cn+"]"});for(var Rn=0;Rn<sn.length;Rn+=1)if(sn[Rn].key==="DecodeParms"){for(var ur=[],Or=0;Or<Ot.reverseChain.split("/").length-1;Or+=1)ur.push("null");ur.push(sn[Rn].value),sn[Rn].value="["+ur.join(" ")+"]"}}ee("<<");for(var Qn=0;Qn<sn.length;Qn++)ee("/"+sn[Qn].key+" "+sn[Qn].value);ee(">>"),Ot.data.length!==0&&(ee("stream"),ee(Pt(Ot.data)),ee("endstream"))},Zt=h.__private__.putPage=function(C){var X=C.number,de=C.data,xe=C.objId,Ie=C.contentsObjId;wt(xe,!0),ee("<</Type /Page"),ee("/Parent "+C.rootDictionaryObjId+" 0 R"),ee("/Resources "+C.resourceDictionaryObjId+" 0 R"),ee("/MediaBox ["+parseFloat(T(C.mediaBox.bottomLeftX))+" "+parseFloat(T(C.mediaBox.bottomLeftY))+" "+T(C.mediaBox.topRightX)+" "+T(C.mediaBox.topRightY)+"]"),C.cropBox!==null&&ee("/CropBox ["+T(C.cropBox.bottomLeftX)+" "+T(C.cropBox.bottomLeftY)+" "+T(C.cropBox.topRightX)+" "+T(C.cropBox.topRightY)+"]"),C.bleedBox!==null&&ee("/BleedBox ["+T(C.bleedBox.bottomLeftX)+" "+T(C.bleedBox.bottomLeftY)+" "+T(C.bleedBox.topRightX)+" "+T(C.bleedBox.topRightY)+"]"),C.trimBox!==null&&ee("/TrimBox ["+T(C.trimBox.bottomLeftX)+" "+T(C.trimBox.bottomLeftY)+" "+T(C.trimBox.topRightX)+" "+T(C.trimBox.topRightY)+"]"),C.artBox!==null&&ee("/ArtBox ["+T(C.artBox.bottomLeftX)+" "+T(C.artBox.bottomLeftY)+" "+T(C.artBox.topRightX)+" "+T(C.artBox.topRightY)+"]"),typeof C.userUnit=="number"&&C.userUnit!==1&&ee("/UserUnit "+C.userUnit),mt.publish("putPage",{objId:xe,pageContext:ut[X],pageNumber:X,page:de}),ee("/Contents "+Ie+" 0 R"),ee(">>"),ee("endobj");var Je=de.join(`
`);return N===w&&(Je+=`
Q`),wt(Ie,!0),Xe({data:Je,filters:Mn(),objectId:Ie}),ee("endobj"),xe},yt=h.__private__.putPages=function(){var C,X,de=[];for(C=1;C<=Ve;C++)ut[C].objId=pt(),ut[C].contentsObjId=pt();for(C=1;C<=Ve;C++)de.push(Zt({number:C,data:we[C],objId:ut[C].objId,contentsObjId:ut[C].contentsObjId,mediaBox:ut[C].mediaBox,cropBox:ut[C].cropBox,bleedBox:ut[C].bleedBox,trimBox:ut[C].trimBox,artBox:ut[C].artBox,userUnit:ut[C].userUnit,rootDictionaryObjId:St,resourceDictionaryObjId:bt}));wt(St,!0),ee("<</Type /Pages");var xe="/Kids [";for(X=0;X<Ve;X++)xe+=de[X]+" 0 R ";ee(xe+"]"),ee("/Count "+Ve),ee(">>"),ee("endobj"),mt.publish("postPutPages")},on=function(C){mt.publish("putFont",{font:C,out:ee,newObject:Ue,putStream:Xe}),C.isAlreadyPutted!==!0&&(C.objectNumber=Ue(),ee("<<"),ee("/Type /Font"),ee("/BaseFont /"+ku(C.postScriptName)),ee("/Subtype /Type1"),typeof C.encoding=="string"&&ee("/Encoding /"+C.encoding),ee("/FirstChar 32"),ee("/LastChar 255"),ee(">>"),ee("endobj"))},rn=function(C){C.objectNumber=Ue();var X=[];X.push({key:"Type",value:"/XObject"}),X.push({key:"Subtype",value:"/Form"}),X.push({key:"BBox",value:"["+[T(C.x),T(C.y),T(C.x+C.width),T(C.y+C.height)].join(" ")+"]"}),X.push({key:"Matrix",value:"["+C.matrix.toString()+"]"});var de=C.pages[1].join(`
`);Xe({data:de,additionalKeyValues:X,objectId:C.objectNumber}),ee("endobj")},Qt=function(C,X){X||(X=21);var de=Ue(),xe=function(ct,Pt){var Ot,sn=[],cn=1/(Pt-1);for(Ot=0;Ot<1;Ot+=cn)sn.push(Ot);if(sn.push(1),ct[0].offset!=0){var Rn={offset:0,color:ct[0].color};ct.unshift(Rn)}if(ct[ct.length-1].offset!=1){var ur={offset:1,color:ct[ct.length-1].color};ct.push(ur)}for(var Or="",Qn=0,Wr=0;Wr<sn.length;Wr++){for(Ot=sn[Wr];Ot>ct[Qn+1].offset;)Qn++;var Fr=ct[Qn].offset,ls=(Ot-Fr)/(ct[Qn+1].offset-Fr),Si=ct[Qn].color,Vs=ct[Qn+1].color;Or+=G(Math.round((1-ls)*Si[0]+ls*Vs[0]).toString(16))+G(Math.round((1-ls)*Si[1]+ls*Vs[1]).toString(16))+G(Math.round((1-ls)*Si[2]+ls*Vs[2]).toString(16))}return Or.trim()}(C.colors,X),Ie=[];Ie.push({key:"FunctionType",value:"0"}),Ie.push({key:"Domain",value:"[0.0 1.0]"}),Ie.push({key:"Size",value:"["+X+"]"}),Ie.push({key:"BitsPerSample",value:"8"}),Ie.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ie.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Xe({data:xe,additionalKeyValues:Ie,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:de}),ee("endobj"),C.objectNumber=Ue(),ee("<< /ShadingType "+C.type),ee("/ColorSpace /DeviceRGB");var Je="/Coords ["+T(parseFloat(C.coords[0]))+" "+T(parseFloat(C.coords[1]))+" ";C.type===2?Je+=T(parseFloat(C.coords[2]))+" "+T(parseFloat(C.coords[3])):Je+=T(parseFloat(C.coords[2]))+" "+T(parseFloat(C.coords[3]))+" "+T(parseFloat(C.coords[4]))+" "+T(parseFloat(C.coords[5])),ee(Je+="]"),C.matrix&&ee("/Matrix ["+C.matrix.toString()+"]"),ee("/Function "+de+" 0 R"),ee("/Extend [true true]"),ee(">>"),ee("endobj")},vt=function(C,X){var de=pt(),xe=Ue();X.push({resourcesOid:de,objectOid:xe}),C.objectNumber=xe;var Ie=[];Ie.push({key:"Type",value:"/Pattern"}),Ie.push({key:"PatternType",value:"1"}),Ie.push({key:"PaintType",value:"1"}),Ie.push({key:"TilingType",value:"1"}),Ie.push({key:"BBox",value:"["+C.boundingBox.map(T).join(" ")+"]"}),Ie.push({key:"XStep",value:T(C.xStep)}),Ie.push({key:"YStep",value:T(C.yStep)}),Ie.push({key:"Resources",value:de+" 0 R"}),C.matrix&&Ie.push({key:"Matrix",value:"["+C.matrix.toString()+"]"}),Xe({data:C.stream,additionalKeyValues:Ie,objectId:C.objectNumber}),ee("endobj")},$t=function(C){for(var X in C.objectNumber=Ue(),ee("<<"),C)switch(X){case"opacity":ee("/ca "+_(C[X]));break;case"stroke-opacity":ee("/CA "+_(C[X]))}ee(">>"),ee("endobj")},Yt=function(C){wt(C.resourcesOid,!0),ee("<<"),ee("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var X in ee("/Font <<"),he)he.hasOwnProperty(X)&&(f===!1||f===!0&&m.hasOwnProperty(X))&&ee("/"+X+" "+he[X].objectNumber+" 0 R");ee(">>")}(),function(){if(Object.keys(tt).length>0){for(var X in ee("/Shading <<"),tt)tt.hasOwnProperty(X)&&tt[X]instanceof sc&&tt[X].objectNumber>=0&&ee("/"+X+" "+tt[X].objectNumber+" 0 R");mt.publish("putShadingPatternDict"),ee(">>")}}(),function(X){if(Object.keys(tt).length>0){for(var de in ee("/Pattern <<"),tt)tt.hasOwnProperty(de)&&tt[de]instanceof h.TilingPattern&&tt[de].objectNumber>=0&&tt[de].objectNumber<X&&ee("/"+de+" "+tt[de].objectNumber+" 0 R");mt.publish("putTilingPatternDict"),ee(">>")}}(C.objectOid),function(){if(Object.keys(ze).length>0){var X;for(X in ee("/ExtGState <<"),ze)ze.hasOwnProperty(X)&&ze[X].objectNumber>=0&&ee("/"+X+" "+ze[X].objectNumber+" 0 R");mt.publish("putGStateDict"),ee(">>")}}(),function(){for(var X in ee("/XObject <<"),Kt)Kt.hasOwnProperty(X)&&Kt[X].objectNumber>=0&&ee("/"+X+" "+Kt[X].objectNumber+" 0 R");mt.publish("putXobjectDict"),ee(">>")}(),ee(">>"),ee("endobj")},zt=function(C){Pe[C.fontName]=Pe[C.fontName]||{},Pe[C.fontName][C.fontStyle]=C.id},Pn=function(C,X,de,xe,Ie){var Je={id:"F"+(Object.keys(he).length+1).toString(10),postScriptName:C,fontName:X,fontStyle:de,encoding:xe,isStandardFont:Ie||!1,metadata:{}};return mt.publish("addFont",{font:Je,instance:this}),he[Je.id]=Je,zt(Je),Je.id},ln=h.__private__.pdfEscape=h.pdfEscape=function(C,X){return function(de,xe){var Ie,Je,ct,Pt,Ot,sn,cn,Rn,ur;if(ct=(xe=xe||{}).sourceEncoding||"Unicode",Ot=xe.outputEncoding,(xe.autoencode||Ot)&&he[le].metadata&&he[le].metadata[ct]&&he[le].metadata[ct].encoding&&(Pt=he[le].metadata[ct].encoding,!Ot&&he[le].encoding&&(Ot=he[le].encoding),!Ot&&Pt.codePages&&(Ot=Pt.codePages[0]),typeof Ot=="string"&&(Ot=Pt[Ot]),Ot)){for(cn=!1,sn=[],Ie=0,Je=de.length;Ie<Je;Ie++)(Rn=Ot[de.charCodeAt(Ie)])?sn.push(String.fromCharCode(Rn)):sn.push(de[Ie]),sn[Ie].charCodeAt(0)>>8&&(cn=!0);de=sn.join("")}for(Ie=de.length;cn===void 0&&Ie!==0;)de.charCodeAt(Ie-1)>>8&&(cn=!0),Ie--;if(!cn)return de;for(sn=xe.noBOM?[]:[254,255],Ie=0,Je=de.length;Ie<Je;Ie++){if((ur=(Rn=de.charCodeAt(Ie))>>8)>>8)throw new Error("Character at position "+Ie+" of string '"+de+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");sn.push(ur),sn.push(Rn-(ur<<8))}return String.fromCharCode.apply(void 0,sn)}(C,X).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Fn=h.__private__.beginPage=function(C){we[++Ve]=[],ut[Ve]={objId:0,contentsObjId:0,userUnit:Number(a),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(C[0]),topRightY:Number(C[1])}},Ni(Ve),pe(we[z])},En=function(C,X){var de,xe,Ie;switch(n=X||n,typeof C=="string"&&(de=x(C.toLowerCase()),Array.isArray(de)&&(xe=de[0],Ie=de[1])),Array.isArray(C)&&(xe=C[0]*fe,Ie=C[1]*fe),isNaN(xe)&&(xe=s[0],Ie=s[1]),(xe>14400||Ie>14400)&&(Kn.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),xe=Math.min(14400,xe),Ie=Math.min(14400,Ie)),s=[xe,Ie],n.substr(0,1)){case"l":Ie>xe&&(s=[Ie,xe]);break;case"p":xe>Ie&&(s=[Ie,xe])}Fn(s),Qc(nt),ee(tu),$d!==0&&ee($d+" J"),Od!==0&&ee(Od+" j"),mt.publish("addPage",{pageNumber:Ve})},Bn=function(C){C>0&&C<=Ve&&(we.splice(C,1),ut.splice(C,1),Ve--,z>Ve&&(z=Ve),this.setPage(z))},Ni=function(C){C>0&&C<=Ve&&(z=C)},ji=h.__private__.getNumberOfPages=h.getNumberOfPages=function(){return we.length-1},$r=function(C,X,de){var xe,Ie=void 0;return de=de||{},C=C!==void 0?C:he[le].fontName,X=X!==void 0?X:he[le].fontStyle,xe=C.toLowerCase(),Pe[xe]!==void 0&&Pe[xe][X]!==void 0?Ie=Pe[xe][X]:Pe[C]!==void 0&&Pe[C][X]!==void 0?Ie=Pe[C][X]:de.disableWarning===!1&&Kn.warn("Unable to look up font label for font '"+C+"', '"+X+"'. Refer to getFontList() for available fonts."),Ie||de.noFallback||(Ie=Pe.times[X])==null&&(Ie=Pe.times.normal),Ie},Va=h.__private__.putInfo=function(){var C=Ue(),X=function(xe){return xe};for(var de in u!==null&&(X=ir.encryptor(C,0)),ee("<<"),ee("/Producer ("+ln(X("jsPDF "+qt.version))+")"),Be)Be.hasOwnProperty(de)&&Be[de]&&ee("/"+de.substr(0,1).toUpperCase()+de.substr(1)+" ("+ln(X(Be[de]))+")");ee("/CreationDate ("+ln(X(B))+")"),ee(">>"),ee("endobj")},Vc=h.__private__.putCatalog=function(C){var X=(C=C||{}).rootDictionaryObjId||St;switch(Ue(),ee("<<"),ee("/Type /Catalog"),ee("/Pages "+X+" 0 R"),Me||(Me="fullwidth"),Me){case"fullwidth":ee("/OpenAction [3 0 R /FitH null]");break;case"fullheight":ee("/OpenAction [3 0 R /FitV null]");break;case"fullpage":ee("/OpenAction [3 0 R /Fit]");break;case"original":ee("/OpenAction [3 0 R /XYZ null null 1]");break;default:var de=""+Me;de.substr(de.length-1)==="%"&&(Me=parseInt(Me)/100),typeof Me=="number"&&ee("/OpenAction [3 0 R /XYZ null null "+_(Me)+"]")}switch(Re||(Re="continuous"),Re){case"continuous":ee("/PageLayout /OneColumn");break;case"single":ee("/PageLayout /SinglePage");break;case"two":case"twoleft":ee("/PageLayout /TwoColumnLeft");break;case"tworight":ee("/PageLayout /TwoColumnRight")}se&&ee("/PageMode /"+se),mt.publish("putCatalog"),ee(">>"),ee("endobj")},cr=h.__private__.putTrailer=function(){ee("trailer"),ee("<<"),ee("/Size "+(re+1)),ee("/Root "+re+" 0 R"),ee("/Info "+(re-1)+" 0 R"),u!==null&&ee("/Encrypt "+ir.oid+" 0 R"),ee("/ID [ <"+L+"> <"+L+"> ]"),ee(">>")},Cl=h.__private__.putHeader=function(){ee("%PDF-"+g),ee("%")},Pl=h.__private__.putXRef=function(){var C="0000000000";ee("xref"),ee("0 "+(re+1)),ee("0000000000 65535 f ");for(var X=1;X<=re;X++)typeof oe[X]=="function"?ee((C+oe[X]()).slice(-10)+" 00000 n "):oe[X]!==void 0?ee((C+oe[X]).slice(-10)+" 00000 n "):ee("0000000000 00000 n ")},_i=h.__private__.buildDocument=function(){var C;re=0,Y=0,ie=[],oe=[],te=[],St=pt(),bt=pt(),pe(ie),mt.publish("buildDocument"),Cl(),yt(),function(){mt.publish("putAdditionalObjects");for(var de=0;de<te.length;de++){var xe=te[de];wt(xe.objId,!0),ee(xe.content),ee("endobj")}mt.publish("postPutAdditionalObjects")}(),C=[],function(){for(var de in he)he.hasOwnProperty(de)&&(f===!1||f===!0&&m.hasOwnProperty(de))&&on(he[de])}(),function(){var de;for(de in ze)ze.hasOwnProperty(de)&&$t(ze[de])}(),function(){for(var de in Kt)Kt.hasOwnProperty(de)&&rn(Kt[de])}(),function(de){var xe;for(xe in tt)tt.hasOwnProperty(xe)&&(tt[xe]instanceof sc?Qt(tt[xe]):tt[xe]instanceof Lu&&vt(tt[xe],de))}(C),mt.publish("putResources"),C.forEach(Yt),Yt({resourcesOid:bt,objectOid:Number.MAX_SAFE_INTEGER}),mt.publish("postPutResources"),u!==null&&(ir.oid=Ue(),ee("<<"),ee("/Filter /Standard"),ee("/V "+ir.v),ee("/R "+ir.r),ee("/U <"+ir.toHexString(ir.U)+">"),ee("/O <"+ir.toHexString(ir.O)+">"),ee("/P "+ir.P),ee(">>"),ee("endobj")),Va(),Vc();var X=Y;return Pl(),cr(),ee("startxref"),ee(""+X),ee("%%EOF"),pe(we[z]),ie.join(`
`)},ma=h.__private__.getBlob=function(C){return new Blob([$e(C)],{type:"application/pdf"})},Hs=h.output=h.__private__.output=(We=function(C,X){switch(typeof(X=X||{})=="string"?X={filename:X}:X.filename=X.filename||"generated.pdf",C){case void 0:return _i();case"save":h.save(X.filename);break;case"arraybuffer":return $e(_i());case"blob":return ma(_i());case"bloburi":case"bloburl":if(nn.URL!==void 0&&typeof nn.URL.createObjectURL=="function")return nn.URL&&nn.URL.createObjectURL(ma(_i()))||void 0;Kn.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var de="",xe=_i();try{de=eA(xe)}catch{de=eA(unescape(encodeURIComponent(xe)))}return"data:application/pdf;filename="+X.filename+";base64,"+de;case"pdfobjectnewwindow":if(Object.prototype.toString.call(nn)==="[object Window]"){var Ie="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Je=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';X.pdfObjectUrl&&(Ie=X.pdfObjectUrl,Je="");var ct='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Ie+'"'+Je+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(X)+");<\/script></body></html>",Pt=nn.open();return Pt!==null&&Pt.document.write(ct),Pt}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(nn)==="[object Window]"){var Ot='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(X.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+X.filename+'" width="500px" height="400px" /></body></html>',sn=nn.open();if(sn!==null){sn.document.write(Ot);var cn=this;sn.document.documentElement.querySelector("#pdfViewer").onload=function(){sn.document.title=X.filename,sn.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(cn.output("bloburl"))}}return sn}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(nn)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Rn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",X)+'"></iframe></body></html>',ur=nn.open();if(ur!==null&&(ur.document.write(Rn),ur.document.title=X.filename),ur||typeof safari>"u")return ur;break;case"datauri":case"dataurl":return nn.document.location.href=this.output("datauristring",X);default:return null}},We.foo=function(){try{return We.apply(this,arguments)}catch(de){var C=de.stack||"";~C.indexOf(" at ")&&(C=C.split(" at ")[1]);var X="Error in function "+C.split(`
`)[0].split("<")[0]+": "+de.message;if(!nn.console)throw new Error(X);nn.console.error(X,de),nn.alert&&alert(X)}},We.foo.bar=We,We.foo),pa=function(C){return Array.isArray(Ht)===!0&&Ht.indexOf(C)>-1};switch(r){case"pt":fe=1;break;case"mm":fe=72/25.4;break;case"cm":fe=72/2.54;break;case"in":fe=72;break;case"px":fe=pa("px_scaling")==1?.75:96/72;break;case"pc":case"em":fe=12;break;case"ex":fe=6;break;default:if(typeof r!="number")throw new Error("Invalid unit: "+r);fe=r}var ir=null;W(),V();var Io=h.__private__.getPageInfo=h.getPageInfo=function(C){if(isNaN(C)||C%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:ut[C].objId,pageNumber:C,pageContext:ut[C]}},Wc=h.__private__.getPageInfoByObjId=function(C){if(isNaN(C)||C%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var X in ut)if(ut[X].objId===C)break;return Io(X)},Gc=h.__private__.getCurrentPageInfo=h.getCurrentPageInfo=function(){return{objId:ut[z].objId,pageNumber:z,pageContext:ut[z]}};h.addPage=function(){return En.apply(this,arguments),this},h.setPage=function(){return Ni.apply(this,arguments),pe.call(this,we[z]),this},h.insertPage=function(C){return this.addPage(),this.movePage(z,C),this},h.movePage=function(C,X){var de,xe;if(C>X){de=we[C],xe=ut[C];for(var Ie=C;Ie>X;Ie--)we[Ie]=we[Ie-1],ut[Ie]=ut[Ie-1];we[X]=de,ut[X]=xe,this.setPage(X)}else if(C<X){de=we[C],xe=ut[C];for(var Je=C;Je<X;Je++)we[Je]=we[Je+1],ut[Je]=ut[Je+1];we[X]=de,ut[X]=xe,this.setPage(X)}return this},h.deletePage=function(){return Bn.apply(this,arguments),this},h.__private__.text=h.text=function(C,X,de,xe,Ie){var Je,ct,Pt,Ot,sn,cn,Rn,ur,Or,Qn=(xe=xe||{}).scope||this;if(typeof C=="number"&&typeof X=="number"&&(typeof de=="string"||Array.isArray(de))){var Wr=de;de=X,X=C,C=Wr}if(arguments[3]instanceof It==0?(Pt=arguments[4],Ot=arguments[5],Wn(Rn=arguments[3])==="object"&&Rn!==null||(typeof Pt=="string"&&(Ot=Pt,Pt=null),typeof Rn=="string"&&(Ot=Rn,Rn=null),typeof Rn=="number"&&(Pt=Rn,Rn=null),xe={flags:Rn,angle:Pt,align:Ot})):(S("The transform parameter of text() with a Matrix value"),Or=Ie),isNaN(X)||isNaN(de)||C==null)throw new Error("Invalid arguments passed to jsPDF.text");if(C.length===0)return Qn;var Fr,ls="",Si=typeof xe.lineHeightFactor=="number"?xe.lineHeightFactor:Ke,Vs=Qn.internal.scaleFactor;function vm(Dn){return Dn=Dn.split("	").join(Array(xe.TabLen||9).join(" ")),ln(Dn,Rn)}function iu(Dn){for(var Yn,kr=Dn.concat(),Gr=[],Za=kr.length;Za--;)typeof(Yn=kr.shift())=="string"?Gr.push(Yn):Array.isArray(Dn)&&(Yn.length===1||Yn[1]===void 0&&Yn[2]===void 0)?Gr.push(Yn[0]):Gr.push([Yn[0],Yn[1],Yn[2]]);return Gr}function Fl(Dn,Yn){var kr;if(typeof Dn=="string")kr=Yn(Dn)[0];else if(Array.isArray(Dn)){for(var Gr,Za,Xd=Dn.concat(),lu=[],Nm=Xd.length;Nm--;)typeof(Gr=Xd.shift())=="string"?lu.push(Yn(Gr)[0]):Array.isArray(Gr)&&typeof Gr[0]=="string"&&(Za=Yn(Gr[0],Gr[1],Gr[2]),lu.push([Za[0],Za[1],Za[2]]));kr=lu}return kr}var Mo=!1,Dl=!0;if(typeof C=="string")Mo=!0;else if(Array.isArray(C)){var ql=C.concat();ct=[];for(var Bl,gs=ql.length;gs--;)(typeof(Bl=ql.shift())!="string"||Array.isArray(Bl)&&typeof Bl[0]!="string")&&(Dl=!1);Mo=Dl}if(Mo===!1)throw new Error('Type of text must be string or Array. "'+C+'" is not recognized.');typeof C=="string"&&(C=C.match(/[\r?\n]/)?C.split(/\r\n|\r|\n/g):[C]);var zl=ge/Qn.internal.scaleFactor,Ul=zl*(Si-1);switch(xe.baseline){case"bottom":de-=Ul;break;case"top":de+=zl-Ul;break;case"hanging":de+=zl-2*Ul;break;case"middle":de+=zl/2-Ul}if((cn=xe.maxWidth||0)>0&&(typeof C=="string"?C=Qn.splitTextToSize(C,cn):Object.prototype.toString.call(C)==="[object Array]"&&(C=C.reduce(function(Dn,Yn){return Dn.concat(Qn.splitTextToSize(Yn,cn))},[]))),Je={text:C,x:X,y:de,options:xe,mutex:{pdfEscape:ln,activeFontKey:le,fonts:he,activeFontSize:ge}},mt.publish("preProcessText",Je),C=Je.text,Pt=(xe=Je.options).angle,Or instanceof It==0&&Pt&&typeof Pt=="number"){Pt*=Math.PI/180,xe.rotationDirection===0&&(Pt=-Pt),N===w&&(Pt=-Pt);var qd=Math.cos(Pt),Bd=Math.sin(Pt);Or=new It(qd,Bd,-Bd,qd,0,0)}else Pt&&Pt instanceof It&&(Or=Pt);N!==w||Or||(Or=Vr),(sn=xe.charSpace||ru)!==void 0&&(ls+=T(A(sn))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(ur=xe.horizontalScale)!==void 0&&(ls+=T(100*ur)+` Tz
`),xe.lang;var pr=-1,Ka=xe.renderingMode!==void 0?xe.renderingMode:xe.stroke,au=Qn.internal.getCurrentPageInfo().pageContext;switch(Ka){case 0:case!1:case"fill":pr=0;break;case 1:case!0:case"stroke":pr=1;break;case 2:case"fillThenStroke":pr=2;break;case 3:case"invisible":pr=3;break;case 4:case"fillAndAddForClipping":pr=4;break;case 5:case"strokeAndAddPathForClipping":pr=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":pr=6;break;case 7:case"addToPathForClipping":pr=7}var bm=au.usedRenderingMode!==void 0?au.usedRenderingMode:-1;pr!==-1?ls+=pr+` Tr
`:bm!==-1&&(ls+=`0 Tr
`),pr!==-1&&(au.usedRenderingMode=pr),Ot=xe.align||"left";var Ai,Hl=ge*Si,zd=Qn.internal.pageSize.getWidth(),Ud=he[le];sn=xe.charSpace||ru,cn=xe.maxWidth||0,Rn=Object.assign({autoencode:!0,noBOM:!0},xe.flags);var Ro=[],Vl=function(Dn){return Qn.getStringUnitWidth(Dn,{font:Ud,charSpace:sn,fontSize:ge,doKerning:!1})*ge/Vs};if(Object.prototype.toString.call(C)==="[object Array]"){var si;ct=iu(C),Ot!=="left"&&(Ai=ct.map(Vl));var ii,$o=0;if(Ot==="right"){X-=Ai[0],C=[],gs=ct.length;for(var Ja=0;Ja<gs;Ja++)Ja===0?(ii=Wa(X),si=Ga(de)):(ii=A($o-Ai[Ja]),si=-Hl),C.push([ct[Ja],ii,si]),$o=Ai[Ja]}else if(Ot==="center"){X-=Ai[0]/2,C=[],gs=ct.length;for(var Oo=0;Oo<gs;Oo++)Oo===0?(ii=Wa(X),si=Ga(de)):(ii=A(($o-Ai[Oo])/2),si=-Hl),C.push([ct[Oo],ii,si]),$o=Ai[Oo]}else if(Ot==="left"){C=[],gs=ct.length;for(var Hd=0;Hd<gs;Hd++)C.push(ct[Hd])}else if(Ot==="justify"&&Ud.encoding==="Identity-H"){C=[],gs=ct.length,cn=cn!==0?cn:zd;for(var ou=0,Ar=0;Ar<gs;Ar++)if(si=Ar===0?Ga(de):-Hl,ii=Ar===0?Wa(X):ou,Ar<gs-1){var wm=A((cn-Ai[Ar])/(ct[Ar].split(" ").length-1)),xa=ct[Ar].split(" ");C.push([xa[0]+" ",ii,si]),ou=0;for(var ya=1;ya<xa.length;ya++){var Vd=(Vl(xa[ya-1]+" "+xa[ya])-Vl(xa[ya]))*Vs+wm;ya==xa.length-1?C.push([xa[ya],Vd,0]):C.push([xa[ya]+" ",Vd,0]),ou-=Vd}}else C.push([ct[Ar],ii,si]);C.push(["",ou,0])}else{if(Ot!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(C=[],gs=ct.length,cn=cn!==0?cn:zd,Ar=0;Ar<gs;Ar++){si=Ar===0?Ga(de):-Hl,ii=Ar===0?Wa(X):0;var Wd=ct[Ar].split(" ").length-1,Gd=Wd>0?(cn-Ai[Ar])/Wd:0;Ar<gs-1?Ro.push(T(A(Gd))):Ro.push(0),C.push([ct[Ar],ii,si])}}}(typeof xe.R2L=="boolean"?xe.R2L:ke)===!0&&(C=Fl(C,function(Dn,Yn,kr){return[Dn.split("").reverse().join(""),Yn,kr]})),Je={text:C,x:X,y:de,options:xe,mutex:{pdfEscape:ln,activeFontKey:le,fonts:he,activeFontSize:ge}},mt.publish("postProcessText",Je),C=Je.text,Fr=Je.mutex.isHex||!1;var Yd=he[le].encoding;Yd!=="WinAnsiEncoding"&&Yd!=="StandardEncoding"||(C=Fl(C,function(Dn,Yn,kr){return[vm(Dn),Yn,kr]})),ct=iu(C),C=[];for(var Fo,Do,qo,Wl=Array.isArray(ct[0])?1:0,Bo="",Gl=function(Dn,Yn,kr){var Gr="";return kr instanceof It?(kr=typeof xe.angle=="number"?Rr(kr,new It(1,0,0,1,Dn,Yn)):Rr(new It(1,0,0,1,Dn,Yn),kr),N===w&&(kr=Rr(new It(1,0,0,-1,0,0),kr)),Gr=kr.join(" ")+` Tm
`):Gr=T(Dn)+" "+T(Yn)+` Td
`,Gr},ki=0;ki<ct.length;ki++){switch(Bo="",Wl){case 1:qo=(Fr?"<":"(")+ct[ki][0]+(Fr?">":")"),Fo=parseFloat(ct[ki][1]),Do=parseFloat(ct[ki][2]);break;case 0:qo=(Fr?"<":"(")+ct[ki]+(Fr?">":")"),Fo=Wa(X),Do=Ga(de)}Ro!==void 0&&Ro[ki]!==void 0&&(Bo=Ro[ki]+` Tw
`),ki===0?C.push(Bo+Gl(Fo,Do,Or)+qo):Wl===0?C.push(Bo+qo):Wl===1&&C.push(Bo+Gl(Fo,Do,Or)+qo)}C=Wl===0?C.join(` Tj
T* `):C.join(` Tj
`),C+=` Tj
`;var va=`BT
/`;return va+=le+" "+ge+` Tf
`,va+=T(ge*Si)+` TL
`,va+=Ll+`
`,va+=ls,va+=C,ee(va+="ET"),m[le]=!0,Qn};var Yc=h.__private__.clip=h.clip=function(C){return ee(C==="evenodd"?"W*":"W"),this};h.clipEvenOdd=function(){return Yc("evenodd")},h.__private__.discardPath=h.discardPath=function(){return ee("n"),this};var ri=h.__private__.isValidStyle=function(C){var X=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(C)!==-1&&(X=!0),X};h.__private__.setDefaultPathOperation=h.setDefaultPathOperation=function(C){return ri(C)&&(d=C),this};var Il=h.__private__.getStyle=h.getStyle=function(C){var X=d;switch(C){case"D":case"S":X="S";break;case"F":X="f";break;case"FD":case"DF":X="B";break;case"f":case"f*":case"B":case"B*":X=C}return X},Tl=h.close=function(){return ee("h"),this};h.stroke=function(){return ee("S"),this},h.fill=function(C){return Hi("f",C),this},h.fillEvenOdd=function(C){return Hi("f*",C),this},h.fillStroke=function(C){return Hi("B",C),this},h.fillStrokeEvenOdd=function(C){return Hi("B*",C),this};var Hi=function(C,X){Wn(X)==="object"?Kc(X,C):ee(C)},To=function(C){C===null||N===w&&C===void 0||(C=Il(C),ee(C))};function Xc(C,X,de,xe,Ie){var Je=new Lu(X||this.boundingBox,de||this.xStep,xe||this.yStep,this.gState,Ie||this.matrix);Je.stream=this.stream;var ct=C+"$$"+this.cloneIndex+++"$$";return Sr(ct,Je),Je}var Kc=function(C,X){var de=qe[C.key],xe=tt[de];if(xe instanceof sc)ee("q"),ee(Jc(X)),xe.gState&&h.setGState(xe.gState),ee(C.matrix.toString()+" cm"),ee("/"+de+" sh"),ee("Q");else if(xe instanceof Lu){var Ie=new It(1,0,0,-1,0,Ol());C.matrix&&(Ie=Ie.multiply(C.matrix||Vr),de=Xc.call(xe,C.key,C.boundingBox,C.xStep,C.yStep,Ie).id),ee("q"),ee("/Pattern cs"),ee("/"+de+" scn"),xe.gState&&h.setGState(xe.gState),ee(X),ee("Q")}},Jc=function(C){switch(C){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Lo=h.moveTo=function(C,X){return ee(T(A(C))+" "+T(P(X))+" m"),this},ga=h.lineTo=function(C,X){return ee(T(A(C))+" "+T(P(X))+" l"),this},Vi=h.curveTo=function(C,X,de,xe,Ie,Je){return ee([T(A(C)),T(P(X)),T(A(de)),T(P(xe)),T(A(Ie)),T(P(Je)),"c"].join(" ")),this};h.__private__.line=h.line=function(C,X,de,xe,Ie){if(isNaN(C)||isNaN(X)||isNaN(de)||isNaN(xe)||!ri(Ie))throw new Error("Invalid arguments passed to jsPDF.line");return N===b?this.lines([[de-C,xe-X]],C,X,[1,1],Ie||"S"):this.lines([[de-C,xe-X]],C,X,[1,1]).stroke()},h.__private__.lines=h.lines=function(C,X,de,xe,Ie,Je){var ct,Pt,Ot,sn,cn,Rn,ur,Or,Qn,Wr,Fr,ls;if(typeof C=="number"&&(ls=de,de=X,X=C,C=ls),xe=xe||[1,1],Je=Je||!1,isNaN(X)||isNaN(de)||!Array.isArray(C)||!Array.isArray(xe)||!ri(Ie)||typeof Je!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Lo(X,de),ct=xe[0],Pt=xe[1],sn=C.length,Wr=X,Fr=de,Ot=0;Ot<sn;Ot++)(cn=C[Ot]).length===2?(Wr=cn[0]*ct+Wr,Fr=cn[1]*Pt+Fr,ga(Wr,Fr)):(Rn=cn[0]*ct+Wr,ur=cn[1]*Pt+Fr,Or=cn[2]*ct+Wr,Qn=cn[3]*Pt+Fr,Wr=cn[4]*ct+Wr,Fr=cn[5]*Pt+Fr,Vi(Rn,ur,Or,Qn,Wr,Fr));return Je&&Tl(),To(Ie),this},h.path=function(C){for(var X=0;X<C.length;X++){var de=C[X],xe=de.c;switch(de.op){case"m":Lo(xe[0],xe[1]);break;case"l":ga(xe[0],xe[1]);break;case"c":Vi.apply(this,xe);break;case"h":Tl()}}return this},h.__private__.rect=h.rect=function(C,X,de,xe,Ie){if(isNaN(C)||isNaN(X)||isNaN(de)||isNaN(xe)||!ri(Ie))throw new Error("Invalid arguments passed to jsPDF.rect");return N===b&&(xe=-xe),ee([T(A(C)),T(P(X)),T(A(de)),T(A(xe)),"re"].join(" ")),To(Ie),this},h.__private__.triangle=h.triangle=function(C,X,de,xe,Ie,Je,ct){if(isNaN(C)||isNaN(X)||isNaN(de)||isNaN(xe)||isNaN(Ie)||isNaN(Je)||!ri(ct))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[de-C,xe-X],[Ie-de,Je-xe],[C-Ie,X-Je]],C,X,[1,1],ct,!0),this},h.__private__.roundedRect=h.roundedRect=function(C,X,de,xe,Ie,Je,ct){if(isNaN(C)||isNaN(X)||isNaN(de)||isNaN(xe)||isNaN(Ie)||isNaN(Je)||!ri(ct))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Pt=4/3*(Math.SQRT2-1);return Ie=Math.min(Ie,.5*de),Je=Math.min(Je,.5*xe),this.lines([[de-2*Ie,0],[Ie*Pt,0,Ie,Je-Je*Pt,Ie,Je],[0,xe-2*Je],[0,Je*Pt,-Ie*Pt,Je,-Ie,Je],[2*Ie-de,0],[-Ie*Pt,0,-Ie,-Je*Pt,-Ie,-Je],[0,2*Je-xe],[0,-Je*Pt,Ie*Pt,-Je,Ie,-Je]],C+Ie,X,[1,1],ct,!0),this},h.__private__.ellipse=h.ellipse=function(C,X,de,xe,Ie){if(isNaN(C)||isNaN(X)||isNaN(de)||isNaN(xe)||!ri(Ie))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Je=4/3*(Math.SQRT2-1)*de,ct=4/3*(Math.SQRT2-1)*xe;return Lo(C+de,X),Vi(C+de,X-ct,C+Je,X-xe,C,X-xe),Vi(C-Je,X-xe,C-de,X-ct,C-de,X),Vi(C-de,X+ct,C-Je,X+xe,C,X+xe),Vi(C+Je,X+xe,C+de,X+ct,C+de,X),To(Ie),this},h.__private__.circle=h.circle=function(C,X,de,xe){if(isNaN(C)||isNaN(X)||isNaN(de)||!ri(xe))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(C,X,de,de,xe)},h.setFont=function(C,X,de){return de&&(X=R(X,de)),le=$r(C,X,{disableWarning:!1}),this};var Zc=h.__private__.getFont=h.getFont=function(){return he[$r.apply(h,arguments)]};h.__private__.getFontList=h.getFontList=function(){var C,X,de={};for(C in Pe)if(Pe.hasOwnProperty(C))for(X in de[C]=[],Pe[C])Pe[C].hasOwnProperty(X)&&de[C].push(X);return de},h.addFont=function(C,X,de,xe,Ie){var Je=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Je.indexOf(arguments[3])!==-1?Ie=arguments[3]:arguments[3]&&Je.indexOf(arguments[3])==-1&&(de=R(de,xe)),Pn.call(this,C,X,de,Ie=Ie||"Identity-H")};var Ke,nt=e.lineWidth||.200025,Ut=h.__private__.getLineWidth=h.getLineWidth=function(){return nt},Qc=h.__private__.setLineWidth=h.setLineWidth=function(C){return nt=C,ee(T(A(C))+" w"),this};h.__private__.setLineDash=qt.API.setLineDash=qt.API.setLineDashPattern=function(C,X){if(C=C||[],X=X||0,isNaN(X)||!Array.isArray(C))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return C=C.map(function(de){return T(A(de))}).join(" "),X=T(A(X)),ee("["+C+"] "+X+" d"),this};var Md=h.__private__.getLineHeight=h.getLineHeight=function(){return ge*Ke};h.__private__.getLineHeight=h.getLineHeight=function(){return ge*Ke};var eu=h.__private__.setLineHeightFactor=h.setLineHeightFactor=function(C){return typeof(C=C||1.15)=="number"&&(Ke=C),this},C1=h.__private__.getLineHeightFactor=h.getLineHeightFactor=function(){return Ke};eu(e.lineHeight);var Wa=h.__private__.getHorizontalCoordinate=function(C){return A(C)},Ga=h.__private__.getVerticalCoordinate=function(C){return N===w?C:ut[z].mediaBox.topRightY-ut[z].mediaBox.bottomLeftY-A(C)},P1=h.__private__.getHorizontalCoordinateString=h.getHorizontalCoordinateString=function(C){return T(Wa(C))},I1=h.__private__.getVerticalCoordinateString=h.getVerticalCoordinateString=function(C){return T(Ga(C))},tu=e.strokeColor||"0 G";h.__private__.getStrokeColor=h.getDrawColor=function(){return jt(tu)},h.__private__.setStrokeColor=h.setDrawColor=function(C,X,de,xe){return tu=an({ch1:C,ch2:X,ch3:de,ch4:xe,pdfColorType:"draw",precision:2}),ee(tu),this};var Rd=e.fillColor||"0 g";h.__private__.getFillColor=h.getFillColor=function(){return jt(Rd)},h.__private__.setFillColor=h.setFillColor=function(C,X,de,xe){return Rd=an({ch1:C,ch2:X,ch3:de,ch4:xe,pdfColorType:"fill",precision:2}),ee(Rd),this};var Ll=e.textColor||"0 g",nu=h.__private__.getTextColor=h.getTextColor=function(){return jt(Ll)};h.__private__.setTextColor=h.setTextColor=function(C,X,de,xe){return Ll=an({ch1:C,ch2:X,ch3:de,ch4:xe,pdfColorType:"text",precision:3}),this};var ru=e.charSpace,T1=h.__private__.getCharSpace=h.getCharSpace=function(){return parseFloat(ru||0)};h.__private__.setCharSpace=h.setCharSpace=function(C){if(isNaN(C))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return ru=C,this};var $d=0;h.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},h.__private__.setLineCap=h.setLineCap=function(C){var X=h.CapJoinStyles[C];if(X===void 0)throw new Error("Line cap style of '"+C+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return $d=X,ee(X+" J"),this};var Od=0;h.__private__.setLineJoin=h.setLineJoin=function(C){var X=h.CapJoinStyles[C];if(X===void 0)throw new Error("Line join style of '"+C+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Od=X,ee(X+" j"),this},h.__private__.setLineMiterLimit=h.__private__.setMiterLimit=h.setLineMiterLimit=h.setMiterLimit=function(C){if(C=C||0,isNaN(C))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return ee(T(A(C))+" M"),this},h.GState=Kg,h.setGState=function(C){(C=typeof C=="string"?ze[it[C]]:Ml(null,C)).equals(st)||(ee("/"+C.id+" gs"),st=C)};var Ml=function(C,X){if(!C||!it[C]){var de=!1;for(var xe in ze)if(ze.hasOwnProperty(xe)&&ze[xe].equals(X)){de=!0;break}if(de)X=ze[xe];else{var Ie="GS"+(Object.keys(ze).length+1).toString(10);ze[Ie]=X,X.id=Ie}return C&&(it[C]=X.id),mt.publish("addGState",X),X}};h.addGState=function(C,X){return Ml(C,X),this},h.saveGraphicsState=function(){return ee("q"),ot.push({key:le,size:ge,color:Ll}),this},h.restoreGraphicsState=function(){ee("Q");var C=ot.pop();return le=C.key,ge=C.size,Ll=C.color,st=null,this},h.setCurrentTransformationMatrix=function(C){return ee(C.toString()+" cm"),this},h.comment=function(C){return ee("#"+C),this};var Rl=function(C,X){var de=C||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return de},set:function(Je){isNaN(Je)||(de=parseFloat(Je))}});var xe=X||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return xe},set:function(Je){isNaN(Je)||(xe=parseFloat(Je))}});var Ie="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Ie},set:function(Je){Ie=Je.toString()}}),this},Fd=function(C,X,de,xe){Rl.call(this,C,X),this.type="rect";var Ie=de||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Ie},set:function(ct){isNaN(ct)||(Ie=parseFloat(ct))}});var Je=xe||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Je},set:function(ct){isNaN(ct)||(Je=parseFloat(ct))}}),this},su=function(){this.page=Ve,this.currentPage=z,this.pages=we.slice(0),this.pagesContext=ut.slice(0),this.x=Te,this.y=at,this.matrix=je,this.width=mm(z),this.height=Ya(z),this.outputDestination=Ee,this.id="",this.objectNumber=-1};su.prototype.restore=function(){Ve=this.page,z=this.currentPage,ut=this.pagesContext,we=this.pages,Te=this.x,at=this.y,je=this.matrix,pm(z,this.width),Xa(z,this.height),Ee=this.outputDestination};var Dd=function(C,X,de,xe,Ie){wn.push(new su),Ve=z=0,we=[],Te=C,at=X,je=Ie,Fn([de,xe])};for(var $l in h.beginFormObject=function(C,X,de,xe,Ie){return Dd(C,X,de,xe,Ie),this},h.endFormObject=function(C){return function(X){if(jn[X])wn.pop().restore();else{var de=new su,xe="Xo"+(Object.keys(Kt).length+1).toString(10);de.id=xe,jn[X]=xe,Kt[xe]=de,mt.publish("addFormObject",de),wn.pop().restore()}}(C),this},h.doFormObject=function(C,X){var de=Kt[jn[C]];return ee("q"),ee(X.toString()+" cm"),ee("/"+de.id+" Do"),ee("Q"),this},h.getFormObject=function(C){var X=Kt[jn[C]];return{x:X.x,y:X.y,width:X.width,height:X.height,matrix:X.matrix}},h.save=function(C,X){return C=C||"generated.pdf",(X=X||{}).returnPromise=X.returnPromise||!1,X.returnPromise===!1?(nc(ma(_i()),C),typeof nc.unload=="function"&&nn.setTimeout&&setTimeout(nc.unload,911),this):new Promise(function(de,xe){try{var Ie=nc(ma(_i()),C);typeof nc.unload=="function"&&nn.setTimeout&&setTimeout(nc.unload,911),de(Ie)}catch(Je){xe(Je.message)}})},qt.API)qt.API.hasOwnProperty($l)&&($l==="events"&&qt.API.events.length?function(C,X){var de,xe,Ie;for(Ie=X.length-1;Ie!==-1;Ie--)de=X[Ie][0],xe=X[Ie][1],C.subscribe.apply(C,[de].concat(typeof xe=="function"?[xe]:xe))}(mt,qt.API.events):h[$l]=qt.API[$l]);function mm(C){return ut[C].mediaBox.topRightX-ut[C].mediaBox.bottomLeftX}function pm(C,X){ut[C].mediaBox.topRightX=X+ut[C].mediaBox.bottomLeftX}function Ya(C){return ut[C].mediaBox.topRightY-ut[C].mediaBox.bottomLeftY}function Xa(C,X){ut[C].mediaBox.topRightY=X+ut[C].mediaBox.bottomLeftY}var gm=h.getPageWidth=function(C){return mm(C=C||z)/fe},xm=h.setPageWidth=function(C,X){pm(C,X*fe)},Ol=h.getPageHeight=function(C){return Ya(C=C||z)/fe},ym=h.setPageHeight=function(C,X){Xa(C,X*fe)};return h.internal={pdfEscape:ln,getStyle:Il,getFont:Zc,getFontSize:_e,getCharSpace:T1,getTextColor:nu,getLineHeight:Md,getLineHeightFactor:C1,getLineWidth:Ut,write:ft,getHorizontalCoordinate:Wa,getVerticalCoordinate:Ga,getCoordinateString:P1,getVerticalCoordinateString:I1,collections:{},newObject:Ue,newAdditionalObject:Vt,newObjectDeferred:pt,newObjectDeferredBegin:wt,getFilters:Mn,putStream:Xe,events:mt,scaleFactor:fe,pageSize:{getWidth:function(){return gm(z)},setWidth:function(C){xm(z,C)},getHeight:function(){return Ol(z)},setHeight:function(C){ym(z,C)}},encryptionOptions:u,encryption:ir,getEncryptor:function(C){return u!==null?ir.encryptor(C,0):function(X){return X}},output:Hs,getNumberOfPages:ji,pages:we,out:ee,f2:_,f3:M,getPageInfo:Io,getPageInfoByObjId:Wc,getCurrentPageInfo:Gc,getPDFVersion:y,Point:Rl,Rectangle:Fd,Matrix:It,hasHotfix:pa},Object.defineProperty(h.internal.pageSize,"width",{get:function(){return gm(z)},set:function(C){xm(z,C)},enumerable:!0,configurable:!0}),Object.defineProperty(h.internal.pageSize,"height",{get:function(){return Ol(z)},set:function(C){ym(z,C)},enumerable:!0,configurable:!0}),(function(C){for(var X=0,de=De.length;X<de;X++){var xe=Pn.call(this,C[X][0],C[X][1],C[X][2],De[X][3],!0);f===!1&&(m[xe]=!0);var Ie=C[X][0].split("-");zt({id:xe,fontName:Ie[0],fontStyle:Ie[1]||""})}mt.publish("addFonts",{fonts:he,dictionary:Pe})}).call(h,De),le="F1",En(s,n),mt.publish("initialized"),h}Au.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},Au.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},Au.prototype.hexToBytes=function(e){for(var t=[],n=0;n<e.length;n+=2)t.push(String.fromCharCode(parseInt(e.substr(n,2),16)));return t.join("")},Au.prototype.processOwnerPassword=function(e,t){return VN(HN(t).substr(0,5),e)},Au.prototype.encryptor=function(e,t){var n=HN(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(r){return VN(n,r)}},Kg.prototype.equals=function(e){var t,n="id,objectNumber,equals";if(!e||Wn(e)!==Wn(this))return!1;var r=0;for(t in this)if(!(n.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;r++}for(t in e)e.hasOwnProperty(t)&&n.indexOf(t)<0&&r--;return r===0},qt.API={events:[]},qt.version="3.0.3";var vr=qt.API,ej=1,Dc=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},ju=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},un=function(e){return e.toFixed(2)},Qo=function(e){return e.toFixed(5)};vr.__acroform__={};var ni=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},sA=function(e){return e*ej},_a=function(e){var t=new MO,n=Ct.internal.getHeight(e)||0,r=Ct.internal.getWidth(e)||0;return t.BBox=[0,0,Number(un(r)),Number(un(n))],t},tde=vr.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},nde=vr.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},rde=vr.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},Pr=vr.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return rde(e,t-1)},Ir=vr.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return tde(e,t-1)},Tr=vr.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return nde(e,t-1)},sde=vr.__acroform__.calculateCoordinates=function(e,t){var n=t.internal.getHorizontalCoordinate,r=t.internal.getVerticalCoordinate,s=e[0],i=e[1],l=e[2],a=e[3],c={};return c.lowerLeft_X=n(s)||0,c.lowerLeft_Y=r(i+a)||0,c.upperRight_X=n(s+l)||0,c.upperRight_Y=r(i)||0,[Number(un(c.lowerLeft_X)),Number(un(c.lowerLeft_Y)),Number(un(c.upperRight_X)),Number(un(c.upperRight_Y))]},ide=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],n=e._V||e.DV,r=WN(e,n),s=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+s+" "+un(r.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(r.text),t.push("ET"),t.push("Q"),t.push("EMC");var i=_a(e);return i.scope=e.scope,i.stream=t.join(`
`),i}},WN=function(e,t){var n=e.fontSize===0?e.maxFontSize:e.fontSize,r={text:"",fontSize:""},s=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");s=e.multiline?s.map(function(_){return _.split(`
`)}):s.map(function(_){return[_]});var i=n,l=Ct.internal.getHeight(e)||0;l=l<0?-l:l;var a=Ct.internal.getWidth(e)||0;a=a<0?-a:a;var c=function(_,M,A){if(_+1<s.length){var P=M+" "+s[_+1][0];return bp(P,e,A).width<=a-4}return!1};i++;e:for(;i>0;){t="",i--;var d,u,f=bp("3",e,i).height,m=e.multiline?l-i:(l-f)/2,h=m+=2,g=0,y=0,p=0;if(i<=0){t=`(...) Tj
`,t+="% Width of Text: "+bp(t,e,i=12).width+", FieldWidth:"+a+`
`;break}for(var x="",b=0,w=0;w<s.length;w++)if(s.hasOwnProperty(w)){var N=!1;if(s[w].length!==1&&p!==s[w].length-1){if((f+2)*(b+2)+2>l)continue e;x+=s[w][p],N=!0,y=w,w--}else{x=(x+=s[w][p]+" ").substr(x.length-1)==" "?x.substr(0,x.length-1):x;var k=parseInt(w),I=c(k,x,i),R=w>=s.length-1;if(I&&!R){x+=" ",p=0;continue}if(I||R){if(R)y=k;else if(e.multiline&&(f+2)*(b+2)+2>l)continue e}else{if(!e.multiline||(f+2)*(b+2)+2>l)continue e;y=k}}for(var T="",S=g;S<=y;S++){var E=s[S];if(e.multiline){if(S===y){T+=E[p]+" ",p=(p+1)%E.length;continue}if(S===g){T+=E[E.length-1]+" ";continue}}T+=E[0]+" "}switch(T=T.substr(T.length-1)==" "?T.substr(0,T.length-1):T,u=bp(T,e,i).width,e.textAlign){case"right":d=a-u-2;break;case"center":d=(a-u)/2;break;default:d=2}t+=un(d)+" "+un(h)+` Td
`,t+="("+Dc(T)+`) Tj
`,t+=-un(d)+` 0 Td
`,h=-(i+2),u=0,g=N?y:y+1,b++,x=""}break}return r.text=t,r.fontSize=i,r},bp=function(e,t,n){var r=t.scope.internal.getFont(t.fontName,t.fontStyle),s=t.scope.getStringUnitWidth(e,{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n);return{height:t.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n)*1.5,width:s}},ade={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},ode=function(e,t){var n={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(r){return r.type===n.type&&r.object===n.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(n)},lde=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(ua.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(ade)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");ej=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new RO,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(n){n.internal.events.unsubscribe(n.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete n.internal.acroformPlugin.acroFormDictionaryRoot._eventID,n.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(n){n.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var r=n.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in r)if(r.hasOwnProperty(s)){var i=r[s];i.objId=void 0,i.hasAnnotation&&ode(i,n)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(n){if(n.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");n.internal.write("/AcroForm "+n.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(n){(function(r,s){var i=!r;for(var l in r||(s.internal.newObjectDeferredBegin(s.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),s.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),r=r||s.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(r.hasOwnProperty(l)){var a=r[l],c=[],d=a.Rect;if(a.Rect&&(a.Rect=sde(a.Rect,s)),s.internal.newObjectDeferredBegin(a.objId,!0),a.DA=Ct.createDefaultAppearanceStream(a),Wn(a)==="object"&&typeof a.getKeyValueListForStream=="function"&&(c=a.getKeyValueListForStream()),a.Rect=d,a.hasAppearanceStream&&!a.appearanceStreamContent){var u=ide(a);c.push({key:"AP",value:"<</N "+u+">>"}),s.internal.acroformPlugin.xForms.push(u)}if(a.appearanceStreamContent){var f="";for(var m in a.appearanceStreamContent)if(a.appearanceStreamContent.hasOwnProperty(m)){var h=a.appearanceStreamContent[m];if(f+="/"+m+" ",f+="<<",Object.keys(h).length>=1||Array.isArray(h)){for(var l in h)if(h.hasOwnProperty(l)){var g=h[l];typeof g=="function"&&(g=g.call(s,a)),f+="/"+l+" "+g+" ",s.internal.acroformPlugin.xForms.indexOf(g)>=0||s.internal.acroformPlugin.xForms.push(g)}}else typeof(g=h)=="function"&&(g=g.call(s,a)),f+="/"+l+" "+g,s.internal.acroformPlugin.xForms.indexOf(g)>=0||s.internal.acroformPlugin.xForms.push(g);f+=">>"}c.push({key:"AP",value:`<<
`+f+">>"})}s.internal.putStream({additionalKeyValues:c,objectId:a.objId}),s.internal.out("endobj")}i&&function(y,p){for(var x in y)if(y.hasOwnProperty(x)){var b=x,w=y[x];p.internal.newObjectDeferredBegin(w.objId,!0),Wn(w)==="object"&&typeof w.putStream=="function"&&w.putStream(),delete y[b]}}(s.internal.acroformPlugin.xForms,s)})(n,e)}),e.internal.acroformPlugin.isInitialized=!0}},LO=vr.__acroform__.arrayToPdfArray=function(e,t,n){var r=function(l){return l};if(Array.isArray(e)){for(var s="[",i=0;i<e.length;i++)switch(i!==0&&(s+=" "),Wn(e[i])){case"boolean":case"number":case"object":s+=e[i].toString();break;case"string":e[i].substr(0,1)!=="/"?(t!==void 0&&n&&(r=n.internal.getEncryptor(t)),s+="("+Dc(r(e[i].toString()))+")"):s+=e[i].toString()}return s+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},gy=function(e,t,n){var r=function(s){return s};return t!==void 0&&n&&(r=n.internal.getEncryptor(t)),(e=e||"").toString(),"("+Dc(r(e))+")"},Ta=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Ta.prototype.toString=function(){return this.objId+" 0 R"},Ta.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Ta.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var n in t)if(Object.getOwnPropertyDescriptor(this,t[n]).configurable===!1){var r=t[n],s=this[r];s&&(Array.isArray(s)?e.push({key:r,value:LO(s,this.objId,this.scope)}):s instanceof Ta?(s.scope=this.scope,e.push({key:r,value:s.objId+" 0 R"})):typeof s!="function"&&e.push({key:r,value:s}))}return e};var MO=function(){Ta.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(n){e=n.trim()},get:function(){return e||null}})};ni(MO,Ta);var RO=function(){Ta.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var n=function(r){return r};return this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),"("+Dc(n(e))+")"}},set:function(n){e=n}})};ni(RO,Ta);var ua=function e(){Ta.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute F supplied.');t=x}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Pr(t,3)},set:function(x){x?this.F=Ir(t,3):this.F=Tr(t,3)}});var n=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return n},set:function(x){if(isNaN(x))throw new Error('Invalid value "'+x+'" for attribute Ff supplied.');n=x}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(r.length!==0)return r},set:function(x){r=x!==void 0?x:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(x){r[0]=x}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(x){r[1]=x}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(x){r[2]=x}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(x){r[3]=x}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(x){switch(x){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=x;break;default:throw new Error('Invalid value "'+x+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof Jg)return;i="FieldObject"+e.FieldNum++}var x=function(b){return b};return this.scope&&(x=this.scope.internal.getEncryptor(this.objId)),"("+Dc(x(i))+")"},set:function(x){i=x.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(x){i=x}});var l="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return l},set:function(x){l=x}});var a="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return a},set:function(x){a=x}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(x){c=x}});var d=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return d===void 0?50/ej:d},set:function(x){d=x}});var u="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return u},set:function(x){u=x}});var f="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!f||this instanceof Jg||this instanceof gc))return gy(f,this.objId,this.scope)},set:function(x){x=x.toString(),f=x}});var m=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof ts==0?gy(m,this.objId,this.scope):m},set:function(x){x=x.toString(),m=this instanceof ts==0?x.substr(0,1)==="("?ju(x.substr(1,x.length-2)):ju(x):x}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof ts==1?ju(m.substr(1,m.length-1)):m},set:function(x){x=x.toString(),m=this instanceof ts==1?"/"+x:x}});var h=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(h)return h},set:function(x){this.V=x}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof ts==0?gy(h,this.objId,this.scope):h},set:function(x){x=x.toString(),h=this instanceof ts==0?x.substr(0,1)==="("?ju(x.substr(1,x.length-2)):ju(x):x}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof ts==1?ju(h.substr(1,h.length-1)):h},set:function(x){x=x.toString(),h=this instanceof ts==1?"/"+x:x}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var g,y=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return y},set:function(x){x=!!x,y=x}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(g)return g},set:function(x){g=x}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Pr(this.Ff,1)},set:function(x){x?this.Ff=Ir(this.Ff,1):this.Ff=Tr(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Pr(this.Ff,2)},set:function(x){x?this.Ff=Ir(this.Ff,2):this.Ff=Tr(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Pr(this.Ff,3)},set:function(x){x?this.Ff=Ir(this.Ff,3):this.Ff=Tr(this.Ff,3)}});var p=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(p!==null)return p},set:function(x){if([0,1,2].indexOf(x)===-1)throw new Error('Invalid value "'+x+'" for attribute Q supplied.');p=x}}),Object.defineProperty(this,"textAlign",{get:function(){var x;switch(p){case 0:default:x="left";break;case 1:x="center";break;case 2:x="right"}return x},configurable:!0,enumerable:!0,set:function(x){switch(x){case"right":case 2:p=2;break;case"center":case 1:p=1;break;default:p=0}}})};ni(ua,Ta);var Bu=function(){ua.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(n){e=n}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return LO(t,this.objId,this.scope)},set:function(n){var r,s;s=[],typeof(r=n)=="string"&&(s=function(i,l,a){a||(a=1);for(var c,d=[];c=l.exec(i);)d.push(c[a]);return d}(r,/\((.*?)\)/g)),t=s}}),this.getOptions=function(){return t},this.setOptions=function(n){t=n,this.sort&&t.sort()},this.addOption=function(n){n=(n=n||"").toString(),t.push(n),this.sort&&t.sort()},this.removeOption=function(n,r){for(r=r||!1,n=(n=n||"").toString();t.indexOf(n)!==-1&&(t.splice(t.indexOf(n),1),r!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Pr(this.Ff,18)},set:function(n){n?this.Ff=Ir(this.Ff,18):this.Ff=Tr(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Pr(this.Ff,19)},set:function(n){this.combo===!0&&(n?this.Ff=Ir(this.Ff,19):this.Ff=Tr(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Pr(this.Ff,20)},set:function(n){n?(this.Ff=Ir(this.Ff,20),t.sort()):this.Ff=Tr(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Pr(this.Ff,22)},set:function(n){n?this.Ff=Ir(this.Ff,22):this.Ff=Tr(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Pr(this.Ff,23)},set:function(n){n?this.Ff=Ir(this.Ff,23):this.Ff=Tr(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Pr(this.Ff,27)},set:function(n){n?this.Ff=Ir(this.Ff,27):this.Ff=Tr(this.Ff,27)}}),this.hasAppearanceStream=!1};ni(Bu,ua);var zu=function(){Bu.call(this),this.fontName="helvetica",this.combo=!1};ni(zu,Bu);var Uu=function(){zu.call(this),this.combo=!0};ni(Uu,zu);var Yp=function(){Uu.call(this),this.edit=!0};ni(Yp,Uu);var ts=function(){ua.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Pr(this.Ff,15)},set:function(n){n?this.Ff=Ir(this.Ff,15):this.Ff=Tr(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Pr(this.Ff,16)},set:function(n){n?this.Ff=Ir(this.Ff,16):this.Ff=Tr(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Pr(this.Ff,17)},set:function(n){n?this.Ff=Ir(this.Ff,17):this.Ff=Tr(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Pr(this.Ff,26)},set:function(n){n?this.Ff=Ir(this.Ff,26):this.Ff=Tr(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(i){return i};if(this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var r,s=[];for(r in s.push("<<"),t)s.push("/"+r+" ("+Dc(n(t[r]))+")");return s.push(">>"),s.join(`
`)}},set:function(n){Wn(n)==="object"&&(t=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(n){typeof n=="string"&&(t.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(n){e="/"+n}})};ni(ts,ua);var Xp=function(){ts.call(this),this.pushButton=!0};ni(Xp,ts);var Hu=function(){ts.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};ni(Hu,ts);var Jg=function(){var e,t;ua.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(s){e=s}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(s){t=s}});var n,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var s=function(a){return a};this.scope&&(s=this.scope.internal.getEncryptor(this.objId));var i,l=[];for(i in l.push("<<"),r)l.push("/"+i+" ("+Dc(s(r[i]))+")");return l.push(">>"),l.join(`
`)},set:function(s){Wn(s)==="object"&&(r=s)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(s){typeof s=="string"&&(r.CA=s)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(s){n=s}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(s){n="/"+s}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=Ct.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};ni(Jg,ua),Hu.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var n=this.Kids[t];n.appearanceStreamContent=e.createAppearanceStream(n.optionName),n.caption=e.getCA()}},Hu.prototype.createOption=function(e){var t=new Jg;return t.Parent=this,t.optionName=e,this.Kids.push(t),cde.call(this.scope,t),t};var Kp=function(){ts.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=Ct.CheckBox.createAppearanceStream()};ni(Kp,ts);var gc=function(){ua.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Pr(this.Ff,13)},set:function(t){t?this.Ff=Ir(this.Ff,13):this.Ff=Tr(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Pr(this.Ff,21)},set:function(t){t?this.Ff=Ir(this.Ff,21):this.Ff=Tr(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Pr(this.Ff,23)},set:function(t){t?this.Ff=Ir(this.Ff,23):this.Ff=Tr(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Pr(this.Ff,24)},set:function(t){t?this.Ff=Ir(this.Ff,24):this.Ff=Tr(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Pr(this.Ff,25)},set:function(t){t?this.Ff=Ir(this.Ff,25):this.Ff=Tr(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Pr(this.Ff,26)},set:function(t){t?this.Ff=Ir(this.Ff,26):this.Ff=Tr(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};ni(gc,ua);var Jp=function(){gc.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Pr(this.Ff,14)},set:function(e){e?this.Ff=Ir(this.Ff,14):this.Ff=Tr(this.Ff,14)}}),this.password=!0};ni(Jp,gc);var Ct={CheckBox:{createAppearanceStream:function(){return{N:{On:Ct.CheckBox.YesNormal},D:{On:Ct.CheckBox.YesPushDown,Off:Ct.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=_a(e);t.scope=e.scope;var n=[],r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,s=e.scope.__private__.encodeColorString(e.color),i=WN(e,e.caption);return n.push("0.749023 g"),n.push("0 0 "+un(Ct.internal.getWidth(e))+" "+un(Ct.internal.getHeight(e))+" re"),n.push("f"),n.push("BMC"),n.push("q"),n.push("0 0 1 rg"),n.push("/"+r+" "+un(i.fontSize)+" Tf "+s),n.push("BT"),n.push(i.text),n.push("ET"),n.push("Q"),n.push("EMC"),t.stream=n.join(`
`),t},YesNormal:function(e){var t=_a(e);t.scope=e.scope;var n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color),s=[],i=Ct.internal.getHeight(e),l=Ct.internal.getWidth(e),a=WN(e,e.caption);return s.push("1 g"),s.push("0 0 "+un(l)+" "+un(i)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+un(l-1)+" "+un(i-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+n+" "+un(a.fontSize)+" Tf "+r),s.push(a.text),s.push("ET"),s.push("Q"),t.stream=s.join(`
`),t},OffPushDown:function(e){var t=_a(e);t.scope=e.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+un(Ct.internal.getWidth(e))+" "+un(Ct.internal.getHeight(e))+" re"),n.push("f"),t.stream=n.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:Ct.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=Ct.RadioButton.Circle.YesNormal,t.D[e]=Ct.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=_a(e);t.scope=e.scope;var n=[],r=Ct.internal.getWidth(e)<=Ct.internal.getHeight(e)?Ct.internal.getWidth(e)/4:Ct.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var s=Ct.internal.Bezier_C,i=Number((r*s).toFixed(5));return n.push("q"),n.push("1 0 0 1 "+Qo(Ct.internal.getWidth(e)/2)+" "+Qo(Ct.internal.getHeight(e)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+i+" "+i+" "+r+" 0 "+r+" c"),n.push("-"+i+" "+r+" -"+r+" "+i+" -"+r+" 0 c"),n.push("-"+r+" -"+i+" -"+i+" -"+r+" 0 -"+r+" c"),n.push(i+" -"+r+" "+r+" -"+i+" "+r+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join(`
`),t},YesPushDown:function(e){var t=_a(e);t.scope=e.scope;var n=[],r=Ct.internal.getWidth(e)<=Ct.internal.getHeight(e)?Ct.internal.getWidth(e)/4:Ct.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var s=Number((2*r).toFixed(5)),i=Number((s*Ct.internal.Bezier_C).toFixed(5)),l=Number((r*Ct.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+Qo(Ct.internal.getWidth(e)/2)+" "+Qo(Ct.internal.getHeight(e)/2)+" cm"),n.push(s+" 0 m"),n.push(s+" "+i+" "+i+" "+s+" 0 "+s+" c"),n.push("-"+i+" "+s+" -"+s+" "+i+" -"+s+" 0 c"),n.push("-"+s+" -"+i+" -"+i+" -"+s+" 0 -"+s+" c"),n.push(i+" -"+s+" "+s+" -"+i+" "+s+" 0 c"),n.push("f"),n.push("Q"),n.push("0 g"),n.push("q"),n.push("1 0 0 1 "+Qo(Ct.internal.getWidth(e)/2)+" "+Qo(Ct.internal.getHeight(e)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+l+" "+l+" "+r+" 0 "+r+" c"),n.push("-"+l+" "+r+" -"+r+" "+l+" -"+r+" 0 c"),n.push("-"+r+" -"+l+" -"+l+" -"+r+" 0 -"+r+" c"),n.push(l+" -"+r+" "+r+" -"+l+" "+r+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=_a(e);t.scope=e.scope;var n=[],r=Ct.internal.getWidth(e)<=Ct.internal.getHeight(e)?Ct.internal.getWidth(e)/4:Ct.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var s=Number((2*r).toFixed(5)),i=Number((s*Ct.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+Qo(Ct.internal.getWidth(e)/2)+" "+Qo(Ct.internal.getHeight(e)/2)+" cm"),n.push(s+" 0 m"),n.push(s+" "+i+" "+i+" "+s+" 0 "+s+" c"),n.push("-"+i+" "+s+" -"+s+" "+i+" -"+s+" 0 c"),n.push("-"+s+" -"+i+" -"+i+" -"+s+" 0 -"+s+" c"),n.push(i+" -"+s+" "+s+" -"+i+" "+s+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:Ct.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=Ct.RadioButton.Cross.YesNormal,t.D[e]=Ct.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=_a(e);t.scope=e.scope;var n=[],r=Ct.internal.calculateCross(e);return n.push("q"),n.push("1 1 "+un(Ct.internal.getWidth(e)-2)+" "+un(Ct.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(un(r.x1.x)+" "+un(r.x1.y)+" m"),n.push(un(r.x2.x)+" "+un(r.x2.y)+" l"),n.push(un(r.x4.x)+" "+un(r.x4.y)+" m"),n.push(un(r.x3.x)+" "+un(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},YesPushDown:function(e){var t=_a(e);t.scope=e.scope;var n=Ct.internal.calculateCross(e),r=[];return r.push("0.749023 g"),r.push("0 0 "+un(Ct.internal.getWidth(e))+" "+un(Ct.internal.getHeight(e))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+un(Ct.internal.getWidth(e)-2)+" "+un(Ct.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(un(n.x1.x)+" "+un(n.x1.y)+" m"),r.push(un(n.x2.x)+" "+un(n.x2.y)+" l"),r.push(un(n.x4.x)+" "+un(n.x4.y)+" m"),r.push(un(n.x3.x)+" "+un(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=_a(e);t.scope=e.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+un(Ct.internal.getWidth(e))+" "+un(Ct.internal.getHeight(e))+" re"),n.push("f"),t.stream=n.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+n}};Ct.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=Ct.internal.getWidth(e),n=Ct.internal.getHeight(e),r=Math.min(t,n);return{x1:{x:(t-r)/2,y:(n-r)/2+r},x2:{x:(t-r)/2+r,y:(n-r)/2},x3:{x:(t-r)/2,y:(n-r)/2},x4:{x:(t-r)/2+r,y:(n-r)/2+r}}}},Ct.internal.getWidth=function(e){var t=0;return Wn(e)==="object"&&(t=sA(e.Rect[2])),t},Ct.internal.getHeight=function(e){var t=0;return Wn(e)==="object"&&(t=sA(e.Rect[3])),t};var cde=vr.addField=function(e){if(lde(this,e),!(e instanceof ua))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};vr.AcroFormChoiceField=Bu,vr.AcroFormListBox=zu,vr.AcroFormComboBox=Uu,vr.AcroFormEditBox=Yp,vr.AcroFormButton=ts,vr.AcroFormPushButton=Xp,vr.AcroFormRadioButton=Hu,vr.AcroFormCheckBox=Kp,vr.AcroFormTextField=gc,vr.AcroFormPasswordField=Jp,vr.AcroFormAppearance=Ct,vr.AcroForm={ChoiceField:Bu,ListBox:zu,ComboBox:Uu,EditBox:Yp,Button:ts,PushButton:Xp,RadioButton:Hu,CheckBox:Kp,TextField:gc,PasswordField:Jp,Appearance:Ct},qt.AcroForm={ChoiceField:Bu,ListBox:zu,ComboBox:Uu,EditBox:Yp,Button:ts,PushButton:Xp,RadioButton:Hu,CheckBox:Kp,TextField:gc,PasswordField:Jp,Appearance:Ct};qt.AcroForm;function $O(e){return e.reduce(function(t,n,r){return t[n]=r,t},{})}(function(e){var t="addImage_";e.__addimage__={};var n="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},s=e.__addimage__.getImageFileTypeByImageData=function(_,M){var A,P,B,L,D,V=n;if((M=M||n)==="RGBA"||_.data!==void 0&&_.data instanceof Uint8ClampedArray&&"height"in _&&"width"in _)return"RGBA";if(I(_))for(D in r)for(B=r[D],A=0;A<B.length;A+=1){for(L=!0,P=0;P<B[A].length;P+=1)if(B[A][P]!==void 0&&B[A][P]!==_[P]){L=!1;break}if(L===!0){V=D;break}}else for(D in r)for(B=r[D],A=0;A<B.length;A+=1){for(L=!0,P=0;P<B[A].length;P+=1)if(B[A][P]!==void 0&&B[A][P]!==_.charCodeAt(P)){L=!1;break}if(L===!0){V=D;break}}return V===n&&M!==n&&(V=M),V},i=function _(M){for(var A=this.internal.write,P=this.internal.putStream,B=(0,this.internal.getFilters)();B.indexOf("FlateEncode")!==-1;)B.splice(B.indexOf("FlateEncode"),1);M.objectId=this.internal.newObject();var L=[];if(L.push({key:"Type",value:"/XObject"}),L.push({key:"Subtype",value:"/Image"}),L.push({key:"Width",value:M.width}),L.push({key:"Height",value:M.height}),M.colorSpace===x.INDEXED?L.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(M.palette.length/3-1)+" "+("sMask"in M&&M.sMask!==void 0?M.objectId+2:M.objectId+1)+" 0 R]"}):(L.push({key:"ColorSpace",value:"/"+M.colorSpace}),M.colorSpace===x.DEVICE_CMYK&&L.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),L.push({key:"BitsPerComponent",value:M.bitsPerComponent}),"decodeParameters"in M&&M.decodeParameters!==void 0&&L.push({key:"DecodeParms",value:"<<"+M.decodeParameters+">>"}),"transparency"in M&&Array.isArray(M.transparency)&&M.transparency.length>0){for(var D="",V=0,O=M.transparency.length;V<O;V++)D+=M.transparency[V]+" "+M.transparency[V]+" ";L.push({key:"Mask",value:"["+D+"]"})}M.sMask!==void 0&&L.push({key:"SMask",value:M.objectId+1+" 0 R"});var H=M.filter!==void 0?["/"+M.filter]:void 0;if(P({data:M.data,additionalKeyValues:L,alreadyAppliedFilters:H,objectId:M.objectId}),A("endobj"),"sMask"in M&&M.sMask!==void 0){var W,$=(W=M.sMaskBitsPerComponent)!==null&&W!==void 0?W:M.bitsPerComponent,z={width:M.width,height:M.height,colorSpace:"DeviceGray",bitsPerComponent:$,data:M.sMask};"filter"in M&&(z.decodeParameters="/Predictor ".concat(M.predictor," /Colors 1 /BitsPerComponent ").concat($," /Columns ").concat(M.width),z.filter=M.filter),_.call(this,z)}if(M.colorSpace===x.INDEXED){var q=this.internal.newObject();P({data:T(new Uint8Array(M.palette)),objectId:q}),A("endobj")}},l=function(){var _=this.internal.collections[t+"images"];for(var M in _)i.call(this,_[M])},a=function(){var _,M=this.internal.collections[t+"images"],A=this.internal.write;for(var P in M)A("/I"+(_=M[P]).index,_.objectId,"0","R")},c=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",l),this.internal.events.subscribe("putXobjectDict",a))},d=function(){var _=this.internal.collections[t+"images"];return c.call(this),_},u=function(){return Object.keys(this.internal.collections[t+"images"]).length},f=function(_){return typeof e["process"+_.toUpperCase()]=="function"},m=function(_){return Wn(_)==="object"&&_.nodeType===1},h=function(_,M){if(_.nodeName==="IMG"&&_.hasAttribute("src")){var A=""+_.getAttribute("src");if(A.indexOf("data:image/")===0)return Gp(unescape(A).split("base64,").pop());var P=e.loadFile(A,!0);if(P!==void 0)return P}if(_.nodeName==="CANVAS"){if(_.width===0||_.height===0)throw new Error("Given canvas must have data. Canvas width: "+_.width+", height: "+_.height);var B;switch(M){case"PNG":B="image/png";break;case"WEBP":B="image/webp";break;default:B="image/jpeg"}return Gp(_.toDataURL(B,1).split("base64,").pop())}},g=function(_){var M=this.internal.collections[t+"images"];if(M){for(var A in M)if(_===M[A].alias)return M[A]}},y=function(_,M,A){return _||M||(_=-96,M=-96),_<0&&(_=-1*A.width*72/_/this.internal.scaleFactor),M<0&&(M=-1*A.height*72/M/this.internal.scaleFactor),_===0&&(_=M*A.width/A.height),M===0&&(M=_*A.height/A.width),[_,M]},p=function(_,M,A,P,B,L){var D=y.call(this,A,P,B),V=this.internal.getCoordinateString,O=this.internal.getVerticalCoordinateString,H=d.call(this);if(A=D[0],P=D[1],H[B.index]=B,L){L*=Math.PI/180;var W=Math.cos(L),$=Math.sin(L),z=function(G){return G.toFixed(4)},q=[z(W),z($),z(-1*$),z(W),0,0,"cm"]}this.internal.write("q"),L?(this.internal.write([1,"0","0",1,V(_),O(M+P),"cm"].join(" ")),this.internal.write(q.join(" ")),this.internal.write([V(A),"0","0",V(P),"0","0","cm"].join(" "))):this.internal.write([V(A),"0","0",V(P),V(_),O(M+P),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+B.index+" Do"),this.internal.write("Q")},x=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var b=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},w=e.__addimage__.sHashCode=function(_){var M,A,P=0;if(typeof _=="string")for(A=_.length,M=0;M<A;M++)P=(P<<5)-P+_.charCodeAt(M),P|=0;else if(I(_))for(A=_.byteLength/2,M=0;M<A;M++)P=(P<<5)-P+_[M],P|=0;return P},N=e.__addimage__.validateStringAsBase64=function(_){(_=_||"").toString().trim();var M=!0;return _.length===0&&(M=!1),_.length%4!=0&&(M=!1),/^[A-Za-z0-9+/]+$/.test(_.substr(0,_.length-2))===!1&&(M=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(_.substr(-2))===!1&&(M=!1),M},k=e.__addimage__.extractImageFromDataUrl=function(_){if(_==null||!(_=_.trim()).startsWith("data:"))return null;var M=_.indexOf(",");return M<0?null:_.substring(0,M).trim().endsWith("base64")?_.substring(M+1):null};e.__addimage__.isArrayBuffer=function(_){return _ instanceof ArrayBuffer};var I=e.__addimage__.isArrayBufferView=function(_){return _ instanceof Int8Array||_ instanceof Uint8Array||_ instanceof Uint8ClampedArray||_ instanceof Int16Array||_ instanceof Uint16Array||_ instanceof Int32Array||_ instanceof Uint32Array||_ instanceof Float32Array||_ instanceof Float64Array},R=e.__addimage__.binaryStringToUint8Array=function(_){for(var M=_.length,A=new Uint8Array(M),P=0;P<M;P++)A[P]=_.charCodeAt(P);return A},T=e.__addimage__.arrayBufferToBinaryString=function(_){for(var M="",A=I(_)?_:new Uint8Array(_),P=0;P<A.length;P+=8192)M+=String.fromCharCode.apply(null,A.subarray(P,P+8192));return M};e.addImage=function(){var _,M,A,P,B,L,D,V,O;if(typeof arguments[1]=="number"?(M=n,A=arguments[1],P=arguments[2],B=arguments[3],L=arguments[4],D=arguments[5],V=arguments[6],O=arguments[7]):(M=arguments[1],A=arguments[2],P=arguments[3],B=arguments[4],L=arguments[5],D=arguments[6],V=arguments[7],O=arguments[8]),Wn(_=arguments[0])==="object"&&!m(_)&&"imageData"in _){var H=_;_=H.imageData,M=H.format||M||n,A=H.x||A||0,P=H.y||P||0,B=H.w||H.width||B,L=H.h||H.height||L,D=H.alias||D,V=H.compression||V,O=H.rotation||H.angle||O}var W=this.internal.getFilters();if(V===void 0&&W.indexOf("FlateEncode")!==-1&&(V="SLOW"),isNaN(A)||isNaN(P))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var $=S.call(this,_,M,D,V);return p.call(this,A,P,B,L,$,O),this};var S=function(_,M,A,P){var B,L,D;if(typeof _=="string"&&s(_)===n){_=unescape(_);var V=E(_,!1);(V!==""||(V=e.loadFile(_,!0))!==void 0)&&(_=V)}if(m(_)&&(_=h(_,M)),M=s(_,M),!f(M))throw new Error("addImage does not support files of type '"+M+"', please ensure that a plugin for '"+M+"' support is added.");if(((D=A)==null||D.length===0)&&(A=function(O){return typeof O=="string"||I(O)?w(O):I(O.data)?w(O.data):null}(_)),(B=g.call(this,A))||(_ instanceof Uint8Array||M==="RGBA"||(L=_,_=R(_)),B=this["process"+M.toUpperCase()](_,u.call(this),A,function(O){return O&&typeof O=="string"&&(O=O.toUpperCase()),O in e.image_compression?O:b.NONE}(P),L)),!B)throw new Error("An unknown error occurred whilst processing the image.");return B},E=e.__addimage__.convertBase64ToBinaryString=function(_,M){M=typeof M!="boolean"||M;var A,P="";if(typeof _=="string"){var B;A=(B=k(_))!==null&&B!==void 0?B:_;try{P=Gp(A)}catch(L){if(M)throw N(A)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+L.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return P};e.getImageProperties=function(_){var M,A,P="";if(m(_)&&(_=h(_)),typeof _=="string"&&s(_)===n&&((P=E(_,!1))===""&&(P=e.loadFile(_)||""),_=P),A=s(_),!f(A))throw new Error("addImage does not support files of type '"+A+"', please ensure that a plugin for '"+A+"' support is added.");if(_ instanceof Uint8Array||(_=R(_)),!(M=this["process"+A.toUpperCase()](_)))throw new Error("An unknown error occurred whilst processing the image");return M.fileType=A,M}})(qt.API),function(e){var t=function(n){if(n!==void 0&&n!="")return!0};qt.API.events.push(["addPage",function(n){this.internal.getPageInfo(n.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(n){for(var r,s,i,l=this.internal.getCoordinateString,a=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(n.objId),d=n.pageContext.annotations,u=!1,f=0;f<d.length&&!u;f++)switch((r=d[f]).type){case"link":(t(r.options.url)||t(r.options.pageNumber))&&(u=!0);break;case"reference":case"text":case"freetext":u=!0}if(u!=0){this.internal.write("/Annots [");for(var m=0;m<d.length;m++){r=d[m];var h=this.internal.pdfEscape,g=this.internal.getEncryptor(n.objId);switch(r.type){case"reference":this.internal.write(" "+r.object.objId+" 0 R ");break;case"text":var y=this.internal.newAdditionalObject(),p=this.internal.newAdditionalObject(),x=this.internal.getEncryptor(y.objId),b=r.title||"Note";i="<</Type /Annot /Subtype /Text "+(s="/Rect ["+l(r.bounds.x)+" "+a(r.bounds.y+r.bounds.h)+" "+l(r.bounds.x+r.bounds.w)+" "+a(r.bounds.y)+"] ")+"/Contents ("+h(x(r.contents))+")",i+=" /Popup "+p.objId+" 0 R",i+=" /P "+c.objId+" 0 R",i+=" /T ("+h(x(b))+") >>",y.content=i;var w=y.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+l(r.bounds.x+30)+" "+a(r.bounds.y+r.bounds.h)+" "+l(r.bounds.x+r.bounds.w+30)+" "+a(r.bounds.y)+"] ")+" /Parent "+w,r.open&&(i+=" /Open true"),i+=" >>",p.content=i,this.internal.write(y.objId,"0 R",p.objId,"0 R");break;case"freetext":s="/Rect ["+l(r.bounds.x)+" "+a(r.bounds.y)+" "+l(r.bounds.x+r.bounds.w)+" "+a(r.bounds.y+r.bounds.h)+"] ";var N=r.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+h(g(r.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+N+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(r.options.name){var k=this.annotations._nameMap[r.options.name];r.options.pageNumber=k.page,r.options.top=k.y}else r.options.top||(r.options.top=0);if(s="/Rect ["+r.finalBounds.x+" "+r.finalBounds.y+" "+r.finalBounds.w+" "+r.finalBounds.h+"] ",i="",r.options.url)i="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+h(g(r.options.url))+") >>";else if(r.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(r.options.pageNumber).objId+" 0 R",r.options.magFactor=r.options.magFactor||"XYZ",r.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+r.options.top+"]";break;case"FitV":r.options.left=r.options.left||0,i+=" /FitV "+r.options.left+"]";break;default:var I=a(r.options.top);r.options.left=r.options.left||0,r.options.zoom===void 0&&(r.options.zoom=0),i+=" /XYZ "+r.options.left+" "+I+" "+r.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),e.createAnnotation=function(n){var r=this.internal.getCurrentPageInfo();switch(n.type){case"link":this.link(n.bounds.x,n.bounds.y,n.bounds.w,n.bounds.h,n);break;case"text":case"freetext":r.pageContext.annotations.push(n)}},e.link=function(n,r,s,i,l){var a=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,d=this.internal.getVerticalCoordinateString;a.pageContext.annotations.push({finalBounds:{x:c(n),y:d(r),w:c(n+s),h:d(r+i)},options:l,type:"link"})},e.textWithLink=function(n,r,s,i){var l,a,c=this.getTextWidth(n),d=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){a=i.maxWidth;var u=this.splitTextToSize(n,a).length;l=Math.ceil(d*u)}else a=c,l=d;return this.text(n,r,s,i),s+=.2*d,i.align==="center"&&(r-=c/2),i.align==="right"&&(r-=c),this.link(r,s-d,a,l,i),c},e.getTextWidth=function(n){var r=this.internal.getFontSize();return this.getStringUnitWidth(n)*r/this.internal.scaleFactor}}(qt.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},n={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];e.__arabicParser__={};var i=e.__arabicParser__.isInArabicSubstitutionA=function(y){return t[y.charCodeAt(0)]!==void 0},l=e.__arabicParser__.isArabicLetter=function(y){return typeof y=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(y)},a=e.__arabicParser__.isArabicEndLetter=function(y){return l(y)&&i(y)&&t[y.charCodeAt(0)].length<=2},c=e.__arabicParser__.isArabicAlfLetter=function(y){return l(y)&&s.indexOf(y.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(y){return l(y)&&i(y)&&t[y.charCodeAt(0)].length>=1};var d=e.__arabicParser__.arabicLetterHasFinalForm=function(y){return l(y)&&i(y)&&t[y.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(y){return l(y)&&i(y)&&t[y.charCodeAt(0)].length>=3};var u=e.__arabicParser__.arabicLetterHasMedialForm=function(y){return l(y)&&i(y)&&t[y.charCodeAt(0)].length==4},f=e.__arabicParser__.resolveLigatures=function(y){var p=0,x=n,b="",w=0;for(p=0;p<y.length;p+=1)x[y.charCodeAt(p)]!==void 0?(w++,typeof(x=x[y.charCodeAt(p)])=="number"&&(b+=String.fromCharCode(x),x=n,w=0),p===y.length-1&&(x=n,b+=y.charAt(p-(w-1)),p-=w-1,w=0)):(x=n,b+=y.charAt(p-w),p-=w,w=0);return b};e.__arabicParser__.isArabicDiacritic=function(y){return y!==void 0&&r[y.charCodeAt(0)]!==void 0};var m=e.__arabicParser__.getCorrectForm=function(y,p,x){return l(y)?i(y)===!1?-1:!d(y)||!l(p)&&!l(x)||!l(x)&&a(p)||a(y)&&!l(p)||a(y)&&c(p)||a(y)&&a(p)?0:u(y)&&l(p)&&!a(p)&&l(x)&&d(x)?3:a(y)||!l(x)?1:2:-1},h=function(y){var p=0,x=0,b=0,w="",N="",k="",I=(y=y||"").split("\\s+"),R=[];for(p=0;p<I.length;p+=1){for(R.push(""),x=0;x<I[p].length;x+=1)w=I[p][x],N=I[p][x-1],k=I[p][x+1],l(w)?(b=m(w,N,k),R[p]+=b!==-1?String.fromCharCode(t[w.charCodeAt(0)][b]):w):R[p]+=w;R[p]=f(R[p])}return R.join(" ")},g=e.__arabicParser__.processArabic=e.processArabic=function(){var y,p=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,x=[];if(Array.isArray(p)){var b=0;for(x=[],b=0;b<p.length;b+=1)Array.isArray(p[b])?x.push([h(p[b][0]),p[b][1],p[b][2]]):x.push([h(p[b])]);y=x}else y=h(p);return typeof arguments[0]=="string"?y:(arguments[0].text=y,arguments[0])};e.events.push(["preProcessText",g])}(qt.API),qt.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform",e.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},function(e){var t=function(){var n=void 0;Object.defineProperty(this,"pdf",{get:function(){return n},set:function(a){n=a}});var r=150;Object.defineProperty(this,"width",{get:function(){return r},set:function(a){r=isNaN(a)||Number.isInteger(a)===!1||a<0?150:a,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=r+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(a){s=isNaN(a)||Number.isInteger(a)===!1||a<0?300:a,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(a){i=a}});var l={};Object.defineProperty(this,"style",{get:function(){return l},set:function(a){l=a}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(n,r){var s;if((n=n||"2d")!=="2d")return null;for(s in r)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=r[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(qt.API),function(e){var t={left:0,top:0,bottom:0,right:0},n=!1,r=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),s.call(this))},s=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(y){c=y}});var d=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return d},set:function(y){d=y}});var u=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return u},set:function(y){u=y}});var f=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return f},set:function(y){f=y}});var m=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return m},set:function(y){m=y}});var h=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return h},set:function(y){h=y}});var g=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return g},set:function(y){g=y}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(c){return r.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},e.getTextDimensions=function(c,d){r.call(this);var u=(d=d||{}).fontSize||this.getFontSize(),f=d.font||this.getFont(),m=d.scaleFactor||this.internal.scaleFactor,h=0,g=0,y=0,p=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var x=d.maxWidth;x>0?typeof c=="string"?c=this.splitTextToSize(c,x):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(w,N){return w.concat(p.splitTextToSize(N,x))},[])):c=Array.isArray(c)?c:[c];for(var b=0;b<c.length;b++)h<(y=this.getStringUnitWidth(c[b],{font:f})*u)&&(h=y);return h!==0&&(g=c.length),{w:h/=m,h:Math.max((g*u*this.getLineHeightFactor()-u*(this.getLineHeightFactor()-1))/m,0)}},e.cellAddPage=function(){r.call(this),this.addPage();var c=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new i(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var l=e.cell=function(){var c;c=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),r.call(this);var d=this.internal.__cell__.lastCell,u=this.internal.__cell__.padding,f=this.internal.__cell__.margins||t,m=this.internal.__cell__.tableHeaderRow,h=this.internal.__cell__.printHeaders;return d.lineNumber!==void 0&&(d.lineNumber===c.lineNumber?(c.x=(d.x||0)+(d.width||0),c.y=d.y||0):d.y+d.height+c.height+f.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=f.top,h&&m&&(this.printHeaderRow(c.lineNumber,!0),c.y+=m[0].height)):c.y=d.y+d.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,n===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-u,c.y+u,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+u,{align:"center",baseline:"top",maxWidth:c.width-u-u}):this.text(c.text,c.x+u,c.y+u,{align:"left",baseline:"top",maxWidth:c.width-u-u})),this.internal.__cell__.lastCell=c,this};e.table=function(c,d,u,f,m){if(r.call(this),!u)throw new Error("No data for PDF table.");var h,g,y,p,x=[],b=[],w=[],N={},k={},I=[],R=[],T=(m=m||{}).autoSize||!1,S=m.printHeaders!==!1,E=m.css&&m.css["font-size"]!==void 0?16*m.css["font-size"]:m.fontSize||12,_=m.margins||Object.assign({width:this.getPageWidth()},t),M=typeof m.padding=="number"?m.padding:3,A=m.headerBackgroundColor||"#c8c8c8",P=m.headerTextColor||"#000";if(s.call(this),this.internal.__cell__.printHeaders=S,this.internal.__cell__.margins=_,this.internal.__cell__.table_font_size=E,this.internal.__cell__.padding=M,this.internal.__cell__.headerBackgroundColor=A,this.internal.__cell__.headerTextColor=P,this.setFontSize(E),f==null)b=x=Object.keys(u[0]),w=x.map(function(){return"left"});else if(Array.isArray(f)&&Wn(f[0])==="object")for(x=f.map(function(H){return H.name}),b=f.map(function(H){return H.prompt||H.name||""}),w=f.map(function(H){return H.align||"left"}),h=0;h<f.length;h+=1)k[f[h].name]=.7499990551181103*f[h].width;else Array.isArray(f)&&typeof f[0]=="string"&&(b=x=f,w=x.map(function(){return"left"}));if(T||Array.isArray(f)&&typeof f[0]=="string")for(h=0;h<x.length;h+=1){for(N[p=x[h]]=u.map(function(H){return H[p]}),this.setFont(void 0,"bold"),I.push(this.getTextDimensions(b[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),g=N[p],this.setFont(void 0,"normal"),y=0;y<g.length;y+=1)I.push(this.getTextDimensions(g[y],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);k[p]=Math.max.apply(null,I)+M+M,I=[]}if(S){var B={};for(h=0;h<x.length;h+=1)B[x[h]]={},B[x[h]].text=b[h],B[x[h]].align=w[h];var L=a.call(this,B,k);R=x.map(function(H){return new i(c,d,k[H],L,B[H].text,void 0,B[H].align)}),this.setTableHeaderRow(R),this.printHeaderRow(1,!1)}var D=f.reduce(function(H,W){return H[W.name]=W.align,H},{});for(h=0;h<u.length;h+=1){"rowStart"in m&&m.rowStart instanceof Function&&m.rowStart({row:h,data:u[h]},this);var V=a.call(this,u[h],k);for(y=0;y<x.length;y+=1){var O=u[h][x[y]];"cellStart"in m&&m.cellStart instanceof Function&&m.cellStart({row:h,col:y,data:O},this),l.call(this,new i(c,d,k[x[y]],V,O,h+2,D[x[y]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=d,this};var a=function(c,d){var u=this.internal.__cell__.padding,f=this.internal.__cell__.table_font_size,m=this.internal.scaleFactor;return Object.keys(c).map(function(h){var g=c[h];return this.splitTextToSize(g.hasOwnProperty("text")?g.text:g,d[h]-u-u)},this).map(function(h){return this.getLineHeightFactor()*h.length*f/m+u+u},this).reduce(function(h,g){return Math.max(h,g)},0)};e.setTableHeaderRow=function(c){r.call(this),this.internal.__cell__.tableHeaderRow=c},e.printHeaderRow=function(c,d){if(r.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var u;if(n=!0,typeof this.internal.__cell__.headerFunction=="function"){var f=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(f[0],f[1],f[2],f[3],void 0,-1)}this.setFont(void 0,"bold");for(var m=[],h=0;h<this.internal.__cell__.tableHeaderRow.length;h+=1){u=this.internal.__cell__.tableHeaderRow[h].clone(),d&&(u.y=this.internal.__cell__.margins.top||0,m.push(u)),u.lineNumber=c;var g=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),l.call(this,u),this.setTextColor(g)}m.length>0&&this.setTableHeaderRow(m),this.setFont(void 0,"normal"),n=!1}}(qt.API);var OO={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},FO=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],GN=$O(FO),DO=[100,200,300,400,500,600,700,800,900],ude=$O(DO);function xy(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),n=function(i){return OO[i=i||"normal"]?i:"normal"}(e.style),r=function(i){return i?typeof i=="number"?i>=100&&i<=900&&i%100==0?i:400:/^\d00$/.test(i)?parseInt(i):i==="bold"?700:400:400}(e.weight),s=function(i){return typeof GN[i=i||"normal"]=="number"?i:"normal"}(e.stretch);return{family:t,style:n,weight:r,stretch:s,src:e.src||[],ref:e.ref||{name:t,style:[s,n,r].join(" ")}}}function iA(e,t,n,r){var s;for(s=n;s>=0&&s<t.length;s+=r)if(e[t[s]])return e[t[s]];for(s=n;s>=0&&s<t.length;s-=r)if(e[t[s]])return e[t[s]]}var dde={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},aA={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function oA(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function lA(e){return e.trimLeft()}function fde(e,t){for(var n=0;n<e.length;){if(e.charAt(n)===t)return[e.substring(0,n),e.substring(n+1)];n+=1}return null}function hde(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var wp,cA,uA,_u,Np,dA,fA,hA,yy=["times"];function mA(e,t,n,r,s){var i=4,l=gA;switch(s){case qt.API.image_compression.FAST:i=1,l=pA;break;case qt.API.image_compression.MEDIUM:i=6,l=xA;break;case qt.API.image_compression.SLOW:i=9,l=yA}e=function(c,d,u,f){for(var m,h=c.length/d,g=new Uint8Array(c.length+h),y=[mde,pA,gA,xA,yA],p=0;p<h;p+=1){var x=p*d,b=c.subarray(x,x+d);if(f)g.set(f(b,u,m),x+p);else{for(var w=y.length,N=[],k=0;k<w;k+=1)N[k]=y[k](b,u,m);var I=gde(N.concat());g.set(N[I],x+p)}m=b}return g}(e,t,Math.ceil(n*r/8),l);var a=qN(e,{level:i});return qt.API.__addimage__.arrayBufferToBinaryString(a)}function mde(e){var t=Array.apply([],e);return t.unshift(0),t}function pA(e,t){var n=e.length,r=[];r[0]=1;for(var s=0;s<n;s+=1){var i=e[s-t]||0;r[s+1]=e[s]-i+256&255}return r}function gA(e,t,n){var r=e.length,s=[];s[0]=2;for(var i=0;i<r;i+=1){var l=n&&n[i]||0;s[i+1]=e[i]-l+256&255}return s}function xA(e,t,n){var r=e.length,s=[];s[0]=3;for(var i=0;i<r;i+=1){var l=e[i-t]||0,a=n&&n[i]||0;s[i+1]=e[i]+256-(l+a>>>1)&255}return s}function yA(e,t,n){var r=e.length,s=[];s[0]=4;for(var i=0;i<r;i+=1){var l=pde(e[i-t]||0,n&&n[i]||0,n&&n[i-t]||0);s[i+1]=e[i]-l+256&255}return s}function pde(e,t,n){if(e===t&&t===n)return e;var r=Math.abs(t-n),s=Math.abs(e-n),i=Math.abs(e+t-n-n);return r<=s&&r<=i?e:s<=i?t:n}function gde(e){var t=e.map(function(n){return n.reduce(function(r,s){return r+Math.abs(s)},0)});return t.indexOf(Math.min.apply(null,t))}function vy(e,t,n){var r=t*n,s=Math.floor(r/8),i=16-(r-8*s+n),l=(1<<n)-1;return qO(e,s)>>i&l}function vA(e,t,n,r){var s=n*r,i=Math.floor(s/8),l=16-(s-8*i+r),a=(1<<r)-1,c=(t&a)<<l;(function(d,u,f){if(u+1<d.byteLength)d.setUint16(u,f,!1);else{var m=f>>8&255;d.setUint8(u,m)}})(e,i,qO(e,i)&~(a<<l)&65535|c)}function qO(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function xde(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var n=e[t++]|e[t++]<<8,r=e[t++]|e[t++]<<8,s=e[t++],i=s>>7,l=1<<1+(7&s);e[t++],e[t++];var a=null,c=null;i&&(a=t,c=l,t+=3*l);var d=!0,u=[],f=0,m=null,h=0,g=null;for(this.width=n,this.height=r;d&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,g=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((_=e[t++])>=0))throw Error("Invalid block size");if(_===0)break;t+=_}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var y=e[t++];f=e[t++]|e[t++]<<8,m=e[t++],1&y||(m=null),h=y>>2&7,t++;break;case 254:for(;;){if(!((_=e[t++])>=0))throw Error("Invalid block size");if(_===0)break;t+=_}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var p=e[t++]|e[t++]<<8,x=e[t++]|e[t++]<<8,b=e[t++]|e[t++]<<8,w=e[t++]|e[t++]<<8,N=e[t++],k=N>>6&1,I=1<<1+(7&N),R=a,T=c,S=!1;N>>7&&(S=!0,R=t,T=I,t+=3*I);var E=t;for(t++;;){var _;if(!((_=e[t++])>=0))throw Error("Invalid block size");if(_===0)break;t+=_}u.push({x:p,y:x,width:b,height:w,has_local_palette:S,palette_offset:R,palette_size:T,data_offset:E,data_length:t-E,transparent_index:m,interlaced:!!k,delay:f,disposal:h});break;case 59:d=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return u.length},this.loopCount=function(){return g},this.frameInfo=function(M){if(M<0||M>=u.length)throw new Error("Frame index out of range.");return u[M]},this.decodeAndBlitFrameBGRA=function(M,A){var P=this.frameInfo(M),B=P.width*P.height,L=new Uint8Array(B);bA(e,P.data_offset,L,B);var D=P.palette_offset,V=P.transparent_index;V===null&&(V=256);var O=P.width,H=n-O,W=O,$=4*(P.y*n+P.x),z=4*((P.y+P.height)*n+P.x),q=$,G=4*H;P.interlaced===!0&&(G+=4*n*7);for(var re=8,oe=0,ie=L.length;oe<ie;++oe){var Y=L[oe];if(W===0&&(W=O,(q+=G)>=z&&(G=4*H+4*n*(re-1),q=$+(O+H)*(re<<1),re>>=1)),Y===V)q+=4;else{var te=e[D+3*Y],we=e[D+3*Y+1],me=e[D+3*Y+2];A[q++]=me,A[q++]=we,A[q++]=te,A[q++]=255}--W}},this.decodeAndBlitFrameRGBA=function(M,A){var P=this.frameInfo(M),B=P.width*P.height,L=new Uint8Array(B);bA(e,P.data_offset,L,B);var D=P.palette_offset,V=P.transparent_index;V===null&&(V=256);var O=P.width,H=n-O,W=O,$=4*(P.y*n+P.x),z=4*((P.y+P.height)*n+P.x),q=$,G=4*H;P.interlaced===!0&&(G+=4*n*7);for(var re=8,oe=0,ie=L.length;oe<ie;++oe){var Y=L[oe];if(W===0&&(W=O,(q+=G)>=z&&(G=4*H+4*n*(re-1),q=$+(O+H)*(re<<1),re>>=1)),Y===V)q+=4;else{var te=e[D+3*Y],we=e[D+3*Y+1],me=e[D+3*Y+2];A[q++]=te,A[q++]=we,A[q++]=me,A[q++]=255}--W}}}function bA(e,t,n,r){for(var s=e[t++],i=1<<s,l=i+1,a=l+1,c=s+1,d=(1<<c)-1,u=0,f=0,m=0,h=e[t++],g=new Int32Array(4096),y=null;;){for(;u<16&&h!==0;)f|=e[t++]<<u,u+=8,h===1?h=e[t++]:--h;if(u<c)break;var p=f&d;if(f>>=c,u-=c,p!==i){if(p===l)break;for(var x=p<a?p:y,b=0,w=x;w>i;)w=g[w]>>8,++b;var N=w;if(m+b+(x!==p?1:0)>r)return void Kn.log("Warning, gif stream longer than expected.");n[m++]=N;var k=m+=b;for(x!==p&&(n[m++]=N),w=x;b--;)w=g[w],n[--k]=255&w,w>>=8;y!==null&&a<4096&&(g[a++]=y<<8|N,a>=d+1&&c<12&&(++c,d=d<<1|1)),y=p}else a=l+1,d=(1<<(c=s+1))-1,y=null}return m!==r&&Kn.log("Warning, gif stream shorter than expected."),n}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function by(e){var t,n,r,s,i,l=Math.floor,a=new Array(64),c=new Array(64),d=new Array(64),u=new Array(64),f=new Array(65535),m=new Array(65535),h=new Array(64),g=new Array(64),y=[],p=0,x=7,b=new Array(64),w=new Array(64),N=new Array(64),k=new Array(256),I=new Array(2048),R=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],T=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],S=[0,1,2,3,4,5,6,7,8,9,10,11],E=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],_=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],M=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],A=[0,1,2,3,4,5,6,7,8,9,10,11],P=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],B=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function L($,z){for(var q=0,G=0,re=new Array,oe=1;oe<=16;oe++){for(var ie=1;ie<=$[oe];ie++)re[z[G]]=[],re[z[G]][0]=q,re[z[G]][1]=oe,G++,q++;q*=2}return re}function D($){for(var z=$[0],q=$[1]-1;q>=0;)z&1<<q&&(p|=1<<x),q--,--x<0&&(p==255?(V(255),V(0)):V(p),x=7,p=0)}function V($){y.push($)}function O($){V($>>8&255),V(255&$)}function H($,z,q,G,re){for(var oe,ie=re[0],Y=re[240],te=function(ge,Me){var _e,ke,se,Ae,Re,Ce,ve,Be,le,fe,Te=0;for(le=0;le<8;++le){_e=ge[Te],ke=ge[Te+1],se=ge[Te+2],Ae=ge[Te+3],Re=ge[Te+4],Ce=ge[Te+5],ve=ge[Te+6];var at=_e+(Be=ge[Te+7]),je=_e-Be,he=ke+ve,Pe=ke-ve,ot=se+Ce,tt=se-Ce,qe=Ae+Re,ze=Ae-Re,it=at+qe,st=at-qe,Ve=he+ot,ut=he-ot;ge[Te]=it+Ve,ge[Te+4]=it-Ve;var mt=.707106781*(ut+st);ge[Te+2]=st+mt,ge[Te+6]=st-mt;var Ht=.382683433*((it=ze+tt)-(ut=Pe+je)),Kt=.5411961*it+Ht,jn=1.306562965*ut+Ht,wn=.707106781*(Ve=tt+Pe),It=je+wn,Rr=je-wn;ge[Te+5]=Rr+Kt,ge[Te+3]=Rr-Kt,ge[Te+1]=It+jn,ge[Te+7]=It-jn,Te+=8}for(Te=0,le=0;le<8;++le){_e=ge[Te],ke=ge[Te+8],se=ge[Te+16],Ae=ge[Te+24],Re=ge[Te+32],Ce=ge[Te+40],ve=ge[Te+48];var Vr=_e+(Be=ge[Te+56]),Sr=_e-Be,We=ke+ve,Ue=ke-ve,pt=se+Ce,wt=se-Ce,Vt=Ae+Re,St=Ae-Re,bt=Vr+Vt,jt=Vr-Vt,an=We+pt,Mn=We-pt;ge[Te]=bt+an,ge[Te+32]=bt-an;var Xe=.707106781*(Mn+jt);ge[Te+16]=jt+Xe,ge[Te+48]=jt-Xe;var Zt=.382683433*((bt=St+wt)-(Mn=Ue+Sr)),yt=.5411961*bt+Zt,on=1.306562965*Mn+Zt,rn=.707106781*(an=wt+Ue),Qt=Sr+rn,vt=Sr-rn;ge[Te+40]=vt+yt,ge[Te+24]=vt-yt,ge[Te+8]=Qt+on,ge[Te+56]=Qt-on,Te++}for(le=0;le<64;++le)fe=ge[le]*Me[le],h[le]=fe>0?fe+.5|0:fe-.5|0;return h}($,z),we=0;we<64;++we)g[R[we]]=te[we];var me=g[0]-q;q=g[0],me==0?D(G[0]):(D(G[m[oe=32767+me]]),D(f[oe]));for(var Ee=63;Ee>0&&g[Ee]==0;)Ee--;if(Ee==0)return D(ie),q;for(var pe,ee=1;ee<=Ee;){for(var ft=ee;g[ee]==0&&ee<=Ee;)++ee;var $e=ee-ft;if($e>=16){pe=$e>>4;for(var De=1;De<=pe;++De)D(Y);$e&=15}oe=32767+g[ee],D(re[($e<<4)+m[oe]]),D(f[oe]),ee++}return Ee!=63&&D(ie),q}function W($){$=Math.min(Math.max($,1),100),i!=$&&(function(z){for(var q=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],G=0;G<64;G++){var re=l((q[G]*z+50)/100);re=Math.min(Math.max(re,1),255),a[R[G]]=re}for(var oe=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],ie=0;ie<64;ie++){var Y=l((oe[ie]*z+50)/100);Y=Math.min(Math.max(Y,1),255),c[R[ie]]=Y}for(var te=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],we=0,me=0;me<8;me++)for(var Ee=0;Ee<8;Ee++)d[we]=1/(a[R[we]]*te[me]*te[Ee]*8),u[we]=1/(c[R[we]]*te[me]*te[Ee]*8),we++}($<50?Math.floor(5e3/$):Math.floor(200-2*$)),i=$)}this.encode=function($,z){z&&W(z),y=new Array,p=0,x=7,O(65496),O(65504),O(16),V(74),V(70),V(73),V(70),V(0),V(1),V(1),V(0),O(1),O(1),V(0),V(0),function(){O(65499),O(132),V(0);for(var ke=0;ke<64;ke++)V(a[ke]);V(1);for(var se=0;se<64;se++)V(c[se])}(),function(ke,se){O(65472),O(17),V(8),O(se),O(ke),V(3),V(1),V(17),V(0),V(2),V(17),V(1),V(3),V(17),V(1)}($.width,$.height),function(){O(65476),O(418),V(0);for(var ke=0;ke<16;ke++)V(T[ke+1]);for(var se=0;se<=11;se++)V(S[se]);V(16);for(var Ae=0;Ae<16;Ae++)V(E[Ae+1]);for(var Re=0;Re<=161;Re++)V(_[Re]);V(1);for(var Ce=0;Ce<16;Ce++)V(M[Ce+1]);for(var ve=0;ve<=11;ve++)V(A[ve]);V(17);for(var Be=0;Be<16;Be++)V(P[Be+1]);for(var le=0;le<=161;le++)V(B[le])}(),O(65498),O(12),V(3),V(1),V(0),V(2),V(17),V(3),V(17),V(0),V(63),V(0);var q=0,G=0,re=0;p=0,x=7,this.encode.displayName="_encode_";for(var oe,ie,Y,te,we,me,Ee,pe,ee,ft=$.data,$e=$.width,De=$.height,ge=4*$e,Me=0;Me<De;){for(oe=0;oe<ge;){for(we=ge*Me+oe,Ee=-1,pe=0,ee=0;ee<64;ee++)me=we+(pe=ee>>3)*ge+(Ee=4*(7&ee)),Me+pe>=De&&(me-=ge*(Me+1+pe-De)),oe+Ee>=ge&&(me-=oe+Ee-ge+4),ie=ft[me++],Y=ft[me++],te=ft[me++],b[ee]=(I[ie]+I[Y+256|0]+I[te+512|0]>>16)-128,w[ee]=(I[ie+768|0]+I[Y+1024|0]+I[te+1280|0]>>16)-128,N[ee]=(I[ie+1280|0]+I[Y+1536|0]+I[te+1792|0]>>16)-128;q=H(b,d,q,t,r),G=H(w,u,G,n,s),re=H(N,u,re,n,s),oe+=32}Me+=8}if(x>=0){var _e=[];_e[1]=x+1,_e[0]=(1<<x+1)-1,D(_e)}return O(65497),new Uint8Array(y)},e=e||50,function(){for(var $=String.fromCharCode,z=0;z<256;z++)k[z]=$(z)}(),t=L(T,S),n=L(M,A),r=L(E,_),s=L(P,B),function(){for(var $=1,z=2,q=1;q<=15;q++){for(var G=$;G<z;G++)m[32767+G]=q,f[32767+G]=[],f[32767+G][1]=q,f[32767+G][0]=G;for(var re=-(z-1);re<=-$;re++)m[32767+re]=q,f[32767+re]=[],f[32767+re][1]=q,f[32767+re][0]=z-1+re;$<<=1,z<<=1}}(),function(){for(var $=0;$<256;$++)I[$]=19595*$,I[$+256|0]=38470*$,I[$+512|0]=7471*$+32768,I[$+768|0]=-11059*$,I[$+1024|0]=-21709*$,I[$+1280|0]=32768*$+8421375,I[$+1536|0]=-27439*$,I[$+1792|0]=-5329*$}(),W(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Xi(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function wA(e){function t(S){if(!S)throw Error("assert :P")}function n(S,E,_){for(var M=0;4>M;M++)if(S[E+M]!=_.charCodeAt(M))return!0;return!1}function r(S,E,_,M,A){for(var P=0;P<A;P++)S[E+P]=_[M+P]}function s(S,E,_,M){for(var A=0;A<M;A++)S[E+A]=_}function i(S){return new Int32Array(S)}function l(S,E){for(var _=[],M=0;M<S;M++)_.push(new E);return _}function a(S,E){var _=[];return function M(A,P,B){for(var L=B[P],D=0;D<L&&(A.push(B.length>P+1?[]:new E),!(B.length<P+1));D++)M(A[D],P+1,B)}(_,0,S),_}var c=function(){var S=this;function E(v,j){for(var F=1<<j-1>>>0;v&F;)F>>>=1;return F?(v&F-1)+F:v}function _(v,j,F,U,K){t(!(U%F));do v[j+(U-=F)]=K;while(0<U)}function M(v,j,F,U,K){if(t(2328>=K),512>=K)var Z=i(512);else if((Z=i(K))==null)return 0;return function(Q,ne,ae,ce,Ne,Fe){var ue,Se,Le=ne,Ge=1<<ae,Oe=i(16),Ye=i(16);for(t(Ne!=0),t(ce!=null),t(Q!=null),t(0<ae),Se=0;Se<Ne;++Se){if(15<ce[Se])return 0;++Oe[ce[Se]]}if(Oe[0]==Ne)return 0;for(Ye[1]=0,ue=1;15>ue;++ue){if(Oe[ue]>1<<ue)return 0;Ye[ue+1]=Ye[ue]+Oe[ue]}for(Se=0;Se<Ne;++Se)ue=ce[Se],0<ce[Se]&&(Fe[Ye[ue]++]=Se);if(Ye[15]==1)return(ce=new A).g=0,ce.value=Fe[0],_(Q,Le,1,Ge,ce),Ge;var Qe,dt=-1,lt=Ge-1,Dt=0,Et=1,pn=1,Lt=1<<ae;for(Se=0,ue=1,Ne=2;ue<=ae;++ue,Ne<<=1){if(Et+=pn<<=1,0>(pn-=Oe[ue]))return 0;for(;0<Oe[ue];--Oe[ue])(ce=new A).g=ue,ce.value=Fe[Se++],_(Q,Le+Dt,Ne,Lt,ce),Dt=E(Dt,ue)}for(ue=ae+1,Ne=2;15>=ue;++ue,Ne<<=1){if(Et+=pn<<=1,0>(pn-=Oe[ue]))return 0;for(;0<Oe[ue];--Oe[ue]){if(ce=new A,(Dt&lt)!=dt){for(Le+=Lt,Qe=1<<(dt=ue)-ae;15>dt&&!(0>=(Qe-=Oe[dt]));)++dt,Qe<<=1;Ge+=Lt=1<<(Qe=dt-ae),Q[ne+(dt=Dt&lt)].g=Qe+ae,Q[ne+dt].value=Le-ne-dt}ce.g=ue-ae,ce.value=Fe[Se++],_(Q,Le+(Dt>>ae),Ne,Lt,ce),Dt=E(Dt,ue)}}return Et!=2*Ye[15]-1?0:Ge}(v,j,F,U,K,Z)}function A(){this.value=this.g=0}function P(){this.value=this.g=0}function B(){this.G=l(5,A),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=l(Vl,P)}function L(v,j,F,U){t(v!=null),t(j!=null),t(2147483648>U),v.Ca=254,v.I=0,v.b=-8,v.Ka=0,v.oa=j,v.pa=F,v.Jd=j,v.Yc=F+U,v.Zc=4<=U?F+U-4+1:F,ie(v)}function D(v,j){for(var F=0;0<j--;)F|=te(v,128)<<j;return F}function V(v,j){var F=D(v,j);return Y(v)?-F:F}function O(v,j,F,U){var K,Z=0;for(t(v!=null),t(j!=null),t(4294967288>U),v.Sb=U,v.Ra=0,v.u=0,v.h=0,4<U&&(U=4),K=0;K<U;++K)Z+=j[F+K]<<8*K;v.Ra=Z,v.bb=U,v.oa=j,v.pa=F}function H(v){for(;8<=v.u&&v.bb<v.Sb;)v.Ra>>>=8,v.Ra+=v.oa[v.pa+v.bb]<<$o-8>>>0,++v.bb,v.u-=8;G(v)&&(v.h=1,v.u=0)}function W(v,j){if(t(0<=j),!v.h&&j<=ii){var F=q(v)&si[j];return v.u+=j,H(v),F}return v.h=1,v.u=0}function $(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function z(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function q(v){return v.Ra>>>(v.u&$o-1)>>>0}function G(v){return t(v.bb<=v.Sb),v.h||v.bb==v.Sb&&v.u>$o}function re(v,j){v.u=j,v.h=G(v)}function oe(v){v.u>=Ja&&(t(v.u>=Ja),H(v))}function ie(v){t(v!=null&&v.oa!=null),v.pa<v.Zc?(v.I=(v.oa[v.pa++]|v.I<<8)>>>0,v.b+=8):(t(v!=null&&v.oa!=null),v.pa<v.Yc?(v.b+=8,v.I=v.oa[v.pa++]|v.I<<8):v.Ka?v.b=0:(v.I<<=8,v.b+=8,v.Ka=1))}function Y(v){return D(v,1)}function te(v,j){var F=v.Ca;0>v.b&&ie(v);var U=v.b,K=F*j>>>8,Z=(v.I>>>U>K)+0;for(Z?(F-=K,v.I-=K+1<<U>>>0):F=K+1,U=F,K=0;256<=U;)K+=8,U>>=8;return U=7^K+Oo[U],v.b-=U,v.Ca=(F<<U)-1,Z}function we(v,j,F){v[j+0]=F>>24&255,v[j+1]=F>>16&255,v[j+2]=F>>8&255,v[j+3]=255&F}function me(v,j){return v[j+0]|v[j+1]<<8}function Ee(v,j){return me(v,j)|v[j+2]<<16}function pe(v,j){return me(v,j)|me(v,j+2)<<16}function ee(v,j){var F=1<<j;return t(v!=null),t(0<j),v.X=i(F),v.X==null?0:(v.Mb=32-j,v.Xa=j,1)}function ft(v,j){t(v!=null),t(j!=null),t(v.Xa==j.Xa),r(j.X,0,v.X,0,1<<j.Xa)}function $e(){this.X=[],this.Xa=this.Mb=0}function De(v,j,F,U){t(F!=null),t(U!=null);var K=F[0],Z=U[0];return K==0&&(K=(v*Z+j/2)/j),Z==0&&(Z=(j*K+v/2)/v),0>=K||0>=Z?0:(F[0]=K,U[0]=Z,1)}function ge(v,j){return v+(1<<j)-1>>>j}function Me(v,j){return((4278255360&v)+(4278255360&j)>>>0&4278255360)+((16711935&v)+(16711935&j)>>>0&16711935)>>>0}function _e(v,j){S[j]=function(F,U,K,Z,Q,ne,ae){var ce;for(ce=0;ce<Q;++ce){var Ne=S[v](ne[ae+ce-1],K,Z+ce);ne[ae+ce]=Me(F[U+ce],Ne)}}}function ke(){this.ud=this.hd=this.jd=0}function se(v,j){return((4278124286&(v^j))>>>1)+(v&j)>>>0}function Ae(v){return 0<=v&&256>v?v:0>v?0:255<v?255:void 0}function Re(v,j){return Ae(v+(v-j+.5>>1))}function Ce(v,j,F){return Math.abs(j-F)-Math.abs(v-F)}function ve(v,j,F,U,K,Z,Q){for(U=Z[Q-1],F=0;F<K;++F)Z[Q+F]=U=Me(v[j+F],U)}function Be(v,j,F,U,K){var Z;for(Z=0;Z<F;++Z){var Q=v[j+Z],ne=Q>>8&255,ae=16711935&(ae=(ae=16711935&Q)+((ne<<16)+ne));U[K+Z]=(4278255360&Q)+ae>>>0}}function le(v,j){j.jd=255&v,j.hd=v>>8&255,j.ud=v>>16&255}function fe(v,j,F,U,K,Z){var Q;for(Q=0;Q<U;++Q){var ne=j[F+Q],ae=ne>>>8,ce=ne,Ne=255&(Ne=(Ne=ne>>>16)+((v.jd<<24>>24)*(ae<<24>>24)>>>5));ce=255&(ce=(ce+=(v.hd<<24>>24)*(ae<<24>>24)>>>5)+((v.ud<<24>>24)*(Ne<<24>>24)>>>5)),K[Z+Q]=(4278255360&ne)+(Ne<<16)+ce}}function Te(v,j,F,U,K){S[j]=function(Z,Q,ne,ae,ce,Ne,Fe,ue,Se){for(ae=Fe;ae<ue;++ae)for(Fe=0;Fe<Se;++Fe)ce[Ne++]=K(ne[U(Z[Q++])])},S[v]=function(Z,Q,ne,ae,ce,Ne,Fe){var ue=8>>Z.b,Se=Z.Ea,Le=Z.K[0],Ge=Z.w;if(8>ue)for(Z=(1<<Z.b)-1,Ge=(1<<ue)-1;Q<ne;++Q){var Oe,Ye=0;for(Oe=0;Oe<Se;++Oe)Oe&Z||(Ye=U(ae[ce++])),Ne[Fe++]=K(Le[Ye&Ge]),Ye>>=ue}else S["VP8LMapColor"+F](ae,ce,Le,Ge,Ne,Fe,Q,ne,Se)}}function at(v,j,F,U,K){for(F=j+F;j<F;){var Z=v[j++];U[K++]=Z>>16&255,U[K++]=Z>>8&255,U[K++]=255&Z}}function je(v,j,F,U,K){for(F=j+F;j<F;){var Z=v[j++];U[K++]=Z>>16&255,U[K++]=Z>>8&255,U[K++]=255&Z,U[K++]=Z>>24&255}}function he(v,j,F,U,K){for(F=j+F;j<F;){var Z=(Q=v[j++])>>16&240|Q>>12&15,Q=240&Q|Q>>28&15;U[K++]=Z,U[K++]=Q}}function Pe(v,j,F,U,K){for(F=j+F;j<F;){var Z=(Q=v[j++])>>16&248|Q>>13&7,Q=Q>>5&224|Q>>3&31;U[K++]=Z,U[K++]=Q}}function ot(v,j,F,U,K){for(F=j+F;j<F;){var Z=v[j++];U[K++]=255&Z,U[K++]=Z>>8&255,U[K++]=Z>>16&255}}function tt(v,j,F,U,K,Z){if(Z==0)for(F=j+F;j<F;)we(U,((Z=v[j++])[0]>>24|Z[1]>>8&65280|Z[2]<<8&16711680|Z[3]<<24)>>>0),K+=32;else r(U,K,v,j,F)}function qe(v,j){S[j][0]=S[v+"0"],S[j][1]=S[v+"1"],S[j][2]=S[v+"2"],S[j][3]=S[v+"3"],S[j][4]=S[v+"4"],S[j][5]=S[v+"5"],S[j][6]=S[v+"6"],S[j][7]=S[v+"7"],S[j][8]=S[v+"8"],S[j][9]=S[v+"9"],S[j][10]=S[v+"10"],S[j][11]=S[v+"11"],S[j][12]=S[v+"12"],S[j][13]=S[v+"13"],S[j][14]=S[v+"0"],S[j][15]=S[v+"0"]}function ze(v){return v==R1||v==$1||v==Em||v==O1}function it(){this.eb=[],this.size=this.A=this.fb=0}function st(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function Ve(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new it,this.f.kb=new st,this.sd=null}function ut(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function mt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function Ht(v){return alert("todo:WebPSamplerProcessPlane"),v.T}function Kt(v,j){var F=v.T,U=j.ba.f.RGBA,K=U.eb,Z=U.fb+v.ka*U.A,Q=Ci[j.ba.S],ne=v.y,ae=v.O,ce=v.f,Ne=v.N,Fe=v.ea,ue=v.W,Se=j.cc,Le=j.dc,Ge=j.Mc,Oe=j.Nc,Ye=v.ka,Qe=v.ka+v.T,dt=v.U,lt=dt+1>>1;for(Ye==0?Q(ne,ae,null,null,ce,Ne,Fe,ue,ce,Ne,Fe,ue,K,Z,null,null,dt):(Q(j.ec,j.fc,ne,ae,Se,Le,Ge,Oe,ce,Ne,Fe,ue,K,Z-U.A,K,Z,dt),++F);Ye+2<Qe;Ye+=2)Se=ce,Le=Ne,Ge=Fe,Oe=ue,Ne+=v.Rc,ue+=v.Rc,Z+=2*U.A,Q(ne,(ae+=2*v.fa)-v.fa,ne,ae,Se,Le,Ge,Oe,ce,Ne,Fe,ue,K,Z-U.A,K,Z,dt);return ae+=v.fa,v.j+Qe<v.o?(r(j.ec,j.fc,ne,ae,dt),r(j.cc,j.dc,ce,Ne,lt),r(j.Mc,j.Nc,Fe,ue,lt),F--):1&Qe||Q(ne,ae,null,null,ce,Ne,Fe,ue,ce,Ne,Fe,ue,K,Z+U.A,null,null,dt),F}function jn(v,j,F){var U=v.F,K=[v.J];if(U!=null){var Z=v.U,Q=j.ba.S,ne=Q==km||Q==Em;j=j.ba.f.RGBA;var ae=[0],ce=v.ka;ae[0]=v.T,v.Kb&&(ce==0?--ae[0]:(--ce,K[0]-=v.width),v.j+v.ka+v.T==v.o&&(ae[0]=v.o-v.j-ce));var Ne=j.eb;ce=j.fb+ce*j.A,v=Ij(U,K[0],v.width,Z,ae,Ne,ce+(ne?0:3),j.A),t(F==ae),v&&ze(Q)&&Kd(Ne,ce,ne,Z,ae,j.A)}return 0}function wn(v){var j=v.ma,F=j.ba.S,U=11>F,K=F==Sm||F==Am||F==km||F==M1||F==12||ze(F);if(j.memory=null,j.Ib=null,j.Jb=null,j.Nd=null,!zd(j.Oa,v,K?11:12))return 0;if(K&&ze(F)&&vm(),v.da)alert("todo:use_scaling");else{if(U){if(j.Ib=Ht,v.Kb){if(F=v.U+1>>1,j.memory=i(v.U+2*F),j.memory==null)return 0;j.ec=j.memory,j.fc=0,j.cc=j.ec,j.dc=j.fc+v.U,j.Mc=j.cc,j.Nc=j.dc+F,j.Ib=Kt,vm()}}else alert("todo:EmitYUV");K&&(j.Jb=jn,U&&Si())}if(U&&!Gj){for(v=0;256>v;++v)zD[v]=89858*(v-128)+Pm>>Cm,VD[v]=-22014*(v-128)+Pm,HD[v]=-45773*(v-128),UD[v]=113618*(v-128)+Pm>>Cm;for(v=Zd;v<q1;++v)j=76283*(v-16)+Pm>>Cm,WD[v-Zd]=pr(j,255),GD[v-Zd]=pr(j+8>>4,15);Gj=1}return 1}function It(v){var j=v.ma,F=v.U,U=v.T;return t(!(1&v.ka)),0>=F||0>=U?0:(F=j.Ib(v,j),j.Jb!=null&&j.Jb(v,j,F),j.Dc+=F,1)}function Rr(v){v.ma.memory=null}function Vr(v,j,F,U){return W(v,8)!=47?0:(j[0]=W(v,14)+1,F[0]=W(v,14)+1,U[0]=W(v,1),W(v,3)!=0?0:!v.h)}function Sr(v,j){if(4>v)return v+1;var F=v-2>>1;return(2+(1&v)<<F)+W(j,F)+1}function We(v,j){return 120<j?j-120:1<=(F=((F=ED[j-1])>>4)*v+(8-(15&F)))?F:1;var F}function Ue(v,j,F){var U=q(F),K=v[j+=255&U].g-8;return 0<K&&(re(F,F.u+8),U=q(F),j+=v[j].value,j+=U&(1<<K)-1),re(F,F.u+v[j].g),v[j].value}function pt(v,j,F){return F.g+=v.g,F.value+=v.value<<j>>>0,t(8>=F.g),v.g}function wt(v,j,F){var U=v.xc;return t((j=U==0?0:v.vc[v.md*(F>>U)+(j>>U)])<v.Wb),v.Ya[j]}function Vt(v,j,F,U){var K=v.ab,Z=v.c*j,Q=v.C;j=Q+j;var ne=F,ae=U;for(U=v.Ta,F=v.Ua;0<K--;){var ce=v.gc[K],Ne=Q,Fe=j,ue=ne,Se=ae,Le=(ae=U,ne=F,ce.Ea);switch(t(Ne<Fe),t(Fe<=ce.nc),ce.hc){case 2:Ar(ue,Se,(Fe-Ne)*Le,ae,ne);break;case 0:var Ge=Ne,Oe=Fe,Ye=ae,Qe=ne,dt=(Lt=ce).Ea;Ge==0&&(Hd(ue,Se,null,null,1,Ye,Qe),ve(ue,Se+1,0,0,dt-1,Ye,Qe+1),Se+=dt,Qe+=dt,++Ge);for(var lt=1<<Lt.b,Dt=lt-1,Et=ge(dt,Lt.b),pn=Lt.K,Lt=Lt.w+(Ge>>Lt.b)*Et;Ge<Oe;){var _n=pn,Yr=Lt,gn=1;for(ou(ue,Se,Ye,Qe-dt,1,Ye,Qe);gn<dt;){var Mt=(gn&~Dt)+lt;Mt>dt&&(Mt=dt),(0,Wd[_n[Yr++]>>8&15])(ue,Se+ +gn,Ye,Qe+gn-dt,Mt-gn,Ye,Qe+gn),gn=Mt}Se+=dt,Qe+=dt,++Ge&Dt||(Lt+=Et)}Fe!=ce.nc&&r(ae,ne-Le,ae,ne+(Fe-Ne-1)*Le,Le);break;case 1:for(Le=ue,Oe=Se,dt=(ue=ce.Ea)-(Qe=ue&~(Ye=(Se=1<<ce.b)-1)),Ge=ge(ue,ce.b),lt=ce.K,ce=ce.w+(Ne>>ce.b)*Ge;Ne<Fe;){for(Dt=lt,Et=ce,pn=new ke,Lt=Oe+Qe,_n=Oe+ue;Oe<Lt;)le(Dt[Et++],pn),Gd(pn,Le,Oe,Se,ae,ne),Oe+=Se,ne+=Se;Oe<_n&&(le(Dt[Et++],pn),Gd(pn,Le,Oe,dt,ae,ne),Oe+=dt,ne+=dt),++Ne&Ye||(ce+=Ge)}break;case 3:if(ue==ae&&Se==ne&&0<ce.b){for(Oe=ae,ue=Le=ne+(Fe-Ne)*Le-(Qe=(Fe-Ne)*ge(ce.Ea,ce.b)),Se=ae,Ye=ne,Ge=[],Qe=(dt=Qe)-1;0<=Qe;--Qe)Ge[Qe]=Se[Ye+Qe];for(Qe=dt-1;0<=Qe;--Qe)Oe[ue+Qe]=Ge[Qe];wm(ce,Ne,Fe,ae,Le,ae,ne)}else wm(ce,Ne,Fe,ue,Se,ae,ne)}ne=U,ae=F}ae!=F&&r(U,F,ne,ae,Z)}function St(v,j){var F=v.V,U=v.Ba+v.c*v.C,K=j-v.C;if(t(j<=v.l.o),t(16>=K),0<K){var Z=v.l,Q=v.Ta,ne=v.Ua,ae=Z.width;if(Vt(v,K,F,U),K=ne=[ne],t((F=v.C)<(U=j)),t(Z.v<Z.va),U>Z.o&&(U=Z.o),F<Z.j){var ce=Z.j-F;F=Z.j,K[0]+=ce*ae}if(F>=U?F=0:(K[0]+=4*Z.v,Z.ka=F-Z.j,Z.U=Z.va-Z.v,Z.T=U-F,F=1),F){if(ne=ne[0],11>(F=v.ca).S){var Ne=F.f.RGBA,Fe=(U=F.S,K=Z.U,Z=Z.T,ce=Ne.eb,Ne.A),ue=Z;for(Ne=Ne.fb+v.Ma*Ne.A;0<ue--;){var Se=Q,Le=ne,Ge=K,Oe=ce,Ye=Ne;switch(U){case _m:Yd(Se,Le,Ge,Oe,Ye);break;case Sm:Fo(Se,Le,Ge,Oe,Ye);break;case R1:Fo(Se,Le,Ge,Oe,Ye),Kd(Oe,Ye,0,Ge,1,0);break;case Fj:Wl(Se,Le,Ge,Oe,Ye);break;case Am:tt(Se,Le,Ge,Oe,Ye,1);break;case $1:tt(Se,Le,Ge,Oe,Ye,1),Kd(Oe,Ye,0,Ge,1,0);break;case km:tt(Se,Le,Ge,Oe,Ye,0);break;case Em:tt(Se,Le,Ge,Oe,Ye,0),Kd(Oe,Ye,1,Ge,1,0);break;case M1:Do(Se,Le,Ge,Oe,Ye);break;case O1:Do(Se,Le,Ge,Oe,Ye),Pj(Oe,Ye,Ge,1,0);break;case Dj:qo(Se,Le,Ge,Oe,Ye);break;default:t(0)}ne+=ae,Ne+=Fe}v.Ma+=Z}else alert("todo:EmitRescaledRowsYUVA");t(v.Ma<=F.height)}}v.C=j,t(v.C<=v.i)}function bt(v){var j;if(0<v.ua)return 0;for(j=0;j<v.Wb;++j){var F=v.Ya[j].G,U=v.Ya[j].H;if(0<F[1][U[1]+0].g||0<F[2][U[2]+0].g||0<F[3][U[3]+0].g)return 0}return 1}function jt(v,j,F,U,K,Z){if(v.Z!=0){var Q=v.qd,ne=v.rd;for(t(Uo[v.Z]!=null);j<F;++j)Uo[v.Z](Q,ne,U,K,U,K,Z),Q=U,ne=K,K+=Z;v.qd=Q,v.rd=ne}}function an(v,j){var F=v.l.ma,U=F.Z==0||F.Z==1?v.l.j:v.C;if(U=v.C<U?U:v.C,t(j<=v.l.o),j>U){var K=v.l.width,Z=F.ca,Q=F.tb+K*U,ne=v.V,ae=v.Ba+v.c*U,ce=v.gc;t(v.ab==1),t(ce[0].hc==3),ya(ce[0],U,j,ne,ae,Z,Q),jt(F,U,j,Z,Q,K)}v.C=v.Ma=j}function Mn(v,j,F,U,K,Z,Q){var ne=v.$/U,ae=v.$%U,ce=v.m,Ne=v.s,Fe=F+v.$,ue=Fe;K=F+U*K;var Se=F+U*Z,Le=280+Ne.ua,Ge=v.Pb?ne:16777216,Oe=0<Ne.ua?Ne.Wa:null,Ye=Ne.wc,Qe=Fe<Se?wt(Ne,ae,ne):null;t(v.C<Z),t(Se<=K);var dt=!1;e:for(;;){for(;dt||Fe<Se;){var lt=0;if(ne>=Ge){var Dt=Fe-F;t((Ge=v).Pb),Ge.wd=Ge.m,Ge.xd=Dt,0<Ge.s.ua&&ft(Ge.s.Wa,Ge.s.vb),Ge=ne+PD}if(ae&Ye||(Qe=wt(Ne,ae,ne)),t(Qe!=null),Qe.Qb&&(j[Fe]=Qe.qb,dt=!0),!dt)if(oe(ce),Qe.jc){lt=ce,Dt=j;var Et=Fe,pn=Qe.pd[q(lt)&Vl-1];t(Qe.jc),256>pn.g?(re(lt,lt.u+pn.g),Dt[Et]=pn.value,lt=0):(re(lt,lt.u+pn.g-256),t(256<=pn.value),lt=pn.value),lt==0&&(dt=!0)}else lt=Ue(Qe.G[0],Qe.H[0],ce);if(ce.h)break;if(dt||256>lt){if(!dt)if(Qe.nd)j[Fe]=(Qe.qb|lt<<8)>>>0;else{if(oe(ce),dt=Ue(Qe.G[1],Qe.H[1],ce),oe(ce),Dt=Ue(Qe.G[2],Qe.H[2],ce),Et=Ue(Qe.G[3],Qe.H[3],ce),ce.h)break;j[Fe]=(Et<<24|dt<<16|lt<<8|Dt)>>>0}if(dt=!1,++Fe,++ae>=U&&(ae=0,++ne,Q!=null&&ne<=Z&&!(ne%16)&&Q(v,ne),Oe!=null))for(;ue<Fe;)lt=j[ue++],Oe.X[(506832829*lt&4294967295)>>>Oe.Mb]=lt}else if(280>lt){if(lt=Sr(lt-256,ce),Dt=Ue(Qe.G[4],Qe.H[4],ce),oe(ce),Dt=We(U,Dt=Sr(Dt,ce)),ce.h)break;if(Fe-F<Dt||K-Fe<lt)break e;for(Et=0;Et<lt;++Et)j[Fe+Et]=j[Fe+Et-Dt];for(Fe+=lt,ae+=lt;ae>=U;)ae-=U,++ne,Q!=null&&ne<=Z&&!(ne%16)&&Q(v,ne);if(t(Fe<=K),ae&Ye&&(Qe=wt(Ne,ae,ne)),Oe!=null)for(;ue<Fe;)lt=j[ue++],Oe.X[(506832829*lt&4294967295)>>>Oe.Mb]=lt}else{if(!(lt<Le))break e;for(dt=lt-280,t(Oe!=null);ue<Fe;)lt=j[ue++],Oe.X[(506832829*lt&4294967295)>>>Oe.Mb]=lt;lt=Fe,t(!(dt>>>(Dt=Oe).Xa)),j[lt]=Dt.X[dt],dt=!0}dt||t(ce.h==G(ce))}if(v.Pb&&ce.h&&Fe<K)t(v.m.h),v.a=5,v.m=v.wd,v.$=v.xd,0<v.s.ua&&ft(v.s.vb,v.s.Wa);else{if(ce.h)break e;Q!=null&&Q(v,ne>Z?Z:ne),v.a=0,v.$=Fe-F}return 1}return v.a=3,0}function Xe(v){t(v!=null),v.vc=null,v.yc=null,v.Ya=null;var j=v.Wa;j!=null&&(j.X=null),v.vb=null,t(v!=null)}function Zt(){var v=new Ot;return v==null?null:(v.a=0,v.xb=zj,qe("Predictor","VP8LPredictors"),qe("Predictor","VP8LPredictors_C"),qe("PredictorAdd","VP8LPredictorsAdd"),qe("PredictorAdd","VP8LPredictorsAdd_C"),Ar=Be,Gd=fe,Yd=at,Fo=je,Do=he,qo=Pe,Wl=ot,S.VP8LMapColor32b=xa,S.VP8LMapColor8b=Vd,v)}function yt(v,j,F,U,K){var Z=1,Q=[v],ne=[j],ae=U.m,ce=U.s,Ne=null,Fe=0;e:for(;;){if(F)for(;Z&&W(ae,1);){var ue=Q,Se=ne,Le=U,Ge=1,Oe=Le.m,Ye=Le.gc[Le.ab],Qe=W(Oe,2);if(Le.Oc&1<<Qe)Z=0;else{switch(Le.Oc|=1<<Qe,Ye.hc=Qe,Ye.Ea=ue[0],Ye.nc=Se[0],Ye.K=[null],++Le.ab,t(4>=Le.ab),Qe){case 0:case 1:Ye.b=W(Oe,3)+2,Ge=yt(ge(Ye.Ea,Ye.b),ge(Ye.nc,Ye.b),0,Le,Ye.K),Ye.K=Ye.K[0];break;case 3:var dt,lt=W(Oe,8)+1,Dt=16<lt?0:4<lt?1:2<lt?2:3;if(ue[0]=ge(Ye.Ea,Dt),Ye.b=Dt,dt=Ge=yt(lt,1,0,Le,Ye.K)){var Et,pn=lt,Lt=Ye,_n=1<<(8>>Lt.b),Yr=i(_n);if(Yr==null)dt=0;else{var gn=Lt.K[0],Mt=Lt.w;for(Yr[0]=Lt.K[0][0],Et=1;Et<1*pn;++Et)Yr[Et]=Me(gn[Mt+Et],Yr[Et-1]);for(;Et<4*_n;++Et)Yr[Et]=0;Lt.K[0]=null,Lt.K[0]=Yr,dt=1}}Ge=dt;break;case 2:break;default:t(0)}Z=Ge}}if(Q=Q[0],ne=ne[0],Z&&W(ae,1)&&!(Z=1<=(Fe=W(ae,4))&&11>=Fe)){U.a=3;break e}var Nt;if(Nt=Z)t:{var Er,fn,An,nr=U,cs=Q,Is=ne,gr=Fe,xs=F,Ts=nr.m,Xr=nr.s,Cn=[null],zn=1,xr=0,Un=CD[gr];n:for(;;){if(xs&&W(Ts,1)){var us=W(Ts,3)+2,Gi=ge(cs,us),Cr=ge(Is,us),Ws=Gi*Cr;if(!yt(Gi,Cr,0,nr,Cn))break n;for(Cn=Cn[0],Xr.xc=us,Er=0;Er<Ws;++Er){var Xn=Cn[Er]>>8&65535;Cn[Er]=Xn,Xn>=zn&&(zn=Xn+1)}}if(Ts.h)break n;for(fn=0;5>fn;++fn){var Kr=qj[fn];!fn&&0<gr&&(Kr+=1<<gr),xr<Kr&&(xr=Kr)}var oi=l(zn*Un,A),Ls=zn,li=l(Ls,B);if(li==null)var ci=null;else t(65536>=Ls),ci=li;var Gs=i(xr);if(ci==null||Gs==null||oi==null){nr.a=1;break n}var ui=oi;for(Er=An=0;Er<zn;++Er){var er=ci[Er],di=er.G,Yi=er.H,Yl=0,eo=1,ds=0;for(fn=0;5>fn;++fn){Kr=qj[fn],di[fn]=ui,Yi[fn]=An,!fn&&0<gr&&(Kr+=1<<gr);s:{var Tm,B1=Kr,Lm=nr,Qd=Gs,KD=ui,JD=An,z1=0,Ho=Lm.m,ZD=W(Ho,1);if(s(Qd,0,0,B1),ZD){var QD=W(Ho,1)+1,eq=W(Ho,1),Kj=W(Ho,eq==0?1:8);Qd[Kj]=1,QD==2&&(Qd[Kj=W(Ho,8)]=1);var Mm=1}else{var Jj=i(19),Zj=W(Ho,4)+4;if(19<Zj){Lm.a=3;var Rm=0;break s}for(Tm=0;Tm<Zj;++Tm)Jj[kD[Tm]]=W(Ho,3);var U1=void 0,ef=void 0,Qj=Lm,tq=Jj,$m=B1,e_=Qd,H1=0,Vo=Qj.m,t_=8,n_=l(128,A);r:for(;M(n_,0,7,tq,19);){if(W(Vo,1)){var nq=2+2*W(Vo,3);if((U1=2+W(Vo,nq))>$m)break r}else U1=$m;for(ef=0;ef<$m&&U1--;){oe(Vo);var r_=n_[0+(127&q(Vo))];re(Vo,Vo.u+r_.g);var cu=r_.value;if(16>cu)e_[ef++]=cu,cu!=0&&(t_=cu);else{var rq=cu==16,s_=cu-16,sq=SD[s_],i_=W(Vo,_D[s_])+sq;if(ef+i_>$m)break r;for(var iq=rq?t_:0;0<i_--;)e_[ef++]=iq}}H1=1;break r}H1||(Qj.a=3),Mm=H1}(Mm=Mm&&!Ho.h)&&(z1=M(KD,JD,8,Qd,B1)),Mm&&z1!=0?Rm=z1:(Lm.a=3,Rm=0)}if(Rm==0)break n;if(eo&&AD[fn]==1&&(eo=ui[An].g==0),Yl+=ui[An].g,An+=Rm,3>=fn){var tf,V1=Gs[0];for(tf=1;tf<Kr;++tf)Gs[tf]>V1&&(V1=Gs[tf]);ds+=V1}}if(er.nd=eo,er.Qb=0,eo&&(er.qb=(di[3][Yi[3]+0].value<<24|di[1][Yi[1]+0].value<<16|di[2][Yi[2]+0].value)>>>0,Yl==0&&256>di[0][Yi[0]+0].value&&(er.Qb=1,er.qb+=di[0][Yi[0]+0].value<<8)),er.jc=!er.Qb&&6>ds,er.jc){var Om,to=er;for(Om=0;Om<Vl;++Om){var Wo=Om,Go=to.pd[Wo],Fm=to.G[0][to.H[0]+Wo];256<=Fm.value?(Go.g=Fm.g+256,Go.value=Fm.value):(Go.g=0,Go.value=0,Wo>>=pt(Fm,8,Go),Wo>>=pt(to.G[1][to.H[1]+Wo],16,Go),Wo>>=pt(to.G[2][to.H[2]+Wo],0,Go),pt(to.G[3][to.H[3]+Wo],24,Go))}}}Xr.vc=Cn,Xr.Wb=zn,Xr.Ya=ci,Xr.yc=oi,Nt=1;break t}Nt=0}if(!(Z=Nt)){U.a=3;break e}if(0<Fe){if(ce.ua=1<<Fe,!ee(ce.Wa,Fe)){U.a=1,Z=0;break e}}else ce.ua=0;var W1=U,a_=Q,aq=ne,G1=W1.s,Y1=G1.xc;if(W1.c=a_,W1.i=aq,G1.md=ge(a_,Y1),G1.wc=Y1==0?-1:(1<<Y1)-1,F){U.xb=OD;break e}if((Ne=i(Q*ne))==null){U.a=1,Z=0;break e}Z=(Z=Mn(U,Ne,0,Q,ne,ne,null))&&!ae.h;break e}return Z?(K!=null?K[0]=Ne:(t(Ne==null),t(F)),U.$=0,F||Xe(ce)):Xe(ce),Z}function on(v,j){var F=v.c*v.i,U=F+j+16*j;return t(v.c<=j),v.V=i(U),v.V==null?(v.Ta=null,v.Ua=0,v.a=1,0):(v.Ta=v.V,v.Ua=v.Ba+F+j,1)}function rn(v,j){var F=v.C,U=j-F,K=v.V,Z=v.Ba+v.c*F;for(t(j<=v.l.o);0<U;){var Q=16<U?16:U,ne=v.l.ma,ae=v.l.width,ce=ae*Q,Ne=ne.ca,Fe=ne.tb+ae*F,ue=v.Ta,Se=v.Ua;Vt(v,Q,K,Z),Tj(ue,Se,Ne,Fe,ce),jt(ne,F,F+Q,Ne,Fe,ae),U-=Q,K+=Q*v.c,F+=Q}t(F==j),v.C=v.Ma=j}function Qt(){this.ub=this.yd=this.td=this.Rb=0}function vt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function $t(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function Yt(){this.Yb=function(){var v=[];return function j(F,U,K){for(var Z=K[U],Q=0;Q<Z&&(F.push(K.length>U+1?[]:0),!(K.length<U+1));Q++)j(F[Q],U+1,K)}(v,0,[3,11]),v}()}function zt(){this.jb=i(3),this.Wc=a([4,8],Yt),this.Xc=a([4,17],Yt)}function Pn(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function ln(){this.ld=this.La=this.dd=this.tc=0}function Fn(){this.Na=this.la=0}function En(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function Bn(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Ni(){this.uc=this.M=this.Nb=0,this.wa=Array(new ln),this.Y=0,this.ya=Array(new Bn),this.aa=0,this.l=new Va}function ji(){this.y=i(16),this.f=i(8),this.ea=i(8)}function $r(){this.cb=this.a=0,this.sc="",this.m=new $,this.Od=new Qt,this.Kc=new vt,this.ed=new Pn,this.Qa=new $t,this.Ic=this.$c=this.Aa=0,this.D=new Ni,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=l(8,$),this.ia=0,this.pb=l(4,En),this.Pa=new zt,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new ji),this.Hd=0,this.rb=Array(new Fn),this.sb=0,this.wa=Array(new ln),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new Bn),this.L=this.aa=0,this.gd=a([4,2],ln),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Va(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Vc(){var v=new $r;return v!=null&&(v.a=0,v.sc="OK",v.cb=0,v.Xb=0,Jd||(Jd=_i)),v}function cr(v,j,F){return v.a==0&&(v.a=j,v.sc=F,v.cb=0),0}function Cl(v,j,F){return 3<=F&&v[j+0]==157&&v[j+1]==1&&v[j+2]==42}function Pl(v,j){if(v==null)return 0;if(v.a=0,v.sc="OK",j==null)return cr(v,2,"null VP8Io passed to VP8GetHeaders()");var F=j.data,U=j.w,K=j.ha;if(4>K)return cr(v,7,"Truncated header.");var Z=F[U+0]|F[U+1]<<8|F[U+2]<<16,Q=v.Od;if(Q.Rb=!(1&Z),Q.td=Z>>1&7,Q.yd=Z>>4&1,Q.ub=Z>>5,3<Q.td)return cr(v,3,"Incorrect keyframe parameters.");if(!Q.yd)return cr(v,4,"Frame not displayable.");U+=3,K-=3;var ne=v.Kc;if(Q.Rb){if(7>K)return cr(v,7,"cannot parse picture header");if(!Cl(F,U,K))return cr(v,3,"Bad code word");ne.c=16383&(F[U+4]<<8|F[U+3]),ne.Td=F[U+4]>>6,ne.i=16383&(F[U+6]<<8|F[U+5]),ne.Ud=F[U+6]>>6,U+=7,K-=7,v.za=ne.c+15>>4,v.Ub=ne.i+15>>4,j.width=ne.c,j.height=ne.i,j.Da=0,j.j=0,j.v=0,j.va=j.width,j.o=j.height,j.da=0,j.ib=j.width,j.hb=j.height,j.U=j.width,j.T=j.height,s((Z=v.Pa).jb,0,255,Z.jb.length),t((Z=v.Qa)!=null),Z.Cb=0,Z.Bb=0,Z.Fb=1,s(Z.Zb,0,0,Z.Zb.length),s(Z.Lb,0,0,Z.Lb)}if(Q.ub>K)return cr(v,7,"bad partition length");L(Z=v.m,F,U,Q.ub),U+=Q.ub,K-=Q.ub,Q.Rb&&(ne.Ld=Y(Z),ne.Kd=Y(Z)),ne=v.Qa;var ae,ce=v.Pa;if(t(Z!=null),t(ne!=null),ne.Cb=Y(Z),ne.Cb){if(ne.Bb=Y(Z),Y(Z)){for(ne.Fb=Y(Z),ae=0;4>ae;++ae)ne.Zb[ae]=Y(Z)?V(Z,7):0;for(ae=0;4>ae;++ae)ne.Lb[ae]=Y(Z)?V(Z,6):0}if(ne.Bb)for(ae=0;3>ae;++ae)ce.jb[ae]=Y(Z)?D(Z,8):255}else ne.Bb=0;if(Z.Ka)return cr(v,3,"cannot parse segment header");if((ne=v.ed).zd=Y(Z),ne.Tb=D(Z,6),ne.wb=D(Z,3),ne.Pc=Y(Z),ne.Pc&&Y(Z)){for(ce=0;4>ce;++ce)Y(Z)&&(ne.vd[ce]=V(Z,6));for(ce=0;4>ce;++ce)Y(Z)&&(ne.od[ce]=V(Z,6))}if(v.L=ne.Tb==0?0:ne.zd?1:2,Z.Ka)return cr(v,3,"cannot parse filter header");var Ne=K;if(K=ae=U,U=ae+Ne,ne=Ne,v.Xb=(1<<D(v.m,2))-1,Ne<3*(ce=v.Xb))F=7;else{for(ae+=3*ce,ne-=3*ce,Ne=0;Ne<ce;++Ne){var Fe=F[K+0]|F[K+1]<<8|F[K+2]<<16;Fe>ne&&(Fe=ne),L(v.Jc[+Ne],F,ae,Fe),ae+=Fe,ne-=Fe,K+=3}L(v.Jc[+ce],F,ae,ne),F=ae<U?0:5}if(F!=0)return cr(v,F,"cannot parse partitions");for(F=D(ae=v.m,7),K=Y(ae)?V(ae,4):0,U=Y(ae)?V(ae,4):0,ne=Y(ae)?V(ae,4):0,ce=Y(ae)?V(ae,4):0,ae=Y(ae)?V(ae,4):0,Ne=v.Qa,Fe=0;4>Fe;++Fe){if(Ne.Cb){var ue=Ne.Zb[Fe];Ne.Fb||(ue+=F)}else{if(0<Fe){v.pb[Fe]=v.pb[0];continue}ue=F}var Se=v.pb[Fe];Se.Sc[0]=F1[pr(ue+K,127)],Se.Sc[1]=D1[pr(ue+0,127)],Se.Eb[0]=2*F1[pr(ue+U,127)],Se.Eb[1]=101581*D1[pr(ue+ne,127)]>>16,8>Se.Eb[1]&&(Se.Eb[1]=8),Se.Qc[0]=F1[pr(ue+ce,117)],Se.Qc[1]=D1[pr(ue+ae,127)],Se.lc=ue+ae}if(!Q.Rb)return cr(v,4,"Not a key frame.");for(Y(Z),Q=v.Pa,F=0;4>F;++F){for(K=0;8>K;++K)for(U=0;3>U;++U)for(ne=0;11>ne;++ne)ce=te(Z,RD[F][K][U][ne])?D(Z,8):LD[F][K][U][ne],Q.Wc[F][K].Yb[U][ne]=ce;for(K=0;17>K;++K)Q.Xc[F][K]=Q.Wc[F][$D[K]]}return v.kc=Y(Z),v.kc&&(v.Bd=D(Z,8)),v.cb=1}function _i(v,j,F,U,K,Z,Q){var ne=j[K].Yb[F];for(F=0;16>K;++K){if(!te(v,ne[F+0]))return K;for(;!te(v,ne[F+1]);)if(ne=j[++K].Yb[0],F=0,K==16)return 16;var ae=j[K+1].Yb;if(te(v,ne[F+2])){var ce=v,Ne=0;if(te(ce,(ue=ne)[(Fe=F)+3]))if(te(ce,ue[Fe+6])){for(ne=0,Fe=2*(Ne=te(ce,ue[Fe+8]))+(ue=te(ce,ue[Fe+9+Ne])),Ne=0,ue=ID[Fe];ue[ne];++ne)Ne+=Ne+te(ce,ue[ne]);Ne+=3+(8<<Fe)}else te(ce,ue[Fe+7])?(Ne=7+2*te(ce,165),Ne+=te(ce,145)):Ne=5+te(ce,159);else Ne=te(ce,ue[Fe+4])?3+te(ce,ue[Fe+5]):2;ne=ae[2]}else Ne=1,ne=ae[1];ae=Q+TD[K],0>(ce=v).b&&ie(ce);var Fe,ue=ce.b,Se=(Fe=ce.Ca>>1)-(ce.I>>ue)>>31;--ce.b,ce.Ca+=Se,ce.Ca|=1,ce.I-=(Fe+1&Se)<<ue,Z[ae]=((Ne^Se)-Se)*U[(0<K)+0]}return 16}function ma(v){var j=v.rb[v.sb-1];j.la=0,j.Na=0,s(v.zc,0,0,v.zc.length),v.ja=0}function Hs(v,j,F,U,K){K=v[j+F+32*U]+(K>>3),v[j+F+32*U]=-256&K?0>K?0:255:K}function pa(v,j,F,U,K,Z){Hs(v,j,0,F,U+K),Hs(v,j,1,F,U+Z),Hs(v,j,2,F,U-Z),Hs(v,j,3,F,U-K)}function ir(v){return(20091*v>>16)+v}function Io(v,j,F,U){var K,Z=0,Q=i(16);for(K=0;4>K;++K){var ne=v[j+0]+v[j+8],ae=v[j+0]-v[j+8],ce=(35468*v[j+4]>>16)-ir(v[j+12]),Ne=ir(v[j+4])+(35468*v[j+12]>>16);Q[Z+0]=ne+Ne,Q[Z+1]=ae+ce,Q[Z+2]=ae-ce,Q[Z+3]=ne-Ne,Z+=4,j++}for(K=Z=0;4>K;++K)ne=(v=Q[Z+0]+4)+Q[Z+8],ae=v-Q[Z+8],ce=(35468*Q[Z+4]>>16)-ir(Q[Z+12]),Hs(F,U,0,0,ne+(Ne=ir(Q[Z+4])+(35468*Q[Z+12]>>16))),Hs(F,U,1,0,ae+ce),Hs(F,U,2,0,ae-ce),Hs(F,U,3,0,ne-Ne),Z++,U+=32}function Wc(v,j,F,U){var K=v[j+0]+4,Z=35468*v[j+4]>>16,Q=ir(v[j+4]),ne=35468*v[j+1]>>16;pa(F,U,0,K+Q,v=ir(v[j+1]),ne),pa(F,U,1,K+Z,v,ne),pa(F,U,2,K-Z,v,ne),pa(F,U,3,K-Q,v,ne)}function Gc(v,j,F,U,K){Io(v,j,F,U),K&&Io(v,j+16,F,U+4)}function Yc(v,j,F,U){Gl(v,j+0,F,U,1),Gl(v,j+32,F,U+128,1)}function ri(v,j,F,U){var K;for(v=v[j+0]+4,K=0;4>K;++K)for(j=0;4>j;++j)Hs(F,U,j,K,v)}function Il(v,j,F,U){v[j+0]&&Dn(v,j+0,F,U),v[j+16]&&Dn(v,j+16,F,U+4),v[j+32]&&Dn(v,j+32,F,U+128),v[j+48]&&Dn(v,j+48,F,U+128+4)}function Tl(v,j,F,U){var K,Z=i(16);for(K=0;4>K;++K){var Q=v[j+0+K]+v[j+12+K],ne=v[j+4+K]+v[j+8+K],ae=v[j+4+K]-v[j+8+K],ce=v[j+0+K]-v[j+12+K];Z[0+K]=Q+ne,Z[8+K]=Q-ne,Z[4+K]=ce+ae,Z[12+K]=ce-ae}for(K=0;4>K;++K)Q=(v=Z[0+4*K]+3)+Z[3+4*K],ne=Z[1+4*K]+Z[2+4*K],ae=Z[1+4*K]-Z[2+4*K],ce=v-Z[3+4*K],F[U+0]=Q+ne>>3,F[U+16]=ce+ae>>3,F[U+32]=Q-ne>>3,F[U+48]=ce-ae>>3,U+=64}function Hi(v,j,F){var U,K=j-32,Z=ai,Q=255-v[K-1];for(U=0;U<F;++U){var ne,ae=Z,ce=Q+v[j-1];for(ne=0;ne<F;++ne)v[j+ne]=ae[ce+v[K+ne]];j+=32}}function To(v,j){Hi(v,j,4)}function Xc(v,j){Hi(v,j,8)}function Kc(v,j){Hi(v,j,16)}function Jc(v,j){var F;for(F=0;16>F;++F)r(v,j+32*F,v,j-32,16)}function Lo(v,j){var F;for(F=16;0<F;--F)s(v,j,v[j-1],16),j+=32}function ga(v,j,F){var U;for(U=0;16>U;++U)s(j,F+32*U,v,16)}function Vi(v,j){var F,U=16;for(F=0;16>F;++F)U+=v[j-1+32*F]+v[j+F-32];ga(U>>5,v,j)}function Zc(v,j){var F,U=8;for(F=0;16>F;++F)U+=v[j-1+32*F];ga(U>>4,v,j)}function Ke(v,j){var F,U=8;for(F=0;16>F;++F)U+=v[j+F-32];ga(U>>4,v,j)}function nt(v,j){ga(128,v,j)}function Ut(v,j,F){return v+2*j+F+2>>2}function Qc(v,j){var F,U=j-32;for(U=new Uint8Array([Ut(v[U-1],v[U+0],v[U+1]),Ut(v[U+0],v[U+1],v[U+2]),Ut(v[U+1],v[U+2],v[U+3]),Ut(v[U+2],v[U+3],v[U+4])]),F=0;4>F;++F)r(v,j+32*F,U,0,U.length)}function Md(v,j){var F=v[j-1],U=v[j-1+32],K=v[j-1+64],Z=v[j-1+96];we(v,j+0,16843009*Ut(v[j-1-32],F,U)),we(v,j+32,16843009*Ut(F,U,K)),we(v,j+64,16843009*Ut(U,K,Z)),we(v,j+96,16843009*Ut(K,Z,Z))}function eu(v,j){var F,U=4;for(F=0;4>F;++F)U+=v[j+F-32]+v[j-1+32*F];for(U>>=3,F=0;4>F;++F)s(v,j+32*F,U,4)}function C1(v,j){var F=v[j-1+0],U=v[j-1+32],K=v[j-1+64],Z=v[j-1-32],Q=v[j+0-32],ne=v[j+1-32],ae=v[j+2-32],ce=v[j+3-32];v[j+0+96]=Ut(U,K,v[j-1+96]),v[j+1+96]=v[j+0+64]=Ut(F,U,K),v[j+2+96]=v[j+1+64]=v[j+0+32]=Ut(Z,F,U),v[j+3+96]=v[j+2+64]=v[j+1+32]=v[j+0+0]=Ut(Q,Z,F),v[j+3+64]=v[j+2+32]=v[j+1+0]=Ut(ne,Q,Z),v[j+3+32]=v[j+2+0]=Ut(ae,ne,Q),v[j+3+0]=Ut(ce,ae,ne)}function Wa(v,j){var F=v[j+1-32],U=v[j+2-32],K=v[j+3-32],Z=v[j+4-32],Q=v[j+5-32],ne=v[j+6-32],ae=v[j+7-32];v[j+0+0]=Ut(v[j+0-32],F,U),v[j+1+0]=v[j+0+32]=Ut(F,U,K),v[j+2+0]=v[j+1+32]=v[j+0+64]=Ut(U,K,Z),v[j+3+0]=v[j+2+32]=v[j+1+64]=v[j+0+96]=Ut(K,Z,Q),v[j+3+32]=v[j+2+64]=v[j+1+96]=Ut(Z,Q,ne),v[j+3+64]=v[j+2+96]=Ut(Q,ne,ae),v[j+3+96]=Ut(ne,ae,ae)}function Ga(v,j){var F=v[j-1+0],U=v[j-1+32],K=v[j-1+64],Z=v[j-1-32],Q=v[j+0-32],ne=v[j+1-32],ae=v[j+2-32],ce=v[j+3-32];v[j+0+0]=v[j+1+64]=Z+Q+1>>1,v[j+1+0]=v[j+2+64]=Q+ne+1>>1,v[j+2+0]=v[j+3+64]=ne+ae+1>>1,v[j+3+0]=ae+ce+1>>1,v[j+0+96]=Ut(K,U,F),v[j+0+64]=Ut(U,F,Z),v[j+0+32]=v[j+1+96]=Ut(F,Z,Q),v[j+1+32]=v[j+2+96]=Ut(Z,Q,ne),v[j+2+32]=v[j+3+96]=Ut(Q,ne,ae),v[j+3+32]=Ut(ne,ae,ce)}function P1(v,j){var F=v[j+0-32],U=v[j+1-32],K=v[j+2-32],Z=v[j+3-32],Q=v[j+4-32],ne=v[j+5-32],ae=v[j+6-32],ce=v[j+7-32];v[j+0+0]=F+U+1>>1,v[j+1+0]=v[j+0+64]=U+K+1>>1,v[j+2+0]=v[j+1+64]=K+Z+1>>1,v[j+3+0]=v[j+2+64]=Z+Q+1>>1,v[j+0+32]=Ut(F,U,K),v[j+1+32]=v[j+0+96]=Ut(U,K,Z),v[j+2+32]=v[j+1+96]=Ut(K,Z,Q),v[j+3+32]=v[j+2+96]=Ut(Z,Q,ne),v[j+3+64]=Ut(Q,ne,ae),v[j+3+96]=Ut(ne,ae,ce)}function I1(v,j){var F=v[j-1+0],U=v[j-1+32],K=v[j-1+64],Z=v[j-1+96];v[j+0+0]=F+U+1>>1,v[j+2+0]=v[j+0+32]=U+K+1>>1,v[j+2+32]=v[j+0+64]=K+Z+1>>1,v[j+1+0]=Ut(F,U,K),v[j+3+0]=v[j+1+32]=Ut(U,K,Z),v[j+3+32]=v[j+1+64]=Ut(K,Z,Z),v[j+3+64]=v[j+2+64]=v[j+0+96]=v[j+1+96]=v[j+2+96]=v[j+3+96]=Z}function tu(v,j){var F=v[j-1+0],U=v[j-1+32],K=v[j-1+64],Z=v[j-1+96],Q=v[j-1-32],ne=v[j+0-32],ae=v[j+1-32],ce=v[j+2-32];v[j+0+0]=v[j+2+32]=F+Q+1>>1,v[j+0+32]=v[j+2+64]=U+F+1>>1,v[j+0+64]=v[j+2+96]=K+U+1>>1,v[j+0+96]=Z+K+1>>1,v[j+3+0]=Ut(ne,ae,ce),v[j+2+0]=Ut(Q,ne,ae),v[j+1+0]=v[j+3+32]=Ut(F,Q,ne),v[j+1+32]=v[j+3+64]=Ut(U,F,Q),v[j+1+64]=v[j+3+96]=Ut(K,U,F),v[j+1+96]=Ut(Z,K,U)}function Rd(v,j){var F;for(F=0;8>F;++F)r(v,j+32*F,v,j-32,8)}function Ll(v,j){var F;for(F=0;8>F;++F)s(v,j,v[j-1],8),j+=32}function nu(v,j,F){var U;for(U=0;8>U;++U)s(j,F+32*U,v,8)}function ru(v,j){var F,U=8;for(F=0;8>F;++F)U+=v[j+F-32]+v[j-1+32*F];nu(U>>4,v,j)}function T1(v,j){var F,U=4;for(F=0;8>F;++F)U+=v[j+F-32];nu(U>>3,v,j)}function $d(v,j){var F,U=4;for(F=0;8>F;++F)U+=v[j-1+32*F];nu(U>>3,v,j)}function Od(v,j){nu(128,v,j)}function Ml(v,j,F){var U=v[j-F],K=v[j+0],Z=3*(K-U)+L1[1020+v[j-2*F]-v[j+F]],Q=jm[112+(Z+4>>3)];v[j-F]=ai[255+U+jm[112+(Z+3>>3)]],v[j+0]=ai[255+K-Q]}function Rl(v,j,F,U){var K=v[j+0],Z=v[j+F];return Ei[255+v[j-2*F]-v[j-F]]>U||Ei[255+Z-K]>U}function Fd(v,j,F,U){return 4*Ei[255+v[j-F]-v[j+0]]+Ei[255+v[j-2*F]-v[j+F]]<=U}function su(v,j,F,U,K){var Z=v[j-3*F],Q=v[j-2*F],ne=v[j-F],ae=v[j+0],ce=v[j+F],Ne=v[j+2*F],Fe=v[j+3*F];return 4*Ei[255+ne-ae]+Ei[255+Q-ce]>U?0:Ei[255+v[j-4*F]-Z]<=K&&Ei[255+Z-Q]<=K&&Ei[255+Q-ne]<=K&&Ei[255+Fe-Ne]<=K&&Ei[255+Ne-ce]<=K&&Ei[255+ce-ae]<=K}function Dd(v,j,F,U){var K=2*U+1;for(U=0;16>U;++U)Fd(v,j+U,F,K)&&Ml(v,j+U,F)}function $l(v,j,F,U){var K=2*U+1;for(U=0;16>U;++U)Fd(v,j+U*F,1,K)&&Ml(v,j+U*F,1)}function mm(v,j,F,U){var K;for(K=3;0<K;--K)Dd(v,j+=4*F,F,U)}function pm(v,j,F,U){var K;for(K=3;0<K;--K)$l(v,j+=4,F,U)}function Ya(v,j,F,U,K,Z,Q,ne){for(Z=2*Z+1;0<K--;){if(su(v,j,F,Z,Q))if(Rl(v,j,F,ne))Ml(v,j,F);else{var ae=v,ce=j,Ne=F,Fe=ae[ce-2*Ne],ue=ae[ce-Ne],Se=ae[ce+0],Le=ae[ce+Ne],Ge=ae[ce+2*Ne],Oe=27*(Qe=L1[1020+3*(Se-ue)+L1[1020+Fe-Le]])+63>>7,Ye=18*Qe+63>>7,Qe=9*Qe+63>>7;ae[ce-3*Ne]=ai[255+ae[ce-3*Ne]+Qe],ae[ce-2*Ne]=ai[255+Fe+Ye],ae[ce-Ne]=ai[255+ue+Oe],ae[ce+0]=ai[255+Se-Oe],ae[ce+Ne]=ai[255+Le-Ye],ae[ce+2*Ne]=ai[255+Ge-Qe]}j+=U}}function Xa(v,j,F,U,K,Z,Q,ne){for(Z=2*Z+1;0<K--;){if(su(v,j,F,Z,Q))if(Rl(v,j,F,ne))Ml(v,j,F);else{var ae=v,ce=j,Ne=F,Fe=ae[ce-Ne],ue=ae[ce+0],Se=ae[ce+Ne],Le=jm[112+(4+(Ge=3*(ue-Fe))>>3)],Ge=jm[112+(Ge+3>>3)],Oe=Le+1>>1;ae[ce-2*Ne]=ai[255+ae[ce-2*Ne]+Oe],ae[ce-Ne]=ai[255+Fe+Ge],ae[ce+0]=ai[255+ue-Le],ae[ce+Ne]=ai[255+Se-Oe]}j+=U}}function gm(v,j,F,U,K,Z){Ya(v,j,F,1,16,U,K,Z)}function xm(v,j,F,U,K,Z){Ya(v,j,1,F,16,U,K,Z)}function Ol(v,j,F,U,K,Z){var Q;for(Q=3;0<Q;--Q)Xa(v,j+=4*F,F,1,16,U,K,Z)}function ym(v,j,F,U,K,Z){var Q;for(Q=3;0<Q;--Q)Xa(v,j+=4,1,F,16,U,K,Z)}function C(v,j,F,U,K,Z,Q,ne){Ya(v,j,K,1,8,Z,Q,ne),Ya(F,U,K,1,8,Z,Q,ne)}function X(v,j,F,U,K,Z,Q,ne){Ya(v,j,1,K,8,Z,Q,ne),Ya(F,U,1,K,8,Z,Q,ne)}function de(v,j,F,U,K,Z,Q,ne){Xa(v,j+4*K,K,1,8,Z,Q,ne),Xa(F,U+4*K,K,1,8,Z,Q,ne)}function xe(v,j,F,U,K,Z,Q,ne){Xa(v,j+4,1,K,8,Z,Q,ne),Xa(F,U+4,1,K,8,Z,Q,ne)}function Ie(){this.ba=new Ve,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new mt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Je(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function ct(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Pt(){this.ua=0,this.Wa=new $e,this.vb=new $e,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new B,this.yc=new A}function Ot(){this.xb=this.a=0,this.l=new Va,this.ca=new Ve,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new z,this.Pb=0,this.wd=new z,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Pt,this.ab=0,this.gc=l(4,ct),this.Oc=0}function sn(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Va,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function cn(v,j,F,U,K,Z,Q){for(v=v==null?0:v[j+0],j=0;j<Q;++j)K[Z+j]=v+F[U+j]&255,v=K[Z+j]}function Rn(v,j,F,U,K,Z,Q){var ne;if(v==null)cn(null,null,F,U,K,Z,Q);else for(ne=0;ne<Q;++ne)K[Z+ne]=v[j+ne]+F[U+ne]&255}function ur(v,j,F,U,K,Z,Q){if(v==null)cn(null,null,F,U,K,Z,Q);else{var ne,ae=v[j+0],ce=ae,Ne=ae;for(ne=0;ne<Q;++ne)ce=Ne+(ae=v[j+ne])-ce,Ne=F[U+ne]+(-256&ce?0>ce?0:255:ce)&255,ce=ae,K[Z+ne]=Ne}}function Or(v,j,F,U){var K=j.width,Z=j.o;if(t(v!=null&&j!=null),0>F||0>=U||F+U>Z)return null;if(!v.Cc){if(v.ga==null){var Q;if(v.ga=new sn,(Q=v.ga==null)||(Q=j.width*j.o,t(v.Gb.length==0),v.Gb=i(Q),v.Uc=0,v.Gb==null?Q=0:(v.mb=v.Gb,v.nb=v.Uc,v.rc=null,Q=1),Q=!Q),!Q){Q=v.ga;var ne=v.Fa,ae=v.P,ce=v.qc,Ne=v.mb,Fe=v.nb,ue=ae+1,Se=ce-1,Le=Q.l;if(t(ne!=null&&Ne!=null&&j!=null),Uo[0]=null,Uo[1]=cn,Uo[2]=Rn,Uo[3]=ur,Q.ca=Ne,Q.tb=Fe,Q.c=j.width,Q.i=j.height,t(0<Q.c&&0<Q.i),1>=ce)j=0;else if(Q.$a=3&ne[ae+0],Q.Z=ne[ae+0]>>2&3,Q.Lc=ne[ae+0]>>4&3,ae=ne[ae+0]>>6&3,0>Q.$a||1<Q.$a||4<=Q.Z||1<Q.Lc||ae)j=0;else if(Le.put=It,Le.ac=wn,Le.bc=Rr,Le.ma=Q,Le.width=j.width,Le.height=j.height,Le.Da=j.Da,Le.v=j.v,Le.va=j.va,Le.j=j.j,Le.o=j.o,Q.$a)e:{t(Q.$a==1),j=Zt();t:for(;;){if(j==null){j=0;break e}if(t(Q!=null),Q.mc=j,j.c=Q.c,j.i=Q.i,j.l=Q.l,j.l.ma=Q,j.l.width=Q.c,j.l.height=Q.i,j.a=0,O(j.m,ne,ue,Se),!yt(Q.c,Q.i,1,j,null)||(j.ab==1&&j.gc[0].hc==3&&bt(j.s)?(Q.ic=1,ne=j.c*j.i,j.Ta=null,j.Ua=0,j.V=i(ne),j.Ba=0,j.V==null?(j.a=1,j=0):j=1):(Q.ic=0,j=on(j,Q.c)),!j))break t;j=1;break e}Q.mc=null,j=0}else j=Se>=Q.c*Q.i;Q=!j}if(Q)return null;v.ga.Lc!=1?v.Ga=0:U=Z-F}t(v.ga!=null),t(F+U<=Z);e:{if(j=(ne=v.ga).c,Z=ne.l.o,ne.$a==0){if(ue=v.rc,Se=v.Vc,Le=v.Fa,ae=v.P+1+F*j,ce=v.mb,Ne=v.nb+F*j,t(ae<=v.P+v.qc),ne.Z!=0)for(t(Uo[ne.Z]!=null),Q=0;Q<U;++Q)Uo[ne.Z](ue,Se,Le,ae,ce,Ne,j),ue=ce,Se=Ne,Ne+=j,ae+=j;else for(Q=0;Q<U;++Q)r(ce,Ne,Le,ae,j),ue=ce,Se=Ne,Ne+=j,ae+=j;v.rc=ue,v.Vc=Se}else{if(t(ne.mc!=null),j=F+U,t((Q=ne.mc)!=null),t(j<=Q.i),Q.C>=j)j=1;else if(ne.ic||Si(),ne.ic){ne=Q.V,ue=Q.Ba,Se=Q.c;var Ge=Q.i,Oe=(Le=1,ae=Q.$/Se,ce=Q.$%Se,Ne=Q.m,Fe=Q.s,Q.$),Ye=Se*Ge,Qe=Se*j,dt=Fe.wc,lt=Oe<Qe?wt(Fe,ce,ae):null;t(Oe<=Ye),t(j<=Ge),t(bt(Fe));t:for(;;){for(;!Ne.h&&Oe<Qe;){if(ce&dt||(lt=wt(Fe,ce,ae)),t(lt!=null),oe(Ne),256>(Ge=Ue(lt.G[0],lt.H[0],Ne)))ne[ue+Oe]=Ge,++Oe,++ce>=Se&&(ce=0,++ae<=j&&!(ae%16)&&an(Q,ae));else{if(!(280>Ge)){Le=0;break t}Ge=Sr(Ge-256,Ne);var Dt,Et=Ue(lt.G[4],lt.H[4],Ne);if(oe(Ne),!(Oe>=(Et=We(Se,Et=Sr(Et,Ne)))&&Ye-Oe>=Ge)){Le=0;break t}for(Dt=0;Dt<Ge;++Dt)ne[ue+Oe+Dt]=ne[ue+Oe+Dt-Et];for(Oe+=Ge,ce+=Ge;ce>=Se;)ce-=Se,++ae<=j&&!(ae%16)&&an(Q,ae);Oe<Qe&&ce&dt&&(lt=wt(Fe,ce,ae))}t(Ne.h==G(Ne))}an(Q,ae>j?j:ae);break t}!Le||Ne.h&&Oe<Ye?(Le=0,Q.a=Ne.h?5:3):Q.$=Oe,j=Le}else j=Mn(Q,Q.V,Q.Ba,Q.c,Q.i,j,rn);if(!j){U=0;break e}}F+U>=Z&&(v.Cc=1),U=1}if(!U)return null;if(v.Cc&&((U=v.ga)!=null&&(U.mc=null),v.ga=null,0<v.Ga))return alert("todo:WebPDequantizeLevels"),null}return v.nb+F*K}function Qn(v,j,F,U,K,Z){for(;0<K--;){var Q,ne=v,ae=j+(F?1:0),ce=v,Ne=j+(F?0:3);for(Q=0;Q<U;++Q){var Fe=ce[Ne+4*Q];Fe!=255&&(Fe*=32897,ne[ae+4*Q+0]=ne[ae+4*Q+0]*Fe>>23,ne[ae+4*Q+1]=ne[ae+4*Q+1]*Fe>>23,ne[ae+4*Q+2]=ne[ae+4*Q+2]*Fe>>23)}j+=Z}}function Wr(v,j,F,U,K){for(;0<U--;){var Z;for(Z=0;Z<F;++Z){var Q=v[j+2*Z+0],ne=15&(ce=v[j+2*Z+1]),ae=4369*ne,ce=(240&ce|ce>>4)*ae>>16;v[j+2*Z+0]=(240&Q|Q>>4)*ae>>16&240|(15&Q|Q<<4)*ae>>16>>4&15,v[j+2*Z+1]=240&ce|ne}j+=K}}function Fr(v,j,F,U,K,Z,Q,ne){var ae,ce,Ne=255;for(ce=0;ce<K;++ce){for(ae=0;ae<U;++ae){var Fe=v[j+ae];Z[Q+4*ae]=Fe,Ne&=Fe}j+=F,Q+=ne}return Ne!=255}function ls(v,j,F,U,K){var Z;for(Z=0;Z<K;++Z)F[U+Z]=v[j+Z]>>8}function Si(){Kd=Qn,Pj=Wr,Ij=Fr,Tj=ls}function Vs(v,j,F){S[v]=function(U,K,Z,Q,ne,ae,ce,Ne,Fe,ue,Se,Le,Ge,Oe,Ye,Qe,dt){var lt,Dt=dt-1>>1,Et=ne[ae+0]|ce[Ne+0]<<16,pn=Fe[ue+0]|Se[Le+0]<<16;t(U!=null);var Lt=3*Et+pn+131074>>2;for(j(U[K+0],255&Lt,Lt>>16,Ge,Oe),Z!=null&&(Lt=3*pn+Et+131074>>2,j(Z[Q+0],255&Lt,Lt>>16,Ye,Qe)),lt=1;lt<=Dt;++lt){var _n=ne[ae+lt]|ce[Ne+lt]<<16,Yr=Fe[ue+lt]|Se[Le+lt]<<16,gn=Et+_n+pn+Yr+524296,Mt=gn+2*(_n+pn)>>3;Lt=Mt+Et>>1,Et=(gn=gn+2*(Et+Yr)>>3)+_n>>1,j(U[K+2*lt-1],255&Lt,Lt>>16,Ge,Oe+(2*lt-1)*F),j(U[K+2*lt-0],255&Et,Et>>16,Ge,Oe+(2*lt-0)*F),Z!=null&&(Lt=gn+pn>>1,Et=Mt+Yr>>1,j(Z[Q+2*lt-1],255&Lt,Lt>>16,Ye,Qe+(2*lt-1)*F),j(Z[Q+2*lt+0],255&Et,Et>>16,Ye,Qe+(2*lt+0)*F)),Et=_n,pn=Yr}1&dt||(Lt=3*Et+pn+131074>>2,j(U[K+dt-1],255&Lt,Lt>>16,Ge,Oe+(dt-1)*F),Z!=null&&(Lt=3*pn+Et+131074>>2,j(Z[Q+dt-1],255&Lt,Lt>>16,Ye,Qe+(dt-1)*F)))}}function vm(){Ci[_m]=FD,Ci[Sm]=Uj,Ci[Fj]=DD,Ci[Am]=Hj,Ci[km]=Vj,Ci[M1]=Wj,Ci[Dj]=qD,Ci[R1]=Uj,Ci[$1]=Hj,Ci[Em]=Vj,Ci[O1]=Wj}function iu(v){return v&-16384?0>v?0:255:v>>BD}function Fl(v,j){return iu((19077*v>>8)+(26149*j>>8)-14234)}function Mo(v,j,F){return iu((19077*v>>8)-(6419*j>>8)-(13320*F>>8)+8708)}function Dl(v,j){return iu((19077*v>>8)+(33050*j>>8)-17685)}function ql(v,j,F,U,K){U[K+0]=Fl(v,F),U[K+1]=Mo(v,j,F),U[K+2]=Dl(v,j)}function Bl(v,j,F,U,K){U[K+0]=Dl(v,j),U[K+1]=Mo(v,j,F),U[K+2]=Fl(v,F)}function gs(v,j,F,U,K){var Z=Mo(v,j,F);j=Z<<3&224|Dl(v,j)>>3,U[K+0]=248&Fl(v,F)|Z>>5,U[K+1]=j}function zl(v,j,F,U,K){var Z=240&Dl(v,j)|15;U[K+0]=240&Fl(v,F)|Mo(v,j,F)>>4,U[K+1]=Z}function Ul(v,j,F,U,K){U[K+0]=255,ql(v,j,F,U,K+1)}function qd(v,j,F,U,K){Bl(v,j,F,U,K),U[K+3]=255}function Bd(v,j,F,U,K){ql(v,j,F,U,K),U[K+3]=255}function pr(v,j){return 0>v?0:v>j?j:v}function Ka(v,j,F){S[v]=function(U,K,Z,Q,ne,ae,ce,Ne,Fe){for(var ue=Ne+(-2&Fe)*F;Ne!=ue;)j(U[K+0],Z[Q+0],ne[ae+0],ce,Ne),j(U[K+1],Z[Q+0],ne[ae+0],ce,Ne+F),K+=2,++Q,++ae,Ne+=2*F;1&Fe&&j(U[K+0],Z[Q+0],ne[ae+0],ce,Ne)}}function au(v,j,F){return F==0?v==0?j==0?6:5:j==0?4:0:F}function bm(v,j,F,U,K){switch(v>>>30){case 3:Gl(j,F,U,K,0);break;case 2:ki(j,F,U,K);break;case 1:Dn(j,F,U,K)}}function Ai(v,j){var F,U,K=j.M,Z=j.Nb,Q=v.oc,ne=v.pc+40,ae=v.oc,ce=v.pc+584,Ne=v.oc,Fe=v.pc+600;for(F=0;16>F;++F)Q[ne+32*F-1]=129;for(F=0;8>F;++F)ae[ce+32*F-1]=129,Ne[Fe+32*F-1]=129;for(0<K?Q[ne-1-32]=ae[ce-1-32]=Ne[Fe-1-32]=129:(s(Q,ne-32-1,127,21),s(ae,ce-32-1,127,9),s(Ne,Fe-32-1,127,9)),U=0;U<v.za;++U){var ue=j.ya[j.aa+U];if(0<U){for(F=-1;16>F;++F)r(Q,ne+32*F-4,Q,ne+32*F+12,4);for(F=-1;8>F;++F)r(ae,ce+32*F-4,ae,ce+32*F+4,4),r(Ne,Fe+32*F-4,Ne,Fe+32*F+4,4)}var Se=v.Gd,Le=v.Hd+U,Ge=ue.ad,Oe=ue.Hc;if(0<K&&(r(Q,ne-32,Se[Le].y,0,16),r(ae,ce-32,Se[Le].f,0,8),r(Ne,Fe-32,Se[Le].ea,0,8)),ue.Za){var Ye=Q,Qe=ne-32+16;for(0<K&&(U>=v.za-1?s(Ye,Qe,Se[Le].y[15],4):r(Ye,Qe,Se[Le+1].y,0,4)),F=0;4>F;F++)Ye[Qe+128+F]=Ye[Qe+256+F]=Ye[Qe+384+F]=Ye[Qe+0+F];for(F=0;16>F;++F,Oe<<=2)Ye=Q,Qe=ne+Yj[F],Wi[ue.Ob[F]](Ye,Qe),bm(Oe,Ge,16*+F,Ye,Qe)}else if(Ye=au(U,K,ue.Ob[0]),zo[Ye](Q,ne),Oe!=0)for(F=0;16>F;++F,Oe<<=2)bm(Oe,Ge,16*+F,Q,ne+Yj[F]);for(F=ue.Gc,Ye=au(U,K,ue.Dd),Qa[Ye](ae,ce),Qa[Ye](Ne,Fe),Oe=Ge,Ye=ae,Qe=ce,255&(ue=0|F)&&(170&ue?va(Oe,256,Ye,Qe):Yn(Oe,256,Ye,Qe)),ue=Ne,Oe=Fe,255&(F>>=8)&&(170&F?va(Ge,320,ue,Oe):Yn(Ge,320,ue,Oe)),K<v.Ub-1&&(r(Se[Le].y,0,Q,ne+480,16),r(Se[Le].f,0,ae,ce+224,8),r(Se[Le].ea,0,Ne,Fe+224,8)),F=8*Z*v.B,Se=v.sa,Le=v.ta+16*U+16*Z*v.R,Ge=v.qa,ue=v.ra+8*U+F,Oe=v.Ha,Ye=v.Ia+8*U+F,F=0;16>F;++F)r(Se,Le+F*v.R,Q,ne+32*F,16);for(F=0;8>F;++F)r(Ge,ue+F*v.B,ae,ce+32*F,8),r(Oe,Ye+F*v.B,Ne,Fe+32*F,8)}}function Hl(v,j,F,U,K,Z,Q,ne,ae){var ce=[0],Ne=[0],Fe=0,ue=ae!=null?ae.kd:0,Se=ae??new Je;if(v==null||12>F)return 7;Se.data=v,Se.w=j,Se.ha=F,j=[j],F=[F],Se.gb=[Se.gb];e:{var Le=j,Ge=F,Oe=Se.gb;if(t(v!=null),t(Ge!=null),t(Oe!=null),Oe[0]=0,12<=Ge[0]&&!n(v,Le[0],"RIFF")){if(n(v,Le[0]+8,"WEBP")){Oe=3;break e}var Ye=pe(v,Le[0]+4);if(12>Ye||4294967286<Ye){Oe=3;break e}if(ue&&Ye>Ge[0]-8){Oe=7;break e}Oe[0]=Ye,Le[0]+=12,Ge[0]-=12}Oe=0}if(Oe!=0)return Oe;for(Ye=0<Se.gb[0],F=F[0];;){e:{var Qe=v;Ge=j,Oe=F;var dt=ce,lt=Ne,Dt=Le=[0];if((Lt=Fe=[Fe])[0]=0,8>Oe[0])Oe=7;else{if(!n(Qe,Ge[0],"VP8X")){if(pe(Qe,Ge[0]+4)!=10){Oe=3;break e}if(18>Oe[0]){Oe=7;break e}var Et=pe(Qe,Ge[0]+8),pn=1+Ee(Qe,Ge[0]+12);if(2147483648<=pn*(Qe=1+Ee(Qe,Ge[0]+15))){Oe=3;break e}Dt!=null&&(Dt[0]=Et),dt!=null&&(dt[0]=pn),lt!=null&&(lt[0]=Qe),Ge[0]+=18,Oe[0]-=18,Lt[0]=1}Oe=0}}if(Fe=Fe[0],Le=Le[0],Oe!=0)return Oe;if(Ge=!!(2&Le),!Ye&&Fe)return 3;if(Z!=null&&(Z[0]=!!(16&Le)),Q!=null&&(Q[0]=Ge),ne!=null&&(ne[0]=0),Q=ce[0],Le=Ne[0],Fe&&Ge&&ae==null){Oe=0;break}if(4>F){Oe=7;break}if(Ye&&Fe||!Ye&&!Fe&&!n(v,j[0],"ALPH")){F=[F],Se.na=[Se.na],Se.P=[Se.P],Se.Sa=[Se.Sa];e:{Et=v,Oe=j,Ye=F;var Lt=Se.gb;dt=Se.na,lt=Se.P,Dt=Se.Sa,pn=22,t(Et!=null),t(Ye!=null),Qe=Oe[0];var _n=Ye[0];for(t(dt!=null),t(Dt!=null),dt[0]=null,lt[0]=null,Dt[0]=0;;){if(Oe[0]=Qe,Ye[0]=_n,8>_n){Oe=7;break e}var Yr=pe(Et,Qe+4);if(4294967286<Yr){Oe=3;break e}var gn=8+Yr+1&-2;if(pn+=gn,0<Lt&&pn>Lt){Oe=3;break e}if(!n(Et,Qe,"VP8 ")||!n(Et,Qe,"VP8L")){Oe=0;break e}if(_n[0]<gn){Oe=7;break e}n(Et,Qe,"ALPH")||(dt[0]=Et,lt[0]=Qe+8,Dt[0]=Yr),Qe+=gn,_n-=gn}}if(F=F[0],Se.na=Se.na[0],Se.P=Se.P[0],Se.Sa=Se.Sa[0],Oe!=0)break}F=[F],Se.Ja=[Se.Ja],Se.xa=[Se.xa];e:if(Lt=v,Oe=j,Ye=F,dt=Se.gb[0],lt=Se.Ja,Dt=Se.xa,Et=Oe[0],Qe=!n(Lt,Et,"VP8 "),pn=!n(Lt,Et,"VP8L"),t(Lt!=null),t(Ye!=null),t(lt!=null),t(Dt!=null),8>Ye[0])Oe=7;else{if(Qe||pn){if(Lt=pe(Lt,Et+4),12<=dt&&Lt>dt-12){Oe=3;break e}if(ue&&Lt>Ye[0]-8){Oe=7;break e}lt[0]=Lt,Oe[0]+=8,Ye[0]-=8,Dt[0]=pn}else Dt[0]=5<=Ye[0]&&Lt[Et+0]==47&&!(Lt[Et+4]>>5),lt[0]=Ye[0];Oe=0}if(F=F[0],Se.Ja=Se.Ja[0],Se.xa=Se.xa[0],j=j[0],Oe!=0)break;if(4294967286<Se.Ja)return 3;if(ne==null||Ge||(ne[0]=Se.xa?2:1),Q=[Q],Le=[Le],Se.xa){if(5>F){Oe=7;break}ne=Q,ue=Le,Ge=Z,v==null||5>F?v=0:5<=F&&v[j+0]==47&&!(v[j+4]>>5)?(Ye=[0],Lt=[0],dt=[0],O(lt=new z,v,j,F),Vr(lt,Ye,Lt,dt)?(ne!=null&&(ne[0]=Ye[0]),ue!=null&&(ue[0]=Lt[0]),Ge!=null&&(Ge[0]=dt[0]),v=1):v=0):v=0}else{if(10>F){Oe=7;break}ne=Le,v==null||10>F||!Cl(v,j+3,F-3)?v=0:(ue=v[j+0]|v[j+1]<<8|v[j+2]<<16,Ge=16383&(v[j+7]<<8|v[j+6]),v=16383&(v[j+9]<<8|v[j+8]),1&ue||3<(ue>>1&7)||!(ue>>4&1)||ue>>5>=Se.Ja||!Ge||!v?v=0:(Q&&(Q[0]=Ge),ne&&(ne[0]=v),v=1))}if(!v||(Q=Q[0],Le=Le[0],Fe&&(ce[0]!=Q||Ne[0]!=Le)))return 3;ae!=null&&(ae[0]=Se,ae.offset=j-ae.w,t(4294967286>j-ae.w),t(ae.offset==ae.ha-F));break}return Oe==0||Oe==7&&Fe&&ae==null?(Z!=null&&(Z[0]|=Se.na!=null&&0<Se.na.length),U!=null&&(U[0]=Q),K!=null&&(K[0]=Le),0):Oe}function zd(v,j,F){var U=j.width,K=j.height,Z=0,Q=0,ne=U,ae=K;if(j.Da=v!=null&&0<v.Da,j.Da&&(ne=v.cd,ae=v.bd,Z=v.v,Q=v.j,11>F||(Z&=-2,Q&=-2),0>Z||0>Q||0>=ne||0>=ae||Z+ne>U||Q+ae>K))return 0;if(j.v=Z,j.j=Q,j.va=Z+ne,j.o=Q+ae,j.U=ne,j.T=ae,j.da=v!=null&&0<v.da,j.da){if(!De(ne,ae,F=[v.ib],Z=[v.hb]))return 0;j.ib=F[0],j.hb=Z[0]}return j.ob=v!=null&&v.ob,j.Kb=v==null||!v.Sd,j.da&&(j.ob=j.ib<3*U/4&&j.hb<3*K/4,j.Kb=0),1}function Ud(v){if(v==null)return 2;if(11>v.S){var j=v.f.RGBA;j.fb+=(v.height-1)*j.A,j.A=-j.A}else j=v.f.kb,v=v.height,j.O+=(v-1)*j.fa,j.fa=-j.fa,j.N+=(v-1>>1)*j.Ab,j.Ab=-j.Ab,j.W+=(v-1>>1)*j.Db,j.Db=-j.Db,j.F!=null&&(j.J+=(v-1)*j.lb,j.lb=-j.lb);return 0}function Ro(v,j,F,U){if(U==null||0>=v||0>=j)return 2;if(F!=null){if(F.Da){var K=F.cd,Z=F.bd,Q=-2&F.v,ne=-2&F.j;if(0>Q||0>ne||0>=K||0>=Z||Q+K>v||ne+Z>j)return 2;v=K,j=Z}if(F.da){if(!De(v,j,K=[F.ib],Z=[F.hb]))return 2;v=K[0],j=Z[0]}}U.width=v,U.height=j;e:{var ae=U.width,ce=U.height;if(v=U.S,0>=ae||0>=ce||!(v>=_m&&13>v))v=2;else{if(0>=U.Rd&&U.sd==null){Q=Z=K=j=0;var Ne=(ne=ae*Xj[v])*ce;if(11>v||(Z=(ce+1)/2*(j=(ae+1)/2),v==12&&(Q=(K=ae)*ce)),(ce=i(Ne+2*Z+Q))==null){v=1;break e}U.sd=ce,11>v?((ae=U.f.RGBA).eb=ce,ae.fb=0,ae.A=ne,ae.size=Ne):((ae=U.f.kb).y=ce,ae.O=0,ae.fa=ne,ae.Fd=Ne,ae.f=ce,ae.N=0+Ne,ae.Ab=j,ae.Cd=Z,ae.ea=ce,ae.W=0+Ne+Z,ae.Db=j,ae.Ed=Z,v==12&&(ae.F=ce,ae.J=0+Ne+2*Z),ae.Tc=Q,ae.lb=K)}if(j=1,K=U.S,Z=U.width,Q=U.height,K>=_m&&13>K)if(11>K)v=U.f.RGBA,j&=(ne=Math.abs(v.A))*(Q-1)+Z<=v.size,j&=ne>=Z*Xj[K],j&=v.eb!=null;else{v=U.f.kb,ne=(Z+1)/2,Ne=(Q+1)/2,ae=Math.abs(v.fa),ce=Math.abs(v.Ab);var Fe=Math.abs(v.Db),ue=Math.abs(v.lb),Se=ue*(Q-1)+Z;j&=ae*(Q-1)+Z<=v.Fd,j&=ce*(Ne-1)+ne<=v.Cd,j=(j&=Fe*(Ne-1)+ne<=v.Ed)&ae>=Z&ce>=ne&Fe>=ne,j&=v.y!=null,j&=v.f!=null,j&=v.ea!=null,K==12&&(j&=ue>=Z,j&=Se<=v.Tc,j&=v.F!=null)}else j=0;v=j?0:2}}return v!=0||F!=null&&F.fd&&(v=Ud(U)),v}var Vl=64,si=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],ii=24,$o=32,Ja=8,Oo=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];_e("Predictor0","PredictorAdd0"),S.Predictor0=function(){return 4278190080},S.Predictor1=function(v){return v},S.Predictor2=function(v,j,F){return j[F+0]},S.Predictor3=function(v,j,F){return j[F+1]},S.Predictor4=function(v,j,F){return j[F-1]},S.Predictor5=function(v,j,F){return se(se(v,j[F+1]),j[F+0])},S.Predictor6=function(v,j,F){return se(v,j[F-1])},S.Predictor7=function(v,j,F){return se(v,j[F+0])},S.Predictor8=function(v,j,F){return se(j[F-1],j[F+0])},S.Predictor9=function(v,j,F){return se(j[F+0],j[F+1])},S.Predictor10=function(v,j,F){return se(se(v,j[F-1]),se(j[F+0],j[F+1]))},S.Predictor11=function(v,j,F){var U=j[F+0];return 0>=Ce(U>>24&255,v>>24&255,(j=j[F-1])>>24&255)+Ce(U>>16&255,v>>16&255,j>>16&255)+Ce(U>>8&255,v>>8&255,j>>8&255)+Ce(255&U,255&v,255&j)?U:v},S.Predictor12=function(v,j,F){var U=j[F+0];return(Ae((v>>24&255)+(U>>24&255)-((j=j[F-1])>>24&255))<<24|Ae((v>>16&255)+(U>>16&255)-(j>>16&255))<<16|Ae((v>>8&255)+(U>>8&255)-(j>>8&255))<<8|Ae((255&v)+(255&U)-(255&j)))>>>0},S.Predictor13=function(v,j,F){var U=j[F-1];return(Re((v=se(v,j[F+0]))>>24&255,U>>24&255)<<24|Re(v>>16&255,U>>16&255)<<16|Re(v>>8&255,U>>8&255)<<8|Re(255&v,255&U))>>>0};var Hd=S.PredictorAdd0;S.PredictorAdd1=ve,_e("Predictor2","PredictorAdd2"),_e("Predictor3","PredictorAdd3"),_e("Predictor4","PredictorAdd4"),_e("Predictor5","PredictorAdd5"),_e("Predictor6","PredictorAdd6"),_e("Predictor7","PredictorAdd7"),_e("Predictor8","PredictorAdd8"),_e("Predictor9","PredictorAdd9"),_e("Predictor10","PredictorAdd10"),_e("Predictor11","PredictorAdd11"),_e("Predictor12","PredictorAdd12"),_e("Predictor13","PredictorAdd13");var ou=S.PredictorAdd2;Te("ColorIndexInverseTransform","MapARGB","32b",function(v){return v>>8&255},function(v){return v}),Te("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(v){return v},function(v){return v>>8&255});var Ar,wm=S.ColorIndexInverseTransform,xa=S.MapARGB,ya=S.VP8LColorIndexInverseTransformAlpha,Vd=S.MapAlpha,Wd=S.VP8LPredictorsAdd=[];Wd.length=16,(S.VP8LPredictors=[]).length=16,(S.VP8LPredictorsAdd_C=[]).length=16,(S.VP8LPredictors_C=[]).length=16;var Gd,Yd,Fo,Do,qo,Wl,Bo,Gl,ki,va,Dn,Yn,kr,Gr,Za,Xd,lu,Nm,_j,Sj,Aj,kj,Ej,Cj,Kd,Pj,Ij,Tj,Lj=i(511),Mj=i(2041),Rj=i(225),$j=i(767),Oj=0,L1=Mj,jm=Rj,ai=$j,Ei=Lj,_m=0,Sm=1,Fj=2,Am=3,km=4,M1=5,Dj=6,R1=7,$1=8,Em=9,O1=10,_D=[2,3,7],SD=[3,3,11],qj=[280,256,256,256,40],AD=[0,1,1,1,0],kD=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],ED=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],CD=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],PD=8,F1=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],D1=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Jd=null,ID=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],TD=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],Bj=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],LD=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],MD=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],RD=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],$D=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],zo=[],Wi=[],Qa=[],OD=1,zj=2,Uo=[],Ci=[];Vs("UpsampleRgbLinePair",ql,3),Vs("UpsampleBgrLinePair",Bl,3),Vs("UpsampleRgbaLinePair",Bd,4),Vs("UpsampleBgraLinePair",qd,4),Vs("UpsampleArgbLinePair",Ul,4),Vs("UpsampleRgba4444LinePair",zl,2),Vs("UpsampleRgb565LinePair",gs,2);var FD=S.UpsampleRgbLinePair,DD=S.UpsampleBgrLinePair,Uj=S.UpsampleRgbaLinePair,Hj=S.UpsampleBgraLinePair,Vj=S.UpsampleArgbLinePair,Wj=S.UpsampleRgba4444LinePair,qD=S.UpsampleRgb565LinePair,Cm=16,Pm=1<<Cm-1,Zd=-227,q1=482,BD=6,Gj=0,zD=i(256),UD=i(256),HD=i(256),VD=i(256),WD=i(q1-Zd),GD=i(q1-Zd);Ka("YuvToRgbRow",ql,3),Ka("YuvToBgrRow",Bl,3),Ka("YuvToRgbaRow",Bd,4),Ka("YuvToBgraRow",qd,4),Ka("YuvToArgbRow",Ul,4),Ka("YuvToRgba4444Row",zl,2),Ka("YuvToRgb565Row",gs,2);var Yj=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Im=[0,2,8],YD=[8,7,6,4,4,2,2,2,1,1,1,1],XD=1;this.WebPDecodeRGBA=function(v,j,F,U,K){var Z=Sm,Q=new Ie,ne=new Ve;Q.ba=ne,ne.S=Z,ne.width=[ne.width],ne.height=[ne.height];var ae=ne.width,ce=ne.height,Ne=new ut;if(Ne==null||v==null)var Fe=2;else t(Ne!=null),Fe=Hl(v,j,F,Ne.width,Ne.height,Ne.Pd,Ne.Qd,Ne.format,null);if(Fe!=0?ae=0:(ae!=null&&(ae[0]=Ne.width[0]),ce!=null&&(ce[0]=Ne.height[0]),ae=1),ae){ne.width=ne.width[0],ne.height=ne.height[0],U!=null&&(U[0]=ne.width),K!=null&&(K[0]=ne.height);e:{if(U=new Va,(K=new Je).data=v,K.w=j,K.ha=F,K.kd=1,j=[0],t(K!=null),((v=Hl(K.data,K.w,K.ha,null,null,null,j,null,K))==0||v==7)&&j[0]&&(v=4),(j=v)==0){if(t(Q!=null),U.data=K.data,U.w=K.w+K.offset,U.ha=K.ha-K.offset,U.put=It,U.ac=wn,U.bc=Rr,U.ma=Q,K.xa){if((v=Zt())==null){Q=1;break e}if(function(ue,Se){var Le=[0],Ge=[0],Oe=[0];t:for(;;){if(ue==null)return 0;if(Se==null)return ue.a=2,0;if(ue.l=Se,ue.a=0,O(ue.m,Se.data,Se.w,Se.ha),!Vr(ue.m,Le,Ge,Oe)){ue.a=3;break t}if(ue.xb=zj,Se.width=Le[0],Se.height=Ge[0],!yt(Le[0],Ge[0],1,ue,null))break t;return 1}return t(ue.a!=0),0}(v,U)){if(U=(j=Ro(U.width,U.height,Q.Oa,Q.ba))==0){t:{U=v;n:for(;;){if(U==null){U=0;break t}if(t(U.s.yc!=null),t(U.s.Ya!=null),t(0<U.s.Wb),t((F=U.l)!=null),t((K=F.ma)!=null),U.xb!=0){if(U.ca=K.ba,U.tb=K.tb,t(U.ca!=null),!zd(K.Oa,F,Am)){U.a=2;break n}if(!on(U,F.width)||F.da)break n;if((F.da||ze(U.ca.S))&&Si(),11>U.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),U.ca.f.kb.F!=null&&Si()),U.Pb&&0<U.s.ua&&U.s.vb.X==null&&!ee(U.s.vb,U.s.Wa.Xa)){U.a=1;break n}U.xb=0}if(!Mn(U,U.V,U.Ba,U.c,U.i,F.o,St))break n;K.Dc=U.Ma,U=1;break t}t(U.a!=0),U=0}U=!U}U&&(j=v.a)}else j=v.a}else{if((v=new Vc)==null){Q=1;break e}if(v.Fa=K.na,v.P=K.P,v.qc=K.Sa,Pl(v,U)){if((j=Ro(U.width,U.height,Q.Oa,Q.ba))==0){if(v.Aa=0,F=Q.Oa,t((K=v)!=null),F!=null){if(0<(ae=0>(ae=F.Md)?0:100<ae?255:255*ae/100)){for(ce=Ne=0;4>ce;++ce)12>(Fe=K.pb[ce]).lc&&(Fe.ia=ae*YD[0>Fe.lc?0:Fe.lc]>>3),Ne|=Fe.ia;Ne&&(alert("todo:VP8InitRandom"),K.ia=1)}K.Ga=F.Id,100<K.Ga?K.Ga=100:0>K.Ga&&(K.Ga=0)}(function(ue,Se){if(ue==null)return 0;if(Se==null)return cr(ue,2,"NULL VP8Io parameter in VP8Decode().");if(!ue.cb&&!Pl(ue,Se))return 0;if(t(ue.cb),Se.ac==null||Se.ac(Se)){Se.ob&&(ue.L=0);var Le=Im[ue.L];if(ue.L==2?(ue.yb=0,ue.zb=0):(ue.yb=Se.v-Le>>4,ue.zb=Se.j-Le>>4,0>ue.yb&&(ue.yb=0),0>ue.zb&&(ue.zb=0)),ue.Va=Se.o+15+Le>>4,ue.Hb=Se.va+15+Le>>4,ue.Hb>ue.za&&(ue.Hb=ue.za),ue.Va>ue.Ub&&(ue.Va=ue.Ub),0<ue.L){var Ge=ue.ed;for(Le=0;4>Le;++Le){var Oe;if(ue.Qa.Cb){var Ye=ue.Qa.Lb[Le];ue.Qa.Fb||(Ye+=Ge.Tb)}else Ye=Ge.Tb;for(Oe=0;1>=Oe;++Oe){var Qe=ue.gd[Le][Oe],dt=Ye;if(Ge.Pc&&(dt+=Ge.vd[0],Oe&&(dt+=Ge.od[0])),0<(dt=0>dt?0:63<dt?63:dt)){var lt=dt;0<Ge.wb&&(lt=4<Ge.wb?lt>>2:lt>>1)>9-Ge.wb&&(lt=9-Ge.wb),1>lt&&(lt=1),Qe.dd=lt,Qe.tc=2*dt+lt,Qe.ld=40<=dt?2:15<=dt?1:0}else Qe.tc=0;Qe.La=Oe}}}Le=0}else cr(ue,6,"Frame setup failed"),Le=ue.a;if(Le=Le==0){if(Le){ue.$c=0,0<ue.Aa||(ue.Ic=XD);t:{Le=ue.Ic,Ge=4*(lt=ue.za);var Dt=32*lt,Et=lt+1,pn=0<ue.L?lt*(0<ue.Aa?2:1):0,Lt=(ue.Aa==2?2:1)*lt;if((Qe=Ge+832+(Oe=3*(16*Le+Im[ue.L])/2*Dt)+(Ye=ue.Fa!=null&&0<ue.Fa.length?ue.Kc.c*ue.Kc.i:0))!=Qe)Le=0;else{if(Qe>ue.Vb){if(ue.Vb=0,ue.Ec=i(Qe),ue.Fc=0,ue.Ec==null){Le=cr(ue,1,"no memory during frame initialization.");break t}ue.Vb=Qe}Qe=ue.Ec,dt=ue.Fc,ue.Ac=Qe,ue.Bc=dt,dt+=Ge,ue.Gd=l(Dt,ji),ue.Hd=0,ue.rb=l(Et+1,Fn),ue.sb=1,ue.wa=pn?l(pn,ln):null,ue.Y=0,ue.D.Nb=0,ue.D.wa=ue.wa,ue.D.Y=ue.Y,0<ue.Aa&&(ue.D.Y+=lt),t(!0),ue.oc=Qe,ue.pc=dt,dt+=832,ue.ya=l(Lt,Bn),ue.aa=0,ue.D.ya=ue.ya,ue.D.aa=ue.aa,ue.Aa==2&&(ue.D.aa+=lt),ue.R=16*lt,ue.B=8*lt,lt=(Dt=Im[ue.L])*ue.R,Dt=Dt/2*ue.B,ue.sa=Qe,ue.ta=dt+lt,ue.qa=ue.sa,ue.ra=ue.ta+16*Le*ue.R+Dt,ue.Ha=ue.qa,ue.Ia=ue.ra+8*Le*ue.B+Dt,ue.$c=0,dt+=Oe,ue.mb=Ye?Qe:null,ue.nb=Ye?dt:null,t(dt+Ye<=ue.Fc+ue.Vb),ma(ue),s(ue.Ac,ue.Bc,0,Ge),Le=1}}if(Le){if(Se.ka=0,Se.y=ue.sa,Se.O=ue.ta,Se.f=ue.qa,Se.N=ue.ra,Se.ea=ue.Ha,Se.Vd=ue.Ia,Se.fa=ue.R,Se.Rc=ue.B,Se.F=null,Se.J=0,!Oj){for(Le=-255;255>=Le;++Le)Lj[255+Le]=0>Le?-Le:Le;for(Le=-1020;1020>=Le;++Le)Mj[1020+Le]=-128>Le?-128:127<Le?127:Le;for(Le=-112;112>=Le;++Le)Rj[112+Le]=-16>Le?-16:15<Le?15:Le;for(Le=-255;510>=Le;++Le)$j[255+Le]=0>Le?0:255<Le?255:Le;Oj=1}Bo=Tl,Gl=Gc,va=Yc,Dn=ri,Yn=Il,ki=Wc,kr=gm,Gr=xm,Za=C,Xd=X,lu=Ol,Nm=ym,_j=de,Sj=xe,Aj=Dd,kj=$l,Ej=mm,Cj=pm,Wi[0]=eu,Wi[1]=To,Wi[2]=Qc,Wi[3]=Md,Wi[4]=C1,Wi[5]=Ga,Wi[6]=Wa,Wi[7]=P1,Wi[8]=tu,Wi[9]=I1,zo[0]=Vi,zo[1]=Kc,zo[2]=Jc,zo[3]=Lo,zo[4]=Zc,zo[5]=Ke,zo[6]=nt,Qa[0]=ru,Qa[1]=Xc,Qa[2]=Rd,Qa[3]=Ll,Qa[4]=$d,Qa[5]=T1,Qa[6]=Od,Le=1}else Le=0}Le&&(Le=function(_n,Yr){for(_n.M=0;_n.M<_n.Va;++_n.M){var gn,Mt=_n.Jc[_n.M&_n.Xb],Nt=_n.m,Er=_n;for(gn=0;gn<Er.za;++gn){var fn=Nt,An=Er,nr=An.Ac,cs=An.Bc+4*gn,Is=An.zc,gr=An.ya[An.aa+gn];if(An.Qa.Bb?gr.$b=te(fn,An.Pa.jb[0])?2+te(fn,An.Pa.jb[2]):te(fn,An.Pa.jb[1]):gr.$b=0,An.kc&&(gr.Ad=te(fn,An.Bd)),gr.Za=!te(fn,145)+0,gr.Za){var xs=gr.Ob,Ts=0;for(An=0;4>An;++An){var Xr,Cn=Is[0+An];for(Xr=0;4>Xr;++Xr){Cn=MD[nr[cs+Xr]][Cn];for(var zn=Bj[te(fn,Cn[0])];0<zn;)zn=Bj[2*zn+te(fn,Cn[zn])];Cn=-zn,nr[cs+Xr]=Cn}r(xs,Ts,nr,cs,4),Ts+=4,Is[0+An]=Cn}}else Cn=te(fn,156)?te(fn,128)?1:3:te(fn,163)?2:0,gr.Ob[0]=Cn,s(nr,cs,Cn,4),s(Is,0,Cn,4);gr.Dd=te(fn,142)?te(fn,114)?te(fn,183)?1:3:2:0}if(Er.m.Ka)return cr(_n,7,"Premature end-of-partition0 encountered.");for(;_n.ja<_n.za;++_n.ja){if(Er=Mt,fn=(Nt=_n).rb[Nt.sb-1],nr=Nt.rb[Nt.sb+Nt.ja],gn=Nt.ya[Nt.aa+Nt.ja],cs=Nt.kc?gn.Ad:0)fn.la=nr.la=0,gn.Za||(fn.Na=nr.Na=0),gn.Hc=0,gn.Gc=0,gn.ia=0;else{var xr,Un;if(fn=nr,nr=Er,cs=Nt.Pa.Xc,Is=Nt.ya[Nt.aa+Nt.ja],gr=Nt.pb[Is.$b],An=Is.ad,xs=0,Ts=Nt.rb[Nt.sb-1],Cn=Xr=0,s(An,xs,0,384),Is.Za)var us=0,Gi=cs[3];else{zn=i(16);var Cr=fn.Na+Ts.Na;if(Cr=Jd(nr,cs[1],Cr,gr.Eb,0,zn,0),fn.Na=Ts.Na=(0<Cr)+0,1<Cr)Bo(zn,0,An,xs);else{var Ws=zn[0]+3>>3;for(zn=0;256>zn;zn+=16)An[xs+zn]=Ws}us=1,Gi=cs[0]}var Xn=15&fn.la,Kr=15&Ts.la;for(zn=0;4>zn;++zn){var oi=1&Kr;for(Ws=Un=0;4>Ws;++Ws)Xn=Xn>>1|(oi=(Cr=Jd(nr,Gi,Cr=oi+(1&Xn),gr.Sc,us,An,xs))>us)<<7,Un=Un<<2|(3<Cr?3:1<Cr?2:An[xs+0]!=0),xs+=16;Xn>>=4,Kr=Kr>>1|oi<<7,Xr=(Xr<<8|Un)>>>0}for(Gi=Xn,us=Kr>>4,xr=0;4>xr;xr+=2){for(Un=0,Xn=fn.la>>4+xr,Kr=Ts.la>>4+xr,zn=0;2>zn;++zn){for(oi=1&Kr,Ws=0;2>Ws;++Ws)Cr=oi+(1&Xn),Xn=Xn>>1|(oi=0<(Cr=Jd(nr,cs[2],Cr,gr.Qc,0,An,xs)))<<3,Un=Un<<2|(3<Cr?3:1<Cr?2:An[xs+0]!=0),xs+=16;Xn>>=2,Kr=Kr>>1|oi<<5}Cn|=Un<<4*xr,Gi|=Xn<<4<<xr,us|=(240&Kr)<<xr}fn.la=Gi,Ts.la=us,Is.Hc=Xr,Is.Gc=Cn,Is.ia=43690&Cn?0:gr.ia,cs=!(Xr|Cn)}if(0<Nt.L&&(Nt.wa[Nt.Y+Nt.ja]=Nt.gd[gn.$b][gn.Za],Nt.wa[Nt.Y+Nt.ja].La|=!cs),Er.Ka)return cr(_n,7,"Premature end-of-file encountered.")}if(ma(_n),Nt=Yr,Er=1,gn=(Mt=_n).D,fn=0<Mt.L&&Mt.M>=Mt.zb&&Mt.M<=Mt.Va,Mt.Aa==0)t:{if(gn.M=Mt.M,gn.uc=fn,Ai(Mt,gn),Er=1,gn=(Un=Mt.D).Nb,fn=(Cn=Im[Mt.L])*Mt.R,nr=Cn/2*Mt.B,zn=16*gn*Mt.R,Ws=8*gn*Mt.B,cs=Mt.sa,Is=Mt.ta-fn+zn,gr=Mt.qa,An=Mt.ra-nr+Ws,xs=Mt.Ha,Ts=Mt.Ia-nr+Ws,Kr=(Xn=Un.M)==0,Xr=Xn>=Mt.Va-1,Mt.Aa==2&&Ai(Mt,Un),Un.uc)for(oi=(Cr=Mt).D.M,t(Cr.D.uc),Un=Cr.yb;Un<Cr.Hb;++Un){us=Un,Gi=oi;var Ls=(li=(ds=Cr).D).Nb;xr=ds.R;var li=li.wa[li.Y+us],ci=ds.sa,Gs=ds.ta+16*Ls*xr+16*us,ui=li.dd,er=li.tc;if(er!=0)if(t(3<=er),ds.L==1)0<us&&kj(ci,Gs,xr,er+4),li.La&&Cj(ci,Gs,xr,er),0<Gi&&Aj(ci,Gs,xr,er+4),li.La&&Ej(ci,Gs,xr,er);else{var di=ds.B,Yi=ds.qa,Yl=ds.ra+8*Ls*di+8*us,eo=ds.Ha,ds=ds.Ia+8*Ls*di+8*us;Ls=li.ld,0<us&&(Gr(ci,Gs,xr,er+4,ui,Ls),Xd(Yi,Yl,eo,ds,di,er+4,ui,Ls)),li.La&&(Nm(ci,Gs,xr,er,ui,Ls),Sj(Yi,Yl,eo,ds,di,er,ui,Ls)),0<Gi&&(kr(ci,Gs,xr,er+4,ui,Ls),Za(Yi,Yl,eo,ds,di,er+4,ui,Ls)),li.La&&(lu(ci,Gs,xr,er,ui,Ls),_j(Yi,Yl,eo,ds,di,er,ui,Ls))}}if(Mt.ia&&alert("todo:DitherRow"),Nt.put!=null){if(Un=16*Xn,Xn=16*(Xn+1),Kr?(Nt.y=Mt.sa,Nt.O=Mt.ta+zn,Nt.f=Mt.qa,Nt.N=Mt.ra+Ws,Nt.ea=Mt.Ha,Nt.W=Mt.Ia+Ws):(Un-=Cn,Nt.y=cs,Nt.O=Is,Nt.f=gr,Nt.N=An,Nt.ea=xs,Nt.W=Ts),Xr||(Xn-=Cn),Xn>Nt.o&&(Xn=Nt.o),Nt.F=null,Nt.J=null,Mt.Fa!=null&&0<Mt.Fa.length&&Un<Xn&&(Nt.J=Or(Mt,Nt,Un,Xn-Un),Nt.F=Mt.mb,Nt.F==null&&Nt.F.length==0)){Er=cr(Mt,3,"Could not decode alpha data.");break t}Un<Nt.j&&(Cn=Nt.j-Un,Un=Nt.j,t(!(1&Cn)),Nt.O+=Mt.R*Cn,Nt.N+=Mt.B*(Cn>>1),Nt.W+=Mt.B*(Cn>>1),Nt.F!=null&&(Nt.J+=Nt.width*Cn)),Un<Xn&&(Nt.O+=Nt.v,Nt.N+=Nt.v>>1,Nt.W+=Nt.v>>1,Nt.F!=null&&(Nt.J+=Nt.v),Nt.ka=Un-Nt.j,Nt.U=Nt.va-Nt.v,Nt.T=Xn-Un,Er=Nt.put(Nt))}gn+1!=Mt.Ic||Xr||(r(Mt.sa,Mt.ta-fn,cs,Is+16*Mt.R,fn),r(Mt.qa,Mt.ra-nr,gr,An+8*Mt.B,nr),r(Mt.Ha,Mt.Ia-nr,xs,Ts+8*Mt.B,nr))}if(!Er)return cr(_n,6,"Output aborted.")}return 1}(ue,Se)),Se.bc!=null&&Se.bc(Se),Le&=1}return Le?(ue.cb=0,Le):0})(v,U)||(j=v.a)}}else j=v.a}j==0&&Q.Oa!=null&&Q.Oa.fd&&(j=Ud(Q.ba))}Q=j}Z=Q!=0?null:11>Z?ne.f.RGBA.eb:ne.f.kb.y}else Z=null;return Z};var Xj=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function d(S,E){for(var _="",M=0;M<4;M++)_+=String.fromCharCode(S[E++]);return _}function u(S,E){return S[E+0]|S[E+1]<<8}function f(S,E){return(S[E+0]|S[E+1]<<8|S[E+2]<<16)>>>0}function m(S,E){return(S[E+0]|S[E+1]<<8|S[E+2]<<16|S[E+3]<<24)>>>0}new c;var h=[0],g=[0],y=[],p=new c,x=e,b=function(S,E){var _={},M=0,A=!1,P=0,B=0;if(_.frames=[],!function($,z){for(var q=0;q<4;q++)if($[z+q]!="RIFF".charCodeAt(q))return!0;return!1}(S,E)){for(m(S,E+=4),E+=8;E<S.length;){var L=d(S,E),D=m(S,E+=4);E+=4;var V=D+(1&D);switch(L){case"VP8 ":case"VP8L":_.frames[M]===void 0&&(_.frames[M]={}),(W=_.frames[M]).src_off=A?B:E-8,W.src_size=P+D+8,M++,A&&(A=!1,P=0,B=0);break;case"VP8X":(W=_.header={}).feature_flags=S[E];var O=E+4;W.canvas_width=1+f(S,O),O+=3,W.canvas_height=1+f(S,O),O+=3;break;case"ALPH":A=!0,P=V+8,B=E-8;break;case"ANIM":(W=_.header).bgcolor=m(S,E),O=E+4,W.loop_count=u(S,O),O+=2;break;case"ANMF":var H,W;(W=_.frames[M]={}).offset_x=2*f(S,E),E+=3,W.offset_y=2*f(S,E),E+=3,W.width=1+f(S,E),E+=3,W.height=1+f(S,E),E+=3,W.duration=f(S,E),E+=3,H=S[E++],W.dispose=1&H,W.blend=H>>1&1}L!="ANMF"&&(E+=V)}return _}}(x,0);b.response=x,b.rgbaoutput=!0,b.dataurl=!1;var w=b.header?b.header:null,N=b.frames?b.frames:null;if(w){w.loop_counter=w.loop_count,h=[w.canvas_height],g=[w.canvas_width];for(var k=0;k<N.length&&N[k].blend!=0;k++);}var I=N[0],R=p.WebPDecodeRGBA(x,I.src_off,I.src_size,g,h);I.rgba=R,I.imgwidth=g[0],I.imgheight=h[0];for(var T=0;T<g[0]*h[0]*4;T++)y[T]=R[T];return this.width=g,this.height=h,this.data=y,this}(function(e){var t,n,r,s,i,l,a,c,d,u=function($){return $=$||{},this.isStrokeTransparent=$.isStrokeTransparent||!1,this.strokeOpacity=$.strokeOpacity||1,this.strokeStyle=$.strokeStyle||"#000000",this.fillStyle=$.fillStyle||"#000000",this.isFillTransparent=$.isFillTransparent||!1,this.fillOpacity=$.fillOpacity||1,this.font=$.font||"10px sans-serif",this.textBaseline=$.textBaseline||"alphabetic",this.textAlign=$.textAlign||"left",this.lineWidth=$.lineWidth||1,this.lineJoin=$.lineJoin||"miter",this.lineCap=$.lineCap||"butt",this.path=$.path||[],this.transform=$.transform!==void 0?$.transform.clone():new c,this.globalCompositeOperation=$.globalCompositeOperation||"normal",this.globalAlpha=$.globalAlpha||1,this.clip_path=$.clip_path||[],this.currentPoint=$.currentPoint||new l,this.miterLimit=$.miterLimit||10,this.lastPoint=$.lastPoint||new l,this.lineDashOffset=$.lineDashOffset||0,this.lineDash=$.lineDash||[],this.margin=$.margin||[0,0,0,0],this.prevPageLastElemOffset=$.prevPageLastElemOffset||0,this.ignoreClearRect=typeof $.ignoreClearRect!="boolean"||$.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new f(this),t=this.internal.f2,n=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,l=this.internal.Point,a=this.internal.Rectangle,c=this.internal.Matrix,d=new u}]);var f=function($){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var z=$;Object.defineProperty(this,"pdf",{get:function(){return z}});var q=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return q},set:function(pe){q=!!pe}});var G=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return G},set:function(pe){G=!!pe}});var re=0;Object.defineProperty(this,"posX",{get:function(){return re},set:function(pe){isNaN(pe)||(re=pe)}});var oe=0;Object.defineProperty(this,"posY",{get:function(){return oe},set:function(pe){isNaN(pe)||(oe=pe)}}),Object.defineProperty(this,"margin",{get:function(){return d.margin},set:function(pe){var ee;typeof pe=="number"?ee=[pe,pe,pe,pe]:((ee=new Array(4))[0]=pe[0],ee[1]=pe.length>=2?pe[1]:ee[0],ee[2]=pe.length>=3?pe[2]:ee[0],ee[3]=pe.length>=4?pe[3]:ee[1]),d.margin=ee}});var ie=!1;Object.defineProperty(this,"autoPaging",{get:function(){return ie},set:function(pe){ie=pe}});var Y=0;Object.defineProperty(this,"lastBreak",{get:function(){return Y},set:function(pe){Y=pe}});var te=[];Object.defineProperty(this,"pageBreaks",{get:function(){return te},set:function(pe){te=pe}}),Object.defineProperty(this,"ctx",{get:function(){return d},set:function(pe){pe instanceof u&&(d=pe)}}),Object.defineProperty(this,"path",{get:function(){return d.path},set:function(pe){d.path=pe}});var we=[];Object.defineProperty(this,"ctxStack",{get:function(){return we},set:function(pe){we=pe}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(pe){var ee;ee=m(pe),this.ctx.fillStyle=ee.style,this.ctx.isFillTransparent=ee.a===0,this.ctx.fillOpacity=ee.a,this.pdf.setFillColor(ee.r,ee.g,ee.b,{a:ee.a}),this.pdf.setTextColor(ee.r,ee.g,ee.b,{a:ee.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(pe){var ee=m(pe);this.ctx.strokeStyle=ee.style,this.ctx.isStrokeTransparent=ee.a===0,this.ctx.strokeOpacity=ee.a,ee.a===0?this.pdf.setDrawColor(255,255,255):(ee.a,this.pdf.setDrawColor(ee.r,ee.g,ee.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(pe){["butt","round","square"].indexOf(pe)!==-1&&(this.ctx.lineCap=pe,this.pdf.setLineCap(pe))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(pe){isNaN(pe)||(this.ctx.lineWidth=pe,this.pdf.setLineWidth(pe))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(pe){["bevel","round","miter"].indexOf(pe)!==-1&&(this.ctx.lineJoin=pe,this.pdf.setLineJoin(pe))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(pe){isNaN(pe)||(this.ctx.miterLimit=pe,this.pdf.setMiterLimit(pe))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(pe){this.ctx.textBaseline=pe}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(pe){["right","end","center","left","start"].indexOf(pe)!==-1&&(this.ctx.textAlign=pe)}});var me=null,Ee=null;Object.defineProperty(this,"fontFaces",{get:function(){return Ee},set:function(pe){me=null,Ee=pe}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(pe){var ee;if(this.ctx.font=pe,(ee=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(pe))!==null){var ft=ee[1];ee[2];var $e=ee[3],De=ee[4];ee[5];var ge=ee[6],Me=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(De)[2];De=Math.floor(Me==="px"?parseFloat(De)*this.pdf.internal.scaleFactor:Me==="em"?parseFloat(De)*this.pdf.getFontSize():parseFloat(De)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(De);var _e=function(fe){var Te,at,je=[],he=fe.trim();if(he==="")return yy;if(he in aA)return[aA[he]];for(;he!=="";){switch(at=null,Te=(he=lA(he)).charAt(0)){case'"':case"'":at=fde(he.substring(1),Te);break;default:at=hde(he)}if(at===null||(je.push(at[0]),(he=lA(at[1]))!==""&&he.charAt(0)!==","))return yy;he=he.replace(/^,/,"")}return je}(ge);if(this.fontFaces){var ke=function(fe,Te){if(me===null){var at=function(je){var he=[];return Object.keys(je).forEach(function(Pe){je[Pe].forEach(function(ot){var tt=null;switch(ot){case"bold":tt={family:Pe,weight:"bold"};break;case"italic":tt={family:Pe,style:"italic"};break;case"bolditalic":tt={family:Pe,weight:"bold",style:"italic"};break;case"":case"normal":tt={family:Pe}}tt!==null&&(tt.ref={name:Pe,style:ot},he.push(tt))})}),he}(fe.getFontList());me=function(je){for(var he={},Pe=0;Pe<je.length;++Pe){var ot=xy(je[Pe]),tt=ot.family,qe=ot.stretch,ze=ot.style,it=ot.weight;he[tt]=he[tt]||{},he[tt][qe]=he[tt][qe]||{},he[tt][qe][ze]=he[tt][qe][ze]||{},he[tt][qe][ze][it]=ot}return he}(at.concat(Te))}return me}(this.pdf,this.fontFaces),se=_e.map(function(fe){return{family:fe,stretch:"normal",weight:$e,style:ft}}),Ae=function(fe,Te,at){for(var je=(at=at||{}).defaultFontFamily||"times",he=Object.assign({},dde,at.genericFontFamilies||{}),Pe=null,ot=null,tt=0;tt<Te.length;++tt)if(he[(Pe=xy(Te[tt])).family]&&(Pe.family=he[Pe.family]),fe.hasOwnProperty(Pe.family)){ot=fe[Pe.family];break}if(!(ot=ot||fe[je]))throw new Error("Could not find a font-family for the rule '"+oA(Pe)+"' and default family '"+je+"'.");if(ot=function(qe,ze){if(ze[qe])return ze[qe];var it=GN[qe],st=it<=GN.normal?-1:1,Ve=iA(ze,FO,it,st);if(!Ve)throw new Error("Could not find a matching font-stretch value for "+qe);return Ve}(Pe.stretch,ot),ot=function(qe,ze){if(ze[qe])return ze[qe];for(var it=OO[qe],st=0;st<it.length;++st)if(ze[it[st]])return ze[it[st]];throw new Error("Could not find a matching font-style for "+qe)}(Pe.style,ot),!(ot=function(qe,ze){if(ze[qe])return ze[qe];if(qe===400&&ze[500])return ze[500];if(qe===500&&ze[400])return ze[400];var it=ude[qe],st=iA(ze,DO,it,qe<400?-1:1);if(!st)throw new Error("Could not find a matching font-weight for value "+qe);return st}(Pe.weight,ot)))throw new Error("Failed to resolve a font for the rule '"+oA(Pe)+"'.");return ot}(ke,se);this.pdf.setFont(Ae.ref.name,Ae.ref.style)}else{var Re="";($e==="bold"||parseInt($e,10)>=700||ft==="bold")&&(Re="bold"),ft==="italic"&&(Re+="italic"),Re.length===0&&(Re="normal");for(var Ce="",ve={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Be=0;Be<_e.length;Be++){if(this.pdf.internal.getFont(_e[Be],Re,{noFallback:!0,disableWarning:!0})!==void 0){Ce=_e[Be];break}if(Re==="bolditalic"&&this.pdf.internal.getFont(_e[Be],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Ce=_e[Be],Re="bold";else if(this.pdf.internal.getFont(_e[Be],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Ce=_e[Be],Re="normal";break}}if(Ce===""){for(var le=0;le<_e.length;le++)if(ve[_e[le]]){Ce=ve[_e[le]];break}}Ce=Ce===""?"Times":Ce,this.pdf.setFont(Ce,Re)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(pe){this.ctx.globalCompositeOperation=pe}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(pe){this.ctx.globalAlpha=pe}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(pe){this.ctx.lineDashOffset=pe,W.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(pe){this.ctx.lineDash=pe,W.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(pe){this.ctx.ignoreClearRect=!!pe}})};f.prototype.setLineDash=function($){this.lineDash=$},f.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},f.prototype.fill=function(){N.call(this,"fill",!1)},f.prototype.stroke=function(){N.call(this,"stroke",!1)},f.prototype.beginPath=function(){this.path=[{type:"begin"}]},f.prototype.moveTo=function($,z){if(isNaN($)||isNaN(z))throw Kn.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var q=this.ctx.transform.applyToPoint(new l($,z));this.path.push({type:"mt",x:q.x,y:q.y}),this.ctx.lastPoint=new l($,z)},f.prototype.closePath=function(){var $=new l(0,0),z=0;for(z=this.path.length-1;z!==-1;z--)if(this.path[z].type==="begin"&&Wn(this.path[z+1])==="object"&&typeof this.path[z+1].x=="number"){$=new l(this.path[z+1].x,this.path[z+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new l($.x,$.y)},f.prototype.lineTo=function($,z){if(isNaN($)||isNaN(z))throw Kn.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var q=this.ctx.transform.applyToPoint(new l($,z));this.path.push({type:"lt",x:q.x,y:q.y}),this.ctx.lastPoint=new l(q.x,q.y)},f.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),N.call(this,null,!0)},f.prototype.quadraticCurveTo=function($,z,q,G){if(isNaN(q)||isNaN(G)||isNaN($)||isNaN(z))throw Kn.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var re=this.ctx.transform.applyToPoint(new l(q,G)),oe=this.ctx.transform.applyToPoint(new l($,z));this.path.push({type:"qct",x1:oe.x,y1:oe.y,x:re.x,y:re.y}),this.ctx.lastPoint=new l(re.x,re.y)},f.prototype.bezierCurveTo=function($,z,q,G,re,oe){if(isNaN(re)||isNaN(oe)||isNaN($)||isNaN(z)||isNaN(q)||isNaN(G))throw Kn.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var ie=this.ctx.transform.applyToPoint(new l(re,oe)),Y=this.ctx.transform.applyToPoint(new l($,z)),te=this.ctx.transform.applyToPoint(new l(q,G));this.path.push({type:"bct",x1:Y.x,y1:Y.y,x2:te.x,y2:te.y,x:ie.x,y:ie.y}),this.ctx.lastPoint=new l(ie.x,ie.y)},f.prototype.arc=function($,z,q,G,re,oe){if(isNaN($)||isNaN(z)||isNaN(q)||isNaN(G)||isNaN(re))throw Kn.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(oe=!!oe,!this.ctx.transform.isIdentity){var ie=this.ctx.transform.applyToPoint(new l($,z));$=ie.x,z=ie.y;var Y=this.ctx.transform.applyToPoint(new l(0,q)),te=this.ctx.transform.applyToPoint(new l(0,0));q=Math.sqrt(Math.pow(Y.x-te.x,2)+Math.pow(Y.y-te.y,2))}Math.abs(re-G)>=2*Math.PI&&(G=0,re=2*Math.PI),this.path.push({type:"arc",x:$,y:z,radius:q,startAngle:G,endAngle:re,counterclockwise:oe})},f.prototype.arcTo=function($,z,q,G,re){throw new Error("arcTo not implemented.")},f.prototype.rect=function($,z,q,G){if(isNaN($)||isNaN(z)||isNaN(q)||isNaN(G))throw Kn.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo($,z),this.lineTo($+q,z),this.lineTo($+q,z+G),this.lineTo($,z+G),this.lineTo($,z),this.lineTo($+q,z),this.lineTo($,z)},f.prototype.fillRect=function($,z,q,G){if(isNaN($)||isNaN(z)||isNaN(q)||isNaN(G))throw Kn.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!h.call(this)){var re={};this.lineCap!=="butt"&&(re.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(re.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect($,z,q,G),this.fill(),re.hasOwnProperty("lineCap")&&(this.lineCap=re.lineCap),re.hasOwnProperty("lineJoin")&&(this.lineJoin=re.lineJoin)}},f.prototype.strokeRect=function($,z,q,G){if(isNaN($)||isNaN(z)||isNaN(q)||isNaN(G))throw Kn.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");g.call(this)||(this.beginPath(),this.rect($,z,q,G),this.stroke())},f.prototype.clearRect=function($,z,q,G){if(isNaN($)||isNaN(z)||isNaN(q)||isNaN(G))throw Kn.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect($,z,q,G))},f.prototype.save=function($){$=typeof $!="boolean"||$;for(var z=this.pdf.internal.getCurrentPageInfo().pageNumber,q=0;q<this.pdf.internal.getNumberOfPages();q++)this.pdf.setPage(q+1),this.pdf.internal.out("q");if(this.pdf.setPage(z),$){this.ctx.fontSize=this.pdf.internal.getFontSize();var G=new u(this.ctx);this.ctxStack.push(this.ctx),this.ctx=G}},f.prototype.restore=function($){$=typeof $!="boolean"||$;for(var z=this.pdf.internal.getCurrentPageInfo().pageNumber,q=0;q<this.pdf.internal.getNumberOfPages();q++)this.pdf.setPage(q+1),this.pdf.internal.out("Q");this.pdf.setPage(z),$&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},f.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var m=function($){var z,q,G,re;if($.isCanvasGradient===!0&&($=$.getColor()),!$)return{r:0,g:0,b:0,a:0,style:$};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test($))z=0,q=0,G=0,re=0;else{var oe=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec($);if(oe!==null)z=parseInt(oe[1]),q=parseInt(oe[2]),G=parseInt(oe[3]),re=1;else if((oe=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec($))!==null)z=parseInt(oe[1]),q=parseInt(oe[2]),G=parseInt(oe[3]),re=parseFloat(oe[4]);else{if(re=1,typeof $=="string"&&$.charAt(0)!=="#"){var ie=new PO($);$=ie.ok?ie.toHex():"#000000"}$.length===4?(z=$.substring(1,2),z+=z,q=$.substring(2,3),q+=q,G=$.substring(3,4),G+=G):(z=$.substring(1,3),q=$.substring(3,5),G=$.substring(5,7)),z=parseInt(z,16),q=parseInt(q,16),G=parseInt(G,16)}}return{r:z,g:q,b:G,a:re,style:$}},h=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},g=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};f.prototype.fillText=function($,z,q,G){if(isNaN(z)||isNaN(q)||typeof $!="string")throw Kn.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(G=isNaN(G)?void 0:G,!h.call(this)){var re=V(this.ctx.transform.rotation),oe=this.ctx.transform.scaleX;M.call(this,{text:$,x:z,y:q,scale:oe,angle:re,align:this.textAlign,maxWidth:G})}},f.prototype.strokeText=function($,z,q,G){if(isNaN(z)||isNaN(q)||typeof $!="string")throw Kn.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!g.call(this)){G=isNaN(G)?void 0:G;var re=V(this.ctx.transform.rotation),oe=this.ctx.transform.scaleX;M.call(this,{text:$,x:z,y:q,scale:oe,renderingMode:"stroke",angle:re,align:this.textAlign,maxWidth:G})}},f.prototype.measureText=function($){if(typeof $!="string")throw Kn.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var z=this.pdf,q=this.pdf.internal.scaleFactor,G=z.internal.getFontSize(),re=z.getStringUnitWidth($)*G/z.internal.scaleFactor;return new function(oe){var ie=(oe=oe||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return ie}}),this}({width:re*=Math.round(96*q/72*1e4)/1e4})},f.prototype.scale=function($,z){if(isNaN($)||isNaN(z))throw Kn.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var q=new c($,0,0,z,0,0);this.ctx.transform=this.ctx.transform.multiply(q)},f.prototype.rotate=function($){if(isNaN($))throw Kn.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var z=new c(Math.cos($),Math.sin($),-Math.sin($),Math.cos($),0,0);this.ctx.transform=this.ctx.transform.multiply(z)},f.prototype.translate=function($,z){if(isNaN($)||isNaN(z))throw Kn.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var q=new c(1,0,0,1,$,z);this.ctx.transform=this.ctx.transform.multiply(q)},f.prototype.transform=function($,z,q,G,re,oe){if(isNaN($)||isNaN(z)||isNaN(q)||isNaN(G)||isNaN(re)||isNaN(oe))throw Kn.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var ie=new c($,z,q,G,re,oe);this.ctx.transform=this.ctx.transform.multiply(ie)},f.prototype.setTransform=function($,z,q,G,re,oe){$=isNaN($)?1:$,z=isNaN(z)?0:z,q=isNaN(q)?0:q,G=isNaN(G)?1:G,re=isNaN(re)?0:re,oe=isNaN(oe)?0:oe,this.ctx.transform=new c($,z,q,G,re,oe)};var y=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};f.prototype.drawImage=function($,z,q,G,re,oe,ie,Y,te){var we=this.pdf.getImageProperties($),me=1,Ee=1,pe=1,ee=1;G!==void 0&&Y!==void 0&&(pe=Y/G,ee=te/re,me=we.width/G*Y/G,Ee=we.height/re*te/re),oe===void 0&&(oe=z,ie=q,z=0,q=0),G!==void 0&&Y===void 0&&(Y=G,te=re),G===void 0&&Y===void 0&&(Y=we.width,te=we.height);for(var ft,$e=this.ctx.transform.decompose(),De=V($e.rotate.shx),ge=new c,Me=(ge=(ge=(ge=ge.multiply($e.translate)).multiply($e.skew)).multiply($e.scale)).applyToRectangle(new a(oe-z*pe,ie-q*ee,G*me,re*Ee)),_e=p.call(this,Me),ke=[],se=0;se<_e.length;se+=1)ke.indexOf(_e[se])===-1&&ke.push(_e[se]);if(w(ke),this.autoPaging)for(var Ae=ke[0],Re=ke[ke.length-1],Ce=Ae;Ce<Re+1;Ce++){this.pdf.setPage(Ce);var ve=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Be=Ce===1?this.posY+this.margin[0]:this.margin[0],le=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],fe=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Te=Ce===1?0:le+(Ce-2)*fe;if(this.ctx.clip_path.length!==0){var at=this.path;ft=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(ft,this.posX+this.margin[3],-Te+Be+this.ctx.prevPageLastElemOffset),k.call(this,"fill",!0),this.path=at}var je=JSON.parse(JSON.stringify(Me));je=b([je],this.posX+this.margin[3],-Te+Be+this.ctx.prevPageLastElemOffset)[0];var he=(Ce>Ae||Ce<Re)&&y.call(this);he&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ve,fe,null).clip().discardPath()),this.pdf.addImage($,"JPEG",je.x,je.y,je.w,je.h,null,null,De),he&&this.pdf.restoreGraphicsState()}else this.pdf.addImage($,"JPEG",Me.x,Me.y,Me.w,Me.h,null,null,De)};var p=function($,z,q){var G=[];z=z||this.pdf.internal.pageSize.width,q=q||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var re=this.posY+this.ctx.prevPageLastElemOffset;switch($.type){default:case"mt":case"lt":G.push(Math.floor(($.y+re)/q)+1);break;case"arc":G.push(Math.floor(($.y+re-$.radius)/q)+1),G.push(Math.floor(($.y+re+$.radius)/q)+1);break;case"qct":var oe=O(this.ctx.lastPoint.x,this.ctx.lastPoint.y,$.x1,$.y1,$.x,$.y);G.push(Math.floor((oe.y+re)/q)+1),G.push(Math.floor((oe.y+oe.h+re)/q)+1);break;case"bct":var ie=H(this.ctx.lastPoint.x,this.ctx.lastPoint.y,$.x1,$.y1,$.x2,$.y2,$.x,$.y);G.push(Math.floor((ie.y+re)/q)+1),G.push(Math.floor((ie.y+ie.h+re)/q)+1);break;case"rect":G.push(Math.floor(($.y+re)/q)+1),G.push(Math.floor(($.y+$.h+re)/q)+1)}for(var Y=0;Y<G.length;Y+=1)for(;this.pdf.internal.getNumberOfPages()<G[Y];)x.call(this);return G},x=function(){var $=this.fillStyle,z=this.strokeStyle,q=this.font,G=this.lineCap,re=this.lineWidth,oe=this.lineJoin;this.pdf.addPage(),this.fillStyle=$,this.strokeStyle=z,this.font=q,this.lineCap=G,this.lineWidth=re,this.lineJoin=oe},b=function($,z,q){for(var G=0;G<$.length;G++)switch($[G].type){case"bct":$[G].x2+=z,$[G].y2+=q;case"qct":$[G].x1+=z,$[G].y1+=q;default:$[G].x+=z,$[G].y+=q}return $},w=function($){return $.sort(function(z,q){return z-q})},N=function($,z){for(var q,G,re=this.fillStyle,oe=this.strokeStyle,ie=this.lineCap,Y=this.lineWidth,te=Math.abs(Y*this.ctx.transform.scaleX),we=this.lineJoin,me=JSON.parse(JSON.stringify(this.path)),Ee=JSON.parse(JSON.stringify(this.path)),pe=[],ee=0;ee<Ee.length;ee++)if(Ee[ee].x!==void 0)for(var ft=p.call(this,Ee[ee]),$e=0;$e<ft.length;$e+=1)pe.indexOf(ft[$e])===-1&&pe.push(ft[$e]);for(var De=0;De<pe.length;De++)for(;this.pdf.internal.getNumberOfPages()<pe[De];)x.call(this);if(w(pe),this.autoPaging)for(var ge=pe[0],Me=pe[pe.length-1],_e=ge;_e<Me+1;_e++){this.pdf.setPage(_e),this.fillStyle=re,this.strokeStyle=oe,this.lineCap=ie,this.lineWidth=te,this.lineJoin=we;var ke=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],se=_e===1?this.posY+this.margin[0]:this.margin[0],Ae=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Re=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ce=_e===1?0:Ae+(_e-2)*Re;if(this.ctx.clip_path.length!==0){var ve=this.path;q=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(q,this.posX+this.margin[3],-Ce+se+this.ctx.prevPageLastElemOffset),k.call(this,$,!0),this.path=ve}if(G=JSON.parse(JSON.stringify(me)),this.path=b(G,this.posX+this.margin[3],-Ce+se+this.ctx.prevPageLastElemOffset),z===!1||_e===0){var Be=(_e>ge||_e<Me)&&y.call(this);Be&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],ke,Re,null).clip().discardPath()),k.call(this,$,z),Be&&this.pdf.restoreGraphicsState()}this.lineWidth=Y}else this.lineWidth=te,k.call(this,$,z),this.lineWidth=Y;this.path=me},k=function($,z){if(($!=="stroke"||z||!g.call(this))&&($==="stroke"||z||!h.call(this))){for(var q,G,re=[],oe=this.path,ie=0;ie<oe.length;ie++){var Y=oe[ie];switch(Y.type){case"begin":re.push({begin:!0});break;case"close":re.push({close:!0});break;case"mt":re.push({start:Y,deltas:[],abs:[]});break;case"lt":var te=re.length;if(oe[ie-1]&&!isNaN(oe[ie-1].x)&&(q=[Y.x-oe[ie-1].x,Y.y-oe[ie-1].y],te>0)){for(;te>=0;te--)if(re[te-1].close!==!0&&re[te-1].begin!==!0){re[te-1].deltas.push(q),re[te-1].abs.push(Y);break}}break;case"bct":q=[Y.x1-oe[ie-1].x,Y.y1-oe[ie-1].y,Y.x2-oe[ie-1].x,Y.y2-oe[ie-1].y,Y.x-oe[ie-1].x,Y.y-oe[ie-1].y],re[re.length-1].deltas.push(q);break;case"qct":var we=oe[ie-1].x+2/3*(Y.x1-oe[ie-1].x),me=oe[ie-1].y+2/3*(Y.y1-oe[ie-1].y),Ee=Y.x+2/3*(Y.x1-Y.x),pe=Y.y+2/3*(Y.y1-Y.y),ee=Y.x,ft=Y.y;q=[we-oe[ie-1].x,me-oe[ie-1].y,Ee-oe[ie-1].x,pe-oe[ie-1].y,ee-oe[ie-1].x,ft-oe[ie-1].y],re[re.length-1].deltas.push(q);break;case"arc":re.push({deltas:[],abs:[],arc:!0}),Array.isArray(re[re.length-1].abs)&&re[re.length-1].abs.push(Y)}}G=z?null:$==="stroke"?"stroke":"fill";for(var $e=!1,De=0;De<re.length;De++)if(re[De].arc)for(var ge=re[De].abs,Me=0;Me<ge.length;Me++){var _e=ge[Me];_e.type==="arc"?T.call(this,_e.x,_e.y,_e.radius,_e.startAngle,_e.endAngle,_e.counterclockwise,void 0,z,!$e):A.call(this,_e.x,_e.y),$e=!0}else if(re[De].close===!0)this.pdf.internal.out("h"),$e=!1;else if(re[De].begin!==!0){var ke=re[De].start.x,se=re[De].start.y;P.call(this,re[De].deltas,ke,se),$e=!0}G&&S.call(this,G),z&&E.call(this)}},I=function($){var z=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,q=z*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return $-q;case"top":return $+z-q;case"hanging":return $+z-2*q;case"middle":return $+z/2-q;default:return $}},R=function($){return $+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};f.prototype.createLinearGradient=function(){var $=function(){};return $.colorStops=[],$.addColorStop=function(z,q){this.colorStops.push([z,q])},$.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},$.isCanvasGradient=!0,$},f.prototype.createPattern=function(){return this.createLinearGradient()},f.prototype.createRadialGradient=function(){return this.createLinearGradient()};var T=function($,z,q,G,re,oe,ie,Y,te){for(var we=L.call(this,q,G,re,oe),me=0;me<we.length;me++){var Ee=we[me];me===0&&(te?_.call(this,Ee.x1+$,Ee.y1+z):A.call(this,Ee.x1+$,Ee.y1+z)),B.call(this,$,z,Ee.x2,Ee.y2,Ee.x3,Ee.y3,Ee.x4,Ee.y4)}Y?E.call(this):S.call(this,ie)},S=function($){switch($){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},E=function(){this.pdf.clip(),this.pdf.discardPath()},_=function($,z){this.pdf.internal.out(n($)+" "+r(z)+" m")},M=function($){var z;switch($.align){case"right":case"end":z="right";break;case"center":z="center";break;default:z="left"}var q=this.pdf.getTextDimensions($.text),G=I.call(this,$.y),re=R.call(this,G)-q.h,oe=this.ctx.transform.applyToPoint(new l($.x,G)),ie=this.ctx.transform.decompose(),Y=new c;Y=(Y=(Y=Y.multiply(ie.translate)).multiply(ie.skew)).multiply(ie.scale);for(var te,we,me,Ee=this.ctx.transform.applyToRectangle(new a($.x,G,q.w,q.h)),pe=Y.applyToRectangle(new a($.x,re,q.w,q.h)),ee=p.call(this,pe),ft=[],$e=0;$e<ee.length;$e+=1)ft.indexOf(ee[$e])===-1&&ft.push(ee[$e]);if(w(ft),this.autoPaging)for(var De=ft[0],ge=ft[ft.length-1],Me=De;Me<ge+1;Me++){this.pdf.setPage(Me);var _e=Me===1?this.posY+this.margin[0]:this.margin[0],ke=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],se=this.pdf.internal.pageSize.height-this.margin[2],Ae=se-this.margin[0],Re=this.pdf.internal.pageSize.width-this.margin[1],Ce=Re-this.margin[3],ve=Me===1?0:ke+(Me-2)*Ae;if(this.ctx.clip_path.length!==0){var Be=this.path;te=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=b(te,this.posX+this.margin[3],-1*ve+_e),k.call(this,"fill",!0),this.path=Be}var le=b([JSON.parse(JSON.stringify(pe))],this.posX+this.margin[3],-ve+_e+this.ctx.prevPageLastElemOffset)[0];$.scale>=.01&&(we=this.pdf.internal.getFontSize(),this.pdf.setFontSize(we*$.scale),me=this.lineWidth,this.lineWidth=me*$.scale);var fe=this.autoPaging!=="text";if(fe||le.y+le.h<=se){if(fe||le.y>=_e&&le.x<=Re){var Te=fe?$.text:this.pdf.splitTextToSize($.text,$.maxWidth||Re-le.x)[0],at=b([JSON.parse(JSON.stringify(Ee))],this.posX+this.margin[3],-ve+_e+this.ctx.prevPageLastElemOffset)[0],je=fe&&(Me>De||Me<ge)&&y.call(this);je&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ce,Ae,null).clip().discardPath()),this.pdf.text(Te,at.x,at.y,{angle:$.angle,align:z,renderingMode:$.renderingMode}),je&&this.pdf.restoreGraphicsState()}}else le.y<se&&(this.ctx.prevPageLastElemOffset+=se-le.y);$.scale>=.01&&(this.pdf.setFontSize(we),this.lineWidth=me)}else $.scale>=.01&&(we=this.pdf.internal.getFontSize(),this.pdf.setFontSize(we*$.scale),me=this.lineWidth,this.lineWidth=me*$.scale),this.pdf.text($.text,oe.x+this.posX,oe.y+this.posY,{angle:$.angle,align:z,renderingMode:$.renderingMode,maxWidth:$.maxWidth}),$.scale>=.01&&(this.pdf.setFontSize(we),this.lineWidth=me)},A=function($,z,q,G){q=q||0,G=G||0,this.pdf.internal.out(n($+q)+" "+r(z+G)+" l")},P=function($,z,q){return this.pdf.lines($,z,q,null,null)},B=function($,z,q,G,re,oe,ie,Y){this.pdf.internal.out([t(s(q+$)),t(i(G+z)),t(s(re+$)),t(i(oe+z)),t(s(ie+$)),t(i(Y+z)),"c"].join(" "))},L=function($,z,q,G){for(var re=2*Math.PI,oe=Math.PI/2;z>q;)z-=re;var ie=Math.abs(q-z);ie<re&&G&&(ie=re-ie);for(var Y=[],te=G?-1:1,we=z;ie>1e-5;){var me=we+te*Math.min(ie,oe);Y.push(D.call(this,$,we,me)),ie-=Math.abs(me-we),we=me}return Y},D=function($,z,q){var G=(q-z)/2,re=$*Math.cos(G),oe=$*Math.sin(G),ie=re,Y=-oe,te=ie*ie+Y*Y,we=te+ie*re+Y*oe,me=4/3*(Math.sqrt(2*te*we)-we)/(ie*oe-Y*re),Ee=ie-me*Y,pe=Y+me*ie,ee=Ee,ft=-pe,$e=G+z,De=Math.cos($e),ge=Math.sin($e);return{x1:$*Math.cos(z),y1:$*Math.sin(z),x2:Ee*De-pe*ge,y2:Ee*ge+pe*De,x3:ee*De-ft*ge,y3:ee*ge+ft*De,x4:$*Math.cos(q),y4:$*Math.sin(q)}},V=function($){return 180*$/Math.PI},O=function($,z,q,G,re,oe){var ie=$+.5*(q-$),Y=z+.5*(G-z),te=re+.5*(q-re),we=oe+.5*(G-oe),me=Math.min($,re,ie,te),Ee=Math.max($,re,ie,te),pe=Math.min(z,oe,Y,we),ee=Math.max(z,oe,Y,we);return new a(me,pe,Ee-me,ee-pe)},H=function($,z,q,G,re,oe,ie,Y){var te,we,me,Ee,pe,ee,ft,$e,De,ge,Me,_e,ke,se,Ae=q-$,Re=G-z,Ce=re-q,ve=oe-G,Be=ie-re,le=Y-oe;for(we=0;we<41;we++)De=(ft=(me=$+(te=we/40)*Ae)+te*((pe=q+te*Ce)-me))+te*(pe+te*(re+te*Be-pe)-ft),ge=($e=(Ee=z+te*Re)+te*((ee=G+te*ve)-Ee))+te*(ee+te*(oe+te*le-ee)-$e),we==0?(Me=De,_e=ge,ke=De,se=ge):(Me=Math.min(Me,De),_e=Math.min(_e,ge),ke=Math.max(ke,De),se=Math.max(se,ge));return new a(Math.round(Me),Math.round(_e),Math.round(ke-Me),Math.round(se-_e))},W=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var $,z,q=($=this.ctx.lineDash,z=this.ctx.lineDashOffset,JSON.stringify({lineDash:$,lineDashOffset:z}));this.prevLineDash!==q&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=q)}}})(qt.API),function(e){var t=function(l){var a,c,d,u,f,m,h,g,y,p;for(c=[],d=0,u=(l+=a="\0\0\0\0".slice(l.length%4||4)).length;u>d;d+=4)(f=(l.charCodeAt(d)<<24)+(l.charCodeAt(d+1)<<16)+(l.charCodeAt(d+2)<<8)+l.charCodeAt(d+3))!==0?(m=(f=((f=((f=((f=(f-(p=f%85))/85)-(y=f%85))/85)-(g=f%85))/85)-(h=f%85))/85)%85,c.push(m+33,h+33,g+33,y+33,p+33)):c.push(122);return function(x,b){for(var w=b;w>0;w--)x.pop()}(c,a.length),String.fromCharCode.apply(String,c)+"~>"},n=function(l){var a,c,d,u,f,m=String,h="length",g=255,y="charCodeAt",p="slice",x="replace";for(l[p](-2),l=l[p](0,-2)[x](/\s/g,"")[x]("z","!!!!!"),d=[],u=0,f=(l+=a="uuuuu"[p](l[h]%5||5))[h];f>u;u+=5)c=52200625*(l[y](u)-33)+614125*(l[y](u+1)-33)+7225*(l[y](u+2)-33)+85*(l[y](u+3)-33)+(l[y](u+4)-33),d.push(g&c>>24,g&c>>16,g&c>>8,g&c);return function(b,w){for(var N=w;N>0;N--)b.pop()}(d,a[h]),m.fromCharCode.apply(m,d)},r=function(l){return l.split("").map(function(a){return("0"+a.charCodeAt().toString(16)).slice(-2)}).join("")+">"},s=function(l){var a=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((l=l.replace(/\s/g,"")).indexOf(">")!==-1&&(l=l.substr(0,l.indexOf(">"))),l.length%2&&(l+="0"),a.test(l)===!1)return"";for(var c="",d=0;d<l.length;d+=2)c+=String.fromCharCode("0x"+(l[d]+l[d+1]));return c},i=function(l){for(var a=new Uint8Array(l.length),c=l.length;c--;)a[c]=l.charCodeAt(c);return(a=qN(a)).reduce(function(d,u){return d+String.fromCharCode(u)},"")};e.processDataByFilters=function(l,a){var c=0,d=l||"",u=[];for(typeof(a=a||[])=="string"&&(a=[a]),c=0;c<a.length;c+=1)switch(a[c]){case"ASCII85Decode":case"/ASCII85Decode":d=n(d),u.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":d=t(d),u.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":d=s(d),u.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":d=r(d),u.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":d=i(d),u.push("/FlateDecode");break;default:throw new Error('The filter: "'+a[c]+'" is not implemented')}return{data:d,reverseChain:u.reverse().join(" ")}}}(qt.API),function(e){e.loadFile=function(t,n,r){return function(s,i,l){i=i!==!1,l=typeof l=="function"?l:function(){};var a=void 0;try{a=function(c,d,u){var f=new XMLHttpRequest,m=0,h=function(g){var y=g.length,p=[],x=String.fromCharCode;for(m=0;m<y;m+=1)p.push(x(255&g.charCodeAt(m)));return p.join("")};if(f.open("GET",c,!d),f.overrideMimeType("text/plain; charset=x-user-defined"),d===!1&&(f.onload=function(){f.status===200?u(h(this.responseText)):u(void 0)}),f.send(null),d&&f.status===200)return h(f.responseText)}(s,i,l)}catch{}return a}(t,n,r)},e.loadImageFile=e.loadFile}(qt.API),function(e){function t(){return(nn.html2canvas?Promise.resolve(nn.html2canvas):Vp(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(a){return Promise.reject(new Error("Could not load html2canvas: "+a))}).then(function(a){return a.default?a.default:a})}function n(){return(nn.DOMPurify?Promise.resolve(nn.DOMPurify):Vp(()=>import("./purify.es-aGzT-_H7.js"),[])).catch(function(a){return Promise.reject(new Error("Could not load dompurify: "+a))}).then(function(a){return a.default?a.default:a})}var r=function(a){var c=Wn(a);return c==="undefined"?"undefined":c==="string"||a instanceof String?"string":c==="number"||a instanceof Number?"number":c==="function"||a instanceof Function?"function":a&&a.constructor===Array?"array":a&&a.nodeType===1?"element":c==="object"?"object":"unknown"},s=function(a,c){var d=document.createElement(a);for(var u in c.className&&(d.className=c.className),c.innerHTML&&c.dompurify&&(d.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)d.style[u]=c.style[u];return d},i=function a(c,d){for(var u=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),f=c.firstChild;f;f=f.nextSibling)d!==!0&&f.nodeType===1&&f.nodeName==="SCRIPT"||u.appendChild(a(f,d));return c.nodeType===1&&(c.nodeName==="CANVAS"?(u.width=c.width,u.height=c.height,u.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(u.value=c.value),u.addEventListener("load",function(){u.scrollTop=c.scrollTop,u.scrollLeft=c.scrollLeft},!0)),u},l=function a(c){var d=Object.assign(a.convert(Promise.resolve()),JSON.parse(JSON.stringify(a.template))),u=a.convert(Promise.resolve(),d);return(u=u.setProgress(1,a,1,[a])).set(c)};(l.prototype=Object.create(Promise.prototype)).constructor=l,l.convert=function(a,c){return a.__proto__=c||l.prototype,a},l.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},l.prototype.from=function(a,c){return this.then(function(){switch(c=c||function(d){switch(r(d)){case"string":return"string";case"element":return d.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(a),c){case"string":return this.then(n).then(function(d){return this.set({src:s("div",{innerHTML:a,dompurify:d})})});case"element":return this.set({src:a});case"canvas":return this.set({canvas:a});case"img":return this.set({img:a});default:return this.error("Unknown source type.")}})},l.prototype.to=function(a){switch(a){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},l.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var a={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=i(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(a.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:a}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},l.prototype.toCanvas=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(t).then(function(c){var d=Object.assign({},this.opt.html2canvas);return delete d.onrendered,c(this.prop.container,d)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},l.prototype.toContext2d=function(){var a=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(a).then(t).then(function(c){var d=this.opt.jsPDF,u=this.opt.fontFaces,f=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,m=Object.assign({async:!0,allowTaint:!0,scale:f,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete m.onrendered,d.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,d.context2d.posX=this.opt.x,d.context2d.posY=this.opt.y,d.context2d.margin=this.opt.margin,d.context2d.fontFaces=u,u)for(var h=0;h<u.length;++h){var g=u[h],y=g.src.find(function(p){return p.format==="truetype"});y&&d.addFont(y.url,g.ref.name,g.ref.style)}return m.windowHeight=m.windowHeight||0,m.windowHeight=m.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):m.windowHeight,d.context2d.save(!0),c(this.prop.container,m)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},l.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var a=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=a})},l.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},l.prototype.output=function(a,c,d){return(d=d||"pdf").toLowerCase()==="img"||d.toLowerCase()==="image"?this.outputImg(a,c):this.outputPdf(a,c)},l.prototype.outputPdf=function(a,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(a,c)})},l.prototype.outputImg=function(a){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(a){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+a+'" is not supported.'}})},l.prototype.save=function(a){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(a?{filename:a}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},l.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},l.prototype.set=function(a){if(r(a)!=="object")return this;var c=Object.keys(a||{}).map(function(d){if(d in l.template.prop)return function(){this.prop[d]=a[d]};switch(d){case"margin":return this.setMargin.bind(this,a.margin);case"jsPDF":return function(){return this.opt.jsPDF=a.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,a.pageSize);default:return function(){this.opt[d]=a[d]}}},this);return this.then(function(){return this.thenList(c)})},l.prototype.get=function(a,c){return this.then(function(){var d=a in l.template.prop?this.prop[a]:this.opt[a];return c?c(d):d})},l.prototype.setMargin=function(a){return this.then(function(){switch(r(a)){case"number":a=[a,a,a,a];case"array":if(a.length===2&&(a=[a[0],a[1],a[0],a[1]]),a.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=a}).then(this.setPageSize)},l.prototype.setPageSize=function(a){function c(d,u){return Math.floor(d*u/72*96)}return this.then(function(){(a=a||qt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(a.inner={width:a.width-this.opt.margin[1]-this.opt.margin[3],height:a.height-this.opt.margin[0]-this.opt.margin[2]},a.inner.px={width:c(a.inner.width,a.k),height:c(a.inner.height,a.k)},a.inner.ratio=a.inner.height/a.inner.width),this.prop.pageSize=a})},l.prototype.setProgress=function(a,c,d,u){return a!=null&&(this.progress.val=a),c!=null&&(this.progress.state=c),d!=null&&(this.progress.n=d),u!=null&&(this.progress.stack=u),this.progress.ratio=this.progress.val/this.progress.state,this},l.prototype.updateProgress=function(a,c,d,u){return this.setProgress(a?this.progress.val+a:null,c||null,d?this.progress.n+d:null,u?this.progress.stack.concat(u):null)},l.prototype.then=function(a,c){var d=this;return this.thenCore(a,c,function(u,f){return d.updateProgress(null,null,1,[u]),Promise.prototype.then.call(this,function(m){return d.updateProgress(null,u),m}).then(u,f).then(function(m){return d.updateProgress(1),m})})},l.prototype.thenCore=function(a,c,d){d=d||Promise.prototype.then;var u=this;a&&(a=a.bind(u)),c&&(c=c.bind(u));var f=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?u:l.convert(Object.assign({},u),Promise.prototype),m=d.call(f,a,c);return l.convert(m,u.__proto__)},l.prototype.thenExternal=function(a,c){return Promise.prototype.then.call(this,a,c)},l.prototype.thenList=function(a){var c=this;return a.forEach(function(d){c=c.thenCore(d)}),c},l.prototype.catch=function(a){a&&(a=a.bind(this));var c=Promise.prototype.catch.call(this,a);return l.convert(c,this)},l.prototype.catchExternal=function(a){return Promise.prototype.catch.call(this,a)},l.prototype.error=function(a){return this.then(function(){throw new Error(a)})},l.prototype.using=l.prototype.set,l.prototype.saveAs=l.prototype.save,l.prototype.export=l.prototype.output,l.prototype.run=l.prototype.then,qt.getPageSize=function(a,c,d){if(Wn(a)==="object"){var u=a;a=u.orientation,c=u.unit||c,d=u.format||d}c=c||"mm",d=d||"a4",a=(""+(a||"P")).toLowerCase();var f,m=(""+d).toLowerCase(),h={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":f=1;break;case"mm":f=72/25.4;break;case"cm":f=72/2.54;break;case"in":f=72;break;case"px":f=.75;break;case"pc":case"em":f=12;break;case"ex":f=6;break;default:throw"Invalid unit: "+c}var g,y=0,p=0;if(h.hasOwnProperty(m))y=h[m][1]/f,p=h[m][0]/f;else try{y=d[1],p=d[0]}catch{throw new Error("Invalid format: "+d)}if(a==="p"||a==="portrait")a="p",p>y&&(g=p,p=y,y=g);else{if(a!=="l"&&a!=="landscape")throw"Invalid orientation: "+a;a="l",y>p&&(g=p,p=y,y=g)}return{width:p,height:y,unit:c,k:f,orientation:a}},e.html=function(a,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(xy):null;var d=new l(c);return c.worker?d:d.from(a).doCallback()}}(qt.API),qt.API.addJS=function(e){return uA=e,this.internal.events.subscribe("postPutResources",function(){wp=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(wp+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),cA=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+uA+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){wp!==void 0&&cA!==void 0&&this.internal.out("/Names <</JavaScript "+wp+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var n=this,r=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var s=n.outline.render().split(/\r\n/),i=0;i<s.length;i++){var l=s[i],a=r.exec(l);if(a!=null){var c=a[1];n.internal.newObjectDeferredBegin(c,!1)}n.internal.write(l)}if(this.outline.createNamedDestinations){var d=this.internal.pages.length,u=[];for(i=0;i<d;i++){var f=n.internal.newObject();u.push(f);var m=n.internal.getPageInfo(i+1);n.internal.write("<< /D["+m.objId+" 0 R /XYZ null null null]>> endobj")}var h=n.internal.newObject();for(n.internal.write("<< /Names [ "),i=0;i<u.length;i++)n.internal.write("(page_"+(i+1)+")"+u[i]+" 0 R");n.internal.write(" ] >>","endobj"),t=n.internal.newObject(),n.internal.write("<< /Dests "+h+" 0 R"),n.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var n=this;n.outline.root.children.length>0&&(n.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&n.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var n=this;n.outline={createNamedDestinations:!1,root:{children:[]}},n.outline.add=function(r,s,i){var l={title:s,options:i,children:[]};return r==null&&(r=this.root),r.children.push(l),l},n.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=n,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},n.outline.genIds_r=function(r){r.id=n.internal.newObjectDeferred();for(var s=0;s<r.children.length;s++)this.genIds_r(r.children[s])},n.outline.renderRoot=function(r){this.objStart(r),this.line("/Type /Outlines"),r.children.length>0&&(this.line("/First "+this.makeRef(r.children[0])),this.line("/Last "+this.makeRef(r.children[r.children.length-1]))),this.line("/Count "+this.count_r({count:0},r)),this.objEnd()},n.outline.renderItems=function(r){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<r.children.length;i++){var l=r.children[i];this.objStart(l),this.line("/Title "+this.makeString(l.title)),this.line("/Parent "+this.makeRef(r)),i>0&&this.line("/Prev "+this.makeRef(r.children[i-1])),i<r.children.length-1&&this.line("/Next "+this.makeRef(r.children[i+1])),l.children.length>0&&(this.line("/First "+this.makeRef(l.children[0])),this.line("/Last "+this.makeRef(l.children[l.children.length-1])));var a=this.count=this.count_r({count:0},l);if(a>0&&this.line("/Count "+a),l.options&&l.options.pageNumber){var c=n.internal.getPageInfo(l.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var d=0;d<r.children.length;d++)this.renderItems(r.children[d])},n.outline.line=function(r){this.ctx.val+=r+`\r
`},n.outline.makeRef=function(r){return r.id+" 0 R"},n.outline.makeString=function(r){return"("+n.internal.pdfEscape(r)+")"},n.outline.objStart=function(r){this.ctx.val+=`\r
`+r.id+` 0 obj\r
<<\r
`},n.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},n.outline.count_r=function(r,s){for(var i=0;i<s.children.length;i++)r.count++,this.count_r(r,s.children[i]);return r.count}}])}(qt.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(n,r,s,i,l,a){var c,d=this.decode.DCT_DECODE,u=null;if(typeof n=="string"||this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n)){switch(n=l||n,n=this.__addimage__.isArrayBuffer(n)?new Uint8Array(n):n,c=function(f){for(var m,h=256*f.charCodeAt(4)+f.charCodeAt(5),g=f.length,y={width:0,height:0,numcomponents:1},p=4;p<g;p+=2){if(p+=h,t.indexOf(f.charCodeAt(p+1))!==-1){m=256*f.charCodeAt(p+5)+f.charCodeAt(p+6),y={width:256*f.charCodeAt(p+7)+f.charCodeAt(p+8),height:m,numcomponents:f.charCodeAt(p+9)};break}h=256*f.charCodeAt(p+2)+f.charCodeAt(p+3)}return y}(n=this.__addimage__.isArrayBufferView(n)?this.__addimage__.arrayBufferToBinaryString(n):n),c.numcomponents){case 1:a=this.color_spaces.DEVICE_GRAY;break;case 4:a=this.color_spaces.DEVICE_CMYK;break;case 3:a=this.color_spaces.DEVICE_RGB}u={data:n,width:c.width,height:c.height,colorSpace:a,bitsPerComponent:8,filter:d,index:r,alias:s}}return u}}(qt.API),qt.API.processPNG=function(e,t,n,r){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var s,i=Kue(e,{checkCrc:!0}),l=i.width,a=i.height,c=i.channels,d=i.palette,u=i.depth;s=d&&c===1?function(T){for(var S=T.width,E=T.height,_=T.data,M=T.palette,A=T.depth,P=!1,B=[],L=[],D=void 0,V=!1,O=0,H=0;H<M.length;H++){var W=m8(M[H],4),$=W[0],z=W[1],q=W[2],G=W[3];B.push($,z,q),G!=null&&(G===0?(O++,L.length<1&&L.push(H)):G<255&&(V=!0))}if(V||O>1){P=!0,L=void 0;var re=S*E;D=new Uint8Array(re);for(var oe=new DataView(_.buffer),ie=0;ie<re;ie++){var Y=vy(oe,ie,A),te=m8(M[Y],4)[3];D[ie]=te}}else O===0&&(L=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:P?8:void 0,colorBytes:_,alphaBytes:D,needSMask:P,palette:B,mask:L}}(i):c===2||c===4?function(T){for(var S=T.data,E=T.width,_=T.height,M=T.channels,A=T.depth,P=M===2?"DeviceGray":"DeviceRGB",B=M-1,L=E*_,D=B,V=L*D,O=1*L,H=Math.ceil(V*A/8),W=Math.ceil(O*A/8),$=new Uint8Array(H),z=new Uint8Array(W),q=new DataView(S.buffer),G=new DataView($.buffer),re=new DataView(z.buffer),oe=!1,ie=0;ie<L;ie++){for(var Y=ie*M,te=0;te<D;te++)vA(G,vy(q,Y+te,A),ie*D+te,A);var we=vy(q,Y+D,A);we<(1<<A)-1&&(oe=!0),vA(re,we,1*ie,A)}return{colorSpace:P,colorsPerPixel:B,sMaskBitsPerComponent:oe?A:void 0,colorBytes:$,alphaBytes:z,needSMask:oe}}(i):function(T){var S=T.data,E=T.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:E,colorsPerPixel:E==="DeviceGray"?1:3,colorBytes:S instanceof Uint16Array?function(_){for(var M=_.length,A=new Uint8Array(2*M),P=new DataView(A.buffer,A.byteOffset,A.byteLength),B=0;B<M;B++)P.setUint16(2*B,_[B],!1);return A}(S):S,needSMask:!1}}(i);var f,m,h,g=s,y=g.colorSpace,p=g.colorsPerPixel,x=g.sMaskBitsPerComponent,b=g.colorBytes,w=g.alphaBytes,N=g.needSMask,k=g.palette,I=g.mask,R=null;return r!==qt.API.image_compression.NONE&&typeof qN=="function"?(R=function(T){var S;switch(T){case qt.API.image_compression.FAST:S=11;break;case qt.API.image_compression.MEDIUM:S=13;break;case qt.API.image_compression.SLOW:S=14;break;default:S=12}return S}(r),f=this.decode.FLATE_DECODE,m="/Predictor ".concat(R," /Colors ").concat(p," /BitsPerComponent ").concat(u," /Columns ").concat(l),e=mA(b,Math.ceil(l*p*u/8),p,u,r),N&&(h=mA(w,Math.ceil(l*x/8),1,x,r))):(f=void 0,m=void 0,e=b,N&&(h=w)),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(h&&this.__addimage__.isArrayBuffer(h)||this.__addimage__.isArrayBufferView(h))&&(h=this.__addimage__.arrayBufferToBinaryString(h)),{alias:n,data:e,index:t,filter:f,decodeParameters:m,transparency:I,palette:k,sMask:h,predictor:R,width:l,height:a,bitsPerComponent:u,sMaskBitsPerComponent:x,colorSpace:y}}},function(e){e.processGIF89A=function(t,n,r,s){var i=new xde(t),l=i.width,a=i.height,c=[];i.decodeAndBlitFrameRGBA(0,c);var d={data:c,width:l,height:a},u=new by(100).encode(d,100);return e.processJPEG.call(this,u,n,r,s)},e.processGIF87A=e.processGIF89A}(qt.API),Xi.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:s,green:r,blue:n,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Xi.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(n){Kn.log("bit decode error:"+n)}},Xi.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),n=t%4;for(e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,s=0;s<t;s++)for(var i=this.datav.getUint8(this.pos++,!0),l=r*this.width*4+8*s*4,a=0;a<8&&8*s+a<this.width;a++){var c=this.palette[i>>7-a&1];this.data[l+4*a]=c.blue,this.data[l+4*a+1]=c.green,this.data[l+4*a+2]=c.red,this.data[l+4*a+3]=255}n!==0&&(this.pos+=4-n)}},Xi.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,s=0;s<e;s++){var i=this.datav.getUint8(this.pos++,!0),l=r*this.width*4+2*s*4,a=i>>4,c=15&i,d=this.palette[a];if(this.data[l]=d.blue,this.data[l+1]=d.green,this.data[l+2]=d.red,this.data[l+3]=255,2*s+1>=this.width)break;d=this.palette[c],this.data[l+4]=d.blue,this.data[l+4+1]=d.green,this.data[l+4+2]=d.red,this.data[l+4+3]=255}t!==0&&(this.pos+=4-t)}},Xi.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var s=this.datav.getUint8(this.pos++,!0),i=n*this.width*4+4*r;if(s<this.palette.length){var l=this.palette[s];this.data[i]=l.red,this.data[i+1]=l.green,this.data[i+2]=l.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}e!==0&&(this.pos+=4-e)}},Xi.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,s=0;s<this.width;s++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(i&t)/t*255|0,a=(i>>5&t)/t*255|0,c=(i>>10&t)/t*255|0,d=i>>15?255:0,u=r*this.width*4+4*s;this.data[u]=c,this.data[u+1]=a,this.data[u+2]=l,this.data[u+3]=d}this.pos+=e}},Xi.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),n=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var s=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var l=this.datav.getUint16(this.pos,!0);this.pos+=2;var a=(l&t)/t*255|0,c=(l>>5&n)/n*255|0,d=(l>>11)/t*255|0,u=s*this.width*4+4*i;this.data[u]=d,this.data[u+1]=c,this.data[u+2]=a,this.data[u+3]=255}this.pos+=e}},Xi.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),l=t*this.width*4+4*n;this.data[l]=i,this.data[l+1]=s,this.data[l+2]=r,this.data[l+3]=255}this.pos+=this.width%4}},Xi.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),a=t*this.width*4+4*n;this.data[a]=i,this.data[a+1]=s,this.data[a+2]=r,this.data[a+3]=l}},Xi.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,n,r,s){var i=new Xi(t,!1),l=i.width,a=i.height,c={data:i.getData(),width:l,height:a},d=new by(100).encode(c,100);return e.processJPEG.call(this,d,n,r,s)}}(qt.API),wA.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,n,r,s){var i=new wA(t),l=i.width,a=i.height,c={data:i.getData(),width:l,height:a},d=new by(100).encode(c,100);return e.processJPEG.call(this,d,n,r,s)}}(qt.API),qt.API.processRGBA=function(e,t,n){for(var r=e.data,s=r.length,i=new Uint8Array(s/4*3),l=new Uint8Array(s/4),a=0,c=0,d=0;d<s;d+=4){var u=r[d],f=r[d+1],m=r[d+2],h=r[d+3];i[a++]=u,i[a++]=f,i[a++]=m,l[c++]=h}var g=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(l),data:g,index:t,alias:n,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},qt.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},_u=qt.API,Np=_u.getCharWidthsArray=function(e,t){var n,r,s=(t=t||{}).font||this.internal.getFont(),i=t.fontSize||this.internal.getFontSize(),l=t.charSpace||this.internal.getCharSpace(),a=t.widths?t.widths:s.metadata.Unicode.widths,c=a.fof?a.fof:1,d=t.kerning?t.kerning:s.metadata.Unicode.kerning,u=d.fof?d.fof:1,f=t.doKerning!==!1,m=0,h=e.length,g=0,y=a[0]||c,p=[];for(n=0;n<h;n++)r=e.charCodeAt(n),typeof s.metadata.widthOfString=="function"?p.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(r))+l*(1e3/i)||0)/1e3):(m=f&&Wn(d[r])==="object"&&!isNaN(parseInt(d[r][g],10))?d[r][g]/u:0,p.push((a[r]||y)/c+m)),g=r;return p},dA=_u.getStringUnitWidth=function(e,t){var n=(t=t||{}).fontSize||this.internal.getFontSize(),r=t.font||this.internal.getFont(),s=t.charSpace||this.internal.getCharSpace();return _u.processArabic&&(e=_u.processArabic(e)),typeof r.metadata.widthOfString=="function"?r.metadata.widthOfString(e,n,s)/n:Np.apply(this,arguments).reduce(function(i,l){return i+l},0)},fA=function(e,t,n,r){for(var s=[],i=0,l=e.length,a=0;i!==l&&a+t[i]<n;)a+=t[i],i++;s.push(e.slice(0,i));var c=i;for(a=0;i!==l;)a+t[i]>r&&(s.push(e.slice(c,i)),a=0,c=i),a+=t[i],i++;return c!==i&&s.push(e.slice(c,i)),s},hA=function(e,t,n){n||(n={});var r,s,i,l,a,c,d,u=[],f=[u],m=n.textIndent||0,h=0,g=0,y=e.split(" "),p=Np.apply(this,[" ",n])[0];if(c=n.lineIndent===-1?y[0].length+2:n.lineIndent||0){var x=Array(c).join(" "),b=[];y.map(function(N){(N=N.split(/\s*\n/)).length>1?b=b.concat(N.map(function(k,I){return(I&&k.length?`
`:"")+k})):b.push(N[0])}),y=b,c=dA.apply(this,[x,n])}for(i=0,l=y.length;i<l;i++){var w=0;if(r=y[i],c&&r[0]==`
`&&(r=r.substr(1),w=1),m+h+(g=(s=Np.apply(this,[r,n])).reduce(function(N,k){return N+k},0))>t||w){if(g>t){for(a=fA.apply(this,[r,s,t-(m+h),t]),u.push(a.shift()),u=[a.pop()];a.length;)f.push([a.shift()]);g=s.slice(r.length-(u[0]?u[0].length:0)).reduce(function(N,k){return N+k},0)}else u=[r];f.push(u),m=g+c,h=p}else u.push(r),m+=h+g,h=p}return d=c?function(N,k){return(k?x:"")+N.join(" ")}:function(N){return N.join(" ")},f.map(d)},_u.splitTextToSize=function(e,t,n){var r,s=(n=n||{}).fontSize||this.internal.getFontSize(),i=(function(u){if(u.widths&&u.kerning)return{widths:u.widths,kerning:u.kerning};var f=this.internal.getFont(u.fontName,u.fontStyle),m="Unicode";return f.metadata[m]?{widths:f.metadata[m].widths||{0:1},kerning:f.metadata[m].kerning||{}}:{font:f.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,n);r=Array.isArray(e)?e:String(e).split(/\r?\n/);var l=1*this.internal.scaleFactor*t/s;i.textIndent=n.textIndent?1*n.textIndent*this.internal.scaleFactor/s:0,i.lineIndent=n.lineIndent;var a,c,d=[];for(a=0,c=r.length;a<c;a++)d=d.concat(hA.apply(this,[r[a],l,i]));return d},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",n="klmnopqrstuvwxyz",r={},s={},i=0;i<16;i++)r[n[i]]=t[i],s[t[i]]=n[i];var l=function(m){return"0x"+parseInt(m,10).toString(16)},a=e.__fontmetrics__.compress=function(m){var h,g,y,p,x=["{"];for(var b in m){if(h=m[b],isNaN(parseInt(b,10))?g="'"+b+"'":(b=parseInt(b,10),g=(g=l(b).slice(2)).slice(0,-1)+s[g.slice(-1)]),typeof h=="number")h<0?(y=l(h).slice(3),p="-"):(y=l(h).slice(2),p=""),y=p+y.slice(0,-1)+s[y.slice(-1)];else{if(Wn(h)!=="object")throw new Error("Don't know what to do with value type "+Wn(h)+".");y=a(h)}x.push(g+y)}return x.push("}"),x.join("")},c=e.__fontmetrics__.uncompress=function(m){if(typeof m!="string")throw new Error("Invalid argument passed to uncompress.");for(var h,g,y,p,x={},b=1,w=x,N=[],k="",I="",R=m.length-1,T=1;T<R;T+=1)(p=m[T])=="'"?h?(y=h.join(""),h=void 0):h=[]:h?h.push(p):p=="{"?(N.push([w,y]),w={},y=void 0):p=="}"?((g=N.pop())[0][g[1]]=w,y=void 0,w=g[0]):p=="-"?b=-1:y===void 0?r.hasOwnProperty(p)?(k+=r[p],y=parseInt(k,16)*b,b=1,k=""):k+=p:r.hasOwnProperty(p)?(I+=r[p],w[y]=parseInt(I,16)*b,b=1,y=void 0,I=""):I+=p;return x},d={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},u={Unicode:{Courier:d,"Courier-Bold":d,"Courier-BoldOblique":d,"Courier-Oblique":d,Helvetica:d,"Helvetica-Bold":d,"Helvetica-BoldOblique":d,"Helvetica-Oblique":d,"Times-Roman":d,"Times-Bold":d,"Times-BoldItalic":d,"Times-Italic":d}},f={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(m){var h=m.font,g=f.Unicode[h.postScriptName];g&&(h.metadata.Unicode={},h.metadata.Unicode.widths=g.widths,h.metadata.Unicode.kerning=g.kerning);var y=u.Unicode[h.postScriptName];y&&(h.metadata.Unicode.encoding=y,h.encoding=y.codePages[0])}])}(qt.API),function(e){var t=function(n){for(var r=n.length,s=new Uint8Array(r),i=0;i<r;i++)s[i]=n.charCodeAt(i);return s};e.API.events.push(["addFont",function(n){var r=void 0,s=n.font,i=n.instance;if(!s.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if(typeof(r=i.existsFileInVFS(s.postScriptName)===!1?i.loadFile(s.postScriptName):i.getFileFromVFS(s.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");(function(l,a){a=/^\x00\x01\x00\x00/.test(a)?t(a):t(Gp(a)),l.metadata=e.API.TTFFont.open(a),l.metadata.Unicode=l.metadata.Unicode||{encoding:{},kerning:{},widths:[]},l.metadata.glyIdsUsed=[0]})(s,r)}}])}(qt),qt.API.addSvgAsImage=function(e,t,n,r,s,i,l,a){if(isNaN(t)||isNaN(n))throw Kn.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(r)||isNaN(s))throw Kn.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=r,c.height=s;var d=c.getContext("2d");d.fillStyle="#fff",d.fillRect(0,0,c.width,c.height);var u={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return(nn.canvg?Promise.resolve(nn.canvg):Vp(()=>import("./index.es-UX7yn5Wd.js"),__vite__mapDeps([0,1,2,3,4,5]))).catch(function(m){return Promise.reject(new Error("Could not load canvg: "+m))}).then(function(m){return m.default?m.default:m}).then(function(m){return m.fromString(d,e,u)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(m){return m.render(u)}).then(function(){f.addImage(c.toDataURL("image/jpeg",1),t,n,r,s,l,a)})},qt.API.putTotalPages=function(e){var t,n=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),n=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),n=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var s=0;s<this.internal.pages[r].length;s++)this.internal.pages[r][s]=this.internal.pages[r][s].replace(t,n);return this},qt.API.viewerPreferences=function(e,t){var n;e=e||{},t=t||!1;var r,s,i,l={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},a=Object.keys(l),c=[],d=0,u=0,f=0;function m(g,y){var p,x=!1;for(p=0;p<g.length;p+=1)g[p]===y&&(x=!0);return x}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(l)),this.internal.viewerpreferences.isSubscribed=!1),n=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var h=a.length;for(f=0;f<h;f+=1)n[a[f]].value=n[a[f]].defaultValue,n[a[f]].explicitSet=!1}if(Wn(e)==="object"){for(s in e)if(i=e[s],m(a,s)&&i!==void 0){if(n[s].type==="boolean"&&typeof i=="boolean")n[s].value=i;else if(n[s].type==="name"&&m(n[s].valueSet,i))n[s].value=i;else if(n[s].type==="integer"&&Number.isInteger(i))n[s].value=i;else if(n[s].type==="array"){for(d=0;d<i.length;d+=1)if(r=!0,i[d].length===1&&typeof i[d][0]=="number")c.push(String(i[d]-1));else if(i[d].length>1){for(u=0;u<i[d].length;u+=1)typeof i[d][u]!="number"&&(r=!1);r===!0&&c.push([i[d][0]-1,i[d][1]-1].join(" "))}n[s].value="["+c.join(" ")+"]"}else n[s].value=n[s].defaultValue;n[s].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var g,y=[];for(g in n)n[g].explicitSet===!0&&(n[g].type==="name"?y.push("/"+g+" /"+n[g].value):y.push("/"+g+" "+n[g].value));y.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+y.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=n,this},function(e){var t=function(){var r='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',s=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(r)),l=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),a=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),d=i.length+l.length+a.length+s.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+d+" >>"),this.internal.write("stream"),this.internal.write(s+i+l+a+c),this.internal.write("endstream"),this.internal.write("endobj")},n=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(r,s){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:r,namespaceuri:s||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",n),this.internal.events.subscribe("postPutResources",t)),this}}(qt.API),function(e){var t=e.API,n=t.pdfEscape16=function(i,l){for(var a,c=l.metadata.Unicode.widths,d=["","0","00","000","0000"],u=[""],f=0,m=i.length;f<m;++f){if(a=l.metadata.characterToGlyph(i.charCodeAt(f)),l.metadata.glyIdsUsed.push(a),l.metadata.toUnicode[a]=i.charCodeAt(f),c.indexOf(a)==-1&&(c.push(a),c.push([parseInt(l.metadata.widthOfGlyph(a),10)])),a=="0")return u.join("");a=a.toString(16),u.push(d[4-a.length],a)}return u.join("")},r=function(i){var l,a,c,d,u,f,m;for(u=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],f=0,m=(a=Object.keys(i).sort(function(h,g){return h-g})).length;f<m;f++)l=a[f],c.length>=100&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),i[l]!==void 0&&i[l]!==null&&typeof i[l].toString=="function"&&(d=("0000"+i[l].toString(16)).slice(-4),l=("0000"+(+l).toString(16)).slice(-4),c.push("<"+l+"><"+d+">"));return c.length&&(u+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),u+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(i){(function(l){var a=l.font,c=l.out,d=l.newObject,u=l.putStream;if(a.metadata instanceof e.API.TTFFont&&a.encoding==="Identity-H"){for(var f=a.metadata.Unicode.widths,m=a.metadata.subset.encode(a.metadata.glyIdsUsed,1),h="",g=0;g<m.length;g++)h+=String.fromCharCode(m[g]);var y=d();u({data:h,addLength1:!0,objectId:y}),c("endobj");var p=d();u({data:r(a.metadata.toUnicode),addLength1:!0,objectId:p}),c("endobj");var x=d();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+ku(a.fontName)),c("/FontFile2 "+y+" 0 R"),c("/FontBBox "+e.API.PDFObject.convert(a.metadata.bbox)),c("/Flags "+a.metadata.flags),c("/StemV "+a.metadata.stemV),c("/ItalicAngle "+a.metadata.italicAngle),c("/Ascent "+a.metadata.ascender),c("/Descent "+a.metadata.decender),c("/CapHeight "+a.metadata.capHeight),c(">>"),c("endobj");var b=d();c("<<"),c("/Type /Font"),c("/BaseFont /"+ku(a.fontName)),c("/FontDescriptor "+x+" 0 R"),c("/W "+e.API.PDFObject.convert(f)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+a.encoding+")"),c(">>"),c(">>"),c("endobj"),a.objectNumber=d(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+p+" 0 R"),c("/BaseFont /"+ku(a.fontName)),c("/Encoding /"+a.encoding),c("/DescendantFonts ["+b+" 0 R]"),c(">>"),c("endobj"),a.isAlreadyPutted=!0}})(i)}]),t.events.push(["putFont",function(i){(function(l){var a=l.font,c=l.out,d=l.newObject,u=l.putStream;if(a.metadata instanceof e.API.TTFFont&&a.encoding==="WinAnsiEncoding"){for(var f=a.metadata.rawData,m="",h=0;h<f.length;h++)m+=String.fromCharCode(f[h]);var g=d();u({data:m,addLength1:!0,objectId:g}),c("endobj");var y=d();u({data:r(a.metadata.toUnicode),addLength1:!0,objectId:y}),c("endobj");var p=d();c("<<"),c("/Descent "+a.metadata.decender),c("/CapHeight "+a.metadata.capHeight),c("/StemV "+a.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+g+" 0 R"),c("/Flags 96"),c("/FontBBox "+e.API.PDFObject.convert(a.metadata.bbox)),c("/FontName /"+ku(a.fontName)),c("/ItalicAngle "+a.metadata.italicAngle),c("/Ascent "+a.metadata.ascender),c(">>"),c("endobj"),a.objectNumber=d();for(var x=0;x<a.metadata.hmtx.widths.length;x++)a.metadata.hmtx.widths[x]=parseInt(a.metadata.hmtx.widths[x]*(1e3/a.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+y+" 0 R/BaseFont/"+ku(a.fontName)+"/FontDescriptor "+p+" 0 R/Encoding/"+a.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(a.metadata.hmtx.widths)+">>"),c("endobj"),a.isAlreadyPutted=!0}})(i)}]);var s=function(i){var l,a=i.text||"",c=i.x,d=i.y,u=i.options||{},f=i.mutex||{},m=f.pdfEscape,h=f.activeFontKey,g=f.fonts,y=h,p="",x=0,b="",w=g[y].encoding;if(g[y].encoding!=="Identity-H")return{text:a,x:c,y:d,options:u,mutex:f};for(b=a,y=h,Array.isArray(a)&&(b=a[0]),x=0;x<b.length;x+=1)g[y].metadata.hasOwnProperty("cmap")&&(l=g[y].metadata.cmap.unicode.codeMap[b[x].charCodeAt(0)]),l||b[x].charCodeAt(0)<256&&g[y].metadata.hasOwnProperty("Unicode")?p+=b[x]:p+="";var N="";return parseInt(y.slice(1))<14||w==="WinAnsiEncoding"?N=m(p,y).split("").map(function(k){return k.charCodeAt(0).toString(16)}).join(""):w==="Identity-H"&&(N=n(p,g[y])),f.isHex=!0,{text:N,x:c,y:d,options:u,mutex:f}};t.events.push(["postProcessText",function(i){var l=i.text||"",a=[],c={text:l,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(l)){var d=0;for(d=0;d<l.length;d+=1)Array.isArray(l[d])&&l[d].length===3?a.push([s(Object.assign({},c,{text:l[d][0]})).text,l[d][1],l[d][2]]):a.push(s(Object.assign({},c,{text:l[d]})).text);i.text=a}else i.text=s(Object.assign({},c,{text:l})).text}])}(qt),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(n){return t.call(this),this.internal.vFS[n]!==void 0},e.addFileToVFS=function(n,r){return t.call(this),this.internal.vFS[n]=r,this},e.getFileFromVFS=function(n){return t.call(this),this.internal.vFS[n]!==void 0?this.internal.vFS[n]:null}}(qt.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(r){var s,i,l,a,c,d,u,f=t,m=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],g={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},y={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},p=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],x=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),b=!1,w=0;this.__bidiEngine__={};var N=function(_){var M=_.charCodeAt(),A=M>>8,P=y[A];return P!==void 0?f[256*P+(255&M)]:A===252||A===253?"AL":x.test(A)?"L":A===8?"R":"N"},k=function(_){for(var M,A=0;A<_.length;A++){if((M=N(_.charAt(A)))==="L")return!1;if(M==="R")return!0}return!1},I=function(_,M,A,P){var B,L,D,V,O=M[P];switch(O){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":b=!1;break;case"N":case"AN":break;case"EN":b&&(O="AN");break;case"AL":b=!0,O="R";break;case"WS":case"BN":O="N";break;case"CS":P<1||P+1>=M.length||(B=A[P-1])!=="EN"&&B!=="AN"||(L=M[P+1])!=="EN"&&L!=="AN"?O="N":b&&(L="AN"),O=L===B?L:"N";break;case"ES":O=(B=P>0?A[P-1]:"B")==="EN"&&P+1<M.length&&M[P+1]==="EN"?"EN":"N";break;case"ET":if(P>0&&A[P-1]==="EN"){O="EN";break}if(b){O="N";break}for(D=P+1,V=M.length;D<V&&M[D]==="ET";)D++;O=D<V&&M[D]==="EN"?"EN":"N";break;case"NSM":if(l&&!a){for(V=M.length,D=P+1;D<V&&M[D]==="NSM";)D++;if(D<V){var H=_[P],W=H>=1425&&H<=2303||H===64286;if(B=M[D],W&&(B==="R"||B==="AL")){O="R";break}}}O=P<1||(B=M[P-1])==="B"?"N":A[P-1];break;case"B":b=!1,s=!0,O=w;break;case"S":i=!0,O="N"}return O},R=function(_,M,A){var P=_.split("");return A&&T(P,A,{hiLevel:w}),P.reverse(),M&&M.reverse(),P.join("")},T=function(_,M,A){var P,B,L,D,V,O=-1,H=_.length,W=0,$=[],z=w?h:m,q=[];for(b=!1,s=!1,i=!1,B=0;B<H;B++)q[B]=N(_[B]);for(L=0;L<H;L++){if(V=W,$[L]=I(_,q,$,L),P=240&(W=z[V][g[$[L]]]),W&=15,M[L]=D=z[W][5],P>0)if(P===16){for(B=O;B<L;B++)M[B]=1;O=-1}else O=-1;if(z[W][6])O===-1&&(O=L);else if(O>-1){for(B=O;B<L;B++)M[B]=D;O=-1}q[L]==="B"&&(M[L]=0),A.hiLevel|=D}i&&function(G,re,oe){for(var ie=0;ie<oe;ie++)if(G[ie]==="S"){re[ie]=w;for(var Y=ie-1;Y>=0&&G[Y]==="WS";Y--)re[Y]=w}}(q,M,H)},S=function(_,M,A,P,B){if(!(B.hiLevel<_)){if(_===1&&w===1&&!s)return M.reverse(),void(A&&A.reverse());for(var L,D,V,O,H=M.length,W=0;W<H;){if(P[W]>=_){for(V=W+1;V<H&&P[V]>=_;)V++;for(O=W,D=V-1;O<D;O++,D--)L=M[O],M[O]=M[D],M[D]=L,A&&(L=A[O],A[O]=A[D],A[D]=L);W=V}W++}}},E=function(_,M,A){var P=_.split(""),B={hiLevel:w};return A||(A=[]),T(P,A,B),function(L,D,V){if(V.hiLevel!==0&&u)for(var O,H=0;H<L.length;H++)D[H]===1&&(O=p.indexOf(L[H]))>=0&&(L[H]=p[O+1])}(P,A,B),S(2,P,M,A,B),S(1,P,M,A,B),P.join("")};return this.__bidiEngine__.doBidiReorder=function(_,M,A){if(function(B,L){if(L)for(var D=0;D<B.length;D++)L[D]=D;a===void 0&&(a=k(B)),d===void 0&&(d=k(B))}(_,M),l||!c||d)if(l&&c&&a^d)w=a?1:0,_=R(_,M,A);else if(!l&&c&&d)w=a?1:0,_=E(_,M,A),_=R(_,M);else if(!l||a||c||d){if(l&&!c&&a^d)_=R(_,M),a?(w=0,_=E(_,M,A)):(w=1,_=E(_,M,A),_=R(_,M));else if(l&&a&&!c&&d)w=1,_=E(_,M,A),_=R(_,M);else if(!l&&!c&&a^d){var P=u;a?(w=1,_=E(_,M,A),w=0,u=!1,_=E(_,M,A),u=P):(w=0,_=E(_,M,A),_=R(_,M),w=1,u=!1,_=E(_,M,A),u=P,_=R(_,M))}}else w=0,_=E(_,M,A);else w=a?1:0,_=E(_,M,A);return _},this.__bidiEngine__.setOptions=function(_){_&&(l=_.isInputVisual,c=_.isOutputVisual,a=_.isInputRtl,d=_.isOutputRtl,u=_.isSymmetricSwapping)},this.__bidiEngine__.setOptions(r),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],n=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(r){var s=r.text;r.x,r.y;var i=r.options||{};r.mutex,i.lang;var l=[];if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,n.setOptions(i),Object.prototype.toString.call(s)==="[object Array]"){var a=0;for(l=[],a=0;a<s.length;a+=1)Object.prototype.toString.call(s[a])==="[object Array]"?l.push([n.doBidiReorder(s[a][0]),s[a][1],s[a][2]]):l.push([n.doBidiReorder(s[a])]);r.text=l}else r.text=n.doBidiReorder(s);n.setOptions({isInputVisual:!0})}])}(qt),qt.API.TTFFont=function(){function e(t){var n;if(this.rawData=t,n=this.contents=new bl(t),this.contents.pos=4,n.readString(4)==="ttcf")throw new Error("TTCF not supported.");n.pos=0,this.parse(),this.subset=new Tde(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new yde(this.contents),this.head=new bde(this),this.name=new Sde(this),this.cmap=new BO(this),this.toUnicode={},this.hhea=new wde(this),this.maxp=new Ade(this),this.hmtx=new kde(this),this.post=new jde(this),this.os2=new Nde(this),this.loca=new Ide(this),this.glyf=new Ede(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,n,r,s,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var l,a,c,d;for(d=[],l=0,a=(c=this.bbox).length;l<a;l++)t=c[l],d.push(Math.round(t*this.scaleFactor));return d}).call(this),this.stemV=0,this.post.exists?(r=255&(s=this.post.italic_angle),32768&(n=s>>16)&&(n=-(1+(65535^n))),this.italicAngle=+(n+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var n;return((n=this.cmap.unicode)!=null?n.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var n;return n=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*n},e.prototype.widthOfString=function(t,n,r){var s,i,l,a;for(l=0,i=0,a=(t=""+t).length;0<=a?i<a:i>a;i=0<=a?++i:--i)s=t.charCodeAt(i),l+=this.widthOfGlyph(this.characterToGlyph(s))+r*(1e3/n)||0;return l*(n/1e3)},e.prototype.lineHeight=function(t,n){var r;return n==null&&(n=!1),r=n?this.lineGap:0,(this.ascender+r-this.decender)/1e3*t},e}();var da,bl=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var n,r;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r[n]=String.fromCharCode(this.readByte());return r.join("")},e.prototype.writeString=function(t){var n,r,s;for(s=[],n=0,r=t.length;0<=r?n<r:n>r;n=0<=r?++n:--n)s.push(this.writeByte(t.charCodeAt(n)));return s},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,n,r,s,i,l,a,c;return t=this.readByte(),n=this.readByte(),r=this.readByte(),s=this.readByte(),i=this.readByte(),l=this.readByte(),a=this.readByte(),c=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^n)+1099511627776*(255^r)+4294967296*(255^s)+16777216*(255^i)+65536*(255^l)+256*(255^a)+(255^c)+1):72057594037927940*t+281474976710656*n+1099511627776*r+4294967296*s+16777216*i+65536*l+256*a+c},e.prototype.writeLongLong=function(t){var n,r;return n=Math.floor(t/4294967296),r=4294967295&t,this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var n,r;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n.push(this.readByte());return n},e.prototype.write=function(t){var n,r,s,i;for(i=[],r=0,s=t.length;r<s;r++)n=t[r],i.push(this.writeByte(n));return i},e}(),yde=function(){var e;function t(n){var r,s,i;for(this.scalarType=n.readInt(),this.tableCount=n.readShort(),this.searchRange=n.readShort(),this.entrySelector=n.readShort(),this.rangeShift=n.readShort(),this.tables={},s=0,i=this.tableCount;0<=i?s<i:s>i;s=0<=i?++s:--s)r={tag:n.readString(4),checksum:n.readInt(),offset:n.readInt(),length:n.readInt()},this.tables[r.tag]=r}return t.prototype.encode=function(n){var r,s,i,l,a,c,d,u,f,m,h,g,y;for(y in h=Object.keys(n).length,c=Math.log(2),f=16*Math.floor(Math.log(h)/c),l=Math.floor(f/c),u=16*h-f,(s=new bl).writeInt(this.scalarType),s.writeShort(h),s.writeShort(f),s.writeShort(l),s.writeShort(u),i=16*h,d=s.pos+i,a=null,g=[],n)for(m=n[y],s.writeString(y),s.writeInt(e(m)),s.writeInt(d),s.writeInt(m.length),g=g.concat(m),y==="head"&&(a=d),d+=m.length;d%4;)g.push(0),d++;return s.write(g),r=2981146554-e(s.data),s.pos=a+8,s.writeUInt32(r),s.data},e=function(n){var r,s,i,l;for(n=zO.call(n);n.length%4;)n.push(0);for(i=new bl(n),s=0,r=0,l=n.length;r<l;r=r+=4)s+=i.readUInt32();return 4294967295&s},t}(),vde={}.hasOwnProperty,Ua=function(e,t){for(var n in t)vde.call(t,n)&&(e[n]=t[n]);function r(){this.constructor=e}return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};da=function(){function e(t){var n;this.file=t,n=this.file.directory.tables[this.tag],this.exists=!!n,n&&(this.offset=n.offset,this.length=n.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var bde=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ua(e,da),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var n;return(n=new bl).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(t),n.writeShort(this.glyphDataFormat),n.data},e}(),NA=function(){function e(t,n){var r,s,i,l,a,c,d,u,f,m,h,g,y,p,x,b,w;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=n+t.readInt(),f=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=t.readByte();break;case 4:for(h=t.readUInt16(),m=h/2,t.pos+=6,i=function(){var N,k;for(k=[],c=N=0;0<=m?N<m:N>m;c=0<=m?++N:--N)k.push(t.readUInt16());return k}(),t.pos+=2,y=function(){var N,k;for(k=[],c=N=0;0<=m?N<m:N>m;c=0<=m?++N:--N)k.push(t.readUInt16());return k}(),d=function(){var N,k;for(k=[],c=N=0;0<=m?N<m:N>m;c=0<=m?++N:--N)k.push(t.readUInt16());return k}(),u=function(){var N,k;for(k=[],c=N=0;0<=m?N<m:N>m;c=0<=m?++N:--N)k.push(t.readUInt16());return k}(),s=(this.length-t.pos+this.offset)/2,a=function(){var N,k;for(k=[],c=N=0;0<=s?N<s:N>s;c=0<=s?++N:--N)k.push(t.readUInt16());return k}(),c=x=0,w=i.length;x<w;c=++x)for(p=i[c],r=b=g=y[c];g<=p?b<=p:b>=p;r=g<=p?++b:--b)u[c]===0?l=r+d[c]:(l=a[u[c]/2+(r-g)-(m-c)]||0)!==0&&(l+=d[c]),this.codeMap[r]=65535&l}t.pos=f}return e.encode=function(t,n){var r,s,i,l,a,c,d,u,f,m,h,g,y,p,x,b,w,N,k,I,R,T,S,E,_,M,A,P,B,L,D,V,O,H,W,$,z,q,G,re,oe,ie,Y,te,we,me;switch(P=new bl,l=Object.keys(t).sort(function(Ee,pe){return Ee-pe}),n){case"macroman":for(y=0,p=function(){var Ee=[];for(g=0;g<256;++g)Ee.push(0);return Ee}(),b={0:0},i={},B=0,O=l.length;B<O;B++)b[Y=t[s=l[B]]]==null&&(b[Y]=++y),i[s]={old:t[s],new:b[t[s]]},p[s]=b[t[s]];return P.writeUInt16(1),P.writeUInt16(0),P.writeUInt32(12),P.writeUInt16(0),P.writeUInt16(262),P.writeUInt16(0),P.write(p),{charMap:i,subtable:P.data,maxGlyphID:y+1};case"unicode":for(M=[],f=[],w=0,b={},r={},x=d=null,L=0,H=l.length;L<H;L++)b[k=t[s=l[L]]]==null&&(b[k]=++w),r[s]={old:k,new:b[k]},a=b[k]-s,x!=null&&a===d||(x&&f.push(x),M.push(s),d=a),x=s;for(x&&f.push(x),f.push(65535),M.push(65535),E=2*(S=M.length),T=2*Math.pow(Math.log(S)/Math.LN2,2),m=Math.log(T/2)/Math.LN2,R=2*S-T,c=[],I=[],h=[],g=D=0,W=M.length;D<W;g=++D){if(_=M[g],u=f[g],_===65535){c.push(0),I.push(0);break}if(_-(A=r[_].new)>=32768)for(c.push(0),I.push(2*(h.length+S-g)),s=V=_;_<=u?V<=u:V>=u;s=_<=u?++V:--V)h.push(r[s].new);else c.push(A-_),I.push(0)}for(P.writeUInt16(3),P.writeUInt16(1),P.writeUInt32(12),P.writeUInt16(4),P.writeUInt16(16+8*S+2*h.length),P.writeUInt16(0),P.writeUInt16(E),P.writeUInt16(T),P.writeUInt16(m),P.writeUInt16(R),oe=0,$=f.length;oe<$;oe++)s=f[oe],P.writeUInt16(s);for(P.writeUInt16(0),ie=0,z=M.length;ie<z;ie++)s=M[ie],P.writeUInt16(s);for(te=0,q=c.length;te<q;te++)a=c[te],P.writeUInt16(a);for(we=0,G=I.length;we<G;we++)N=I[we],P.writeUInt16(N);for(me=0,re=h.length;me<re;me++)y=h[me],P.writeUInt16(y);return{charMap:r,subtable:P.data,maxGlyphID:w+1}}},e}(),BO=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ua(e,da),e.prototype.tag="cmap",e.prototype.parse=function(t){var n,r,s;for(t.pos=this.offset,this.version=t.readUInt16(),s=t.readUInt16(),this.tables=[],this.unicode=null,r=0;0<=s?r<s:r>s;r=0<=s?++r:--r)n=new NA(t,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},e.encode=function(t,n){var r,s;return n==null&&(n="macroman"),r=NA.encode(t,n),(s=new bl).writeUInt16(0),s.writeUInt16(1),r.table=s.data.concat(r.subtable),r},e}(),wde=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ua(e,da),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),Nde=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ua(e,da),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var n,r;for(r=[],n=0;n<10;++n)r.push(t.readByte());return r}(),this.charRange=function(){var n,r;for(r=[],n=0;n<4;++n)r.push(t.readInt());return r}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var n,r;for(r=[],n=0;n<2;n=++n)r.push(t.readInt());return r}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),jde=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ua(e,da),e.prototype.tag="post",e.prototype.parse=function(t){var n,r,s;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var i;for(r=t.readUInt16(),this.glyphNameIndex=[],i=0;0<=r?i<r:i>r;i=0<=r?++i:--i)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],s=[];t.pos<this.offset+this.length;)n=t.readByte(),s.push(this.names.push(t.readString(n)));return s;case 151552:return r=t.readUInt16(),this.offsets=t.read(r);case 262144:return this.map=(function(){var l,a,c;for(c=[],i=l=0,a=this.file.maxp.numGlyphs;0<=a?l<a:l>a;i=0<=a?++l:--l)c.push(t.readUInt32());return c}).call(this)}},e}(),_de=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},Sde=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ua(e,da),e.prototype.tag="name",e.prototype.parse=function(t){var n,r,s,i,l,a,c,d,u,f,m;for(t.pos=this.offset,t.readShort(),n=t.readShort(),a=t.readShort(),r=[],i=0;0<=n?i<n:i>n;i=0<=n?++i:--i)r.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+a+t.readShort()});for(c={},i=u=0,f=r.length;u<f;i=++u)s=r[i],t.pos=s.offset,d=t.readString(s.length),l=new _de(d,s),c[m=s.nameID]==null&&(c[m]=[]),c[s.nameID].push(l);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},e}(),Ade=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ua(e,da),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),kde=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ua(e,da),e.prototype.tag="hmtx",e.prototype.parse=function(t){var n,r,s,i,l,a,c;for(t.pos=this.offset,this.metrics=[],n=0,a=this.file.hhea.numberOfMetrics;0<=a?n<a:n>a;n=0<=a?++n:--n)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var d,u;for(u=[],n=d=0;0<=s?d<s:d>s;n=0<=s?++d:--d)u.push(t.readInt16());return u}(),this.widths=(function(){var d,u,f,m;for(m=[],d=0,u=(f=this.metrics).length;d<u;d++)i=f[d],m.push(i.advance);return m}).call(this),r=this.widths[this.widths.length-1],c=[],n=l=0;0<=s?l<s:l>s;n=0<=s?++l:--l)c.push(this.widths.push(r));return c},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),zO=[].slice,Ede=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ua(e,da),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var n,r,s,i,l,a,c,d,u,f;return t in this.cache?this.cache[t]:(i=this.file.loca,n=this.file.contents,r=i.indexOf(t),(s=i.lengthOf(t))===0?this.cache[t]=null:(n.pos=this.offset+r,l=(a=new bl(n.read(s))).readShort(),d=a.readShort(),f=a.readShort(),c=a.readShort(),u=a.readShort(),this.cache[t]=l===-1?new Pde(a,d,f,c,u):new Cde(a,l,d,f,c,u),this.cache[t]))},e.prototype.encode=function(t,n,r){var s,i,l,a,c;for(l=[],i=[],a=0,c=n.length;a<c;a++)s=t[n[a]],i.push(l.length),s&&(l=l.concat(s.encode(r)));return i.push(l.length),{table:l,offsets:i}},e}(),Cde=function(){function e(t,n,r,s,i,l){this.raw=t,this.numberOfContours=n,this.xMin=r,this.yMin=s,this.xMax=i,this.yMax=l,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),Pde=function(){function e(t,n,r,s,i){var l,a;for(this.raw=t,this.xMin=n,this.yMin=r,this.xMax=s,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],l=this.raw;a=l.readShort(),this.glyphOffsets.push(l.pos),this.glyphIDs.push(l.readUInt16()),32&a;)l.pos+=1&a?4:2,128&a?l.pos+=8:64&a?l.pos+=4:8&a&&(l.pos+=2)}return e.prototype.encode=function(){var t,n,r;for(n=new bl(zO.call(this.raw.data)),t=0,r=this.glyphIDs.length;t<r;++t)n.pos=this.glyphOffsets[t];return n.data},e}(),Ide=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Ua(e,da),e.prototype.tag="loca",e.prototype.parse=function(t){var n,r;return t.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var s,i;for(i=[],r=0,s=this.length;r<s;r+=2)i.push(2*t.readUInt16());return i}).call(this):(function(){var s,i;for(i=[],r=0,s=this.length;r<s;r+=4)i.push(t.readUInt32());return i}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,n){for(var r=new Uint32Array(this.offsets.length),s=0,i=0,l=0;l<r.length;++l)if(r[l]=s,i<n.length&&n[i]==l){++i,r[l]=s;var a=this.offsets[l],c=this.offsets[l+1]-a;c>0&&(s+=c)}for(var d=new Array(4*r.length),u=0;u<r.length;++u)d[4*u+3]=255&r[u],d[4*u+2]=(65280&r[u])>>8,d[4*u+1]=(16711680&r[u])>>16,d[4*u]=(4278190080&r[u])>>24;return d},e}(),Tde=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,n,r,s,i;for(n in s=this.font.cmap.tables[0].codeMap,t={},i=this.subset)r=i[n],t[n]=s[r];return t},e.prototype.glyphsFor=function(t){var n,r,s,i,l,a,c;for(s={},l=0,a=t.length;l<a;l++)s[i=t[l]]=this.font.glyf.glyphFor(i);for(i in n=[],s)(r=s[i])!=null&&r.compound&&n.push.apply(n,r.glyphIDs);if(n.length>0)for(i in c=this.glyphsFor(n))r=c[i],s[i]=r;return s},e.prototype.encode=function(t,n){var r,s,i,l,a,c,d,u,f,m,h,g,y,p,x;for(s in r=BO.encode(this.generateCmap(),"unicode"),l=this.glyphsFor(t),h={0:0},x=r.charMap)h[(c=x[s]).old]=c.new;for(g in m=r.maxGlyphID,l)g in h||(h[g]=m++);return u=function(b){var w,N;for(w in N={},b)N[b[w]]=w;return N}(h),f=Object.keys(u).sort(function(b,w){return b-w}),y=function(){var b,w,N;for(N=[],b=0,w=f.length;b<w;b++)a=f[b],N.push(u[a]);return N}(),i=this.font.glyf.encode(l,y,h),d=this.font.loca.encode(i.offsets,y),p={cmap:this.font.cmap.raw(),glyf:i.table,loca:d,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(n)},this.font.os2.exists&&(p["OS/2"]=this.font.os2.raw()),this.font.directory.encode(p)},e}();qt.API.PDFObject=function(){var e;function t(){}return e=function(n,r){return(Array(r+1).join("0")+n).slice(-r)},t.convert=function(n){var r,s,i,l;if(Array.isArray(n))return"["+function(){var a,c,d;for(d=[],a=0,c=n.length;a<c;a++)r=n[a],d.push(t.convert(r));return d}().join(" ")+"]";if(typeof n=="string")return"/"+n;if(n!=null&&n.isString)return"("+n+")";if(n instanceof Date)return"(D:"+e(n.getUTCFullYear(),4)+e(n.getUTCMonth(),2)+e(n.getUTCDate(),2)+e(n.getUTCHours(),2)+e(n.getUTCMinutes(),2)+e(n.getUTCSeconds(),2)+"Z)";if({}.toString.call(n)==="[object Object]"){for(s in i=["<<"],n)l=n[s],i.push("/"+s+" "+t.convert(l));return i.push(">>"),i.join(`
`)}return""+n},t}();var UO={exports:{}};/*! dom-to-image-more 20-08-2025 */(function(e,t){(n=>{let r=(()=>{let R=0;return{escape:function(A){return A.replace(/([.*+?^${}()|[\]/\\])/g,"\\$1")},isDataUrl:function(A){return A.search(/^(data:)/)!==-1},canvasToBlob:function(A){return A.toBlob?new Promise(function(P){A.toBlob(P)}):(P=>new Promise(function(B){var L=h(P.toDataURL().split(",")[1]),D=L.length,V=new Uint8Array(D);for(let O=0;O<D;O++)V[O]=L.charCodeAt(O);B(new Blob([V],{type:"image/png"}))}))(A)},resolveUrl:function(A,P){var B=document.implementation.createHTMLDocument(),L=B.createElement("base"),D=(B.head.appendChild(L),B.createElement("a"));return B.body.appendChild(D),L.href=P,D.href=A,D.href},getAndEncode:function(A){let P=u.impl.urlCache.find(function(B){return B.url===A});return P||(P={url:A,promise:null},u.impl.urlCache.push(P)),P.promise===null&&(u.impl.options.cacheBust&&(A+=(/\?/.test(A)?"&":"?")+new Date().getTime()),P.promise=new Promise(function(B){let L=new XMLHttpRequest;function D(H){console.error(H),B("")}function V(){var H=u.impl.options.imagePlaceholder;H?B(H):D("Status:"+L.status+" while fetching resource: "+A)}if(L.timeout=u.impl.options.httpTimeout,L.onerror=V,L.ontimeout=V,L.onloadend=function(){if(L.readyState===XMLHttpRequest.DONE){var H=L.status;if(H===0&&A.toLowerCase().startsWith("file://")||200<=H&&H<=300&&L.response!==null){H=L.response,H instanceof Blob||D("Expected response to be a Blob, but got: "+typeof H);let W=new FileReader;W.onloadend=function(){var $=W.result;B($)};try{W.readAsDataURL(H)}catch($){D("Failed to read the response as Data URL: "+$.toString())}}else V()}},0<u.impl.options.useCredentialsFilters.length&&(u.impl.options.useCredentials=0<u.impl.options.useCredentialsFilters.filter(H=>0<=A.search(H)).length),u.impl.options.useCredentials&&(L.withCredentials=!0),u.impl.options.corsImg&&A.indexOf("http")===0&&A.indexOf(window.location.origin)===-1){var O=(u.impl.options.corsImg.method||"GET").toUpperCase()==="POST"?"POST":"GET";L.open(O,(u.impl.options.corsImg.url||"").replace("#{cors}",A),!0);let H=!1,W=u.impl.options.corsImg.headers||{},$=(Object.keys(W).forEach(function(z){W[z].indexOf("application/json")!==-1&&(H=!0),L.setRequestHeader(z,W[z])}),(z=>{try{return JSON.parse(JSON.stringify(z))}catch(q){D("corsImg.data is missing or invalid:"+q.toString())}})(u.impl.options.corsImg.data||""));Object.keys($).forEach(function(z){typeof $[z]=="string"&&($[z]=$[z].replace("#{cors}",A))}),L.responseType="blob",L.send(H?JSON.stringify($):$)}else L.open("GET",A,!0),L.responseType="blob",L.send()})),P.promise},uid:function(){return"u"+("0000"+(Math.random()*Math.pow(36,4)<<0).toString(36)).slice(-4)+R++},asArray:function(A){var P=[],B=A.length;for(let L=0;L<B;L++)P.push(A[L]);return P},escapeXhtml:function(A){return A.replace(/%/g,"%25").replace(/#/g,"%23").replace(/\n/g,"%0A")},makeImage:function(A){return A!=="data:,"?new Promise(function(P,B){let L=document.createElementNS("http://www.w3.org/2000/svg","svg"),D=new Image;u.impl.options.useCredentials&&(D.crossOrigin="use-credentials"),D.onload=function(){document.body.removeChild(L),window&&window.requestAnimationFrame?window.requestAnimationFrame(function(){P(D)}):P(D)},D.onerror=V=>{document.body.removeChild(L),B(V)},L.appendChild(D),D.src=A,document.body.appendChild(L)}):Promise.resolve()},width:function(A){var P=M(A,"width");if(!isNaN(P))return P;var P=M(A,"border-left-width"),B=M(A,"border-right-width");return A.scrollWidth+P+B},height:function(A){var P=M(A,"height");if(!isNaN(P))return P;var P=M(A,"border-top-width"),B=M(A,"border-bottom-width");return A.scrollHeight+P+B},getWindow:T,isElement:_,isElementHostForOpenShadowRoot:function(A){return _(A)&&A.shadowRoot!==null},isShadowRoot:S,isInShadowRoot:E,isHTMLElement:function(A){return A instanceof T(A).HTMLElement},isHTMLCanvasElement:function(A){return A instanceof T(A).HTMLCanvasElement},isHTMLInputElement:function(A){return A instanceof T(A).HTMLInputElement},isHTMLImageElement:function(A){return A instanceof T(A).HTMLImageElement},isHTMLLinkElement:function(A){return A instanceof T(A).HTMLLinkElement},isHTMLScriptElement:function(A){return A instanceof T(A).HTMLScriptElement},isHTMLStyleElement:function(A){return A instanceof T(A).HTMLStyleElement},isHTMLTextAreaElement:function(A){return A instanceof T(A).HTMLTextAreaElement},isShadowSlotElement:function(A){return E(A)&&A instanceof T(A).HTMLSlotElement},isSVGElement:function(A){return A instanceof T(A).SVGElement},isSVGRectElement:function(A){return A instanceof T(A).SVGRectElement},isDimensionMissing:function(A){return isNaN(A)||A<=0}};function T(A){return A=A?A.ownerDocument:void 0,(A?A.defaultView:void 0)||window||n}function S(A){return A instanceof T(A).ShadowRoot}function E(A){return A!=null&&A.getRootNode!==void 0&&S(A.getRootNode())}function _(A){return A instanceof T(A).Element}function M(A,P){if(A.nodeType===f){let B=m(A).getPropertyValue(P);if(B.slice(-2)==="px")return B=B.slice(0,-2),parseFloat(B)}return NaN}})(),s=(()=>{let R=/url\(\s*(["']?)((?:\\.|[^\\)])+)\1\s*\)/gm;return{inlineAll:function(M,A,P){return T(M)?Promise.resolve(M).then(S).then(function(B){let L=Promise.resolve(M);return B.forEach(function(D){L=L.then(function(V){return _(V,D,A,P)})}),L}):Promise.resolve(M)},shouldProcess:T,impl:{readUrls:S,inline:_,urlAsRegex:E}};function T(M){return M.search(R)!==-1}function S(M){for(var A,P=[];(A=R.exec(M))!==null;)P.push(A[2]);return P.filter(function(B){return!r.isDataUrl(B)})}function E(M){return new RegExp(`url\\((["']?)(${r.escape(M)})\\1\\)`,"gm")}function _(M,A,P,B){return Promise.resolve(A).then(function(L){return P?r.resolveUrl(L,P):L}).then(B||r.getAndEncode).then(function(L){var D=E(A);return M.replace(D,`url($1${L}$1)`)})}})(),i={resolveAll:function(){return l().then(function(R){return Promise.all(R.map(function(T){return T.resolve()}))}).then(function(R){return R.join(`
`)})},impl:{readAll:l}};function l(){return Promise.resolve(r.asArray(document.styleSheets)).then(function(T){let S=[];return T.forEach(function(E){var _=Object.getPrototypeOf(E);if(Object.prototype.hasOwnProperty.call(_,"cssRules"))try{r.asArray(E.cssRules||[]).forEach(S.push.bind(S))}catch(M){console.error("domtoimage: Error while reading CSS rules from: "+E.href,M.toString())}}),S}).then(function(T){return T.filter(function(S){return S.type===CSSRule.FONT_FACE_RULE}).filter(function(S){return s.shouldProcess(S.style.getPropertyValue("src"))})}).then(function(T){return T.map(R)});function R(T){return{resolve:function(){var S=(T.parentStyleSheet||{}).href;return s.inlineAll(T.cssText,S)},src:function(){return T.style.getPropertyValue("src")}}}}let a={inlineAll:function R(T){if(!r.isElement(T))return Promise.resolve(T);return S(T).then(function(){return r.isHTMLImageElement(T)?c(T).inline():Promise.all(r.asArray(T.childNodes).map(function(E){return R(E)}))});function S(E){let _=["background","background-image"],M=_.map(function(A){let P=E.style.getPropertyValue(A),B=E.style.getPropertyPriority(A);return P?s.inlineAll(P).then(function(L){E.style.setProperty(A,L,B)}):Promise.resolve()});return Promise.all(M).then(function(){return E})}},impl:{newImage:c}};function c(R){return{inline:function(T){return r.isDataUrl(R.src)?Promise.resolve():Promise.resolve(R.src).then(T||r.getAndEncode).then(function(S){return new Promise(function(E){R.onload=E,R.onerror=E,R.src=S})})}}}let d={copyDefaultStyles:!0,imagePlaceholder:void 0,cacheBust:!1,useCredentials:!1,useCredentialsFilters:[],httpTimeout:3e4,styleCaching:"strict",corsImg:void 0},u={toSvg:g,toPng:function(R,T){return y(R,T).then(function(S){return S.toDataURL()})},toJpeg:function(R,T){return y(R,T).then(function(S){return S.toDataURL("image/jpeg",(T?T.quality:void 0)||1)})},toBlob:function(R,T){return y(R,T).then(r.canvasToBlob)},toPixelData:function(R,T){return y(R,T).then(function(S){return S.getContext("2d").getImageData(0,0,r.width(R),r.height(R)).data})},toCanvas:y,impl:{fontFaces:i,images:a,util:r,inliner:s,urlCache:[],options:{},copyOptions:function(R){R.copyDefaultStyles===void 0?u.impl.options.copyDefaultStyles=d.copyDefaultStyles:u.impl.options.copyDefaultStyles=R.copyDefaultStyles,u.impl.options.imagePlaceholder=(R.imagePlaceholder===void 0?d:R).imagePlaceholder,u.impl.options.cacheBust=(R.cacheBust===void 0?d:R).cacheBust,u.impl.options.corsImg=(R.corsImg===void 0?d:R).corsImg,u.impl.options.useCredentials=(R.useCredentials===void 0?d:R).useCredentials,u.impl.options.useCredentialsFilters=(R.useCredentialsFilters===void 0?d:R).useCredentialsFilters,u.impl.options.httpTimeout=(R.httpTimeout===void 0?d:R).httpTimeout,u.impl.options.styleCaching=(R.styleCaching===void 0?d:R).styleCaching}}},f=(e.exports=u,(typeof Node<"u"?Node.ELEMENT_NODE:void 0)||1),m=(n!==void 0?n.getComputedStyle:void 0)||(typeof window<"u"?window.getComputedStyle:void 0)||globalThis.getComputedStyle,h=(n!==void 0?n.atob:void 0)||(typeof window<"u"?window.atob:void 0)||globalThis.atob;function g(R,T){u.impl.util.getWindow(R);let S=(T=T||{},u.impl.copyOptions(T),[]);return Promise.resolve(R).then(function(E){if(E.nodeType===f)return E;var _=E,M=E.parentNode,A=document.createElement("span");return M.replaceChild(A,_),A.append(E),S.push({parent:M,child:_,wrapper:A}),A}).then(function(E){return function _(M,A,P,B){let L=A.filter;if(M===p||r.isHTMLScriptElement(M)||r.isHTMLStyleElement(M)||r.isHTMLLinkElement(M)||P!==null&&L&&!L(M))return Promise.resolve();return Promise.resolve(M).then(D).then(V).then(function(z){return W(z,H(M))}).then(O).then(function(z){return $(z,M)});function D(z){return r.isHTMLCanvasElement(z)?r.makeImage(z.toDataURL()):z.cloneNode(!1)}function V(z){return A.adjustClonedNode&&A.adjustClonedNode(M,z,!1),Promise.resolve(z)}function O(z){return A.adjustClonedNode&&A.adjustClonedNode(M,z,!0),Promise.resolve(z)}function H(z){return r.isElementHostForOpenShadowRoot(z)?z.shadowRoot:z}function W(z,q){let G=ie(q),re=Promise.resolve();if(G.length!==0){let Y=m(oe(q));r.asArray(G).forEach(function(te){re=re.then(function(){return _(te,A,Y).then(function(we){we&&z.appendChild(we)})})})}return re.then(function(){return z});function oe(Y){return r.isShadowRoot(Y)?Y.host:Y}function ie(Y){if(r.isShadowSlotElement(Y)){let te=Y.assignedNodes();if(te&&0<te.length)return te}return Y.childNodes}}function $(z,q){return!r.isElement(z)||r.isShadowSlotElement(q)?Promise.resolve(z):Promise.resolve().then(re).then(oe).then(ie).then(Y).then(G).then(function(){return z});function G(){r.isHTMLImageElement(z)&&(z.removeAttribute("loading"),q.srcset||q.sizes)&&(z.removeAttribute("srcset"),z.removeAttribute("sizes"),z.src=q.currentSrc||q.src)}function re(){function te(me,Ee){Ee.font=me.font,Ee.fontFamily=me.fontFamily,Ee.fontFeatureSettings=me.fontFeatureSettings,Ee.fontKerning=me.fontKerning,Ee.fontSize=me.fontSize,Ee.fontStretch=me.fontStretch,Ee.fontStyle=me.fontStyle,Ee.fontVariant=me.fontVariant,Ee.fontVariantCaps=me.fontVariantCaps,Ee.fontVariantEastAsian=me.fontVariantEastAsian,Ee.fontVariantLigatures=me.fontVariantLigatures,Ee.fontVariantNumeric=me.fontVariantNumeric,Ee.fontVariationSettings=me.fontVariationSettings,Ee.fontWeight=me.fontWeight}function we(me,Ee){let pe=m(me);pe.cssText?(Ee.style.cssText=pe.cssText,te(pe,Ee.style)):(w(A,me,pe,P,Ee),P===null&&(["inset-block","inset-block-start","inset-block-end"].forEach(ee=>Ee.style.removeProperty(ee)),["left","right","top","bottom"].forEach(ee=>{Ee.style.getPropertyValue(ee)&&Ee.style.setProperty(ee,"0px")})))}we(q,z)}function oe(){let te=r.uid();function we(me){let Ee=m(q,me),pe=Ee.getPropertyValue("content");if(pe!==""&&pe!=="none"){let $e=function(){let De=`.${te}:`+me,ge=(Ee.cssText?Me:_e)();return document.createTextNode(De+`{${ge}}`);function Me(){return`${Ee.cssText} content: ${pe};`}function _e(){return r.asArray(Ee).map(se).join("; ")+";";function se(Ae){let Re=Ee.getPropertyValue(Ae),Ce=Ee.getPropertyPriority(Ae)?" !important":"";return Ae+": "+Re+Ce}}},ee=z.getAttribute("class")||"",ft=(z.setAttribute("class",ee+" "+te),document.createElement("style"));ft.appendChild($e()),z.appendChild(ft)}}[":before",":after"].forEach(function(me){we(me)})}function ie(){r.isHTMLTextAreaElement(q)&&(z.innerHTML=q.value),r.isHTMLInputElement(q)&&z.setAttribute("value",q.value)}function Y(){r.isSVGElement(z)&&(z.setAttribute("xmlns","http://www.w3.org/2000/svg"),r.isSVGRectElement(z))&&["width","height"].forEach(function(te){let we=z.getAttribute(te);we&&z.style.setProperty(te,we)})}}}(E,T,null)}).then(T.disableEmbedFonts?Promise.resolve(R):x).then(T.disableInlineImages?Promise.resolve(R):b).then(function(E){T.bgcolor&&(E.style.backgroundColor=T.bgcolor),T.width&&(E.style.width=T.width+"px"),T.height&&(E.style.height=T.height+"px"),T.style&&Object.keys(T.style).forEach(function(M){E.style[M]=T.style[M]});let _=null;return typeof T.onclone=="function"&&(_=T.onclone(E)),Promise.resolve(_).then(function(){return E})}).then(function(E){let _=T.width||r.width(R),M=T.height||r.height(R);return Promise.resolve(E).then(function(A){return A.setAttribute("xmlns","http://www.w3.org/1999/xhtml"),new XMLSerializer().serializeToString(A)}).then(r.escapeXhtml).then(function(A){var P=(r.isDimensionMissing(_)?' width="100%"':` width="${_}"`)+(r.isDimensionMissing(M)?' height="100%"':` height="${M}"`);return`<svg xmlns="http://www.w3.org/2000/svg"${(r.isDimensionMissing(_)?"":` width="${_}"`)+(r.isDimensionMissing(M)?"":` height="${M}"`)}><foreignObject${P}>${A}</foreignObject></svg>`}).then(function(A){return"data:image/svg+xml;charset=utf-8,"+A})}).then(function(E){for(;0<S.length;){var _=S.pop();_.parent.replaceChild(_.child,_.wrapper)}return E}).then(function(E){return u.impl.urlCache=[],p&&(document.body.removeChild(p),p=null),N&&clearTimeout(N),N=setTimeout(()=>{N=null,k={}},2e4),E})}function y(R,T){return g(R,T=T||{}).then(r.makeImage).then(function(S){var E=typeof T.scale!="number"?1:T.scale,_=((A,P)=>{let B=T.width||r.width(A),L=T.height||r.height(A);return r.isDimensionMissing(B)&&(B=r.isDimensionMissing(L)?300:2*L),r.isDimensionMissing(L)&&(L=B/2),(A=document.createElement("canvas")).width=B*P,A.height=L*P,T.bgcolor&&((P=A.getContext("2d")).fillStyle=T.bgcolor,P.fillRect(0,0,A.width,A.height)),A})(R,E),M=_.getContext("2d");return M.msImageSmoothingEnabled=!1,M.imageSmoothingEnabled=!1,S&&(M.scale(E,E),M.drawImage(S,0,0)),_})}let p=null;function x(R){return i.resolveAll().then(function(T){var S;return T!==""&&(S=document.createElement("style"),R.appendChild(S),S.appendChild(document.createTextNode(T))),R})}function b(R){return a.inlineAll(R).then(function(){return R})}function w(R,T,S,E,_){let M=u.impl.options.copyDefaultStyles?((P,B)=>{var L,D=(H=>(P.styleCaching!=="relaxed"?H:H.filter((W,$,z)=>$===0||$===z.length-1)).join(">"))(B=(H=>{var W=[];do if(H.nodeType===f){var $=H.tagName;if(W.push($),I.includes($))break}while(H=H.parentNode);return W})(B));{if(k[D])return k[D];B=((H,W)=>{let $=H.body;do{var z=W.pop(),z=H.createElement(z);$.appendChild(z),$=z}while(0<W.length);return $.textContent="",$})((L=(()=>{if(p)return p.contentWindow;W=document.characterSet||"UTF-8",H=(H=document.doctype)?(`<!DOCTYPE ${oe(H.name)} ${oe(H.publicId)} `+oe(H.systemId)).trim()+">":"",(p=document.createElement("iframe")).id="domtoimage-sandbox-"+r.uid(),p.style.visibility="hidden",p.style.position="fixed",document.body.appendChild(p);var H,W,$=p,z="domtoimage-sandbox";try{return $.contentWindow.document.write(H+`<html><head><meta charset='${W}'><title>${z}</title></head><body></body></html>`),$.contentWindow}catch{}var q=document.createElement("meta");q.setAttribute("charset",W);try{var G=document.implementation.createHTMLDocument(z),re=(G.head.appendChild(q),H+G.documentElement.outerHTML);return $.setAttribute("srcdoc",re),$.contentWindow}catch{}return $.contentDocument.head.appendChild(q),$.contentDocument.title=z,$.contentWindow;function oe(ie){var Y;return ie?((Y=document.createElement("div")).innerText=ie,Y.innerHTML):""}})()).document,B),L=((H,W)=>{let $={},z=H.getComputedStyle(W);return r.asArray(z).forEach(function(q){$[q]=q==="width"||q==="height"?"auto":z.getPropertyValue(q)}),$})(L,B);var V=B;do{var O=V.parentElement;O!==null&&O.removeChild(V),V=O}while(V&&V.tagName!=="BODY");return k[D]=L}})(R,T):{},A=_.style;r.asArray(S).forEach(function(P){var B,L,D,V;R.filterStyles&&!R.filterStyles(T,P)||(L=S.getPropertyValue(P),D=M[P],B=E?E.getPropertyValue(P):void 0,A.getPropertyValue(P))||(L!==D||E&&L!==B)&&(D=S.getPropertyPriority(P),B=A,L=L,D=D,V=0<=["background-clip"].indexOf(P=P),D?(B.setProperty(P,L,D),V&&B.setProperty("-webkit-"+P,L,D)):(B.setProperty(P,L),V&&B.setProperty("-webkit-"+P,L)))})}let N=null,k={},I=["ADDRESS","ARTICLE","ASIDE","BLOCKQUOTE","DETAILS","DIALOG","DD","DIV","DL","DT","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","HR","LI","MAIN","NAV","OL","P","PRE","SECTION","SVG","TABLE","UL","math","svg","BODY","HEAD","HTML"]})(Tf)})(UO);var Lde=UO.exports;const jA=n0(Lde);function tj(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var wy,_A;function Mde(){if(_A)return wy;_A=1;function e(){this.__data__=[],this.size=0}return wy=e,wy}var Ny,SA;function Cd(){if(SA)return Ny;SA=1;function e(t,n){return t===n||t!==t&&n!==n}return Ny=e,Ny}var jy,AA;function c1(){if(AA)return jy;AA=1;var e=Cd();function t(n,r){for(var s=n.length;s--;)if(e(n[s][0],r))return s;return-1}return jy=t,jy}var _y,kA;function Rde(){if(kA)return _y;kA=1;var e=c1(),t=Array.prototype,n=t.splice;function r(s){var i=this.__data__,l=e(i,s);if(l<0)return!1;var a=i.length-1;return l==a?i.pop():n.call(i,l,1),--this.size,!0}return _y=r,_y}var Sy,EA;function $de(){if(EA)return Sy;EA=1;var e=c1();function t(n){var r=this.__data__,s=e(r,n);return s<0?void 0:r[s][1]}return Sy=t,Sy}var Ay,CA;function Ode(){if(CA)return Ay;CA=1;var e=c1();function t(n){return e(this.__data__,n)>-1}return Ay=t,Ay}var ky,PA;function Fde(){if(PA)return ky;PA=1;var e=c1();function t(n,r){var s=this.__data__,i=e(s,n);return i<0?(++this.size,s.push([n,r])):s[i][1]=r,this}return ky=t,ky}var Ey,IA;function u1(){if(IA)return Ey;IA=1;var e=Mde(),t=Rde(),n=$de(),r=Ode(),s=Fde();function i(l){var a=-1,c=l==null?0:l.length;for(this.clear();++a<c;){var d=l[a];this.set(d[0],d[1])}}return i.prototype.clear=e,i.prototype.delete=t,i.prototype.get=n,i.prototype.has=r,i.prototype.set=s,Ey=i,Ey}var Cy,TA;function Dde(){if(TA)return Cy;TA=1;var e=u1();function t(){this.__data__=new e,this.size=0}return Cy=t,Cy}var Py,LA;function qde(){if(LA)return Py;LA=1;function e(t){var n=this.__data__,r=n.delete(t);return this.size=n.size,r}return Py=e,Py}var Iy,MA;function Bde(){if(MA)return Iy;MA=1;function e(t){return this.__data__.get(t)}return Iy=e,Iy}var Ty,RA;function zde(){if(RA)return Ty;RA=1;function e(t){return this.__data__.has(t)}return Ty=e,Ty}var Ly,$A;function HO(){if($A)return Ly;$A=1;var e=typeof Tf=="object"&&Tf&&Tf.Object===Object&&Tf;return Ly=e,Ly}var My,OA;function fa(){if(OA)return My;OA=1;var e=HO(),t=typeof self=="object"&&self&&self.Object===Object&&self,n=e||t||Function("return this")();return My=n,My}var Ry,FA;function Pd(){if(FA)return Ry;FA=1;var e=fa(),t=e.Symbol;return Ry=t,Ry}var $y,DA;function Ude(){if(DA)return $y;DA=1;var e=Pd(),t=Object.prototype,n=t.hasOwnProperty,r=t.toString,s=e?e.toStringTag:void 0;function i(l){var a=n.call(l,s),c=l[s];try{l[s]=void 0;var d=!0}catch{}var u=r.call(l);return d&&(a?l[s]=c:delete l[s]),u}return $y=i,$y}var Oy,qA;function Hde(){if(qA)return Oy;qA=1;var e=Object.prototype,t=e.toString;function n(r){return t.call(r)}return Oy=n,Oy}var Fy,BA;function qc(){if(BA)return Fy;BA=1;var e=Pd(),t=Ude(),n=Hde(),r="[object Null]",s="[object Undefined]",i=e?e.toStringTag:void 0;function l(a){return a==null?a===void 0?s:r:i&&i in Object(a)?t(a):n(a)}return Fy=l,Fy}var Dy,zA;function zi(){if(zA)return Dy;zA=1;function e(t){var n=typeof t;return t!=null&&(n=="object"||n=="function")}return Dy=e,Dy}var qy,UA;function cm(){if(UA)return qy;UA=1;var e=qc(),t=zi(),n="[object AsyncFunction]",r="[object Function]",s="[object GeneratorFunction]",i="[object Proxy]";function l(a){if(!t(a))return!1;var c=e(a);return c==r||c==s||c==n||c==i}return qy=l,qy}var By,HA;function Vde(){if(HA)return By;HA=1;var e=fa(),t=e["__core-js_shared__"];return By=t,By}var zy,VA;function Wde(){if(VA)return zy;VA=1;var e=Vde(),t=function(){var r=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function n(r){return!!t&&t in r}return zy=n,zy}var Uy,WA;function VO(){if(WA)return Uy;WA=1;var e=Function.prototype,t=e.toString;function n(r){if(r!=null){try{return t.call(r)}catch{}try{return r+""}catch{}}return""}return Uy=n,Uy}var Hy,GA;function Gde(){if(GA)return Hy;GA=1;var e=cm(),t=Wde(),n=zi(),r=VO(),s=/[\\^$.*+?()[\]{}|]/g,i=/^\[object .+?Constructor\]$/,l=Function.prototype,a=Object.prototype,c=l.toString,d=a.hasOwnProperty,u=RegExp("^"+c.call(d).replace(s,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function f(m){if(!n(m)||t(m))return!1;var h=e(m)?u:i;return h.test(r(m))}return Hy=f,Hy}var Vy,YA;function Yde(){if(YA)return Vy;YA=1;function e(t,n){return t==null?void 0:t[n]}return Vy=e,Vy}var Wy,XA;function Bc(){if(XA)return Wy;XA=1;var e=Gde(),t=Yde();function n(r,s){var i=t(r,s);return e(i)?i:void 0}return Wy=n,Wy}var Gy,KA;function nj(){if(KA)return Gy;KA=1;var e=Bc(),t=fa(),n=e(t,"Map");return Gy=n,Gy}var Yy,JA;function d1(){if(JA)return Yy;JA=1;var e=Bc(),t=e(Object,"create");return Yy=t,Yy}var Xy,ZA;function Xde(){if(ZA)return Xy;ZA=1;var e=d1();function t(){this.__data__=e?e(null):{},this.size=0}return Xy=t,Xy}var Ky,QA;function Kde(){if(QA)return Ky;QA=1;function e(t){var n=this.has(t)&&delete this.__data__[t];return this.size-=n?1:0,n}return Ky=e,Ky}var Jy,ek;function Jde(){if(ek)return Jy;ek=1;var e=d1(),t="__lodash_hash_undefined__",n=Object.prototype,r=n.hasOwnProperty;function s(i){var l=this.__data__;if(e){var a=l[i];return a===t?void 0:a}return r.call(l,i)?l[i]:void 0}return Jy=s,Jy}var Zy,tk;function Zde(){if(tk)return Zy;tk=1;var e=d1(),t=Object.prototype,n=t.hasOwnProperty;function r(s){var i=this.__data__;return e?i[s]!==void 0:n.call(i,s)}return Zy=r,Zy}var Qy,nk;function Qde(){if(nk)return Qy;nk=1;var e=d1(),t="__lodash_hash_undefined__";function n(r,s){var i=this.__data__;return this.size+=this.has(r)?0:1,i[r]=e&&s===void 0?t:s,this}return Qy=n,Qy}var e2,rk;function efe(){if(rk)return e2;rk=1;var e=Xde(),t=Kde(),n=Jde(),r=Zde(),s=Qde();function i(l){var a=-1,c=l==null?0:l.length;for(this.clear();++a<c;){var d=l[a];this.set(d[0],d[1])}}return i.prototype.clear=e,i.prototype.delete=t,i.prototype.get=n,i.prototype.has=r,i.prototype.set=s,e2=i,e2}var t2,sk;function tfe(){if(sk)return t2;sk=1;var e=efe(),t=u1(),n=nj();function r(){this.size=0,this.__data__={hash:new e,map:new(n||t),string:new e}}return t2=r,t2}var n2,ik;function nfe(){if(ik)return n2;ik=1;function e(t){var n=typeof t;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?t!=="__proto__":t===null}return n2=e,n2}var r2,ak;function f1(){if(ak)return r2;ak=1;var e=nfe();function t(n,r){var s=n.__data__;return e(r)?s[typeof r=="string"?"string":"hash"]:s.map}return r2=t,r2}var s2,ok;function rfe(){if(ok)return s2;ok=1;var e=f1();function t(n){var r=e(this,n).delete(n);return this.size-=r?1:0,r}return s2=t,s2}var i2,lk;function sfe(){if(lk)return i2;lk=1;var e=f1();function t(n){return e(this,n).get(n)}return i2=t,i2}var a2,ck;function ife(){if(ck)return a2;ck=1;var e=f1();function t(n){return e(this,n).has(n)}return a2=t,a2}var o2,uk;function afe(){if(uk)return o2;uk=1;var e=f1();function t(n,r){var s=e(this,n),i=s.size;return s.set(n,r),this.size+=s.size==i?0:1,this}return o2=t,o2}var l2,dk;function rj(){if(dk)return l2;dk=1;var e=tfe(),t=rfe(),n=sfe(),r=ife(),s=afe();function i(l){var a=-1,c=l==null?0:l.length;for(this.clear();++a<c;){var d=l[a];this.set(d[0],d[1])}}return i.prototype.clear=e,i.prototype.delete=t,i.prototype.get=n,i.prototype.has=r,i.prototype.set=s,l2=i,l2}var c2,fk;function ofe(){if(fk)return c2;fk=1;var e=u1(),t=nj(),n=rj(),r=200;function s(i,l){var a=this.__data__;if(a instanceof e){var c=a.__data__;if(!t||c.length<r-1)return c.push([i,l]),this.size=++a.size,this;a=this.__data__=new n(c)}return a.set(i,l),this.size=a.size,this}return c2=s,c2}var u2,hk;function h1(){if(hk)return u2;hk=1;var e=u1(),t=Dde(),n=qde(),r=Bde(),s=zde(),i=ofe();function l(a){var c=this.__data__=new e(a);this.size=c.size}return l.prototype.clear=t,l.prototype.delete=n,l.prototype.get=r,l.prototype.has=s,l.prototype.set=i,u2=l,u2}var d2,mk;function sj(){if(mk)return d2;mk=1;function e(t,n){for(var r=-1,s=t==null?0:t.length;++r<s&&n(t[r],r,t)!==!1;);return t}return d2=e,d2}var f2,pk;function WO(){if(pk)return f2;pk=1;var e=Bc(),t=function(){try{var n=e(Object,"defineProperty");return n({},"",{}),n}catch{}}();return f2=t,f2}var h2,gk;function m1(){if(gk)return h2;gk=1;var e=WO();function t(n,r,s){r=="__proto__"&&e?e(n,r,{configurable:!0,enumerable:!0,value:s,writable:!0}):n[r]=s}return h2=t,h2}var m2,xk;function p1(){if(xk)return m2;xk=1;var e=m1(),t=Cd(),n=Object.prototype,r=n.hasOwnProperty;function s(i,l,a){var c=i[l];(!(r.call(i,l)&&t(c,a))||a===void 0&&!(l in i))&&e(i,l,a)}return m2=s,m2}var p2,yk;function um(){if(yk)return p2;yk=1;var e=p1(),t=m1();function n(r,s,i,l){var a=!i;i||(i={});for(var c=-1,d=s.length;++c<d;){var u=s[c],f=l?l(i[u],r[u],u,i,r):void 0;f===void 0&&(f=r[u]),a?t(i,u,f):e(i,u,f)}return i}return p2=n,p2}var g2,vk;function lfe(){if(vk)return g2;vk=1;function e(t,n){for(var r=-1,s=Array(t);++r<t;)s[r]=n(r);return s}return g2=e,g2}var x2,bk;function Ha(){if(bk)return x2;bk=1;function e(t){return t!=null&&typeof t=="object"}return x2=e,x2}var y2,wk;function cfe(){if(wk)return y2;wk=1;var e=qc(),t=Ha(),n="[object Arguments]";function r(s){return t(s)&&e(s)==n}return y2=r,y2}var v2,Nk;function dm(){if(Nk)return v2;Nk=1;var e=cfe(),t=Ha(),n=Object.prototype,r=n.hasOwnProperty,s=n.propertyIsEnumerable,i=e(function(){return arguments}())?e:function(l){return t(l)&&r.call(l,"callee")&&!s.call(l,"callee")};return v2=i,v2}var b2,jk;function zr(){if(jk)return b2;jk=1;var e=Array.isArray;return b2=e,b2}var Gf={exports:{}},w2,_k;function ufe(){if(_k)return w2;_k=1;function e(){return!1}return w2=e,w2}Gf.exports;var Sk;function Id(){return Sk||(Sk=1,function(e,t){var n=fa(),r=ufe(),s=t&&!t.nodeType&&t,i=s&&!0&&e&&!e.nodeType&&e,l=i&&i.exports===s,a=l?n.Buffer:void 0,c=a?a.isBuffer:void 0,d=c||r;e.exports=d}(Gf,Gf.exports)),Gf.exports}var N2,Ak;function g1(){if(Ak)return N2;Ak=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function n(r,s){var i=typeof r;return s=s??e,!!s&&(i=="number"||i!="symbol"&&t.test(r))&&r>-1&&r%1==0&&r<s}return N2=n,N2}var j2,kk;function ij(){if(kk)return j2;kk=1;var e=9007199254740991;function t(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=e}return j2=t,j2}var _2,Ek;function dfe(){if(Ek)return _2;Ek=1;var e=qc(),t=ij(),n=Ha(),r="[object Arguments]",s="[object Array]",i="[object Boolean]",l="[object Date]",a="[object Error]",c="[object Function]",d="[object Map]",u="[object Number]",f="[object Object]",m="[object RegExp]",h="[object Set]",g="[object String]",y="[object WeakMap]",p="[object ArrayBuffer]",x="[object DataView]",b="[object Float32Array]",w="[object Float64Array]",N="[object Int8Array]",k="[object Int16Array]",I="[object Int32Array]",R="[object Uint8Array]",T="[object Uint8ClampedArray]",S="[object Uint16Array]",E="[object Uint32Array]",_={};_[b]=_[w]=_[N]=_[k]=_[I]=_[R]=_[T]=_[S]=_[E]=!0,_[r]=_[s]=_[p]=_[i]=_[x]=_[l]=_[a]=_[c]=_[d]=_[u]=_[f]=_[m]=_[h]=_[g]=_[y]=!1;function M(A){return n(A)&&t(A.length)&&!!_[e(A)]}return _2=M,_2}var S2,Ck;function x1(){if(Ck)return S2;Ck=1;function e(t){return function(n){return t(n)}}return S2=e,S2}var Yf={exports:{}};Yf.exports;var Pk;function aj(){return Pk||(Pk=1,function(e,t){var n=HO(),r=t&&!t.nodeType&&t,s=r&&!0&&e&&!e.nodeType&&e,i=s&&s.exports===r,l=i&&n.process,a=function(){try{var c=s&&s.require&&s.require("util").types;return c||l&&l.binding&&l.binding("util")}catch{}}();e.exports=a}(Yf,Yf.exports)),Yf.exports}var A2,Ik;function fm(){if(Ik)return A2;Ik=1;var e=dfe(),t=x1(),n=aj(),r=n&&n.isTypedArray,s=r?t(r):e;return A2=s,A2}var k2,Tk;function GO(){if(Tk)return k2;Tk=1;var e=lfe(),t=dm(),n=zr(),r=Id(),s=g1(),i=fm(),l=Object.prototype,a=l.hasOwnProperty;function c(d,u){var f=n(d),m=!f&&t(d),h=!f&&!m&&r(d),g=!f&&!m&&!h&&i(d),y=f||m||h||g,p=y?e(d.length,String):[],x=p.length;for(var b in d)(u||a.call(d,b))&&!(y&&(b=="length"||h&&(b=="offset"||b=="parent")||g&&(b=="buffer"||b=="byteLength"||b=="byteOffset")||s(b,x)))&&p.push(b);return p}return k2=c,k2}var E2,Lk;function y1(){if(Lk)return E2;Lk=1;var e=Object.prototype;function t(n){var r=n&&n.constructor,s=typeof r=="function"&&r.prototype||e;return n===s}return E2=t,E2}var C2,Mk;function YO(){if(Mk)return C2;Mk=1;function e(t,n){return function(r){return t(n(r))}}return C2=e,C2}var P2,Rk;function ffe(){if(Rk)return P2;Rk=1;var e=YO(),t=e(Object.keys,Object);return P2=t,P2}var I2,$k;function oj(){if($k)return I2;$k=1;var e=y1(),t=ffe(),n=Object.prototype,r=n.hasOwnProperty;function s(i){if(!e(i))return t(i);var l=[];for(var a in Object(i))r.call(i,a)&&a!="constructor"&&l.push(a);return l}return I2=s,I2}var T2,Ok;function Co(){if(Ok)return T2;Ok=1;var e=cm(),t=ij();function n(r){return r!=null&&t(r.length)&&!e(r)}return T2=n,T2}var L2,Fk;function El(){if(Fk)return L2;Fk=1;var e=GO(),t=oj(),n=Co();function r(s){return n(s)?e(s):t(s)}return L2=r,L2}var M2,Dk;function hfe(){if(Dk)return M2;Dk=1;var e=um(),t=El();function n(r,s){return r&&e(s,t(s),r)}return M2=n,M2}var R2,qk;function mfe(){if(qk)return R2;qk=1;function e(t){var n=[];if(t!=null)for(var r in Object(t))n.push(r);return n}return R2=e,R2}var $2,Bk;function pfe(){if(Bk)return $2;Bk=1;var e=zi(),t=y1(),n=mfe(),r=Object.prototype,s=r.hasOwnProperty;function i(l){if(!e(l))return n(l);var a=t(l),c=[];for(var d in l)d=="constructor"&&(a||!s.call(l,d))||c.push(d);return c}return $2=i,$2}var O2,zk;function zc(){if(zk)return O2;zk=1;var e=GO(),t=pfe(),n=Co();function r(s){return n(s)?e(s,!0):t(s)}return O2=r,O2}var F2,Uk;function gfe(){if(Uk)return F2;Uk=1;var e=um(),t=zc();function n(r,s){return r&&e(s,t(s),r)}return F2=n,F2}var Xf={exports:{}};Xf.exports;var Hk;function XO(){return Hk||(Hk=1,function(e,t){var n=fa(),r=t&&!t.nodeType&&t,s=r&&!0&&e&&!e.nodeType&&e,i=s&&s.exports===r,l=i?n.Buffer:void 0,a=l?l.allocUnsafe:void 0;function c(d,u){if(u)return d.slice();var f=d.length,m=a?a(f):new d.constructor(f);return d.copy(m),m}e.exports=c}(Xf,Xf.exports)),Xf.exports}var D2,Vk;function KO(){if(Vk)return D2;Vk=1;function e(t,n){var r=-1,s=t.length;for(n||(n=Array(s));++r<s;)n[r]=t[r];return n}return D2=e,D2}var q2,Wk;function JO(){if(Wk)return q2;Wk=1;function e(t,n){for(var r=-1,s=t==null?0:t.length,i=0,l=[];++r<s;){var a=t[r];n(a,r,t)&&(l[i++]=a)}return l}return q2=e,q2}var B2,Gk;function ZO(){if(Gk)return B2;Gk=1;function e(){return[]}return B2=e,B2}var z2,Yk;function lj(){if(Yk)return z2;Yk=1;var e=JO(),t=ZO(),n=Object.prototype,r=n.propertyIsEnumerable,s=Object.getOwnPropertySymbols,i=s?function(l){return l==null?[]:(l=Object(l),e(s(l),function(a){return r.call(l,a)}))}:t;return z2=i,z2}var U2,Xk;function xfe(){if(Xk)return U2;Xk=1;var e=um(),t=lj();function n(r,s){return e(r,t(r),s)}return U2=n,U2}var H2,Kk;function cj(){if(Kk)return H2;Kk=1;function e(t,n){for(var r=-1,s=n.length,i=t.length;++r<s;)t[i+r]=n[r];return t}return H2=e,H2}var V2,Jk;function v1(){if(Jk)return V2;Jk=1;var e=YO(),t=e(Object.getPrototypeOf,Object);return V2=t,V2}var W2,Zk;function QO(){if(Zk)return W2;Zk=1;var e=cj(),t=v1(),n=lj(),r=ZO(),s=Object.getOwnPropertySymbols,i=s?function(l){for(var a=[];l;)e(a,n(l)),l=t(l);return a}:r;return W2=i,W2}var G2,Qk;function yfe(){if(Qk)return G2;Qk=1;var e=um(),t=QO();function n(r,s){return e(r,t(r),s)}return G2=n,G2}var Y2,eE;function eF(){if(eE)return Y2;eE=1;var e=cj(),t=zr();function n(r,s,i){var l=s(r);return t(r)?l:e(l,i(r))}return Y2=n,Y2}var X2,tE;function tF(){if(tE)return X2;tE=1;var e=eF(),t=lj(),n=El();function r(s){return e(s,n,t)}return X2=r,X2}var K2,nE;function vfe(){if(nE)return K2;nE=1;var e=eF(),t=QO(),n=zc();function r(s){return e(s,n,t)}return K2=r,K2}var J2,rE;function bfe(){if(rE)return J2;rE=1;var e=Bc(),t=fa(),n=e(t,"DataView");return J2=n,J2}var Z2,sE;function wfe(){if(sE)return Z2;sE=1;var e=Bc(),t=fa(),n=e(t,"Promise");return Z2=n,Z2}var Q2,iE;function nF(){if(iE)return Q2;iE=1;var e=Bc(),t=fa(),n=e(t,"Set");return Q2=n,Q2}var ev,aE;function Nfe(){if(aE)return ev;aE=1;var e=Bc(),t=fa(),n=e(t,"WeakMap");return ev=n,ev}var tv,oE;function Td(){if(oE)return tv;oE=1;var e=bfe(),t=nj(),n=wfe(),r=nF(),s=Nfe(),i=qc(),l=VO(),a="[object Map]",c="[object Object]",d="[object Promise]",u="[object Set]",f="[object WeakMap]",m="[object DataView]",h=l(e),g=l(t),y=l(n),p=l(r),x=l(s),b=i;return(e&&b(new e(new ArrayBuffer(1)))!=m||t&&b(new t)!=a||n&&b(n.resolve())!=d||r&&b(new r)!=u||s&&b(new s)!=f)&&(b=function(w){var N=i(w),k=N==c?w.constructor:void 0,I=k?l(k):"";if(I)switch(I){case h:return m;case g:return a;case y:return d;case p:return u;case x:return f}return N}),tv=b,tv}var nv,lE;function jfe(){if(lE)return nv;lE=1;var e=Object.prototype,t=e.hasOwnProperty;function n(r){var s=r.length,i=new r.constructor(s);return s&&typeof r[0]=="string"&&t.call(r,"index")&&(i.index=r.index,i.input=r.input),i}return nv=n,nv}var rv,cE;function rF(){if(cE)return rv;cE=1;var e=fa(),t=e.Uint8Array;return rv=t,rv}var sv,uE;function uj(){if(uE)return sv;uE=1;var e=rF();function t(n){var r=new n.constructor(n.byteLength);return new e(r).set(new e(n)),r}return sv=t,sv}var iv,dE;function _fe(){if(dE)return iv;dE=1;var e=uj();function t(n,r){var s=r?e(n.buffer):n.buffer;return new n.constructor(s,n.byteOffset,n.byteLength)}return iv=t,iv}var av,fE;function Sfe(){if(fE)return av;fE=1;var e=/\w*$/;function t(n){var r=new n.constructor(n.source,e.exec(n));return r.lastIndex=n.lastIndex,r}return av=t,av}var ov,hE;function Afe(){if(hE)return ov;hE=1;var e=Pd(),t=e?e.prototype:void 0,n=t?t.valueOf:void 0;function r(s){return n?Object(n.call(s)):{}}return ov=r,ov}var lv,mE;function sF(){if(mE)return lv;mE=1;var e=uj();function t(n,r){var s=r?e(n.buffer):n.buffer;return new n.constructor(s,n.byteOffset,n.length)}return lv=t,lv}var cv,pE;function kfe(){if(pE)return cv;pE=1;var e=uj(),t=_fe(),n=Sfe(),r=Afe(),s=sF(),i="[object Boolean]",l="[object Date]",a="[object Map]",c="[object Number]",d="[object RegExp]",u="[object Set]",f="[object String]",m="[object Symbol]",h="[object ArrayBuffer]",g="[object DataView]",y="[object Float32Array]",p="[object Float64Array]",x="[object Int8Array]",b="[object Int16Array]",w="[object Int32Array]",N="[object Uint8Array]",k="[object Uint8ClampedArray]",I="[object Uint16Array]",R="[object Uint32Array]";function T(S,E,_){var M=S.constructor;switch(E){case h:return e(S);case i:case l:return new M(+S);case g:return t(S,_);case y:case p:case x:case b:case w:case N:case k:case I:case R:return s(S,_);case a:return new M;case c:case f:return new M(S);case d:return n(S);case u:return new M;case m:return r(S)}}return cv=T,cv}var uv,gE;function iF(){if(gE)return uv;gE=1;var e=zi(),t=Object.create,n=function(){function r(){}return function(s){if(!e(s))return{};if(t)return t(s);r.prototype=s;var i=new r;return r.prototype=void 0,i}}();return uv=n,uv}var dv,xE;function aF(){if(xE)return dv;xE=1;var e=iF(),t=v1(),n=y1();function r(s){return typeof s.constructor=="function"&&!n(s)?e(t(s)):{}}return dv=r,dv}var fv,yE;function Efe(){if(yE)return fv;yE=1;var e=Td(),t=Ha(),n="[object Map]";function r(s){return t(s)&&e(s)==n}return fv=r,fv}var hv,vE;function Cfe(){if(vE)return hv;vE=1;var e=Efe(),t=x1(),n=aj(),r=n&&n.isMap,s=r?t(r):e;return hv=s,hv}var mv,bE;function Pfe(){if(bE)return mv;bE=1;var e=Td(),t=Ha(),n="[object Set]";function r(s){return t(s)&&e(s)==n}return mv=r,mv}var pv,wE;function Ife(){if(wE)return pv;wE=1;var e=Pfe(),t=x1(),n=aj(),r=n&&n.isSet,s=r?t(r):e;return pv=s,pv}var gv,NE;function oF(){if(NE)return gv;NE=1;var e=h1(),t=sj(),n=p1(),r=hfe(),s=gfe(),i=XO(),l=KO(),a=xfe(),c=yfe(),d=tF(),u=vfe(),f=Td(),m=jfe(),h=kfe(),g=aF(),y=zr(),p=Id(),x=Cfe(),b=zi(),w=Ife(),N=El(),k=zc(),I=1,R=2,T=4,S="[object Arguments]",E="[object Array]",_="[object Boolean]",M="[object Date]",A="[object Error]",P="[object Function]",B="[object GeneratorFunction]",L="[object Map]",D="[object Number]",V="[object Object]",O="[object RegExp]",H="[object Set]",W="[object String]",$="[object Symbol]",z="[object WeakMap]",q="[object ArrayBuffer]",G="[object DataView]",re="[object Float32Array]",oe="[object Float64Array]",ie="[object Int8Array]",Y="[object Int16Array]",te="[object Int32Array]",we="[object Uint8Array]",me="[object Uint8ClampedArray]",Ee="[object Uint16Array]",pe="[object Uint32Array]",ee={};ee[S]=ee[E]=ee[q]=ee[G]=ee[_]=ee[M]=ee[re]=ee[oe]=ee[ie]=ee[Y]=ee[te]=ee[L]=ee[D]=ee[V]=ee[O]=ee[H]=ee[W]=ee[$]=ee[we]=ee[me]=ee[Ee]=ee[pe]=!0,ee[A]=ee[P]=ee[z]=!1;function ft($e,De,ge,Me,_e,ke){var se,Ae=De&I,Re=De&R,Ce=De&T;if(ge&&(se=_e?ge($e,Me,_e,ke):ge($e)),se!==void 0)return se;if(!b($e))return $e;var ve=y($e);if(ve){if(se=m($e),!Ae)return l($e,se)}else{var Be=f($e),le=Be==P||Be==B;if(p($e))return i($e,Ae);if(Be==V||Be==S||le&&!_e){if(se=Re||le?{}:g($e),!Ae)return Re?c($e,s(se,$e)):a($e,r(se,$e))}else{if(!ee[Be])return _e?$e:{};se=h($e,Be,Ae)}}ke||(ke=new e);var fe=ke.get($e);if(fe)return fe;ke.set($e,se),w($e)?$e.forEach(function(je){se.add(ft(je,De,ge,je,$e,ke))}):x($e)&&$e.forEach(function(je,he){se.set(he,ft(je,De,ge,he,$e,ke))});var Te=Ce?Re?u:d:Re?k:N,at=ve?void 0:Te($e);return t(at||$e,function(je,he){at&&(he=je,je=$e[he]),n(se,he,ft(je,De,ge,he,$e,ke))}),se}return gv=ft,gv}var xv,jE;function Tfe(){if(jE)return xv;jE=1;var e=oF(),t=4;function n(r){return e(r,t)}return xv=n,xv}var yv,_E;function dj(){if(_E)return yv;_E=1;function e(t){return function(){return t}}return yv=e,yv}var vv,SE;function Lfe(){if(SE)return vv;SE=1;function e(t){return function(n,r,s){for(var i=-1,l=Object(n),a=s(n),c=a.length;c--;){var d=a[t?c:++i];if(r(l[d],d,l)===!1)break}return n}}return vv=e,vv}var bv,AE;function fj(){if(AE)return bv;AE=1;var e=Lfe(),t=e();return bv=t,bv}var wv,kE;function hj(){if(kE)return wv;kE=1;var e=fj(),t=El();function n(r,s){return r&&e(r,s,t)}return wv=n,wv}var Nv,EE;function Mfe(){if(EE)return Nv;EE=1;var e=Co();function t(n,r){return function(s,i){if(s==null)return s;if(!e(s))return n(s,i);for(var l=s.length,a=r?l:-1,c=Object(s);(r?a--:++a<l)&&i(c[a],a,c)!==!1;);return s}}return Nv=t,Nv}var jv,CE;function b1(){if(CE)return jv;CE=1;var e=hj(),t=Mfe(),n=t(e);return jv=n,jv}var _v,PE;function Uc(){if(PE)return _v;PE=1;function e(t){return t}return _v=e,_v}var Sv,IE;function lF(){if(IE)return Sv;IE=1;var e=Uc();function t(n){return typeof n=="function"?n:e}return Sv=t,Sv}var Av,TE;function cF(){if(TE)return Av;TE=1;var e=sj(),t=b1(),n=lF(),r=zr();function s(i,l){var a=r(i)?e:t;return a(i,n(l))}return Av=s,Av}var kv,LE;function uF(){return LE||(LE=1,kv=cF()),kv}var Ev,ME;function Rfe(){if(ME)return Ev;ME=1;var e=b1();function t(n,r){var s=[];return e(n,function(i,l,a){r(i,l,a)&&s.push(i)}),s}return Ev=t,Ev}var Cv,RE;function $fe(){if(RE)return Cv;RE=1;var e="__lodash_hash_undefined__";function t(n){return this.__data__.set(n,e),this}return Cv=t,Cv}var Pv,$E;function Ofe(){if($E)return Pv;$E=1;function e(t){return this.__data__.has(t)}return Pv=e,Pv}var Iv,OE;function dF(){if(OE)return Iv;OE=1;var e=rj(),t=$fe(),n=Ofe();function r(s){var i=-1,l=s==null?0:s.length;for(this.__data__=new e;++i<l;)this.add(s[i])}return r.prototype.add=r.prototype.push=t,r.prototype.has=n,Iv=r,Iv}var Tv,FE;function Ffe(){if(FE)return Tv;FE=1;function e(t,n){for(var r=-1,s=t==null?0:t.length;++r<s;)if(n(t[r],r,t))return!0;return!1}return Tv=e,Tv}var Lv,DE;function fF(){if(DE)return Lv;DE=1;function e(t,n){return t.has(n)}return Lv=e,Lv}var Mv,qE;function hF(){if(qE)return Mv;qE=1;var e=dF(),t=Ffe(),n=fF(),r=1,s=2;function i(l,a,c,d,u,f){var m=c&r,h=l.length,g=a.length;if(h!=g&&!(m&&g>h))return!1;var y=f.get(l),p=f.get(a);if(y&&p)return y==a&&p==l;var x=-1,b=!0,w=c&s?new e:void 0;for(f.set(l,a),f.set(a,l);++x<h;){var N=l[x],k=a[x];if(d)var I=m?d(k,N,x,a,l,f):d(N,k,x,l,a,f);if(I!==void 0){if(I)continue;b=!1;break}if(w){if(!t(a,function(R,T){if(!n(w,T)&&(N===R||u(N,R,c,d,f)))return w.push(T)})){b=!1;break}}else if(!(N===k||u(N,k,c,d,f))){b=!1;break}}return f.delete(l),f.delete(a),b}return Mv=i,Mv}var Rv,BE;function Dfe(){if(BE)return Rv;BE=1;function e(t){var n=-1,r=Array(t.size);return t.forEach(function(s,i){r[++n]=[i,s]}),r}return Rv=e,Rv}var $v,zE;function mj(){if(zE)return $v;zE=1;function e(t){var n=-1,r=Array(t.size);return t.forEach(function(s){r[++n]=s}),r}return $v=e,$v}var Ov,UE;function qfe(){if(UE)return Ov;UE=1;var e=Pd(),t=rF(),n=Cd(),r=hF(),s=Dfe(),i=mj(),l=1,a=2,c="[object Boolean]",d="[object Date]",u="[object Error]",f="[object Map]",m="[object Number]",h="[object RegExp]",g="[object Set]",y="[object String]",p="[object Symbol]",x="[object ArrayBuffer]",b="[object DataView]",w=e?e.prototype:void 0,N=w?w.valueOf:void 0;function k(I,R,T,S,E,_,M){switch(T){case b:if(I.byteLength!=R.byteLength||I.byteOffset!=R.byteOffset)return!1;I=I.buffer,R=R.buffer;case x:return!(I.byteLength!=R.byteLength||!_(new t(I),new t(R)));case c:case d:case m:return n(+I,+R);case u:return I.name==R.name&&I.message==R.message;case h:case y:return I==R+"";case f:var A=s;case g:var P=S&l;if(A||(A=i),I.size!=R.size&&!P)return!1;var B=M.get(I);if(B)return B==R;S|=a,M.set(I,R);var L=r(A(I),A(R),S,E,_,M);return M.delete(I),L;case p:if(N)return N.call(I)==N.call(R)}return!1}return Ov=k,Ov}var Fv,HE;function Bfe(){if(HE)return Fv;HE=1;var e=tF(),t=1,n=Object.prototype,r=n.hasOwnProperty;function s(i,l,a,c,d,u){var f=a&t,m=e(i),h=m.length,g=e(l),y=g.length;if(h!=y&&!f)return!1;for(var p=h;p--;){var x=m[p];if(!(f?x in l:r.call(l,x)))return!1}var b=u.get(i),w=u.get(l);if(b&&w)return b==l&&w==i;var N=!0;u.set(i,l),u.set(l,i);for(var k=f;++p<h;){x=m[p];var I=i[x],R=l[x];if(c)var T=f?c(R,I,x,l,i,u):c(I,R,x,i,l,u);if(!(T===void 0?I===R||d(I,R,a,c,u):T)){N=!1;break}k||(k=x=="constructor")}if(N&&!k){var S=i.constructor,E=l.constructor;S!=E&&"constructor"in i&&"constructor"in l&&!(typeof S=="function"&&S instanceof S&&typeof E=="function"&&E instanceof E)&&(N=!1)}return u.delete(i),u.delete(l),N}return Fv=s,Fv}var Dv,VE;function zfe(){if(VE)return Dv;VE=1;var e=h1(),t=hF(),n=qfe(),r=Bfe(),s=Td(),i=zr(),l=Id(),a=fm(),c=1,d="[object Arguments]",u="[object Array]",f="[object Object]",m=Object.prototype,h=m.hasOwnProperty;function g(y,p,x,b,w,N){var k=i(y),I=i(p),R=k?u:s(y),T=I?u:s(p);R=R==d?f:R,T=T==d?f:T;var S=R==f,E=T==f,_=R==T;if(_&&l(y)){if(!l(p))return!1;k=!0,S=!1}if(_&&!S)return N||(N=new e),k||a(y)?t(y,p,x,b,w,N):n(y,p,R,x,b,w,N);if(!(x&c)){var M=S&&h.call(y,"__wrapped__"),A=E&&h.call(p,"__wrapped__");if(M||A){var P=M?y.value():y,B=A?p.value():p;return N||(N=new e),w(P,B,x,b,N)}}return _?(N||(N=new e),r(y,p,x,b,w,N)):!1}return Dv=g,Dv}var qv,WE;function mF(){if(WE)return qv;WE=1;var e=zfe(),t=Ha();function n(r,s,i,l,a){return r===s?!0:r==null||s==null||!t(r)&&!t(s)?r!==r&&s!==s:e(r,s,i,l,n,a)}return qv=n,qv}var Bv,GE;function Ufe(){if(GE)return Bv;GE=1;var e=h1(),t=mF(),n=1,r=2;function s(i,l,a,c){var d=a.length,u=d,f=!c;if(i==null)return!u;for(i=Object(i);d--;){var m=a[d];if(f&&m[2]?m[1]!==i[m[0]]:!(m[0]in i))return!1}for(;++d<u;){m=a[d];var h=m[0],g=i[h],y=m[1];if(f&&m[2]){if(g===void 0&&!(h in i))return!1}else{var p=new e;if(c)var x=c(g,y,h,i,l,p);if(!(x===void 0?t(y,g,n|r,c,p):x))return!1}}return!0}return Bv=s,Bv}var zv,YE;function pF(){if(YE)return zv;YE=1;var e=zi();function t(n){return n===n&&!e(n)}return zv=t,zv}var Uv,XE;function Hfe(){if(XE)return Uv;XE=1;var e=pF(),t=El();function n(r){for(var s=t(r),i=s.length;i--;){var l=s[i],a=r[l];s[i]=[l,a,e(a)]}return s}return Uv=n,Uv}var Hv,KE;function gF(){if(KE)return Hv;KE=1;function e(t,n){return function(r){return r==null?!1:r[t]===n&&(n!==void 0||t in Object(r))}}return Hv=e,Hv}var Vv,JE;function Vfe(){if(JE)return Vv;JE=1;var e=Ufe(),t=Hfe(),n=gF();function r(s){var i=t(s);return i.length==1&&i[0][2]?n(i[0][0],i[0][1]):function(l){return l===s||e(l,s,i)}}return Vv=r,Vv}var Wv,ZE;function Ld(){if(ZE)return Wv;ZE=1;var e=qc(),t=Ha(),n="[object Symbol]";function r(s){return typeof s=="symbol"||t(s)&&e(s)==n}return Wv=r,Wv}var Gv,QE;function pj(){if(QE)return Gv;QE=1;var e=zr(),t=Ld(),n=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,r=/^\w*$/;function s(i,l){if(e(i))return!1;var a=typeof i;return a=="number"||a=="symbol"||a=="boolean"||i==null||t(i)?!0:r.test(i)||!n.test(i)||l!=null&&i in Object(l)}return Gv=s,Gv}var Yv,e7;function Wfe(){if(e7)return Yv;e7=1;var e=rj(),t="Expected a function";function n(r,s){if(typeof r!="function"||s!=null&&typeof s!="function")throw new TypeError(t);var i=function(){var l=arguments,a=s?s.apply(this,l):l[0],c=i.cache;if(c.has(a))return c.get(a);var d=r.apply(this,l);return i.cache=c.set(a,d)||c,d};return i.cache=new(n.Cache||e),i}return n.Cache=e,Yv=n,Yv}var Xv,t7;function Gfe(){if(t7)return Xv;t7=1;var e=Wfe(),t=500;function n(r){var s=e(r,function(l){return i.size===t&&i.clear(),l}),i=s.cache;return s}return Xv=n,Xv}var Kv,n7;function Yfe(){if(n7)return Kv;n7=1;var e=Gfe(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,n=/\\(\\)?/g,r=e(function(s){var i=[];return s.charCodeAt(0)===46&&i.push(""),s.replace(t,function(l,a,c,d){i.push(c?d.replace(n,"$1"):a||l)}),i});return Kv=r,Kv}var Jv,r7;function w1(){if(r7)return Jv;r7=1;function e(t,n){for(var r=-1,s=t==null?0:t.length,i=Array(s);++r<s;)i[r]=n(t[r],r,t);return i}return Jv=e,Jv}var Zv,s7;function Xfe(){if(s7)return Zv;s7=1;var e=Pd(),t=w1(),n=zr(),r=Ld(),s=e?e.prototype:void 0,i=s?s.toString:void 0;function l(a){if(typeof a=="string")return a;if(n(a))return t(a,l)+"";if(r(a))return i?i.call(a):"";var c=a+"";return c=="0"&&1/a==-1/0?"-0":c}return Zv=l,Zv}var Qv,i7;function xF(){if(i7)return Qv;i7=1;var e=Xfe();function t(n){return n==null?"":e(n)}return Qv=t,Qv}var eb,a7;function N1(){if(a7)return eb;a7=1;var e=zr(),t=pj(),n=Yfe(),r=xF();function s(i,l){return e(i)?i:t(i,l)?[i]:n(r(i))}return eb=s,eb}var tb,o7;function hm(){if(o7)return tb;o7=1;var e=Ld();function t(n){if(typeof n=="string"||e(n))return n;var r=n+"";return r=="0"&&1/n==-1/0?"-0":r}return tb=t,tb}var nb,l7;function j1(){if(l7)return nb;l7=1;var e=N1(),t=hm();function n(r,s){s=e(s,r);for(var i=0,l=s.length;r!=null&&i<l;)r=r[t(s[i++])];return i&&i==l?r:void 0}return nb=n,nb}var rb,c7;function Kfe(){if(c7)return rb;c7=1;var e=j1();function t(n,r,s){var i=n==null?void 0:e(n,r);return i===void 0?s:i}return rb=t,rb}var sb,u7;function Jfe(){if(u7)return sb;u7=1;function e(t,n){return t!=null&&n in Object(t)}return sb=e,sb}var ib,d7;function yF(){if(d7)return ib;d7=1;var e=N1(),t=dm(),n=zr(),r=g1(),s=ij(),i=hm();function l(a,c,d){c=e(c,a);for(var u=-1,f=c.length,m=!1;++u<f;){var h=i(c[u]);if(!(m=a!=null&&d(a,h)))break;a=a[h]}return m||++u!=f?m:(f=a==null?0:a.length,!!f&&s(f)&&r(h,f)&&(n(a)||t(a)))}return ib=l,ib}var ab,f7;function vF(){if(f7)return ab;f7=1;var e=Jfe(),t=yF();function n(r,s){return r!=null&&t(r,s,e)}return ab=n,ab}var ob,h7;function Zfe(){if(h7)return ob;h7=1;var e=mF(),t=Kfe(),n=vF(),r=pj(),s=pF(),i=gF(),l=hm(),a=1,c=2;function d(u,f){return r(u)&&s(f)?i(l(u),f):function(m){var h=t(m,u);return h===void 0&&h===f?n(m,u):e(f,h,a|c)}}return ob=d,ob}var lb,m7;function bF(){if(m7)return lb;m7=1;function e(t){return function(n){return n==null?void 0:n[t]}}return lb=e,lb}var cb,p7;function Qfe(){if(p7)return cb;p7=1;var e=j1();function t(n){return function(r){return e(r,n)}}return cb=t,cb}var ub,g7;function ehe(){if(g7)return ub;g7=1;var e=bF(),t=Qfe(),n=pj(),r=hm();function s(i){return n(i)?e(r(i)):t(i)}return ub=s,ub}var db,x7;function Po(){if(x7)return db;x7=1;var e=Vfe(),t=Zfe(),n=Uc(),r=zr(),s=ehe();function i(l){return typeof l=="function"?l:l==null?n:typeof l=="object"?r(l)?t(l[0],l[1]):e(l):s(l)}return db=i,db}var fb,y7;function wF(){if(y7)return fb;y7=1;var e=JO(),t=Rfe(),n=Po(),r=zr();function s(i,l){var a=r(i)?e:t;return a(i,n(l,3))}return fb=s,fb}var hb,v7;function the(){if(v7)return hb;v7=1;var e=Object.prototype,t=e.hasOwnProperty;function n(r,s){return r!=null&&t.call(r,s)}return hb=n,hb}var mb,b7;function NF(){if(b7)return mb;b7=1;var e=the(),t=yF();function n(r,s){return r!=null&&t(r,s,e)}return mb=n,mb}var pb,w7;function nhe(){if(w7)return pb;w7=1;var e=oj(),t=Td(),n=dm(),r=zr(),s=Co(),i=Id(),l=y1(),a=fm(),c="[object Map]",d="[object Set]",u=Object.prototype,f=u.hasOwnProperty;function m(h){if(h==null)return!0;if(s(h)&&(r(h)||typeof h=="string"||typeof h.splice=="function"||i(h)||a(h)||n(h)))return!h.length;var g=t(h);if(g==c||g==d)return!h.size;if(l(h))return!e(h).length;for(var y in h)if(f.call(h,y))return!1;return!0}return pb=m,pb}var gb,N7;function jF(){if(N7)return gb;N7=1;function e(t){return t===void 0}return gb=e,gb}var xb,j7;function _F(){if(j7)return xb;j7=1;var e=b1(),t=Co();function n(r,s){var i=-1,l=t(r)?Array(r.length):[];return e(r,function(a,c,d){l[++i]=s(a,c,d)}),l}return xb=n,xb}var yb,_7;function SF(){if(_7)return yb;_7=1;var e=w1(),t=Po(),n=_F(),r=zr();function s(i,l){var a=r(i)?e:n;return a(i,t(l,3))}return yb=s,yb}var vb,S7;function rhe(){if(S7)return vb;S7=1;function e(t,n,r,s){var i=-1,l=t==null?0:t.length;for(s&&l&&(r=t[++i]);++i<l;)r=n(r,t[i],i,t);return r}return vb=e,vb}var bb,A7;function she(){if(A7)return bb;A7=1;function e(t,n,r,s,i){return i(t,function(l,a,c){r=s?(s=!1,l):n(r,l,a,c)}),r}return bb=e,bb}var wb,k7;function AF(){if(k7)return wb;k7=1;var e=rhe(),t=b1(),n=Po(),r=she(),s=zr();function i(l,a,c){var d=s(l)?e:r,u=arguments.length<3;return d(l,n(a,4),c,u,t)}return wb=i,wb}var Nb,E7;function ihe(){if(E7)return Nb;E7=1;var e=qc(),t=zr(),n=Ha(),r="[object String]";function s(i){return typeof i=="string"||!t(i)&&n(i)&&e(i)==r}return Nb=s,Nb}var jb,C7;function ahe(){if(C7)return jb;C7=1;var e=bF(),t=e("length");return jb=t,jb}var _b,P7;function ohe(){if(P7)return _b;P7=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",s=t+n+r,i="\\ufe0e\\ufe0f",l="\\u200d",a=RegExp("["+l+e+s+i+"]");function c(d){return a.test(d)}return _b=c,_b}var Sb,I7;function lhe(){if(I7)return Sb;I7=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",n="\\ufe20-\\ufe2f",r="\\u20d0-\\u20ff",s=t+n+r,i="\\ufe0e\\ufe0f",l="["+e+"]",a="["+s+"]",c="\\ud83c[\\udffb-\\udfff]",d="(?:"+a+"|"+c+")",u="[^"+e+"]",f="(?:\\ud83c[\\udde6-\\uddff]){2}",m="[\\ud800-\\udbff][\\udc00-\\udfff]",h="\\u200d",g=d+"?",y="["+i+"]?",p="(?:"+h+"(?:"+[u,f,m].join("|")+")"+y+g+")*",x=y+g+p,b="(?:"+[u+a+"?",a,f,m,l].join("|")+")",w=RegExp(c+"(?="+c+")|"+b+x,"g");function N(k){for(var I=w.lastIndex=0;w.test(k);)++I;return I}return Sb=N,Sb}var Ab,T7;function che(){if(T7)return Ab;T7=1;var e=ahe(),t=ohe(),n=lhe();function r(s){return t(s)?n(s):e(s)}return Ab=r,Ab}var kb,L7;function uhe(){if(L7)return kb;L7=1;var e=oj(),t=Td(),n=Co(),r=ihe(),s=che(),i="[object Map]",l="[object Set]";function a(c){if(c==null)return 0;if(n(c))return r(c)?s(c):c.length;var d=t(c);return d==i||d==l?c.size:e(c).length}return kb=a,kb}var Eb,M7;function dhe(){if(M7)return Eb;M7=1;var e=sj(),t=iF(),n=hj(),r=Po(),s=v1(),i=zr(),l=Id(),a=cm(),c=zi(),d=fm();function u(f,m,h){var g=i(f),y=g||l(f)||d(f);if(m=r(m,4),h==null){var p=f&&f.constructor;y?h=g?new p:[]:c(f)?h=a(p)?t(s(f)):{}:h={}}return(y?e:n)(f,function(x,b,w){return m(h,x,b,w)}),h}return Eb=u,Eb}var Cb,R7;function fhe(){if(R7)return Cb;R7=1;var e=Pd(),t=dm(),n=zr(),r=e?e.isConcatSpreadable:void 0;function s(i){return n(i)||t(i)||!!(r&&i&&i[r])}return Cb=s,Cb}var Pb,$7;function gj(){if($7)return Pb;$7=1;var e=cj(),t=fhe();function n(r,s,i,l,a){var c=-1,d=r.length;for(i||(i=t),a||(a=[]);++c<d;){var u=r[c];s>0&&i(u)?s>1?n(u,s-1,i,l,a):e(a,u):l||(a[a.length]=u)}return a}return Pb=n,Pb}var Ib,O7;function hhe(){if(O7)return Ib;O7=1;function e(t,n,r){switch(r.length){case 0:return t.call(n);case 1:return t.call(n,r[0]);case 2:return t.call(n,r[0],r[1]);case 3:return t.call(n,r[0],r[1],r[2])}return t.apply(n,r)}return Ib=e,Ib}var Tb,F7;function kF(){if(F7)return Tb;F7=1;var e=hhe(),t=Math.max;function n(r,s,i){return s=t(s===void 0?r.length-1:s,0),function(){for(var l=arguments,a=-1,c=t(l.length-s,0),d=Array(c);++a<c;)d[a]=l[s+a];a=-1;for(var u=Array(s+1);++a<s;)u[a]=l[a];return u[s]=i(d),e(r,this,u)}}return Tb=n,Tb}var Lb,D7;function mhe(){if(D7)return Lb;D7=1;var e=dj(),t=WO(),n=Uc(),r=t?function(s,i){return t(s,"toString",{configurable:!0,enumerable:!1,value:e(i),writable:!0})}:n;return Lb=r,Lb}var Mb,q7;function phe(){if(q7)return Mb;q7=1;var e=800,t=16,n=Date.now;function r(s){var i=0,l=0;return function(){var a=n(),c=t-(a-l);if(l=a,c>0){if(++i>=e)return arguments[0]}else i=0;return s.apply(void 0,arguments)}}return Mb=r,Mb}var Rb,B7;function EF(){if(B7)return Rb;B7=1;var e=mhe(),t=phe(),n=t(e);return Rb=n,Rb}var $b,z7;function _1(){if(z7)return $b;z7=1;var e=Uc(),t=kF(),n=EF();function r(s,i){return n(t(s,i,e),s+"")}return $b=r,$b}var Ob,U7;function CF(){if(U7)return Ob;U7=1;function e(t,n,r,s){for(var i=t.length,l=r+(s?1:-1);s?l--:++l<i;)if(n(t[l],l,t))return l;return-1}return Ob=e,Ob}var Fb,H7;function ghe(){if(H7)return Fb;H7=1;function e(t){return t!==t}return Fb=e,Fb}var Db,V7;function xhe(){if(V7)return Db;V7=1;function e(t,n,r){for(var s=r-1,i=t.length;++s<i;)if(t[s]===n)return s;return-1}return Db=e,Db}var qb,W7;function yhe(){if(W7)return qb;W7=1;var e=CF(),t=ghe(),n=xhe();function r(s,i,l){return i===i?n(s,i,l):e(s,t,l)}return qb=r,qb}var Bb,G7;function vhe(){if(G7)return Bb;G7=1;var e=yhe();function t(n,r){var s=n==null?0:n.length;return!!s&&e(n,r,0)>-1}return Bb=t,Bb}var zb,Y7;function bhe(){if(Y7)return zb;Y7=1;function e(t,n,r){for(var s=-1,i=t==null?0:t.length;++s<i;)if(r(n,t[s]))return!0;return!1}return zb=e,zb}var Ub,X7;function whe(){if(X7)return Ub;X7=1;function e(){}return Ub=e,Ub}var Hb,K7;function Nhe(){if(K7)return Hb;K7=1;var e=nF(),t=whe(),n=mj(),r=1/0,s=e&&1/n(new e([,-0]))[1]==r?function(i){return new e(i)}:t;return Hb=s,Hb}var Vb,J7;function jhe(){if(J7)return Vb;J7=1;var e=dF(),t=vhe(),n=bhe(),r=fF(),s=Nhe(),i=mj(),l=200;function a(c,d,u){var f=-1,m=t,h=c.length,g=!0,y=[],p=y;if(u)g=!1,m=n;else if(h>=l){var x=d?null:s(c);if(x)return i(x);g=!1,m=r,p=new e}else p=d?[]:y;e:for(;++f<h;){var b=c[f],w=d?d(b):b;if(b=u||b!==0?b:0,g&&w===w){for(var N=p.length;N--;)if(p[N]===w)continue e;d&&p.push(w),y.push(b)}else m(p,w,u)||(p!==y&&p.push(w),y.push(b))}return y}return Vb=a,Vb}var Wb,Z7;function PF(){if(Z7)return Wb;Z7=1;var e=Co(),t=Ha();function n(r){return t(r)&&e(r)}return Wb=n,Wb}var Gb,Q7;function _he(){if(Q7)return Gb;Q7=1;var e=gj(),t=_1(),n=jhe(),r=PF(),s=t(function(i){return n(e(i,1,r,!0))});return Gb=s,Gb}var Yb,eC;function She(){if(eC)return Yb;eC=1;var e=w1();function t(n,r){return e(r,function(s){return n[s]})}return Yb=t,Yb}var Xb,tC;function IF(){if(tC)return Xb;tC=1;var e=She(),t=El();function n(r){return r==null?[]:e(r,t(r))}return Xb=n,Xb}var Kb,nC;function Ui(){if(nC)return Kb;nC=1;var e;if(typeof tj=="function")try{e={clone:Tfe(),constant:dj(),each:uF(),filter:wF(),has:NF(),isArray:zr(),isEmpty:nhe(),isFunction:cm(),isUndefined:jF(),keys:El(),map:SF(),reduce:AF(),size:uhe(),transform:dhe(),union:_he(),values:IF()}}catch{}return e||(e=window._),Kb=e,Kb}var Jb,rC;function xj(){if(rC)return Jb;rC=1;var e=Ui();Jb=s;var t="\0",n="\0",r="";function s(u){this._isDirected=e.has(u,"directed")?u.directed:!0,this._isMultigraph=e.has(u,"multigraph")?u.multigraph:!1,this._isCompound=e.has(u,"compound")?u.compound:!1,this._label=void 0,this._defaultNodeLabelFn=e.constant(void 0),this._defaultEdgeLabelFn=e.constant(void 0),this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children[n]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}s.prototype._nodeCount=0,s.prototype._edgeCount=0,s.prototype.isDirected=function(){return this._isDirected},s.prototype.isMultigraph=function(){return this._isMultigraph},s.prototype.isCompound=function(){return this._isCompound},s.prototype.setGraph=function(u){return this._label=u,this},s.prototype.graph=function(){return this._label},s.prototype.setDefaultNodeLabel=function(u){return e.isFunction(u)||(u=e.constant(u)),this._defaultNodeLabelFn=u,this},s.prototype.nodeCount=function(){return this._nodeCount},s.prototype.nodes=function(){return e.keys(this._nodes)},s.prototype.sources=function(){var u=this;return e.filter(this.nodes(),function(f){return e.isEmpty(u._in[f])})},s.prototype.sinks=function(){var u=this;return e.filter(this.nodes(),function(f){return e.isEmpty(u._out[f])})},s.prototype.setNodes=function(u,f){var m=arguments,h=this;return e.each(u,function(g){m.length>1?h.setNode(g,f):h.setNode(g)}),this},s.prototype.setNode=function(u,f){return e.has(this._nodes,u)?(arguments.length>1&&(this._nodes[u]=f),this):(this._nodes[u]=arguments.length>1?f:this._defaultNodeLabelFn(u),this._isCompound&&(this._parent[u]=n,this._children[u]={},this._children[n][u]=!0),this._in[u]={},this._preds[u]={},this._out[u]={},this._sucs[u]={},++this._nodeCount,this)},s.prototype.node=function(u){return this._nodes[u]},s.prototype.hasNode=function(u){return e.has(this._nodes,u)},s.prototype.removeNode=function(u){var f=this;if(e.has(this._nodes,u)){var m=function(h){f.removeEdge(f._edgeObjs[h])};delete this._nodes[u],this._isCompound&&(this._removeFromParentsChildList(u),delete this._parent[u],e.each(this.children(u),function(h){f.setParent(h)}),delete this._children[u]),e.each(e.keys(this._in[u]),m),delete this._in[u],delete this._preds[u],e.each(e.keys(this._out[u]),m),delete this._out[u],delete this._sucs[u],--this._nodeCount}return this},s.prototype.setParent=function(u,f){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(e.isUndefined(f))f=n;else{f+="";for(var m=f;!e.isUndefined(m);m=this.parent(m))if(m===u)throw new Error("Setting "+f+" as parent of "+u+" would create a cycle");this.setNode(f)}return this.setNode(u),this._removeFromParentsChildList(u),this._parent[u]=f,this._children[f][u]=!0,this},s.prototype._removeFromParentsChildList=function(u){delete this._children[this._parent[u]][u]},s.prototype.parent=function(u){if(this._isCompound){var f=this._parent[u];if(f!==n)return f}},s.prototype.children=function(u){if(e.isUndefined(u)&&(u=n),this._isCompound){var f=this._children[u];if(f)return e.keys(f)}else{if(u===n)return this.nodes();if(this.hasNode(u))return[]}},s.prototype.predecessors=function(u){var f=this._preds[u];if(f)return e.keys(f)},s.prototype.successors=function(u){var f=this._sucs[u];if(f)return e.keys(f)},s.prototype.neighbors=function(u){var f=this.predecessors(u);if(f)return e.union(f,this.successors(u))},s.prototype.isLeaf=function(u){var f;return this.isDirected()?f=this.successors(u):f=this.neighbors(u),f.length===0},s.prototype.filterNodes=function(u){var f=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});f.setGraph(this.graph());var m=this;e.each(this._nodes,function(y,p){u(p)&&f.setNode(p,y)}),e.each(this._edgeObjs,function(y){f.hasNode(y.v)&&f.hasNode(y.w)&&f.setEdge(y,m.edge(y))});var h={};function g(y){var p=m.parent(y);return p===void 0||f.hasNode(p)?(h[y]=p,p):p in h?h[p]:g(p)}return this._isCompound&&e.each(f.nodes(),function(y){f.setParent(y,g(y))}),f},s.prototype.setDefaultEdgeLabel=function(u){return e.isFunction(u)||(u=e.constant(u)),this._defaultEdgeLabelFn=u,this},s.prototype.edgeCount=function(){return this._edgeCount},s.prototype.edges=function(){return e.values(this._edgeObjs)},s.prototype.setPath=function(u,f){var m=this,h=arguments;return e.reduce(u,function(g,y){return h.length>1?m.setEdge(g,y,f):m.setEdge(g,y),y}),this},s.prototype.setEdge=function(){var u,f,m,h,g=!1,y=arguments[0];typeof y=="object"&&y!==null&&"v"in y?(u=y.v,f=y.w,m=y.name,arguments.length===2&&(h=arguments[1],g=!0)):(u=y,f=arguments[1],m=arguments[3],arguments.length>2&&(h=arguments[2],g=!0)),u=""+u,f=""+f,e.isUndefined(m)||(m=""+m);var p=a(this._isDirected,u,f,m);if(e.has(this._edgeLabels,p))return g&&(this._edgeLabels[p]=h),this;if(!e.isUndefined(m)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(u),this.setNode(f),this._edgeLabels[p]=g?h:this._defaultEdgeLabelFn(u,f,m);var x=c(this._isDirected,u,f,m);return u=x.v,f=x.w,Object.freeze(x),this._edgeObjs[p]=x,i(this._preds[f],u),i(this._sucs[u],f),this._in[f][p]=x,this._out[u][p]=x,this._edgeCount++,this},s.prototype.edge=function(u,f,m){var h=arguments.length===1?d(this._isDirected,arguments[0]):a(this._isDirected,u,f,m);return this._edgeLabels[h]},s.prototype.hasEdge=function(u,f,m){var h=arguments.length===1?d(this._isDirected,arguments[0]):a(this._isDirected,u,f,m);return e.has(this._edgeLabels,h)},s.prototype.removeEdge=function(u,f,m){var h=arguments.length===1?d(this._isDirected,arguments[0]):a(this._isDirected,u,f,m),g=this._edgeObjs[h];return g&&(u=g.v,f=g.w,delete this._edgeLabels[h],delete this._edgeObjs[h],l(this._preds[f],u),l(this._sucs[u],f),delete this._in[f][h],delete this._out[u][h],this._edgeCount--),this},s.prototype.inEdges=function(u,f){var m=this._in[u];if(m){var h=e.values(m);return f?e.filter(h,function(g){return g.v===f}):h}},s.prototype.outEdges=function(u,f){var m=this._out[u];if(m){var h=e.values(m);return f?e.filter(h,function(g){return g.w===f}):h}},s.prototype.nodeEdges=function(u,f){var m=this.inEdges(u,f);if(m)return m.concat(this.outEdges(u,f))};function i(u,f){u[f]?u[f]++:u[f]=1}function l(u,f){--u[f]||delete u[f]}function a(u,f,m,h){var g=""+f,y=""+m;if(!u&&g>y){var p=g;g=y,y=p}return g+r+y+r+(e.isUndefined(h)?t:h)}function c(u,f,m,h){var g=""+f,y=""+m;if(!u&&g>y){var p=g;g=y,y=p}var x={v:g,w:y};return h&&(x.name=h),x}function d(u,f){return a(u,f.v,f.w,f.name)}return Jb}var Zb,sC;function Ahe(){return sC||(sC=1,Zb="2.1.8"),Zb}var Qb,iC;function khe(){return iC||(iC=1,Qb={Graph:xj(),version:Ahe()}),Qb}var ew,aC;function Ehe(){if(aC)return ew;aC=1;var e=Ui(),t=xj();ew={write:n,read:i};function n(l){var a={options:{directed:l.isDirected(),multigraph:l.isMultigraph(),compound:l.isCompound()},nodes:r(l),edges:s(l)};return e.isUndefined(l.graph())||(a.value=e.clone(l.graph())),a}function r(l){return e.map(l.nodes(),function(a){var c=l.node(a),d=l.parent(a),u={v:a};return e.isUndefined(c)||(u.value=c),e.isUndefined(d)||(u.parent=d),u})}function s(l){return e.map(l.edges(),function(a){var c=l.edge(a),d={v:a.v,w:a.w};return e.isUndefined(a.name)||(d.name=a.name),e.isUndefined(c)||(d.value=c),d})}function i(l){var a=new t(l.options).setGraph(l.value);return e.each(l.nodes,function(c){a.setNode(c.v,c.value),c.parent&&a.setParent(c.v,c.parent)}),e.each(l.edges,function(c){a.setEdge({v:c.v,w:c.w,name:c.name},c.value)}),a}return ew}var tw,oC;function Che(){if(oC)return tw;oC=1;var e=Ui();tw=t;function t(n){var r={},s=[],i;function l(a){e.has(r,a)||(r[a]=!0,i.push(a),e.each(n.successors(a),l),e.each(n.predecessors(a),l))}return e.each(n.nodes(),function(a){i=[],l(a),i.length&&s.push(i)}),s}return tw}var nw,lC;function TF(){if(lC)return nw;lC=1;var e=Ui();nw=t;function t(){this._arr=[],this._keyIndices={}}return t.prototype.size=function(){return this._arr.length},t.prototype.keys=function(){return this._arr.map(function(n){return n.key})},t.prototype.has=function(n){return e.has(this._keyIndices,n)},t.prototype.priority=function(n){var r=this._keyIndices[n];if(r!==void 0)return this._arr[r].priority},t.prototype.min=function(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key},t.prototype.add=function(n,r){var s=this._keyIndices;if(n=String(n),!e.has(s,n)){var i=this._arr,l=i.length;return s[n]=l,i.push({key:n,priority:r}),this._decrease(l),!0}return!1},t.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var n=this._arr.pop();return delete this._keyIndices[n.key],this._heapify(0),n.key},t.prototype.decrease=function(n,r){var s=this._keyIndices[n];if(r>this._arr[s].priority)throw new Error("New priority is greater than current priority. Key: "+n+" Old: "+this._arr[s].priority+" New: "+r);this._arr[s].priority=r,this._decrease(s)},t.prototype._heapify=function(n){var r=this._arr,s=2*n,i=s+1,l=n;s<r.length&&(l=r[s].priority<r[l].priority?s:l,i<r.length&&(l=r[i].priority<r[l].priority?i:l),l!==n&&(this._swap(n,l),this._heapify(l)))},t.prototype._decrease=function(n){for(var r=this._arr,s=r[n].priority,i;n!==0&&(i=n>>1,!(r[i].priority<s));)this._swap(n,i),n=i},t.prototype._swap=function(n,r){var s=this._arr,i=this._keyIndices,l=s[n],a=s[r];s[n]=a,s[r]=l,i[a.key]=n,i[l.key]=r},nw}var rw,cC;function LF(){if(cC)return rw;cC=1;var e=Ui(),t=TF();rw=r;var n=e.constant(1);function r(i,l,a,c){return s(i,String(l),a||n,c||function(d){return i.outEdges(d)})}function s(i,l,a,c){var d={},u=new t,f,m,h=function(g){var y=g.v!==f?g.v:g.w,p=d[y],x=a(g),b=m.distance+x;if(x<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+g+" Weight: "+x);b<p.distance&&(p.distance=b,p.predecessor=f,u.decrease(y,b))};for(i.nodes().forEach(function(g){var y=g===l?0:Number.POSITIVE_INFINITY;d[g]={distance:y},u.add(g,y)});u.size()>0&&(f=u.removeMin(),m=d[f],m.distance!==Number.POSITIVE_INFINITY);)c(f).forEach(h);return d}return rw}var sw,uC;function Phe(){if(uC)return sw;uC=1;var e=LF(),t=Ui();sw=n;function n(r,s,i){return t.transform(r.nodes(),function(l,a){l[a]=e(r,a,s,i)},{})}return sw}var iw,dC;function MF(){if(dC)return iw;dC=1;var e=Ui();iw=t;function t(n){var r=0,s=[],i={},l=[];function a(c){var d=i[c]={onStack:!0,lowlink:r,index:r++};if(s.push(c),n.successors(c).forEach(function(m){e.has(i,m)?i[m].onStack&&(d.lowlink=Math.min(d.lowlink,i[m].index)):(a(m),d.lowlink=Math.min(d.lowlink,i[m].lowlink))}),d.lowlink===d.index){var u=[],f;do f=s.pop(),i[f].onStack=!1,u.push(f);while(c!==f);l.push(u)}}return n.nodes().forEach(function(c){e.has(i,c)||a(c)}),l}return iw}var aw,fC;function Ihe(){if(fC)return aw;fC=1;var e=Ui(),t=MF();aw=n;function n(r){return e.filter(t(r),function(s){return s.length>1||s.length===1&&r.hasEdge(s[0],s[0])})}return aw}var ow,hC;function The(){if(hC)return ow;hC=1;var e=Ui();ow=n;var t=e.constant(1);function n(s,i,l){return r(s,i||t,l||function(a){return s.outEdges(a)})}function r(s,i,l){var a={},c=s.nodes();return c.forEach(function(d){a[d]={},a[d][d]={distance:0},c.forEach(function(u){d!==u&&(a[d][u]={distance:Number.POSITIVE_INFINITY})}),l(d).forEach(function(u){var f=u.v===d?u.w:u.v,m=i(u);a[d][f]={distance:m,predecessor:d}})}),c.forEach(function(d){var u=a[d];c.forEach(function(f){var m=a[f];c.forEach(function(h){var g=m[d],y=u[h],p=m[h],x=g.distance+y.distance;x<p.distance&&(p.distance=x,p.predecessor=y.predecessor)})})}),a}return ow}var lw,mC;function RF(){if(mC)return lw;mC=1;var e=Ui();lw=t,t.CycleException=n;function t(r){var s={},i={},l=[];function a(c){if(e.has(i,c))throw new n;e.has(s,c)||(i[c]=!0,s[c]=!0,e.each(r.predecessors(c),a),delete i[c],l.push(c))}if(e.each(r.sinks(),a),e.size(s)!==r.nodeCount())throw new n;return l}function n(){}return n.prototype=new Error,lw}var cw,pC;function Lhe(){if(pC)return cw;pC=1;var e=RF();cw=t;function t(n){try{e(n)}catch(r){if(r instanceof e.CycleException)return!1;throw r}return!0}return cw}var uw,gC;function $F(){if(gC)return uw;gC=1;var e=Ui();uw=t;function t(r,s,i){e.isArray(s)||(s=[s]);var l=(r.isDirected()?r.successors:r.neighbors).bind(r),a=[],c={};return e.each(s,function(d){if(!r.hasNode(d))throw new Error("Graph does not have node: "+d);n(r,d,i==="post",c,l,a)}),a}function n(r,s,i,l,a,c){e.has(l,s)||(l[s]=!0,i||c.push(s),e.each(a(s),function(d){n(r,d,i,l,a,c)}),i&&c.push(s))}return uw}var dw,xC;function Mhe(){if(xC)return dw;xC=1;var e=$F();dw=t;function t(n,r){return e(n,r,"post")}return dw}var fw,yC;function Rhe(){if(yC)return fw;yC=1;var e=$F();fw=t;function t(n,r){return e(n,r,"pre")}return fw}var hw,vC;function $he(){if(vC)return hw;vC=1;var e=Ui(),t=xj(),n=TF();hw=r;function r(s,i){var l=new t,a={},c=new n,d;function u(m){var h=m.v===d?m.w:m.v,g=c.priority(h);if(g!==void 0){var y=i(m);y<g&&(a[h]=d,c.decrease(h,y))}}if(s.nodeCount()===0)return l;e.each(s.nodes(),function(m){c.add(m,Number.POSITIVE_INFINITY),l.setNode(m)}),c.decrease(s.nodes()[0],0);for(var f=!1;c.size()>0;){if(d=c.removeMin(),e.has(a,d))l.setEdge(d,a[d]);else{if(f)throw new Error("Input graph is not connected: "+s);f=!0}s.nodeEdges(d).forEach(u)}return l}return hw}var mw,bC;function Ohe(){return bC||(bC=1,mw={components:Che(),dijkstra:LF(),dijkstraAll:Phe(),findCycles:Ihe(),floydWarshall:The(),isAcyclic:Lhe(),postorder:Mhe(),preorder:Rhe(),prim:$he(),tarjan:MF(),topsort:RF()}),mw}var pw,wC;function Fhe(){if(wC)return pw;wC=1;var e=khe();return pw={Graph:e.Graph,json:Ehe(),alg:Ohe(),version:e.version},pw}var Zg;if(typeof tj=="function")try{Zg=Fhe()}catch{}Zg||(Zg=window.graphlib);var ha=Zg,gw,NC;function Dhe(){if(NC)return gw;NC=1;var e=oF(),t=1,n=4;function r(s){return e(s,t|n)}return gw=r,gw}var xw,jC;function S1(){if(jC)return xw;jC=1;var e=Cd(),t=Co(),n=g1(),r=zi();function s(i,l,a){if(!r(a))return!1;var c=typeof l;return(c=="number"?t(a)&&n(l,a.length):c=="string"&&l in a)?e(a[l],i):!1}return xw=s,xw}var yw,_C;function qhe(){if(_C)return yw;_C=1;var e=_1(),t=Cd(),n=S1(),r=zc(),s=Object.prototype,i=s.hasOwnProperty,l=e(function(a,c){a=Object(a);var d=-1,u=c.length,f=u>2?c[2]:void 0;for(f&&n(c[0],c[1],f)&&(u=1);++d<u;)for(var m=c[d],h=r(m),g=-1,y=h.length;++g<y;){var p=h[g],x=a[p];(x===void 0||t(x,s[p])&&!i.call(a,p))&&(a[p]=m[p])}return a});return yw=l,yw}var vw,SC;function Bhe(){if(SC)return vw;SC=1;var e=Po(),t=Co(),n=El();function r(s){return function(i,l,a){var c=Object(i);if(!t(i)){var d=e(l,3);i=n(i),l=function(f){return d(c[f],f,c)}}var u=s(i,l,a);return u>-1?c[d?i[u]:u]:void 0}}return vw=r,vw}var bw,AC;function zhe(){if(AC)return bw;AC=1;var e=/\s/;function t(n){for(var r=n.length;r--&&e.test(n.charAt(r)););return r}return bw=t,bw}var ww,kC;function Uhe(){if(kC)return ww;kC=1;var e=zhe(),t=/^\s+/;function n(r){return r&&r.slice(0,e(r)+1).replace(t,"")}return ww=n,ww}var Nw,EC;function Hhe(){if(EC)return Nw;EC=1;var e=Uhe(),t=zi(),n=Ld(),r=NaN,s=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,l=/^0o[0-7]+$/i,a=parseInt;function c(d){if(typeof d=="number")return d;if(n(d))return r;if(t(d)){var u=typeof d.valueOf=="function"?d.valueOf():d;d=t(u)?u+"":u}if(typeof d!="string")return d===0?d:+d;d=e(d);var f=i.test(d);return f||l.test(d)?a(d.slice(2),f?2:8):s.test(d)?r:+d}return Nw=c,Nw}var jw,CC;function OF(){if(CC)return jw;CC=1;var e=Hhe(),t=1/0,n=17976931348623157e292;function r(s){if(!s)return s===0?s:0;if(s=e(s),s===t||s===-t){var i=s<0?-1:1;return i*n}return s===s?s:0}return jw=r,jw}var _w,PC;function Vhe(){if(PC)return _w;PC=1;var e=OF();function t(n){var r=e(n),s=r%1;return r===r?s?r-s:r:0}return _w=t,_w}var Sw,IC;function Whe(){if(IC)return Sw;IC=1;var e=CF(),t=Po(),n=Vhe(),r=Math.max;function s(i,l,a){var c=i==null?0:i.length;if(!c)return-1;var d=a==null?0:n(a);return d<0&&(d=r(c+d,0)),e(i,t(l,3),d)}return Sw=s,Sw}var Aw,TC;function Ghe(){if(TC)return Aw;TC=1;var e=Bhe(),t=Whe(),n=e(t);return Aw=n,Aw}var kw,LC;function FF(){if(LC)return kw;LC=1;var e=gj();function t(n){var r=n==null?0:n.length;return r?e(n,1):[]}return kw=t,kw}var Ew,MC;function Yhe(){if(MC)return Ew;MC=1;var e=fj(),t=lF(),n=zc();function r(s,i){return s==null?s:e(s,t(i),n)}return Ew=r,Ew}var Cw,RC;function Xhe(){if(RC)return Cw;RC=1;function e(t){var n=t==null?0:t.length;return n?t[n-1]:void 0}return Cw=e,Cw}var Pw,$C;function Khe(){if($C)return Pw;$C=1;var e=m1(),t=hj(),n=Po();function r(s,i){var l={};return i=n(i,3),t(s,function(a,c,d){e(l,c,i(a,c,d))}),l}return Pw=r,Pw}var Iw,OC;function yj(){if(OC)return Iw;OC=1;var e=Ld();function t(n,r,s){for(var i=-1,l=n.length;++i<l;){var a=n[i],c=r(a);if(c!=null&&(d===void 0?c===c&&!e(c):s(c,d)))var d=c,u=a}return u}return Iw=t,Iw}var Tw,FC;function Jhe(){if(FC)return Tw;FC=1;function e(t,n){return t>n}return Tw=e,Tw}var Lw,DC;function Zhe(){if(DC)return Lw;DC=1;var e=yj(),t=Jhe(),n=Uc();function r(s){return s&&s.length?e(s,n,t):void 0}return Lw=r,Lw}var Mw,qC;function DF(){if(qC)return Mw;qC=1;var e=m1(),t=Cd();function n(r,s,i){(i!==void 0&&!t(r[s],i)||i===void 0&&!(s in r))&&e(r,s,i)}return Mw=n,Mw}var Rw,BC;function Qhe(){if(BC)return Rw;BC=1;var e=qc(),t=v1(),n=Ha(),r="[object Object]",s=Function.prototype,i=Object.prototype,l=s.toString,a=i.hasOwnProperty,c=l.call(Object);function d(u){if(!n(u)||e(u)!=r)return!1;var f=t(u);if(f===null)return!0;var m=a.call(f,"constructor")&&f.constructor;return typeof m=="function"&&m instanceof m&&l.call(m)==c}return Rw=d,Rw}var $w,zC;function qF(){if(zC)return $w;zC=1;function e(t,n){if(!(n==="constructor"&&typeof t[n]=="function")&&n!="__proto__")return t[n]}return $w=e,$w}var Ow,UC;function eme(){if(UC)return Ow;UC=1;var e=um(),t=zc();function n(r){return e(r,t(r))}return Ow=n,Ow}var Fw,HC;function tme(){if(HC)return Fw;HC=1;var e=DF(),t=XO(),n=sF(),r=KO(),s=aF(),i=dm(),l=zr(),a=PF(),c=Id(),d=cm(),u=zi(),f=Qhe(),m=fm(),h=qF(),g=eme();function y(p,x,b,w,N,k,I){var R=h(p,b),T=h(x,b),S=I.get(T);if(S){e(p,b,S);return}var E=k?k(R,T,b+"",p,x,I):void 0,_=E===void 0;if(_){var M=l(T),A=!M&&c(T),P=!M&&!A&&m(T);E=T,M||A||P?l(R)?E=R:a(R)?E=r(R):A?(_=!1,E=t(T,!0)):P?(_=!1,E=n(T,!0)):E=[]:f(T)||i(T)?(E=R,i(R)?E=g(R):(!u(R)||d(R))&&(E=s(T))):_=!1}_&&(I.set(T,E),N(E,T,w,k,I),I.delete(T)),e(p,b,E)}return Fw=y,Fw}var Dw,VC;function nme(){if(VC)return Dw;VC=1;var e=h1(),t=DF(),n=fj(),r=tme(),s=zi(),i=zc(),l=qF();function a(c,d,u,f,m){c!==d&&n(d,function(h,g){if(m||(m=new e),s(h))r(c,d,g,u,a,f,m);else{var y=f?f(l(c,g),h,g+"",c,d,m):void 0;y===void 0&&(y=h),t(c,g,y)}},i)}return Dw=a,Dw}var qw,WC;function rme(){if(WC)return qw;WC=1;var e=_1(),t=S1();function n(r){return e(function(s,i){var l=-1,a=i.length,c=a>1?i[a-1]:void 0,d=a>2?i[2]:void 0;for(c=r.length>3&&typeof c=="function"?(a--,c):void 0,d&&t(i[0],i[1],d)&&(c=a<3?void 0:c,a=1),s=Object(s);++l<a;){var u=i[l];u&&r(s,u,l,c)}return s})}return qw=n,qw}var Bw,GC;function sme(){if(GC)return Bw;GC=1;var e=nme(),t=rme(),n=t(function(r,s,i){e(r,s,i)});return Bw=n,Bw}var zw,YC;function BF(){if(YC)return zw;YC=1;function e(t,n){return t<n}return zw=e,zw}var Uw,XC;function ime(){if(XC)return Uw;XC=1;var e=yj(),t=BF(),n=Uc();function r(s){return s&&s.length?e(s,n,t):void 0}return Uw=r,Uw}var Hw,KC;function ame(){if(KC)return Hw;KC=1;var e=yj(),t=Po(),n=BF();function r(s,i){return s&&s.length?e(s,t(i,2),n):void 0}return Hw=r,Hw}var Vw,JC;function ome(){if(JC)return Vw;JC=1;var e=fa(),t=function(){return e.Date.now()};return Vw=t,Vw}var Ww,ZC;function lme(){if(ZC)return Ww;ZC=1;var e=p1(),t=N1(),n=g1(),r=zi(),s=hm();function i(l,a,c,d){if(!r(l))return l;a=t(a,l);for(var u=-1,f=a.length,m=f-1,h=l;h!=null&&++u<f;){var g=s(a[u]),y=c;if(g==="__proto__"||g==="constructor"||g==="prototype")return l;if(u!=m){var p=h[g];y=d?d(p,g,h):void 0,y===void 0&&(y=r(p)?p:n(a[u+1])?[]:{})}e(h,g,y),h=h[g]}return l}return Ww=i,Ww}var Gw,QC;function cme(){if(QC)return Gw;QC=1;var e=j1(),t=lme(),n=N1();function r(s,i,l){for(var a=-1,c=i.length,d={};++a<c;){var u=i[a],f=e(s,u);l(f,u)&&t(d,n(u,s),f)}return d}return Gw=r,Gw}var Yw,eP;function ume(){if(eP)return Yw;eP=1;var e=cme(),t=vF();function n(r,s){return e(r,s,function(i,l){return t(r,l)})}return Yw=n,Yw}var Xw,tP;function dme(){if(tP)return Xw;tP=1;var e=FF(),t=kF(),n=EF();function r(s){return n(t(s,void 0,e),s+"")}return Xw=r,Xw}var Kw,nP;function fme(){if(nP)return Kw;nP=1;var e=ume(),t=dme(),n=t(function(r,s){return r==null?{}:e(r,s)});return Kw=n,Kw}var Jw,rP;function hme(){if(rP)return Jw;rP=1;var e=Math.ceil,t=Math.max;function n(r,s,i,l){for(var a=-1,c=t(e((s-r)/(i||1)),0),d=Array(c);c--;)d[l?c:++a]=r,r+=i;return d}return Jw=n,Jw}var Zw,sP;function mme(){if(sP)return Zw;sP=1;var e=hme(),t=S1(),n=OF();function r(s){return function(i,l,a){return a&&typeof a!="number"&&t(i,l,a)&&(l=a=void 0),i=n(i),l===void 0?(l=i,i=0):l=n(l),a=a===void 0?i<l?1:-1:n(a),e(i,l,a,s)}}return Zw=r,Zw}var Qw,iP;function pme(){if(iP)return Qw;iP=1;var e=mme(),t=e();return Qw=t,Qw}var e5,aP;function gme(){if(aP)return e5;aP=1;function e(t,n){var r=t.length;for(t.sort(n);r--;)t[r]=t[r].value;return t}return e5=e,e5}var t5,oP;function xme(){if(oP)return t5;oP=1;var e=Ld();function t(n,r){if(n!==r){var s=n!==void 0,i=n===null,l=n===n,a=e(n),c=r!==void 0,d=r===null,u=r===r,f=e(r);if(!d&&!f&&!a&&n>r||a&&c&&u&&!d&&!f||i&&c&&u||!s&&u||!l)return 1;if(!i&&!a&&!f&&n<r||f&&s&&l&&!i&&!a||d&&s&&l||!c&&l||!u)return-1}return 0}return t5=t,t5}var n5,lP;function yme(){if(lP)return n5;lP=1;var e=xme();function t(n,r,s){for(var i=-1,l=n.criteria,a=r.criteria,c=l.length,d=s.length;++i<c;){var u=e(l[i],a[i]);if(u){if(i>=d)return u;var f=s[i];return u*(f=="desc"?-1:1)}}return n.index-r.index}return n5=t,n5}var r5,cP;function vme(){if(cP)return r5;cP=1;var e=w1(),t=j1(),n=Po(),r=_F(),s=gme(),i=x1(),l=yme(),a=Uc(),c=zr();function d(u,f,m){f.length?f=e(f,function(y){return c(y)?function(p){return t(p,y.length===1?y[0]:y)}:y}):f=[a];var h=-1;f=e(f,i(n));var g=r(u,function(y,p,x){var b=e(f,function(w){return w(y)});return{criteria:b,index:++h,value:y}});return s(g,function(y,p){return l(y,p,m)})}return r5=d,r5}var s5,uP;function bme(){if(uP)return s5;uP=1;var e=gj(),t=vme(),n=_1(),r=S1(),s=n(function(i,l){if(i==null)return[];var a=l.length;return a>1&&r(i,l[0],l[1])?l=[]:a>2&&r(l[0],l[1],l[2])&&(l=[l[0]]),t(i,e(l,1),[])});return s5=s,s5}var i5,dP;function wme(){if(dP)return i5;dP=1;var e=xF(),t=0;function n(r){var s=++t;return e(r)+s}return i5=n,i5}var a5,fP;function Nme(){if(fP)return a5;fP=1;function e(t,n,r){for(var s=-1,i=t.length,l=n.length,a={};++s<i;){var c=s<l?n[s]:void 0;r(a,t[s],c)}return a}return a5=e,a5}var o5,hP;function jme(){if(hP)return o5;hP=1;var e=p1(),t=Nme();function n(r,s){return t(r||[],s||[],e)}return o5=n,o5}var Qg;if(typeof tj=="function")try{Qg={cloneDeep:Dhe(),constant:dj(),defaults:qhe(),each:uF(),filter:wF(),find:Ghe(),flatten:FF(),forEach:cF(),forIn:Yhe(),has:NF(),isUndefined:jF(),last:Xhe(),map:SF(),mapValues:Khe(),max:Zhe(),merge:sme(),min:ime(),minBy:ame(),now:ome(),pick:fme(),range:pme(),reduce:AF(),sortBy:bme(),uniqueId:wme(),values:IF(),zipObject:jme()}}catch{}Qg||(Qg=window._);var lr=Qg,_me=A1;function A1(){var e={};e._next=e._prev=e,this._sentinel=e}A1.prototype.dequeue=function(){var e=this._sentinel,t=e._prev;if(t!==e)return zF(t),t};A1.prototype.enqueue=function(e){var t=this._sentinel;e._prev&&e._next&&zF(e),e._next=t._next,t._next._prev=e,t._next=e,e._prev=t};A1.prototype.toString=function(){for(var e=[],t=this._sentinel,n=t._prev;n!==t;)e.push(JSON.stringify(n,Sme)),n=n._prev;return"["+e.join(", ")+"]"};function zF(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function Sme(e,t){if(e!=="_next"&&e!=="_prev")return t}var vo=lr,Ame=ha.Graph,kme=_me,Eme=Pme,Cme=vo.constant(1);function Pme(e,t){if(e.nodeCount()<=1)return[];var n=Tme(e,t||Cme),r=Ime(n.graph,n.buckets,n.zeroIdx);return vo.flatten(vo.map(r,function(s){return e.outEdges(s.v,s.w)}),!0)}function Ime(e,t,n){for(var r=[],s=t[t.length-1],i=t[0],l;e.nodeCount();){for(;l=i.dequeue();)l5(e,t,n,l);for(;l=s.dequeue();)l5(e,t,n,l);if(e.nodeCount()){for(var a=t.length-2;a>0;--a)if(l=t[a].dequeue(),l){r=r.concat(l5(e,t,n,l,!0));break}}}return r}function l5(e,t,n,r,s){var i=s?[]:void 0;return vo.forEach(e.inEdges(r.v),function(l){var a=e.edge(l),c=e.node(l.v);s&&i.push({v:l.v,w:l.w}),c.out-=a,YN(t,n,c)}),vo.forEach(e.outEdges(r.v),function(l){var a=e.edge(l),c=l.w,d=e.node(c);d.in-=a,YN(t,n,d)}),e.removeNode(r.v),i}function Tme(e,t){var n=new Ame,r=0,s=0;vo.forEach(e.nodes(),function(a){n.setNode(a,{v:a,in:0,out:0})}),vo.forEach(e.edges(),function(a){var c=n.edge(a.v,a.w)||0,d=t(a),u=c+d;n.setEdge(a.v,a.w,u),s=Math.max(s,n.node(a.v).out+=d),r=Math.max(r,n.node(a.w).in+=d)});var i=vo.range(s+r+3).map(function(){return new kme}),l=r+1;return vo.forEach(n.nodes(),function(a){YN(i,l,n.node(a))}),{graph:n,buckets:i,zeroIdx:l}}function YN(e,t,n){n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)}var uc=lr,Lme=Eme,Mme={run:Rme,undo:Ome};function Rme(e){var t=e.graph().acyclicer==="greedy"?Lme(e,n(e)):$me(e);uc.forEach(t,function(r){var s=e.edge(r);e.removeEdge(r),s.forwardName=r.name,s.reversed=!0,e.setEdge(r.w,r.v,s,uc.uniqueId("rev"))});function n(r){return function(s){return r.edge(s).weight}}}function $me(e){var t=[],n={},r={};function s(i){uc.has(r,i)||(r[i]=!0,n[i]=!0,uc.forEach(e.outEdges(i),function(l){uc.has(n,l.w)?t.push(l):s(l.w)}),delete n[i])}return uc.forEach(e.nodes(),s),t}function Ome(e){uc.forEach(e.edges(),function(t){var n=e.edge(t);if(n.reversed){e.removeEdge(t);var r=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,r)}})}var On=lr,UF=ha.Graph,ti={addDummyNode:HF,simplify:Fme,asNonCompoundGraph:Dme,successorWeights:qme,predecessorWeights:Bme,intersectRect:zme,buildLayerMatrix:Ume,normalizeRanks:Hme,removeEmptyRanks:Vme,addBorderNode:Wme,maxRank:VF,partition:Gme,time:Yme,notime:Xme};function HF(e,t,n,r){var s;do s=On.uniqueId(r);while(e.hasNode(s));return n.dummy=t,e.setNode(s,n),s}function Fme(e){var t=new UF().setGraph(e.graph());return On.forEach(e.nodes(),function(n){t.setNode(n,e.node(n))}),On.forEach(e.edges(),function(n){var r=t.edge(n.v,n.w)||{weight:0,minlen:1},s=e.edge(n);t.setEdge(n.v,n.w,{weight:r.weight+s.weight,minlen:Math.max(r.minlen,s.minlen)})}),t}function Dme(e){var t=new UF({multigraph:e.isMultigraph()}).setGraph(e.graph());return On.forEach(e.nodes(),function(n){e.children(n).length||t.setNode(n,e.node(n))}),On.forEach(e.edges(),function(n){t.setEdge(n,e.edge(n))}),t}function qme(e){var t=On.map(e.nodes(),function(n){var r={};return On.forEach(e.outEdges(n),function(s){r[s.w]=(r[s.w]||0)+e.edge(s).weight}),r});return On.zipObject(e.nodes(),t)}function Bme(e){var t=On.map(e.nodes(),function(n){var r={};return On.forEach(e.inEdges(n),function(s){r[s.v]=(r[s.v]||0)+e.edge(s).weight}),r});return On.zipObject(e.nodes(),t)}function zme(e,t){var n=e.x,r=e.y,s=t.x-n,i=t.y-r,l=e.width/2,a=e.height/2;if(!s&&!i)throw new Error("Not possible to find intersection inside of the rectangle");var c,d;return Math.abs(i)*l>Math.abs(s)*a?(i<0&&(a=-a),c=a*s/i,d=a):(s<0&&(l=-l),c=l,d=l*i/s),{x:n+c,y:r+d}}function Ume(e){var t=On.map(On.range(VF(e)+1),function(){return[]});return On.forEach(e.nodes(),function(n){var r=e.node(n),s=r.rank;On.isUndefined(s)||(t[s][r.order]=n)}),t}function Hme(e){var t=On.min(On.map(e.nodes(),function(n){return e.node(n).rank}));On.forEach(e.nodes(),function(n){var r=e.node(n);On.has(r,"rank")&&(r.rank-=t)})}function Vme(e){var t=On.min(On.map(e.nodes(),function(i){return e.node(i).rank})),n=[];On.forEach(e.nodes(),function(i){var l=e.node(i).rank-t;n[l]||(n[l]=[]),n[l].push(i)});var r=0,s=e.graph().nodeRankFactor;On.forEach(n,function(i,l){On.isUndefined(i)&&l%s!==0?--r:r&&On.forEach(i,function(a){e.node(a).rank+=r})})}function Wme(e,t,n,r){var s={width:0,height:0};return arguments.length>=4&&(s.rank=n,s.order=r),HF(e,"border",s,t)}function VF(e){return On.max(On.map(e.nodes(),function(t){var n=e.node(t).rank;if(!On.isUndefined(n))return n}))}function Gme(e,t){var n={lhs:[],rhs:[]};return On.forEach(e,function(r){t(r)?n.lhs.push(r):n.rhs.push(r)}),n}function Yme(e,t){var n=On.now();try{return t()}finally{console.log(e+" time: "+(On.now()-n)+"ms")}}function Xme(e,t){return t()}var WF=lr,Kme=ti,Jme={run:Zme,undo:epe};function Zme(e){e.graph().dummyChains=[],WF.forEach(e.edges(),function(t){Qme(e,t)})}function Qme(e,t){var n=t.v,r=e.node(n).rank,s=t.w,i=e.node(s).rank,l=t.name,a=e.edge(t),c=a.labelRank;if(i!==r+1){e.removeEdge(t);var d,u,f;for(f=0,++r;r<i;++f,++r)a.points=[],u={width:0,height:0,edgeLabel:a,edgeObj:t,rank:r},d=Kme.addDummyNode(e,"edge",u,"_d"),r===c&&(u.width=a.width,u.height=a.height,u.dummy="edge-label",u.labelpos=a.labelpos),e.setEdge(n,d,{weight:a.weight},l),f===0&&e.graph().dummyChains.push(d),n=d;e.setEdge(n,s,{weight:a.weight},l)}}function epe(e){WF.forEach(e.graph().dummyChains,function(t){var n=e.node(t),r=n.edgeLabel,s;for(e.setEdge(n.edgeObj,r);n.dummy;)s=e.successors(t)[0],e.removeNode(t),r.points.push({x:n.x,y:n.y}),n.dummy==="edge-label"&&(r.x=n.x,r.y=n.y,r.width=n.width,r.height=n.height),t=s,n=e.node(t)})}var jp=lr,k1={longestPath:tpe,slack:npe};function tpe(e){var t={};function n(r){var s=e.node(r);if(jp.has(t,r))return s.rank;t[r]=!0;var i=jp.min(jp.map(e.outEdges(r),function(l){return n(l.w)-e.edge(l).minlen}));return(i===Number.POSITIVE_INFINITY||i===void 0||i===null)&&(i=0),s.rank=i}jp.forEach(e.sources(),n)}function npe(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}var e0=lr,rpe=ha.Graph,t0=k1.slack,GF=spe;function spe(e){var t=new rpe({directed:!1}),n=e.nodes()[0],r=e.nodeCount();t.setNode(n,{});for(var s,i;ipe(t,e)<r;)s=ape(t,e),i=t.hasNode(s.v)?t0(e,s):-t0(e,s),ope(t,e,i);return t}function ipe(e,t){function n(r){e0.forEach(t.nodeEdges(r),function(s){var i=s.v,l=r===i?s.w:i;!e.hasNode(l)&&!t0(t,s)&&(e.setNode(l,{}),e.setEdge(r,l,{}),n(l))})}return e0.forEach(e.nodes(),n),e.nodeCount()}function ape(e,t){return e0.minBy(t.edges(),function(n){if(e.hasNode(n.v)!==e.hasNode(n.w))return t0(t,n)})}function ope(e,t,n){e0.forEach(e.nodes(),function(r){t.node(r).rank+=n})}var Ao=lr,lpe=GF,cpe=k1.slack,upe=k1.longestPath,dpe=ha.alg.preorder,fpe=ha.alg.postorder,hpe=ti.simplify,mpe=Hc;Hc.initLowLimValues=bj;Hc.initCutValues=vj;Hc.calcCutValue=YF;Hc.leaveEdge=KF;Hc.enterEdge=JF;Hc.exchangeEdges=ZF;function Hc(e){e=hpe(e),upe(e);var t=lpe(e);bj(t),vj(t,e);for(var n,r;n=KF(t);)r=JF(t,e,n),ZF(t,e,n,r)}function vj(e,t){var n=fpe(e,e.nodes());n=n.slice(0,n.length-1),Ao.forEach(n,function(r){ppe(e,t,r)})}function ppe(e,t,n){var r=e.node(n),s=r.parent;e.edge(n,s).cutvalue=YF(e,t,n)}function YF(e,t,n){var r=e.node(n),s=r.parent,i=!0,l=t.edge(n,s),a=0;return l||(i=!1,l=t.edge(s,n)),a=l.weight,Ao.forEach(t.nodeEdges(n),function(c){var d=c.v===n,u=d?c.w:c.v;if(u!==s){var f=d===i,m=t.edge(c).weight;if(a+=f?m:-m,xpe(e,n,u)){var h=e.edge(n,u).cutvalue;a+=f?-h:h}}}),a}function bj(e,t){arguments.length<2&&(t=e.nodes()[0]),XF(e,{},1,t)}function XF(e,t,n,r,s){var i=n,l=e.node(r);return t[r]=!0,Ao.forEach(e.neighbors(r),function(a){Ao.has(t,a)||(n=XF(e,t,n,a,r))}),l.low=i,l.lim=n++,s?l.parent=s:delete l.parent,n}function KF(e){return Ao.find(e.edges(),function(t){return e.edge(t).cutvalue<0})}function JF(e,t,n){var r=n.v,s=n.w;t.hasEdge(r,s)||(r=n.w,s=n.v);var i=e.node(r),l=e.node(s),a=i,c=!1;i.lim>l.lim&&(a=l,c=!0);var d=Ao.filter(t.edges(),function(u){return c===mP(e,e.node(u.v),a)&&c!==mP(e,e.node(u.w),a)});return Ao.minBy(d,function(u){return cpe(t,u)})}function ZF(e,t,n,r){var s=n.v,i=n.w;e.removeEdge(s,i),e.setEdge(r.v,r.w,{}),bj(e),vj(e,t),gpe(e,t)}function gpe(e,t){var n=Ao.find(e.nodes(),function(s){return!t.node(s).parent}),r=dpe(e,n);r=r.slice(1),Ao.forEach(r,function(s){var i=e.node(s).parent,l=t.edge(s,i),a=!1;l||(l=t.edge(i,s),a=!0),t.node(s).rank=t.node(i).rank+(a?l.minlen:-l.minlen)})}function xpe(e,t,n){return e.hasEdge(t,n)}function mP(e,t,n){return n.low<=t.lim&&t.lim<=n.lim}var ype=k1,QF=ype.longestPath,vpe=GF,bpe=mpe,wpe=Npe;function Npe(e){switch(e.graph().ranker){case"network-simplex":pP(e);break;case"tight-tree":_pe(e);break;case"longest-path":jpe(e);break;default:pP(e)}}var jpe=QF;function _pe(e){QF(e),vpe(e)}function pP(e){bpe(e)}var XN=lr,Spe=Ape;function Ape(e){var t=Epe(e);XN.forEach(e.graph().dummyChains,function(n){for(var r=e.node(n),s=r.edgeObj,i=kpe(e,t,s.v,s.w),l=i.path,a=i.lca,c=0,d=l[c],u=!0;n!==s.w;){if(r=e.node(n),u){for(;(d=l[c])!==a&&e.node(d).maxRank<r.rank;)c++;d===a&&(u=!1)}if(!u){for(;c<l.length-1&&e.node(d=l[c+1]).minRank<=r.rank;)c++;d=l[c]}e.setParent(n,d),n=e.successors(n)[0]}})}function kpe(e,t,n,r){var s=[],i=[],l=Math.min(t[n].low,t[r].low),a=Math.max(t[n].lim,t[r].lim),c,d;c=n;do c=e.parent(c),s.push(c);while(c&&(t[c].low>l||a>t[c].lim));for(d=c,c=r;(c=e.parent(c))!==d;)i.push(c);return{path:s.concat(i.reverse()),lca:d}}function Epe(e){var t={},n=0;function r(s){var i=n;XN.forEach(e.children(s),r),t[s]={low:i,lim:n++}}return XN.forEach(e.children(),r),t}var bo=lr,KN=ti,Cpe={run:Ppe,cleanup:Lpe};function Ppe(e){var t=KN.addDummyNode(e,"root",{},"_root"),n=Ipe(e),r=bo.max(bo.values(n))-1,s=2*r+1;e.graph().nestingRoot=t,bo.forEach(e.edges(),function(l){e.edge(l).minlen*=s});var i=Tpe(e)+1;bo.forEach(e.children(),function(l){eD(e,t,s,i,r,n,l)}),e.graph().nodeRankFactor=s}function eD(e,t,n,r,s,i,l){var a=e.children(l);if(!a.length){l!==t&&e.setEdge(t,l,{weight:0,minlen:n});return}var c=KN.addBorderNode(e,"_bt"),d=KN.addBorderNode(e,"_bb"),u=e.node(l);e.setParent(c,l),u.borderTop=c,e.setParent(d,l),u.borderBottom=d,bo.forEach(a,function(f){eD(e,t,n,r,s,i,f);var m=e.node(f),h=m.borderTop?m.borderTop:f,g=m.borderBottom?m.borderBottom:f,y=m.borderTop?r:2*r,p=h!==g?1:s-i[l]+1;e.setEdge(c,h,{weight:y,minlen:p,nestingEdge:!0}),e.setEdge(g,d,{weight:y,minlen:p,nestingEdge:!0})}),e.parent(l)||e.setEdge(t,c,{weight:0,minlen:s+i[l]})}function Ipe(e){var t={};function n(r,s){var i=e.children(r);i&&i.length&&bo.forEach(i,function(l){n(l,s+1)}),t[r]=s}return bo.forEach(e.children(),function(r){n(r,1)}),t}function Tpe(e){return bo.reduce(e.edges(),function(t,n){return t+e.edge(n).weight},0)}function Lpe(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,bo.forEach(e.edges(),function(n){var r=e.edge(n);r.nestingEdge&&e.removeEdge(n)})}var c5=lr,Mpe=ti,Rpe=$pe;function $pe(e){function t(n){var r=e.children(n),s=e.node(n);if(r.length&&c5.forEach(r,t),c5.has(s,"minRank")){s.borderLeft=[],s.borderRight=[];for(var i=s.minRank,l=s.maxRank+1;i<l;++i)gP(e,"borderLeft","_bl",n,s,i),gP(e,"borderRight","_br",n,s,i)}}c5.forEach(e.children(),t)}function gP(e,t,n,r,s,i){var l={width:0,height:0,rank:i,borderType:t},a=s[t][i-1],c=Mpe.addDummyNode(e,"border",l,n);s[t][i]=c,e.setParent(c,r),a&&e.setEdge(a,c,{weight:1})}var La=lr,Ope={adjust:Fpe,undo:Dpe};function Fpe(e){var t=e.graph().rankdir.toLowerCase();(t==="lr"||t==="rl")&&tD(e)}function Dpe(e){var t=e.graph().rankdir.toLowerCase();(t==="bt"||t==="rl")&&qpe(e),(t==="lr"||t==="rl")&&(Bpe(e),tD(e))}function tD(e){La.forEach(e.nodes(),function(t){xP(e.node(t))}),La.forEach(e.edges(),function(t){xP(e.edge(t))})}function xP(e){var t=e.width;e.width=e.height,e.height=t}function qpe(e){La.forEach(e.nodes(),function(t){u5(e.node(t))}),La.forEach(e.edges(),function(t){var n=e.edge(t);La.forEach(n.points,u5),La.has(n,"y")&&u5(n)})}function u5(e){e.y=-e.y}function Bpe(e){La.forEach(e.nodes(),function(t){d5(e.node(t))}),La.forEach(e.edges(),function(t){var n=e.edge(t);La.forEach(n.points,d5),La.has(n,"x")&&d5(n)})}function d5(e){var t=e.x;e.x=e.y,e.y=t}var lo=lr,zpe=Upe;function Upe(e){var t={},n=lo.filter(e.nodes(),function(a){return!e.children(a).length}),r=lo.max(lo.map(n,function(a){return e.node(a).rank})),s=lo.map(lo.range(r+1),function(){return[]});function i(a){if(!lo.has(t,a)){t[a]=!0;var c=e.node(a);s[c.rank].push(a),lo.forEach(e.successors(a),i)}}var l=lo.sortBy(n,function(a){return e.node(a).rank});return lo.forEach(l,i),s}var el=lr,Hpe=Vpe;function Vpe(e,t){for(var n=0,r=1;r<t.length;++r)n+=Wpe(e,t[r-1],t[r]);return n}function Wpe(e,t,n){for(var r=el.zipObject(n,el.map(n,function(d,u){return u})),s=el.flatten(el.map(t,function(d){return el.sortBy(el.map(e.outEdges(d),function(u){return{pos:r[u.w],weight:e.edge(u).weight}}),"pos")}),!0),i=1;i<n.length;)i<<=1;var l=2*i-1;i-=1;var a=el.map(new Array(l),function(){return 0}),c=0;return el.forEach(s.forEach(function(d){var u=d.pos+i;a[u]+=d.weight;for(var f=0;u>0;)u%2&&(f+=a[u+1]),u=u-1>>1,a[u]+=d.weight;c+=d.weight*f})),c}var yP=lr,Gpe=Ype;function Ype(e,t){return yP.map(t,function(n){var r=e.inEdges(n);if(r.length){var s=yP.reduce(r,function(i,l){var a=e.edge(l),c=e.node(l.v);return{sum:i.sum+a.weight*c.order,weight:i.weight+a.weight}},{sum:0,weight:0});return{v:n,barycenter:s.sum/s.weight,weight:s.weight}}else return{v:n}})}var xi=lr,Xpe=Kpe;function Kpe(e,t){var n={};xi.forEach(e,function(s,i){var l=n[s.v]={indegree:0,in:[],out:[],vs:[s.v],i};xi.isUndefined(s.barycenter)||(l.barycenter=s.barycenter,l.weight=s.weight)}),xi.forEach(t.edges(),function(s){var i=n[s.v],l=n[s.w];!xi.isUndefined(i)&&!xi.isUndefined(l)&&(l.indegree++,i.out.push(n[s.w]))});var r=xi.filter(n,function(s){return!s.indegree});return Jpe(r)}function Jpe(e){var t=[];function n(i){return function(l){l.merged||(xi.isUndefined(l.barycenter)||xi.isUndefined(i.barycenter)||l.barycenter>=i.barycenter)&&Zpe(i,l)}}function r(i){return function(l){l.in.push(i),--l.indegree===0&&e.push(l)}}for(;e.length;){var s=e.pop();t.push(s),xi.forEach(s.in.reverse(),n(s)),xi.forEach(s.out,r(s))}return xi.map(xi.filter(t,function(i){return!i.merged}),function(i){return xi.pick(i,["vs","i","barycenter","weight"])})}function Zpe(e,t){var n=0,r=0;e.weight&&(n+=e.barycenter*e.weight,r+=e.weight),t.weight&&(n+=t.barycenter*t.weight,r+=t.weight),e.vs=t.vs.concat(e.vs),e.barycenter=n/r,e.weight=r,e.i=Math.min(t.i,e.i),t.merged=!0}var Kf=lr,Qpe=ti,ege=tge;function tge(e,t){var n=Qpe.partition(e,function(u){return Kf.has(u,"barycenter")}),r=n.lhs,s=Kf.sortBy(n.rhs,function(u){return-u.i}),i=[],l=0,a=0,c=0;r.sort(nge(!!t)),c=vP(i,s,c),Kf.forEach(r,function(u){c+=u.vs.length,i.push(u.vs),l+=u.barycenter*u.weight,a+=u.weight,c=vP(i,s,c)});var d={vs:Kf.flatten(i,!0)};return a&&(d.barycenter=l/a,d.weight=a),d}function vP(e,t,n){for(var r;t.length&&(r=Kf.last(t)).i<=n;)t.pop(),e.push(r.vs),n++;return n}function nge(e){return function(t,n){return t.barycenter<n.barycenter?-1:t.barycenter>n.barycenter?1:e?n.i-t.i:t.i-n.i}}var al=lr,rge=Gpe,sge=Xpe,ige=ege,age=nD;function nD(e,t,n,r){var s=e.children(t),i=e.node(t),l=i?i.borderLeft:void 0,a=i?i.borderRight:void 0,c={};l&&(s=al.filter(s,function(g){return g!==l&&g!==a}));var d=rge(e,s);al.forEach(d,function(g){if(e.children(g.v).length){var y=nD(e,g.v,n,r);c[g.v]=y,al.has(y,"barycenter")&&lge(g,y)}});var u=sge(d,n);oge(u,c);var f=ige(u,r);if(l&&(f.vs=al.flatten([l,f.vs,a],!0),e.predecessors(l).length)){var m=e.node(e.predecessors(l)[0]),h=e.node(e.predecessors(a)[0]);al.has(f,"barycenter")||(f.barycenter=0,f.weight=0),f.barycenter=(f.barycenter*f.weight+m.order+h.order)/(f.weight+2),f.weight+=2}return f}function oge(e,t){al.forEach(e,function(n){n.vs=al.flatten(n.vs.map(function(r){return t[r]?t[r].vs:r}),!0)})}function lge(e,t){al.isUndefined(e.barycenter)?(e.barycenter=t.barycenter,e.weight=t.weight):(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight)}var Jf=lr,cge=ha.Graph,uge=dge;function dge(e,t,n){var r=fge(e),s=new cge({compound:!0}).setGraph({root:r}).setDefaultNodeLabel(function(i){return e.node(i)});return Jf.forEach(e.nodes(),function(i){var l=e.node(i),a=e.parent(i);(l.rank===t||l.minRank<=t&&t<=l.maxRank)&&(s.setNode(i),s.setParent(i,a||r),Jf.forEach(e[n](i),function(c){var d=c.v===i?c.w:c.v,u=s.edge(d,i),f=Jf.isUndefined(u)?0:u.weight;s.setEdge(d,i,{weight:e.edge(c).weight+f})}),Jf.has(l,"minRank")&&s.setNode(i,{borderLeft:l.borderLeft[t],borderRight:l.borderRight[t]}))}),s}function fge(e){for(var t;e.hasNode(t=Jf.uniqueId("_root")););return t}var hge=lr,mge=pge;function pge(e,t,n){var r={},s;hge.forEach(n,function(i){for(var l=e.parent(i),a,c;l;){if(a=e.parent(l),a?(c=r[a],r[a]=l):(c=s,s=l),c&&c!==l){t.setEdge(c,l);return}l=a}})}var dl=lr,gge=zpe,xge=Hpe,yge=age,vge=uge,bge=mge,wge=ha.Graph,bP=ti,Nge=jge;function jge(e){var t=bP.maxRank(e),n=wP(e,dl.range(1,t+1),"inEdges"),r=wP(e,dl.range(t-1,-1,-1),"outEdges"),s=gge(e);NP(e,s);for(var i=Number.POSITIVE_INFINITY,l,a=0,c=0;c<4;++a,++c){_ge(a%2?n:r,a%4>=2),s=bP.buildLayerMatrix(e);var d=xge(e,s);d<i&&(c=0,l=dl.cloneDeep(s),i=d)}NP(e,l)}function wP(e,t,n){return dl.map(t,function(r){return vge(e,r,n)})}function _ge(e,t){var n=new wge;dl.forEach(e,function(r){var s=r.graph().root,i=yge(r,s,n,t);dl.forEach(i.vs,function(l,a){r.node(l).order=a}),bge(r,n,i.vs)})}function NP(e,t){dl.forEach(t,function(n){dl.forEach(n,function(r,s){e.node(r).order=s})})}var dn=lr,Sge=ha.Graph,Age=ti,kge={positionX:Fge};function Ege(e,t){var n={};function r(s,i){var l=0,a=0,c=s.length,d=dn.last(i);return dn.forEach(i,function(u,f){var m=Pge(e,u),h=m?e.node(m).order:c;(m||u===d)&&(dn.forEach(i.slice(a,f+1),function(g){dn.forEach(e.predecessors(g),function(y){var p=e.node(y),x=p.order;(x<l||h<x)&&!(p.dummy&&e.node(g).dummy)&&rD(n,y,g)})}),a=f+1,l=h)}),i}return dn.reduce(t,r),n}function Cge(e,t){var n={};function r(i,l,a,c,d){var u;dn.forEach(dn.range(l,a),function(f){u=i[f],e.node(u).dummy&&dn.forEach(e.predecessors(u),function(m){var h=e.node(m);h.dummy&&(h.order<c||h.order>d)&&rD(n,m,u)})})}function s(i,l){var a=-1,c,d=0;return dn.forEach(l,function(u,f){if(e.node(u).dummy==="border"){var m=e.predecessors(u);m.length&&(c=e.node(m[0]).order,r(l,d,f,a,c),d=f,a=c)}r(l,d,l.length,c,i.length)}),l}return dn.reduce(t,s),n}function Pge(e,t){if(e.node(t).dummy)return dn.find(e.predecessors(t),function(n){return e.node(n).dummy})}function rD(e,t,n){if(t>n){var r=t;t=n,n=r}var s=e[t];s||(e[t]=s={}),s[n]=!0}function Ige(e,t,n){if(t>n){var r=t;t=n,n=r}return dn.has(e[t],n)}function Tge(e,t,n,r){var s={},i={},l={};return dn.forEach(t,function(a){dn.forEach(a,function(c,d){s[c]=c,i[c]=c,l[c]=d})}),dn.forEach(t,function(a){var c=-1;dn.forEach(a,function(d){var u=r(d);if(u.length){u=dn.sortBy(u,function(y){return l[y]});for(var f=(u.length-1)/2,m=Math.floor(f),h=Math.ceil(f);m<=h;++m){var g=u[m];i[d]===d&&c<l[g]&&!Ige(n,d,g)&&(i[g]=d,i[d]=s[d]=s[g],c=l[g])}}})}),{root:s,align:i}}function Lge(e,t,n,r,s){var i={},l=Mge(e,t,n,s),a=s?"borderLeft":"borderRight";function c(f,m){for(var h=l.nodes(),g=h.pop(),y={};g;)y[g]?f(g):(y[g]=!0,h.push(g),h=h.concat(m(g))),g=h.pop()}function d(f){i[f]=l.inEdges(f).reduce(function(m,h){return Math.max(m,i[h.v]+l.edge(h))},0)}function u(f){var m=l.outEdges(f).reduce(function(g,y){return Math.min(g,i[y.w]-l.edge(y))},Number.POSITIVE_INFINITY),h=e.node(f);m!==Number.POSITIVE_INFINITY&&h.borderType!==a&&(i[f]=Math.max(i[f],m))}return c(d,l.predecessors.bind(l)),c(u,l.successors.bind(l)),dn.forEach(r,function(f){i[f]=i[n[f]]}),i}function Mge(e,t,n,r){var s=new Sge,i=e.graph(),l=Dge(i.nodesep,i.edgesep,r);return dn.forEach(t,function(a){var c;dn.forEach(a,function(d){var u=n[d];if(s.setNode(u),c){var f=n[c],m=s.edge(f,u);s.setEdge(f,u,Math.max(l(e,d,c),m||0))}c=d})}),s}function Rge(e,t){return dn.minBy(dn.values(t),function(n){var r=Number.NEGATIVE_INFINITY,s=Number.POSITIVE_INFINITY;return dn.forIn(n,function(i,l){var a=qge(e,l)/2;r=Math.max(i+a,r),s=Math.min(i-a,s)}),r-s})}function $ge(e,t){var n=dn.values(t),r=dn.min(n),s=dn.max(n);dn.forEach(["u","d"],function(i){dn.forEach(["l","r"],function(l){var a=i+l,c=e[a],d;if(c!==t){var u=dn.values(c);d=l==="l"?r-dn.min(u):s-dn.max(u),d&&(e[a]=dn.mapValues(c,function(f){return f+d}))}})})}function Oge(e,t){return dn.mapValues(e.ul,function(n,r){if(t)return e[t.toLowerCase()][r];var s=dn.sortBy(dn.map(e,r));return(s[1]+s[2])/2})}function Fge(e){var t=Age.buildLayerMatrix(e),n=dn.merge(Ege(e,t),Cge(e,t)),r={},s;dn.forEach(["u","d"],function(l){s=l==="u"?t:dn.values(t).reverse(),dn.forEach(["l","r"],function(a){a==="r"&&(s=dn.map(s,function(f){return dn.values(f).reverse()}));var c=(l==="u"?e.predecessors:e.successors).bind(e),d=Tge(e,s,n,c),u=Lge(e,s,d.root,d.align,a==="r");a==="r"&&(u=dn.mapValues(u,function(f){return-f})),r[l+a]=u})});var i=Rge(e,r);return $ge(r,i),Oge(r,e.graph().align)}function Dge(e,t,n){return function(r,s,i){var l=r.node(s),a=r.node(i),c=0,d;if(c+=l.width/2,dn.has(l,"labelpos"))switch(l.labelpos.toLowerCase()){case"l":d=-l.width/2;break;case"r":d=l.width/2;break}if(d&&(c+=n?d:-d),d=0,c+=(l.dummy?t:e)/2,c+=(a.dummy?t:e)/2,c+=a.width/2,dn.has(a,"labelpos"))switch(a.labelpos.toLowerCase()){case"l":d=a.width/2;break;case"r":d=-a.width/2;break}return d&&(c+=n?d:-d),d=0,c}}function qge(e,t){return e.node(t).width}var Zf=lr,sD=ti,Bge=kge.positionX,zge=Uge;function Uge(e){e=sD.asNonCompoundGraph(e),Hge(e),Zf.forEach(Bge(e),function(t,n){e.node(n).x=t})}function Hge(e){var t=sD.buildLayerMatrix(e),n=e.graph().ranksep,r=0;Zf.forEach(t,function(s){var i=Zf.max(Zf.map(s,function(l){return e.node(l).height}));Zf.forEach(s,function(l){e.node(l).y=r+i/2}),r+=i+n})}var bn=lr,jP=Mme,_P=Jme,Vge=wpe,Wge=ti.normalizeRanks,Gge=Spe,Yge=ti.removeEmptyRanks,SP=Cpe,Xge=Rpe,AP=Ope,Kge=Nge,Jge=zge,wl=ti,Zge=ha.Graph,Qge=e0e;function e0e(e,t){var n=t&&t.debugTiming?wl.time:wl.notime;n("layout",function(){var r=n("  buildLayoutGraph",function(){return d0e(e)});n("  runLayout",function(){t0e(r,n)}),n("  updateInputGraph",function(){n0e(e,r)})})}function t0e(e,t){t("    makeSpaceForEdgeLabels",function(){f0e(e)}),t("    removeSelfEdges",function(){w0e(e)}),t("    acyclic",function(){jP.run(e)}),t("    nestingGraph.run",function(){SP.run(e)}),t("    rank",function(){Vge(wl.asNonCompoundGraph(e))}),t("    injectEdgeLabelProxies",function(){h0e(e)}),t("    removeEmptyRanks",function(){Yge(e)}),t("    nestingGraph.cleanup",function(){SP.cleanup(e)}),t("    normalizeRanks",function(){Wge(e)}),t("    assignRankMinMax",function(){m0e(e)}),t("    removeEdgeLabelProxies",function(){p0e(e)}),t("    normalize.run",function(){_P.run(e)}),t("    parentDummyChains",function(){Gge(e)}),t("    addBorderSegments",function(){Xge(e)}),t("    order",function(){Kge(e)}),t("    insertSelfEdges",function(){N0e(e)}),t("    adjustCoordinateSystem",function(){AP.adjust(e)}),t("    position",function(){Jge(e)}),t("    positionSelfEdges",function(){j0e(e)}),t("    removeBorderNodes",function(){b0e(e)}),t("    normalize.undo",function(){_P.undo(e)}),t("    fixupEdgeLabelCoords",function(){y0e(e)}),t("    undoCoordinateSystem",function(){AP.undo(e)}),t("    translateGraph",function(){g0e(e)}),t("    assignNodeIntersects",function(){x0e(e)}),t("    reversePoints",function(){v0e(e)}),t("    acyclic.undo",function(){jP.undo(e)})}function n0e(e,t){bn.forEach(e.nodes(),function(n){var r=e.node(n),s=t.node(n);r&&(r.x=s.x,r.y=s.y,t.children(n).length&&(r.width=s.width,r.height=s.height))}),bn.forEach(e.edges(),function(n){var r=e.edge(n),s=t.edge(n);r.points=s.points,bn.has(s,"x")&&(r.x=s.x,r.y=s.y)}),e.graph().width=t.graph().width,e.graph().height=t.graph().height}var r0e=["nodesep","edgesep","ranksep","marginx","marginy"],s0e={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},i0e=["acyclicer","ranker","rankdir","align"],a0e=["width","height"],o0e={width:0,height:0},l0e=["minlen","weight","width","height","labeloffset"],c0e={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},u0e=["labelpos"];function d0e(e){var t=new Zge({multigraph:!0,compound:!0}),n=h5(e.graph());return t.setGraph(bn.merge({},s0e,f5(n,r0e),bn.pick(n,i0e))),bn.forEach(e.nodes(),function(r){var s=h5(e.node(r));t.setNode(r,bn.defaults(f5(s,a0e),o0e)),t.setParent(r,e.parent(r))}),bn.forEach(e.edges(),function(r){var s=h5(e.edge(r));t.setEdge(r,bn.merge({},c0e,f5(s,l0e),bn.pick(s,u0e)))}),t}function f0e(e){var t=e.graph();t.ranksep/=2,bn.forEach(e.edges(),function(n){var r=e.edge(n);r.minlen*=2,r.labelpos.toLowerCase()!=="c"&&(t.rankdir==="TB"||t.rankdir==="BT"?r.width+=r.labeloffset:r.height+=r.labeloffset)})}function h0e(e){bn.forEach(e.edges(),function(t){var n=e.edge(t);if(n.width&&n.height){var r=e.node(t.v),s=e.node(t.w),i={rank:(s.rank-r.rank)/2+r.rank,e:t};wl.addDummyNode(e,"edge-proxy",i,"_ep")}})}function m0e(e){var t=0;bn.forEach(e.nodes(),function(n){var r=e.node(n);r.borderTop&&(r.minRank=e.node(r.borderTop).rank,r.maxRank=e.node(r.borderBottom).rank,t=bn.max(t,r.maxRank))}),e.graph().maxRank=t}function p0e(e){bn.forEach(e.nodes(),function(t){var n=e.node(t);n.dummy==="edge-proxy"&&(e.edge(n.e).labelRank=n.rank,e.removeNode(t))})}function g0e(e){var t=Number.POSITIVE_INFINITY,n=0,r=Number.POSITIVE_INFINITY,s=0,i=e.graph(),l=i.marginx||0,a=i.marginy||0;function c(d){var u=d.x,f=d.y,m=d.width,h=d.height;t=Math.min(t,u-m/2),n=Math.max(n,u+m/2),r=Math.min(r,f-h/2),s=Math.max(s,f+h/2)}bn.forEach(e.nodes(),function(d){c(e.node(d))}),bn.forEach(e.edges(),function(d){var u=e.edge(d);bn.has(u,"x")&&c(u)}),t-=l,r-=a,bn.forEach(e.nodes(),function(d){var u=e.node(d);u.x-=t,u.y-=r}),bn.forEach(e.edges(),function(d){var u=e.edge(d);bn.forEach(u.points,function(f){f.x-=t,f.y-=r}),bn.has(u,"x")&&(u.x-=t),bn.has(u,"y")&&(u.y-=r)}),i.width=n-t+l,i.height=s-r+a}function x0e(e){bn.forEach(e.edges(),function(t){var n=e.edge(t),r=e.node(t.v),s=e.node(t.w),i,l;n.points?(i=n.points[0],l=n.points[n.points.length-1]):(n.points=[],i=s,l=r),n.points.unshift(wl.intersectRect(r,i)),n.points.push(wl.intersectRect(s,l))})}function y0e(e){bn.forEach(e.edges(),function(t){var n=e.edge(t);if(bn.has(n,"x"))switch((n.labelpos==="l"||n.labelpos==="r")&&(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset;break}})}function v0e(e){bn.forEach(e.edges(),function(t){var n=e.edge(t);n.reversed&&n.points.reverse()})}function b0e(e){bn.forEach(e.nodes(),function(t){if(e.children(t).length){var n=e.node(t),r=e.node(n.borderTop),s=e.node(n.borderBottom),i=e.node(bn.last(n.borderLeft)),l=e.node(bn.last(n.borderRight));n.width=Math.abs(l.x-i.x),n.height=Math.abs(s.y-r.y),n.x=i.x+n.width/2,n.y=r.y+n.height/2}}),bn.forEach(e.nodes(),function(t){e.node(t).dummy==="border"&&e.removeNode(t)})}function w0e(e){bn.forEach(e.edges(),function(t){if(t.v===t.w){var n=e.node(t.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}})}function N0e(e){var t=wl.buildLayerMatrix(e);bn.forEach(t,function(n){var r=0;bn.forEach(n,function(s,i){var l=e.node(s);l.order=i+r,bn.forEach(l.selfEdges,function(a){wl.addDummyNode(e,"selfedge",{width:a.label.width,height:a.label.height,rank:l.rank,order:i+ ++r,e:a.e,label:a.label},"_se")}),delete l.selfEdges})})}function j0e(e){bn.forEach(e.nodes(),function(t){var n=e.node(t);if(n.dummy==="selfedge"){var r=e.node(n.e.v),s=r.x+r.width/2,i=r.y,l=n.x-s,a=r.height/2;e.setEdge(n.e,n.label),e.removeNode(t),n.label.points=[{x:s+2*l/3,y:i-a},{x:s+5*l/6,y:i-a},{x:s+l,y:i},{x:s+5*l/6,y:i+a},{x:s+2*l/3,y:i+a}],n.label.x=n.x,n.label.y=n.y}})}function f5(e,t){return bn.mapValues(bn.pick(e,t),Number)}function h5(e){var t={};return bn.forEach(e,function(n,r){t[r.toLowerCase()]=n}),t}var _p=lr,_0e=ti,S0e=ha.Graph,A0e={debugOrdering:k0e};function k0e(e){var t=_0e.buildLayerMatrix(e),n=new S0e({compound:!0,multigraph:!0}).setGraph({});return _p.forEach(e.nodes(),function(r){n.setNode(r,{label:r}),n.setParent(r,"layer"+e.node(r).rank)}),_p.forEach(e.edges(),function(r){n.setEdge(r.v,r.w,{},r.name)}),_p.forEach(t,function(r,s){var i="layer"+s;n.setNode(i,{rank:"same"}),_p.reduce(r,function(l,a){return n.setEdge(l,a,{style:"invis"}),a})}),n}var E0e="0.8.5",C0e={graphlib:ha,layout:Qge,debug:A0e,util:{time:ti.time,notime:ti.notime},version:E0e};const kP=n0(C0e),P0e=(e,t,n={})=>{const{rankdir:r="TB",nodeWidth:s=280,nodeHeight:i=220,ranker:l="network-simplex",spouseEdgeStyle:a="#ec4899"}=n,c=new kP.graphlib.Graph;c.setGraph({rankdir:r,ranker:l,nodesep:50,edgesep:30,ranksep:100}),c.setDefaultEdgeLabel(()=>({})),e.forEach(y=>{c.setNode(y.id,{width:s,height:i})});const d=[],u=[];t.forEach(y=>{var p;((p=y.style)==null?void 0:p.stroke)===a||y.sourceHandle==="spouse"||y.targetHandle==="spouse"?d.push(y):u.push(y)});const f=new Map;u.forEach(y=>{f.has(y.target)||f.set(y.target,[]),f.get(y.target).push(y.source)}),u.forEach(y=>{c.setEdge(y.source,y.target)}),kP.layout(c);const m={};e.forEach(y=>{const p=c.node(y.id);p&&(m[y.id]={x:p.x-s/2,y:p.y-i/2})});const h=new Set,g={...m};return d.forEach(y=>{const p=y.source,x=y.target,b=[p,x].sort().join("-");if(!h.has(b)){h.add(b);const w=m[p],N=m[x];if(w&&N){const k=(w.y+N.y)/2,I=s+50;g[p]={x:w.x,y:k},g[x]={x:w.x+I,y:k}}}}),e.map(y=>{const p=g[y.id];return p?{...y,position:p}:y})},iD=J.createContext(void 0),wj=()=>{const e=J.useContext(iD);if(!e)throw new Error("useSelectedNode must be used within a SelectedNodeProvider");return e},I0e=(e,t,n)=>{var s;if(!n||!Array.isArray(n))return null;const r=n.filter(i=>{var d;const l=i.relationshipType==="Child",a=e.toString(),c=(d=i.relatedPersonId)==null?void 0:d.toString();return l&&c===a});for(const i of r){const l=(s=i.personId)==null?void 0:s.toString(),a=t.find(c=>c.id===l);if(a&&a.gender==="male")return a}return null},T0e=(e,t,n)=>{var s,i;if(!n||!Array.isArray(n))return null;const r=n.filter(l=>{var u;const a=l.relationshipType==="Child",c=e.toString(),d=(u=l.relatedPersonId)==null?void 0:u.toString();return a&&d===c});for(const l of r){const a=(s=l.personId)==null?void 0:s.toString(),c=t.find(d=>d.id===a);if(c&&c.gender==="female")return c;if(c&&c.gender==="male"){const d=n.find(u=>{var g,y;const f=u.relationshipType==="Child",m=e.toString(),h=(g=u.relatedPersonId)==null?void 0:g.toString();return f&&h===m&&((y=t.find(p=>{var x;return p.id===((x=u.personId)==null?void 0:x.toString())}))==null?void 0:y.gender)==="female"});if(d){const u=(i=d.personId)==null?void 0:i.toString(),f=t.find(m=>m.id===u);if(f)return f}}}return null},L0e=({id:e,sourceX:t,sourceY:n,targetX:r,targetY:s,sourcePosition:i,targetPosition:l,style:a={},data:c,markerEnd:d})=>{const{collapsedNodes:u,toggleNodeCollapse:f}=wj(),{theme:m}=Ft(),[h,g,y]=U4({sourceX:t,sourceY:n,sourcePosition:i,targetX:r,targetY:s,targetPosition:l}),p=(c==null?void 0:c.target)||"",x=(c==null?void 0:c.hasChildren)||!1,b=u.has(p);return o.jsxs(o.Fragment,{children:[o.jsx("path",{id:e,style:a,className:"react-flow__edge-path",d:h,markerEnd:d}),x&&o.jsx("foreignObject",{width:24,height:24,x:g-12,y:y-12,className:"edgebutton-foreignobject",requiredExtensions:"http://www.w3.org/1999/xhtml",children:o.jsx("button",{className:`w-6 h-6 rounded-full border-2 flex items-center justify-center text-xs font-bold transition-all duration-200 hover:scale-110 ${b?"bg-blue-500 text-white border-blue-600 hover:bg-blue-600":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,style:{backgroundColor:b?"#3b82f6":m==="dark"?"#374151":"#ffffff",color:b?"#ffffff":m==="dark"?"#f9fafb":"#374151",borderColor:b?"#2563eb":m==="dark"?"#4b5563":"#d1d5db"},onClick:w=>{w.stopPropagation(),f(p)},title:b?"Expand":"Collapse",children:b?"+":""})})]})},M0e=({person:e,isOpen:t,onClose:n,persons:r,relationships:s})=>{var w,N,k,I,R,T,S;const{theme:i,language:l="en"}=Ft(),{isMobile:a}=_r();Hle();const[c,d]=J.useState([]),[u,f]=J.useState([]);if(J.useEffect(()=>{if(!e||!t)return;const E=new Map;r.forEach(B=>E.set(B.id,B));const _=new Set,M=new Set;s&&Array.isArray(s)&&s.forEach(B=>{if((B.relationshipType==="Spouse"||B.relationshipType==="spouse"||B.relationshipType==="Husband"||B.relationshipType==="husband"||B.relationshipType==="Wife"||B.relationshipType==="wife")&&(B.personId.toString()===e.id||B.relatedPersonId.toString()===e.id)){const L=B.personId.toString()===e.id?B.relatedPersonId.toString():B.personId.toString();_.add(L)}(B.relationshipType==="Child"||B.relationshipType==="child"||B.relationshipType==="Son"||B.relationshipType==="son"||B.relationshipType==="Daughter"||B.relationshipType==="daughter")&&B.personId.toString()===e.id&&M.add(B.relatedPersonId.toString())}),e.relationships&&(e.relationships.spouses&&Array.isArray(e.relationships.spouses)&&e.relationships.spouses.forEach(B=>{typeof B=="object"&&B.person?typeof B.person=="object"&&B.person.id?_.add(B.person.id):typeof B.person=="string"&&_.add(B.person):typeof B=="string"&&_.add(B)}),e.relationships.children&&Array.isArray(e.relationships.children)&&e.relationships.children.forEach(B=>{typeof B=="object"&&B.id?M.add(B.id):typeof B=="string"&&M.add(B)}));const A=Array.from(_).map(B=>E.get(B)).filter(B=>B!==void 0),P=Array.from(M).map(B=>E.get(B)).filter(B=>B!==void 0);d(A),f(P)},[e,t,r,s]),!t||!e)return null;const m=a?"95vw":"600px",h=e,y=(()=>{var A,P,B,L;if(!((A=e.birth)!=null&&A.date)&&!h.birthDate)return null;const E=((P=e.birth)==null?void 0:P.date)||h.birthDate,_=new Date(E).getFullYear();return((B=e.death)!=null&&B.date||h.deathDate?new Date(((L=e.death)==null?void 0:L.date)||h.deathDate).getFullYear():new Date().getFullYear())-_})(),p=e.gender||"unknown",x=p==="male",b=p==="female";return o.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:E=>{E.target===E.currentTarget&&n()},children:o.jsxs("div",{className:"relative rounded-3xl shadow-2xl max-h-[90vh] overflow-hidden animate-in fade-in-0 zoom-in-95 duration-300",style:{width:m,background:i==="dark"?"linear-gradient(135deg, #1f2937 0%, #111827 100%)":"linear-gradient(135deg, #ffffff 0%, #f8fafc 100%)",border:`2px solid ${i==="dark"?"#374151":"#e2e8f0"}`},onClick:E=>E.stopPropagation(),children:[o.jsxs("div",{className:"relative h-32 overflow-hidden",style:{background:x?"linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)":b?"linear-gradient(135deg, #ec4899 0%, #be185d 100%)":"linear-gradient(135deg, #6b7280 0%, #374151 100%)"},children:[o.jsx("button",{onClick:E=>{E.preventDefault(),E.stopPropagation(),n()},className:"absolute top-4 right-4 w-10 h-10 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center hover:bg-white/30 transition-all duration-200 group z-10",type:"button",children:o.jsx(ia,{size:20,className:"text-white group-hover:scale-110 transition-transform"})}),o.jsx("div",{className:"absolute -top-10 -right-10 w-32 h-32 rounded-full bg-white/10"}),o.jsx("div",{className:"absolute -bottom-5 -left-5 w-20 h-20 rounded-full bg-white/5"})]}),o.jsxs("div",{className:"relative -mt-16 px-6 pb-6",children:[o.jsx("div",{className:"flex justify-center mb-4",children:o.jsx("div",{className:"w-24 h-24 rounded-full border-4 border-white shadow-xl flex items-center justify-center relative overflow-hidden",style:{background:x?"linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)":b?"linear-gradient(135deg, #ec4899 0%, #be185d 100%)":"linear-gradient(135deg, #6b7280 0%, #374151 100%)"},children:h.photo&&!h.photo.includes("/api/placeholder")?o.jsx("img",{src:h.photo,alt:`${e.firstName} ${e.lastName}`,className:"w-full h-full rounded-full object-cover"}):o.jsx("div",{className:"flex items-center justify-center w-full h-full",children:x?o.jsx(Aa,{size:40,color:"white",strokeWidth:1.5}):b?o.jsx(Xt,{size:40,color:"white",strokeWidth:1.5,className:"transform scale-x-[-1]"}):o.jsx(Xt,{size:40,color:"white",strokeWidth:1.5})})})}),o.jsxs("div",{className:"text-center mb-6",children:[o.jsxs("h2",{className:"text-2xl font-bold mb-2",style:{color:i==="dark"?"#f9fafb":"#111827"},children:[e.firstName," ",e.lastName]}),o.jsxs("div",{className:"flex flex-wrap justify-center gap-2 mb-4",children:[o.jsx("div",{className:"px-3 py-1 rounded-full text-xs font-medium",style:{backgroundColor:x?"#dbeafe":b?"#fce7f3":"#f3f4f6",color:x?"#1d4ed8":b?"#be185d":"#374151"},children:x?l==="ar"?"":"Male":b?l==="ar"?"":"Female":l==="ar"?" ":"Unknown"}),y&&o.jsxs("div",{className:"px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",children:[y," ",l==="ar"?"":"years old"]}),(w=e.death)!=null&&w.date||h.deathDate?o.jsx("div",{className:"px-3 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200",children:l==="ar"?"":"Deceased"}):o.jsx("div",{className:"px-3 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:l==="ar"?"  ":"Living"})]})]}),o.jsxs("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:[o.jsxs("div",{className:"rounded-2xl p-4 border",style:{backgroundColor:i==="dark"?"#374151":"#f8fafc",borderColor:i==="dark"?"#4b5563":"#e2e8f0"},children:[o.jsxs("div",{className:"flex items-center mb-3",children:[o.jsx(Xt,{size:18,className:"mr-2",style:{color:i==="dark"?"#9ca3af":"#6b7280"}}),o.jsx("h3",{className:"font-semibold",style:{color:i==="dark"?"#f9fafb":"#111827"},children:l==="ar"?" ":"Personal Information"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[(((N=e.birth)==null?void 0:N.date)||h.birthDate)&&o.jsxs("div",{className:"flex items-center",children:[o.jsx(Lr,{size:14,className:"mr-2 text-blue-500"}),o.jsxs("span",{style:{color:i==="dark"?"#d1d5db":"#6b7280"},children:[o.jsx("strong",{children:l==="ar"?" :":"Birth Date:"})," ",((k=e.birth)==null?void 0:k.date)||h.birthDate]})]}),(((I=e.death)==null?void 0:I.date)||h.deathDate)&&o.jsxs("div",{className:"flex items-center",children:[o.jsx(Lr,{size:14,className:"mr-2 text-gray-500"}),o.jsxs("span",{style:{color:i==="dark"?"#d1d5db":"#6b7280"},children:[o.jsx("strong",{children:l==="ar"?" :":"Death Date:"})," ",((R=e.death)==null?void 0:R.date)||h.deathDate]})]}),(((T=e.birth)==null?void 0:T.place)||h.birthPlace)&&o.jsxs("div",{className:"flex items-center",children:[o.jsx(ei,{size:14,className:"mr-2 text-green-500"}),o.jsxs("span",{style:{color:i==="dark"?"#d1d5db":"#6b7280"},children:[o.jsx("strong",{children:l==="ar"?" :":"Birth Place:"})," ",((S=e.birth)==null?void 0:S.place)||h.birthPlace]})]}),h.occupation&&o.jsxs("div",{className:"flex items-center",children:[o.jsx(Xt,{size:14,className:"mr-2 text-purple-500"}),o.jsxs("span",{style:{color:i==="dark"?"#d1d5db":"#6b7280"},children:[o.jsx("strong",{children:l==="ar"?":":"Occupation:"})," ",h.occupation]})]})]})]}),o.jsxs("div",{className:"rounded-2xl p-4 border",style:{backgroundColor:i==="dark"?"#374151":"#f8fafc",borderColor:i==="dark"?"#4b5563":"#e2e8f0"},children:[o.jsxs("div",{className:"flex items-center mb-3",children:[o.jsx(kn,{size:18,className:"mr-2 text-blue-500"}),o.jsx("h3",{className:"font-semibold",style:{color:i==="dark"?"#f9fafb":"#111827"},children:l==="ar"?"":"Parents"})]}),o.jsxs("div",{className:"space-y-2",children:[(()=>{var _,M;const E=I0e(e.id,r,s);return E?o.jsxs("div",{className:"flex items-center p-3 rounded-xl border hover:shadow-md transition-all duration-200",style:{backgroundColor:i==="dark"?"#1f2937":"#ffffff",borderColor:i==="dark"?"#4b5563":"#e5e7eb"},children:[o.jsx("div",{className:"w-10 h-10 rounded-full mr-3 flex items-center justify-center",style:{backgroundColor:"#dbeafe"},children:o.jsx(Aa,{size:16,color:"#3b82f6"})}),o.jsxs("div",{className:"flex-1",children:[o.jsxs("p",{className:"font-medium",style:{color:i==="dark"?"#f9fafb":"#111827"},children:[o.jsx("span",{className:"text-xs text-blue-600 dark:text-blue-400 block",children:l==="ar"?"":"Father"}),E.firstName," ",E.lastName]}),(((_=E.birth)==null?void 0:_.date)||E.birthDate)&&o.jsxs("p",{className:"text-xs",style:{color:i==="dark"?"#9ca3af":"#6b7280"},children:[l==="ar"?" :":"Born:"," ",((M=E.birth)==null?void 0:M.date)||E.birthDate]})]})]}):o.jsxs("div",{className:"flex items-center p-3 rounded-xl border",style:{backgroundColor:i==="dark"?"#1f2937":"#f9fafb",borderColor:i==="dark"?"#4b5563":"#e5e7eb"},children:[o.jsx("div",{className:"w-10 h-10 rounded-full mr-3 flex items-center justify-center",style:{backgroundColor:"#f3f4f6"},children:o.jsx(Aa,{size:16,color:"#9ca3af"})}),o.jsx("div",{className:"flex-1",children:o.jsxs("p",{className:"text-sm",style:{color:i==="dark"?"#9ca3af":"#6b7280"},children:[o.jsx("span",{className:"text-xs block",children:l==="ar"?"":"Father"}),l==="ar"?" ":"Not registered"]})})]})})(),(()=>{var _,M;const E=T0e(e.id,r,s);return E?o.jsxs("div",{className:"flex items-center p-3 rounded-xl border hover:shadow-md transition-all duration-200",style:{backgroundColor:i==="dark"?"#1f2937":"#ffffff",borderColor:i==="dark"?"#4b5563":"#e5e7eb"},children:[o.jsx("div",{className:"w-10 h-10 rounded-full mr-3 flex items-center justify-center",style:{backgroundColor:"#fce7f3"},children:o.jsx(th,{size:16,className:"w-4 h-4"})}),o.jsxs("div",{className:"flex-1",children:[o.jsxs("p",{className:"font-medium",style:{color:i==="dark"?"#f9fafb":"#111827"},children:[o.jsx("span",{className:"text-xs text-pink-600 dark:text-pink-400 block",children:l==="ar"?"":"Mother"}),E.firstName," ",E.lastName]}),(((_=E.birth)==null?void 0:_.date)||E.birthDate)&&o.jsxs("p",{className:"text-xs",style:{color:i==="dark"?"#9ca3af":"#6b7280"},children:[l==="ar"?" :":"Born:"," ",((M=E.birth)==null?void 0:M.date)||E.birthDate]})]})]}):o.jsxs("div",{className:"flex items-center p-3 rounded-xl border",style:{backgroundColor:i==="dark"?"#1f2937":"#f9fafb",borderColor:i==="dark"?"#4b5563":"#e5e7eb"},children:[o.jsx("div",{className:"w-10 h-10 rounded-full mr-3 flex items-center justify-center",style:{backgroundColor:"#f3f4f6"},children:o.jsx(Xt,{size:16,className:"w-4 h-4 opacity-50"})}),o.jsx("div",{className:"flex-1",children:o.jsxs("p",{className:"text-sm",style:{color:i==="dark"?"#9ca3af":"#6b7280"},children:[o.jsx("span",{className:"text-xs block",children:l==="ar"?"":"Mother"}),l==="ar"?" ":"Not registered"]})})]})})()]})]}),o.jsxs("div",{className:"rounded-2xl p-4 border",style:{backgroundColor:i==="dark"?"#374151":"#f8fafc",borderColor:i==="dark"?"#4b5563":"#e2e8f0"},children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(br,{size:18,className:"mr-2 text-pink-500"}),o.jsx("h3",{className:"font-semibold",style:{color:i==="dark"?"#f9fafb":"#111827"},children:l==="ar"?"":"Spouses"})]}),c.length>0&&o.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-200",children:c.length})]}),c.length>0?o.jsx("div",{className:"space-y-2",children:c.map(E=>{var _;return o.jsxs("div",{className:"flex items-center p-3 rounded-xl border hover:shadow-md transition-all duration-200",style:{backgroundColor:i==="dark"?"#1f2937":"#ffffff",borderColor:i==="dark"?"#4b5563":"#e5e7eb"},children:[o.jsx("div",{className:"w-10 h-10 rounded-full mr-3 flex items-center justify-center",style:{backgroundColor:E.gender==="male"?"#dbeafe":"#fce7f3"},children:E.gender==="male"?o.jsx(Aa,{size:16,color:"#3b82f6"}):o.jsx(th,{size:16,className:"w-4 h-4"})}),o.jsxs("div",{className:"flex-1",children:[o.jsxs("p",{className:"font-medium",style:{color:i==="dark"?"#f9fafb":"#111827"},children:[E.firstName," ",E.lastName]}),((_=E.birth)==null?void 0:_.date)&&o.jsxs("p",{className:"text-xs",style:{color:i==="dark"?"#9ca3af":"#6b7280"},children:[l==="ar"?" :":"Born:"," ",E.birth.date]})]})]},E.id)})}):o.jsxs("div",{className:"text-center py-4",children:[o.jsx(br,{size:24,className:"mx-auto mb-2 text-gray-400"}),o.jsx("p",{className:"text-sm",style:{color:i==="dark"?"#9ca3af":"#6b7280"},children:l==="ar"?"   ":"No spouses listed"})]})]}),o.jsxs("div",{className:"rounded-2xl p-4 border",style:{backgroundColor:i==="dark"?"#374151":"#f8fafc",borderColor:i==="dark"?"#4b5563":"#e2e8f0"},children:[o.jsxs("div",{className:"flex items-center justify-between mb-3",children:[o.jsxs("div",{className:"flex items-center",children:[o.jsx(ta,{size:18,className:"mr-2 text-blue-500"}),o.jsx("h3",{className:"font-semibold",style:{color:i==="dark"?"#f9fafb":"#111827"},children:l==="ar"?"":"Children"})]}),u.length>0&&o.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",children:u.length})]}),u.length>0?o.jsx("div",{className:"space-y-2",children:u.map(E=>{var _;return o.jsxs("div",{className:"flex items-center p-3 rounded-xl border hover:shadow-md transition-all duration-200",style:{backgroundColor:i==="dark"?"#1f2937":"#ffffff",borderColor:i==="dark"?"#4b5563":"#e5e7eb"},children:[o.jsx("div",{className:"w-10 h-10 rounded-full mr-3 flex items-center justify-center",style:{backgroundColor:E.gender==="male"?"#dbeafe":"#fce7f3"},children:E.gender==="male"?o.jsx(Aa,{size:16,color:"#3b82f6"}):o.jsx(th,{size:16,className:"w-4 h-4"})}),o.jsxs("div",{className:"flex-1",children:[o.jsxs("p",{className:"font-medium",style:{color:i==="dark"?"#f9fafb":"#111827"},children:[E.firstName," ",E.lastName]}),((_=E.birth)==null?void 0:_.date)&&o.jsxs("p",{className:"text-xs",style:{color:i==="dark"?"#9ca3af":"#6b7280"},children:[l==="ar"?" :":"Born:"," ",E.birth.date]})]})]},E.id)})}):o.jsxs("div",{className:"text-center py-4",children:[o.jsx(ta,{size:24,className:"mx-auto mb-2 text-gray-400"}),o.jsx("p",{className:"text-sm",style:{color:i==="dark"?"#9ca3af":"#6b7280"},children:l==="ar"?"   ":"No children listed"})]})]})]})]})]})})},R0e=({data:e,id:t})=>{const{theme:n,language:r="en"}=Ft(),{isMobile:s}=_r(),{selectedNodeId:i,setSelectedNodeId:l,toggleNodeCollapse:a}=wj(),c=i===e.id,d=e.birthDate||e.occupation||e.birthPlace,u=s?220:280,f=s?d?180:160:d?220:200,m=e.gender||"unknown",h=m==="female",g=m==="male",p=e.familyRole==="patriarch"?{primary:"#1e40af",secondary:"#dbeafe",accent:"#3b82f6"}:e.familyRole==="matriarch"?{primary:"#be185d",secondary:"#fce7f3",accent:"#ec4899"}:g?{primary:"#3b82f6",secondary:"#dbeafe",accent:"#60a5fa"}:h?{primary:"#ec4899",secondary:"#fce7f3",accent:"#f472b6"}:{primary:"#6b7280",secondary:"#f3f4f6",accent:"#9ca3af"},[x,b]=J.useState(p.primary),w=I=>{I.stopPropagation(),l(c?null:e.id)},k=(()=>{if(!e.birthDate)return null;const I=new Date(e.birthDate).getFullYear();return(e.deathDate?new Date(e.deathDate).getFullYear():new Date().getFullYear())-I})();return o.jsxs("div",{className:`relative rounded-2xl cursor-pointer transition-all duration-300 ${c?"ring-4 ring-blue-400 shadow-2xl scale-105":"shadow-lg hover:shadow-xl hover:scale-102"}`,style:{width:u,height:f,backgroundColor:n==="dark"?"#1f2937":"#ffffff",border:`2px solid ${c?p.accent:n==="dark"?"#374151":"#e5e7eb"}`,zIndex:c?100:1,background:`linear-gradient(135deg, ${p.secondary} 0%, ${n==="dark"?"#1f2937":"#ffffff"} 100%)`},onClick:w,children:[o.jsxs("div",{className:"absolute top-0 left-0 right-0 h-8 rounded-t-2xl flex items-center justify-between px-3",style:{background:`linear-gradient(90deg, ${x} 0%, ${p.accent} 100%)`,boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[o.jsxs("div",{className:"flex items-center space-x-1",children:[e.familyRole==="patriarch"&&o.jsx(mh,{size:14,color:"white"}),e.familyRole==="matriarch"&&o.jsx(mh,{size:14,color:"white"}),e.isRoot&&o.jsx(m0,{size:14,color:"white"}),e.generation!==void 0&&o.jsxs("span",{className:"text-xs text-white font-medium",children:["G",e.generation]})]}),o.jsxs("div",{className:"flex items-center space-x-1",children:[e.relationshipStatus==="married"&&o.jsx(br,{size:12,color:"white"}),e.spouses&&e.spouses.length>0&&o.jsx(br,{size:12,color:"white"}),e.children&&e.children.length>0&&o.jsx(ta,{size:12,color:"white"})]})]}),o.jsx("div",{className:"absolute top-12 left-1/2 transform -translate-x-1/2",children:o.jsx("div",{className:"w-16 h-16 rounded-full border-4 border-white shadow-md flex items-center justify-center",style:{backgroundColor:p.primary},children:g?o.jsx(Aa,{size:24,color:"white"}):h?o.jsx(Xt,{size:24,className:"w-6 h-6"}):o.jsx(Xt,{size:24,color:"white"})})}),o.jsxs("div",{className:"absolute top-32 left-0 right-0 text-center px-4",children:[o.jsx("p",{className:"font-bold text-lg truncate mb-1",style:{color:n==="dark"?"#f9fafb":"#111827",lineHeight:"1.2",margin:"0",padding:"0",border:"none",outline:"none",background:"transparent",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.name}),(k||e.birthDate)&&o.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[o.jsx(Lr,{size:12,color:n==="dark"?"#9ca3af":"#6b7280"}),o.jsxs("span",{className:"text-xs",style:{color:n==="dark"?"#9ca3af":"#6b7280",lineHeight:"1.2",margin:"0",padding:"0",border:"none",outline:"none",background:"transparent",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[k?`${k} `:new Date(e.birthDate).getFullYear(),e.deathDate&&` - ${new Date(e.deathDate).getFullYear()}`]})]}),e.occupation&&o.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[o.jsx(Xt,{size:12,color:n==="dark"?"#9ca3af":"#6b7280"}),o.jsx("span",{className:"text-xs truncate",style:{color:n==="dark"?"#9ca3af":"#6b7280",lineHeight:"1.2",margin:"0",padding:"0",border:"none",outline:"none",background:"transparent",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.occupation})]}),e.birthPlace&&o.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[o.jsx(ei,{size:12,color:n==="dark"?"#9ca3af":"#6b7280"}),o.jsx("span",{className:"text-xs truncate",style:{color:n==="dark"?"#9ca3af":"#6b7280",lineHeight:"1.2",margin:"0",padding:"0",border:"none",outline:"none",background:"transparent",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.birthPlace})]})]}),o.jsxs("div",{className:"absolute top-10 right-2 flex flex-col space-y-1",children:[e.spouses&&e.spouses.length>0&&o.jsxs("div",{className:"flex items-center space-x-1 bg-pink-100 dark:bg-pink-900 px-2 py-1 rounded-full shadow-sm",children:[o.jsx(br,{size:8,color:"#ec4899"}),o.jsx("span",{className:"text-xs font-medium",style:{color:"#ec4899",lineHeight:"1.2",margin:"0",padding:"0",border:"none",outline:"none",background:"transparent",overflow:"hidden",textOverflow:"ellipsis"},children:e.spouses.length})]}),e.children&&e.children.length>0&&o.jsxs("div",{className:"flex items-center space-x-1 bg-blue-100 dark:bg-blue-900 px-2 py-1 rounded-full shadow-sm",children:[o.jsx(ta,{size:8,color:"#3b82f6"}),o.jsx("span",{className:"text-xs font-medium",style:{color:"#3b82f6",lineHeight:"1.2",margin:"0",padding:"0",border:"none",outline:"none",background:"transparent",overflow:"hidden",textOverflow:"ellipsis"},children:e.children.length})]}),e.siblings&&e.siblings.length>0&&o.jsxs("div",{className:"flex items-center space-x-1 bg-green-100 dark:bg-green-900 px-2 py-1 rounded-full shadow-sm",children:[o.jsx(kn,{size:8,color:"#10b981"}),o.jsx("span",{className:"text-xs font-medium",style:{color:"#10b981",lineHeight:"1.2",margin:"0",padding:"0",border:"none",outline:"none",background:"transparent",overflow:"hidden",textOverflow:"ellipsis"},children:e.siblings.length})]})]}),o.jsxs("div",{className:"absolute bottom-0 left-0 right-0 flex rounded-b-2xl overflow-hidden",children:[o.jsxs("div",{className:"flex-1 flex items-center justify-center py-2 cursor-pointer hover:opacity-80 transition-opacity",style:{backgroundColor:p.primary},onClick:I=>{var R;I.stopPropagation(),(R=e.onSelectPerson)==null||R.call(e,e.id)},children:[o.jsx(ra,{size:14,color:"white",className:"mr-1"}),o.jsx("span",{className:"text-white text-xs font-medium",style:{lineHeight:"1.2",margin:"0",padding:"0",border:"none",outline:"none",background:"transparent",overflow:"hidden",textOverflow:"ellipsis"},children:r==="ar"?"":"View"})]}),o.jsxs("div",{className:"flex-1 flex items-center justify-center py-2 cursor-pointer hover:opacity-80 transition-opacity",style:{backgroundColor:"#10b981"},onClick:I=>{var R;I.stopPropagation(),(R=e.onAddChild)==null||R.call(e,e.id)},children:[o.jsx(Yu,{size:14,color:"white",className:"mr-1"}),o.jsx("span",{className:"text-white text-xs font-medium",style:{lineHeight:"1.2",margin:"0",padding:"0",border:"none",outline:"none",background:"transparent",overflow:"hidden",textOverflow:"ellipsis"},children:r==="ar"?"":"Add"})]})]}),e.gender==="male"&&(e.spouses&&e.spouses.length>0||e.children&&e.children.length>0)&&o.jsx("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-6 h-6 rounded-full flex items-center justify-center cursor-pointer shadow-md z-20",style:{backgroundColor:p.primary},onClick:I=>{I.stopPropagation(),a(e.id)},children:e.isCollapsed?o.jsx(f0,{size:14,color:"white"}):o.jsx(c3,{size:14,color:"white"})}),c&&e.isOwnedTree&&o.jsxs("div",{className:"absolute flex items-center justify-center space-x-2 bg-white dark:bg-gray-800 rounded-xl shadow-2xl p-2 border-2",style:{top:-60,left:"50%",transform:"translateX(-50%)",zIndex:1e3,borderColor:p.accent},children:[o.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-pink-500 rounded-full cursor-pointer hover:bg-pink-600 transition-colors",onClick:I=>{var R;I.stopPropagation(),(R=e.onAddSpouse)==null||R.call(e,e.id)},title:r==="ar"?" /":"Add Spouse",children:o.jsx(br,{size:14,color:"white"})}),o.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-green-500 rounded-full cursor-pointer hover:bg-green-600 transition-colors",onClick:I=>{var R;I.stopPropagation(),(R=e.onAddChild)==null||R.call(e,e.id)},title:r==="ar"?" ":"Add Child",children:o.jsx(ta,{size:14,color:"white"})}),e.onAddSibling&&o.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-purple-500 rounded-full cursor-pointer hover:bg-purple-600 transition-colors",onClick:I=>{var R;I.stopPropagation(),(R=e.onAddSibling)==null||R.call(e,e.id)},title:r==="ar"?" /":"Add Sibling",children:o.jsx(kn,{size:14,color:"white"})}),o.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-yellow-500 rounded-full cursor-pointer hover:bg-yellow-600 transition-colors",onClick:I=>{var R;I.stopPropagation(),(R=e.onEditPerson)==null||R.call(e,e.id)},title:r==="ar"?"":"Edit",children:o.jsx(sa,{size:14,color:"white"})}),o.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-red-500 rounded-full cursor-pointer hover:bg-red-600 transition-colors",onClick:I=>{var R;I.stopPropagation(),(R=e.onDeletePerson)==null||R.call(e,e.id)},title:r==="ar"?"":"Delete",children:o.jsx($a,{size:14,color:"white"})})]}),o.jsx(Oi,{type:"target",position:Tt.Top,style:{background:p.primary,width:12,height:12,zIndex:10,border:"2px solid white",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},isConnectable:!0}),o.jsx(Oi,{type:"source",position:Tt.Bottom,style:{background:p.primary,width:12,height:12,zIndex:10,border:"2px solid white",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},isConnectable:!0}),o.jsx(Oi,{type:"source",position:Tt.Right,style:{background:"#ec4899",width:12,height:12,zIndex:10,right:-6,top:"50%",transform:"translateY(-50%)",border:"2px solid white",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},isConnectable:!0,id:"spouse"}),o.jsx(Oi,{type:"target",position:Tt.Left,style:{background:"#ec4899",width:12,height:12,zIndex:10,left:-6,top:"50%",transform:"translateY(-50%)",border:"2px solid white",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},isConnectable:!0,id:"spouse"})]})},$0e=({data:e,id:t})=>{const{theme:n}=Ft(),{isMobile:r}=_r(),{selectedNodeId:s,setSelectedNodeId:i,toggleNodeCollapse:l}=wj(),a=s===e.id,c=e.spouses||[],d=Math.min(c.length,3),u=r?300:400,f=r?200:240,m=h=>{h.stopPropagation(),i(a?null:e.id)};return o.jsxs("div",{className:`relative rounded-2xl cursor-pointer transition-all duration-300 ${a?"ring-4 ring-pink-400 shadow-2xl scale-105":"shadow-lg hover:shadow-xl hover:scale-102"}`,style:{width:u,height:f,backgroundColor:n==="dark"?"#1f2937":"#ffffff",border:`2px solid ${a?"#ec4899":n==="dark"?"#374151":"#e5e7eb"}`,zIndex:a?100:1,background:`linear-gradient(135deg, #fce7f3 0%, ${n==="dark"?"#1f2937":"#ffffff"} 100%)`},onClick:m,children:[o.jsx("div",{className:"absolute top-0 left-0 right-0 h-10 rounded-t-2xl flex items-center justify-center",style:{background:"linear-gradient(90deg, #ec4899 0%, #f472b6 100%)",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(br,{size:16,color:"white"}),o.jsx("span",{className:"text-white font-bold text-sm",style:{lineHeight:"1.2",margin:"0",padding:"0",border:"none",outline:"none",background:"transparent",overflow:"hidden",textOverflow:"ellipsis"},children:" "}),o.jsx(br,{size:16,color:"white"})]})}),o.jsx("div",{className:"absolute top-12 left-5 right-5 bottom-16 flex space-x-2",children:c.slice(0,d).map((h,g)=>{var w;const y=((w=h.attributes)==null?void 0:w.gender)||h.gender||"unknown",p=y==="male",x=y==="female",b={primary:p?"#3b82f6":x?"#ec4899":"#6b7280",secondary:p?"#dbeafe":x?"#fce7f3":"#f3f4f6"};return o.jsxs("div",{className:"flex-1 relative rounded-xl border-2 overflow-hidden",style:{borderColor:b.primary,background:`linear-gradient(135deg, ${b.secondary} 0%, ${n==="dark"?"#374151":"#ffffff"} 100%)`},children:[o.jsx("div",{className:"h-6 flex items-center justify-center",style:{backgroundColor:b.primary},children:o.jsx("span",{className:"text-white text-xs font-medium",style:{lineHeight:"1.2",margin:"0",padding:"0",border:"none",outline:"none",background:"transparent",overflow:"hidden",textOverflow:"ellipsis"},children:p?"":x?"":""})}),o.jsx("div",{className:"flex justify-center mt-2",children:h.photo?o.jsx("img",{src:h.photo,alt:h.name,className:"w-12 h-12 rounded-full border-2 border-white shadow-md object-cover"}):o.jsx("div",{className:"w-12 h-12 rounded-full border-2 border-white shadow-md flex items-center justify-center",style:{backgroundColor:b.primary},children:p?o.jsx(Aa,{size:16,color:"white"}):x?o.jsx(th,{size:16,className:"w-4 h-4"}):o.jsx(Xt,{size:16,color:"white"})})}),o.jsxs("div",{className:"text-center mt-2 px-2",children:[o.jsx("p",{className:"font-bold text-sm truncate",style:{color:n==="dark"?"#f9fafb":"#111827",lineHeight:"1.2",margin:"0",padding:"0",border:"none",outline:"none",background:"transparent",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:h.name}),h.birthDate&&o.jsxs("div",{className:"flex items-center justify-center mt-1",children:[o.jsx(Lr,{size:10,color:n==="dark"?"#9ca3af":"#6b7280"}),o.jsx("span",{className:"text-xs ml-1",style:{color:n==="dark"?"#9ca3af":"#6b7280",lineHeight:"1.2",margin:"0",padding:"0",border:"none",outline:"none",background:"transparent",overflow:"hidden",textOverflow:"ellipsis"},children:new Date(h.birthDate).getFullYear()})]})]}),o.jsxs("div",{className:"absolute bottom-2 left-2 right-2 flex space-x-1",children:[o.jsx("button",{className:"flex-1 py-1 rounded text-xs text-white font-medium hover:opacity-80 transition-opacity",style:{backgroundColor:b.primary},onClick:N=>{var k;N.stopPropagation(),(k=e.onSelectPerson)==null||k.call(e,h.id)},children:o.jsx("span",{style:{lineHeight:"1.2",margin:"0",padding:"0",border:"none",outline:"none",background:"transparent",overflow:"hidden",textOverflow:"ellipsis"},children:""})}),o.jsx("button",{className:"flex-1 py-1 rounded text-xs text-white font-medium bg-green-500 hover:opacity-80 transition-opacity",onClick:N=>{var k;N.stopPropagation(),(k=e.onAddChild)==null||k.call(e,h.id)},children:o.jsx("span",{style:{lineHeight:"1.2",margin:"0",padding:"0",border:"none",outline:"none",background:"transparent",overflow:"hidden",textOverflow:"ellipsis"},children:""})})]})]},h.id)})}),o.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex items-center space-x-2",children:c.length>1&&o.jsxs(o.Fragment,{children:[o.jsxs("div",{className:"flex items-center space-x-1 bg-pink-100 dark:bg-pink-900 px-3 py-1 rounded-full",children:[o.jsx(br,{size:12,color:"#ec4899"}),o.jsxs("span",{className:"text-xs font-medium",style:{color:"#ec4899",lineHeight:"1.2",margin:"0",padding:"0",border:"none",outline:"none",background:"transparent",overflow:"hidden",textOverflow:"ellipsis"},children:[c.length," "]})]}),e.children&&e.children.length>0&&o.jsxs("div",{className:"flex items-center space-x-1 bg-blue-100 dark:bg-blue-900 px-3 py-1 rounded-full",children:[o.jsx(ta,{size:12,color:"#3b82f6"}),o.jsxs("span",{className:"text-xs font-medium",style:{color:"#3b82f6",lineHeight:"1.2",margin:"0",padding:"0",border:"none",outline:"none",background:"transparent"},children:[e.children.length," "]})]})]})}),a&&e.isOwnedTree&&o.jsxs("div",{className:"absolute flex items-center justify-center space-x-2 bg-white dark:bg-gray-800 rounded-xl shadow-2xl p-2 border-2 border-pink-400",style:{top:-60,left:"50%",transform:"translateX(-50%)",zIndex:1e3},children:[o.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-pink-500 rounded-full cursor-pointer hover:bg-pink-600 transition-colors",onClick:h=>{var g;h.stopPropagation(),c.length>0&&((g=e.onAddSpouse)==null||g.call(e,c[0].id))},title:" / ",children:o.jsx(br,{size:14,color:"white"})}),o.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-green-500 rounded-full cursor-pointer hover:bg-green-600 transition-colors",onClick:h=>{var g;h.stopPropagation(),c.length>0&&((g=e.onAddChild)==null||g.call(e,c[0].id))},title:"  ",children:o.jsx(ta,{size:14,color:"white"})}),o.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-yellow-500 rounded-full cursor-pointer hover:bg-yellow-600 transition-colors",onClick:h=>{var g;h.stopPropagation(),c.length>0&&((g=e.onEditPerson)==null||g.call(e,c[0].id))},title:" ",children:o.jsx(sa,{size:14,color:"white"})})]}),e.gender==="male"&&(e.spouses&&e.spouses.length>0||e.children&&e.children.length>0)&&o.jsx("div",{className:"absolute -top-3 left-1/2 transform -translate-x-1/2 w-6 h-6 rounded-full flex items-center justify-center cursor-pointer shadow-md z-20",style:{backgroundColor:"#ec4899"},onClick:h=>{h.stopPropagation(),l(e.id)},children:e.isCollapsed?o.jsx(f0,{size:14,color:"white"}):o.jsx(c3,{size:14,color:"white"})}),o.jsx(Oi,{type:"target",position:Tt.Top,style:{background:"#ec4899",width:14,height:14,zIndex:10,border:"2px solid white",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},isConnectable:!0}),o.jsx(Oi,{type:"source",position:Tt.Bottom,style:{background:"#ec4899",width:14,height:14,zIndex:10,border:"2px solid white",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},isConnectable:!0}),o.jsx(Oi,{type:"source",position:Tt.Right,style:{background:"#ec4899",width:14,height:14,zIndex:10,right:-7,top:"50%",transform:"translateY(-50%)",border:"2px solid white",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},isConnectable:!0,id:"spouse"}),o.jsx(Oi,{type:"target",position:Tt.Left,style:{background:"#ec4899",width:14,height:14,zIndex:10,left:-7,top:"50%",transform:"translateY(-50%)",border:"2px solid white",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},isConnectable:!0,id:"spouse"})]})},O0e={person:R0e,combinedSpouse:$0e},aD=({persons:e,rootPersonId:t,onSelectPerson:n,onEditPerson:r,onDeletePerson:s,onAddChild:i,onAddSpouse:l,onAddFather:a,onAddMother:c,onAddSibling:d,relationships:u,dataVersion:f=0,isOwnedTree:m=!1})=>{const h=jr(),[g,y,p]=vle([]),[x,b,w]=ble([]),{theme:N,language:k}=Ft(),{isMobile:I}=_r(),[R,T]=J.useState(null),[S,E]=J.useState(null),[_,M]=J.useState(null),[A,P]=J.useState(new Set),[B,L]=J.useState(!1),[D,V]=J.useState(()=>{const ge=localStorage.getItem("familyTreeManualConnections");return ge?JSON.parse(ge):[]}),O=J.useRef({}),[H,W]=J.useState(()=>{const ge=localStorage.getItem("familyTreeCustomPositions");return ge?JSON.parse(ge):{}}),[$,z]=J.useState({}),[q,G]=J.useState(null),[re,oe]=J.useState(!1),ie=J.useCallback(ge=>{const Me=e.find(_e=>_e.id.toString()===ge);Me&&(G(Me),oe(!0))},[e]),Y=J.useCallback(()=>{oe(!1),G(null)},[]),te=J.useCallback((ge,Me,_e=new Set)=>{if(_e.has(ge))return[];_e.add(ge);const ke=Me.get(ge)||[];let se=[...ke];return ke.forEach(Ae=>{const Re=te(Ae,Me,_e);se=[...se,...Re]}),se},[]),we=J.useCallback(ge=>{const Me=new Map,_e=new Map;e.forEach(ke=>{var Ce,ve,Be;const se=ke.id.toString(),Ae=ke,Re=Ae.parentIds||Ae.parents||Ae.parent_ids||((Ce=Ae.relationships)==null?void 0:Ce.parents)||[];if(Re&&Re.length>0)if(Array.isArray(Re))Re.forEach(le=>{var Te,at;let fe="";typeof le=="object"&&(le!=null&&le.id)?fe=le.id.toString():(typeof le=="string"||typeof le=="number")&&(fe=le.toString()),fe&&(Me.has(fe)||Me.set(fe,[]),(Te=Me.get(fe))!=null&&Te.includes(se)||(at=Me.get(fe))==null||at.push(se))});else{let le="";typeof Re=="object"&&(Re!=null&&Re.id)?le=Re.id.toString():(typeof Re=="string"||typeof Re=="number")&&(le=Re.toString()),le&&(Me.has(le)||Me.set(le,[]),(ve=Me.get(le))!=null&&ve.includes(se)||(Be=Me.get(le))==null||Be.push(se))}if(Ae.relationships&&Array.isArray(Ae.relationships)){const le=Ae.relationships.filter(fe=>(fe.relationshipType==="Spouse"||fe.relationshipType==="spouse"||fe.relationshipType==="Husband"||fe.relationshipType==="husband"||fe.relationshipType==="Wife"||fe.relationshipType==="wife")&&(fe.personId.toString()===se||fe.relatedPersonId.toString()===se));le&&le.length>0&&le.forEach(fe=>{var at,je;let Te="";if(fe.personId.toString()===se?Te=fe.relatedPersonId.toString():fe.relatedPersonId.toString()===se&&(Te=fe.personId.toString()),Te){_e.has(se)||_e.set(se,[]);const he=_e.get(se)!==void 0?_e.get(se):[];(!he||!he.includes(Te))&&((at=_e.get(se))==null||at.push(Te)),_e.has(Te)||_e.set(Te,[]);const Pe=_e.get(Te)!==void 0?_e.get(Te):[];Pe&&!Pe.includes(se)&&((je=_e.get(Te))==null||je.push(se))}})}ke.relationships&&ke.relationships.spouses&&ke.relationships.spouses.forEach(le=>{var Te,at,je;let fe="";if(typeof le=="object"&&(le!=null&&le.person)?typeof le.person=="object"&&((Te=le.person)!=null&&Te.id)?fe=le.person.id.toString():typeof le.person=="string"&&(fe=le.person.toString()):typeof le=="string"&&(fe=le.toString()),fe&&fe!==se&&!(_e.get(se)||[]).includes(fe)){_e.has(se)||_e.set(se,[]),(at=_e.get(se))==null||at.push(fe),_e.has(fe)||_e.set(fe,[]);const Pe=_e.get(fe)!==void 0?_e.get(fe):[];Pe&&!Pe.includes(se)&&((je=_e.get(fe))==null||je.push(se))}}),Ae.spouseIds&&Array.isArray(Ae.spouseIds)&&Ae.spouseIds.forEach(le=>{var Te,at;const fe=le.toString();if(fe&&fe!==se&&!(_e.get(se)||[]).includes(fe)){_e.has(se)||_e.set(se,[]),(Te=_e.get(se))==null||Te.push(fe),_e.has(fe)||_e.set(fe,[]);const he=_e.get(fe)!==void 0?_e.get(fe):[];he&&!he.includes(se)&&((at=_e.get(fe))==null||at.push(se))}})}),u&&Array.isArray(u)&&u.forEach(ke=>{var se,Ae,Re,Ce,ve,Be;if(ke.relationshipType==="Spouse"||ke.relationshipType==="spouse"||ke.relationshipType==="Husband"||ke.relationshipType==="husband"||ke.relationshipType==="Wife"||ke.relationshipType==="wife"){const le=ke.personId.toString(),fe=ke.relatedPersonId.toString();_e.has(le)||_e.set(le,[]);const Te=_e.get(le)!==void 0?_e.get(le):[];(!Te||!Te.includes(fe))&&((se=_e.get(le))==null||se.push(fe)),_e.has(fe)||_e.set(fe,[]);const at=_e.get(fe)!==void 0?_e.get(fe):[];at&&!at.includes(le)&&((Ae=_e.get(fe))==null||Ae.push(le))}else if(ke.relationshipType==="Father"||ke.relationshipType==="father"||ke.relationshipType==="Mother"||ke.relationshipType==="mother"||ke.relationshipType==="Parent"||ke.relationshipType==="parent"){const le=ke.personId.toString(),fe=ke.relatedPersonId.toString();Me.has(fe)||Me.set(fe,[]),(Re=Me.get(fe))!=null&&Re.includes(le)||(Ce=Me.get(fe))==null||Ce.push(le)}else if(ke.relationshipType==="Child"||ke.relationshipType==="child"||ke.relationshipType==="Son"||ke.relationshipType==="son"||ke.relationshipType==="Daughter"||ke.relationshipType==="daughter"){const le=ke.personId.toString(),fe=ke.relatedPersonId.toString();Me.has(le)||Me.set(le,[]),(ve=Me.get(le))!=null&&ve.includes(fe)||(Be=Me.get(le))==null||Be.push(fe)}}),P(ke=>{const se=new Set(ke);if(se.has(ge)){se.delete(ge);const Ae=te(ge,Me);Ae.forEach(Ce=>{se.delete(Ce)}),(_e.get(ge)||[]).forEach(Ce=>{se.delete(Ce)}),y(Ce=>Ce.map(ve=>{const Be=$[ve.id];return Be&&(ve.id===ge||Ae.includes(ve.id))?{...ve,position:Be}:ve}))}else y(Ce=>{const ve={},Be=te(ge,Me);return Ce.forEach(le=>{(le.id===ge||Be.includes(le.id))&&(ve[le.id]={...le.position})}),z(le=>({...le,...ve})),Ce}),se.add(ge),te(ge,Me).forEach(Ce=>{se.add(Ce)}),(_e.get(ge)||[]).forEach(Ce=>{se.add(Ce)});return se})},[e,u,te]),me=J.useMemo(()=>{if(!e||e.length===0)return{flowNodes:[],flowEdges:[]};const ge=new Map;e.forEach(je=>{var Pe,ot,tt,qe,ze,it;const he=je;ge.set(je.id.toString(),{id:je.id.toString(),name:`${je.firstName||""} ${je.lastName||""}`.trim()||"Unknown",gender:je.gender||"unknown",birthDate:((Pe=he.birth)==null?void 0:Pe.date)||he.birthDate||"",deathDate:((ot=he.death)==null?void 0:ot.date)||he.deathDate||"",birthPlace:((tt=he.birth)==null?void 0:tt.place)||he.birthPlace||"",occupation:((ze=(qe=he.occupation)==null?void 0:qe[0])==null?void 0:ze.title)||he.occupation||"",photo:((it=he.primaryPhoto)==null?void 0:it.url)||he.photo||"",children:[],spouses:[],siblings:[],parents:[],relationshipStatus:"single",marriageDate:"",generation:0,familyRole:"child"})});const Me=new Map,_e=new Map,ke=new Map;e.forEach(je=>{var tt,qe,ze,it;const he=je.id.toString(),Pe=je,ot=Pe.parentIds||Pe.parents||Pe.parent_ids||((tt=Pe.relationships)==null?void 0:tt.parents)||[];if(ot&&ot.length>0)if(Array.isArray(ot))ot.forEach(st=>{var ut,mt,Ht,Kt;let Ve="";typeof st=="object"&&(st!=null&&st.id)?Ve=st.id.toString():(typeof st=="string"||typeof st=="number")&&(Ve=st.toString()),Ve&&(Me.has(he)||Me.set(he,[]),(ut=Me.get(he))!=null&&ut.includes(Ve)||(mt=Me.get(he))==null||mt.push(Ve),_e.has(Ve)||_e.set(Ve,[]),(Ht=_e.get(Ve))!=null&&Ht.includes(he)||(Kt=_e.get(Ve))==null||Kt.push(he))});else{let st="";typeof ot=="object"&&(ot!=null&&ot.id)?st=ot.id.toString():(typeof ot=="string"||typeof ot=="number")&&(st=ot.toString()),st&&(Me.has(he)||Me.set(he,[]),(qe=Me.get(he))==null||qe.push(st),_e.has(st)||_e.set(st,[]),(ze=_e.get(st))!=null&&ze.includes(he)||(it=_e.get(st))==null||it.push(he))}if(Pe.relationships&&Array.isArray(Pe.relationships)){const st=Pe.relationships.filter(Ve=>(Ve.relationshipType==="Spouse"||Ve.relationshipType==="spouse"||Ve.relationshipType==="Husband"||Ve.relationshipType==="husband"||Ve.relationshipType==="Wife"||Ve.relationshipType==="wife")&&(Ve.personId.toString()===he||Ve.relatedPersonId.toString()===he));st&&st.length>0&&st.forEach(Ve=>{var mt,Ht;let ut="";if(Ve.personId.toString()===he?ut=Ve.relatedPersonId.toString():Ve.relatedPersonId.toString()===he&&(ut=Ve.personId.toString()),ut){ke.has(he)||ke.set(he,[]);const Kt=ke.get(he)!==void 0?ke.get(he):[];(!Kt||!Kt.includes(ut))&&((mt=ke.get(he))==null||mt.push(ut)),ke.has(ut)||ke.set(ut,[]);const jn=ke.get(ut)!==void 0?ke.get(ut):[];jn&&!jn.includes(he)&&((Ht=ke.get(ut))==null||Ht.push(he))}})}je.relationships&&je.relationships.spouses&&je.relationships.spouses.forEach(st=>{var ut,mt,Ht;let Ve="";if(typeof st=="object"&&(st!=null&&st.person)?typeof st.person=="object"&&((ut=st.person)!=null&&ut.id)?Ve=st.person.id.toString():typeof st.person=="string"&&(Ve=st.person.toString()):typeof st=="string"&&(Ve=st.toString()),Ve&&Ve!==he&&!(ke.get(he)||[]).includes(Ve)){ke.has(he)||ke.set(he,[]),(mt=ke.get(he))==null||mt.push(Ve),ke.has(Ve)||ke.set(Ve,[]);const jn=ke.get(Ve)!==void 0?ke.get(Ve):[];jn&&!jn.includes(he)&&((Ht=ke.get(Ve))==null||Ht.push(he))}}),Pe.spouseIds&&Array.isArray(Pe.spouseIds)&&Pe.spouseIds.forEach(st=>{var ut,mt;const Ve=st.toString();if(Ve&&Ve!==he&&!(ke.get(he)||[]).includes(Ve)){ke.has(he)||ke.set(he,[]),(ut=ke.get(he))==null||ut.push(Ve),ke.has(Ve)||ke.set(Ve,[]);const Kt=ke.get(Ve)!==void 0?ke.get(Ve):[];Kt&&!Kt.includes(he)&&((mt=ke.get(Ve))==null||mt.push(he))}})}),u&&Array.isArray(u)&&u.forEach(je=>{var he,Pe,ot,tt,qe,ze,it,st,Ve,ut;if(je.relationshipType==="Spouse"||je.relationshipType==="spouse"||je.relationshipType==="Husband"||je.relationshipType==="husband"||je.relationshipType==="Wife"||je.relationshipType==="wife"){const mt=je.personId.toString(),Ht=je.relatedPersonId.toString();ke.has(mt)||ke.set(mt,[]);const Kt=ke.get(mt)!==void 0?ke.get(mt):[];(!Kt||!Kt.includes(Ht))&&((he=ke.get(mt))==null||he.push(Ht)),ke.has(Ht)||ke.set(Ht,[]);const jn=ke.get(Ht)!==void 0?ke.get(Ht):[];jn&&!jn.includes(mt)&&((Pe=ke.get(Ht))==null||Pe.push(mt))}else if(je.relationshipType==="Father"||je.relationshipType==="father"||je.relationshipType==="Mother"||je.relationshipType==="mother"||je.relationshipType==="Parent"||je.relationshipType==="parent"){const mt=je.personId.toString(),Ht=je.relatedPersonId.toString();Me.has(mt)||Me.set(mt,[]),(ot=Me.get(mt))!=null&&ot.includes(Ht)||(tt=Me.get(mt))==null||tt.push(Ht),_e.has(Ht)||_e.set(Ht,[]),(qe=_e.get(Ht))!=null&&qe.includes(mt)||(ze=_e.get(Ht))==null||ze.push(mt)}else if(je.relationshipType==="Child"||je.relationshipType==="child"||je.relationshipType==="Son"||je.relationshipType==="son"||je.relationshipType==="Daughter"||je.relationshipType==="daughter"){const mt=je.personId.toString(),Ht=je.relatedPersonId.toString();Me.has(Ht)||Me.set(Ht,[]),(it=Me.get(Ht))!=null&&it.includes(mt)||(st=Me.get(Ht))==null||st.push(mt),_e.has(mt)||_e.set(mt,[]),(Ve=_e.get(mt))!=null&&Ve.includes(Ht)||(ut=_e.get(mt))==null||ut.push(Ht)}});const se=[],Ae=new Set;if(Me.forEach((je,he)=>{Ae.add(he)}),t){const je=ge.get(t);je&&se.push(je);const he=new Set,Pe=[t];for(;Pe.length>0;){const ot=Pe.shift();if(he.has(ot))continue;he.add(ot),(_e.get(ot)||[]).forEach(it=>{he.has(it)||Pe.push(it)}),(Me.get(ot)||[]).forEach(it=>{he.has(it)||Pe.push(it)}),(ke.get(ot)||[]).forEach(it=>{he.has(it)||Pe.push(it)})}e.forEach(ot=>{const tt=ot.id.toString();if(!he.has(tt)&&!Ae.has(tt)){const qe=ge.get(tt);qe&&se.push(qe)}})}else e.forEach(je=>{const he=je.id.toString();if(!Ae.has(he)){const Pe=ge.get(he);Pe&&se.push(Pe)}});const Re=new Set;e.forEach(je=>{const he=je.id.toString(),Pe=ge.get(he);(Me.get(he)||[]).forEach(tt=>{const qe=`${tt}-${he}`;if(Re.has(qe))return;Re.add(qe);const ze=ge.get(tt);ze&&Pe&&(ze.children.some(st=>st.id===Pe.id)||ze.children.push(Pe))})});const Ce=new Set;e.forEach(je=>{const he=je.id.toString();(_e.get(he)||[]).forEach(ot=>{const tt=Me.get(ot)||[];if(tt.length>1){const qe=new Set;tt.forEach(ze=>{tt.forEach(it=>{var st,Ve;if(ze!==it){const ut=[ze,it].sort().join("-");if(!qe.has(ut)){qe.add(ut);const mt=`${ze}-${it}`;if(Ce.has(mt))return;Ce.add(mt);const Ht=ke.get(ze)||[],Kt=ke.get(it)||[];Ht.includes(it)||(ke.has(ze)||ke.set(ze,[]),(st=ke.get(ze))==null||st.push(it)),Kt.includes(ze)||(ke.has(it)||ke.set(it,[]),(Ve=ke.get(it))==null||Ve.push(ze))}}})})}})});const ve=[],Be=[],le=new Map,fe=je=>je;return(()=>{const je=new Map,he=qe=>{var mt;const ze=ge.get(qe);if(!ze)return{horizontal:200,vertical:80};const it=ze.children.length,st=((mt=ke.get(qe))==null?void 0:mt.length)||0;let Ve=200,ut=80;return it>2&&(Ve=180+it*20),st>1&&(Ve=Math.max(Ve,150+st*80)),{horizontal:Ve,vertical:ut}},Pe=new Set,ot=(qe,ze,it,st)=>{const Ve=fe(qe.id);if(it>50){console.warn("Maximum depth reached for node processing, stopping recursion");return}if(Pe.has(Ve))return;if(Pe.add(Ve),le.has(Ve)){ze&&(Be.some(wt=>wt.source===ze&&wt.target===Ve)||Be.push({id:`${ze}-${Ve}`,source:ze,target:Ve,type:"bezier",markerEnd:{type:mi.Arrow},style:{strokeWidth:2}}));return}le.set(Ve,Ve);const ut=ke.get(qe.id)||[],mt=_e.get(qe.id)||[],Ht=Me.get(qe.id)||[];let Kt="child";it===0&&mt.length>0?Kt=qe.gender==="female"?"matriarch":"patriarch":mt.length>0?Kt="parent":ut.length>0&&(Kt="spouse");const jn=ut.map(pt=>{const wt=ge.get(pt);return wt?{id:wt.id,name:wt.name,gender:wt.gender,birthDate:wt.birthDate,photo:wt.photo}:null}).filter(Boolean),wn=mt.map(pt=>{const wt=ge.get(pt);return wt?{id:wt.id,name:wt.name,gender:wt.gender}:null}).filter(Boolean),It=new Set;Ht.forEach(pt=>{(_e.get(pt)||[]).forEach(Vt=>{Vt!==qe.id&&It.add(Vt)})});const Rr=Array.from(It).map(pt=>{const wt=ge.get(pt);return wt?{id:wt.id,name:wt.name,gender:wt.gender}:null}).filter(Boolean),Vr=H[Ve],Sr=Vr||{x:st.x,y:st.y},We={id:Ve,type:"person",position:Sr,data:{id:qe.id,name:qe.name,gender:qe.gender,birthDate:qe.birthDate,deathDate:qe.deathDate,birthPlace:qe.birthPlace,occupation:qe.occupation,photo:qe.photo,isCombinedSpouseNode:!1,spouses:jn,spouseIds:ut,children:wn,siblings:Rr,relationshipStatus:ut.length>0?"married":"single",isOwnedTree:m,onEditPerson:r,onDeletePerson:s,onAddChild:i,onAddSpouse:l,onAddFather:a,onAddMother:c,onAddSibling:d,onSelectPerson:ie,navigate:h,isCollapsed:A.has(qe.id),isRoot:it===0,generation:it,familyRole:Kt}};je.set(Ve,{node:We,parentId:ze,depth:it,position:st,children:[],spouses:[]}),ve.push(We),ze&&Be.push({id:`${ze}-${Ve}`,source:ze,target:Ve,type:"bezier",markerEnd:{type:mi.Arrow},style:{strokeWidth:2}});const Ue=ke.get(qe.id)||[];if(Ue.length>0){const wt=(Ue.length-1)*150;let Vt=st.x-wt/2;Ue.length>1&&(We.position.x=st.x),Ue.forEach((St,bt)=>{const jt=ge.get(St);if(jt){let an;if(Ue.length===1)an=st.x+150;else if(bt<Math.floor(Ue.length/2))an=Vt+bt*150;else if(bt===Math.floor(Ue.length/2)&&Ue.length%2===1)an=st.x+150;else{const on=bt-Math.floor(Ue.length/2)-Ue.length%2;an=st.x+150+on*150}const Mn={x:an,y:st.y};ot(jt,null,it,Mn);const Xe=[Ve,St].sort().join("-");Be.some(on=>on.id===Xe)||Be.push({id:Xe,source:Ve,target:St,type:"straight",style:{stroke:"#ec4899",strokeWidth:2},markerEnd:{type:mi.Arrow,color:"#ec4899"},sourceHandle:"spouse",targetHandle:"spouse"});const yt=je.get(Ve);yt&&yt.spouses.push(St)}})}if(!A.has(qe.id)){const pt=he(qe.id),wt=new Map,Vt=[];qe.children.forEach(bt=>{let jt=null;if(u&&Array.isArray(u)){const an=u.find(Mn=>Mn.personId.toString()===bt.id&&(Mn.relationshipType==="Mother"||Mn.relationshipType==="mother"));an&&(jt=an.relatedPersonId.toString())}jt&&Ue.includes(jt)?(wt.has(jt)||wt.set(jt,[]),wt.get(jt).push(bt)):Vt.push(bt)});let St=0;Ue.forEach(bt=>{(wt.get(bt)||[]).forEach(an=>{ge.get(bt);const Mn=fe(bt),Xe=je.get(Mn);let Zt=st.x;Xe&&(Zt=Xe.position.x);const yt={x:Zt+St*pt.horizontal-(qe.children.length-1)*(pt.horizontal/2),y:st.y+pt.vertical};ot(an,Ve,it+1,yt);const on=je.get(Ve);if(on&&on.children.push(fe(an.id)),(Me.get(an.id)||[]).forEach(Qt=>{const vt=fe(Qt),$t=fe(an.id);if(!Be.some(zt=>zt.source===vt&&zt.target===$t)&&le.has(vt)){const zt=ge.get(Qt),Pn=(zt==null?void 0:zt.gender)==="female"?"#ec4899":"#3b82f6";Be.push({id:`${vt}-${$t}`,source:vt,target:$t,type:"bezier",style:{stroke:Pn,strokeWidth:2},markerEnd:{type:mi.Arrow,color:Pn}})}}),qe.gender==="male"&&Ue.length>0){const Qt=an.id;let vt=null;if(u&&Array.isArray(u)){const $t=u.find(Yt=>Yt.personId.toString()===Qt&&(Yt.relationshipType==="Mother"||Yt.relationshipType==="mother"));$t&&(vt=$t.relatedPersonId.toString())}if(!vt&&Ue.length>0&&(vt=Ue[0]),vt){const $t=fe(vt),Yt=fe(Qt);!Be.some(Pn=>Pn.source===$t&&Pn.target===Yt)&&le.has($t)&&Be.push({id:`mother-${$t}-${Yt}`,source:$t,target:Yt,type:"smoothstep",style:{stroke:"#ec4899",strokeWidth:2,strokeDasharray:"5,5"},markerEnd:{type:mi.Arrow,color:"#ec4899"}})}}St++})}),Vt.forEach(bt=>{const jt={x:st.x+St*pt.horizontal-(qe.children.length-1)*(pt.horizontal/2),y:st.y+pt.vertical};ot(bt,Ve,it+1,jt);const an=je.get(Ve);an&&an.children.push(fe(bt.id)),(Me.get(bt.id)||[]).forEach(Xe=>{const Zt=fe(Xe),yt=fe(bt.id);if(!Be.some(rn=>rn.source===Zt&&rn.target===yt)&&le.has(Zt)){const rn=ge.get(Xe),Qt=(rn==null?void 0:rn.gender)==="female"?"#ec4899":"#3b82f6";Be.push({id:`parent-${Zt}-${yt}`,source:Zt,target:yt,type:"bezier",style:{stroke:Qt,strokeWidth:2},markerEnd:{type:mi.Arrow,color:Qt}})}}),St++})}};let tt=0;return se.forEach(qe=>{const ze=he(qe.id),it={x:tt*ze.horizontal*1.5,y:0};ot(qe,null,0,it),tt++}),e.forEach(qe=>{const ze=qe.id.toString(),it=fe(ze);if(!le.has(it)){const st=ge.get(ze);if(st){const Ve=Me.get(ze)||[];if(!Ve.some(mt=>A.has(mt))){const mt=_e.has(ze)&&_e.get(ze).length>0,Ht=Ve.some(Kt=>le.has(fe(Kt)));if(!mt&&!Ht){const Kt=he(ze),jn={x:tt*Kt.horizontal*.8,y:0};ot(st,null,0,jn),tt++}else if(Ht){const Kt=Ve.find(jn=>le.has(fe(jn)));if(Kt){const jn=je.get(fe(Kt));if(jn){const wn=jn.position,It=he(ze),Rr={x:wn.x,y:wn.y+It.vertical};ot(st,fe(Kt),jn.depth+1,Rr)}}}}}}}),{flowNodes:ve,flowEdges:Be}})(),{flowNodes:P0e(ve,Be,{rankdir:"TB",nodeWidth:280,nodeHeight:220,ranker:"network-simplex"}),flowEdges:Be}},[e,u,m,r,s,i,l,a,c,h,A,ie,H]);J.useEffect(()=>{if(me){const{flowNodes:ge,flowEdges:Me}=me,_e=new Map;Me.forEach(Be=>{var le;if(((le=Be.style)==null?void 0:le.stroke)==="#ec4899"){const fe=[Be.source,Be.target].sort().join("-");_e.has(fe)||_e.set(fe,Be)}});const ke=Array.from(_e.values()),Ae=[...Me.filter(Be=>{var le;return((le=Be.style)==null?void 0:le.stroke)!=="#ec4899"}),...ke],Re=D.map((Be,le)=>({id:`manual-${Be.source}-${Be.target}-${le}`,source:Be.source,target:Be.target,type:"smoothstep",markerEnd:{type:mi.Arrow},style:{stroke:"#8b5cf6",strokeWidth:2}}));let Ce=[...Ae,...Re];S&&(Ce=Ce.map(Be=>{var le,fe;if(Be.source===S||Be.target===S){const Te=typeof((le=Be.style)==null?void 0:le.strokeWidth)=="number"?Be.style.strokeWidth:2;return{...Be,animated:!0,style:{...Be.style,stroke:((fe=Be.style)==null?void 0:fe.stroke)==="#ec4899"?"#ff6b9d":"#a78bfa",strokeWidth:Te+1,filter:"drop-shadow(0 0 4px rgba(167, 139, 250, 0.7))"}}}return Be})),y(ge),b(Ce);const ve={};ge.forEach(Be=>{ve[Be.id]={...Be.position}}),O.current=ve}},[me,y,b,A,D,S]),J.useCallback(()=>{V([]),localStorage.removeItem("familyTreeManualConnections"),b(ge=>ge.filter(Me=>!Me.id.startsWith("manual-")))},[b]);const Ee=J.useCallback(ge=>{V(_e=>{const ke=[..._e,ge];return localStorage.setItem("familyTreeManualConnections",JSON.stringify(ke)),ke});const Me={id:`manual-${ge.source}-${ge.target}-${Date.now()}`,source:ge.source,target:ge.target,type:"smoothstep",markerEnd:{type:mi.Arrow},style:{stroke:"#8b5cf6",strokeWidth:2}};b(_e=>f$(Me,_e))},[b,V]),pe=J.useCallback((ge,Me,_e)=>{y(ke=>ke.map(se=>se.id===Me.id?{...se,position:{x:Me.position.x,y:Me.position.y}}:se))},[y]),ee=J.useCallback(()=>{y(ge=>{const Me={},_e={};return ge.forEach(ke=>{Me[ke.id]={...ke.position},_e[ke.id]={...ke.position}}),O.current=Me,W(_e),localStorage.setItem("familyTreeCustomPositions",JSON.stringify(_e)),ge})},[y]),ft=async()=>{if(R)try{const ge=document.querySelector(".react-flow");if(!ge){console.error("ReactFlow container not found");return}const{getViewport:Me,fitView:_e,setViewport:ke}=R,se=Me();_e({duration:0,padding:.5,includeHiddenNodes:!0}),await new Promise(it=>setTimeout(it,150));const Ae=ge.querySelector(".react-flow__controls"),Re=ge.querySelector(".react-flow__minimap"),Ce=document.querySelector(".absolute.z-20"),ve=Ae?Ae.getAttribute("style"):null,Be=Re?Re.getAttribute("style"):null;Ae&&Ae.setAttribute("style","display: none !important"),Re&&Re.setAttribute("style","display: none !important"),Ce&&Ce.setAttribute("style","display: none !important");const le=ge,fe=ge.querySelector(".react-flow__viewport"),Te=fe?fe.getAttribute("style"):null,at=le?le.getAttribute("style"):null,je=R.getNodes().reduce((it,st)=>{const{x:Ve,y:ut}=st.position;return{minX:Math.min(it.minX,Ve),minY:Math.min(it.minY,ut),maxX:Math.max(it.maxX,Ve+300),maxY:Math.max(it.maxY,ut+250)}},{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}),he=100,Pe={minX:je.minX-he,minY:je.minY-he,maxX:je.maxX+he,maxY:je.maxY+he};fe&&(fe.style.width=`${Pe.maxX-Pe.minX}px`,fe.style.height=`${Pe.maxY-Pe.minY}px`),le&&(le.style.width=`${Pe.maxX-Pe.minX}px`,le.style.height=`${Pe.maxY-Pe.minY}px`),ke({x:-Pe.minX,y:-Pe.minY,zoom:1}),await new Promise(it=>setTimeout(it,150));const ot=(Pe.maxX-Pe.minX)*2,tt=(Pe.maxY-Pe.minY)*2,qe=await jA.toPng(le,{quality:1,width:ot,height:tt,bgcolor:N==="dark"?"#1f2937":"#ffffff",style:{backgroundColor:N==="dark"?"#1f2937":"#ffffff",transform:"scale(2)",transformOrigin:"top left",boxShadow:"none",border:"none",outline:"none",width:`${Pe.maxX-Pe.minX}px`,height:`${Pe.maxY-Pe.minY}px`}});Ae&&(ve?Ae.setAttribute("style",ve):Ae.removeAttribute("style")),Re&&(Be?Re.setAttribute("style",Be):Re.removeAttribute("style")),Ce&&Ce.removeAttribute("style"),fe&&(Te?fe.setAttribute("style",Te):fe.removeAttribute("style")),le&&(at?le.setAttribute("style",at):le.removeAttribute("style")),ke(se);const ze=new Image;ze.src=qe,ze.onload=()=>{const it=ze.width,st=ze.height,Ve=new qt({orientation:it>st?"landscape":"portrait",unit:"px",format:[it,st]});Ve.addImage(qe,"PNG",0,0,it,st),Ve.save("family_tree.pdf")}}catch(ge){console.error("Error generating PDF:",ge)}},$e=async()=>{if(R)try{const ge=document.querySelector(".react-flow");if(!ge){console.error("ReactFlow container not found");return}const{getViewport:Me,fitView:_e,setViewport:ke}=R,se=Me();_e({duration:0,padding:.5,includeHiddenNodes:!0}),await new Promise(it=>setTimeout(it,150));const Ae=ge.querySelector(".react-flow__controls"),Re=ge.querySelector(".react-flow__minimap"),Ce=document.querySelector(".absolute.z-20"),ve=Ae?Ae.getAttribute("style"):null,Be=Re?Re.getAttribute("style"):null;Ae&&Ae.setAttribute("style","display: none !important"),Re&&Re.setAttribute("style","display: none !important"),Ce&&Ce.setAttribute("style","display: none !important");const le=ge,fe=ge.querySelector(".react-flow__viewport"),Te=fe?fe.getAttribute("style"):null,at=le?le.getAttribute("style"):null,je=R.getNodes().reduce((it,st)=>{const{x:Ve,y:ut}=st.position;return{minX:Math.min(it.minX,Ve),minY:Math.min(it.minY,ut),maxX:Math.max(it.maxX,Ve+300),maxY:Math.max(it.maxY,ut+250)}},{minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}),he=100,Pe={minX:je.minX-he,minY:je.minY-he,maxX:je.maxX+he,maxY:je.maxY+he};fe&&(fe.style.width=`${Pe.maxX-Pe.minX}px`,fe.style.height=`${Pe.maxY-Pe.minY}px`),le&&(le.style.width=`${Pe.maxX-Pe.minX}px`,le.style.height=`${Pe.maxY-Pe.minY}px`),ke({x:-Pe.minX,y:-Pe.minY,zoom:1}),await new Promise(it=>setTimeout(it,150));const ot=(Pe.maxX-Pe.minX)*2,tt=(Pe.maxY-Pe.minY)*2,qe=await jA.toPng(le,{quality:1,width:ot,height:tt,bgcolor:N==="dark"?"#1f2937":"#ffffff",style:{backgroundColor:N==="dark"?"#1f2937":"#ffffff",transform:"scale(2)",transformOrigin:"top left",boxShadow:"none",border:"none",outline:"none",width:`${Pe.maxX-Pe.minX}px`,height:`${Pe.maxY-Pe.minY}px`}});Ae&&(ve?Ae.setAttribute("style",ve):Ae.removeAttribute("style")),Re&&(Be?Re.setAttribute("style",Be):Re.removeAttribute("style")),Ce&&Ce.removeAttribute("style"),fe&&(Te?fe.setAttribute("style",Te):fe.removeAttribute("style")),le&&(at?le.setAttribute("style",at):le.removeAttribute("style")),ke(se);const ze=document.createElement("a");ze.href=qe,ze.download="family_tree.png",document.body.appendChild(ze),ze.click(),document.body.removeChild(ze)}catch(ge){console.error("Error generating image:",ge)}},De=()=>{try{let ge=`ID,First Name,Last Name,Gender,Birth Date,Death Date,Birth Place,Occupation,Photo URL,Parents,Spouses,Children
`;e.forEach(se=>{var le,fe,Te,at,je,he;const Ae=se,Re=(Ae.parentIds||Ae.parents||[]).join(";"),Ce=(Ae.spouseIds||[]).join(";"),ve=(u||[]).filter(Pe=>Pe.personId===se.id&&(Pe.relationshipType==="Child"||Pe.relationshipType==="child"||Pe.relationshipType==="Son"||Pe.relationshipType==="son"||Pe.relationshipType==="Daughter"||Pe.relationshipType==="daughter")).map(Pe=>Pe.relatedPersonId).join(";"),Be=[`"${se.id}"`,`"${se.firstName||""}"`,`"${se.lastName||""}"`,`"${se.gender||""}"`,`"${((le=Ae.birth)==null?void 0:le.date)||Ae.birthDate||""}"`,`"${((fe=Ae.death)==null?void 0:fe.date)||Ae.deathDate||""}"`,`"${((Te=Ae.birth)==null?void 0:Te.place)||Ae.birthPlace||""}"`,`"${((je=(at=Ae.occupation)==null?void 0:at[0])==null?void 0:je.title)||Ae.occupation||""}"`,`"${((he=Ae.primaryPhoto)==null?void 0:he.url)||Ae.photo||""}"`,`"${Re}"`,`"${Ce}"`,`"${ve}"`].join(",");ge+=Be+`
`});const Me=new Blob(["\uFEFF",ge],{type:"text/csv;charset=utf-8;"}),_e=URL.createObjectURL(Me),ke=document.createElement("a");ke.href=_e,ke.download="family_tree.csv",document.body.appendChild(ke),ke.click(),document.body.removeChild(ke),URL.revokeObjectURL(_e)}catch(ge){console.error("Error generating CSV:",ge)}};return o.jsx(iD.Provider,{value:{selectedNodeId:S,setSelectedNodeId:E,collapsedNodes:A,toggleNodeCollapse:we},children:o.jsx(X4,{children:o.jsxs("div",{className:"w-full h-full relative",children:[o.jsxs("div",{className:`absolute z-20 flex flex-col gap-3 ${I?"top-2 right-2 gap-2":"top-6 right-6 gap-3"}`,children:[o.jsxs("div",{className:"flex flex-col gap-2",children:[o.jsx("button",{className:`px-2 py-1 text-xs rounded-md font-medium text-white transition-all duration-200 shadow-md ${R?"bg-red-500 hover:bg-red-600":"bg-gray-400 cursor-not-allowed"}`,onClick:ft,title:k==="ar"?" PDF":"Export PDF",disabled:!R,children:o.jsx(eh,{size:14})}),o.jsx("button",{className:`px-2 py-1 text-xs rounded-md font-medium text-white transition-all duration-200 shadow-md ${R?"bg-blue-500 hover:bg-blue-600":"bg-gray-400 cursor-not-allowed"}`,onClick:$e,title:k==="ar"?" ":"Export Image",disabled:!R,children:o.jsx(eh,{size:14})}),o.jsx("button",{className:"px-2 py-1 text-xs rounded-md font-medium bg-green-500 text-white hover:bg-green-600 transition-all duration-200 shadow-md",onClick:De,title:k==="ar"?" CSV":"Export CSV",children:o.jsx(eh,{size:14})})]}),o.jsxs("div",{className:"flex flex-col gap-2",children:[o.jsx("button",{className:"px-2 py-1 text-xs rounded-md font-medium bg-gray-500 text-white hover:bg-gray-600 transition-all duration-200 shadow-md",onClick:()=>R&&R.zoomIn({duration:200}),title:k==="ar"?"":"Zoom In",disabled:!R,children:o.jsx(kH,{size:14})}),o.jsx("button",{className:"px-2 py-1 text-xs rounded-md font-medium bg-gray-500 text-white hover:bg-gray-600 transition-all duration-200 shadow-md",onClick:()=>R&&R.zoomOut({duration:200}),title:k==="ar"?"":"Zoom Out",disabled:!R,children:o.jsx(EH,{size:14})}),o.jsx("button",{className:"px-2 py-1 text-xs rounded-md font-medium bg-gray-500 text-white hover:bg-gray-600 transition-all duration-200 shadow-md",onClick:()=>R&&R.fitView({duration:500,padding:.1}),title:k==="ar"?" ":"Fit View",disabled:!R,children:o.jsx(CI,{size:14})})]})]}),o.jsxs(W$,{nodes:g,edges:x,onNodesChange:p,onEdgesChange:w,onConnect:Ee,onNodeDrag:pe,onNodeDragStop:ee,nodeTypes:O0e,edgeTypes:{custom:L0e},defaultEdgeOptions:{type:"custom",markerEnd:{type:mi.Arrow},style:{strokeWidth:2}},style:{zIndex:1},fitView:!0,nodesDraggable:!0,nodesConnectable:B,elementsSelectable:!0,selectNodesOnDrag:!1,connectionLineStyle:{stroke:"#8b5cf6",strokeWidth:3},minZoom:.05,maxZoom:2,defaultViewport:{x:0,y:0,zoom:.3},onNodeClick:(ge,Me)=>{E(Me.id)},onInit:T,onPaneClick:()=>{E(null)},children:[o.jsx(Ule,{variant:Fi.Dots,gap:20,size:2,color:N==="dark"?"#374151":"#e5e7eb"}),o.jsx(Ole,{position:"bottom-left",style:{backgroundColor:N==="dark"?"#1f2937":"#ffffff",border:`1px solid ${N==="dark"?"#374151":"#e5e7eb"}`,borderRadius:"6px",padding:"4px",display:"flex",gap:"4px"}}),o.jsx(Ple,{nodeColor:ge=>{if(ge.type==="person"){const Me=ge.data;return Me.gender==="male"?"#3b82f6":Me.gender==="female"?"#ec4899":"#6b7280"}return"#6b7280"},maskColor:N==="dark"?"rgba(31, 41, 55, 0.7)":"rgba(248, 250, 252, 0.7)",nodeBorderRadius:2,nodeStrokeWidth:2,position:"bottom-right"})]}),o.jsx(M0e,{person:q,isOpen:re,onClose:Y,persons:e,relationships:u||[]})]})})})},oD=({person:e,isOpen:t,onClose:n})=>{const{language:r}=Ft(),{isMobile:s}=_r(),i=r==="ar",[l,a]=J.useState("info");if(!t||!e)return null;const d=((N,k)=>{if(!N)return null;let I;try{if(N.includes("T"))I=new Date(N);else if(N.includes("-")){const E=N.split("-");E.length===3?I=new Date(parseInt(E[0]),parseInt(E[1])-1,parseInt(E[2])):I=new Date(N)}else if(N.includes("/")){const E=N.split("/");E.length===3?I=new Date(parseInt(E[2]),parseInt(E[0])-1,parseInt(E[1])):I=new Date(N)}else I=new Date(N)}catch{return null}if(isNaN(I.getTime()))return null;let R;if(k&&k.trim()!=="")try{if(k.includes("T"))R=new Date(k);else if(k.includes("-")){const E=k.split("-");E.length===3?R=new Date(parseInt(E[0]),parseInt(E[1])-1,parseInt(E[2])):R=new Date(k)}else if(k.includes("/")){const E=k.split("/");E.length===3?R=new Date(parseInt(E[2]),parseInt(E[0])-1,parseInt(E[1])):R=new Date(k)}else R=new Date(k);isNaN(R.getTime())&&(R=new Date)}catch{R=new Date}else R=new Date;let T=R.getFullYear()-I.getFullYear();const S=R.getMonth()-I.getMonth();return(S<0||S===0&&R.getDate()<I.getDate())&&T--,T>=0?T:0})(e.birthDate,e.deathDate),u=e.gender||"unknown",f=u==="male",m=u==="female",h=()=>i?`${e.firstName} ${e.lastName}`:`${e.firstNameEn||e.firstName} ${e.lastNameEn||e.lastName}`,g=e.parents&&e.parents.length>0||e.parentIds&&e.parentIds.length>0,y=e.spouses&&e.spouses.length>0||e.spouseIds&&e.spouseIds.length>0,p=e.childrenDetails&&e.childrenDetails.length>0||e.children&&e.children.length>0,x=!!(e.parents&&e.parents.length>0),b=!!(e.spouses&&e.spouses.length>0),w=!!(e.childrenDetails&&e.childrenDetails.length>0);return console.log("Person data for tabs:",{hasParents:g,hasSpouses:y,hasChildren:p,showDetailedSpouses:b,parents:e.parents,parentIds:e.parentIds,spouses:e.spouses,spouseIds:e.spouseIds,childrenDetails:e.childrenDetails,children:e.children}),o.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:N=>{N.target===N.currentTarget&&n()},children:o.jsxs("div",{className:"relative rounded-3xl shadow-2xl max-h-[95vh] overflow-hidden animate-in fade-in-0 zoom-in-95 duration-300",style:{width:s?"95vw":"600px",background:"linear-gradient(135deg, #ffffff 0%, #f8fafc 100%)",border:"2px solid #e2e8f0"},onClick:N=>N.stopPropagation(),children:[o.jsxs("div",{className:"relative h-32 overflow-hidden",style:{background:f?"linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)":m?"linear-gradient(135deg, #ec4899 0%, #be185d 100%)":"linear-gradient(135deg, #6b7280 0%, #374151 100%)"},children:[o.jsx("button",{onClick:N=>{N.preventDefault(),N.stopPropagation(),n()},className:"absolute top-4 right-4 w-10 h-10 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center hover:bg-white/30 transition-all duration-200 group z-10",type:"button",children:o.jsx(ia,{size:20,className:"text-white group-hover:scale-110 transition-transform"})}),o.jsx("div",{className:"absolute -top-10 -right-10 w-32 h-32 rounded-full bg-white/10"}),o.jsx("div",{className:"absolute -bottom-5 -left-5 w-20 h-20 rounded-full bg-white/5"})]}),o.jsxs("div",{className:"relative -mt-16 px-6 pb-6",children:[o.jsx("div",{className:"flex justify-center mb-4",children:o.jsx("div",{className:"w-24 h-24 rounded-full border-4 border-white shadow-xl flex items-center justify-center relative overflow-hidden",style:{background:f?"linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)":m?"linear-gradient(135deg, #ec4899 0%, #be185d 100%)":"linear-gradient(135deg, #6b7280 0%, #374151 100%)"},children:e.avatar?o.jsx("img",{src:e.avatar,alt:h(),className:"w-full h-full rounded-full object-cover"}):o.jsx("div",{className:"flex items-center justify-center w-full h-full",children:f?o.jsx(Aa,{size:40,color:"white",strokeWidth:1.5}):m?o.jsx(th,{size:40,color:"white",strokeWidth:1.5}):o.jsx(Xt,{size:40,color:"white",strokeWidth:1.5})})})}),o.jsxs("div",{className:"text-center mb-6",children:[o.jsx("h2",{className:"text-2xl font-bold mb-2",style:{color:"#111827"},children:h()}),o.jsxs("div",{className:"flex flex-wrap justify-center gap-2 mb-4",children:[o.jsx("div",{className:"px-3 py-1 rounded-full text-xs font-medium",style:{backgroundColor:f?"#dbeafe":m?"#fce7f3":"#f3f4f6",color:f?"#1d4ed8":m?"#be185d":"#374151"},children:f?i?"":"Male":m?i?"":"Female":i?" ":"Unknown"}),d!==null&&o.jsxs("div",{className:"px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[d," ",i?"":"years old"]}),e.deathDate?o.jsx("div",{className:"px-3 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:i?"":"Deceased"}):o.jsx("div",{className:"px-3 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:i?"  ":"Living"}),o.jsx("div",{className:"px-3 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:i?` ${e.generation}`:`Gen ${e.generation}`})]})]}),o.jsxs("div",{className:`flex ${s?"flex-wrap gap-1 p-1 bg-muted rounded-lg mb-4":"border-b mb-4"}`,style:{minHeight:"40px"},children:[o.jsx("button",{onClick:()=>a("info"),className:`px-3 py-2 text-sm font-medium rounded-lg transition-colors ${l==="info"?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground"} ${s?"flex-1 text-xs py-1.5":""}`,style:{minWidth:"80px"},children:i?"":"Info"}),g&&o.jsxs("button",{onClick:()=>a("parents"),className:`px-3 py-2 text-sm font-medium rounded-lg transition-colors ${l==="parents"?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground"} ${s?"flex-1 text-xs py-1.5":""}`,style:{minWidth:"80px"},children:[i?"":"Parents",o.jsx("span",{className:"ml-1 bg-primary-foreground text-primary text-xs px-1.5 py-0.5 rounded-full",children:x&&e.parents?e.parents.filter((N,k,I)=>k===I.findIndex(R=>R.id===N.id)).length:e.parentIds?e.parentIds.filter((N,k,I)=>k===I.indexOf(N)).length:0})]}),y&&o.jsxs("button",{onClick:()=>a("spouses"),className:`px-3 py-2 text-sm font-medium rounded-lg transition-colors ${l==="spouses"?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground"} ${s?"flex-1 text-xs py-1.5":""}`,style:{minWidth:"80px"},children:[i?"/":"Spouses",o.jsx("span",{className:"ml-1 bg-primary-foreground text-primary text-xs px-1.5 py-0.5 rounded-full",children:b&&e.spouses?e.spouses.filter((N,k,I)=>k===I.findIndex(R=>R.id===N.id)).length:e.spouseIds?e.spouseIds.filter((N,k,I)=>k===I.indexOf(N)).length:0})]}),p&&o.jsxs("button",{onClick:()=>a("children"),className:`px-3 py-2 text-sm font-medium rounded-lg transition-colors ${l==="children"?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground"} ${s?"flex-1 text-xs py-1.5":""}`,style:{minWidth:"80px"},children:[i?"":"Children",o.jsx("span",{className:"ml-1 bg-primary-foreground text-primary text-xs px-1.5 py-0.5 rounded-full",children:w&&e.childrenDetails?e.childrenDetails.filter((N,k,I)=>k===I.findIndex(R=>R.id===N.id)).length:e.children?e.children.filter((N,k,I)=>k===I.indexOf(N)).length:0})]})]}),o.jsxs("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:[l==="info"&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"rounded-2xl p-4 border",style:{backgroundColor:"#f8fafc",borderColor:"#e2e8f0"},children:[o.jsxs("div",{className:"flex items-center mb-3",children:[o.jsx(Xt,{size:18,className:"mr-2 text-gray-600"}),o.jsx("h3",{className:"font-semibold",style:{color:"#111827"},children:i?" ":"Personal Information"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.birthDate&&o.jsxs("div",{className:"flex items-center",children:[o.jsx(Lr,{size:14,className:"mr-2 text-blue-500"}),o.jsxs("span",{style:{color:"#6b7280"},children:[o.jsx("strong",{children:i?" :":"Birth Date:"})," ",new Date(e.birthDate).toLocaleDateString(i?"ar-SA":"en-US")]})]}),e.deathDate&&o.jsxs("div",{className:"flex items-center",children:[o.jsx(Lr,{size:14,className:"mr-2 text-gray-500"}),o.jsxs("span",{style:{color:"#6b7280"},children:[o.jsx("strong",{children:i?" :":"Death Date:"})," ",new Date(e.deathDate).toLocaleDateString(i?"ar-SA":"en-US")]})]}),(e.birthPlace||e.birthPlaceEn)&&o.jsxs("div",{className:"flex items-center",children:[o.jsx(ei,{size:14,className:"mr-2 text-green-500"}),o.jsxs("span",{style:{color:"#6b7280"},children:[o.jsx("strong",{children:i?" :":"Birth Place:"})," ",i?e.birthPlace:e.birthPlaceEn]})]}),(e.occupation||e.occupationEn)&&o.jsxs("div",{className:"flex items-center",children:[o.jsx(hl,{size:14,className:"mr-2 text-purple-500"}),o.jsxs("span",{style:{color:"#6b7280"},children:[o.jsx("strong",{children:i?":":"Occupation:"})," ",i?e.occupation:e.occupationEn]})]})]})]}),e.photos&&e.photos.length>0||e.documents&&e.documents.length>0?o.jsxs("div",{className:"rounded-2xl p-4 border",style:{backgroundColor:"#f8fafc",borderColor:"#e2e8f0"},children:[o.jsxs("div",{className:"flex items-center mb-3",children:[o.jsx(Ru,{size:18,className:"mr-2 text-gray-600"}),o.jsx("h3",{className:"font-semibold",style:{color:"#111827"},children:i?"":"Attachments"})]}),o.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.photos&&e.photos.length>0&&o.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[o.jsx(Yh,{size:14,className:"mr-1 text-purple-500"}),o.jsxs("span",{children:[e.photos.length," ",i?"":"Photos"]})]}),e.documents&&e.documents.length>0&&o.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[o.jsx(Ru,{size:14,className:"mr-1 text-gray-500"}),o.jsxs("span",{children:[e.documents.length," ",i?"":"Documents"]})]})]})]}):null]}),l==="parents"&&g&&o.jsxs("div",{className:"rounded-2xl p-4 border",style:{backgroundColor:"#f8fafc",borderColor:"#e2e8f0"},children:[o.jsxs("div",{className:"flex items-center mb-3",children:[o.jsx(rg,{size:18,className:"mr-2 text-blue-500"}),o.jsx("h3",{className:"font-semibold",style:{color:"#111827"},children:i?"":"Parents"}),o.jsx("span",{className:"ml-2 px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:x&&e.parents?e.parents.filter((N,k,I)=>k===I.findIndex(R=>R.id===N.id)).length:e.parentIds?e.parentIds.filter((N,k,I)=>k===I.indexOf(N)).length:0})]}),o.jsx("div",{className:"space-y-2",children:x&&e.parents?e.parents.filter((N,k,I)=>k===I.findIndex(R=>R.id===N.id)).map((N,k)=>o.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[o.jsx(Xt,{size:14,className:"mr-2 text-blue-500"}),o.jsxs("span",{children:[N.name," (",N.relationship,")"]})]},`parent-${N.id}-${k}`)):e.parentIds&&e.parentIds.length>0?e.parentIds.filter((N,k,I)=>k===I.indexOf(N)).map((N,k)=>o.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[o.jsx(Xt,{size:14,className:"mr-2 text-blue-500"}),o.jsx("span",{children:i?` ${k+1}`:`Parent ${k+1}`})]},`parent-id-${N}-${k}`)):null})]}),l==="spouses"&&y&&o.jsxs("div",{className:"rounded-2xl p-4 border",style:{backgroundColor:"#f8fafc",borderColor:"#e2e8f0"},children:[o.jsxs("div",{className:"flex items-center mb-3",children:[o.jsx(br,{size:18,className:"mr-2 text-red-500"}),o.jsx("h3",{className:"font-semibold",style:{color:"#111827"},children:i?"/":"Spouses"}),o.jsx("span",{className:"ml-2 px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:b&&e.spouses?e.spouses.filter((N,k,I)=>k===I.findIndex(R=>R.id===N.id)).length:e.spouseIds?e.spouseIds.filter((N,k,I)=>k===I.indexOf(N)).length:0})]}),o.jsx("div",{className:"space-y-2",children:b&&e.spouses?e.spouses.filter((N,k,I)=>k===I.findIndex(R=>R.id===N.id)).map((N,k)=>o.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[o.jsx(Xt,{size:14,className:"mr-2 text-red-500"}),o.jsx("span",{children:N.name})]},`spouse-${N.id}-${k}`)):e.spouseIds&&e.spouseIds.length>0?e.spouseIds.filter((N,k,I)=>k===I.indexOf(N)).map((N,k)=>o.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[o.jsx(Xt,{size:14,className:"mr-2 text-red-500"}),o.jsx("span",{children:i?`/ ${k+1}`:`Spouse ${k+1}`})]},`spouse-id-${N}-${k}`)):null})]}),l==="children"&&p&&o.jsxs("div",{className:"rounded-2xl p-4 border",style:{backgroundColor:"#f8fafc",borderColor:"#e2e8f0"},children:[o.jsxs("div",{className:"flex items-center mb-3",children:[o.jsx(ta,{size:18,className:"mr-2 text-blue-500"}),o.jsx("h3",{className:"font-semibold",style:{color:"#111827"},children:i?"":"Children"}),o.jsx("span",{className:"ml-2 px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:w&&e.childrenDetails?e.childrenDetails.filter((N,k,I)=>k===I.findIndex(R=>R.id===N.id)).length:e.children?e.children.filter((N,k,I)=>k===I.indexOf(N)).length:0})]}),o.jsx("div",{className:"space-y-2",children:w&&e.childrenDetails?e.childrenDetails.filter((N,k,I)=>k===I.findIndex(R=>R.id===N.id)).map((N,k)=>o.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[o.jsx(Xt,{size:14,className:"mr-2 text-blue-500"}),o.jsx("span",{children:N.name})]},`child-${N.id}-${k}`)):e.children&&e.children.length>0?e.children.filter((N,k,I)=>k===I.indexOf(N)).map((N,k)=>o.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[o.jsx(Xt,{size:14,className:"mr-2 text-blue-500"}),o.jsx("span",{children:i?` ${k+1}`:`Child ${k+1}`})]},`child-id-${N}-${k}`)):null})]})]})]})]})})},F0e=({isOpen:e,onClose:t,treeId:n,treeName:r,treePersons:s})=>{const{language:i}=Ft(),{user:l}=Mr(),a=i==="ar";be.useEffect(()=>{if(e){const p=localStorage.getItem("user");if(localStorage.getItem("authToken"),p)try{const x=JSON.parse(p)}catch{}}},[e,l]),be.useEffect(()=>()=>{},[]),be.useEffect(()=>{},[e]);const[c,d]=J.useState({name:"",birthDate:"",birthPlace:"",gender:"Male",occupation:"",relatedPersonId:"",relationshipType:""}),[u,f]=J.useState(!1),m=[{value:"Father",label:a?"":"Father"},{value:"Mother",label:a?"":"Mother"},{value:"Son",label:a?"":"Son"},{value:"Daughter",label:a?"":"Daughter"},{value:"Brother",label:a?"":"Brother"},{value:"Sister",label:a?"":"Sister"},{value:"Grandfather",label:a?"":"Grandfather"},{value:"Grandmother",label:a?"":"Grandmother"},{value:"Grandson",label:a?"":"Grandson"},{value:"Granddaughter",label:a?"":"Granddaughter"},{value:"Uncle",label:a?"/":"Uncle"},{value:"Aunt",label:a?"/":"Aunt"},{value:"Nephew",label:a?" /":"Nephew"},{value:"Niece",label:a?" /":"Niece"},{value:"Cousin",label:a?" /":"Cousin"},{value:"Spouse",label:a?"/":"Spouse"}],h=p=>{const{name:x,value:b}=p.target;d(w=>({...w,[x]:b}))},g=async p=>{p.preventDefault(),f(!0);try{if(!c.name||!c.birthDate||!c.birthPlace||!c.occupation||!c.relatedPersonId||!c.relationshipType){tn.error({en:"All fields are required",ar:"  "}),f(!1);return}const x=parseInt(n);if(isNaN(x)||x<=0){tn.error({en:"Invalid tree ID",ar:"   "}),f(!1);return}const b=parseInt(c.relatedPersonId);if(isNaN(b)||b<=0){tn.error({en:"Invalid related person ID",ar:"    "}),f(!1);return}const N=(()=>{if(l&&typeof l=="object"&&l.id!==void 0){if(typeof l.id=="string"&&l.id.length>0)return l.id;if(typeof l.id=="number"){const k=l.id.toString();if(k.length>0)return k}}try{const k=localStorage.getItem("user");if(k){const I=JSON.parse(k);if(I&&I.id!==void 0){if(typeof I.id=="string"&&I.id.length>0)return I.id;if(typeof I.id=="number"){const R=I.id.toString();if(R.length>0)return R}}}}catch{}try{const k=localStorage.getItem("authToken");if(k){const R=k.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),T=decodeURIComponent(atob(R).split("").map(function(_){return"%"+("00"+_.charCodeAt(0).toString(16)).slice(-2)}).join("")),S=JSON.parse(T),E=["sub","nameid","userId","id","jti"];for(const _ of E)if(S[_]!==void 0){if(typeof S[_]=="string"&&S[_].length>0)return S[_];if(typeof S[_]=="number"){const M=S[_].toString();if(M.length>0)return M}}}}catch{}return null})();if(!N){tn.error({en:"You must be logged in to send a join request",ar:"     "}),f(!1);return}await At.createJoinRequest(x,c.name,c.birthDate,c.birthPlace,c.gender,c.occupation,b,"Pending",N,c.relationshipType),tn.success({en:"Join request sent successfully",ar:"    "}),t(),d({name:"",birthDate:"",birthPlace:"",gender:"Male",occupation:"",relatedPersonId:"",relationshipType:""})}catch(x){let b=a?`    : ${x.message}`:`Failed to send join request: ${x.message}`;x.message&&x.message.includes("A pending request already exists for this user and family tree")&&(b=a?"       ":"You already have a pending join request for this family tree"),tn.error({en:b,ar:b})}finally{f(!1)}},y=p=>a?`${p.firstName} ${p.lastName}`:`${p.firstNameEn} ${p.lastNameEn}`;return o.jsx(am,{isOpen:e,onClose:t,title:a?`   ${r}`:`Join Request for ${r}`,children:o.jsxs("form",{onSubmit:g,className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:a?" ":"Full Name"}),o.jsxs("div",{className:"relative",children:[o.jsx(Xt,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),o.jsx(Bt,{name:"name",value:c.name,onChange:h,placeholder:a?"  ":"Enter your full name",className:"pl-10",required:!0})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:a?" ":"Birth Date"}),o.jsxs("div",{className:"relative",children:[o.jsx(Lr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),o.jsx(Bt,{type:"date",name:"birthDate",value:c.birthDate,onChange:h,className:"pl-10",required:!0})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:a?"":"Gender"}),o.jsxs("select",{name:"gender",value:c.gender,onChange:h,className:"w-full border rounded-md px-3 py-2 text-sm bg-background text-foreground border-input",required:!0,children:[o.jsx("option",{value:"Male",children:a?"":"Male"}),o.jsx("option",{value:"Female",children:a?"":"Female"})]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:a?" ":"Birth Place"}),o.jsxs("div",{className:"relative",children:[o.jsx(ei,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),o.jsx(Bt,{name:"birthPlace",value:c.birthPlace,onChange:h,placeholder:a?"  ":"Enter birth place",className:"pl-10",required:!0})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:a?"":"Occupation"}),o.jsxs("div",{className:"relative",children:[o.jsx(hl,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),o.jsx(Bt,{name:"occupation",value:c.occupation,onChange:h,placeholder:a?" ":"Enter your occupation",className:"pl-10",required:!0})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:a?" ":"Related Person"}),o.jsxs("div",{className:"relative",children:[o.jsx(kn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),o.jsxs("select",{name:"relatedPersonId",value:c.relatedPersonId,onChange:h,className:"w-full border rounded-md px-10 py-2 text-sm bg-background text-foreground border-input",required:!0,children:[o.jsx("option",{value:"",children:a?" ":"Select Person"}),s.map(p=>o.jsx("option",{value:p.id,children:y(p)},p.id))]})]})]}),o.jsxs("div",{children:[o.jsx("label",{className:"block text-sm font-medium mb-1",children:a?" ":"Relationship Type"}),o.jsxs("select",{name:"relationshipType",value:c.relationshipType,onChange:h,className:"w-full border rounded-md px-3 py-2 text-sm bg-background text-foreground border-input",required:!0,children:[o.jsx("option",{value:"",children:a?"  ":"Select Relationship"}),m.map(p=>o.jsx("option",{value:p.value,children:p.label},p.value))]})]})]}),o.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[o.jsx(ye,{type:"button",variant:"outline",onClick:t,disabled:u,children:a?"":"Cancel"}),o.jsxs(ye,{type:"submit",disabled:u,className:"flex items-center gap-2",children:[u&&o.jsx(mr,{className:"h-4 w-4 animate-spin"}),a?" ":"Send Request"]})]})]})})},D0e=()=>{const{id:e}=pd(),t=jr(),{language:n}=Ft(),{currentTree:r,fetchPersonsInTree:s,isLoading:i,error:l,trees:a,publicTrees:c}=As(),{user:d}=Mr(),[u,f]=J.useState(null),[m,h]=J.useState(null),[g,y]=J.useState("tree"),[p,x]=J.useState(""),[b,w]=J.useState(!1),[N,k]=J.useState(!1),[I,R]=J.useState(!1),[T,S]=J.useState(null),[E,_]=J.useState(null),[M,A]=J.useState(null),[P,B]=J.useState(null),[L,D]=J.useState(null),V=J.useRef(null),[O,H]=J.useState(!1),[W,$]=J.useState("tree"),[z,q]=J.useState([]),[G,re]=J.useState([]),[oe,ie]=J.useState(!1),Y=n==="ar",{isMobile:te}=_r(),{limits:we,isLimitReached:me}=Oc(),[Ee,pe]=J.useState(0),[ee,ft]=J.useState(!1),[$e,De]=J.useState(null),[ge,Me]=J.useState(!1),[_e,ke]=J.useState(null);J.useEffect(()=>{},[]),J.useEffect(()=>{const We=localStorage.getItem("user");if(localStorage.getItem("authToken"),We)try{const Ue=JSON.parse(We)}catch{}},[d]);const se=()=>{if(d&&typeof d=="object"&&d.id!==void 0){if(typeof d.id=="string"&&d.id.length>0)return d.id;if(typeof d.id=="number"){const We=d.id.toString();if(We.length>0)return We}}try{const We=localStorage.getItem("user");if(We){const Ue=JSON.parse(We);if(Ue&&Ue.id!==void 0){if(typeof Ue.id=="string"&&Ue.id.length>0)return Ue.id;if(typeof Ue.id=="number"){const pt=Ue.id.toString();if(pt.length>0)return pt}}}}catch{}try{const We=localStorage.getItem("authToken");if(We){const pt=We.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),wt=decodeURIComponent(atob(pt).split("").map(function(bt){return"%"+("00"+bt.charCodeAt(0).toString(16)).slice(-2)}).join("")),Vt=JSON.parse(wt),St=["sub","nameid","userId","id","jti"];for(const bt of St)if(Vt[bt]!==void 0){if(typeof Vt[bt]=="string"&&Vt[bt].length>0)return Vt[bt];if(typeof Vt[bt]=="number"){const jt=Vt[bt].toString();if(jt.length>0)return jt}}}}catch{}return null},Ae=async()=>{if(!(!e||!wn))try{ie(!0);const We=await At.getIncomingJoinRequests(parseInt(e));q(We)}catch{tn.error({en:"Failed to load incoming requests",ar:"     "})}finally{ie(!1)}},Re=async()=>{const We=se();if(We)try{ie(!0);const Ue=await At.getOutgoingJoinRequests(We);re(Ue)}catch{tn.error({en:"Failed to load outgoing requests",ar:"     "})}finally{ie(!1)}};J.useEffect(()=>{if(O&&(!d||!d.id))try{const We=localStorage.getItem("user");if(We){const Ue=JSON.parse(We);Ue&&Ue.id}}catch{}},[O,d]),J.useEffect(()=>{(async()=>{var Ue;if(e)try{const pt=await s(e);let wt=[];try{wt=await At.getRelationships()}catch{}let St=a.find(Xe=>Xe.id===e)||c.find(Xe=>Xe.id===e)||r;if(!St)try{const Xe=await At.getTreeById(parseInt(e));Xe&&Xe.data&&(St={id:Xe.data.id.toString(),name:Xe.data.name,description:Xe.data.description||"",category:Xe.data.category||"family",tags:Xe.data.tags||[],settings:Xe.data.settings||{isPublic:!Xe.data.isPrivate,theme:"default",layout:"vertical",showPhotos:!0,showDates:!0,showPlaces:!0,allowComments:!0,allowSuggestions:!0},sharing:Xe.data.sharing||{isShared:Xe.data.members&&Xe.data.members.length>0||!1,allowedUsers:[],shareToken:void 0,publicUrl:void 0},stats:Xe.data.stats||{totalPeople:((Ue=Xe.data.members)==null?void 0:Ue.length)||0,totalGenerations:0,totalPhotos:0,completionPercentage:Xe.data.members&&Xe.data.members.length>0?50:0},createdAt:Xe.data.createdAt||new Date().toISOString(),updatedAt:Xe.data.updatedAt||new Date().toISOString(),ownerId:Xe.data.ownerId||(Xe.data.owner?Xe.data.owner.id:void 0),userRole:Xe.data.userRole||"viewer"})}catch{}const bt=new Map,jt=new Map;wt&&Array.isArray(wt)&&wt.forEach(Xe=>{var Zt,yt,on,rn;if(Xe.relationshipType==="Child"||Xe.relationshipType==="child"||Xe.relationshipType==="Son"||Xe.relationshipType==="son"||Xe.relationshipType==="Daughter"||Xe.relationshipType==="daughter"){const Qt=Xe.personId.toString(),vt=Xe.relatedPersonId.toString(),$t=pt.some(zt=>zt.id.toString()===Qt),Yt=pt.some(zt=>zt.id.toString()===vt);$t&&Yt&&(bt.has(vt)||bt.set(vt,[]),(Zt=bt.get(vt))==null||Zt.push(Qt),jt.has(Qt)||jt.set(Qt,[]),(yt=jt.get(Qt))==null||yt.push(vt))}else if(Xe.relationshipType==="Father"||Xe.relationshipType==="father"||Xe.relationshipType==="Mother"||Xe.relationshipType==="mother"||Xe.relationshipType==="Parent"||Xe.relationshipType==="parent"){const Qt=Xe.personId.toString(),vt=Xe.relatedPersonId.toString(),$t=pt.some(zt=>zt.id.toString()===vt),Yt=pt.some(zt=>zt.id.toString()===Qt);$t&&Yt&&(bt.has(Qt)||bt.set(Qt,[]),(on=bt.get(Qt))==null||on.push(vt),jt.has(vt)||jt.set(vt,[]),(rn=jt.get(vt))==null||rn.push(Qt))}}),pt.forEach(Xe=>{var yt,on,rn,Qt;if(["parentId","parent_id","fatherId","father_id","motherId","mother_id"].forEach(vt=>{var $t,Yt;if(Xe[vt]&&Xe[vt]!=="0"&&Xe[vt]!==0){const zt=Xe[vt].toString(),Pn=Xe.id.toString();pt.some(Fn=>Fn.id.toString()===zt)&&(bt.has(Pn)||bt.set(Pn,[]),($t=bt.get(Pn))==null||$t.push(zt),jt.has(zt)||jt.set(zt,[]),(Yt=jt.get(zt))==null||Yt.push(Pn))}}),Xe.parentIds&&Array.isArray(Xe.parentIds)&&Xe.parentIds.forEach(vt=>{var $t,Yt;if(vt&&vt!=="0"&&vt!==0){const zt=Xe.id.toString();pt.some(ln=>ln.id.toString()===vt.toString())&&(bt.has(zt)||bt.set(zt,[]),($t=bt.get(zt))==null||$t.push(vt.toString()),jt.has(vt.toString())||jt.set(vt.toString(),[]),(Yt=jt.get(vt.toString()))==null||Yt.push(zt))}}),Xe.relationships){if(Xe.relationships.father){let vt=null;if(typeof Xe.relationships.father=="string"?vt=Xe.relationships.father:typeof Xe.relationships.father=="object"&&Xe.relationships.father.id&&(vt=Xe.relationships.father.id.toString()),vt){const $t=Xe.id.toString();pt.some(zt=>zt.id.toString()===vt)&&(bt.has($t)||bt.set($t,[]),(yt=bt.get($t))==null||yt.push(vt),jt.has(vt)||jt.set(vt,[]),(on=jt.get(vt))==null||on.push($t))}}if(Xe.relationships.mother){let vt=null;if(typeof Xe.relationships.mother=="string"?vt=Xe.relationships.mother:typeof Xe.relationships.mother=="object"&&Xe.relationships.mother.id&&(vt=Xe.relationships.mother.id.toString()),vt){const $t=Xe.id.toString();pt.some(zt=>zt.id.toString()===vt)&&(bt.has($t)||bt.set($t,[]),(rn=bt.get($t))==null||rn.push(vt),jt.has(vt)||jt.set(vt,[]),(Qt=jt.get(vt))==null||Qt.push($t))}}}}),wt&&Array.isArray(wt)&&wt.forEach(Xe=>{var Qt,vt,$t,Yt,zt,Pn,ln,Fn;const Zt=(Qt=Xe.personId)==null?void 0:Qt.toString(),yt=(vt=Xe.relatedPersonId)==null?void 0:vt.toString(),on=pt.some(En=>En.id.toString()===Zt),rn=pt.some(En=>En.id.toString()===yt);if(!(!on||!rn))if(["Father","father","Mother","mother","Parent","parent"].includes(Xe.relationshipType)){const En=Zt,Bn=yt;bt.has(En)||bt.set(En,[]),($t=bt.get(En))==null||$t.push(Bn),jt.has(Bn)||jt.set(Bn,[]),(Yt=jt.get(Bn))==null||Yt.push(En)}else if(["Child","child","Son","son","Daughter","daughter"].includes(Xe.relationshipType)){const En=Zt,Bn=yt;bt.has(Bn)||bt.set(Bn,[]),(zt=bt.get(Bn))==null||zt.push(En),jt.has(En)||jt.set(En,[]),(Pn=jt.get(En))==null||Pn.push(Bn)}else if(["Spouse","spouse","Husband","husband","Wife","wife"].includes(Xe.relationshipType)){const En=Zt,Bn=yt}else{const En=Zt,Bn=yt;bt.has(En)||bt.set(En,[]),(ln=bt.get(En))==null||ln.push(Bn),jt.has(Bn)||jt.set(Bn,[]),(Fn=jt.get(Bn))==null||Fn.push(En)}}),pt.forEach(Xe=>{const Zt=Xe.id.toString();pt.forEach(yt=>{var $t,Yt,zt,Pn;const on=yt.id.toString();if(Zt===on)return;const rn=yt;if((rn.parentIds||rn.parents||rn.parent_ids||[]).some(ln=>(typeof ln=="object"&&ln.id?ln.id.toString():ln.toString())===Zt)){const ln=on,Fn=Zt;bt.has(ln)||bt.set(ln,[]),($t=bt.get(ln))!=null&&$t.includes(Fn)||(Yt=bt.get(ln))==null||Yt.push(Fn),jt.has(Fn)||jt.set(Fn,[]),(zt=jt.get(Fn))!=null&&zt.includes(ln)||(Pn=jt.get(Fn))==null||Pn.push(ln)}})});const an={id:e,name:(St==null?void 0:St.name)||"Family Tree",nameEn:(St==null?void 0:St.name)||"Family Tree",description:(St==null?void 0:St.description)||"",descriptionEn:(St==null?void 0:St.description)||"",rootPersonId:(()=>{if(u!=null&&u.rootPersonId&&pt.some(yt=>yt.id.toString()===u.rootPersonId))return u.rootPersonId;for(const Zt of pt)if(Zt.isRoot)return Zt.id.toString();const Xe=new Map;wt&&Array.isArray(wt)&&wt.forEach(Zt=>{var yt,on,rn,Qt;if(["Spouse","spouse","Husband","husband","Wife","wife"].includes(Zt.relationshipType)){const vt=Zt.personId.toString(),$t=Zt.relatedPersonId.toString();Xe.has(vt)||Xe.set(vt,[]),(yt=Xe.get(vt))!=null&&yt.includes($t)||(on=Xe.get(vt))==null||on.push($t),Xe.has($t)||Xe.set($t,[]),(rn=Xe.get($t))!=null&&rn.includes(vt)||(Qt=Xe.get($t))==null||Qt.push(vt)}});for(const Zt of pt){const yt=Zt.id.toString();if(!bt.has(yt)){let on=!1;for(const[rn,Qt]of Xe.entries())if(Qt.includes(yt)){on=!0;break}if(!on)return yt}}for(const Zt of pt){const yt=Zt.id.toString();if(!bt.has(yt))return yt}return pt.length>0?pt[0].id.toString():"1"})(),persons:((yt,on)=>{const rn=new Map;yt.forEach(Yt=>{rn.set(Yt.id.toString(),{...Yt,generation:1})});const Qt=yt.filter(Yt=>!on.has(Yt.id.toString()));Qt.forEach(Yt=>{const zt=rn.get(Yt.id.toString());zt&&(zt.generation=1,rn.set(Yt.id.toString(),zt))});const vt=Qt.map(Yt=>({personId:Yt.id.toString(),generation:1})),$t=new Set;for(Qt.forEach(Yt=>$t.add(Yt.id.toString()));vt.length>0;){const{personId:Yt,generation:zt}=vt.shift();on.forEach((Pn,ln)=>{if(Pn.includes(Yt)&&!$t.has(ln)){const Fn=rn.get(ln);Fn&&(Fn.generation=zt+1,rn.set(ln,Fn),$t.add(ln),vt.push({personId:ln,generation:zt+1}))}})}return Array.from(rn.values())})(pt,bt).map(yt=>{var zt,Pn,ln,Fn,En,Bn,Ni,ji;let on="",rn="";if(yt.name){const $r=yt.name.split(" ");on=$r[0]||"",rn=$r.slice(1).join(" ")||""}const Qt=bt.get(yt.id.toString())||[],vt=yt.spouseIds||yt.spouses||yt.spouse_ids||[],$t=jt.get(yt.id.toString())||[];return{id:yt.id.toString(),firstName:yt.firstName||on||yt.name||"",firstNameEn:yt.firstName||on||yt.name||"",lastName:yt.lastName||rn||"",lastNameEn:yt.lastName||rn||"",gender:yt.gender==="male"?"male":yt.gender==="female"?"female":"male",birthDate:((zt=yt.birth)==null?void 0:zt.date)||yt.birthDate||"",birthPlace:((ln=(Pn=yt.birth)==null?void 0:Pn.place)==null?void 0:ln.city)||yt.birthPlace||"",birthPlaceEn:((En=(Fn=yt.birth)==null?void 0:Fn.place)==null?void 0:En.city)||yt.birthPlace||"",isAlive:!yt.isDeceased,photo:((Bn=yt.primaryPhoto)==null?void 0:Bn.url)||yt.photo||yt.photoUrl||"/api/placeholder/100/100",generation:yt.generation||1,position:{x:((Ni=yt.position)==null?void 0:Ni.x)||0,y:((ji=yt.position)==null?void 0:ji.y)||0},parentIds:Qt.map($r=>$r.toString()),spouseIds:(vt||[]).map($r=>$r.toString()),childrenIds:$t.map($r=>$r.toString())}}),createdAt:(St==null?void 0:St.createdAt)||new Date().toISOString(),updatedAt:(St==null?void 0:St.updatedAt)||new Date().toISOString(),ownerId:(St==null?void 0:St.ownerId)||(St!=null&&St.owner?St.owner.id:void 0),userRole:St==null?void 0:St.userRole};if(an.relationships=wt,!an.persons.find(Xe=>Xe.id==="31")){const Xe=pt.find(Zt=>Zt.id.toString()==="31")}f(Xe=>JSON.stringify(Xe)===JSON.stringify(an)?Xe:an)}catch{f(null)}})()},[e,s,a,c,r,Ee]);const Ce=We=>Y?`${We.firstName} ${We.lastName}`:`${We.firstNameEn} ${We.lastNameEn}`,ve=We=>{h(m===We?null:We)},Be=We=>{if(!wn){tn.error(Y?"       ":"You do not have permission to add people to this tree");return}if(u&&we&&me("people",u.persons.length)){const Ue=we.people;tn.error({en:`You've reached the maximum number of people in this tree (${Ue} people). Please upgrade your subscription to add more.`,ar:`          (${Ue} ).     .`},{action:{label:n==="ar"?" ":"Upgrade Subscription",onClick:()=>window.location.assign("/subscription")}});return}_(We),k(!0)},le=We=>{if(!wn){tn.error(Y?"       ":"You do not have permission to add people to this tree");return}A(We),k(!0)},fe=We=>{if(!wn){tn.error(Y?"       ":"You do not have permission to add people to this tree");return}if(u&&we&&me("people",u.persons.length)){const Ue=we.people;tn.error({en:`You've reached the maximum number of people in this tree (${Ue} people). Please upgrade your subscription to add more.`,ar:`          (${Ue} ).     .`},{action:{label:n==="ar"?" ":"Upgrade Subscription",onClick:()=>window.location.assign("/subscription")}});return}B(We),k(!0)},Te=We=>{if(!wn){tn.error(Y?"       ":"You do not have permission to add people to this tree");return}if(u&&we&&me("people",u.persons.length)){const Ue=we.people;tn.error({en:`You've reached the maximum number of people in this tree (${Ue} people). Please upgrade your subscription to add more.`,ar:`          (${Ue} ).     .`},{action:{label:n==="ar"?" ":"Upgrade Subscription",onClick:()=>window.location.assign("/subscription")}});return}D(We),k(!0)},at=We=>{wn?(S(We),R(!0)):tn.error(Y?"     ":"You do not have permission to edit this person")},je=async We=>{if(!wn){tn.error(Y?"     ":"You do not have permission to delete this person");return}De(We),ft(!0)},he=async()=>{if($e)try{await At.deletePerson(parseInt($e)),e&&(s(e),pe(We=>We+1)),tn.success(Y?"   :      ":"Person deleted successfully: The person has been deleted from the family tree")}catch{tn.error(Y?"   :          ":"Failed to delete person: delete childs first")}finally{ft(!1),De(null)}},Pe=()=>{ft(!1),De(null)},ot=J.useCallback(()=>{V.current&&(b?(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen(),w(!1)):(V.current.requestFullscreen?V.current.requestFullscreen():V.current.webkitRequestFullscreen?V.current.webkitRequestFullscreen():V.current.msRequestFullscreen&&V.current.msRequestFullscreen(),w(!0)))},[b]),tt=async()=>{if(!u)return;const{encryptString:We}=await Vp(async()=>{const{encryptString:wt}=await Promise.resolve().then(()=>U0e);return{encryptString:wt}},void 0);console.log("Encrypting tree ID for sharing:",u.id);const Ue=await We(u.id);console.log("Encrypted ID for sharing:",Ue);const pt=`${window.location.origin}/shared/${Ue}`;if(console.log("Share URL:",pt),navigator.share)try{await navigator.share({title:u.name,text:Y?`    ${u.name}`:`Check out the ${u.name} family tree`,url:pt})}catch{qe(pt)}else qe(pt)},qe=We=>{navigator.clipboard?navigator.clipboard.writeText(We).then(()=>{tn.success(Y?"    ":"Link copied to clipboard")}).catch(Ue=>{ze(We)}):ze(We)},ze=We=>{const Ue=document.createElement("textarea");Ue.value=We,Ue.style.top="0",Ue.style.left="0",Ue.style.position="fixed",Ue.style.opacity="0",document.body.appendChild(Ue),Ue.focus(),Ue.select();try{document.execCommand("copy")?tn.success(Y?"    ":"Link copied to clipboard"):tn.error(Y?"  ":"Failed to copy link")}catch{tn.error(Y?"  ":"Failed to copy link")}document.body.removeChild(Ue)};J.useEffect(()=>{const We=()=>{const Ue=document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement;w(!!Ue)};return document.addEventListener("fullscreenchange",We),document.addEventListener("webkitfullscreenchange",We),document.addEventListener("msfullscreenchange",We),()=>{document.removeEventListener("fullscreenchange",We),document.removeEventListener("webkitfullscreenchange",We),document.removeEventListener("msfullscreenchange",We)}},[]);const it=()=>{H(!0),setTimeout(()=>{},0)},st=We=>{if(!u)return;const Ue=u.persons.find(Vt=>Vt.id===We);if(!Ue)return;let pt="",wt="";return u!=null&&u.relationships&&Array.isArray(u.relationships)&&u.relationships.filter(St=>{var Mn;const bt=St.relationshipType==="Child",jt=We.toString(),an=(Mn=St.relatedPersonId)==null?void 0:Mn.toString();return bt&&an===jt}).forEach(St=>{var an;const bt=(an=St.personId)==null?void 0:an.toString(),jt=u.persons.find(Mn=>Mn.id.toString()===bt);jt&&(jt.gender==="male"?pt=jt.id:jt.gender==="female"&&(wt=jt.id))}),{id:Ue.id,name:`${Ue.firstName} ${Ue.lastName}`,gender:Ue.gender,birthDate:Ue.birthDate||"",deathDate:"",birthPlace:Ue.birthPlace||"",birthPlaceEn:Ue.birthPlaceEn||"",occupation:"",occupationEn:"",isAlive:Ue.isAlive,fatherId:pt,motherId:wt}},Ve=()=>wn?o.jsx("div",{className:"space-y-4",children:oe?o.jsx("div",{className:"flex items-center justify-center h-32",children:o.jsx(mr,{className:"h-8 w-8 animate-spin text-primary"})}):z.length===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx(kn,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-medium mb-1",children:Y?"   ":"No Incoming Requests"}),o.jsx("p",{className:"text-muted-foreground",children:Y?"     ":"No incoming join requests currently"})]}):z.map(We=>o.jsx("div",{className:"border rounded-lg p-4",children:o.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx("h3",{className:"font-medium",children:We.name}),mt(We.status)]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Lr,{className:"h-4 w-4 text-muted-foreground"}),o.jsx("span",{children:new Date(We.birthDate).toLocaleDateString(Y?"ar-SA":"en-US")})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(ei,{className:"h-4 w-4 text-muted-foreground"}),o.jsx("span",{children:We.birthPlace})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(hl,{className:"h-4 w-4 text-muted-foreground"}),o.jsx("span",{children:We.occupation})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(kn,{className:"h-4 w-4 text-muted-foreground"}),o.jsx("span",{children:We.relationshipType})]})]}),o.jsxs("div",{className:"mt-2 text-xs text-muted-foreground",children:[Y?" :":"Requested by:"," ",We.requesterId]})]}),We.status.toLowerCase()==="pending"&&o.jsxs("div",{className:"flex gap-2",children:[o.jsxs(ye,{variant:"default",size:"sm",onClick:()=>Ht(We.id),className:"flex items-center gap-1",children:[o.jsx(Lp,{className:"h-4 w-4"}),Y?"":"Accept"]}),o.jsxs(ye,{variant:"destructive",size:"sm",onClick:()=>Kt(We.id),className:"flex items-center gap-1",children:[o.jsx(LI,{className:"h-4 w-4"}),Y?"":"Reject"]})]})]})},We.id))}):null,ut=()=>o.jsx("div",{className:"space-y-4",children:oe?o.jsx("div",{className:"flex items-center justify-center h-32",children:o.jsx(mr,{className:"h-8 w-8 animate-spin text-primary"})}):G.length===0?o.jsxs("div",{className:"text-center py-8",children:[o.jsx(rg,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-medium mb-1",children:Y?"   ":"No Outgoing Requests"}),o.jsx("p",{className:"text-muted-foreground",children:Y?"     ":"You have not made any join requests currently"})]}):G.map(We=>o.jsx("div",{className:"border rounded-lg p-4",children:o.jsx("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx("h3",{className:"font-medium",children:We.name}),mt(We.status)]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Lr,{className:"h-4 w-4 text-muted-foreground"}),o.jsx("span",{children:new Date(We.birthDate).toLocaleDateString(Y?"ar-SA":"en-US")})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(ei,{className:"h-4 w-4 text-muted-foreground"}),o.jsx("span",{children:We.birthPlace})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(hl,{className:"h-4 w-4 text-muted-foreground"}),o.jsx("span",{children:We.occupation})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(kn,{className:"h-4 w-4 text-muted-foreground"}),o.jsx("span",{children:We.relationshipType})]})]}),o.jsxs("div",{className:"mt-2 text-xs text-muted-foreground",children:[Y?" :":"Tree ID:"," ",We.familyTreeId]})]})})},We.id))}),mt=We=>{switch(We.toLowerCase()){case"pending":return o.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[o.jsx(h0,{className:"h-3 w-3 mr-1"}),Y?" ":"Pending"]});case"accepted":return o.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[o.jsx(vi,{className:"h-3 w-3 mr-1"}),Y?"":"Accepted"]});case"rejected":return o.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[o.jsx(sg,{className:"h-3 w-3 mr-1"}),Y?"":"Rejected"]});default:return o.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:We})}},Ht=async We=>{try{await At.acceptJoinRequest(We),tn.success({en:"Request accepted successfully",ar:"   "}),Ae()}catch{tn.error({en:"Failed to accept request",ar:"   "})}},Kt=async We=>{try{await At.rejectJoinRequest(We),tn.success({en:"Request rejected successfully",ar:"   "}),Ae()}catch{tn.error({en:"Failed to reject request",ar:"   "})}},jn=()=>{if(!u)return null;const We=u.persons.filter(Ue=>Ce(Ue).toLowerCase().includes(p.toLowerCase()));return o.jsx("div",{className:`grid ${te?"grid-cols-1 gap-3":"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"}`,children:We.map(Ue=>o.jsx(et,{className:"hover:shadow-md transition-shadow",children:o.jsxs(rt,{className:`p-4 ${te?"p-3":""}`,children:[o.jsxs("div",{className:`flex items-center gap-3 mb-3 ${te?"gap-2":""}`,children:[o.jsx("div",{className:`rounded-full flex items-center justify-center ${Ue.gender==="male"?"bg-blue-100 text-blue-600":Ue.gender==="female"?"bg-pink-100 text-pink-600":"bg-gray-100 text-gray-600"} ${te?"w-10 h-10":"w-12 h-12"}`,children:Ue.gender==="male"?o.jsx(Xt,{className:`h-6 w-6 ${te?"h-5 w-5":""}`}):Ue.gender==="female"?o.jsx(Xt,{className:`h-6 w-6 ${te?"h-5 w-5":""}`}):o.jsx(Xt,{className:`h-6 w-6 text-gray-500 ${te?"h-5 w-5":""}`})}),o.jsxs("div",{className:"flex-1",children:[o.jsx("h3",{className:`font-medium ${te?"text-sm":""}`,children:Ce(Ue)}),o.jsxs("div",{className:`flex items-center gap-2 ${te?"text-xs":"text-sm"} text-muted-foreground`,children:[o.jsx(Gn,{variant:Ue.gender==="male"?"default":"secondary",className:te?"text-xs px-1.5 py-0.5":"",children:Ue.gender==="male"?Y?"":"Male":Y?"":"Female"}),Ue.birthDate&&o.jsx("span",{children:new Date(Ue.birthDate).getFullYear()})]})]})]}),o.jsxs("div",{className:`flex ${te?"gap-1":"gap-2"}`,children:[o.jsxs(ye,{size:"sm",variant:"outline",onClick:()=>{const pt={...Ue,parents:Ue.parentIds?Ue.parentIds.map(wt=>{const Vt=u==null?void 0:u.persons.find(St=>St.id===wt);return{id:wt,name:Vt?Y?`${Vt.firstName} ${Vt.lastName}`:`${Vt.firstNameEn||Vt.firstName} ${Vt.lastNameEn||Vt.lastName}`:Y?" ":"Unknown",relationship:Y?"":"Parent"}}):[],spouses:Ue.spouseIds?Ue.spouseIds.map(wt=>{const Vt=u==null?void 0:u.persons.find(St=>St.id===wt);return{id:wt,name:Vt?Y?`${Vt.firstName} ${Vt.lastName}`:`${Vt.firstNameEn||Vt.firstName} ${Vt.lastNameEn||Vt.lastName}`:Y?" ":"Unknown"}}).filter(wt=>wt.name!==(Y?" ":"Unknown")):[],childrenDetails:Ue.childrenIds?Ue.childrenIds.map(wt=>{const Vt=u==null?void 0:u.persons.find(St=>St.id===wt);return{id:wt,name:Vt?Y?`${Vt.firstName} ${Vt.lastName}`:`${Vt.firstNameEn||Vt.firstName} ${Vt.lastNameEn||Vt.lastName}`:Y?" ":"Unknown"}}):[],parentIds:void 0,spouseIds:void 0,children:void 0};console.log("Detailed person spouse data:",{originalSpouseIds:Ue.spouseIds,createdSpouses:pt.spouses,hasSpouses:pt.spouses&&pt.spouses.length>0}),ke(pt),Me(!0)},className:te?"text-xs py-1 px-2":"",children:[o.jsx(ra,{className:`h-4 w-4 ${te?"h-3 w-3 mr-1":"mr-1"}`}),o.jsx("span",{className:te?"hidden":"",children:Y?"":"View"})]}),o.jsxs(ye,{size:"sm",variant:"outline",onClick:()=>at(Ue.id),className:`flex items-center ${wn?"":"hidden"} ${te?"text-xs py-1 px-2":""}`,children:[o.jsx(sa,{className:`h-4 w-4 ${te?"h-3 w-3 mr-1":"mr-1"}`}),o.jsx("span",{className:te?"hidden":"",children:Y?"":"Edit"})]}),o.jsxs(ye,{size:"sm",variant:"destructive",onClick:()=>je(Ue.id),className:`flex items-center ${wn?"":"hidden"} ${te?"text-xs py-1 px-2":""}`,children:[o.jsx($a,{className:`h-4 w-4 ${te?"h-3 w-3 mr-1":"mr-1"}`}),o.jsx("span",{className:te?"hidden":"",children:Y?"":"Delete"})]})]})]})},Ue.id))})},wn=(()=>{if(!d||!u&&!r)return!1;if(r&&r.id===e&&(r.ownerId&&r.ownerId===d.id||r.owner&&r.owner.id===d.id||r.userRole==="owner")||u&&(u.ownerId&&u.ownerId===d.id||u.owner&&u.owner.id===d.id))return!0;const We=a.find(pt=>pt.id===e);if(We&&(We.ownerId&&We.ownerId===d.id||We.owner&&We.owner.id===d.id||We.userRole==="owner"))return!0;const Ue=c.find(pt=>pt.id===e);return!!(Ue&&(Ue.ownerId&&Ue.ownerId===d.id||Ue.owner&&Ue.owner.id===d.id||Ue.userRole==="owner"))})();if(J.useEffect(()=>{W==="incoming"&&wn?Ae():W==="outgoing"&&Re()},[W,wn]),i)return o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsxs("div",{className:"text-center",children:[o.jsx(mr,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4 animate-spin"}),o.jsx("p",{className:"text-muted-foreground",children:Y?"  ...":"Loading tree..."})]})});if(l)return o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"text-destructive mx-auto mb-4",children:o.jsx(qn,{className:"h-12 w-12 mx-auto"})}),o.jsx("p",{className:"text-destructive",children:Y?"    ":"Error loading tree"}),o.jsx(ye,{variant:"outline",className:"mt-4",onClick:()=>window.location.reload(),children:Y?" ":"Try Again"})]})});if(!u)return o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsxs("div",{className:"text-center",children:[o.jsx(qn,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),o.jsx("p",{className:"text-muted-foreground",children:Y?"    ":"Tree not found"})]})});const It=o.jsx("div",{className:W!=="tree"?"hidden":"",children:o.jsx("div",{ref:V,className:"w-full h-full",children:o.jsx(et,{className:`relative overflow-hidden tree-visualization-container ${b?"fixed inset-0 z-50 m-0 rounded-none":""}`,style:{height:b?"100vh":"calc(100vh - 200px)"},children:o.jsx("div",{className:"w-full h-full flex items-center justify-center",style:{width:"100%",height:"100%"},children:o.jsx("div",{className:"w-full h-full",style:{width:"100%",height:"100%"},children:o.jsx(aD,{persons:u?u.persons:[],relationships:(u==null?void 0:u.relationships)||[],rootPersonId:u?u.rootPersonId:"",onSelectPerson:ve,onEditPerson:at,onDeletePerson:je,onAddChild:Be,onAddSpouse:le,onAddFather:fe,onAddMother:Te,dataVersion:Ee,isOwnedTree:wn})})})})})}),Rr=o.jsx("div",{className:W!=="list"?"hidden":"",children:jn()}),Vr=o.jsx("div",{className:W!=="incoming"?"hidden":"",children:o.jsx(et,{children:o.jsxs(rt,{className:"p-4",children:[o.jsx("h2",{className:"text-xl font-bold mb-4",children:Y?"  ":"Incoming Join Requests"}),Ve()]})})}),Sr=o.jsx("div",{className:W!=="outgoing"?"hidden":"",children:o.jsx(et,{children:o.jsxs(rt,{className:"p-4",children:[o.jsx("h2",{className:"text-xl font-bold mb-4",children:Y?"  ":"Outgoing Join Requests"}),ut()]})})});return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:`flex ${te?"flex-col gap-3":"items-center justify-between"}`,children:[o.jsxs("div",{className:`flex ${te?"flex-col gap-3":"items-center gap-4"}`,children:[o.jsxs(ye,{variant:"outline",onClick:()=>t("/trees"),size:te?"sm":"default",className:te?"w-full":"",children:[o.jsx(fl,{className:"h-4 w-4 mr-2"}),Y?" ":"Back to Trees"]}),o.jsxs("div",{children:[o.jsx("h1",{className:`font-bold ${te?"text-xl":"text-2xl"}`,children:Y?u==null?void 0:u.name:u==null?void 0:u.nameEn}),o.jsxs("p",{className:"text-muted-foreground text-sm",children:[(u==null?void 0:u.persons.length)||0," ",Y?"":"members"]})]})]}),o.jsxs("div",{className:`flex ${te?"gap-2 w-full":"items-center gap-2"}`,children:[o.jsxs(ye,{variant:"outline",onClick:()=>k(!0),className:wn?"":"hidden",size:te?"sm":"default",children:[o.jsx(Yu,{className:"h-4 w-4 mr-2"}),Y?" ":"Add Person"]}),o.jsxs(ye,{variant:"default",onClick:it,className:`${wn?"hidden":""} ${te?"flex-1":""}`,size:te?"sm":"default",children:[o.jsx(Lp,{className:"h-4 w-4 mr-2"}),Y?" ":"Join Request"]}),o.jsxs(ye,{variant:"outline",onClick:tt,className:te?"flex-1":"",size:te?"sm":"default",children:[o.jsx(p0,{className:"h-4 w-4 mr-2"}),Y?"":"Share"]})]})]}),o.jsxs("div",{className:`flex flex-col ${te?"gap-3":"gap-4"}`,children:[o.jsxs("div",{className:`flex ${te?"flex-wrap gap-1 p-1 bg-muted rounded-lg overflow-x-auto":"items-center gap-2"}`,style:{minHeight:"40px"},children:[o.jsxs(ye,{variant:W==="tree"?"default":"outline",size:"sm",onClick:()=>$("tree"),className:`flex items-center gap-2 whitespace-nowrap ${te?"text-xs py-2 px-3 flex-1 justify-center":""}`,style:{minWidth:"80px"},children:[o.jsx(qn,{className:`h-4 w-4 ${te?"h-3 w-3":"mr-2"}`}),o.jsx("span",{className:te?"hidden":"",children:Y?"":"Tree"})]}),o.jsxs(ye,{variant:W==="list"?"default":"outline",size:"sm",onClick:()=>$("list"),className:`flex items-center gap-2 whitespace-nowrap ${te?"text-xs py-2 px-3 flex-1 justify-center":""}`,style:{minWidth:"80px"},children:[o.jsx(mH,{className:`h-4 w-4 ${te?"h-3 w-3":"mr-2"}`}),o.jsx("span",{className:te?"hidden":"",children:Y?"":"List"})]}),wn&&o.jsxs(ye,{variant:W==="incoming"?"default":"outline",size:"sm",onClick:()=>$("incoming"),className:`flex items-center gap-2 whitespace-nowrap ${te?"text-xs py-2 px-3 flex-1 justify-center":""}`,style:{minWidth:"80px"},children:[o.jsx(Lp,{className:`h-4 w-4 ${te?"h-3 w-3":"mr-2"}`}),o.jsx("span",{className:te?"hidden":"",children:Y?"":"Incoming"}),z.filter(We=>{var Ue;return((Ue=We.status)==null?void 0:Ue.toLowerCase())==="pending"}).length>0&&o.jsx("span",{className:`ml-2 bg-red-500 text-white text-xs rounded-full flex items-center justify-center ${te?"h-4 w-4":"h-5 w-5"}`,children:z.filter(We=>{var Ue;return((Ue=We.status)==null?void 0:Ue.toLowerCase())==="pending"}).length})]}),o.jsxs(ye,{variant:W==="outgoing"?"default":"outline",size:"sm",onClick:()=>$("outgoing"),className:`flex items-center gap-2 whitespace-nowrap ${te?"text-xs py-2 px-3 flex-1 justify-center":""}`,style:{minWidth:"80px"},children:[o.jsx(rg,{className:`h-4 w-4 ${te?"h-3 w-3":"mr-2"}`}),o.jsx("span",{className:te?"hidden":"",children:Y?"":"Outgoing"})]}),W==="tree"&&o.jsx(ye,{variant:"outline",size:"sm",onClick:ot,className:`flex items-center gap-2 whitespace-nowrap ${te?"text-xs py-2 px-3 flex-1 justify-center":""}`,style:{minWidth:"80px"},children:b?o.jsxs(o.Fragment,{children:[o.jsx(II,{className:`h-4 w-4 ${te?"h-3 w-3":""}`}),o.jsx("span",{className:te?"hidden":"",children:Y?"   ":"Exit Fullscreen"})]}):o.jsxs(o.Fragment,{children:[o.jsx(CI,{className:`h-4 w-4 ${te?"h-3 w-3":""}`}),o.jsx("span",{className:te?"hidden":"",children:Y?" ":"Fullscreen"})]})})]}),o.jsx("div",{className:`flex ${te?"flex-col gap-3":"items-center justify-between"}`,children:o.jsx("div",{className:"w-full",children:(W==="tree"||W==="list")&&o.jsxs("div",{className:"relative",children:[o.jsx(Qi,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 ${te?"h-3.5 w-3.5":"h-4 w-4"} text-muted-foreground`}),o.jsx("input",{type:"text",placeholder:Y?"  ...":"Search members...",value:p,onChange:We=>x(We.target.value),className:`pl-10 pr-4 border rounded-md ${te?"py-2 text-sm w-full":"py-2 text-sm w-64"}`})]})})})]}),It,Rr,o.jsx("div",{className:W!=="incoming"||!wn?"hidden":"",children:Vr}),Sr,o.jsx(Rh,{isOpen:N,onClose:()=>{k(!1),_(null),A(null),B(null),D(null)},onSubmit:We=>{e&&(s(e),pe(Ue=>Ue+1)),k(!1),_(null),A(null),B(null),D(null)},familyTreeId:(u==null?void 0:u.id)||"",familyMembers:(u==null?void 0:u.persons)||[],relationships:(u==null?void 0:u.relationships)||[],initialRelationshipData:E?{parentId:E,relationshipType:"father"}:M?{parentId:M,relationshipType:"spouse"}:P?{parentId:P,relationshipType:"father"}:L?{parentId:L,relationshipType:"mother"}:null,mode:"create"}),o.jsx(Rh,{isOpen:I,onClose:()=>{R(!1),S(null)},onSubmit:We=>{e&&(s(e),pe(Ue=>Ue+1)),R(!1),S(null)},familyTreeId:(u==null?void 0:u.id)||"",familyMembers:(u==null?void 0:u.persons)||[],relationships:(u==null?void 0:u.relationships)||[],initialData:T?st(T):void 0,mode:"edit"}),o.jsx(F0e,{isOpen:O,onClose:()=>H(!1),treeId:e||"",treeName:Y?(u==null?void 0:u.name)||"":(u==null?void 0:u.nameEn)||"",treePersons:(u==null?void 0:u.persons)||[]}),o.jsx(am,{isOpen:ee,onClose:Pe,title:Y?" ":"Confirm Deletion",children:o.jsxs("div",{className:"space-y-6",children:[o.jsx("div",{className:"flex items-start gap-3",children:o.jsxs("div",{className:"flex-1",children:[o.jsx("p",{className:"text-foreground",children:Y?"      ":"Are you sure you want to delete this person?"}),o.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:Y?"     .":"This action cannot be undone."})]})}),o.jsxs("div",{className:"flex justify-end gap-3",children:[o.jsx(ye,{variant:"outline",onClick:Pe,children:Y?"":"Cancel"}),o.jsx(ye,{variant:"destructive",onClick:he,children:Y?"":"Delete"})]})]})}),o.jsx(oD,{person:_e,isOpen:ge,onClose:()=>{Me(!1),ke(null)}})]})};function q0e(e){return new TextEncoder().encode(e).buffer}function B0e(e){const t=new Uint8Array(e);let n="";for(let r=0;r<t.byteLength;r++)n+=String.fromCharCode(t[r]);return btoa(n)}function z0e(e){const t=atob(e),n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n.buffer}async function lD(){const e=q0e("nasabna-tree-sharing-key-2025");return crypto.subtle.importKey("raw",e,{name:"AES-GCM"},!1,["encrypt","decrypt"])}async function JN(e){try{const t=await lD(),r=new TextEncoder().encode(e),s=crypto.getRandomValues(new Uint8Array(12)),i=await crypto.subtle.encrypt({name:"AES-GCM",iv:s},t,r),l=new Uint8Array(s.length+i.byteLength);return l.set(s,0),l.set(new Uint8Array(i),s.length),B0e(l.buffer)}catch{return e}}async function cD(e){try{const t=await lD(),n=z0e(e),r=new Uint8Array(n),s=r.slice(0,12),i=r.slice(12),l=await crypto.subtle.decrypt({name:"AES-GCM",iv:s},t,i);return new TextDecoder().decode(l)}catch{return e}}const U0e=Object.freeze(Object.defineProperty({__proto__:null,decryptString:cD,encryptString:JN},Symbol.toStringTag,{value:"Module"})),H0e=()=>{const{id:e}=pd(),t=jr(),{language:n}=Ft(),{user:r}=Mr(),{trees:s,fetchTrees:i,deleteTree:l}=As(),{isMobile:a}=_r(),[c,d]=J.useState("info"),[u,f]=J.useState(!1),[m,h]=J.useState(!1),[g,y]=J.useState(!1),[p,x]=J.useState(!1),[b,w]=J.useState(!1),[N,k]=J.useState(!1),[I,R]=J.useState(null),[T,S]=J.useState(null),[E,_]=J.useState(!0),[M,A]=J.useState(null),[P,B]=J.useState(null),[L,D]=J.useState(!1),[V,O]=J.useState(null),[H,W]=J.useState(""),[$,z]=J.useState(!1);J.useRef(null),J.useEffect(()=>{},[H]);const q=n==="ar",[G,re]=J.useState({id:"",name:"",description:"",descriptionEn:"",coverImage:void 0,isPublic:!0,allowCollaboration:!1,createdAt:"",updatedAt:"",membersCount:0,generationsCount:0}),[oe,ie]=J.useState(G),[Y,te]=J.useState([]),we=(se,Ae)=>{const Re=new Map;se.forEach(fe=>{Re.set(fe.id,{...fe,generation:1})});const Ce=new Map;Ae.forEach(fe=>{var Te,at,je,he,Pe,ot;((Te=fe.relationshipType)==null?void 0:Te.toLowerCase())==="child"?Ce.set(((at=fe.relatedPersonId)==null?void 0:at.toString())||"",((je=fe.personId)==null?void 0:je.toString())||""):((he=fe.relationshipType)==null?void 0:he.toLowerCase())==="parent"&&Ce.set(((Pe=fe.personId)==null?void 0:Pe.toString())||"",((ot=fe.relatedPersonId)==null?void 0:ot.toString())||"")});const ve=se.filter(fe=>!Ce.has(fe.id));ve.forEach(fe=>{const Te=Re.get(fe.id);Te&&(Te.generation=1,Re.set(fe.id,Te))});const Be=ve.map(fe=>({memberId:fe.id,generation:1})),le=new Set;for(ve.forEach(fe=>le.add(fe.id));Be.length>0;){const{memberId:fe,generation:Te}=Be.shift();Ce.forEach((at,je)=>{if(at===fe&&!le.has(je)){const he=Re.get(je);he&&(he.generation=Te+1,Re.set(je,he),le.add(je),Be.push({memberId:je,generation:Te+1}))}})}return Array.from(Re.values())},me=async(se,Ae)=>{try{As.getState().updateTreeGenerations(se.toString(),Ae),await i()}catch{}};J.useEffect(()=>{(async()=>{if(G.id&&G.id!=="0"&&G.id!=="")try{z(!0);const Ae=await JN(G.id);W(Ae)}catch(Ae){console.warn("Encryption error:",Ae),W(G.id)}finally{z(!1)}else if(G.id===""&&e)try{z(!0);const Ae=await JN(e);W(Ae)}catch(Ae){console.warn("Encryption error for param:",Ae),W(e)}finally{z(!1)}else W("")})()},[G.id,e]),J.useEffect(()=>{(async()=>{var Ae,Re;if(!e){A(q?"     ":"Tree ID not found"),_(!1);return}try{_(!0),A(null);const Ce=await At.getTreeById(parseInt(e));if(!Ce){A(q?"    ":"Tree not found"),_(!1);return}const ve={id:((Ae=Ce.id)==null?void 0:Ae.toString())||e,name:Ce.name||"",description:Ce.description||"",descriptionEn:Ce.description||"",coverImage:Ce.photoUrl||void 0,isPublic:Ce.isPrivate!==void 0?!Ce.isPrivate:!0,allowCollaboration:Ce.members&&Ce.members.length>0,createdAt:Ce.createdAt||new Date().toISOString(),updatedAt:Ce.updatedAt||new Date().toISOString(),membersCount:((Re=Ce.members)==null?void 0:Re.length)||0,generationsCount:1};re(ve),ie(ve);let le=(Array.isArray(Ce.members)?Ce.members:[]).map(fe=>({id:fe.id&&fe.id.toString()!=="undefined"&&fe.id.toString()!=="null"&&!isNaN(parseInt(fe.id.toString()))&&parseInt(fe.id.toString())>0?fe.id.toString():Date.now().toString()+Math.random().toString(36).substr(2,9),firstName:fe.firstName||fe.name||"",firstNameEn:fe.firstName||fe.name||"",lastName:fe.lastName||"",lastNameEn:fe.lastName||"",gender:fe.gender||"unknown",birthDate:fe.birthDate||void 0,deathDate:fe.deathDate||void 0,birthPlace:fe.birthPlace||void 0,birthPlaceEn:fe.birthPlace||void 0,occupation:fe.occupation||void 0,occupationEn:fe.occupation||void 0,bio:void 0,bioEn:void 0,avatar:fe.photoUrl||void 0,isAlive:fe.isDeceased!==void 0?!fe.isDeceased:!0,generation:1,parentId:void 0,spouseId:void 0,children:[],photos:[],documents:[]}));try{const Te=(await At.getRelationships()).filter(je=>!0);le=we(le,Te);const at=Math.max(...le.map(je=>je.generation),1);re(je=>({...je,generationsCount:at})),ie(je=>({...je,generationsCount:at})),await me(e,at)}catch{}te(le)}catch{A(q?"    ":"Failed to load tree data")}finally{_(!1)}})()},[e,q]);const Ee=async()=>{var se,Ae,Re,Ce,ve,Be;if(e)try{if(_(!0),!oe.name||oe.name.trim()==="")throw new Error(q?"  ":"Tree name is required");const le=await At.updateTree(parseInt(e),oe.name.trim(),!oe.isPublic,((se=oe.description)==null?void 0:se.trim())||"");if(!le)throw new Error(q?"   ":"Failed to update tree");const fe={...oe,id:((Ae=le.id)==null?void 0:Ae.toString())||e,name:le.name||oe.name,description:le.description||oe.description,descriptionEn:le.description||oe.descriptionEn,coverImage:le.photoUrl||oe.coverImage,isPublic:le.isPrivate!==void 0?!le.isPrivate:oe.isPublic,allowCollaboration:!!(le.members&&le.members.length>0),createdAt:le.createdAt||oe.createdAt,updatedAt:le.updatedAt||new Date().toISOString(),membersCount:((Re=le.members)==null?void 0:Re.length)||oe.membersCount,generationsCount:oe.generationsCount};re(fe),f(!1)}catch(le){let fe=q?"    ":"Failed to update tree data";(ve=(Ce=le.response)==null?void 0:Ce.data)!=null&&ve.message?fe+=`: ${le.response.data.message}`:le.message?fe+=`: ${le.message}`:((Be=le.response)==null?void 0:Be.status)===400&&(fe+=": "+(q?"  ":"Invalid data provided")),A(fe)}finally{_(!1)}},pe=()=>{ie(G),f(!1)},ee=async se=>{try{const Ae=await At.updateTree(parseInt(se.id),se.name,!se.isPublic,q?se.description:se.descriptionEn);re(Re=>({...Re,name:Ae.name,description:Ae.description||Re.description,descriptionEn:Ae.description||Re.descriptionEn,isPublic:Ae.isPrivate!==void 0?!Ae.isPrivate:Re.isPublic})),ie(Re=>({...Re,name:Ae.name,description:Ae.description||Re.description,descriptionEn:Ae.description||Re.descriptionEn,isPublic:Ae.isPrivate!==void 0?!Ae.isPrivate:Re.isPublic})),As.getState().updateTree(Ae.id.toString(),{...Ae,isPrivate:Ae.isPrivate,description:Ae.description||""}),O(q?"   ":"Tree updated successfully"),setTimeout(()=>O(null),3e3),h(!1)}catch{O(q?"   ":"Failed to update tree"),setTimeout(()=>O(null),3e3)}},ft=async se=>{var Ae,Re,Ce,ve,Be;try{const le={id:(Ae=se.id)!=null&&Ae.toString()&&se.id.toString()!=="undefined"&&se.id.toString()!=="null"&&!isNaN(parseInt(se.id.toString()))?se.id.toString():Date.now().toString()+Math.random().toString(36).substr(2,9),firstName:se.firstName||((Re=se.name)==null?void 0:Re.split(" ")[0])||"",firstNameEn:se.firstNameEn||((Ce=se.name)==null?void 0:Ce.split(" ")[0])||"",lastName:se.lastName||((ve=se.name)==null?void 0:ve.split(" ").slice(1).join(" "))||"",lastNameEn:se.lastNameEn||((Be=se.name)==null?void 0:Be.split(" ").slice(1).join(" "))||"",gender:se.gender||"unknown",birthDate:se.birthDate||void 0,deathDate:se.deathDate||void 0,birthPlace:se.birthPlace||void 0,birthPlaceEn:se.birthPlaceEn||void 0,occupation:se.occupation||void 0,occupationEn:se.occupationEn||void 0,bio:se.bio||void 0,bioEn:se.bioEn||void 0,avatar:se.avatar||void 0,isAlive:!se.isDeceased,generation:se.generation||1,parentId:se.parentId||void 0,spouseId:se.spouseId||void 0,children:se.children||[],photos:se.photos||[],documents:se.documents||[]},fe=[...Y,le];te(fe);try{const Te=await At.getRelationships(),at=we(fe,Te);te(at);const je=Math.max(...at.map(he=>he.generation),1);re(he=>({...he,membersCount:he.membersCount+1,generationsCount:je})),ie(he=>({...he,membersCount:he.membersCount+1,generationsCount:je})),e&&await me(e,je)}catch{}O(q?"   ":"Member added successfully"),setTimeout(()=>O(null),3e3)}catch{O(q?"   ":"Failed to add member"),setTimeout(()=>O(null),3e3)}},$e=async se=>{var Ae,Re,Ce;if(confirm(q?"      ":"Are you sure you want to delete this member?"))try{_(!0);const Be=(await As.getState().getRelationships()).filter(fe=>fe.personId===parseInt(se)||fe.relatedPersonId===parseInt(se));for(const fe of Be)try{await As.getState().deleteRelationship(fe.id.toString())}catch{}await As.getState().deletePerson(se);const le=Y.filter(fe=>fe.id!==se);te(le),re(fe=>({...fe,membersCount:fe.membersCount-1})),ie(fe=>({...fe,membersCount:fe.membersCount-1}));try{const fe=await At.getRelationships(),Te=we(le,fe);te(Te);const at=Math.max(...Te.map(je=>je.generation),1);re(je=>({...je,generationsCount:at})),ie(je=>({...je,generationsCount:at})),e&&await me(e,at)}catch{}}catch(ve){let Be=q?"   ":"Failed to delete member";(Re=(Ae=ve.response)==null?void 0:Ae.data)!=null&&Re.message?Be+=`: ${ve.response.data.message}`:(Ce=ve.response)!=null&&Ce.data?Be+=`: ${JSON.stringify(ve.response.data)}`:ve.message&&(Be+=`: ${ve.message}`),A(Be)}finally{_(!1)}},De=async se=>{var Ae,Re,Ce,ve,Be;try{B(null);const le=await At.updatePerson(parseInt(se.id),se.name,se.birthDate||"",q?se.birthPlace||"":se.birthPlaceEn||"",q?se.occupation||"":se.occupationEn||"",se.gender||"unknown",parseInt(e||"0")),fe=Y.map(Te=>{var at,je,he,Pe,ot,tt,qe,ze,it,st,Ve;return Te.id===((at=se.id)==null?void 0:at.toString())?{...Te,firstName:((je=se.name)==null?void 0:je.split(" ")[0])||Te.firstName||"",firstNameEn:((he=se.name)==null?void 0:he.split(" ")[0])||Te.firstNameEn||"",lastName:((Pe=se.name)==null?void 0:Pe.split(" ").slice(1).join(" "))||Te.lastName||"",lastNameEn:((ot=se.name)==null?void 0:ot.split(" ").slice(1).join(" "))||Te.lastNameEn||"",gender:le.gender||se.gender||Te.gender,birthDate:((tt=le.birth)==null?void 0:tt.date)||se.birthDate||Te.birthDate,deathDate:((qe=le.death)==null?void 0:qe.date)||se.deathDate||Te.deathDate,birthPlace:((it=(ze=le.birth)==null?void 0:ze.place)==null?void 0:it.city)||se.birthPlace||Te.birthPlace,birthPlaceEn:((Ve=(st=le.birth)==null?void 0:st.place)==null?void 0:Ve.city)||se.birthPlaceEn||Te.birthPlaceEn,occupation:Array.isArray(le.occupation)&&le.occupation.length>0?le.occupation[0].title:se.occupation||Te.occupation,occupationEn:Array.isArray(le.occupation)&&le.occupation.length>0?le.occupation[0].title:se.occupationEn||Te.occupation,isAlive:le.isDeceased!==void 0?!le.isDeceased:se.isDeceased!==void 0?!se.isDeceased:Te.isAlive}:Te});te(fe);try{const Te=await At.getRelationships(),at=we(fe,Te);te(at);const je=Math.max(...at.map(he=>he.generation),1);re(he=>({...he,generationsCount:je})),ie(he=>({...he,generationsCount:je})),e&&await me(e,je)}catch{}x(!1),S(null)}catch(le){let fe=q?"    ":"Failed to update member";((Ae=le.response)==null?void 0:Ae.status)===400?fe=q?"    ":"Please check the entered data":((Re=le.response)==null?void 0:Re.status)===401?fe=q?"     ":"You must be logged in to perform this action":((Ce=le.response)==null?void 0:Ce.status)===403?fe=q?"     ":"You do not have permission to perform this action":((ve=le.response)==null?void 0:ve.status)===404?fe=q?"     ":"The requested member was not found":((Be=le.response)==null?void 0:Be.status)===500?fe=q?"   .     ":"Server error. Please try again later":le.message&&(le.message.includes("Network Error")?fe=q?"  .     ":"Network error. Please check your internet connection":le.message.includes("timeout")&&(fe=q?"  .    ":"Request timeout. Please try again")),B(fe)}},ge=se=>se==="male"?Aa:se==="female"?TI:Xt,Me=(se,Ae)=>{if(!se)return"";let Re;try{if(se.includes("T"))Re=new Date(se);else if(se.includes("-")){const le=se.split("-");le.length===3?Re=new Date(parseInt(le[0]),parseInt(le[1])-1,parseInt(le[2])):Re=new Date(se)}else if(se.includes("/")){const le=se.split("/");le.length===3?Re=new Date(parseInt(le[2]),parseInt(le[0])-1,parseInt(le[1])):Re=new Date(se)}else Re=new Date(se)}catch{return""}if(isNaN(Re.getTime()))return"";let Ce;if(Ae&&Ae.trim()!=="")try{if(Ae.includes("T"))Ce=new Date(Ae);else if(Ae.includes("-")){const le=Ae.split("-");le.length===3?Ce=new Date(parseInt(le[0]),parseInt(le[1])-1,parseInt(le[2])):Ce=new Date(Ae)}else if(Ae.includes("/")){const le=Ae.split("/");le.length===3?Ce=new Date(parseInt(le[2]),parseInt(le[0])-1,parseInt(le[1])):Ce=new Date(Ae)}else Ce=new Date(Ae);isNaN(Ce.getTime())&&(Ce=new Date)}catch{Ce=new Date}else Ce=new Date;let ve=Ce.getFullYear()-Re.getFullYear();const Be=Ce.getMonth()-Re.getMonth();return(Be<0||Be===0&&Ce.getDate()<Re.getDate())&&ve--,ve>=0?ve.toString():"0"},_e=se=>{const Ae=se.target;Ae.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgZmlsbD0iI2NjYyIvPjx0ZXh0IHg9IjUwIiB5PSI1NSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjEwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSIjNjY2Ij5JbWFnZSBOb3QgRm91bmQ8L3RleHQ+PC9zdmc+"};return E?o.jsx("div",{className:"flex justify-center items-center h-64",children:o.jsx(mr,{className:"h-8 w-8 animate-spin text-primary"})}):!(()=>{if(!r||!e)return!1;const se=s.find(Ae=>Ae.id===e);return se?se.ownerId===r.id||se.userRole==="owner":!1})()&&!E&&r?o.jsxs("div",{className:"flex flex-col items-center justify-center h-64 space-y-4",children:[o.jsx(No,{className:"h-12 w-12 text-destructive"}),o.jsx("p",{className:"text-destructive text-center",children:q?"     ":"You do not have permission to edit this tree"}),o.jsx(ye,{onClick:()=>t("/trees"),children:q?" ":"Back to Trees"})]}):M?o.jsxs("div",{className:"flex flex-col items-center justify-center h-64 space-y-4",children:[o.jsx(No,{className:"h-12 w-12 text-destructive"}),o.jsx("p",{className:"text-destructive text-center",children:M}),o.jsx(ye,{onClick:()=>window.location.reload(),children:q?" ":"Try Again"})]}):o.jsxs("div",{className:"space-y-6",children:[V&&o.jsx("div",{className:"bg-green-100 border border-green-200 rounded-lg p-3",children:o.jsx("p",{className:"text-green-800 text-sm",children:V})}),o.jsxs("div",{className:`flex flex-col ${a?"gap-3":"sm:flex-row sm:items-center"} justify-between`,children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs(ye,{variant:"outline",onClick:()=>t("/trees"),className:"flex items-center gap-2",size:a?"sm":"default",children:[o.jsx(fl,{className:`h-4 w-4 ${a?"h-3 w-33":""}`}),o.jsx("span",{className:a?"hidden":"hidden xs:inline",children:q?" ":"Back to Trees"})]}),o.jsxs("div",{children:[o.jsx("h1",{className:`font-bold text-foreground truncate ${a?"text-lg max-w-[150px]":"text-xl sm:text-2xl max-w-[200px] sm:max-w-none"}`,children:G.name}),o.jsx("p",{className:`text-muted-foreground ${a?"text-xs":"text-xs sm:text-sm"}`,children:q?`${G.membersCount}   ${G.generationsCount} `:`${G.membersCount} members  ${G.generationsCount} generations`})]})]}),o.jsx("div",{className:`flex ${a?"gap-1":"gap-2"}`})]}),o.jsx("div",{className:`flex ${a?"flex-wrap gap-1 p-1 bg-muted rounded-lg":"flex-wrap gap-1 border-b"}`,children:[{id:"info",label:q?" ":"Tree Info",icon:qn},{id:"members",label:q?" ":"Family Members",icon:kn},{id:"settings",label:q?"":"Settings",icon:gh}].map(se=>o.jsxs(ye,{variant:c===se.id?"default":"ghost",onClick:()=>d(se.id),className:`flex items-center gap-2 ${a?"text-xs py-2 px-3 flex-1 justify-center":"text-xs sm:text-sm"}`,size:a?"sm":"default",children:[be.createElement(se.icon,{className:`h-4 w-4 ${a?"h-3 w-3":""}`}),o.jsx("span",{className:a?"hidden":"hidden xs:inline",children:se.label})]},se.id))}),c==="info"&&o.jsxs(et,{children:[o.jsx(ht,{className:`${a?"p-4":""}`,children:o.jsxs(gt,{className:"flex items-center gap-2",children:[o.jsx(qn,{className:`h-5 w-5 ${a?"h-4 w-4":""}`}),q?" ":"Tree Information"]})}),o.jsxs(rt,{className:`space-y-6 ${a?"p-4":""}`,children:[o.jsx("div",{className:`grid ${a?"grid-cols-1 gap-3":"grid-cols-1 sm:grid-cols-2 gap-4"}`,children:o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:`font-medium ${a?"text-xs":"text-sm"}`,children:q?" ":"Tree Name"}),o.jsx(Bt,{value:u?oe.name:G.name,onChange:se=>ie(Ae=>({...Ae,name:se.target.value})),disabled:!u||E,placeholder:q?" ":"Tree Name",className:a?"text-sm py-2":"text-sm"})]})}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:`font-medium ${a?"text-xs":"text-sm"}`,children:q?" ":"Tree Description"}),o.jsx(kd,{value:u?q?oe.description||"":oe.descriptionEn||"":q?G.description||"":G.descriptionEn||"",onChange:se=>ie(Ae=>({...Ae,[q?"description":"descriptionEn"]:se.target.value})),disabled:!u||E,placeholder:q?"  ...":"Write a description for the tree...",rows:a?2:3,className:a?"text-sm py-2":"text-sm"})]}),o.jsxs("div",{className:`grid ${a?"grid-cols-2 gap-2":"grid-cols-2 sm:grid-cols-4 gap-3"}`,children:[o.jsxs("div",{className:`text-center rounded-lg ${a?"p-2":"p-3"} bg-secondary/50`,children:[o.jsx(kn,{className:`text-primary mx-auto ${a?"h-5 w-5 mb-1":"h-6 w-6 mb-1.5"}`}),o.jsx("div",{className:`font-bold text-foreground ${a?"text-lg":"text-xl"}`,children:G.membersCount}),o.jsx("div",{className:"text-muted-foreground text-xs",children:q?"":"Members"})]}),o.jsxs("div",{className:`text-center rounded-lg ${a?"p-2":"p-3"} bg-secondary/50`,children:[o.jsx(qn,{className:`text-green-600 mx-auto ${a?"h-5 w-5 mb-1":"h-6 w-6 mb-1.5"}`}),o.jsx("div",{className:`font-bold text-foreground ${a?"text-lg":"text-xl"}`,children:G.generationsCount}),o.jsx("div",{className:"text-muted-foreground text-xs",children:q?"":"Generations"})]})]}),u&&o.jsxs("div",{className:`flex ${a?"flex-col gap-2":"gap-3 pt-4"}`,children:[o.jsxs(ye,{onClick:Ee,className:"flex items-center gap-2",disabled:E,size:a?"sm":"default",children:[E?o.jsx(mr,{className:`animate-spin ${a?"h-3 w-3":"h-4 w-4"}`}):o.jsx(Xu,{className:`h-4 w-4 ${a?"h-3 w-3":""}`}),a?q?"":"Save":q?" ":"Save Changes"]}),o.jsx(ye,{variant:"outline",onClick:pe,disabled:E,size:a?"sm":"default",children:q?"":"Cancel"})]})]})]}),c==="members"&&o.jsxs("div",{className:`flex ${a?"flex-col gap-3":"justify-between items-center"} mb-6`,children:[o.jsx("h2",{className:`font-bold text-foreground ${a?"text-lg":"text-xl"}`,children:q?" ":"Family Members"}),o.jsxs(ye,{onClick:()=>y(!0),className:"flex items-center gap-2",size:a?"sm":"default",children:[o.jsx(Yu,{className:`h-4 w-4 ${a?"h-3 w-3":""}`}),a?q?"":"Add":q?" ":"Add Member"]})]}),c==="members"&&o.jsxs("div",{className:`grid ${a?"grid-cols-1 gap-3":"grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"}`,children:[Y.map(se=>o.jsx(et,{className:`overflow-hidden hover:shadow-md transition-shadow ${a?"rounded-lg":""}`,children:o.jsxs(rt,{className:"p-0",children:[o.jsx("div",{className:`relative ${a?"h-24":"h-28"} ${se.gender==="female"?"bg-gradient-to-r from-pink-500/20 to-pink-500/40":se.gender==="male"?"bg-gradient-to-r from-blue-500/20 to-blue-500/40":"bg-gradient-to-r from-primary/20 to-primary/40"}`,children:o.jsxs("div",{className:`absolute ${a?"top-1 right-1":"top-2 right-2"} flex gap-1`,children:[o.jsx(ye,{size:a?"icon":"sm",variant:"secondary",className:`bg-background/80 hover:bg-background ${a?"h-6 w-6 p-0":"h-7 w-7 p-0"}`,onClick:()=>{S(se),x(!0)},children:o.jsx(sa,{className:`h-3 w-3 ${a?"h-2.5 w-2.5":""}`})}),o.jsx(ye,{size:a?"icon":"sm",variant:"secondary",className:`bg-background/80 hover:bg-background text-destructive hover:text-destructive ${a?"h-6 w-6 p-0":"h-7 w-7 p-0"}`,onClick:()=>$e(se.id),disabled:E,children:o.jsx($a,{className:`h-3 w-3 ${a?"h-2.5 w-2.5":""}`})})]})}),o.jsxs("div",{className:`px-3 ${a?"-mt-8":"-mt-10"}`,children:[o.jsx("div",{className:`rounded-full bg-background border-4 border-background mx-auto flex items-center justify-center ${a?"w-12 h-12":"w-14 h-14"}`,children:se.avatar?o.jsx("img",{src:se.avatar,alt:"Avatar",className:"w-full h-full rounded-full object-cover",onError:_e}):o.jsx("div",{className:`w-full h-full rounded-full flex items-center justify-center ${se.gender==="female"?"bg-gradient-to-br from-pink-500/20 to-pink-500/40":se.gender==="male"?"bg-gradient-to-br from-blue-500/20 to-blue-500/40":"bg-gradient-to-br from-primary/20 to-primary/40"}`,children:be.createElement(ge(se.gender),{className:` ${se.gender==="female"?"text-pink-500":se.gender==="male"?"text-blue-500":"text-primary"} ${a?"h-5 w-5":"h-6 w-6"}`})})}),o.jsx("div",{className:`text-center ${a?"pt-2 pb-2":"pt-3 pb-3"}`,children:o.jsx("h3",{className:`font-bold text-foreground truncate ${a?"text-xs":"text-sm"}`,children:q?se.firstName||se.lastName?`${se.firstName||""} ${se.lastName||""}`.trim():" ":se.firstNameEn||se.lastNameEn?`${se.firstNameEn||""} ${se.lastNameEn||""}`.trim():"Unknown"})})]}),o.jsxs("div",{className:`border-t bg-muted/30 p-3 ${a?"p-2":""}`,children:[o.jsxs("div",{className:"space-y-1.5 text-xs",children:[se.birthPlace&&o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx(ei,{className:`text-muted-foreground flex-shrink-0 ${a?"h-3 w-3":"h-3.5 w-3.5"}`}),o.jsx("span",{className:"truncate",children:q?se.birthPlace:se.birthPlaceEn})]}),o.jsxs("div",{className:"flex items-center gap-1.5",children:[se.isAlive?o.jsx(br,{className:`text-green-500 flex-shrink-0 ${a?"h-3 w-3":"h-3.5 w-3.5"}`}):o.jsx(br,{className:`text-red-500 flex-shrink-0 ${a?"h-3 w-3":"h-3.5 w-3.5"}`}),o.jsx("span",{className:"truncate",children:se.isAlive?q?"  ":"Alive":q?"":"Deceased"})]}),(se.birthDate||se.deathDate)&&o.jsxs("div",{className:"flex items-center gap-1.5",children:[o.jsx(Xt,{className:`text-muted-foreground flex-shrink-0 ${a?"h-3 w-3":"h-3.5 w-3.5"}`}),o.jsxs("span",{className:"truncate",children:[Me(se.birthDate,se.deathDate)," ",q?"":"years"]})]})]}),o.jsx("div",{className:`mt-3 ${a?"mt-2":""}`,children:o.jsxs(ye,{size:"sm",variant:"outline",className:`w-full ${a?"h-7 text-xs":"h-8 text-xs"}`,onClick:()=>{const Ae={...se,parents:se.parentIds?se.parentIds.map(Re=>{const Ce=Y.find(ve=>ve.id===Re);return{id:Re,name:Ce?q?`${Ce.firstName} ${Ce.lastName}`:`${Ce.firstNameEn||Ce.firstName} ${Ce.lastNameEn||Ce.lastName}`:q?" ":"Unknown",relationship:q?"":"Parent"}}):[],spouses:se.spouseIds?se.spouseIds.map(Re=>{const Ce=Y.find(ve=>ve.id===Re);return{id:Re,name:Ce?q?`${Ce.firstName} ${Ce.lastName}`:`${Ce.firstNameEn||Ce.firstName} ${Ce.lastNameEn||Ce.lastName}`:q?" ":"Unknown"}}):[],childrenDetails:se.childrenIds?se.childrenIds.map(Re=>{const Ce=Y.find(ve=>ve.id===Re);return{id:Re,name:Ce?q?`${Ce.firstName} ${Ce.lastName}`:`${Ce.firstNameEn||Ce.firstName} ${Ce.lastNameEn||Ce.lastName}`:q?" ":"Unknown"}}):[]};R(Ae),k(!0)},children:[o.jsx(ra,{className:`mr-1 ${a?"h-3 w-3":"h-3.5 w-3.5"}`}),o.jsx("span",{className:a?"hidden":"hidden xs:inline",children:q?" ":"View Details"})]})})]})]})},se.id)),Y.length===0&&o.jsxs("div",{className:"col-span-full text-center py-8",children:[o.jsx(kn,{className:`text-muted-foreground mx-auto mb-3 ${a?"h-8 w-8":"h-10 w-10"}`}),o.jsx("h3",{className:"font-medium text-foreground mb-1 text-base",children:q?"    ":"No Family Members"}),o.jsx("p",{className:`text-muted-foreground mb-3 ${a?"text-xs":"text-sm"}`,children:q?"    ":"Start by adding your first family members"}),o.jsxs(ye,{onClick:()=>y(!0),size:"sm",children:[o.jsx(Yu,{className:`mr-1 ${a?"h-3 w-3":"h-4 w-4"}`}),o.jsx("span",{className:a?"hidden":"hidden xs:inline",children:q?" ":"Add Member"})]})]})]}),o.jsx(R4,{isOpen:m,onClose:()=>h(!1),onSubmit:ee,initialData:{id:G.id,name:G.name,description:G.description,descriptionEn:G.descriptionEn,isPublic:G.isPublic},mode:"edit"}),o.jsx(Rh,{isOpen:g,onClose:()=>y(!1),onSubmit:ft,familyTreeId:e||"",familyMembers:Y,mode:"create"}),o.jsx(Rh,{isOpen:p,onClose:()=>{x(!1),S(null)},onSubmit:De,familyTreeId:e||"",familyMembers:Y,initialData:T?{id:T.id,name:T.firstName||T.lastName?`${T.firstName||""} ${T.lastName||""}`.trim():"",gender:T.gender,birthDate:T.birthDate,deathDate:T.deathDate,birthPlace:T.birthPlace,birthPlaceEn:T.birthPlaceEn,occupation:T.occupation,occupationEn:T.occupationEn,isAlive:T.isAlive}:void 0,mode:"edit"}),o.jsx(oD,{person:I,isOpen:N,onClose:()=>{k(!1),R(null)}}),c==="settings"&&o.jsxs(et,{children:[o.jsx(ht,{className:a?"p-4":"",children:o.jsxs(gt,{className:"flex items-center gap-2",children:[o.jsx(gh,{className:`h-5 w-5 ${a?"h-4 w-4":""}`}),q?" ":"Tree Settings"]})}),o.jsx(rt,{className:`space-y-6 ${a?"p-4":""}`,children:o.jsxs("div",{className:`space-y-4 ${a?"space-y-3":""}`,children:[o.jsxs("div",{className:`border-t pt-4 ${a?"pt-3":""}`,children:[o.jsxs("h3",{className:"font-medium mb-4 flex items-center gap-2",children:[o.jsx(Di,{className:`h-4 w-4 ${a?"h-3 w-3":""}`}),q?" ":"Privacy Settings"]}),o.jsxs("div",{className:`flex ${a?"flex-col gap-3":"items-center justify-between"}`,children:[o.jsxs("div",{children:[o.jsx("p",{className:`font-medium ${a?"text-sm":""}`,children:q?" ":"Public Tree"}),o.jsx("p",{className:`text-muted-foreground ${a?"text-xs mt-1":"text-sm text-muted-foreground mt-1 sm:mt-0"}`,children:q?"   ":"Allow others to view the tree"})]}),o.jsx(ye,{variant:G.isPublic?"default":"outline",size:"sm",onClick:async()=>{try{_(!0);const se=!G.isPublic,Ae=await At.updateTree(parseInt(G.id),G.name,!se,q?G.description||"":G.descriptionEn||"");re(Re=>({...Re,isPublic:se,isPrivate:!se})),ie(Re=>({...Re,isPublic:se,isPrivate:!se})),As.getState().updateTree(Ae.id.toString(),{...Ae,isPrivate:!se,description:Ae.description||G.description||""}),O(q?"    ":"Privacy settings updated successfully"),setTimeout(()=>O(null),3e3)}catch{A(q?"    ":"Failed to update privacy settings")}finally{_(!1)}},disabled:E,className:a?"w-full":"",children:G.isPublic?q?"":"Public":q?"":"Private"})]}),o.jsx("div",{className:`p-3 bg-secondary/50 rounded-lg mt-4 ${a?"p-2 mt-3":""}`,children:o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx(Wu,{className:`text-primary mt-0.5 ${a?"h-3.5 w-3.5":"h-4 w-4"}`}),o.jsxs("div",{children:[o.jsx("p",{className:`font-medium ${a?"text-xs":"text-sm"}`,children:q?" ":"Privacy Information"}),o.jsx("p",{className:"text-muted-foreground mt-1 text-xs",children:q?"      .          .":"Public trees can be viewed and searched by everyone. Private trees can only be viewed by the owner and invited collaborators."})]})]})}),G.isPublic&&o.jsxs("div",{className:`space-y-3 mt-4 ${a?"space-y-2 mt-3":""}`,children:[o.jsx("h3",{className:"font-medium text-sm",children:q?"  ":"Public Share Link"}),o.jsxs("div",{className:`flex ${a?"flex-col gap-2":"flex-col sm:flex-row gap-2"}`,children:[o.jsx(Bt,{value:$?"Encrypting...":H?`${window.location.origin}/shared/${H}`:G.id?`${window.location.origin}/shared/${G.id}`:"Loading...",readOnly:!0,className:`flex-1 ${a?"text-xs py-2":"text-xs"}`,disabled:E||$||!H&&!G.id}),o.jsx(ye,{variant:"outline",size:"sm",disabled:E||$||!H&&!G.id,className:a?"w-full":"w-full sm:w-auto",onClick:()=>{const se=`${window.location.origin}/shared/${H||G.id}`;navigator.clipboard.writeText(se),D(!0),setTimeout(()=>D(!1),2e3)},children:q?"":"Copy"})]}),L&&o.jsx("p",{className:"text-sm text-green-600 mt-1",children:q?"  ":"Link copied"})]})]}),o.jsx("div",{className:`border-t pt-4 ${a?"pt-3":""}`,children:o.jsxs("div",{className:`flex ${a?"flex-col gap-3":"flex-col sm:flex-row sm:items-center justify-between gap-3"}`,children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-destructive text-sm",children:q?" ":"Delete Tree"}),o.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-0 text-xs",children:q?"    ":"Permanently delete the tree and all its data"})]}),o.jsxs(ye,{variant:"destructive",className:"flex items-center gap-2 w-full sm:w-auto",size:"sm",disabled:E,onClick:()=>w(!0),children:[o.jsx($a,{className:`h-4 w-4 ${a?"h-3 w-3":""}`}),q?"":"Delete"]})]})})]})})]}),o.jsx($4,{isOpen:b,onClose:()=>w(!1),onConfirm:async()=>{try{_(!0),await l(G.id),t("/trees")}catch{A(q?"   ":"Failed to delete tree")}finally{_(!1),w(!1)}},title:q?" ":"Confirm Deletion",message:q?"            .":"Are you sure you want to delete this tree? This action cannot be undone.",confirmText:q?"":"Delete",cancelText:q?"":"Cancel",variant:"destructive"}),c==="info"&&o.jsx("div",{className:`flex items-center gap-2 mt-4 ${a?"flex-wrap":""}`,children:o.jsxs(ye,{variant:"outline",size:"sm",onClick:()=>h(!0),className:a?"flex-1":"",children:[o.jsx(sa,{className:`mr-1 ${a?"h-3 w-3":"h-4 w-4"}`}),a?q?"":"Edit":q?" ":"Edit Tree"]})})]})},V0e=()=>{const{id:e}=pd(),{language:t}=Ft(),[n,r]=J.useState(null),[s,i]=J.useState(!0),[l,a]=J.useState(null),[c,d]=J.useState(!1),[u,f]=J.useState(!0),[m,h]=J.useState(!1),g=J.useRef(null),y=t==="ar",{isMobile:p}=_r(),x=async()=>{try{document.documentElement.requestFullscreen?await document.documentElement.requestFullscreen():document.documentElement.webkitRequestFullscreen?await document.documentElement.webkitRequestFullscreen():document.documentElement.msRequestFullscreen&&await document.documentElement.msRequestFullscreen(),d(!0),f(!1),setTimeout(()=>{h(!0)},100)}catch{f(!1),setTimeout(()=>{h(!0)},100)}};J.useEffect(()=>{const w=()=>{const N=document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement;d(!!N),N&&setTimeout(()=>{h(!0)},100)};return document.addEventListener("fullscreenchange",w),document.addEventListener("webkitfullscreenchange",w),document.addEventListener("msfullscreenchange",w),()=>{document.removeEventListener("fullscreenchange",w),document.removeEventListener("webkitfullscreenchange",w),document.removeEventListener("msfullscreenchange",w)}},[]),J.useEffect(()=>{(async()=>{var k;if(!e){a(y?"  ":"Tree ID is missing"),i(!1);return}let N=e;try{N=await cD(e)}catch{}try{i(!0),a(null);const I=await At.getPersonsInTree(Number(N));let R=null;try{const A=await At.getTreeById(Number(N));A&&A.data&&(R={id:A.data.id.toString(),name:A.data.name||(y?" ":"Family Tree"),nameEn:A.data.name||"Family Tree",description:A.data.description||"",descriptionEn:A.data.description||"",createdAt:A.data.createdAt||new Date().toISOString(),updatedAt:A.data.updatedAt||new Date().toISOString()})}catch{}let T=[];try{T=await At.getRelationships()}catch{}const S=new Map,E=new Map,_=new Map;T&&Array.isArray(T)&&T.forEach(A=>{var V,O,H,W,$,z,q,G,re,oe,ie,Y;const P=(V=A.personId)==null?void 0:V.toString(),B=(O=A.relatedPersonId)==null?void 0:O.toString(),L=I.some(te=>te.id.toString()===P),D=I.some(te=>te.id.toString()===B);if(!(!L||!D))if(["Father","father","Mother","mother","Parent","parent"].includes(A.relationshipType)){const te=P,we=B;S.has(te)||S.set(te,[]),(H=S.get(te))==null||H.push(we),E.has(we)||E.set(we,[]),(W=E.get(we))==null||W.push(te)}else if(["Child","child","Son","son","Daughter","daughter"].includes(A.relationshipType)){const te=P,we=B;S.has(we)||S.set(we,[]),($=S.get(we))==null||$.push(te),E.has(te)||E.set(te,[]),(z=E.get(te))==null||z.push(we)}else if(["Spouse","spouse","Husband","husband","Wife","wife"].includes(A.relationshipType))_.has(P)||_.set(P,[]),(q=_.get(P))!=null&&q.includes(B)||(G=_.get(P))==null||G.push(B),_.has(B)||_.set(B,[]),(re=_.get(B))!=null&&re.includes(P)||(oe=_.get(B))==null||oe.push(P);else{const te=P,we=B;S.has(te)||S.set(te,[]),(ie=S.get(te))==null||ie.push(we),E.has(we)||E.set(we,[]),(Y=E.get(we))==null||Y.push(te)}}),I.forEach(A=>{var B,L,D,V;if(["parentId","parent_id","fatherId","father_id","motherId","mother_id"].forEach(O=>{var H,W;if(A[O]&&A[O]!=="0"&&A[O]!==0){const $=A[O].toString(),z=A.id.toString();I.some(G=>G.id.toString()===$)&&(S.has(z)||S.set(z,[]),(H=S.get(z))==null||H.push($),E.has($)||E.set($,[]),(W=E.get($))==null||W.push(z))}}),A.parentIds&&Array.isArray(A.parentIds)&&A.parentIds.forEach(O=>{var H,W;if(O&&O!=="0"&&O!==0){const $=A.id.toString();I.some(q=>q.id.toString()===O.toString())&&(S.has($)||S.set($,[]),(H=S.get($))==null||H.push(O.toString()),E.has(O.toString())||E.set(O.toString(),[]),(W=E.get(O.toString()))==null||W.push($))}}),A.relationships&&A.relationships.spouses&&A.relationships.spouses.forEach(O=>{var W,$;let H=null;if(typeof O=="string"?H=O:typeof O=="object"&&(O!=null&&O.person)?typeof O.person=="string"?H=O.person:typeof O.person=="object"&&O.person.id&&(H=O.person.id.toString()):typeof O=="object"&&(O!=null&&O.id)&&(H=O.id.toString()),H){const z=A.id.toString();I.some(G=>G.id.toString()===H)&&H!==z&&((_.get(z)||[]).includes(H)||(_.has(z)||_.set(z,[]),(W=_.get(z))==null||W.push(H),_.has(H)||_.set(H,[]),($=_.get(H))==null||$.push(z)))}}),A.relationships){if(A.relationships.father){let O=null;if(typeof A.relationships.father=="string"?O=A.relationships.father:typeof A.relationships.father=="object"&&A.relationships.father.id&&(O=A.relationships.father.id.toString()),O){const H=A.id.toString();I.some($=>$.id.toString()===O)&&(S.has(H)||S.set(H,[]),(B=S.get(H))==null||B.push(O),E.has(O)||E.set(O,[]),(L=E.get(O))==null||L.push(H))}}if(A.relationships.mother){let O=null;if(typeof A.relationships.mother=="string"?O=A.relationships.mother:typeof A.relationships.mother=="object"&&A.relationships.mother.id&&(O=A.relationships.mother.id.toString()),O){const H=A.id.toString();I.some($=>$.id.toString()===O)&&(S.has(H)||S.set(H,[]),(D=S.get(H))==null||D.push(O),E.has(O)||E.set(O,[]),(V=E.get(O))==null||V.push(H))}}}}),I.forEach(A=>{const P=A.id.toString();I.forEach(B=>{var H,W,$,z;const L=B.id.toString();if(P===L)return;const D=B;if((D.parentIds||D.parents||D.parent_ids||[]).some(q=>(typeof q=="object"&&q.id?q.id.toString():q.toString())===P)){const q=L,G=P;S.has(q)||S.set(q,[]),(H=S.get(q))!=null&&H.includes(G)||(W=S.get(q))==null||W.push(G),E.has(G)||E.set(G,[]),($=E.get(G))!=null&&$.includes(q)||(z=E.get(G))==null||z.push(q)}})});const M={id:N,name:(R==null?void 0:R.name)||(y?" ":"Family Tree"),nameEn:(R==null?void 0:R.nameEn)||"Family Tree",description:(R==null?void 0:R.description)||"",descriptionEn:(R==null?void 0:R.descriptionEn)||"",rootPersonId:(()=>{if(n!=null&&n.rootPersonId&&I.some(P=>P.id.toString()===n.rootPersonId))return n.rootPersonId;for(const A of I)if(A.isRoot)return A.id.toString();for(const A of I){const P=A.id.toString();if(!S.has(P))return P}return I.length>0?I[0].id.toString():"1"})(),persons:I.map(A=>{var H,W,$,z,q,G,re;let P="",B="";if(A.name){const oe=A.name.split(" ");P=oe[0]||"",B=oe.slice(1).join(" ")||""}const L=S.get(A.id.toString())||[],D=_.get(A.id.toString())||[],V=E.get(A.id.toString())||[];let O="male";return A.gender==="female"&&(O="female"),{id:A.id.toString(),firstName:A.firstName||P||A.name||"",lastName:A.lastName||B||"",gender:O,birthDate:((H=A.birth)==null?void 0:H.date)||A.birthDate||"",birthPlace:(($=(W=A.birth)==null?void 0:W.place)==null?void 0:$.city)||A.birthPlace||"",isAlive:!A.isDeceased,photo:((z=A.primaryPhoto)==null?void 0:z.url)||A.photo||A.photoUrl||"/api/placeholder/100/100",generation:((q=A.position)==null?void 0:q.generation)||0,position:{x:((G=A.position)==null?void 0:G.x)||0,y:((re=A.position)==null?void 0:re.y)||0},parentIds:L.map(oe=>oe.toString()),spouseIds:D.map(oe=>oe.toString()),childrenIds:V.map(oe=>oe.toString())}}),createdAt:(R==null?void 0:R.createdAt)||new Date().toISOString(),updatedAt:(R==null?void 0:R.updatedAt)||new Date().toISOString()};r(M)}catch(I){a(((k=I.response)==null?void 0:k.status)===404?y?"  ":"Tree not found":y?"   ":"Failed to load tree")}finally{i(!1)}})()},[e,y]);const b=()=>{document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()};return s?o.jsx("div",{className:"fixed inset-0 bg-background flex items-center justify-center z-50",children:o.jsxs("div",{className:"text-center",children:[o.jsx(mr,{className:`text-muted-foreground mx-auto mb-4 animate-spin ${p?"h-8 w-8":"h-12 w-12"}`}),o.jsx("p",{className:`text-muted-foreground ${p?"text-sm":""}`,children:y?"  ...":"Loading tree..."})]})}):l?o.jsx("div",{className:"fixed inset-0 bg-background flex items-center justify-center z-50",children:o.jsxs("div",{className:`text-center p-4 ${p?"p-2":""}`,children:[o.jsx(Qs,{className:`text-destructive mx-auto mb-4 ${p?"h-8 w-8":"h-12 w-12"}`}),o.jsx("h2",{className:`font-semibold mb-2 ${p?"text-lg":"text-xl"}`,children:y?"":"Error"}),o.jsx("p",{className:`text-muted-foreground mb-4 ${p?"text-sm":""}`,children:l}),o.jsx(ye,{onClick:()=>window.history.back(),size:p?"sm":"default",children:y?"":"Go Back"})]})}):n?u?o.jsx("div",{className:"fixed inset-0 bg-background flex items-center justify-center z-50",children:o.jsxs("div",{className:`text-center mx-auto ${p?"p-4 max-w-sm":"p-6 max-w-md"}`,children:[o.jsx(qn,{className:`text-primary mx-auto mb-6 ${p?"h-12 w-12":"h-16 w-16"}`}),o.jsx("h1",{className:`font-bold mb-4 ${p?"text-xl":"text-2xl"}`,children:y?"  ":"View Family Tree"}),o.jsx("p",{className:`text-muted-foreground mb-6 ${p?"text-sm":""}`,children:y?"          ":"Click the button below to start viewing the family tree in fullscreen mode"}),o.jsxs("div",{className:`space-y-4 ${p?"space-y-3":""}`,children:[o.jsx(ye,{onClick:x,size:p?"default":"lg",className:"w-full",children:y?" ":"Start Viewing"}),o.jsx(ye,{variant:"outline",onClick:()=>window.history.back(),size:p?"default":"lg",className:"w-full",children:y?"":"Go Back"})]})]})}):o.jsxs("div",{ref:g,className:"fixed inset-0 bg-background z-50",children:[o.jsxs("div",{className:"absolute top-4 left-4 right-4 z-10 flex items-center justify-between",children:[o.jsxs("div",{className:`bg-background/80 backdrop-blur-sm rounded-lg px-4 py-2 ${p?"px-3 py-1.5":""}`,children:[o.jsx("h1",{className:`font-semibold ${p?"text-base":"text-lg"}`,children:y?n.name:n.nameEn}),o.jsxs("p",{className:`text-muted-foreground ${p?"text-xs":"text-sm"}`,children:[n.persons.length," ",y?n.persons.length===1?"":"":n.persons.length===1?"member":"members"]})]}),o.jsx(ye,{variant:"outline",size:"sm",onClick:c?b:x,className:`bg-background/80 backdrop-blur-sm ${p?"h-8 px-2 text-xs":""}`,children:c?o.jsxs(o.Fragment,{children:[o.jsx(II,{className:`h-4 w-4 ${p?"h-3 w-3 mr-1":"mr-2"}`}),o.jsx("span",{className:p?"hidden":"",children:y?"   ":"Exit Fullscreen"})]}):o.jsxs(o.Fragment,{children:[o.jsx(qn,{className:`h-4 w-4 ${p?"h-3 w-3 mr-1":"mr-2"}`}),o.jsx("span",{className:p?"hidden":"",children:y?" ":"Fullscreen"})]})})]}),o.jsx("div",{className:"w-full h-full pt-20",children:o.jsx(et,{className:"w-full h-full border-0 rounded-none",children:o.jsx("div",{className:"w-full h-full shared-tree-container",style:{width:"100%",height:"100%",minHeight:"calc(100vh - 100px)"},children:m&&o.jsx("div",{className:"w-full h-full",style:{width:"100%",height:"100%"},children:o.jsx(aD,{persons:n.persons,rootPersonId:n.rootPersonId,onSelectPerson:()=>{},onEditPerson:()=>{},onDeletePerson:()=>{},onAddChild:()=>{},onAddSpouse:()=>{},onAddFather:()=>{},onAddMother:()=>{},relationships:(n==null?void 0:n.relationships)||[],isOwnedTree:!1})})})})})]}):o.jsx("div",{className:"fixed inset-0 bg-background flex items-center justify-center z-50",children:o.jsxs("div",{className:`text-center p-4 ${p?"p-2":""}`,children:[o.jsx(qn,{className:`text-muted-foreground mx-auto mb-4 ${p?"h-8 w-8":"h-12 w-12"}`}),o.jsx("p",{className:`text-muted-foreground ${p?"text-sm":""}`,children:y?"    ":"Tree not found"})]})})},W0e=()=>{var k,I,R,T,S,E,_,M,A,P,B;const{id:e}=pd(),{language:t}=Ft(),{user:n}=Mr(),{trees:r,currentTree:s}=As(),{isMobile:i}=_r(),l=jr(),[a,c]=J.useState(null),[d,u]=J.useState([]),[f,m]=J.useState(!0),[h,g]=J.useState(null),[y,p]=J.useState(!1),x=t==="ar",b=(()=>{if(!n||!a)return!1;const L=a.treeId||a.familyTreeId;if(!L)return!1;const D=r.find(V=>V.id===L)||s;return D?D.ownerId===n.id||D.userRole==="owner":!1})();J.useEffect(()=>{(async()=>{var V,O,H,W,$,z,q,G,re,oe,ie,Y,te,we,me,Ee,pe,ee,ft,$e,De,ge,Me,_e,ke,se,Ae,Re,Ce;if(!e){g(t==="ar"?"   ":"Person ID not found"),m(!1);return}const D=parseInt(e);if(isNaN(D)||D<=0){g(t==="ar"?"   : "+e:"Invalid person ID: "+e),m(!1);return}try{m(!0),g(null);let ve;try{const le=await At.getPersonById(D);if(le)le.hasOwnProperty("data")?ve=le.data:ve=le;else throw new Error("Empty response from API")}catch(le){throw le}if(!ve)throw new Error("No person data received");const Be={id:(ve.id||D).toString(),firstName:((V=ve.arabicName)==null?void 0:V.firstName)||ve.firstName||ve.name||"",firstNameEn:ve.firstName||ve.name||"",lastName:((O=ve.arabicName)==null?void 0:O.lastName)||ve.lastName||"",lastNameEn:ve.lastName||"",gender:(()=>{const le=ve.gender;return le==="male"||le==="Male"||le===1||le==="1"||le==="M"||le==="m"?"male":le==="female"||le==="Female"||le===2||le==="2"||le==="F"||le==="f"?"female":"unknown"})(),birthDate:ve.birthDate||((H=ve.birth)==null?void 0:H.date)||void 0,deathDate:ve.deathDate||((W=ve.death)==null?void 0:W.date)||void 0,birthPlace:ve.birthPlace||((z=($=ve.birth)==null?void 0:$.place)==null?void 0:z.city)||void 0,birthPlaceEn:ve.birthPlace||((G=(q=ve.birth)==null?void 0:q.place)==null?void 0:G.city)||void 0,deathPlace:ve.deathPlace||((oe=(re=ve.death)==null?void 0:re.place)==null?void 0:oe.city)||void 0,deathPlaceEn:ve.deathPlace||((Y=(ie=ve.death)==null?void 0:ie.place)==null?void 0:Y.city)||void 0,isAlive:!ve.isDeceased,generation:(()=>{var le,fe;return typeof ve.generation=="number"&&ve.generation>=0?ve.generation:((le=ve.position)==null?void 0:le.generation)!==void 0&&ve.position.generation>=0?ve.position.generation:((fe=ve.position)==null?void 0:fe.level)!==void 0&&ve.position.level>=0?ve.position.level:ve.level!==void 0&&ve.level>=0?ve.level:1})(),photo:ve.photoUrl||((te=ve.primaryPhoto)==null?void 0:te.url)||((me=(we=ve.photos)==null?void 0:we[0])==null?void 0:me.url)||void 0,email:ve.email||((Ee=ve.contact)==null?void 0:Ee.email)||"",phone:ve.phone||((pe=ve.contact)==null?void 0:pe.phone)||"",occupation:Array.isArray(ve.occupation)&&ve.occupation.length>0?ve.occupation[0].title:ve.occupation||"",occupationEn:Array.isArray(ve.occupation)&&ve.occupation.length>0?ve.occupation[0].title:ve.occupation||"",education:ve.education||"",educationEn:ve.education||"",biography:ve.biography||ve.notes||"",biographyEn:ve.biography||ve.notes||"",treeId:((ee=ve.familyTreeId)==null?void 0:ee.toString())||((ft=ve.treeId)==null?void 0:ft.toString())||ve.tree||"",familyTreeId:(($e=ve.familyTreeId)==null?void 0:$e.toString())||((De=ve.treeId)==null?void 0:De.toString())||ve.tree||"",createdAt:ve.createdAt||new Date().toISOString(),updatedAt:ve.updatedAt||new Date().toISOString(),relationships:ve.relationships||{},middleName:ve.middleName||"",nickname:ve.nickname||"",fullName:ve.fullName||"",displayName:ve.displayName||"",arabicName:ve.arabicName||{},fullArabicName:ve.fullArabicName||"",age:ve.age||void 0,physical:ve.physical||{},contact:ve.contact||{},photos:ve.photos||[],documents:ve.documents||[],primaryPhoto:ve.primaryPhoto||{},notes:ve.notes||"",military:ve.military||{},religion:ve.religion||"",tags:ve.tags||[],position:ve.position||{},createdBy:ve.createdBy||"",status:ve.status||"active"};c(Be);try{const le=ve.familyTreeId||ve.treeId||ve.tree;if(le){const fe=await At.getPersonsInTree(le),Te=ve.relationships||{},at=[];if(Te.father){const je=typeof Te.father=="string"?Te.father:Te.father.id||Te.father._id;if(je){const he=fe.find(Pe=>Pe.id==je);he&&at.push({id:((ge=he.id)==null?void 0:ge.toString())||"",firstName:he.firstName||"",firstNameEn:he.firstName||"",lastName:he.lastName||"",lastNameEn:he.lastName||"",relationship:t==="ar"?"":"Father",relationshipEn:"Father",photo:((Me=he.primaryPhoto)==null?void 0:Me.url)||((ke=(_e=he.photos)==null?void 0:_e[0])==null?void 0:ke.url)||void 0})}}if(Te.mother){const je=typeof Te.mother=="string"?Te.mother:Te.mother.id||Te.mother._id;if(je){const he=fe.find(Pe=>Pe.id==je);he&&at.push({id:((se=he.id)==null?void 0:se.toString())||"",firstName:he.firstName||"",firstNameEn:he.firstName||"",lastName:he.lastName||"",lastNameEn:he.lastName||"",relationship:t==="ar"?"":"Mother",relationshipEn:"Mother",photo:((Ae=he.primaryPhoto)==null?void 0:Ae.url)||((Ce=(Re=he.photos)==null?void 0:Re[0])==null?void 0:Ce.url)||void 0})}}Te.spouses&&Array.isArray(Te.spouses)&&Te.spouses.forEach(je=>{var Pe,ot,tt,qe,ze,it;const he=typeof je=="string"?je:(typeof je.person=="string"?je.person:((Pe=je.person)==null?void 0:Pe.id)||((ot=je.person)==null?void 0:ot._id))||je.id||je._id;if(he){const st=fe.find(Ve=>Ve.id==he);st&&at.push({id:((tt=st.id)==null?void 0:tt.toString())||"",firstName:st.firstName||"",firstNameEn:st.firstName||"",lastName:st.lastName||"",lastNameEn:st.lastName||"",relationship:t==="ar"?"":"Spouse",relationshipEn:"Spouse",photo:((qe=st.primaryPhoto)==null?void 0:qe.url)||((it=(ze=st.photos)==null?void 0:ze[0])==null?void 0:it.url)||void 0})}}),Te.children&&Array.isArray(Te.children)&&Te.children.forEach(je=>{var Pe,ot,tt,qe;const he=typeof je=="string"?je:je.id||je._id;if(he){const ze=fe.find(it=>it.id==he);ze&&at.push({id:((Pe=ze.id)==null?void 0:Pe.toString())||"",firstName:ze.firstName||"",firstNameEn:ze.firstName||"",lastName:ze.lastName||"",lastNameEn:ze.lastName||"",relationship:t==="ar"?"":"Child",relationshipEn:"Child",photo:((ot=ze.primaryPhoto)==null?void 0:ot.url)||((qe=(tt=ze.photos)==null?void 0:tt[0])==null?void 0:qe.url)||void 0})}}),Te.siblings&&Array.isArray(Te.siblings)&&Te.siblings.forEach(je=>{var Pe,ot,tt,qe;const he=typeof je=="string"?je:je.id||je._id;if(he){const ze=fe.find(it=>it.id==he);ze&&at.push({id:((Pe=ze.id)==null?void 0:Pe.toString())||"",firstName:ze.firstName||"",firstNameEn:ze.firstName||"",lastName:ze.lastName||"",lastNameEn:ze.lastName||"",relationship:t==="ar"?"":"Sibling",relationshipEn:"Sibling",photo:((ot=ze.primaryPhoto)==null?void 0:ot.url)||((qe=(tt=ze.photos)==null?void 0:tt[0])==null?void 0:qe.url)||void 0})}}),ve.parentIds&&Array.isArray(ve.parentIds)&&ve.parentIds.forEach(je=>{var he,Pe,ot,tt;if(!at.some(qe=>qe.id===je)){const qe=fe.find(ze=>ze.id==je);if(qe){const ze=qe.gender==="female"?t==="ar"?"":"Mother":t==="ar"?"":"Father",it=qe.gender==="female"?"Mother":"Father";at.push({id:((he=qe.id)==null?void 0:he.toString())||"",firstName:qe.firstName||"",firstNameEn:qe.firstName||"",lastName:qe.lastName||"",lastNameEn:qe.lastName||"",relationship:t==="ar"?ze:it,relationshipEn:it,photo:((Pe=qe.primaryPhoto)==null?void 0:Pe.url)||((tt=(ot=qe.photos)==null?void 0:ot[0])==null?void 0:tt.url)||void 0})}}}),ve.spouseIds&&Array.isArray(ve.spouseIds)&&ve.spouseIds.forEach(je=>{var he,Pe,ot,tt;if(!at.some(qe=>qe.id===je)){const qe=fe.find(ze=>ze.id==je);qe&&at.push({id:((he=qe.id)==null?void 0:he.toString())||"",firstName:qe.firstName||"",firstNameEn:qe.firstName||"",lastName:qe.lastName||"",lastNameEn:qe.lastName||"",relationship:t==="ar"?"":"Spouse",relationshipEn:"Spouse",photo:((Pe=qe.primaryPhoto)==null?void 0:Pe.url)||((tt=(ot=qe.photos)==null?void 0:ot[0])==null?void 0:tt.url)||void 0})}}),ve.childrenIds&&Array.isArray(ve.childrenIds)&&ve.childrenIds.forEach(je=>{var he,Pe,ot,tt;if(!at.some(qe=>qe.id===je)){const qe=fe.find(ze=>ze.id==je);qe&&at.push({id:((he=qe.id)==null?void 0:he.toString())||"",firstName:qe.firstName||"",firstNameEn:qe.firstName||"",lastName:qe.lastName||"",lastNameEn:qe.lastName||"",relationship:t==="ar"?"":"Child",relationshipEn:"Child",photo:((Pe=qe.primaryPhoto)==null?void 0:Pe.url)||((tt=(ot=qe.photos)==null?void 0:ot[0])==null?void 0:tt.url)||void 0})}}),at.length===0&&fe.filter(he=>he.id&&parseInt(he.id.toString())!==D).slice(0,5).forEach(he=>{var Pe;at.push({id:((Pe=he.id)==null?void 0:Pe.toString())||"",firstName:he.firstName||"",firstNameEn:he.firstName||"",lastName:he.lastName||"",lastNameEn:he.lastName||"",relationship:t==="ar"?"":"Related",relationshipEn:"Related"})}),u(at)}else u([{id:"2",firstName:"",firstNameEn:"Fatima",lastName:"",lastNameEn:"Ahmed",relationship:"",relationshipEn:"Daughter"},{id:"3",firstName:"",firstNameEn:"Mohammed",lastName:"",lastNameEn:"Ahmed",relationship:"",relationshipEn:"Son"}])}catch{u([{id:"2",firstName:"",firstNameEn:"Fatima",lastName:"",lastNameEn:"Ahmed",relationship:"",relationshipEn:"Daughter"},{id:"3",firstName:"",firstNameEn:"Mohammed",lastName:"",lastNameEn:"Ahmed",relationship:"",relationshipEn:"Son"}])}}catch{g(t==="ar"?"    ":"Failed to load person data")}finally{m(!1)}})()},[e,t]);const w=(L,D)=>{if(!L)return 0;let V;try{if(L.includes("T"))V=new Date(L);else if(L.includes("-")){const $=L.split("-");$.length===3?V=new Date(parseInt($[0]),parseInt($[1])-1,parseInt($[2])):V=new Date(L)}else if(L.includes("/")){const $=L.split("/");$.length===3?V=new Date(parseInt($[2]),parseInt($[0])-1,parseInt($[1])):V=new Date(L)}else V=new Date(L)}catch{return 0}if(isNaN(V.getTime()))return 0;let O;if(D&&D.trim()!=="")try{if(D.includes("T"))O=new Date(D);else if(D.includes("-")){const $=D.split("-");$.length===3?O=new Date(parseInt($[0]),parseInt($[1])-1,parseInt($[2])):O=new Date(D)}else if(D.includes("/")){const $=D.split("/");$.length===3?O=new Date(parseInt($[2]),parseInt($[0])-1,parseInt($[1])):O=new Date(D)}else O=new Date(D);isNaN(O.getTime())&&(O=new Date)}catch{O=new Date}else O=new Date;let H=O.getFullYear()-V.getFullYear();const W=O.getMonth()-V.getMonth();return(W<0||W===0&&O.getDate()<V.getDate())&&H--,H>=0?H:0},N=L=>L===1?mh:L===2?Xt:ta;return f?o.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:o.jsxs("div",{className:"text-center",children:[o.jsx(mr,{className:"h-12 w-12 animate-spin text-primary mx-auto mb-4"}),o.jsx("p",{className:"text-muted-foreground",children:x?"   ...":"Loading person profile..."})]})}):h?o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"mx-auto w-16 h-16 bg-destructive/10 rounded-full flex items-center justify-center mb-4",children:o.jsx(Qs,{className:"h-8 w-8 text-destructive"})}),o.jsx("h2",{className:"text-2xl font-bold text-destructive mb-4",children:h}),o.jsxs("p",{className:"text-muted-foreground mb-4",children:[t==="ar"?"  : ":"Requested Person ID: ",o.jsx("code",{className:"bg-muted px-2 py-1 rounded",children:e})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 justify-center",children:[o.jsx(ye,{onClick:()=>l(-1),children:t==="ar"?"":"Go Back"}),o.jsx(ye,{variant:"outline",onClick:()=>window.location.reload(),children:t==="ar"?" ":"Try Again"})]})]}):a?(N(a.generation),o.jsxs("div",{className:"space-y-6",children:[o.jsx("div",{children:o.jsx(ye,{asChild:!0,variant:"ghost",size:i?"sm":"default",children:o.jsxs(_t,{to:`/trees/${a==null?void 0:a.treeId}`,className:"flex items-center",children:[o.jsx(fl,{className:`h-4 w-4 ${i?"h-3 w-3":"mr-2"}`}),o.jsx("span",{className:i?"hidden":"",children:x?" ":"Back to Tree"})]})})}),o.jsx(et,{children:o.jsx(ht,{className:i?"p-4":"",children:o.jsxs("div",{className:`flex ${i?"flex-col gap-4":"flex-col sm:flex-row sm:items-start gap-6"}`,children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx("div",{className:`rounded-full flex items-center justify-center ${(a==null?void 0:a.gender)==="male"?"bg-blue-100 text-blue-600":(a==null?void 0:a.gender)==="female"?"bg-pink-100 text-pink-600":"bg-muted text-muted-foreground"} ${i?"w-24 h-24":"w-32 h-32"}`,children:a!=null&&a.photo?o.jsx("img",{src:a.photo,alt:x?a.firstName:a.firstNameEn,className:"w-full h-full rounded-full object-cover"}):o.jsx(Xt,{className:`text-muted-foreground ${i?"h-12 w-12":"h-16 w-16"}`})})}),o.jsx("div",{className:"flex-1",children:o.jsxs("div",{className:`flex ${i?"flex-col gap-3":"flex-col sm:flex-row sm:items-start sm:justify-between gap-4"}`,children:[o.jsxs("div",{children:[o.jsx("h1",{className:`font-bold text-foreground ${i?"text-xl mb-1":"text-3xl mb-2"}`,children:x?`${a==null?void 0:a.firstName} ${a==null?void 0:a.lastName}`:`${a==null?void 0:a.firstNameEn} ${a==null?void 0:a.lastNameEn}`}),o.jsxs("div",{className:`flex flex-wrap items-center gap-2 ${i?"text-xs":"text-sm"} text-muted-foreground mb-3`,children:[(a==null?void 0:a.birthDate)&&o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(Lr,{className:`h-3 w-3 ${i?"h-2.5 w-2.5":"h-4 w-4"}`}),o.jsxs("span",{children:[w(a.birthDate,a.deathDate)," ",x?"":"years old",!a.isAlive&&` (${x?"":"Deceased"})`]})]}),o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(qn,{className:`h-3 w-3 ${i?"h-2.5 w-2.5":"h-4 w-4"}`}),o.jsx("span",{children:x?` ${(a==null?void 0:a.generation)||1}`:`Generation ${(a==null?void 0:a.generation)||1}`})]}),(a==null?void 0:a.gender)!=="unknown"&&o.jsx(Gn,{variant:(a==null?void 0:a.gender)==="male"?"secondary":"outline",className:i?"text-xs px-1.5 py-0.5":"",children:(a==null?void 0:a.gender)==="male"?x?"":"Male":x?"":"Female"}),!(a!=null&&a.isAlive)&&o.jsx(Gn,{variant:"outline",className:i?"text-xs px-1.5 py-0.5":"",children:x?"":"Deceased"})]}),o.jsxs("div",{className:`space-y-1 ${i?"text-xs":"text-sm"}`,children:[(a==null?void 0:a.birthDate)&&o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Lr,{className:`h-3 w-3 ${i?"h-2.5 w-2.5":"h-4 w-4"} text-green-600`}),o.jsx("span",{className:"font-medium",children:x?" :":"Born:"}),o.jsx("span",{children:new Date(a.birthDate).toLocaleDateString(x?"ar-SA":"en-US")}),a.birthPlace&&o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"text-muted-foreground",children:x?"":"in"}),o.jsx("span",{children:x?a.birthPlace:a.birthPlaceEn})]})]}),(a==null?void 0:a.deathDate)&&o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Lr,{className:`h-3 w-3 ${i?"h-2.5 w-2.5":"h-4 w-4"} text-red-600`}),o.jsx("span",{className:"font-medium",children:x?" :":"Died:"}),o.jsx("span",{children:new Date(a.deathDate).toLocaleDateString(x?"ar-SA":"en-US")}),a.deathPlace&&o.jsxs(o.Fragment,{children:[o.jsx("span",{className:"text-muted-foreground",children:x?"":"in"}),o.jsx("span",{children:x?a.deathPlace:a.deathPlaceEn})]})]})]})]}),o.jsx("div",{className:`flex ${i?"gap-1":"gap-2"}`,children:b&&o.jsxs(ye,{size:"sm",variant:"outline",onClick:()=>p(!0),children:[o.jsx(sa,{className:`h-4 w-4 ${i?"h-33 w-3":"mr-2"}`}),o.jsx("span",{className:i?"hidden":"",children:x?"":"Edit"})]})})]})})]})})}),o.jsxs("div",{className:`grid ${i?"grid-cols-1 gap-4":"grid-cols-1 lg:grid-cols-3 gap-6"}`,children:[o.jsxs("div",{className:`space-y-4 ${i?"lg:col-span-1":"lg:col-span-2"} space-y-4`,children:[o.jsxs(et,{children:[o.jsx(ht,{className:i?"p-4":"",children:o.jsxs(gt,{className:"flex items-center gap-2",children:[o.jsx(Xt,{className:`h-4 w-4 ${i?"h-3.5 w-3.5":"h-5 w-5"}`}),x?" ":"Person Summary"]})}),o.jsx(rt,{className:`space-y-3 ${i?"p-4":""}`,children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[o.jsxs("div",{className:`flex justify-between items-center p-2 rounded-lg ${i?"p-2":"p-3"} bg-muted/50`,children:[o.jsx("span",{className:`font-medium ${i?"text-xs":"text-sm"}`,children:x?":":"Name:"}),o.jsx("span",{className:`text-foreground truncate max-w-[60%] text-right ${i?"text-xs":"text-sm"}`,children:x?`${a==null?void 0:a.firstName} ${a==null?void 0:a.lastName}`:`${a==null?void 0:a.firstNameEn} ${a==null?void 0:a.lastNameEn}`})]}),(a==null?void 0:a.birthDate)&&o.jsxs("div",{className:`flex justify-between items-center p-2 rounded-lg ${i?"p-2":"p-3"} bg-muted/50`,children:[o.jsx("span",{className:`font-medium ${i?"text-xs":"text-sm"}`,children:x?" :":"Date of Birth:"}),o.jsx("span",{className:`text-foreground ${i?"text-xs":"text-sm"}`,children:new Date(a.birthDate).toLocaleDateString(x?"ar-SA":"en-US")})]}),o.jsxs("div",{className:`flex justify-between items-center p-2 rounded-lg ${i?"p-2":"p-3"} bg-muted/50`,children:[o.jsx("span",{className:`font-medium ${i?"text-xs":"text-sm"}`,children:x?":":"Status:"}),o.jsx(Gn,{variant:a!=null&&a.isAlive?"default":"destructive",className:`font-normal ${i?"text-xs px-1.5 py-0.5":"text-xs"}`,children:a!=null&&a.isAlive?x?"  ":"Alive":x?"":"Deceased"})]}),(a==null?void 0:a.occupation)&&o.jsxs("div",{className:`flex justify-between items-center p-2 rounded-lg ${i?"p-2":"p-3"} bg-muted/50`,children:[o.jsx("span",{className:`font-medium ${i?"text-xs":"text-sm"}`,children:x?":":"Occupation:"}),o.jsx("span",{className:`text-foreground truncate max-w-[60%] text-right ${i?"text-xs":"text-sm"}`,children:x?a.occupation:a.occupationEn})]}),(a==null?void 0:a.birthPlace)&&o.jsxs("div",{className:`flex justify-between items-center p-2 rounded-lg ${i?"p-2":"p-3"} bg-muted/50`,children:[o.jsx("span",{className:`font-medium ${i?"text-xs":"text-sm"}`,children:x?" :":"Place of Birth:"}),o.jsx("span",{className:`text-foreground truncate max-w-[60%] text-right ${i?"text-xs":"text-sm"}`,children:x?a.birthPlace:a.birthPlaceEn})]}),o.jsxs("div",{className:`flex justify-between items-center p-2 rounded-lg ${i?"p-2":"p-3"} bg-muted/50`,children:[o.jsx("span",{className:`font-medium ${i?"text-xs":"text-sm"}`,children:x?":":"Generation:"}),o.jsx("span",{className:`text-foreground ${i?"text-xs":"text-sm"}`,children:x?` ${(a==null?void 0:a.generation)||1}`:`Generation ${(a==null?void 0:a.generation)||1}`})]}),(a==null?void 0:a.gender)!=="unknown"&&o.jsxs("div",{className:`flex justify-between items-center p-2 rounded-lg ${i?"p-2":"p-3"} bg-muted/50`,children:[o.jsx("span",{className:`font-medium ${i?"text-xs":"text-sm"}`,children:x?":":"Gender:"}),o.jsx(Gn,{variant:(a==null?void 0:a.gender)==="male"?"secondary":"outline",className:i?"text-xs px-1.5 py-0.5":"",children:(a==null?void 0:a.gender)==="male"?x?"":"Male":x?"":"Female"})]}),(a==null?void 0:a.birthDate)&&o.jsxs("div",{className:`flex justify-between items-center p-2 rounded-lg ${i?"p-2":"p-3"} bg-muted/50`,children:[o.jsx("span",{className:`font-medium ${i?"text-xs":"text-sm"}`,children:x?":":"Age:"}),o.jsxs("span",{className:`text-foreground ${i?"text-xs":"text-sm"}`,children:[w(a.birthDate,a.deathDate)," ",x?"":"years"]})]}),(a==null?void 0:a.status)&&o.jsxs("div",{className:`flex justify-between items-center p-2 rounded-lg ${i?"p-2":"p-3"} bg-muted/50`,children:[o.jsx("span",{className:`font-medium ${i?"text-xs":"text-sm"}`,children:x?":":"Status:"}),o.jsx("span",{className:`text-foreground ${i?"text-xs":"text-sm"}`,children:a.status})]})]})})]}),((a==null?void 0:a.email)||(a==null?void 0:a.phone)||((k=a==null?void 0:a.contact)==null?void 0:k.email)||((I=a==null?void 0:a.contact)==null?void 0:I.phone)||((R=a==null?void 0:a.contact)==null?void 0:R.address))&&o.jsxs(et,{children:[o.jsx(ht,{className:i?"p-4":"",children:o.jsxs(gt,{className:"flex items-center gap-2",children:[o.jsx(Gu,{className:`h-4 w-4 ${i?"h-3.5 w-3.5":"h-5 w-5"}`}),x?" ":"Contact Information"]})}),o.jsxs(rt,{className:`space-y-2 ${i?"p-4":"space-y-3"}`,children:[((a==null?void 0:a.email)||((T=a==null?void 0:a.contact)==null?void 0:T.email))&&o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Ra,{className:`h-3.5 w-3.5 ${i?"h-3 w-3":"h-4 w-4"} text-muted-foreground`}),o.jsx("span",{className:`font-medium ${i?"text-xs":"text-sm"}`,children:x?" :":"Email:"}),o.jsx("a",{href:`mailto:${a.email||((S=a.contact)==null?void 0:S.email)}`,className:`text-primary hover:underline ${i?"text-xs":"text-sm"}`,children:a.email||((E=a.contact)==null?void 0:E.email)})]}),((a==null?void 0:a.phone)||((_=a==null?void 0:a.contact)==null?void 0:_.phone))&&o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Gu,{className:`h-3.5 w-3.5 ${i?"h-3 w-3":"h-4 w-4"} text-muted-foreground`}),o.jsx("span",{className:`font-medium ${i?"text-xs":"text-sm"}`,children:x?":":"Phone:"}),o.jsx("a",{href:`tel:${a.phone||((M=a.contact)==null?void 0:M.phone)}`,className:`text-primary hover:underline ${i?"text-xs":"text-sm"}`,children:a.phone||((A=a.contact)==null?void 0:A.phone)})]}),((P=a==null?void 0:a.contact)==null?void 0:P.address)&&o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx(m0,{className:`h-3.5 w-3.5 ${i?"h-3 w-3":"h-4 w-4"} text-muted-foreground mt-0.5`}),o.jsxs("div",{children:[o.jsx("span",{className:`font-medium ${i?"text-xs":"text-sm"}`,children:x?":":"Address:"}),o.jsxs("div",{className:`text-muted-foreground ${i?"text-xs":"text-sm"}`,children:[a.contact.address.street&&o.jsx("div",{children:a.contact.address.street}),(a.contact.address.city||a.contact.address.state||a.contact.address.country)&&o.jsx("div",{children:[a.contact.address.city,a.contact.address.state,a.contact.address.country].filter(Boolean).join(", ")}),a.contact.address.postalCode&&o.jsx("div",{children:a.contact.address.postalCode})]})]})]}),((B=a==null?void 0:a.contact)==null?void 0:B.socialMedia)&&o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(jo,{className:`h-3.5 w-3.5 ${i?"h-3 w-3":"h-4 w-4"} text-muted-foreground`}),o.jsx("span",{className:`font-medium ${i?"text-xs":"text-sm"}`,children:x?"  :":"Social Media:"}),o.jsxs("div",{className:"flex gap-2",children:[a.contact.socialMedia.facebook&&o.jsx("a",{href:a.contact.socialMedia.facebook,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline text-xs",children:"Facebook"}),a.contact.socialMedia.twitter&&o.jsx("a",{href:a.contact.socialMedia.twitter,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline text-xs",children:"Twitter"}),a.contact.socialMedia.linkedin&&o.jsx("a",{href:a.contact.socialMedia.linkedin,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline text-xs",children:"LinkedIn"}),a.contact.socialMedia.instagram&&o.jsx("a",{href:a.contact.socialMedia.instagram,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline text-xs",children:"Instagram"})]})]})]})]}),(a==null?void 0:a.physical)&&(a.physical.height||a.physical.weight||a.physical.eyeColor||a.physical.hairColor)&&o.jsxs(et,{children:[o.jsx(ht,{className:i?"p-4":"",children:o.jsxs(gt,{className:"flex items-center gap-2",children:[o.jsx(Xt,{className:`h-4 w-4 ${i?"h-3.5 w-3.5":"h-5 w-5"}`}),x?" ":"Physical Information"]})}),o.jsxs(rt,{className:`space-y-2 ${i?"p-4":"space-y-3"}`,children:[a.physical.height&&o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:`font-medium ${i?"text-xs":"text-sm"}`,children:x?":":"Height:"}),o.jsx("span",{className:i?"text-xs":"text-sm",children:a.physical.height})]}),a.physical.weight&&o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:`font-medium ${i?"text-xs":"text-sm"}`,children:x?":":"Weight:"}),o.jsx("span",{className:i?"text-xs":"text-sm",children:a.physical.weight})]}),a.physical.eyeColor&&o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:`font-medium ${i?"text-xs":"text-sm"}`,children:x?" :":"Eye Color:"}),o.jsx("span",{className:i?"text-xs":"text-sm",children:a.physical.eyeColor})]}),a.physical.hairColor&&o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx("span",{className:`font-medium ${i?"text-xs":"text-sm"}`,children:x?" :":"Hair Color:"}),o.jsx("span",{className:i?"text-xs":"text-sm",children:a.physical.hairColor})]})]})]}),((a==null?void 0:a.biography)||(a==null?void 0:a.notes))&&o.jsxs(et,{children:[o.jsx(ht,{className:i?"p-4":"",children:o.jsxs(gt,{className:"flex items-center gap-2",children:[o.jsx(Ru,{className:`h-4 w-4 ${i?"h-3.5 w-3.5":"h-5 w-5"}`}),x?" ":"Biography"]})}),o.jsx(rt,{className:i?"p-4":"",children:o.jsx("p",{className:`text-foreground leading-relaxed whitespace-pre-wrap ${i?"text-sm":""}`,children:x?a.biography||a.notes:a.biographyEn||a.notes})})]}),(a==null?void 0:a.religion)&&o.jsxs(et,{children:[o.jsx(ht,{className:i?"p-4":"",children:o.jsxs(gt,{className:"flex items-center gap-2",children:[o.jsx(br,{className:`h-4 w-4 ${i?"h-3.5 w-3.5":"h-5 w-5"}`}),x?"":"Religion"]})}),o.jsx(rt,{className:i?"p-4":"",children:o.jsx("p",{className:`text-foreground ${i?"text-sm":""}`,children:a.religion})})]}),(a==null?void 0:a.photos)&&a.photos.length>0&&o.jsxs(et,{children:[o.jsx(ht,{className:i?"p-4":"",children:o.jsxs(gt,{className:"flex items-center gap-2",children:[o.jsx(Yh,{className:`h-4 w-4 ${i?"h-3.5 w-3.5":"h-5 w-5"}`}),x?"":"Photos",o.jsx(Gn,{variant:"secondary",className:i?"text-xs px-1.5 py-0.5":"",children:a.photos.length})]})}),o.jsx(rt,{className:i?"p-4":"",children:o.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[a.photos.slice(0,6).map(L=>o.jsx("div",{className:"aspect-square rounded-lg overflow-hidden",children:o.jsx("img",{src:L.url||L.thumbnailUrl,alt:L.caption||x?"":"Photo",className:"w-full h-full object-cover"})},L.id)),a.photos.length>6&&o.jsx("div",{className:"aspect-square rounded-lg bg-muted flex items-center justify-center",children:o.jsxs("span",{className:"text-xs text-muted-foreground",children:["+",a.photos.length-6]})})]})})]}),(a==null?void 0:a.documents)&&a.documents.length>0&&o.jsxs(et,{children:[o.jsx(ht,{className:i?"p-4":"",children:o.jsxs(gt,{className:"flex items-center gap-2",children:[o.jsx(Ru,{className:`h-4 w-4 ${i?"h-3.5 w-3.5":"h-5 w-5"}`}),x?"":"Documents",o.jsx(Gn,{variant:"secondary",className:i?"text-xs px-1.5 py-0.5":"",children:a.documents.length})]})}),o.jsx(rt,{className:i?"p-4":"",children:o.jsxs("div",{className:`space-y-2 ${i?"space-y-2":"space-y-3"}`,children:[a.documents.slice(0,5).map(L=>o.jsxs("div",{className:`flex items-center gap-2 p-2 rounded-lg hover:bg-muted/50 transition-colors ${i?"p-2":"p-3"}`,children:[o.jsx(Ru,{className:`h-4 w-4 ${i?"h-3.5 w-3.5":"h-5 w-5"} text-muted-foreground`}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:`font-medium text-foreground truncate ${i?"text-sm":""}`,children:L.name||L.caption}),o.jsx("p",{className:"text-muted-foreground text-xs",children:L.type||L.mimeType})]}),o.jsx(ye,{size:"sm",variant:"ghost",className:i?"h-6 w-6 p-0":"h-8 w-8 p-0",children:o.jsx("span",{className:`text-xs ${i?"text-xs":"text-sm"}`,children:x?"":"Download"})})]},L.id)),a.documents.length>5&&o.jsx("div",{className:`text-center text-muted-foreground ${i?"text-xs":"text-sm"}`,children:x?`${a.documents.length-5}  `:`And ${a.documents.length-5} more documents`})]})})]})]}),o.jsxs("div",{className:`space-y-4 ${i?"lg:col-span-1":""} space-y-4`,children:[o.jsxs(et,{children:[o.jsx(ht,{className:i?"p-4":"",children:o.jsxs(gt,{className:"flex items-center gap-2",children:[o.jsx(kn,{className:`h-4 w-4 ${i?"h-3.5 w-3.5":"h-5 w-5"}`}),x?" ":"Family Members",o.jsx(Gn,{variant:"secondary",className:i?"text-xs px-1.5 py-0.5":"",children:d.length})]})}),o.jsx(rt,{className:i?"p-4":"",children:d.length>0?o.jsx("div",{className:`space-y-2 ${i?"space-y-2":"space-y-3"}`,children:d.map(L=>{var D,V,O,H;return o.jsxs("div",{className:`flex items-center gap-2 p-2 rounded-lg hover:bg-muted/50 transition-colors cursor-pointer ${i?"p-2":"p-3"}`,onClick:()=>l(`/persons/${L.id}`),children:[o.jsx("div",{className:`rounded-full flex items-center justify-center ${L.id===((V=(D=a==null?void 0:a.relationships)==null?void 0:D.father)==null?void 0:V.id)?"bg-blue-100 text-blue-600":L.id===((H=(O=a==null?void 0:a.relationships)==null?void 0:O.mother)==null?void 0:H.id)?"bg-pink-100 text-pink-600":"bg-muted text-muted-foreground"} ${i?"w-8 h-8":"w-10 h-10"}`,children:L.photo?o.jsx("img",{src:L.photo,alt:x?L.firstName:L.firstNameEn,className:"w-full h-full rounded-full object-cover"}):o.jsx(Xt,{className:`h-4 w-4 ${i?"h-3 w-3":"h-5 w-5"}`})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:`font-medium text-foreground truncate ${i?"text-sm":""}`,children:x?`${L.firstName} ${L.lastName}`:`${L.firstNameEn} ${L.lastNameEn}`}),o.jsx("p",{className:"text-muted-foreground text-xs",children:x?L.relationship:L.relationshipEn})]}),o.jsx(ye,{size:"sm",variant:"ghost",className:i?"h-6 w-6 p-0":"h-8 w-8 p-0",onClick:W=>{W.stopPropagation(),l(`/persons/${L.id}`)},children:o.jsx(fl,{className:`h-3 w-3 ${i?"h-2.5 w-2.5":"h-4 w-4"}`})})]},L.id)})}):o.jsx("p",{className:`text-muted-foreground text-center py-4 ${i?"text-xs":"text-sm"}`,children:x?"   ":"No family relationships found"})})]}),o.jsxs(et,{children:[o.jsx(ht,{className:i?"p-4":"",children:o.jsxs(gt,{className:"flex items-center gap-2",children:[o.jsx(h0,{className:`h-4 w-4 ${i?"h-3.5 w-3.5":"h-5 w-5"}`}),x?" ":"Quick Info"]})}),o.jsx(rt,{className:i?"p-4":"",children:o.jsxs("div",{className:`space-y-2 ${i?"space-y-2":"space-y-3"}`,children:[o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:`text-muted-foreground ${i?"text-xs":"text-sm"}`,children:x?" :":"Person ID:"}),o.jsx("span",{className:`font-mono ${i?"text-xs":"text-sm"}`,children:a==null?void 0:a.id})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:`text-muted-foreground ${i?"text-xs":"text-sm"}`,children:x?" :":"Created:"}),o.jsx("span",{className:`${i?"text-xs":"text-sm"}`,children:a!=null&&a.createdAt?new Date(a.createdAt).toLocaleDateString(x?"ar-SA":"en-US"):"-"})]}),o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:`text-muted-foreground ${i?"text-xs":"text-sm"}`,children:x?" :":"Last Updated:"}),o.jsx("span",{className:`${i?"text-xs":"text-sm"}`,children:a!=null&&a.updatedAt?new Date(a.updatedAt).toLocaleDateString(x?"ar-SA":"en-US"):"-"})]}),(a==null?void 0:a.createdBy)&&o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:`text-muted-foreground ${i?"text-xs":"text-sm"}`,children:x?"  :":"Created By:"}),o.jsx("span",{className:`${i?"text-xs":"text-sm"}`,children:a.createdBy})]}),(a==null?void 0:a.status)&&o.jsxs("div",{className:"flex justify-between",children:[o.jsx("span",{className:`text-muted-foreground ${i?"text-xs":"text-sm"}`,children:x?":":"Status:"}),o.jsx(Gn,{variant:a.status==="active"?"default":a.status==="archived"?"secondary":"destructive",className:i?"text-xs px-1.5 py-0.5":"text-xs",children:x?a.status==="active"?"":a.status==="archived"?"":"":a.status==="active"?"Active":a.status==="archived"?"Archived":"Deleted"})]})]})})]})]})]}),y&&a&&o.jsx(Rh,{isOpen:y,onClose:()=>p(!1),onSubmit:L=>{a&&c({...a,firstName:L.name.split(" ")[0]||L.name||a.firstName,lastName:L.name.split(" ").slice(1).join(" ")||a.lastName,firstNameEn:L.name.split(" ")[0]||L.name||a.firstNameEn,lastNameEn:L.name.split(" ").slice(1).join(" ")||a.lastNameEn,gender:L.gender||a.gender,birthDate:L.birthDate||a.birthDate,deathDate:L.deathDate||a.deathDate,birthPlace:L.birthPlace||a.birthPlace,birthPlaceEn:L.birthPlaceEn||a.birthPlaceEn,deathPlace:L.deathPlace||a.deathPlace,deathPlaceEn:L.deathPlaceEn||a.deathPlaceEn,isAlive:L.isAlive!==void 0?L.isAlive:a.isAlive,occupation:L.occupation||a.occupation,occupationEn:L.occupationEn||a.occupationEn}),p(!1),tn.success({en:"Person updated successfully",ar:"    "})},familyTreeId:a.treeId||a.familyTreeId||"",familyMembers:[],initialData:{id:a.id,name:`${a.firstName} ${a.lastName}`,gender:a.gender,birthDate:a.birthDate,deathDate:a.deathDate,birthPlace:a.birthPlace,birthPlaceEn:a.birthPlaceEn,occupation:a.occupation,occupationEn:a.occupationEn,isAlive:a.isAlive},mode:"edit"})]})):o.jsxs("div",{className:"text-center py-12",children:[o.jsx("h2",{className:"text-2xl font-bold text-muted-foreground mb-4",children:x?"  ":"Person not found"}),o.jsx(ye,{asChild:!0,children:o.jsx(_t,{to:"/trees",className:"flex items-center",children:x?" ":"Back to Trees"})})]})},G0e=()=>{var H,W,$,z,q,G,re,oe;const{id:e}=pd(),t=jr(),{language:n}=Ft(),{user:r}=Mr(),{trees:s,currentTree:i,fetchTrees:l}=As(),{isMobile:a}=_r(),[c,d]=J.useState("basic"),[u,f]=J.useState(!1),[m,h]=J.useState(!1);J.useRef(null),J.useRef(null),J.useRef(null);const[g,y]=J.useState(!0),[p,x]=J.useState(null),b=n==="ar";J.useEffect(()=>{const ie=async()=>{try{await l()}catch{}};s.length===0&&ie()},[l,s.length]);const[w,N]=J.useState({id:"",firstName:"",middleName:"",lastName:"",nickname:"",fullName:"",displayName:"",gender:"unknown",birth:{date:"",place:{city:"",state:"",country:""}},death:{date:"",place:{city:"",state:"",country:""}},isDeceased:!1,physical:{height:"",weight:"",eyeColor:"",hairColor:"",complexion:"",distinguishingMarks:""},occupation:[],education:[],contact:{email:"",phone:"",address:{street:"",city:"",state:"",country:"",postalCode:""},socialMedia:{facebook:"",twitter:"",linkedin:"",instagram:""}},relationships:{father:"",mother:"",spouses:[],children:[],siblings:[]},photos:[],documents:[],notes:"",tags:[],tree:"",position:{generation:1,x:0,y:0},createdBy:"",createdAt:"",updatedAt:"",status:"active"}),[k,I]=J.useState(w),[R,T]=J.useState(null),[S,E]=J.useState(""),[_,M]=J.useState(""),[A,P]=J.useState([]);J.useEffect(()=>{(async()=>{var te,we,me,Ee,pe,ee,ft,$e,De,ge,Me,_e,ke,se,Ae,Re,Ce,ve,Be,le,fe,Te,at,je,he,Pe,ot,tt,qe,ze,it,st,Ve,ut,mt,Ht,Kt,jn,wn,It,Rr,Vr,Sr,We,Ue,pt,wt,Vt,St,bt,jt,an,Mn,Xe,Zt,yt,on,rn,Qt,vt,$t,Yt,zt,Pn,ln,Fn,En,Bn,Ni,ji,$r,Va,Vc,cr,Cl,Pl,_i,ma,Hs,pa,ir,Io,Wc,Gc,Yc,ri,Il,Tl,Hi,To,Xc,Kc,Jc,Lo,ga,Vi,Zc;if(!e){x(n==="ar"?"  ":"Person ID is missing"),y(!1);return}const Y=parseInt(e);if(isNaN(Y)){x(n==="ar"?"   ":"Invalid person ID"),y(!1);return}try{y(!0),x(null);const Ke=await At.getPersonById(Y);if(!Ke)throw new Error("Received empty response from API");const nt=(Qc,...Md)=>{for(const eu of Md)if(Qc.hasOwnProperty(eu))return Qc[eu]},Ut={id:((te=nt(Ke,"id","Id"))==null?void 0:te.toString())||"",firstName:nt(Ke,"firstName","FirstName","name")||"",middleName:nt(Ke,"middleName","MiddleName")||"",lastName:nt(Ke,"lastName","LastName")||"",nickname:nt(Ke,"nickname","Nickname")||"",fullName:nt(Ke,"fullName","FullName")||`${nt(Ke,"firstName","FirstName")||""} ${nt(Ke,"lastName","LastName")||""}`,displayName:nt(Ke,"displayName","DisplayName")||`${nt(Ke,"firstName","FirstName")||""} ${nt(Ke,"lastName","LastName")||""}`,gender:["male","female","unknown"].includes(nt(Ke,"gender","Gender"))?nt(Ke,"gender","Gender"):"unknown",birth:{date:((we=nt(Ke,"birth","Birth"))==null?void 0:we.date)||((me=nt(Ke,"birth","Birth"))==null?void 0:me.Date)||nt(Ke,"birthDate")||"",place:{city:((pe=(Ee=nt(Ke,"birth","Birth"))==null?void 0:Ee.place)==null?void 0:pe.city)||((ft=(ee=nt(Ke,"birth","Birth"))==null?void 0:ee.Place)==null?void 0:ft.City)||nt(Ke,"birthPlace")||"",state:((De=($e=nt(Ke,"birth","Birth"))==null?void 0:$e.place)==null?void 0:De.state)||((Me=(ge=nt(Ke,"birth","Birth"))==null?void 0:ge.Place)==null?void 0:Me.State)||"",country:((ke=(_e=nt(Ke,"birth","Birth"))==null?void 0:_e.place)==null?void 0:ke.country)||((Ae=(se=nt(Ke,"birth","Birth"))==null?void 0:se.Place)==null?void 0:Ae.Country)||""},description:((Re=nt(Ke,"birth","Birth"))==null?void 0:Re.description)||((Ce=nt(Ke,"birth","Birth"))==null?void 0:Ce.Description)||"",isEstimated:((ve=nt(Ke,"birth","Birth"))==null?void 0:ve.isEstimated)||((Be=nt(Ke,"birth","Birth"))==null?void 0:Be.IsEstimated)||!1},death:nt(Ke,"death","Death")?{date:((le=nt(Ke,"death","Death"))==null?void 0:le.date)||((fe=nt(Ke,"death","Death"))==null?void 0:fe.Date)||nt(Ke,"deathDate")||"",place:{city:((at=(Te=nt(Ke,"death","Death"))==null?void 0:Te.place)==null?void 0:at.city)||((he=(je=nt(Ke,"death","Death"))==null?void 0:je.Place)==null?void 0:he.City)||"",state:((ot=(Pe=nt(Ke,"death","Death"))==null?void 0:Pe.place)==null?void 0:ot.state)||((qe=(tt=nt(Ke,"death","Death"))==null?void 0:tt.Place)==null?void 0:qe.State)||"",country:((it=(ze=nt(Ke,"death","Death"))==null?void 0:ze.place)==null?void 0:it.country)||((Ve=(st=nt(Ke,"death","Death"))==null?void 0:st.Place)==null?void 0:Ve.Country)||""},description:((ut=nt(Ke,"death","Death"))==null?void 0:ut.description)||((mt=nt(Ke,"death","Death"))==null?void 0:mt.Description)||"",isEstimated:((Ht=nt(Ke,"death","Death"))==null?void 0:Ht.isEstimated)||((Kt=nt(Ke,"death","Death"))==null?void 0:Kt.IsEstimated)||!1}:void 0,isDeceased:!!nt(Ke,"isDeceased","IsDeceased","isDead"),physical:{height:((jn=nt(Ke,"physical","Physical"))==null?void 0:jn.height)||((wn=nt(Ke,"physical","Physical"))==null?void 0:wn.Height)||"",weight:((It=nt(Ke,"physical","Physical"))==null?void 0:It.weight)||((Rr=nt(Ke,"physical","Physical"))==null?void 0:Rr.Weight)||"",eyeColor:((Vr=nt(Ke,"physical","Physical"))==null?void 0:Vr.eyeColor)||((Sr=nt(Ke,"physical","Physical"))==null?void 0:Sr.EyeColor)||"",hairColor:((We=nt(Ke,"physical","Physical"))==null?void 0:We.hairColor)||((Ue=nt(Ke,"physical","Physical"))==null?void 0:Ue.HairColor)||"",complexion:((pt=nt(Ke,"physical","Physical"))==null?void 0:pt.complexion)||((wt=nt(Ke,"physical","Physical"))==null?void 0:wt.Complexion)||"",distinguishingMarks:((Vt=nt(Ke,"physical","Physical"))==null?void 0:Vt.distinguishingMarks)||((St=nt(Ke,"physical","Physical"))==null?void 0:St.DistinguishingMarks)||""},occupation:Array.isArray(nt(Ke,"occupation"))?nt(Ke,"occupation"):Array.isArray(nt(Ke,"Occupation"))?nt(Ke,"Occupation"):nt(Ke,"occupation")?[nt(Ke,"occupation")]:nt(Ke,"Occupation")?[nt(Ke,"Occupation")]:[],education:Array.isArray(nt(Ke,"education"))?nt(Ke,"education"):Array.isArray(nt(Ke,"Education"))?nt(Ke,"Education"):nt(Ke,"education")?[nt(Ke,"education")]:nt(Ke,"Education")?[nt(Ke,"Education")]:[],contact:{email:((bt=nt(Ke,"contact","Contact"))==null?void 0:bt.email)||((jt=nt(Ke,"contact","Contact"))==null?void 0:jt.Email)||nt(Ke,"email")||"",phone:((an=nt(Ke,"contact","Contact"))==null?void 0:an.phone)||((Mn=nt(Ke,"contact","Contact"))==null?void 0:Mn.Phone)||"",address:{street:((Zt=(Xe=nt(Ke,"contact","Contact"))==null?void 0:Xe.address)==null?void 0:Zt.street)||((on=(yt=nt(Ke,"contact","Contact"))==null?void 0:yt.Address)==null?void 0:on.Street)||"",city:((Qt=(rn=nt(Ke,"contact","Contact"))==null?void 0:rn.address)==null?void 0:Qt.city)||(($t=(vt=nt(Ke,"contact","Contact"))==null?void 0:vt.Address)==null?void 0:$t.City)||"",state:((zt=(Yt=nt(Ke,"contact","Contact"))==null?void 0:Yt.address)==null?void 0:zt.state)||((ln=(Pn=nt(Ke,"contact","Contact"))==null?void 0:Pn.Address)==null?void 0:ln.State)||"",country:((En=(Fn=nt(Ke,"contact","Contact"))==null?void 0:Fn.address)==null?void 0:En.country)||((Ni=(Bn=nt(Ke,"contact","Contact"))==null?void 0:Bn.Address)==null?void 0:Ni.Country)||"",postalCode:(($r=(ji=nt(Ke,"contact","Contact"))==null?void 0:ji.address)==null?void 0:$r.postalCode)||((Vc=(Va=nt(Ke,"contact","Contact"))==null?void 0:Va.Address)==null?void 0:Vc.PostalCode)||""},socialMedia:{facebook:((Cl=(cr=nt(Ke,"contact","Contact"))==null?void 0:cr.socialMedia)==null?void 0:Cl.facebook)||((_i=(Pl=nt(Ke,"contact","Contact"))==null?void 0:Pl.SocialMedia)==null?void 0:_i.Facebook)||"",twitter:((Hs=(ma=nt(Ke,"contact","Contact"))==null?void 0:ma.socialMedia)==null?void 0:Hs.twitter)||((ir=(pa=nt(Ke,"contact","Contact"))==null?void 0:pa.SocialMedia)==null?void 0:ir.Twitter)||"",linkedin:((Wc=(Io=nt(Ke,"contact","Contact"))==null?void 0:Io.socialMedia)==null?void 0:Wc.linkedin)||((Yc=(Gc=nt(Ke,"contact","Contact"))==null?void 0:Gc.SocialMedia)==null?void 0:Yc.Linkedin)||"",instagram:((Il=(ri=nt(Ke,"contact","Contact"))==null?void 0:ri.socialMedia)==null?void 0:Il.instagram)||((Hi=(Tl=nt(Ke,"contact","Contact"))==null?void 0:Tl.SocialMedia)==null?void 0:Hi.Instagram)||""}},relationships:nt(Ke,"relationships","Relationships")||{father:"",mother:"",spouses:[],children:[],siblings:[]},photos:nt(Ke,"photos","Photos")||[],documents:nt(Ke,"documents","Documents")||[],notes:nt(Ke,"notes","Notes")||"",tags:nt(Ke,"tags","Tags")||[],tree:nt(Ke,"tree","Tree","familyTreeId")||"",position:{generation:((To=nt(Ke,"position","Position"))==null?void 0:To.generation)||((Xc=nt(Ke,"position","Position"))==null?void 0:Xc.Generation)||1,x:((Kc=nt(Ke,"position","Position"))==null?void 0:Kc.x)||((Jc=nt(Ke,"position","Position"))==null?void 0:Jc.X)||0,y:((Lo=nt(Ke,"position","Position"))==null?void 0:Lo.y)||((ga=nt(Ke,"position","Position"))==null?void 0:ga.Y)||0,level:((Vi=nt(Ke,"position","Position"))==null?void 0:Vi.level)||((Zc=nt(Ke,"position","Position"))==null?void 0:Zc.Level)||0},createdBy:nt(Ke,"createdBy","CreatedBy")||"",createdAt:nt(Ke,"createdAt","CreatedAt")||new Date().toISOString(),updatedAt:nt(Ke,"updatedAt","UpdatedAt")||new Date().toISOString(),status:nt(Ke,"status","Status")||"active"};Ut.relationships.father&&E(typeof Ut.relationships.father=="string"?Ut.relationships.father:Ut.relationships.father.id),Ut.relationships.mother&&M(typeof Ut.relationships.mother=="string"?Ut.relationships.mother:Ut.relationships.mother.id),N(Ut),I(Ut)}catch(Ke){x(n==="ar"?"    ":"Failed to load person data: "+(Ke.message||"Unknown error"))}finally{y(!1)}})()},[e,n]),J.useEffect(()=>{(async()=>{if(k.tree)try{const te=(await At.getPersonsInTree(Number(k.tree))).filter(we=>we.id!==k.id);P(te)}catch(Y){console.error("Failed to fetch persons for parent selection",Y)}})()},[k.tree,k.id]);const B=ie=>{if(ie)return s.find(Y=>Y.id===ie)||s.find(Y=>Y.id.toString()===ie)||s.find(Y=>parseInt(Y.id)===parseInt(ie))||((i==null?void 0:i.id)===ie?i:void 0)||((i==null?void 0:i.id.toString())===ie?i:void 0)||(parseInt((i==null?void 0:i.id)||"0")===parseInt(ie)?i:void 0)};(()=>{if(g||!r||!e||!w.tree||s.length===0)return!0;const ie=w.tree.toString(),Y=B(ie);return Y?Y.ownerId===r.id||Y.userRole==="owner":!0})();const L=(()=>{if(g||!r||!e||!w.tree||s.length===0)return!0;const ie=w.tree.toString(),Y=B(ie);return Y?Y.ownerId===r.id||Y.userRole==="owner"||Y.userRole==="editor":!0})(),D=async()=>{var ie;if(e){if(!L){x(b?"     ":"You do not have permission to edit this person");return}try{y(!0);const Y=await At.updatePerson(parseInt(e),k.firstName||"",k.birth.date||"",((ie=k.birth.place)==null?void 0:ie.city)||"",k.occupation.length>0?k.occupation[0].title:"",k.gender||"unknown",parseInt(k.tree)||0);if(S!==(w.relationships.father?typeof w.relationships.father=="string"?w.relationships.father:w.relationships.father.id:"")&&(w.relationships.father,S))try{await At.addRelationship(parseInt(S),parseInt(e),"Parent")}catch(te){console.error("Failed to add father relationship",te)}if(_!==(w.relationships.mother?typeof w.relationships.mother=="string"?w.relationships.mother:w.relationships.mother.id:"")&&(w.relationships.mother,_))try{await At.addRelationship(parseInt(_),parseInt(e),"Parent")}catch(te){console.error("Failed to add mother relationship",te)}N(k),f(!1)}catch{x(n==="ar"?"   ":"Failed to save changes")}finally{y(!1)}}},V=()=>{I(w),f(!1)},O=async()=>{if(e){if(!L){x(b?"     ":"You do not have permission to delete this person");return}if(confirm(b?"            .":"Are you sure you want to delete this person? This action cannot be undone."))try{y(!0),await At.deletePerson(parseInt(e)),t("/trees")}catch(ie){const Y=ie.message||(n==="ar"?"   ":"Failed to delete person");x(Y),y(!1)}}};return g?o.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:o.jsxs("div",{className:"text-center",children:[o.jsx(mr,{className:"h-12 w-12 animate-spin text-primary mx-auto mb-4"}),o.jsx("p",{className:"text-muted-foreground",children:b?"   ...":"Loading person profile..."})]})}):p?o.jsxs("div",{className:"text-center py-12",children:[o.jsx("div",{className:"mx-auto w-16 h-16 bg-destructive/10 rounded-full flex items-center justify-center mb-4",children:o.jsx(Qs,{className:"h-8 w-8 text-destructive"})}),o.jsx("h2",{className:"text-2xl font-bold text-destructive mb-4",children:p}),o.jsx(ye,{onClick:()=>window.location.reload(),children:b?" ":"Try Again"})]}):!L&&!g&&r&&w.tree?o.jsxs("div",{className:"flex flex-col items-center justify-center h-64 space-y-4",children:[o.jsx(No,{className:"h-12 w-12 text-destructive"}),o.jsx("p",{className:"text-destructive text-center",children:b?"     ":"You do not have permission to edit this person"}),o.jsx(ye,{onClick:()=>t(-1),children:b?"":"Go Back"})]}):o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:`flex ${a?"flex-col gap-3":"flex-col sm:flex-row sm:items-center"} justify-between`,children:[o.jsxs("div",{className:"flex items-center gap-4",children:[o.jsxs(ye,{variant:"outline",onClick:()=>t(-1),className:"flex items-center gap-2",size:a?"sm":"default",children:[o.jsx(fl,{className:`h-4 w-4 ${a?"h-3 w-3":""}`}),o.jsx("span",{className:a?"hidden":"hidden xs:inline",children:b?"":"Back"})]}),o.jsxs("div",{children:[o.jsx("h1",{className:`font-bold text-foreground ${a?"text-lg":"text-xl sm:text-2xl"}`,children:u?b?" ":"Edit Person":b?" ":"View Person"}),o.jsx("p",{className:`text-muted-foreground ${a?"text-xs":"text-xs sm:text-sm"}`,children:b?"   ":"Manage person information and data"})]})]}),o.jsxs("div",{className:`flex ${a?"gap-1":"gap-2"}`,children:[o.jsxs(ye,{variant:"outline",className:"flex items-center gap-2",size:a?"sm":"default",onClick:()=>{const ie=`${window.location.origin}/persons/${e}`;navigator.clipboard.writeText(ie).then(()=>{T(b?"    ":"Link copied to clipboard"),setTimeout(()=>T(null),3e3)}).catch(()=>{const Y=document.createElement("textarea");Y.value=ie,document.body.appendChild(Y),Y.select(),document.execCommand("copy"),document.body.removeChild(Y),T(b?"    ":"Link copied to clipboard"),setTimeout(()=>T(null),3e3)})},children:[o.jsx(p0,{className:`h-4 w-4 ${a?"h-3 w-3":""}`}),o.jsx("span",{className:a?"hidden":"hidden xs:inline",children:b?"":"Share"})]}),o.jsx(ye,{variant:u?"outline":"default",onClick:()=>u?V():f(!0),className:"flex items-center gap-2",disabled:!L,size:a?"sm":"default",children:u?o.jsxs(o.Fragment,{children:[o.jsx(ia,{className:`h-4 w-4 ${a?"h-3 w-3":""}`}),o.jsx("span",{className:a?"hidden":"hidden xs:inline",children:b?"":"Cancel"})]}):o.jsxs(o.Fragment,{children:[o.jsx(sa,{className:`h-4 w-4 ${a?"h-3 w-3":""}`}),o.jsx("span",{className:a?"hidden":"hidden xs:inline",children:b?"":"Edit"})]})})]})]}),o.jsx("div",{className:`flex ${a?"flex-wrap gap-1 p-1 bg-muted rounded-lg overflow-x-auto":"gap-1 border-b overflow-x-auto"}`,children:[{id:"basic",label:b?" ":"Basic Info",icon:Xt},{id:"family",label:b?"":"Family",icon:kn},{id:"contact",label:b?" ":"Contact",icon:Gu},{id:"education",label:b?"":"Education",icon:lH},{id:"work",label:b?"":"Work",icon:hl},{id:"media",label:b?" ":"Media & Docs",icon:uH},{id:"notes",label:b?"":"Notes",icon:Ru}].map(ie=>o.jsxs(ye,{variant:c===ie.id?"default":"ghost",onClick:()=>d(ie.id),className:`flex items-center gap-2 whitespace-nowrap ${a?"text-xs py-2 px-3 flex-1 justify-center":""}`,size:a?"sm":"default",children:[be.createElement(ie.icon,{className:`h-4 w-4 ${a?"h-3 w-3":""}`}),o.jsx("span",{className:a?"hidden":"hidden xs:inline",children:ie.label})]},ie.id))}),R&&o.jsx("div",{className:"bg-green-100 border border-green-200 rounded-lg p-3 mb-4",children:o.jsx("p",{className:"text-green-800 text-sm",children:R})}),c==="basic"&&o.jsxs(et,{children:[o.jsx(ht,{className:a?"p-4":"",children:o.jsxs(gt,{className:"flex items-center gap-2",children:[o.jsx(Xt,{className:`h-5 w-5 ${a?"h-4 w-4":""}`}),b?" ":"Basic Information"]})}),o.jsxs(rt,{className:`space-y-6 ${a?"p-4":""}`,children:[o.jsxs("div",{className:`grid ${a?"grid-cols-1 gap-3":"grid-cols-1 md:grid-cols-2 gap-6"}`,children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:`font-medium ${a?"text-xs":"text-sm"}`,children:b?" ":"First Name"}),o.jsx(Bt,{value:u?k.firstName:w.firstName,onChange:ie=>I(Y=>({...Y,firstName:ie.target.value})),disabled:!u,placeholder:b?" ":"First Name",className:a?"text-sm py-2":""})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:`font-medium ${a?"text-xs":"text-sm"}`,children:b?" ":"Middle Name"}),o.jsx(Bt,{value:u?k.middleName||"":w.middleName||"",onChange:ie=>I(Y=>({...Y,middleName:ie.target.value})),disabled:!u,placeholder:b?" ":"Middle Name",className:a?"text-sm py-2":""})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:`font-medium ${a?"text-xs":"text-sm"}`,children:b?" ":"Last Name"}),o.jsx(Bt,{value:u?k.lastName:w.lastName,onChange:ie=>I(Y=>({...Y,lastName:ie.target.value})),disabled:!u,placeholder:b?" ":"Last Name",className:a?"text-sm py-2":""})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:`font-medium ${a?"text-xs":"text-sm"}`,children:b?"":"Nickname"}),o.jsx(Bt,{value:u?k.nickname||"":w.nickname||"",onChange:ie=>I(Y=>({...Y,nickname:ie.target.value})),disabled:!u,placeholder:b?"":"Nickname",className:a?"text-sm py-2":""})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:`font-medium ${a?"text-xs":"text-sm"}`,children:b?"":"Gender"}),o.jsxs("select",{value:u?k.gender:w.gender,onChange:ie=>I(Y=>({...Y,gender:ie.target.value})),disabled:!u,className:`w-full px-3 border border-input rounded-md bg-background disabled:opacity-50 ${a?"text-sm py-2":"py-2"}`,children:[o.jsx("option",{value:"male",children:b?"":"Male"}),o.jsx("option",{value:"female",children:b?"":"Female"}),o.jsx("option",{value:"unknown",children:b?" ":"Not specified"})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:`font-medium ${a?"text-xs":"text-sm"}`,children:b?"":"Status"}),o.jsxs("select",{value:u?k.isDeceased.toString():w.isDeceased.toString(),onChange:ie=>I(Y=>({...Y,isDeceased:ie.target.value==="true"})),disabled:!u,className:`w-full px-3 border border-input rounded-md bg-background disabled:opacity-50 ${a?"text-sm py-2":"py-2"}`,children:[o.jsx("option",{value:"false",children:b?"  ":"Alive"}),o.jsx("option",{value:"true",children:b?"":"Deceased"})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:`font-medium ${a?"text-xs":"text-sm"}`,children:b?" ":"Birth Date"}),o.jsx(Bt,{type:"date",value:u?k.birth.date||"":w.birth.date||"",onChange:ie=>I(Y=>({...Y,birth:{...Y.birth,date:ie.target.value}})),disabled:!u,className:a?"text-sm py-2":""})]}),(u?k.isDeceased:w.isDeceased)&&o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:`font-medium ${a?"text-xs":"text-sm"}`,children:b?" ":"Death Date"}),o.jsx(Bt,{type:"date",value:u?((H=k.death)==null?void 0:H.date)||"":((W=w.death)==null?void 0:W.date)||"",onChange:ie=>I(Y=>({...Y,death:{...Y.death||{},date:ie.target.value}})),disabled:!u,className:a?"text-sm py-2":""})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:`font-medium ${a?"text-xs":"text-sm"}`,children:b?" ":"Birth Place"}),o.jsx(Bt,{value:u?(($=k.birth.place)==null?void 0:$.city)||"":((z=w.birth.place)==null?void 0:z.city)||"",onChange:ie=>I(Y=>({...Y,birth:{...Y.birth,place:{...Y.birth.place,city:ie.target.value}}})),disabled:!u,placeholder:b?" ":"Birth City",className:a?"text-sm py-2":""})]}),(u?k.isDeceased:w.isDeceased)&&o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:`font-medium ${a?"text-xs":"text-sm"}`,children:b?" ":"Death Place"}),o.jsx(Bt,{value:u?((G=(q=k.death)==null?void 0:q.place)==null?void 0:G.city)||"":((oe=(re=w.death)==null?void 0:re.place)==null?void 0:oe.city)||"",onChange:ie=>I(Y=>{var te;return{...Y,death:{...Y.death||{},place:{...(te=Y.death)==null?void 0:te.place,city:ie.target.value}}}}),disabled:!u,placeholder:b?" ":"Death City",className:a?"text-sm py-2":""})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:`font-medium ${a?"text-xs":"text-sm"}`,children:b?"":"Father"}),o.jsxs("select",{value:S,onChange:ie=>E(ie.target.value),disabled:!u,className:`w-full px-3 border border-input rounded-md bg-background disabled:opacity-50 ${a?"text-sm py-2":"py-2"}`,children:[o.jsx("option",{value:"",children:b?" ":"Select Father"}),A.filter(ie=>ie.gender==="male").map(ie=>o.jsx("option",{value:ie.id,children:ie.fullName||`${ie.firstName} ${ie.lastName}`},ie.id))]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:`font-medium ${a?"text-xs":"text-sm"}`,children:b?"":"Mother"}),o.jsxs("select",{value:_,onChange:ie=>M(ie.target.value),disabled:!u,className:`w-full px-3 border border-input rounded-md bg-background disabled:opacity-50 ${a?"text-sm py-2":"py-2"}`,children:[o.jsx("option",{value:"",children:b?" ":"Select Mother"}),A.filter(ie=>ie.gender==="female").map(ie=>o.jsx("option",{value:ie.id,children:ie.fullName||`${ie.firstName} ${ie.lastName}`},ie.id))]})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:`font-medium ${a?"text-xs":"text-sm"}`,children:b?"":"Notes"}),o.jsx(kd,{value:u?k.notes||"":w.notes||"",onChange:ie=>I(Y=>({...Y,notes:ie.target.value})),disabled:!u,placeholder:b?"  ...":"Write additional notes...",rows:a?3:4,className:a?"text-sm py-2":""})]}),u&&o.jsxs("div",{className:`flex ${a?"flex-col gap-2":"gap-3 pt-4"}`,children:[o.jsx(ye,{onClick:D,className:"flex items-center gap-2",disabled:g,size:a?"sm":"default",children:g?o.jsxs(o.Fragment,{children:[o.jsx(mr,{className:`animate-spin ${a?"h-3 w-3 mr-1":"h-4 w-4 mr-2"}`}),b?" ...":"Saving..."]}):o.jsxs(o.Fragment,{children:[o.jsx(Xu,{className:`h-4 w-4 ${a?"h-3 w-3":""}`}),a?b?"":"Save":b?" ":"Save Changes"]})}),o.jsx(ye,{variant:"outline",onClick:V,disabled:g,size:a?"sm":"default",children:b?"":"Cancel"})]})]})]}),u&&o.jsxs(et,{className:"border-destructive/20",children:[o.jsx(ht,{className:a?"p-4":"",children:o.jsxs(gt,{className:"flex items-center gap-2 text-destructive",children:[o.jsx(No,{className:`h-5 w-5 ${a?"h-4 w-4":""}`}),b?" ":"Danger Zone"]})}),o.jsx(rt,{className:a?"p-4":"",children:o.jsxs("div",{className:`flex ${a?"flex-col gap-3":"items-center justify-between"}`,children:[o.jsxs("div",{children:[o.jsx("p",{className:`font-medium text-destructive ${a?"text-sm":""}`,children:b?" ":"Delete Person"}),o.jsx("p",{className:`text-muted-foreground ${a?"text-xs":"text-sm"}`,children:b?"       ":"Permanently delete this person and all their data from the tree"})]}),o.jsxs(ye,{variant:"destructive",onClick:O,className:"flex items-center gap-2",disabled:g,size:a?"sm":"default",children:[g?o.jsx(mr,{className:`animate-spin ${a?"h-3 w-3":"h-4 w-4"}`}):o.jsx($a,{className:`h-4 w-4 ${a?"h-3 w-3":""}`}),b?"":"Delete"]})]})})]})]})},Y0e=()=>{const{language:e}=Ft(),{trees:t}=As(),[n,r]=J.useState(""),[s,i]=J.useState("all"),[l,a]=J.useState("relevance"),[c,d]=J.useState(null),[u,f]=J.useState(null),[m,h]=J.useState(null),[g,y]=J.useState(!1),[p,x]=J.useState(!1),[b,w]=J.useState([]),[N,k]=J.useState([]),[I,R]=J.useState(null),T=J.useRef(null),{isMobile:S}=_r(),E=e==="ar";J.useEffect(()=>()=>{T.current&&clearTimeout(T.current)},[]),J.useEffect(()=>(T.current&&clearTimeout(T.current),()=>{T.current&&clearTimeout(T.current)}),[n]);const _=J.useMemo(()=>{let L=b,D=N;if(n){const V=n.toLowerCase();L=b.filter(O=>O.firstName&&O.firstName.toLowerCase().includes(V)||O.firstNameEn&&O.firstNameEn.toLowerCase().includes(V)||O.lastName&&O.lastName.toLowerCase().includes(V)||O.lastNameEn&&O.lastNameEn.toLowerCase().includes(V)||O.treeName&&O.treeName.toLowerCase().includes(V)||O.treeNameEn&&O.treeNameEn.toLowerCase().includes(V)||O.occupation&&O.occupation.toLowerCase().includes(V)||O.occupationEn&&O.occupationEn.toLowerCase().includes(V)||O.birthPlace&&O.birthPlace.toLowerCase().includes(V)||O.birthPlaceEn&&O.birthPlaceEn.toLowerCase().includes(V)),D=N.filter(O=>O.name&&O.name.toLowerCase().includes(V)||O.nameEn&&O.nameEn.toLowerCase().includes(V)||O.description&&O.description.toLowerCase().includes(V)||O.descriptionEn&&O.descriptionEn.toLowerCase().includes(V))}return c!==null&&(L=L.filter(V=>V.generation===c)),u!==null&&(L=L.filter(V=>V.gender===u)),m!==null&&(L=L.filter(V=>V.isAlive===m)),l==="name"?(L.sort((V,O)=>{const H=E?V.firstName:V.firstNameEn||V.firstName,W=E?O.firstName:O.firstNameEn||O.firstName;return H.localeCompare(W)}),D.sort((V,O)=>{const H=E?V.name:V.nameEn||V.name,W=E?O.name:O.nameEn||O.name;return H.localeCompare(W)})):l==="date"?(L.sort((V,O)=>{const H=V.birthDate?new Date(V.birthDate).getTime():0;return(O.birthDate?new Date(O.birthDate).getTime():0)-H}),D.sort((V,O)=>new Date(O.createdAt).getTime()-new Date(V.createdAt).getTime())):l==="generation"&&L.some(V=>V.generation!==void 0)&&L.sort((V,O)=>(V.generation||0)-(O.generation||0)),{people:L,trees:D}},[b,N,n,c,u,m,l,E]),M=L=>{if(!L)return null;let D;try{if(L.includes("T"))D=new Date(L);else if(L.includes("-")){const W=L.split("-");W.length===3?D=new Date(parseInt(W[0]),parseInt(W[1])-1,parseInt(W[2])):D=new Date(L)}else if(L.includes("/")){const W=L.split("/");W.length===3?D=new Date(parseInt(W[2]),parseInt(W[0])-1,parseInt(W[1])):D=new Date(L)}else D=new Date(L)}catch{return null}if(isNaN(D.getTime()))return null;const V=new Date;let O=V.getFullYear()-D.getFullYear();const H=V.getMonth()-D.getMonth();return(H<0||H===0&&V.getDate()<D.getDate())&&O--,O},A=L=>L===1?mh:L===2?Xt:ta,P=()=>{d(null),f(null),h(null)},B=c!==null||u!==null||m!==null;return o.jsxs("div",{className:`space-y-6 ${S?"p-4":""}`,children:[o.jsxs(et,{className:S?"rounded-lg":"",children:[o.jsx(ht,{className:S?"p-4":"",children:o.jsxs(gt,{className:`flex items-center gap-2 ${S?"text-lg":""}`,children:[o.jsx(Qi,{className:`h-5 w-5 text-primary ${S?"h-4 w-4":""}`}),E?" ":"Advanced Search"]})}),o.jsxs(rt,{className:`space-y-4 ${S?"p-4":""}`,children:[o.jsxs("div",{className:"relative",children:[o.jsx(Qi,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 ${S?"h-3.5 w-3.5":"h-4 w-4"} text-muted-foreground`}),o.jsx(Bt,{placeholder:E?"   ...":"Search people and trees...",value:n,onChange:L=>r(L.target.value),className:`pl-10 ${S?"py-2 text-sm":""}`})]}),o.jsxs("div",{className:`flex ${S?"flex-col gap-3":"flex-wrap gap-4"} items-center`,children:[o.jsxs("div",{className:`flex ${S?"flex-wrap gap-1 p-1 bg-muted rounded-lg w-full":"gap-1 border rounded-md p-1"}`,children:[o.jsx(ye,{variant:s==="all"?"default":"ghost",size:"sm",onClick:()=>i("all"),className:`flex items-center gap-2 whitespace-nowrap ${S?"text-xs py-2 px-3 flex-1 justify-center h-8":"h-8 px-3"}`,children:o.jsx("span",{className:S?"hidden":"",children:E?"":"All"})}),o.jsxs(ye,{variant:s==="people"?"default":"ghost",size:"sm",onClick:()=>i("people"),className:`flex items-center gap-2 whitespace-nowrap ${S?"text-xs py-2 px-3 flex-1 justify-center h-8":"h-8 px-3"}`,children:[o.jsx(Xt,{className:`h-4 w-4 ${S?"h-3 w-3":"mr-1"}`}),o.jsx("span",{className:S?"hidden":"",children:E?"":"People"})]}),o.jsxs(ye,{variant:s==="trees"?"default":"ghost",size:"sm",onClick:()=>i("trees"),className:`flex items-center gap-2 whitespace-nowrap ${S?"text-xs py-2 px-3 flex-1 justify-center h-8":"h-8 px-3"}`,children:[o.jsx(qn,{className:`h-4 w-4 ${S?"h-3 w-3":"mr-1"}`}),o.jsx("span",{className:S?"hidden":"",children:E?"":"Trees"})]})]}),o.jsxs("div",{className:`flex ${S?"flex-col gap-2 w-full":"items-center gap-2"}`,children:[o.jsx("span",{className:`text-muted-foreground ${S?"text-xs":"text-sm"}`,children:E?":":"Sort:"}),o.jsxs("div",{className:`flex ${S?"flex-wrap gap-1 p-1 bg-muted rounded-lg w-full":"gap-1 border rounded-md p-1"}`,children:[o.jsx(ye,{variant:l==="relevance"?"default":"ghost",size:"sm",onClick:()=>a("relevance"),className:`flex items-center gap-2 whitespace-nowrap ${S?"text-xs py-2 px-3 flex-1 justify-center h-8":"h-8 px-3 text-xs"}`,children:E?"":"Relevance"}),o.jsx(ye,{variant:l==="name"?"default":"ghost",size:"sm",onClick:()=>a("name"),className:`flex items-center gap-2 whitespace-nowrap ${S?"text-xs py-2 px-3 flex-1 justify-center h-8":"h-8 px-3 text-xs"}`,children:E?"":"Name"}),o.jsx(ye,{variant:l==="date"?"default":"ghost",size:"sm",onClick:()=>a("date"),className:`flex items-center gap-2 whitespace-nowrap ${S?"text-xs py-2 px-3 flex-1 justify-center h-8":"h-8 px-3 text-xs"}`,children:E?"":"Date"}),o.jsx(ye,{variant:l==="generation"?"default":"ghost",size:"sm",onClick:()=>a("generation"),className:`flex items-center gap-2 whitespace-nowrap ${S?"text-xs py-2 px-3 flex-1 justify-center h-8":"h-8 px-3 text-xs"}`,children:E?"":"Generation"})]})]}),o.jsxs(ye,{variant:"outline",size:"sm",onClick:()=>y(!g),className:`h-8 px-3 ${S?"w-full":""}`,children:[o.jsx(yH,{className:`h-4 w-4 ${S?"h-3 w-3 mr-1":"mr-1"}`}),E?"":"Filters",g?o.jsx(c3,{className:`h-4 w-4 ${S?"h-3 w-3 ml-1":"ml-1"}`}):o.jsx(f0,{className:`h-4 w-4 ${S?"h-3 w-3 ml-1":"ml-1"}`}),B&&o.jsx("div",{className:"w-2 h-2 bg-primary rounded-full ml-1"})]})]}),g&&o.jsxs("div",{className:`border-t ${S?"pt-3":"pt-4"} space-y-4`,children:[o.jsxs("div",{className:`flex ${S?"flex-col gap-3":"flex-wrap gap-4"}`,children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:`font-medium ${S?"text-xs":"text-sm"}`,children:E?":":"Generation:"}),o.jsx("div",{className:`flex ${S?"flex-wrap gap-1":"gap-1"}`,children:[1,2,3].map(L=>o.jsxs(ye,{variant:c===L?"default":"outline",size:"sm",onClick:()=>d(c===L?null:L),className:`flex items-center gap-2 whitespace-nowrap ${S?"text-xs py-2 px-3 h-8 flex-1 justify-center":"h-8 px-3"}`,children:[L===1&&o.jsx(mh,{className:`h-3 w-3 ${S?"h-2.5 w-2.5":"mr-1"}`}),L===2&&o.jsx(Xt,{className:`h-3 w-3 ${S?"h-2.5 w-2.5":"mr-1"}`}),L===3&&o.jsx(ta,{className:`h-3 w-3 ${S?"h-2.5 w-2.5":"mr-1"}`}),E?` ${L}`:`Gen ${L}`]},L))})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:`font-medium ${S?"text-xs":"text-sm"}`,children:E?":":"Gender:"}),o.jsxs("div",{className:`flex ${S?"flex-wrap gap-1":"gap-1"}`,children:[o.jsx(ye,{variant:u==="male"?"default":"outline",size:"sm",onClick:()=>f(u==="male"?null:"male"),className:`flex items-center gap-2 whitespace-nowrap ${S?"text-xs py-2 px-3 h-8 flex-1 justify-center":"h-8 px-3"}`,children:E?"":"Male"}),o.jsx(ye,{variant:u==="female"?"default":"outline",size:"sm",onClick:()=>f(u==="female"?null:"female"),className:`flex items-center gap-2 whitespace-nowrap ${S?"text-xs py-2 px-3 h-8 flex-1 justify-center":"h-8 px-3"}`,children:E?"":"Female"})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:`font-medium ${S?"text-xs":"text-sm"}`,children:E?":":"Status:"}),o.jsxs("div",{className:`flex ${S?"flex-wrap gap-1":"gap-1"}`,children:[o.jsxs(ye,{variant:m===!0?"default":"outline",size:"sm",onClick:()=>h(m===!0?null:!0),className:`flex items-center gap-2 whitespace-nowrap ${S?"text-xs py-2 px-3 h-8 flex-1 justify-center":"h-8 px-3"}`,children:[o.jsx(br,{className:`h-3 w-3 ${S?"h-2.5 w-2.5 mr-1":"mr-1"} text-green-600`}),E?"  ":"Alive"]}),o.jsx(ye,{variant:m===!1?"default":"outline",size:"sm",onClick:()=>h(m===!1?null:!1),className:`flex items-center gap-2 whitespace-nowrap ${S?"text-xs py-2 px-3 h-8 flex-1 justify-center":"h-8 px-3"}`,children:E?"":"Deceased"})]})]})]}),B&&o.jsxs(ye,{variant:"ghost",size:"sm",onClick:P,className:`text-muted-foreground ${S?"h-8 px-3 text-xs":"h-8 px-3"}`,children:[o.jsx(ia,{className:`h-4 w-4 ${S?"h-3 w-3 mr-1":"mr-1"}`}),E?" ":"Clear Filters"]})]})]})]}),p&&o.jsx("div",{className:"flex justify-center items-center py-12",children:o.jsx(mr,{className:"h-8 w-8 animate-spin text-primary"})}),I&&!p&&o.jsx(et,{className:S?"rounded-lg":"",children:o.jsxs(rt,{className:"text-center py-12",children:[o.jsx("div",{className:"text-destructive mb-4",children:o.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12 mx-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),o.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:E?"   ":"Error Loading Data"}),o.jsx("p",{className:"text-muted-foreground mb-4",children:I}),o.jsx(ye,{onClick:()=>window.location.reload(),children:E?" ":"Try Again"})]})}),!p&&!I&&o.jsxs("div",{className:"space-y-6",children:[(s==="all"||s==="people")&&_.people.length>0&&o.jsxs(et,{className:S?"rounded-lg":"",children:[o.jsx(ht,{className:S?"p-4":"",children:o.jsxs(gt,{className:`flex items-center gap-2 ${S?"text-lg":""}`,children:[o.jsx(Xt,{className:`h-5 w-5 text-blue-600 ${S?"h-4 w-4":""}`}),E?"":"People",o.jsx(Gn,{variant:"secondary",className:S?"text-xs px-1.5 py-0.5":"",children:_.people.length})]})}),o.jsx(rt,{className:S?"p-4":"",children:o.jsx("div",{className:`grid ${S?"grid-cols-1 gap-3":"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"}`,children:_.people.map(L=>{var O;const D=A(L.generation),V=M(L.birthDate);return o.jsx("div",{className:"group",children:o.jsxs("div",{className:`
                          relative bg-card border rounded-lg shadow-sm hover:shadow-md transition-all duration-200
                          ${L.gender==="male"?"border-blue-200 hover:border-blue-300 dark:border-blue-900 dark:hover:border-blue-700":"border-pink-200 hover:border-pink-300 dark:border-pink-900 dark:hover:border-pink-700"} ${S?"p-3":"p-4"}`,children:[o.jsxs("div",{className:`flex items-start gap-3 ${S?"gap-2":""}`,children:[o.jsx("div",{className:`
                              rounded-full flex items-center justify-center flex-shrink-0
                              ${L.gender==="male"?"bg-blue-100 text-blue-600":"bg-pink-100 text-pink-600"} ${S?"w-10 h-10":"w-12 h-12"}`,children:L.photo?o.jsx("img",{src:L.photo,alt:E?L.firstName:L.firstNameEn||L.firstName,className:"w-full h-full rounded-full object-cover"}):o.jsx(D,{className:`h-6 w-6 ${S?"h-5 w-5":""}`})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("h4",{className:`font-semibold text-foreground truncate ${S?"text-sm":""}`,children:[E?L.firstName:L.firstNameEn||L.firstName,L.lastName&&` ${E?L.lastName:L.lastNameEn||L.lastName}`]}),L.treeName&&o.jsx("p",{className:`text-muted-foreground truncate ${S?"text-xs":"text-sm"}`,children:E?L.treeName:L.treeNameEn||L.treeName}),o.jsxs("div",{className:`flex items-center gap-2 mt-1 ${S?"text-xs":"text-sm"} text-muted-foreground`,children:[V!==null&&o.jsxs(o.Fragment,{children:[o.jsx(Lr,{className:`h-3 w-3 ${S?"h-2.5 w-2.5":""}`}),o.jsxs("span",{children:[V," ",E?"":"yrs"]})]}),L.generation&&o.jsx(Gn,{variant:"outline",className:`text-xs ${S?"px-1.5 py-0.5":""}`,children:E?` ${L.generation}`:`Gen ${L.generation}`}),!L.isAlive&&o.jsx(Gn,{variant:"outline",className:`text-xs ${S?"px-1.5 py-0.5":""}`,children:E?"":"Deceased"})]}),L.occupation&&o.jsx("div",{className:"flex items-center gap-1 mt-1 text-xs text-muted-foreground",children:o.jsx("span",{children:E?L.occupation:L.occupationEn||L.occupation})}),L.birthPlace&&o.jsxs("div",{className:"flex items-center gap-1 mt-1 text-xs text-muted-foreground",children:[o.jsx(ei,{className:`h-3 w-3 ${S?"h-2.5 w-2.5":""}`}),o.jsx("span",{className:"truncate",children:E?L.birthPlace.split("")[0]:((O=L.birthPlaceEn)==null?void 0:O.split(",")[0])||L.birthPlace.split(",")[0]})]})]}),o.jsx("div",{className:`
                              rounded-full flex-shrink-0
                              ${L.isAlive?"bg-green-500":"bg-gray-400"}
                              ${S?"w-2.5 h-2.5":"w-3 h-3"}`})]}),o.jsxs("div",{className:`flex ${S?"gap-1 mt-2":"gap-2 mt-3"} opacity-0 group-hover:opacity-100 transition-opacity`,children:[o.jsx(ye,{asChild:!0,size:"sm",variant:"outline",className:"flex-1 h-7 px-2 text-xs",children:o.jsxs(_t,{to:`/persons/${L.id}`,className:"flex items-center justify-center",children:[o.jsx(ra,{className:`h-3 w-3 ${S?"h-2.5 w-2.5 mr-1":"mr-1"}`}),o.jsx("span",{className:S?"hidden":"",children:E?"":"View"})]})}),o.jsx(ye,{asChild:!0,size:"sm",variant:"outline",className:"flex-1 h-7 px-2 text-xs",children:o.jsxs(_t,{to:`/trees/${L.treeId}`,className:"flex items-center justify-center",children:[o.jsx(qn,{className:`h-3 w-3 ${S?"h-2.5 w-2.5 mr-1":"mr-1"}`}),o.jsx("span",{className:S?"hidden":"",children:E?"":"Tree"})]})})]}),o.jsx("div",{className:`
                            absolute top-2 right-2 rounded-full
                            ${L.gender==="male"?"bg-blue-500":"bg-pink-500"}
                            ${S?"w-2.5 h-2.5":"w-3 h-3"}`})]})},L.id)})})})]}),(s==="all"||s==="trees")&&_.trees.length>0&&o.jsxs(et,{className:S?"rounded-lg":"",children:[o.jsx(ht,{className:S?"p-4":"",children:o.jsxs(gt,{className:`flex items-center gap-2 ${S?"text-lg":""}`,children:[o.jsx(qn,{className:`h-5 w-5 text-green-600 ${S?"h-4 w-4":""}`}),E?" ":"Family Trees",o.jsx(Gn,{variant:"secondary",className:S?"text-xs px-1.5 py-0.5":"",children:_.trees.length})]})}),o.jsx(rt,{className:S?"p-4":"",children:o.jsx("div",{className:`grid ${S?"grid-cols-1 gap-3":"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"}`,children:_.trees.map(L=>o.jsx("div",{className:"group",children:o.jsxs("div",{className:`relative bg-card border border-green-200 rounded-lg shadow-sm hover:shadow-md hover:border-green-300 transition-all duration-200 dark:border-green-900 dark:hover:border-green-700 ${S?"p-3":"p-4"}`,children:[o.jsxs("div",{className:`flex items-start gap-3 ${S?"gap-2":""}`,children:[o.jsx("div",{className:`rounded-full bg-green-100 text-green-600 flex items-center justify-center flex-shrink-0 ${S?"w-10 h-10":"w-12 h-12"}`,children:o.jsx(qn,{className:`h-6 w-6 ${S?"h-5 w-5":""}`})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h4",{className:`font-semibold text-foreground truncate ${S?"text-sm":""}`,children:E?L.name:L.nameEn||L.name}),L.description&&o.jsx("p",{className:`text-muted-foreground mt-1 line-clamp-2 ${S?"text-xs":"text-sm"}`,children:E?L.description:L.descriptionEn||L.description}),o.jsxs("div",{className:`flex items-center gap-2 mt-2 ${S?"text-xs":"text-sm"} text-muted-foreground`,children:[L.memberCount!==void 0&&o.jsxs(o.Fragment,{children:[o.jsx(kn,{className:`h-3 w-3 ${S?"h-2.5 w-2.5":""}`}),o.jsxs("span",{children:[L.memberCount," ",E?"":"members"]})]}),L.isPublic!==void 0&&o.jsx(Gn,{variant:L.isPublic?"default":"secondary",className:`text-xs ${S?"px-1.5 py-0.5":""}`,children:L.isPublic?E?"":"Public":E?"":"Private"})]}),o.jsxs("div",{className:"flex items-center gap-1 mt-1 text-xs text-muted-foreground",children:[o.jsx(Lr,{className:`h-3 w-3 ${S?"h-2.5 w-2.5":""}`}),o.jsxs("span",{children:[E?" : ":"Created: ",new Date(L.createdAt).toLocaleDateString(E?"ar-SA":"en-US")]})]}),L.owner&&o.jsxs("div",{className:"flex items-center gap-1 mt-1 text-xs text-muted-foreground",children:[o.jsx(Xt,{className:`h-3 w-3 ${S?"h-2.5 w-2.5":""}`}),o.jsx("span",{children:E?`${L.owner.firstName} ${L.owner.lastName}`:`${L.owner.firstName} ${L.owner.lastName}`})]})]})]}),o.jsxs("div",{className:`flex ${S?"gap-1 mt-2":"gap-2 mt-3"} opacity-0 group-hover:opacity-100 transition-opacity`,children:[o.jsx(ye,{asChild:!0,size:"sm",variant:"outline",className:"flex-1 h-7 px-2 text-xs",children:o.jsxs(_t,{to:`/trees/${L.id}`,className:"flex items-center justify-center",children:[o.jsx(ra,{className:`h-3 w-3 ${S?"h-2.5 w-2.5 mr-1":"mr-1"}`}),o.jsx("span",{className:S?"hidden":"",children:E?"":"View"})]})}),o.jsx(ye,{asChild:!0,size:"sm",variant:"outline",className:"flex-1 h-7 px-2 text-xs",children:o.jsxs(_t,{to:`/trees/${L.id}/edit`,className:"flex items-center justify-center",children:[o.jsx(sa,{className:`h-3 w-3 ${S?"h-2.5 w-2.5 mr-1":"mr-1"}`}),o.jsx("span",{className:S?"hidden":"",children:E?"":"Edit"})]})})]})]})},L.id))})})]}),_.people.length===0&&_.trees.length===0&&n&&o.jsx(et,{className:S?"rounded-lg":"",children:o.jsxs(rt,{className:`text-center ${S?"py-8":"py-12"}`,children:[o.jsx(Qi,{className:`text-muted-foreground mx-auto mb-4 ${S?"h-8 w-8":"h-12 w-12"}`}),o.jsx("h3",{className:`font-semibold text-foreground mb-2 ${S?"text-base":"text-lg"}`,children:E?"  ":"No Results Found"}),o.jsx("p",{className:`text-muted-foreground mb-4 ${S?"text-sm":""}`,children:E?`     "${n}"`:`We couldn't find any results for "${n}"`}),o.jsxs("div",{className:`text-muted-foreground ${S?"text-xs":"text-sm"}`,children:[o.jsx("p",{children:E?":":"Try:"}),o.jsxs("ul",{className:`mt-2 ${S?"space-y-0.5":"space-y-1"}`,children:[o.jsxs("li",{children:[" ",E?"  ":"Check your spelling"]}),o.jsxs("li",{children:[" ",E?"    ":"Use fewer or different keywords"]}),o.jsxs("li",{children:[" ",E?" ":"Clear filters"]}),o.jsxs("li",{children:[" ",E?"  ":"Search using English names"]})]})]})]})}),!n&&!p&&o.jsx(et,{className:S?"rounded-lg":"",children:o.jsxs(rt,{className:`text-center ${S?"py-8":"py-12"}`,children:[o.jsx(Qi,{className:`text-muted-foreground mx-auto mb-4 ${S?"h-8 w-8":"h-12 w-12"}`}),o.jsx("h3",{className:`font-semibold text-foreground mb-2 ${S?"text-base":"text-lg"}`,children:E?" ":"Start Searching"}),o.jsx("p",{className:`text-muted-foreground ${S?"text-sm":""}`,children:E?"          ":"Search through family trees and people using names, places, or occupations"})]})})]})]})},X0e=()=>{var E,_,M,A,P,B,L;const{isMobile:e}=_r(),{language:t,setLanguage:n,theme:r,setTheme:s}=Ft(),{success:i,error:l}=MI(),{user:a,updateNotificationSettings:c,updatePrivacySettings:d}=Mr(),[u,f]=J.useState("general"),[m,h]=J.useState(!1),[g,y]=J.useState(!1),p=t==="ar",[x,b]=J.useState({language:t,theme:r,notifications:{email:((_=(E=a==null?void 0:a.notifications)==null?void 0:E.email)==null?void 0:_.newSuggestions)??!0,push:((A=(M=a==null?void 0:a.notifications)==null?void 0:M.push)==null?void 0:A.enabled)??!0,sound:!0,familyUpdates:!0,newMembers:!0,birthdays:!0,anniversaries:!0},privacy:{profileVisibility:((P=a==null?void 0:a.privacy)==null?void 0:P.profileVisibility)??"family",allowSearch:((B=a==null?void 0:a.privacy)==null?void 0:B.allowSearchEngines)??!0,showOnlineStatus:((L=a==null?void 0:a.privacy)==null?void 0:L.showOnlineStatus)??!0,allowDirectMessages:!0},display:{dateFormat:"dd/mm/yyyy",timeFormat:"24h",fontSize:"medium",compactMode:!1},backup:{autoBackup:!0,backupFrequency:"weekly",cloudSync:!0}});J.useEffect(()=>{a&&b(D=>{var V,O,H,W,$,z,q;return{...D,notifications:{...D.notifications,email:((O=(V=a.notifications)==null?void 0:V.email)==null?void 0:O.newSuggestions)??!0,push:((W=(H=a.notifications)==null?void 0:H.push)==null?void 0:W.enabled)??!0},privacy:{...D.privacy,profileVisibility:(($=a.privacy)==null?void 0:$.profileVisibility)??"family",allowSearch:((z=a.privacy)==null?void 0:z.allowSearchEngines)??!0,showOnlineStatus:((q=a.privacy)==null?void 0:q.showOnlineStatus)??!0}}})},[a]),J.useEffect(()=>{b(D=>({...D,language:t,theme:r}))},[t,r]);const w=(D,V,O)=>{b(H=>({...H,[D]:{...H[D],[V]:O}})),h(!0)},N=D=>{n(D),b(V=>({...V,language:D})),h(!0)},k=D=>{s(D),b(V=>({...V,theme:D})),h(!0)},I=async()=>{y(!0);try{await c({email:{newSuggestions:x.notifications.email,treeUpdates:x.notifications.familyUpdates,subscriptionUpdates:x.notifications.newMembers,marketing:x.notifications.anniversaries},push:{enabled:x.notifications.push}}),await d({profileVisibility:x.privacy.profileVisibility,allowSearchEngines:x.privacy.allowSearch,showOnlineStatus:x.privacy.showOnlineStatus}),h(!1),i({en:"Settings saved successfully",ar:"   "})}catch{l({en:"Failed to save settings",ar:"   "})}finally{y(!1)}},R=()=>{var D,V,O,H,W,$,z;confirm(p?"       ":"Are you sure you want to reset all settings?")&&(b({language:t,theme:r,notifications:{email:((V=(D=a==null?void 0:a.notifications)==null?void 0:D.email)==null?void 0:V.newSuggestions)??!0,push:((H=(O=a==null?void 0:a.notifications)==null?void 0:O.push)==null?void 0:H.enabled)??!0,sound:!0,familyUpdates:!0,newMembers:!0,birthdays:!0,anniversaries:!0},privacy:{profileVisibility:((W=a==null?void 0:a.privacy)==null?void 0:W.profileVisibility)??"family",allowSearch:(($=a==null?void 0:a.privacy)==null?void 0:$.allowSearchEngines)??!0,showOnlineStatus:((z=a==null?void 0:a.privacy)==null?void 0:z.showOnlineStatus)??!0,allowDirectMessages:!0},display:{dateFormat:"dd/mm/yyyy",timeFormat:"24h",fontSize:"medium",compactMode:!1},backup:{autoBackup:!0,backupFrequency:"weekly",cloudSync:!0}}),h(!0))},T=()=>{},S=()=>{};return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-foreground",children:p?"":"Settings"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:p?"   ":"Manage application and account settings"})]}),m&&o.jsx(ye,{onClick:I,disabled:g,className:"flex items-center gap-2",size:e?"icon":"default",children:g?o.jsxs(o.Fragment,{children:[o.jsx(mr,{className:"h-4 w-4 animate-spin"}),!e&&(p?" ...":"Saving...")]}):o.jsxs(o.Fragment,{children:[o.jsx(Xu,{className:"h-4 w-4"}),!e&&(p?" ":"Save Changes")]})})]}),o.jsx("div",{className:"flex gap-1 border-b overflow-x-auto",children:[{id:"general",label:p?"":"General",icon:gh},{id:"account",label:p?"":"Account",icon:Xt}].map(D=>o.jsxs(ye,{variant:u===D.id?"default":"ghost",onClick:()=>f(D.id),className:"flex items-center gap-2 whitespace-nowrap",size:e?"icon":"default",title:e?D.label:void 0,children:[be.createElement(D.icon,{className:"h-4 w-4"}),!e&&D.label," "]},D.id))}),u==="general"&&o.jsxs("div",{className:"space-y-6",children:[o.jsxs(et,{children:[o.jsx(ht,{children:o.jsxs(gt,{className:"flex items-center gap-2",children:[o.jsx(EI,{className:"h-5 w-5"}),p?" ":"Language & Region"]})}),o.jsx(rt,{className:"space-y-4",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium",children:p?" ":"Application Language"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:p?"   ":"Choose the application interface language"})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs(ye,{variant:x.language==="ar"?"default":"outline",size:e?"icon":"sm",onClick:()=>N("ar"),title:e?"":void 0,children:[e?"":""," "]}),o.jsxs(ye,{variant:x.language==="en"?"default":"outline",size:e?"icon":"sm",onClick:()=>N("en"),title:e?"English":void 0,children:[e?"En":"English"," "]})]})]})})]}),o.jsxs(et,{children:[o.jsx(ht,{children:o.jsxs(gt,{className:"flex items-center gap-2",children:[o.jsx(xH,{className:"h-5 w-5"}),p?"":"Appearance"]})}),o.jsx(rt,{className:"space-y-4",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium",children:p?" ":"Theme Mode"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:p?"   ":"Choose your preferred theme mode"})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs(ye,{variant:x.theme==="light"?"default":"outline",size:e?"icon":"sm",onClick:()=>k("light"),className:"flex items-center gap-2",title:e?p?"":"Light":void 0,children:[o.jsx(xh,{className:"h-4 w-4"}),!e&&(p?"":"Light")," "]}),o.jsxs(ye,{variant:x.theme==="dark"?"default":"outline",size:e?"icon":"sm",onClick:()=>k("dark"),className:"flex items-center gap-2",title:e?p?"":"Dark":void 0,children:[o.jsx(ph,{className:"h-4 w-4"}),!e&&(p?"":"Dark")," "]}),o.jsxs(ye,{variant:"outline",size:e?"icon":"sm",onClick:()=>{},className:"flex items-center gap-2",title:e?p?"":"System":void 0,children:[o.jsx(A_,{className:"h-4 w-4"}),!e&&(p?"":"System")," "]})]})]})})]})]}),u==="notifications"&&o.jsxs(et,{children:[o.jsx(ht,{children:o.jsxs(gt,{className:"flex items-center gap-2",children:[o.jsx(nH,{className:"h-5 w-5"}),p?" ":"Notification Settings"]})}),o.jsxs(rt,{className:"space-y-6",children:[o.jsxs("div",{className:"space-y-4",children:[o.jsx("h3",{className:"font-medium",children:p?" ":"Notification Methods"}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium",children:p?"  ":"Email Notifications"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:p?"    ":"Receive notifications via email"})]}),o.jsx(ye,{variant:x.notifications.email?"default":"outline",size:e?"icon":"sm",onClick:()=>w("notifications","email",!x.notifications.email),title:e?x.notifications.email?p?"":"On":p?"":"Off":void 0,children:e?x.notifications.email?p?"":"ON":p?"":"OFF":x.notifications.email?p?"":"On":p?"":"Off"})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium",children:p?" ":"Push Notifications"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:p?"    ":"Receive push notifications on device"})]}),o.jsx(ye,{variant:x.notifications.push?"default":"outline",size:e?"icon":"sm",onClick:()=>w("notifications","push",!x.notifications.push),title:e?x.notifications.push?p?"":"On":p?"":"Off":void 0,children:e?x.notifications.push?p?"":"ON":p?"":"OFF":x.notifications.push?p?"":"On":p?"":"Off"})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium",children:p?"":"Sound Notifications"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:p?"   ":"Play sounds with notifications"})]}),o.jsxs(ye,{variant:x.notifications.sound?"default":"outline",size:e?"icon":"sm",onClick:()=>w("notifications","sound",!x.notifications.sound),className:"flex items-center gap-2",title:e?x.notifications.sound?p?"":"On":p?"":"Off":void 0,children:[x.notifications.sound?o.jsx(_H,{className:"h-4 w-4"}):o.jsx(SH,{className:"h-4 w-4"}),!e&&(x.notifications.sound?p?"":"On":p?"":"Off")]})]})]}),o.jsxs("div",{className:"border-t pt-6 space-y-4",children:[o.jsx("h3",{className:"font-medium",children:p?" ":"Notification Types"}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium",children:p?" ":"Family Updates"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:p?"      ":"Notifications when family members are added or updated"})]}),o.jsx(ye,{variant:x.notifications.familyUpdates?"default":"outline",size:e?"icon":"sm",onClick:()=>w("notifications","familyUpdates",!x.notifications.familyUpdates),title:e?x.notifications.familyUpdates?p?"":"On":p?"":"Off":void 0,children:e?x.notifications.familyUpdates?p?"":"ON":p?"":"OFF":x.notifications.familyUpdates?p?"":"On":p?"":"Off"})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium",children:p?" ":"New Members"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:p?"     ":"Notifications when new members join the tree"})]}),o.jsx(ye,{variant:x.notifications.newMembers?"default":"outline",size:e?"icon":"sm",onClick:()=>w("notifications","newMembers",!x.notifications.newMembers),title:e?x.notifications.newMembers?p?"":"On":p?"":"Off":void 0,children:e?x.notifications.newMembers?p?"":"ON":p?"":"OFF":x.notifications.newMembers?p?"":"On":p?"":"Off"})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium",children:p?" ":"Birthdays"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:p?"    ":"Reminders for family members birthdays"})]}),o.jsx(ye,{variant:x.notifications.birthdays?"default":"outline",size:e?"icon":"sm",onClick:()=>w("notifications","birthdays",!x.notifications.birthdays),title:e?x.notifications.birthdays?p?"":"On":p?"":"Off":void 0,children:e?x.notifications.birthdays?p?"":"ON":p?"":"OFF":x.notifications.birthdays?p?"":"On":p?"":"Off"})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium",children:p?" ":"Anniversaries"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:p?"   ":"Reminders for important anniversaries"})]}),o.jsx(ye,{variant:x.notifications.anniversaries?"default":"outline",size:e?"icon":"sm",onClick:()=>w("notifications","anniversaries",!x.notifications.anniversaries),title:e?x.notifications.anniversaries?p?"":"On":p?"":"Off":void 0,children:e?x.notifications.anniversaries?p?"":"ON":p?"":"OFF":x.notifications.anniversaries?p?"":"On":p?"":"Off"})]})]})]})]}),u==="privacy"&&o.jsxs(et,{children:[o.jsx(ht,{children:o.jsxs(gt,{className:"flex items-center gap-2",children:[o.jsx(g0,{className:"h-5 w-5"}),p?" ":"Privacy Settings"]})}),o.jsxs(rt,{className:"space-y-6",children:[o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium",children:p?"  ":"Profile Visibility"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:p?"    ":"Who can see your profile"})]}),o.jsxs("select",{value:x.privacy.profileVisibility,onChange:D=>w("privacy","profileVisibility",D.target.value),className:"px-3 py-2 border border-input rounded-md bg-background",children:[o.jsx("option",{value:"public",children:p?"":"Public"}),o.jsx("option",{value:"family",children:p?" ":"Family Only"}),o.jsx("option",{value:"private",children:p?"":"Private"})]})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium",children:p?" ":"Allow Search"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:p?"     ":"Allow others to find you in search"})]}),o.jsx(ye,{variant:x.privacy.allowSearch?"default":"outline",size:e?"icon":"sm",onClick:()=>w("privacy","allowSearch",!x.privacy.allowSearch),title:e?x.privacy.allowSearch?p?"":"Allowed":p?"":"Blocked":void 0,children:e?x.privacy.allowSearch?p?"":"ON":p?"":"OFF":x.privacy.allowSearch?p?"":"Allowed":p?"":"Blocked"})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium",children:p?"  ":"Show Online Status"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:p?"      ":"Show whether you are online or not"})]}),o.jsxs(ye,{variant:x.privacy.showOnlineStatus?"default":"outline",size:e?"icon":"sm",onClick:()=>w("privacy","showOnlineStatus",!x.privacy.showOnlineStatus),className:"flex items-center gap-2",title:e?x.privacy.showOnlineStatus?p?"":"Visible":p?"":"Hidden":void 0,children:[x.privacy.showOnlineStatus?o.jsx(ra,{className:"h-4 w-4"}):o.jsx(kI,{className:"h-4 w-4"}),!e&&(x.privacy.showOnlineStatus?p?"":"Visible":p?"":"Hidden")]})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium",children:p?"  ":"Allow Direct Messages"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:p?"     ":"Allow others to send you direct messages"})]}),o.jsx(ye,{variant:x.privacy.allowDirectMessages?"default":"outline",size:e?"icon":"sm",onClick:()=>w("privacy","allowDirectMessages",!x.privacy.allowDirectMessages),title:e?x.privacy.allowDirectMessages?p?"":"Allowed":p?"":"Blocked":void 0,children:e?x.privacy.allowDirectMessages?p?"":"ON":p?"":"OFF":x.privacy.allowDirectMessages?p?"":"Allowed":p?"":"Blocked"})]})]}),o.jsx("div",{className:"p-4 bg-secondary/50 rounded-lg",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(Wu,{className:"h-5 w-5 text-primary mt-0.5"}),o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-sm",children:p?" ":"Privacy Information"}),o.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:p?"     .       .":"We respect your privacy and protect your personal data. You can change these settings at any time."})]})]})})]})]}),u==="display"&&o.jsxs(et,{children:[o.jsx(ht,{children:o.jsxs(gt,{className:"flex items-center gap-2",children:[o.jsx(A_,{className:"h-5 w-5"}),p?" ":"Display Settings"]})}),o.jsx(rt,{className:"space-y-6",children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium",children:p?" ":"Date Format"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:p?"   ":"Choose how dates are displayed"})]}),o.jsxs("select",{value:x.display.dateFormat,onChange:D=>w("display","dateFormat",D.target.value),className:"px-3 py-2 border border-input rounded-md bg-background",children:[o.jsx("option",{value:"dd/mm/yyyy",children:"DD/MM/YYYY"}),o.jsx("option",{value:"mm/dd/yyyy",children:"MM/DD/YYYY"}),o.jsx("option",{value:"yyyy-mm-dd",children:"YYYY-MM-DD"})]})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium",children:p?" ":"Time Format"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:p?"   ":"Choose how time is displayed"})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs(ye,{variant:x.display.timeFormat==="12h"?"default":"outline",size:e?"icon":"sm",onClick:()=>w("display","timeFormat","12h"),title:e?"12h":void 0,children:[e?"12":"12h"," "]}),o.jsxs(ye,{variant:x.display.timeFormat==="24h"?"default":"outline",size:e?"icon":"sm",onClick:()=>w("display","timeFormat","24h"),title:e?"24h":void 0,children:[e?"24":"24h"," "]})]})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium",children:p?" ":"Font Size"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:p?"   ":"Choose your preferred font size"})]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs(ye,{variant:x.display.fontSize==="small"?"default":"outline",size:e?"icon":"sm",onClick:()=>w("display","fontSize","small"),title:e?p?"":"Small":void 0,children:[e?p?"":"S":p?"":"Small"," "]}),o.jsxs(ye,{variant:x.display.fontSize==="medium"?"default":"outline",size:e?"icon":"sm",onClick:()=>w("display","fontSize","medium"),title:e?p?"":"Medium":void 0,children:[e?p?"":"M":p?"":"Medium"," "]}),o.jsxs(ye,{variant:x.display.fontSize==="large"?"default":"outline",size:e?"icon":"sm",onClick:()=>w("display","fontSize","large"),title:e?p?"":"Large":void 0,children:[e?p?"":"L":p?"":"Large"," "]})]})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium",children:p?" ":"Compact Mode"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:p?"      ":"Show more content in less space"})]}),o.jsx(ye,{variant:x.display.compactMode?"default":"outline",size:e?"icon":"sm",onClick:()=>w("display","compactMode",!x.display.compactMode),title:e?x.display.compactMode?p?"":"On":p?"":"Off":void 0,children:e?x.display.compactMode?p?"":"ON":p?"":"OFF":x.display.compactMode?p?"":"On":p?"":"Off"})]})]})})]}),u==="backup"&&o.jsxs(et,{children:[o.jsx(ht,{children:o.jsxs(gt,{className:"flex items-center gap-2",children:[o.jsx(iH,{className:"h-5 w-5"}),p?"  ":"Backup & Sync"]})}),o.jsxs(rt,{className:"space-y-6",children:[o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium",children:p?"  ":"Auto Backup"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:p?"     ":"Automatically create backups of your data"})]}),o.jsx(ye,{variant:x.backup.autoBackup?"default":"outline",size:e?"icon":"sm",onClick:()=>w("backup","autoBackup",!x.backup.autoBackup),title:e?x.backup.autoBackup?p?"":"On":p?"":"Off":void 0,children:e?x.backup.autoBackup?p?"":"ON":p?"":"OFF":x.backup.autoBackup?p?"":"On":p?"":"Off"})]}),x.backup.autoBackup&&o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium",children:p?"  ":"Backup Frequency"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:p?"     ":"How often backups are created"})]}),o.jsxs("select",{value:x.backup.backupFrequency,onChange:D=>w("backup","backupFrequency",D.target.value),className:"px-3 py-2 border border-input rounded-md bg-background",children:[o.jsx("option",{value:"daily",children:p?"":"Daily"}),o.jsx("option",{value:"weekly",children:p?"":"Weekly"}),o.jsx("option",{value:"monthly",children:p?"":"Monthly"})]})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium",children:p?" ":"Cloud Sync"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:p?"    ":"Sync data with cloud storage"})]}),o.jsxs(ye,{variant:x.backup.cloudSync?"default":"outline",size:e?"icon":"sm",onClick:()=>w("backup","cloudSync",!x.backup.cloudSync),className:"flex items-center gap-2",title:e?x.backup.cloudSync?p?"":"On":p?"":"Off":void 0,children:[o.jsx(sH,{className:"h-4 w-4"}),!e&&(x.backup.cloudSync?p?"":"On":p?"":"Off")]})]})]}),o.jsxs("div",{className:"border-t pt-6 space-y-4",children:[o.jsx("h3",{className:"font-medium",children:p?" ":"Data Management"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs(ye,{variant:"outline",onClick:T,className:"flex items-center gap-2 h-auto p-4",size:e?"icon":"default",children:[o.jsx(eh,{className:"h-5 w-5"}),!e&&o.jsxs("div",{className:"text-left",children:[o.jsx("p",{className:"font-medium",children:p?" ":"Export Data"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:p?"    ":"Download a copy of all your data"})]})]}),o.jsxs(ye,{variant:"outline",onClick:S,className:"flex items-center gap-2 h-auto p-4",size:e?"icon":"default",children:[o.jsx(jH,{className:"h-5 w-5"}),!e&&o.jsxs("div",{className:"text-left",children:[o.jsx("p",{className:"font-medium",children:p?" ":"Import Data"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:p?"    ":"Upload and import data from file"})]})]})]}),o.jsx("div",{className:"p-4 bg-secondary/50 rounded-lg",children:o.jsxs("div",{className:"flex items-start gap-3",children:[o.jsx(cH,{className:"h-5 w-5 text-primary mt-0.5"}),o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-sm",children:p?" ":"Storage Information"}),o.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:p?" : 2.3   10 ":"Used space: 2.3 GB of 10 GB"}),o.jsx("div",{className:"w-full bg-secondary rounded-full h-2 mt-2",children:o.jsx("div",{className:"bg-primary h-2 rounded-full",style:{width:"23%"}})})]})]})})]})]})]}),u==="account"&&o.jsxs("div",{className:"space-y-6",children:[o.jsxs(et,{children:[o.jsx(ht,{children:o.jsxs(gt,{className:"flex items-center gap-2",children:[o.jsx(Xt,{className:"h-5 w-5"}),p?" ":"Account Information"]})}),o.jsx(rt,{className:"space-y-4",children:o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-sm font-medium",children:p?" ":"Full Name"}),o.jsx(Bt,{value:`${(a==null?void 0:a.firstName)||""} ${(a==null?void 0:a.lastName)||""}`,disabled:!0,className:"bg-secondary/50"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-sm font-medium",children:p?" ":"Email"}),o.jsx(Bt,{value:(a==null?void 0:a.email)||"",disabled:!0,className:"bg-secondary/50"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-sm font-medium",children:p?" ":"Phone Number"}),o.jsx(Bt,{value:(a==null?void 0:a.phone)||"",disabled:!0,className:"bg-secondary/50"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-sm font-medium",children:p?" ":"Join Date"}),o.jsx(Bt,{value:a!=null&&a.createdAt?new Date(a.createdAt).toLocaleDateString():"",disabled:!0,className:"bg-secondary/50"})]})]})})]}),o.jsxs(et,{className:"border-destructive/20",children:[o.jsx(ht,{children:o.jsxs(gt,{className:"flex items-center gap-2 text-destructive",children:[o.jsx(No,{className:"h-5 w-5"}),p?" ":"Danger Zone"]})}),o.jsxs(rt,{className:"space-y-4",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-destructive",children:p?"  ":"Reset Settings"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:p?"     ":"Reset all settings to default values"})]}),o.jsxs(ye,{variant:"outline",onClick:R,className:"flex items-center gap-2",size:e?"icon":"default",children:[o.jsx(ml,{className:"h-4 w-4"}),!e&&(p?" ":"Reset")]})]}),o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"font-medium text-destructive",children:p?" ":"Delete Account"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:p?"    ":"Permanently delete account and all data"})]}),o.jsxs(ye,{variant:"destructive",className:"flex items-center gap-2",size:e?"icon":"default",children:[o.jsx($a,{className:"h-4 w-4"}),!e&&(p?" ":"Delete Account")]})]})]})]})]}),m&&o.jsxs("div",{className:"fixed bottom-4 left-1/2 transform -translate-x-1/2 bg-primary text-primary-foreground px-6 py-3 rounded-lg shadow-lg flex items-center gap-3",children:[o.jsx(Wu,{className:"h-5 w-5"}),o.jsx("span",{children:p?"   ":"You have unsaved changes"}),o.jsx(ye,{variant:"secondary",size:e?"icon":"sm",onClick:I,disabled:g,className:"flex items-center gap-2",children:g?o.jsx(mr,{className:"h-4 w-4 animate-spin"}):o.jsxs(o.Fragment,{children:[o.jsx(Xu,{className:"h-4 w-4"}),!e&&(p?"":"Save")," "]})})]})]})},K0e=()=>{var T,S,E;const{user:e,updateProfile:t,uploadAvatar:n,deleteAvatar:r}=Mr(),{language:s}=Ft(),{success:i,error:l}=MI();jr();const[a,c]=J.useState(!1),[d,u]=J.useState(!1),[f,m]=J.useState({firstName:(e==null?void 0:e.firstName)||"",lastName:(e==null?void 0:e.lastName)||"",email:(e==null?void 0:e.email)||"",phone:(e==null?void 0:e.phone)||"",country:(e==null?void 0:e.country)||"",city:(e==null?void 0:e.city)||"",dateOfBirth:(e==null?void 0:e.dateOfBirth)||"",gender:(e==null?void 0:e.gender)||"",bio:""}),[h,g]=J.useState(null),[y,p]=J.useState(null),x=s==="ar";be.useEffect(()=>{e&&m({firstName:e.firstName||"",lastName:e.lastName||"",email:e.email||"",phone:e.phone||"",country:e.country||"",city:e.city||"",dateOfBirth:e.dateOfBirth||"",gender:e.gender||"",bio:""})},[e]);const b=_=>{const{name:M,value:A}=_.target;m(P=>({...P,[M]:A}))},w=_=>{var A;const M=(A=_.target.files)==null?void 0:A[0];if(M){if(M.size>5*1024*1024){l({en:"File size exceeds 5MB limit",ar:"      5 "});return}p(M);const P=new FileReader;P.onloadend=()=>{g(P.result)},P.readAsDataURL(M)}},N=()=>{g(null),p(null),e!=null&&e.avatar&&g(null)},k=async()=>{var _,M,A,P;u(!0);try{const B={firstName:f.firstName,lastName:f.lastName,phone:f.phone||void 0,country:f.country||void 0,city:f.city||void 0,dateOfBirth:f.dateOfBirth||void 0,gender:f.gender&&f.gender!==""?f.gender:void 0};await t(B),y&&await n(y),c(!1),i({en:"Profile updated successfully",ar:"    "})}catch(B){console.error("Profile update error:",B);let L=B.message||"Unknown error";((_=B.response)==null?void 0:_.status)===405?L="Profile update method not allowed. Please contact support.":((M=B.response)==null?void 0:M.status)===400?L="Invalid profile data. Please check your inputs.":((A=B.response)==null?void 0:A.status)===401?L="Authentication required. Please log in again.":((P=B.response)==null?void 0:P.status)===500&&(L="Server error. Please try again later."),l({en:"Failed to update profile: "+L,ar:"    : "+L})}finally{u(!1)}},I=()=>{e&&m({firstName:e.firstName||"",lastName:e.lastName||"",email:e.email||"",phone:e.phone||"",country:e.country||"",city:e.city||"",dateOfBirth:e.dateOfBirth||"",gender:e.gender||"",bio:""}),g(null),p(null),c(!1)},R=_=>_?new Date(_).toLocaleDateString(s==="ar"?"ar-SA":"en-US"):"";return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold text-foreground",children:x?" ":"Profile"}),o.jsx("p",{className:"text-sm text-muted-foreground",children:x?"   ":"Manage your account information"})]}),!a&&o.jsxs(ye,{onClick:()=>c(!0),className:"flex items-center gap-2",children:[o.jsx(sa,{className:"h-4 w-4"}),x?"":"Edit"]})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[o.jsx("div",{className:"lg:col-span-1",children:o.jsx(et,{children:o.jsx(rt,{className:"p-6",children:o.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"relative",children:a?o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"w-24 h-24 rounded-full bg-secondary flex items-center justify-center overflow-hidden",children:h?o.jsx("img",{src:h,alt:"Preview",className:"w-full h-full object-cover"}):(T=e==null?void 0:e.avatar)!=null&&T.url?o.jsx("img",{src:e.avatar.url,alt:e.firstName,className:"w-full h-full object-cover"}):o.jsx(Xt,{className:"h-12 w-12 text-muted-foreground"})}),o.jsxs("label",{className:"absolute bottom-0 right-0 bg-primary rounded-full p-2 cursor-pointer shadow-md hover:bg-primary/90 transition-colors",children:[o.jsx(Yh,{className:"h-4 w-4 text-primary-foreground"}),o.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:w})]})]}):o.jsx("div",{className:"w-24 h-24 rounded-full bg-secondary flex items-center justify-center overflow-hidden",children:(S=e==null?void 0:e.avatar)!=null&&S.url?o.jsx("img",{src:e.avatar.url,alt:e.firstName,className:"w-full h-full object-cover"}):o.jsx(Xt,{className:"h-12 w-12 text-muted-foreground"})})}),a&&(h||((E=e==null?void 0:e.avatar)==null?void 0:E.url))&&o.jsx("button",{onClick:N,className:"absolute -top-2 -right-2 bg-destructive rounded-full p-1 shadow-md hover:bg-destructive/90 transition-colors",children:o.jsx(ia,{className:"h-3 w-3 text-destructive-foreground"})})]}),o.jsxs("div",{className:"text-center space-y-1",children:[o.jsxs("h2",{className:"text-xl font-semibold",children:[e==null?void 0:e.firstName," ",e==null?void 0:e.lastName]}),o.jsx("p",{className:"text-sm text-muted-foreground",children:e==null?void 0:e.email}),(e==null?void 0:e.country)&&o.jsxs("div",{className:"flex items-center justify-center gap-1 text-sm text-muted-foreground",children:[o.jsx(ei,{className:"h-4 w-4"}),o.jsxs("span",{children:[e.country,e.city?`, ${e.city}`:""]})]})]})]})})})}),o.jsx("div",{className:"lg:col-span-2",children:o.jsxs(et,{children:[o.jsx(ht,{children:o.jsxs(gt,{className:"flex items-center gap-2",children:[o.jsx(Xt,{className:"h-5 w-5"}),x?" ":"Account Information"]})}),o.jsx(rt,{className:"space-y-6",children:a?o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-sm font-medium",children:x?" ":"First Name"}),o.jsx(Bt,{name:"firstName",value:f.firstName,onChange:b,placeholder:x?" ":"First Name"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-sm font-medium",children:x?" ":"Last Name"}),o.jsx(Bt,{name:"lastName",value:f.lastName,onChange:b,placeholder:x?" ":"Last Name"})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-sm font-medium",children:x?" ":"Email"}),o.jsx(Bt,{name:"email",value:f.email,onChange:b,disabled:!0,className:"bg-secondary/50"}),o.jsx("p",{className:"text-xs text-muted-foreground",children:x?"    ":"Email cannot be changed"})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-sm font-medium",children:x?" ":"Phone Number"}),o.jsx(Bt,{name:"phone",value:f.phone,onChange:b,placeholder:x?" ":"Phone Number"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-sm font-medium",children:x?" ":"Date of Birth"}),o.jsx(Bt,{name:"dateOfBirth",type:"date",value:f.dateOfBirth,onChange:b})]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-sm font-medium",children:x?"":"Country"}),o.jsx(Bt,{name:"country",value:f.country,onChange:b,placeholder:x?"":"Country"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-sm font-medium",children:x?"":"City"}),o.jsx(Bt,{name:"city",value:f.city,onChange:b,placeholder:x?"":"City"})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-sm font-medium",children:x?"":"Gender"}),o.jsxs("select",{name:"gender",value:f.gender,onChange:_=>m(M=>({...M,gender:_.target.value})),className:"w-full px-3 py-2 border border-input rounded-md bg-background",children:[o.jsx("option",{value:"",children:x?"":"Select"}),o.jsx("option",{value:"male",children:x?"":"Male"}),o.jsx("option",{value:"female",children:x?"":"Female"}),o.jsx("option",{value:"other",children:x?"":"Other"})]})]}),o.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[o.jsxs(ye,{variant:"outline",onClick:I,disabled:d,className:"flex items-center gap-2",children:[o.jsx(ia,{className:"h-4 w-4"}),x?"":"Cancel"]}),o.jsxs(ye,{onClick:k,disabled:d,className:"flex items-center gap-2",children:[d?o.jsx(mr,{className:"h-4 w-4 animate-spin"}):o.jsx(Xu,{className:"h-4 w-4"}),x?" ":"Save Changes"]})]})]}):o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:x?" ":"First Name"}),o.jsx("p",{children:(e==null?void 0:e.firstName)||"-"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:x?" ":"Last Name"}),o.jsx("p",{children:(e==null?void 0:e.lastName)||"-"})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:x?" ":"Email"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Ra,{className:"h-4 w-4 text-muted-foreground"}),o.jsx("p",{children:(e==null?void 0:e.email)||"-"})]})]}),(e==null?void 0:e.phone)&&o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:x?" ":"Phone Number"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Gu,{className:"h-4 w-4 text-muted-foreground"}),o.jsx("p",{children:e.phone})]})]}),((e==null?void 0:e.country)||(e==null?void 0:e.city))&&o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:x?"":"Address"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(ei,{className:"h-4 w-4 text-muted-foreground"}),o.jsx("p",{children:e!=null&&e.country||e!=null&&e.city?`${e.country||""}${e.city?`, ${e.city}`:""}`:x?" ":"Not set"})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:x?"":"Gender"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(jo,{className:"h-4 w-4 text-muted-foreground"}),o.jsx("p",{children:e!=null&&e.gender?e.gender==="male"?x?"":"Male":e.gender==="female"?x?"":"Female":x?"":"Other":x?" ":"Not set"})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:x?" ":"Join Date"}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Lr,{className:"h-4 w-4 text-muted-foreground"}),o.jsx("p",{children:e!=null&&e.createdAt?R(e.createdAt):"-"})]})]})]})})]})})]})]})},J0e=()=>{const{language:e}=Ft(),t=e==="ar",n=[{icon:qn,titleAr:"  ",titleEn:"Interactive Family Tree",descriptionAr:"            ",descriptionEn:"Create beautiful and interactive family trees with real tree design, connecting lines and distinctive colors",category:"core"},{icon:kn,titleAr:" ",titleEn:"Member Management",descriptionAr:"           ",descriptionEn:"Add family members with detailed information, photos, birth and death dates, and family relationships",category:"core"},{icon:Qi,titleAr:" vanced",titleEn:"Advanced Search",descriptionAr:"            ",descriptionEn:"Search all family members by name, birth date, location, or any other information",category:"search"},{icon:p0,titleAr:" ",titleEn:"Sharing & Collaboration",descriptionAr:"           ",descriptionEn:"Share family trees with relatives and allow them to contribute information and photos",category:"social"},{icon:EI,titleAr:" ",titleEn:"Bilingual Support",descriptionAr:"          ",descriptionEn:"Complete interface in Arabic and English with right-to-left writing support",category:"language"},{icon:vH,titleAr:"  ",titleEn:"Mobile Friendly",descriptionAr:"          ",descriptionEn:"Works perfectly on smartphones and tablets with responsive design",category:"mobile"},{icon:g0,titleAr:" ",titleEn:"Security & Privacy",descriptionAr:"         ",descriptionEn:"High data protection with advanced encryption and customizable privacy settings",category:"security"}],r=[{id:"core",nameAr:" ",nameEn:"Core Features",color:"bg-blue-500"},{id:"search",nameAr:"",nameEn:"Search",color:"bg-purple-500"},{id:"social",nameAr:"",nameEn:"Collaboration",color:"bg-pink-500"},{id:"language",nameAr:"",nameEn:"Language",color:"bg-indigo-500"},{id:"mobile",nameAr:"",nameEn:"Mobile",color:"bg-teal-500"},{id:"security",nameAr:"",nameEn:"Security",color:"bg-red-500"}],s=i=>r.find(l=>l.id===i);return o.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-blue-50 dark:from-gray-900 dark:to-gray-800",children:[o.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-r from-green-600 to-blue-600 text-white",children:[o.jsx("div",{className:"absolute inset-0 bg-black/20"}),o.jsx("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-24",children:o.jsxs("div",{className:"text-center",children:[o.jsx("h1",{className:"text-4xl md:text-6xl font-bold mb-6",children:t?" ":"Nasabna Features"}),o.jsx("p",{className:"text-xl md:text-2xl mb-8 max-w-3xl mx-auto opacity-90",children:t?"             ":"Discover all the powerful features that make creating and managing your family tree an enjoyable and easy experience"}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[o.jsx(ye,{asChild:!0,size:"lg",className:"bg-primary text-primary-foreground hover:bg-primary/90",children:o.jsxs(_t,{to:"/register",children:[t?" ":"Start Free",o.jsx(Ki,{className:"ml-2 h-5 w-5"})]})}),o.jsx(ye,{asChild:!0,variant:"outline",size:"lg",className:"border-primary text-primary hover:bg-primary/10",children:o.jsx(_t,{to:"/pricing",children:t?" ":"View Plans"})})]})]})})]}),o.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16",children:[o.jsxs("div",{className:"text-center mb-16",children:[o.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-4",children:t?"    ":"Comprehensive Features to Preserve Your Family Heritage"}),o.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-300 max-w-3xl mx-auto",children:t?"                ":"We provide all the tools you need to create a detailed and beautiful family tree that preserves your family history for future generations"})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:n.map((i,l)=>{const a=i.icon,c=s(i.category);return o.jsxs(et,{className:"group hover:shadow-xl transition-all duration-300 hover:-translate-y-2 border-0 shadow-lg",children:[o.jsxs(ht,{className:"text-center pb-4",children:[o.jsxs("div",{className:"mx-auto mb-4 relative",children:[o.jsx("div",{className:`w-16 h-16 rounded-full ${c==null?void 0:c.color} flex items-center justify-center group-hover:scale-110 transition-transform duration-300`,children:o.jsx(a,{className:"h-8 w-8 text-white"})}),o.jsx(Gn,{variant:"secondary",className:"absolute -bottom-2 left-1/2 transform -translate-x-1/2 text-xs",children:t?c==null?void 0:c.nameAr:c==null?void 0:c.nameEn})]}),o.jsx(gt,{className:"text-xl font-bold text-gray-900 dark:text-white",children:t?i.titleAr:i.titleEn})]}),o.jsx(rt,{children:o.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-center leading-relaxed",children:t?i.descriptionAr:i.descriptionEn})})]},l)})})]}),o.jsx("div",{className:"bg-gradient-to-r from-green-600 to-blue-600 text-white",children:o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16",children:o.jsxs("div",{className:"text-center",children:[o.jsx("h2",{className:"text-3xl md:text-4xl font-bold mb-6",children:t?"  ":"Ready to Start Your Journey?"}),o.jsx("p",{className:"text-xl mb-8 max-w-2xl mx-auto opacity-90",children:t?"      Nasabna   ":"Join thousands of families using Nasabna to preserve their family heritage"}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[o.jsx(ye,{asChild:!0,size:"lg",className:"bg-primary text-primary-foreground hover:bg-primary/90",children:o.jsxs(_t,{to:"/register",children:[o.jsx(u3,{className:"mr-2 h-5 w-5"}),t?"  ":"Start Free Now"]})}),o.jsx(ye,{asChild:!0,variant:"outline",size:"lg",className:"border-primary text-primary hover:bg-primary/10",children:o.jsx(_t,{to:"/about",children:t?"  ":"Learn More About Us"})})]})]})})}),o.jsx("div",{className:"bg-white dark:bg-gray-900 py-16",children:o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-8 text-center",children:[o.jsxs("div",{children:[o.jsx("div",{className:"text-4xl font-bold text-green-600 mb-2",children:"7"}),o.jsx("div",{className:"text-gray-600 dark:text-gray-300",children:t?" ":"Powerful Features"})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-4xl font-bold text-blue-600 mb-2",children:"2"}),o.jsx("div",{className:"text-gray-600 dark:text-gray-300",children:t?" ":"Supported Languages"})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-4xl font-bold text-purple-600 mb-2",children:"100%"}),o.jsx("div",{className:"text-gray-600 dark:text-gray-300",children:t?"  ":"Mobile Compatible"})]}),o.jsxs("div",{children:[o.jsx("div",{className:"text-4xl font-bold text-orange-600 mb-2",children:"24/hr"}),o.jsx("div",{className:"text-gray-600 dark:text-gray-300",children:t?" ":"Technical Support"})]})]})})})]})},Z0e="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQACWAJYAAD/2wBDAAgGBgcGBQgHBwcJCQgKDBQNDAsLDBkSEw8UHRofHh0aHBwgJC4nICIsIxwcKDcpLDAxNDQ0Hyc5PTgyPC4zNDL/wgALCAGQAZABAREA/8QAHAABAAMAAwEBAAAAAAAAAAAAAAYHCAEEBQMC/9oACAEBAAAAAL/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAH5hcRS6afoAAAAAACE5miHDmX6ZmwAAAAAAQTI/TB3NcTsAAAAAA+OKo2Akm1fsAAAAAArHJwA1jZwAAAAADPlBgC/NBgAAAAAM7USAL20SAAAAAAp7MIA09cIAAAAADy8R9AB39ueoAAAAAAUtmrgHOlbpAAAAAAHFIZ4647Gh7v5AAAAAAB4FSRBL7b98AAAAAAAAAAAAAAAPz1nZ/QAAAAAAOI5UlcxXou9KrGtuR8gAAAAAeLnap/mA+lsaJ9oAAAAAcV1lrywAepqWxeQAAAAFYZW+AAD76ps8AAAACIY66gAA7exZeAAAAHyxvDQAATLZP0AAAAFSZbAAAaktsAAAA4x1BgAAE62JyAAAA8bDn4AAAfvcfsgAAAKyyaAAANZWaAAAApLNoAAA0ldoAAACGQcAAATiZgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAf//EAD4QAAEDAgIECggFBAMBAAAAAAECAwQFEQAGBxIhMQgYQVBRVWFxktEiMEBCgZGhsRMUIzLBIFJignKQ4RD/2gAIAQEAAT8A/wCm5a0NoK1rSlIFypRsBit6WMmUJa2pFZaeeTsLcYF0g9GzZ9cSeEblltRDFNqLw6bJT9ziNwjcsuKAfptRZHTZKvscUTSxkyurQ1HrLTLytzckFok/HZ9cIWhxAWhSVJIuFJNwebM+6SqNkaLaQr8zUFpu1EbPpHtV0DGbtJeY84PLE2YtmIT6MRhRS2B2/wB3xwTf/wCg2xlHSXmTJ7yBCmreiX9KI+oqbI7P7fhjIWkqj55i2jq/LVBCbuxHD6Q7U9I5q0naQmMi0PWb1XKnJBTGZPJ/mewfXFTqUyr1B6dPfW/JeUVLcWbkn+umVOZSagzOgSFsSWVBSHEGxBxox0hMZ6oes5qt1OMAmSyOX/Mdh+nNEuUzBhvSpCwhllBcWo8gAucZ5zXIzjmmXVXlH8JStRhs+42P2j+fU5FzW/k7NMSqsqP4aVaj6B77Z/cP5xElMzYbMqOsLZeQFoUNxBFxzPp1rqqPo9djtL1Xag6I+zfq71fQW+Pq9BVdVWNHrUZ1es9T3VRzffq70/Q2+HM/CUlq/MUGHf0Ql10jtuB6vg1y1fmK9Dv6JS06B23I5n4SjChVaE/Y6pYcRftuD6vg1sKNUrz9vRDLaL9tyeZ+ERR1TcmRKk2m6oMka5HIlYt97er4O9HVCyZLqTibKnSTqE8qUC33vzPmGjM5hoE6kyB+nKZU2T0HkPwNsVilyqJVpVMmIKJEZwtrB7OX1NHpcqt1aLTIaCuRJcDaAO3lxl6jM5eoEGkxx+nFZS3fpI3n4m/NGm/RuutxTmWkslU6Oi0lpI2utjlA5SPthQ1TY7/60jWNhvxoQ0brokUZlqzJTOkItGaUNrTZ5SOQn7c0kAi1hjSboSTVHXq1lhtDctV1PQtyXD0o6D2YmwJdNluRZsd2O+2bKbdSUqB7v6YUCXUpbcWFHdkPuGyW20lRPwxoy0JJpbrNazO2hyWmymYW9LZ6V9J7MAAC1hzXmPJdAzWx+HV6c0+q1kugarie5Q24rfBwZUpTlDramwdzUtGsB/snyxJ4Puc2l2ZNPfHSl+33GI3B9zm6uzxp7A6VP3+wxRODgylSXK5W1OAb2oiNUH/ZXljLmS6BlRj8OkU5phVrKdI1nFd6jt5vti3N98KWhAutQSO02wuqU9s2XOjJPa6kfzhFUp7hsidGUex1J/nCVoWLoUFDsN8X5qJtjMefMt5UbJq1TZbdtcMIOu4f9RtxX+EdtU3QKPs3B6Wr66o88VbTBnerKUF1lcZB9yKkNj5jb9cSq5VpyiqVU5jxO/8AEeUf5wXFKN1KJPacBxSTdKiD2HEWuVaCoKi1OYyRu/DeUP5xSdMOd6SUhFZXJQPclJDg+Z2/XFA4R21Ldfo+zcXoivrqnzxlzPmW81tg0mpsuO2uWFnUcH+p24BvzNmXNVHypTjNq8xDCPdRvWs9CRvOM66dq1XFORKHrUyCdmuk/rLHafd+Hzw8+7IdU686txxRupa1Ek95PqWX3Y7qXWXVtuJN0rQogjuIxkrTtWqGpuJXNapwRs11H9ZA7D73x+eMtZqo+a6cJtImIfR7yNy0HoUN45jJtjSRpWp2SY6okbUl1hafQYv6LXavo7sV7MVUzLU3KhVZbkh9Z947EjoSOQetoOYqplqpt1ClS3I76D7p2KHQocoxo30rU7O0dMSTqRKwhPpsX9F3tR092Ab8w6WNKLWToRptOUlytPp2DeGEn3j29AxMmSJ0t2TKeW8+6oqW4s3KifXw5kiDLakxXlsvtKCkOINikjGifSi1nGEKbUVJbrTCdo3B9I94dvSOYNImeIuRstOTV6q5jt24rJP719PcN5xU6lLq9SfqE55T0l9ZW4tXKT7DTKlLpFSYqEF5TMlhYW2tPIRjR3niLnnLTc1GqiY1ZuUyD+xfT3HePbn324zK3nlhDTaSpajuAG840l50dzrmt+WFEQWSWoiOhAO/vO/2PRpnR3JWa2JZUTBeIalo6UE7+8b8MPtyWW3mVBbbiQpCgdhB2g+26es2mi5URR4zmrLqZKVWO1LQ/d89g+fsugXNprWVF0eS5rS6YQlNztU0f2/LaPl7YcaW8xnMekKoOpXrR4qvyrPRZOwn4m/suiTMhy5pCp7ql6seUr8q9t2WVsB+Btge15sqwoeU6rUybGPGWtP/ACtYfW2HVqddW4s3UslRPST7K0tTTqHEGykEKSegjGU6sK5lOlVMG5kRkLV/ytt+t/a9PFRMLRnIZSbKlvts94vrH7YPsoxoHqBm6M47KjdUV9xnuF9Yff2vhIyCjLVHj32OSlK+Sf8A32YY4N0gry1WI99jctKrd6f/AD2vP2juFpAYhNTZsiMmKpSk/ggHWJAG2/dji20HruoeBHlji20HruoeBHlji20HruoeBHlji20HruoeBHlji20HruoeBHlji20HruoeBHlji20HruoeBHlji20HruoeBHlji20HruoeBHlji20HruoeBHlji20HruoeBHlji20HruoeBHlji20HruoeBHlji20HruoeBHlji20HruoeBHlji20HruoeBHlji20HruoeBHlji20HruoeBHlji20HruoeBHlji20HruoeBHlji20HruoeBHlji20HruoeBHljIOjuFo/jzWYU2RJTLUlSi8ANWwI2W7/+mb//2Q==",Q0e=()=>{const{language:e}=Ft(),t=e==="ar",n=[{icon:br,titleAr:" ",titleEn:"Love & Respect",descriptionAr:"       ",descriptionEn:"We believe in the importance of family bonds and mutual respect between generations"},{icon:g0,titleAr:" ",titleEn:"Security & Privacy",descriptionAr:"      ",descriptionEn:"We protect your family data with the highest security and privacy standards"},{icon:fH,titleAr:" ",titleEn:"Innovation & Development",descriptionAr:"      ",descriptionEn:"We continuously develop new technologies to improve user experience"},{icon:kn,titleAr:" ",titleEn:"Trust & Transparency",descriptionAr:"         ",descriptionEn:"We build long-term relationships with our customers based on trust and transparency"}],r=[{name:" ",nameEn:"Ahmed Mohammed",role:"  ",roleEn:"Founder & CEO",bio:"        ",bioEn:"Web technology expert with a passion for preserving family heritage"},{name:" ",nameEn:"Fatima Ali",role:" ",roleEn:"Development Manager",bio:"      ",bioEn:"Developer specialized in user interfaces and interactive experience"},{name:" ",nameEn:"Mohammed Khalid",role:" ",roleEn:"Marketing Manager",bio:"      ",bioEn:"Expert in digital marketing and reaching Arabic audiences"}],s=[{year:"2024",titleAr:" ",titleEn:"Nasabna Launch",descriptionAr:"        ",descriptionEn:"Launch of the first Arabic platform specialized in interactive family trees"},{year:"2024",titleAr:" ",titleEn:"Bilingual Support",descriptionAr:"     ",descriptionEn:"Added full support for Arabic and English languages"},{year:"2024",titleAr:" ",titleEn:"Responsive Application",descriptionAr:"      ",descriptionEn:"Developed responsive application that works on all devices"}];return o.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-blue-50 dark:from-gray-900 dark:to-gray-800",children:[o.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-r from-green-600 to-blue-600 text-white",children:[o.jsx("div",{className:"absolute inset-0 bg-black/20"}),o.jsx("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-24",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"flex justify-center mb-6",children:o.jsx("div",{className:"w-20 h-20 bg-white/20 rounded-full flex items-center justify-center",children:o.jsx(qn,{className:"h-12 w-12 text-white"})})}),o.jsx("h1",{className:"text-4xl md:text-6xl font-bold mb-6",children:t?" ":"About Us"}),o.jsx("p",{className:"text-xl md:text-2xl mb-8 max-w-3xl mx-auto opacity-90",children:t?"              ":"We are a team specialized in developing technologies that help families preserve their heritage and history for future generations"}),o.jsx(ye,{asChild:!0,size:"lg",className:"bg-white text-green-600 hover:bg-gray-100",children:o.jsxs(_t,{to:"/contact",children:[o.jsx(Ra,{className:"mr-2 h-5 w-5"}),t?" ":"Contact Us"]})})]})})]}),o.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16",children:[o.jsxs("div",{className:"text-center mb-12",children:[o.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-4",children:t?" Nasabna":"Discover Nasabna"}),o.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-300 max-w-2xl mx-auto",children:t?"    Nasabna      ":"See how Nasabna can help you preserve your family heritage"})]}),o.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl overflow-hidden max-w-4xl mx-auto",children:o.jsxs("div",{className:"aspect-w-16 aspect-h-9 relative",children:[o.jsx("div",{className:"w-full h-full",children:o.jsxs("video",{controls:!0,className:"w-full h-full object-cover",poster:RI,children:[o.jsx("source",{src:"/videos/intro.mp4",type:"video/mp4"}),t?"    .":"Your browser does not support the video tag."]})}),o.jsx("div",{className:"absolute bottom-4 left-0 right-0 text-center text-white bg-black/50 py-2 mx-4 rounded-lg",children:o.jsx("p",{className:"font-semibold",children:t?"   Nasabna":"Nasabna Introduction Video"})})]})}),o.jsx("div",{className:"text-center mt-8",children:o.jsx(ye,{asChild:!0,size:"lg",children:o.jsxs(_t,{to:"/features",children:[t?"  ":"Discover All Features",o.jsx(Ki,{className:`mr-2 h-5 w-5 ${t?"rotate-180":""}`})]})})})]}),o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16",children:o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12",children:[o.jsxs(et,{className:"border-0 shadow-xl",children:[o.jsxs(ht,{className:"text-center pb-6",children:[o.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-green-500 to-blue-500 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx(wH,{className:"h-8 w-8 text-white"})}),o.jsx(gt,{className:"text-2xl font-bold text-gray-900 dark:text-white",children:t?"":"Our Mission"})]}),o.jsx(rt,{children:o.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-center leading-relaxed text-lg",children:t?"                          .":"Helping Arabic families preserve their heritage and history through an easy-to-use and secure technology platform that enables them to create beautiful and comprehensive interactive family trees that transfer knowledge and memories across generations."})})]}),o.jsxs(et,{className:"border-0 shadow-xl",children:[o.jsxs(ht,{className:"text-center pb-6",children:[o.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx(bH,{className:"h-8 w-8 text-white"})}),o.jsx(gt,{className:"text-2xl font-bold text-gray-900 dark:text-white",children:t?"":"Our Vision"})]}),o.jsx(rt,{children:o.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-center leading-relaxed text-lg",children:t?"                     .":"To become the leading platform in the Arab world for preserving family heritage, and contribute to strengthening family bonds and reviving values of authenticity and belonging in Arab communities."})})]})]})}),o.jsx("div",{className:"bg-white dark:bg-gray-900 py-16",children:o.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[o.jsxs("div",{className:"text-center mb-12",children:[o.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-4",children:t?"":"Our Values"}),o.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-300 max-w-2xl mx-auto",children:t?"        ":"The values we believe in and that guide our work in serving our customers"})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:n.map((i,l)=>{const a=i.icon;return o.jsxs(et,{className:"text-center border-0 shadow-lg hover:shadow-xl transition-shadow duration-300",children:[o.jsxs(ht,{children:[o.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-green-500 to-blue-500 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx(a,{className:"h-8 w-8 text-white"})}),o.jsx(gt,{className:"text-xl font-bold text-gray-900 dark:text-white",children:t?i.titleAr:i.titleEn})]}),o.jsx(rt,{children:o.jsx("p",{className:"text-gray-600 dark:text-gray-300 leading-relaxed",children:t?i.descriptionAr:i.descriptionEn})})]},l)})})]})}),o.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16",children:[o.jsxs("div",{className:"text-center mb-12",children:[o.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-4",children:t?" ":"Our Team"}),o.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-300 max-w-2xl mx-auto",children:t?"      ":"A specialized and passionate team dedicated to providing the best services to our customers"})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:r.map((i,l)=>o.jsxs(et,{className:"text-center border-0 shadow-lg hover:shadow-xl transition-all duration-300 hover:-translate-y-2",children:[o.jsxs(ht,{children:[o.jsx("div",{className:"w-32 h-32 mx-auto mb-4 rounded-full overflow-hidden bg-gray-200",children:o.jsx("img",{src:Z0e,alt:t?i.name:i.nameEn,className:"w-full h-full object-cover"})}),o.jsx(gt,{className:"text-xl font-bold text-gray-900 dark:text-white",children:t?i.name:i.nameEn}),o.jsx(Gn,{variant:"secondary",className:"mx-auto",children:t?i.role:i.roleEn})]}),o.jsx(rt,{children:o.jsx("p",{className:"text-gray-600 dark:text-gray-300 leading-relaxed",children:t?i.bio:i.bioEn})})]},l))})]}),o.jsx("div",{className:"bg-white dark:bg-gray-900 py-16",children:o.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[o.jsxs("div",{className:"text-center mb-12",children:[o.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-4",children:t?"":"Our Journey"}),o.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-300 max-w-2xl mx-auto",children:t?"    ":"Important milestones in developing Nasabna"})]}),o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 w-1 h-full bg-gradient-to-b from-green-500 to-blue-500"}),o.jsx("div",{className:"space-y-12",children:s.map((i,l)=>o.jsxs("div",{className:`flex items-center ${l%2===0?"flex-row":"flex-row-reverse"}`,children:[o.jsx("div",{className:`w-1/2 ${l%2===0?"pr-8 text-right":"pl-8 text-left"}`,children:o.jsxs(et,{className:"border-0 shadow-lg",children:[o.jsx(ht,{children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx(Gn,{variant:"default",className:"bg-gradient-to-r from-green-500 to-blue-500",children:i.year}),o.jsx(gt,{className:"text-lg font-bold text-gray-900 dark:text-white",children:t?i.titleAr:i.titleEn})]})}),o.jsx(rt,{children:o.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:t?i.descriptionAr:i.descriptionEn})})]})}),o.jsx("div",{className:"relative z-10",children:o.jsx("div",{className:"w-4 h-4 bg-gradient-to-r from-green-500 to-blue-500 rounded-full border-4 border-white dark:border-gray-900"})}),o.jsx("div",{className:"w-1/2"})]},l))})]})]})}),o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16",children:o.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-8 text-center",children:[o.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-lg",children:[o.jsx("div",{className:"text-4xl font-bold text-green-600 mb-2",children:"1000+"}),o.jsx("div",{className:"text-gray-600 dark:text-gray-300",children:t?" ":"Registered Families"})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-lg",children:[o.jsx("div",{className:"text-4xl font-bold text-blue-600 mb-2",children:"5000+"}),o.jsx("div",{className:"text-gray-600 dark:text-gray-300",children:t?" ":"People Added"})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-lg",children:[o.jsx("div",{className:"text-4xl font-bold text-purple-600 mb-2",children:"2"}),o.jsx("div",{className:"text-gray-600 dark:text-gray-300",children:t?" ":"Supported Languages"})]}),o.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-lg",children:[o.jsx("div",{className:"text-4xl font-bold text-orange-600 mb-2",children:"24/7"}),o.jsx("div",{className:"text-gray-600 dark:text-gray-300",children:t?" ":"Technical Support"})]})]})}),o.jsx("div",{className:"bg-gradient-to-r from-green-600 to-blue-600 text-white",children:o.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16",children:o.jsxs("div",{className:"text-center",children:[o.jsx("h2",{className:"text-3xl md:text-4xl font-bold mb-6",children:t?"   Nasabna":"Join the Nasabna Family"}),o.jsx("p",{className:"text-xl mb-8 max-w-2xl mx-auto opacity-90",children:t?"      ":"Start your journey in preserving your family heritage today"}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[o.jsx(ye,{asChild:!0,size:"lg",className:"bg-white text-green-600 hover:bg-gray-100",children:o.jsxs(_t,{to:"/register",children:[o.jsx(u3,{className:"mr-2 h-5 w-5"}),t?" ":"Start Free"]})}),o.jsx(ye,{asChild:!0,variant:"outline",size:"lg",className:"border-white text-white hover:bg-white hover:text-green-600",children:o.jsxs(_t,{to:"/features",children:[t?" ":"Discover Features",o.jsx(Ki,{className:"ml-2 h-5 w-5"})]})})]})]})})})]})},e1e="/assets/contacts-BSvnWvjy.png",t1e=()=>{const{language:e}=Ft(),t=e==="ar",[n,r]=J.useState({name:"",email:"",subject:"",message:""}),[s,i]=J.useState(!1),[l,a]=J.useState(!1),[c,d]=J.useState(""),u=h=>{const{name:g,value:y}=h.target;r(p=>({...p,[g]:y}))},f=async h=>{h.preventDefault(),i(!0),d("");try{await new Promise(g=>setTimeout(g,1500)),r({name:"",email:"",subject:"",message:""}),a(!0),setTimeout(()=>a(!1),5e3)}catch{d(t?"    .    .":"An error occurred while sending the message. Please try again.")}finally{i(!1)}},m=[{icon:ei,title:t?"":"Our Address",titleAr:"",content:t?"123      ":"123 Family Street, Riyadh, Saudi Arabia",contentAr:"123      "},{icon:Gu,title:t?" ":"Call Us",titleAr:" ",content:"+966 11 123 4567",contentAr:"+966 11 123 4567"},{icon:Ra,title:t?" ":"Email Us",titleAr:" ",content:"support@nasabna.com",contentAr:"support@nasabna.com"},{icon:h0,title:t?" ":"Working Hours",titleAr:" ",content:t?" - : 8  - 5 ":"Sunday - Thursday: 8AM - 5PM",contentAr:" - : 8  - 5 "}];return o.jsxs("div",{className:"min-h-screen bg-background",children:[o.jsx("section",{className:"relative py-20 md:py-32 bg-gradient-to-br from-primary/10 via-primary/5 to-background overflow-hidden",children:o.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 relative z-10",children:o.jsxs("div",{className:"text-center max-w-4xl mx-auto",children:[o.jsx("h1",{className:"text-4xl sm:text-5xl lg:text-6xl font-bold text-foreground mb-6",children:t?" ":"Contact Us"}),o.jsx("p",{className:"text-xl text-muted-foreground mb-8 max-w-2xl mx-auto",children:t?"         Nasabna  .":"Have questions or need assistance? The Nasabna support team is here to help."})]})})}),o.jsx("section",{className:"py-16",children:o.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-3xl font-bold text-foreground mb-6",children:t?"  ":"Get In Touch"}),o.jsx("p",{className:"text-lg text-muted-foreground mb-8",children:t?"   .         .":"We appreciate your feedback and inquiries. Feel free to reach out to us through any of the following methods."}),o.jsx("div",{className:"space-y-6",children:m.map((h,g)=>o.jsxs("div",{className:"flex items-start",children:[o.jsx("div",{className:"flex-shrink-0 w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center mr-4",children:o.jsx(h.icon,{className:"h-6 w-6 text-primary"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold text-foreground mb-1",children:t?h.titleAr:h.title}),o.jsx("p",{className:"text-muted-foreground",children:t?h.contentAr:h.content})]})]},g))}),o.jsx("div",{className:"mt-12",children:o.jsx("img",{src:e1e,alt:t?" ":"Contact Us",className:"rounded-lg shadow-lg w-full max-w-md mx-auto"})})]}),o.jsx("div",{children:o.jsxs(et,{children:[o.jsxs(ht,{children:[o.jsx(gt,{className:"text-2xl",children:t?"  ":"Send Us a Message"}),o.jsx(qr,{children:t?"         .":"Fill out the form below and we'll get back to you as soon as possible."})]}),o.jsx(rt,{children:l?o.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6 text-center",children:[o.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:o.jsx(k_,{className:"h-6 w-6 text-green-600"})}),o.jsx("h3",{className:"text-lg font-semibold text-green-800 mb-2",children:t?"   !":"Message Sent Successfully!"}),o.jsx("p",{className:"text-green-700",children:t?"  .    .":"Thank you for contacting us. We'll get back to you soon."})]}):o.jsxs("form",{onSubmit:f,className:"space-y-6",children:[c&&o.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:o.jsx("p",{className:"text-red-700 text-center",children:c})}),o.jsxs("div",{children:[o.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium text-foreground mb-2",children:[t?" ":"Full Name"," *"]}),o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx(Xt,{className:"h-5 w-5 text-muted-foreground"})}),o.jsx(Bt,{id:"name",name:"name",value:n.name,onChange:u,placeholder:t?"  ":"Enter your full name",className:"pl-10",required:!0,disabled:s})]})]}),o.jsxs("div",{children:[o.jsxs("label",{htmlFor:"email",className:"block text-sm font-medium text-foreground mb-2",children:[t?" ":"Email Address"," *"]}),o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:o.jsx(Ra,{className:"h-5 w-5 text-muted-foreground"})}),o.jsx(Bt,{id:"email",name:"email",type:"email",value:n.email,onChange:u,placeholder:t?"  ":"Enter your email address",className:"pl-10",required:!0,disabled:s})]})]}),o.jsxs("div",{children:[o.jsxs("label",{htmlFor:"subject",className:"block text-sm font-medium text-foreground mb-2",children:[t?"":"Subject"," *"]}),o.jsx(Bt,{id:"subject",name:"subject",value:n.subject,onChange:u,placeholder:t?"  ":"Enter your message subject",required:!0,disabled:s})]}),o.jsxs("div",{children:[o.jsxs("label",{htmlFor:"message",className:"block text-sm font-medium text-foreground mb-2",children:[t?"":"Message"," *"]}),o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:"absolute top-3 left-3",children:o.jsx(pH,{className:"h-5 w-5 text-muted-foreground"})}),o.jsx(kd,{id:"message",name:"message",value:n.message,onChange:u,placeholder:t?"  ...":"Write your message here...",rows:5,className:"pl-10",required:!0,disabled:s})]})]}),o.jsx(ye,{type:"submit",className:"w-full flex items-center justify-center",disabled:s,children:s?o.jsxs(o.Fragment,{children:[o.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),t?" ...":"Sending..."]}):o.jsxs(o.Fragment,{children:[o.jsx(k_,{className:`h-4 w-4 ${t?"ml-2":"mr-2"}`}),t?" ":"Send Message"]})})]})})]})})]})})}),o.jsx("section",{className:"py-16 bg-muted/30",children:o.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[o.jsxs("div",{className:"text-center mb-12",children:[o.jsx("h2",{className:"text-3xl font-bold text-foreground mb-4",children:t?" ":"Frequently Asked Questions"}),o.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto",children:t?"      .":"Here are some frequently asked questions that might help you."})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 max-w-4xl mx-auto",children:[o.jsxs(et,{children:[o.jsx(ht,{children:o.jsx(gt,{className:"text-lg",children:t?"      ":"How long does it take to reply to my message?"})}),o.jsx(rt,{children:o.jsx("p",{className:"text-muted-foreground",children:t?"       24  .":"We typically respond to all messages within 24 business hours."})})]}),o.jsxs(et,{children:[o.jsx(ht,{children:o.jsx(gt,{className:"text-lg",children:t?"      ":"Can I get support in Arabic?"})}),o.jsx(rt,{children:o.jsx("p",{className:"text-muted-foreground",children:t?"       .":"Yes, our support team is fluent in both Arabic and English."})})]}),o.jsxs(et,{children:[o.jsx(ht,{children:o.jsx(gt,{className:"text-lg",children:t?"   ":"Do you offer technical support?"})}),o.jsx(rt,{children:o.jsx("p",{className:"text-muted-foreground",children:t?"         .":"Yes, we have a dedicated technical support team to help with technical issues."})})]}),o.jsxs(et,{children:[o.jsx(ht,{children:o.jsx(gt,{className:"text-lg",children:t?"      ":"How can I report a website issue?"})}),o.jsx(rt,{children:o.jsx("p",{className:"text-muted-foreground",children:t?"           .":"You can send details of the issue through this contact form, and we'll investigate it immediately."})})]})]})]})})]})},n1e=()=>{const{language:e}=Ft(),t=e==="ar",n={title:t?" ":"Privacy Policy",lastUpdated:t?" : 1  2024":"Last updated: January 1, 2024",introduction:{title:t?"":"Introduction",content:t?" Nasabna      .":"At Nasabna, we are committed to protecting your privacy and personal information."},informationCollection:{title:t?"  ":"Information We Collect",personalInfo:{title:t?" ":"Personal Information",content:t?"        (  )    ":"Full name and email address, Contact information (address, phone number), Account information and user identifiers"},familyTreeInfo:{title:t?"  ":"Family Tree Information",content:t?"           ":"Names and dates of family members, Uploaded photos and documents, Family relationships and lineage"},technicalInfo:{title:t?" ":"Technical Information",content:t?" IP           ":"IP address and browser type, Usage data and activity logs, Cookies and device identifiers"}},informationUse:{title:t?"  ":"How We Use Your Information",content:t?"                   ":"Provide and improve our services, Create and manage your account, Process payments and subscriptions, Send updates and important notifications, Ensure security and prevent fraud, Comply with legal requirements"},informationSharing:{title:t?" ":"Information Sharing",intro:t?"           .      :":"We do not sell, rent, or trade your personal information to third parties. We may share your information in the following cases:",points:t?[" ","   ","  ","   "]:["With your explicit consent","With trusted service providers","To comply with laws and regulations","To protect our rights and user safety"]},dataSecurity:{title:t?" ":"Data Security",content:t?"       :":"We use advanced security measures to protect your personal information:",measures:t?[" SSL/TLS  ","    ","    24 ","    ","  "]:["SSL/TLS encryption for data transmission","Advanced server and infrastructure protection","24/7 security monitoring","Regular secure backups","Strict access controls"]},yourRights:{title:t?"":"Your Rights",content:t?"      :":"You have the following rights regarding your personal information:",rights:t?["   ","   ","  ","  ","  ","  "]:["Access your personal information","Correct or update information","Delete your account and information","Restrict data processing","Data portability","Object to processing"]},contact:{title:t?" ":"Contact Us",content:t?"           :":"If you have any questions about this Privacy Policy, please contact us:",email:"privacy@nasabna.com",address:t?"123     ":"123 Nasabna St, Cultural District, Egypt",phone:"+20 123 456 7890"}};return o.jsxs("div",{className:"min-h-screen bg-background",children:[o.jsx("section",{className:"relative py-20 md:py-32 bg-gradient-to-br from-primary/10 via-primary/5 to-background overflow-hidden",children:o.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 relative z-10",children:o.jsxs("div",{className:"text-center max-w-4xl mx-auto",children:[o.jsx("h1",{className:"text-4xl sm:text-5xl lg:text-6xl font-bold text-foreground mb-6",children:n.title}),o.jsx("p",{className:"text-xl text-muted-foreground",children:n.lastUpdated})]})})}),o.jsx("section",{className:"py-16",children:o.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:o.jsxs("div",{className:"max-w-4xl mx-auto",children:[o.jsxs(et,{children:[o.jsx(ht,{children:o.jsx(gt,{className:"text-2xl",children:n.introduction.title})}),o.jsx(rt,{children:o.jsx("p",{className:"text-muted-foreground",children:n.introduction.content})})]}),o.jsxs("div",{className:"mt-8 space-y-8",children:[o.jsxs(et,{children:[o.jsx(ht,{children:o.jsx(gt,{children:n.informationCollection.title})}),o.jsx(rt,{children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold mb-2",children:n.informationCollection.personalInfo.title}),o.jsx("p",{className:"text-muted-foreground",children:n.informationCollection.personalInfo.content})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold mb-2",children:n.informationCollection.familyTreeInfo.title}),o.jsx("p",{className:"text-muted-foreground",children:n.informationCollection.familyTreeInfo.content})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold mb-2",children:n.informationCollection.technicalInfo.title}),o.jsx("p",{className:"text-muted-foreground",children:n.informationCollection.technicalInfo.content})]})]})})]}),o.jsxs(et,{children:[o.jsx(ht,{children:o.jsx(gt,{children:n.informationUse.title})}),o.jsx(rt,{children:o.jsx("p",{className:"text-muted-foreground",children:n.informationUse.content})})]}),o.jsxs(et,{children:[o.jsx(ht,{children:o.jsx(gt,{children:n.informationSharing.title})}),o.jsxs(rt,{children:[o.jsx("p",{className:"text-muted-foreground mb-4",children:n.informationSharing.intro}),o.jsx("ul",{className:"list-disc list-inside space-y-2 text-muted-foreground",children:n.informationSharing.points.map((r,s)=>o.jsx("li",{children:r},s))})]})]}),o.jsxs(et,{children:[o.jsx(ht,{children:o.jsx(gt,{children:n.dataSecurity.title})}),o.jsxs(rt,{children:[o.jsx("p",{className:"text-muted-foreground mb-4",children:n.dataSecurity.content}),o.jsx("ul",{className:"list-disc list-inside space-y-2 text-muted-foreground",children:n.dataSecurity.measures.map((r,s)=>o.jsx("li",{children:r},s))})]})]}),o.jsxs(et,{children:[o.jsx(ht,{children:o.jsx(gt,{children:n.yourRights.title})}),o.jsxs(rt,{children:[o.jsx("p",{className:"text-muted-foreground mb-4",children:n.yourRights.content}),o.jsx("ul",{className:"list-disc list-inside space-y-2 text-muted-foreground",children:n.yourRights.rights.map((r,s)=>o.jsx("li",{children:r},s))})]})]}),o.jsxs(et,{children:[o.jsx(ht,{children:o.jsx(gt,{children:n.contact.title})}),o.jsxs(rt,{children:[o.jsx("p",{className:"text-muted-foreground mb-4",children:n.contact.content}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("p",{children:[o.jsx("span",{className:"font-semibold",children:t?" :":"Email:"})," ",n.contact.email]}),o.jsxs("p",{children:[o.jsx("span",{className:"font-semibold",children:t?":":"Address:"})," ",n.contact.address]}),o.jsxs("p",{children:[o.jsx("span",{className:"font-semibold",children:t?":":"Phone:"})," ",n.contact.phone]})]})]})]})]})]})})})]})},r1e=()=>{const{language:e}=Ft(),t=e==="ar",n={title:t?" ":"Terms of Service",lastUpdated:t?" : 1  2024":"Last updated: January 1, 2024",welcome:{title:t?"   Nasabna":"Welcome to Nasabna",content:t?"       .":"These terms govern your use of our family tree platform."},acceptance:{title:t?" ":"Acceptance of Terms",content:t?"  Nasabna       .            .":"By using the Nasabna platform, you agree to be bound by these Terms and Conditions. If you do not agree to any of these terms, please do not use our services.",requirements:t?["     13   ","    ","      "]:["You must be 13 years or older to use the service","You must provide accurate and current information","You are responsible for maintaining account confidentiality"]},serviceDescription:{title:t?" ":"Description of Services",content:t?"Nasabna           .  :":"Nasabna is a digital platform for creating and managing family trees and preserving family heritage. Our services include:",services:t?["    ","   ","  ","  ","   "]:["Interactive family tree creation tools","Digital photo and document storage","Collaboration and sharing tools","Search and discovery features","Data export and report generation"]},userAccounts:{title:t?" ":"User Accounts",creation:{title:t?" ":"Account Creation",content:t?"                   ":"You must provide accurate and current information, You are responsible for all activities under your account, You must notify us immediately of any unauthorized use"},security:{title:t?" ":"Account Security",content:t?"              ":"Choose a strong and unique password, Do not share login credentials, Enable two-factor authentication when available"}},userContent:{title:t?" ":"User Content",content:t?"               .":"You retain ownership of content you create or upload to the platform, but you grant us a license to use it to provide the service.",guidelines:t?["       ","      ","  ","     "]:["Ensure you have the right to upload content","Do not upload offensive or illegal content","Respect others' privacy","We reserve the right to remove violating content"]},prohibitedUses:{title:t?" ":"Prohibited Uses",content:t?"      :":"You may not use our platform for the following purposes:",prohibitions:t?["     ","    ","    ","    ","   "]:["Violating any local or international laws","Harassment, bullying, or threatening","Publishing false or misleading content","Attempting to hack or disrupt the system","Violating intellectual property rights"]},termination:{title:t?"":"Termination",content:t?"        .          .":"Either party may terminate this agreement at any time. We reserve the right to suspend or terminate your account for violations of these terms.",details:t?["     ","        ","    "]:["You may delete your account at any time","We will provide notice before account termination when possible","You may export your data before deletion"]},limitationOfLiability:{title:t?" ":"Limitation of Liability",content:t?'  " "       .        .':'We provide our services "as is" and make no express or implied warranties. Our liability is limited to the maximum extent permitted by law.',details:t?["    ","    ","    "]:["We do not guarantee continuous service availability","We are not responsible for data loss","We recommend regular backups"]},changes:{title:t?"  ":"Changes to Terms",content:t?"        .            .":"We reserve the right to modify these terms at any time. We will notify you of any material changes via email or through the platform."},contact:{title:t?" ":"Contact Information",content:t?"          :":"If you have any questions about these Terms of Service, please contact us:",email:"legal@nasabna.com",address:t?"123     ":"123 Nasabna St, Cultural District, Egypt",phone:"+20 123 456 7890"}};return o.jsxs("div",{className:"min-h-screen bg-background",children:[o.jsx("section",{className:"relative py-20 md:py-32 bg-gradient-to-br from-primary/10 via-primary/5 to-background overflow-hidden",children:o.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 relative z-10",children:o.jsxs("div",{className:"text-center max-w-4xl mx-auto",children:[o.jsx("h1",{className:"text-4xl sm:text-5xl lg:text-6xl font-bold text-foreground mb-6",children:n.title}),o.jsx("p",{className:"text-xl text-muted-foreground",children:n.lastUpdated})]})})}),o.jsx("section",{className:"py-16",children:o.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:o.jsxs("div",{className:"max-w-4xl mx-auto",children:[o.jsxs(et,{children:[o.jsx(ht,{children:o.jsx(gt,{className:"text-2xl",children:n.welcome.title})}),o.jsx(rt,{children:o.jsx("p",{className:"text-muted-foreground",children:n.welcome.content})})]}),o.jsxs("div",{className:"mt-8 space-y-8",children:[o.jsxs(et,{children:[o.jsx(ht,{children:o.jsx(gt,{children:n.acceptance.title})}),o.jsxs(rt,{children:[o.jsx("p",{className:"text-muted-foreground mb-4",children:n.acceptance.content}),o.jsx("ul",{className:"list-disc list-inside space-y-2 text-muted-foreground",children:n.acceptance.requirements.map((r,s)=>o.jsx("li",{children:r},s))})]})]}),o.jsxs(et,{children:[o.jsx(ht,{children:o.jsx(gt,{children:n.serviceDescription.title})}),o.jsxs(rt,{children:[o.jsx("p",{className:"text-muted-foreground mb-4",children:n.serviceDescription.content}),o.jsx("ul",{className:"list-disc list-inside space-y-2 text-muted-foreground",children:n.serviceDescription.services.map((r,s)=>o.jsx("li",{children:r},s))})]})]}),o.jsxs(et,{children:[o.jsx(ht,{children:o.jsx(gt,{children:n.userAccounts.title})}),o.jsx(rt,{children:o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold mb-2",children:n.userAccounts.creation.title}),o.jsx("p",{className:"text-muted-foreground",children:n.userAccounts.creation.content})]}),o.jsxs("div",{children:[o.jsx("h3",{className:"text-lg font-semibold mb-2",children:n.userAccounts.security.title}),o.jsx("p",{className:"text-muted-foreground",children:n.userAccounts.security.content})]})]})})]}),o.jsxs(et,{children:[o.jsx(ht,{children:o.jsx(gt,{children:n.userContent.title})}),o.jsxs(rt,{children:[o.jsx("p",{className:"text-muted-foreground mb-4",children:n.userContent.content}),o.jsx("ul",{className:"list-disc list-inside space-y-2 text-muted-foreground",children:n.userContent.guidelines.map((r,s)=>o.jsx("li",{children:r},s))})]})]}),o.jsxs(et,{children:[o.jsx(ht,{children:o.jsx(gt,{children:n.prohibitedUses.title})}),o.jsxs(rt,{children:[o.jsx("p",{className:"text-muted-foreground mb-4",children:n.prohibitedUses.content}),o.jsx("ul",{className:"list-disc list-inside space-y-2 text-muted-foreground",children:n.prohibitedUses.prohibitions.map((r,s)=>o.jsx("li",{children:r},s))})]})]}),o.jsxs(et,{children:[o.jsx(ht,{children:o.jsx(gt,{children:n.termination.title})}),o.jsxs(rt,{children:[o.jsx("p",{className:"text-muted-foreground mb-4",children:n.termination.content}),o.jsx("ul",{className:"list-disc list-inside space-y-2 text-muted-foreground",children:n.termination.details.map((r,s)=>o.jsx("li",{children:r},s))})]})]}),o.jsxs(et,{children:[o.jsx(ht,{children:o.jsx(gt,{children:n.limitationOfLiability.title})}),o.jsxs(rt,{children:[o.jsx("p",{className:"text-muted-foreground mb-4",children:n.limitationOfLiability.content}),o.jsx("ul",{className:"list-disc list-inside space-y-2 text-muted-foreground",children:n.limitationOfLiability.details.map((r,s)=>o.jsx("li",{children:r},s))})]})]}),o.jsxs(et,{children:[o.jsx(ht,{children:o.jsx(gt,{children:n.changes.title})}),o.jsx(rt,{children:o.jsx("p",{className:"text-muted-foreground",children:n.changes.content})})]}),o.jsxs(et,{children:[o.jsx(ht,{children:o.jsx(gt,{children:n.contact.title})}),o.jsxs(rt,{children:[o.jsx("p",{className:"text-muted-foreground mb-4",children:n.contact.content}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("p",{children:[o.jsx("span",{className:"font-semibold",children:t?" :":"Email:"})," ",n.contact.email]}),o.jsxs("p",{children:[o.jsx("span",{className:"font-semibold",children:t?":":"Address:"})," ",n.contact.address]}),o.jsxs("p",{children:[o.jsx("span",{className:"font-semibold",children:t?":":"Phone:"})," ",n.contact.phone]})]})]})]})]})]})})})]})},Nj=J.createContext(void 0),s1e=({value:e,onValueChange:t,children:n,className:r})=>o.jsx(Nj.Provider,{value:{value:e,onValueChange:t},children:o.jsx("div",{className:wi("w-full",r),children:n})}),i1e=({children:e,className:t})=>o.jsx("div",{className:wi("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),children:e}),Ef=({value:e,children:t,className:n})=>{const r=J.useContext(Nj);if(!r)throw new Error("TabsTrigger must be used within Tabs");const{value:s,onValueChange:i}=r,l=s===e;return o.jsx("button",{className:wi("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",l?"bg-background text-foreground shadow-sm":"hover:bg-background/50",n),onClick:()=>i(e),children:t})},Cf=({value:e,children:t,className:n})=>{const r=J.useContext(Nj);if(!r)throw new Error("TabsContent must be used within Tabs");const{value:s}=r;return s!==e?null:o.jsx("div",{className:wi("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",n),children:t})},a1e=()=>{const e=jr(),{language:t}=Ft(),{user:n}=Mr(),r=(D,V)=>t==="ar"?D:V,[s,i]=J.useState({isOpen:!1,message:""}),[l,a]=J.useState("overview"),[c,d]=J.useState({userCount:0,totalTrees:0,privateTrees:0,publicTrees:0,personCount:0,totalSubscriptions:0,activeSubscriptions:0,recentUsers:[],recentTrees:[],monthlyRevenue:0,growthRate:0}),[u,f]=J.useState([]),[m,h]=J.useState([]),[g,y]=J.useState([]),[p,x]=J.useState(!0),[b,w]=J.useState(""),[N,k]=J.useState("all"),I=D=>{i({...D,isOpen:!0})},R=()=>{i(D=>({...D,isOpen:!1}))},T=()=>{s.onConfirm&&s.onConfirm(),R()};J.useEffect(()=>{S()},[]);const S=async()=>{x(!0);try{await Promise.all([_(),M(),A()]),await E()}catch(D){console.error("Error fetching admin data:",D)}finally{x(!1)}},E=async()=>{try{const[D,V,O,H,W]=await Promise.all([en.getUserCount(),en.getTotalTreeCount(),en.getPrivateTreeCount(),en.getPublicTreeCount(),en.getPersonCount()]);d($=>{const z=$.monthlyRevenue,q=$.growthRate,G=$.activeSubscriptions,re=$.totalSubscriptions;return{...$,userCount:(D==null?void 0:D.count)??D??0,totalTrees:(V==null?void 0:V.count)??V??0,privateTrees:(O==null?void 0:O.count)??O??0,publicTrees:(H==null?void 0:H.count)??H??0,personCount:(W==null?void 0:W.count)??W??0,monthlyRevenue:z,growthRate:q,activeSubscriptions:G,totalSubscriptions:re}})}catch(D){console.error("Error fetching stats:",D)}},_=async()=>{x(!0);try{const D=await en.getAllUsers(),O=(Array.isArray(D)?D:(D==null?void 0:D.data)||[]).map(W=>{var $,z,q,G,re,oe,ie,Y;return{id:W.id||W.Id||"",firstName:W.firstName||W.FirstName||W.userName||W.UserName||"Unknown",lastName:W.lastName||W.LastName||"",email:W.email||W.Email||`${W.firstName||W.userName||"user"}@example.com`,gender:W.gender||W.Gender||"other",role:W.role||W.Role||"user",subscription:{plan:(($=W.subscription)==null?void 0:$.plan)||((z=W.Subscription)==null?void 0:z.Plan)||W.plan||"basic",status:((q=W.subscription)==null?void 0:q.status)||((G=W.Subscription)==null?void 0:G.Status)||W.status||"active",currentPeriodStart:((re=W.subscription)==null?void 0:re.currentPeriodStart)||((oe=W.Subscription)==null?void 0:oe.CurrentPeriodStart)||new Date().toISOString(),currentPeriodEnd:((ie=W.subscription)==null?void 0:ie.currentPeriodEnd)||((Y=W.Subscription)==null?void 0:Y.CurrentPeriodEnd)||new Date(Date.now()+30*24*60*60*1e3).toISOString()},createdAt:W.createdAt||W.CreatedAt||W.created||new Date().toISOString(),lastLogin:W.lastLogin||W.LastLogin||void 0,isActive:W.isActive!==void 0?W.isActive:!0}});f(O);const H=(D==null?void 0:D.count)??O.length;d(W=>({...W,userCount:H,recentUsers:O.slice(0,5)}))}catch(D){console.error("Error fetching users:",D),f([]),d(V=>({...V,userCount:0,recentUsers:[]}))}finally{x(!1)}},M=async()=>{try{const D=await en.getAdminTrees(),O=(Array.isArray(D)?D:(D==null?void 0:D.data)||[]).map(H=>{let W={id:"",firstName:"Unknown",lastName:"User",email:"unknown@example.com"};if(H.owner||H.Owner){const z=H.owner||H.Owner;W={id:z.id||z.Id||"",firstName:z.firstName||z.FirstName||z.name||"Unknown",lastName:z.lastName||z.LastName||"",email:z.email||z.Email||`${z.firstName||z.name||"unknown"}@example.com`}}else if(H.ownerId||H.OwnerId){const z=H.ownerId||H.OwnerId;W={id:"",firstName:z,lastName:"",email:`${z}@example.com`}}let $=0;return H.members&&Array.isArray(H.members)?$=H.members.length:$=H.personCount||H.totalPeople||H.PersonCount||0,{id:H.id||H.Id||"",name:H.name||H.Name||"Unnamed Tree",owner:W,personCount:$,isPrivate:H.isPrivate||H.IsPrivate||!1,createdAt:H.createdAt||H.CreatedAt||new Date().toISOString(),lastModified:H.lastModified||H.updatedAt||new Date().toISOString()}});h(O),d(H=>({...H,recentTrees:O.slice(0,5)}))}catch(D){console.error("Error fetching trees:",D),h([])}},A=async()=>{try{const D=await en.getAllSubscriptions(),O=(Array.isArray(D)?D:(D==null?void 0:D.data)||[]).map(z=>({id:z.id||z.Id||"",userId:z.userId||z.UserId||"",plan:z.plan||z.Plan||"basic",status:z.status||z.Status||"active",currentPeriodStart:z.currentPeriodStart||z.CurrentPeriodStart||new Date().toISOString(),currentPeriodEnd:z.currentPeriodEnd||z.CurrentPeriodEnd||new Date(Date.now()+30*24*60*60*1e3).toISOString(),amount:z.amount||9.99,currency:z.currency||"USD"}));y(O);const H=O.filter(z=>z.status==="active"),W=H.reduce((z,q)=>z+(q.amount||0),0),$=O.length>0?Math.round(H.length/O.length*1e3)/10:0;d(z=>({...z,totalSubscriptions:O.length,activeSubscriptions:H.length,monthlyRevenue:W,growthRate:$}))}catch(D){console.error("Error fetching subscriptions:",D),d(V=>({...V,totalSubscriptions:0,activeSubscriptions:0,monthlyRevenue:0,growthRate:0})),y([])}},P=u.filter(D=>{const V=`${D.firstName} ${D.lastName} ${D.email}`.toLowerCase().includes(b.toLowerCase()),O=N==="all"||D.subscription.status===N;return V&&O}),B=m.filter(D=>`${D.name} ${D.owner.firstName} ${D.owner.lastName}`.toLowerCase().includes(b.toLowerCase())),L=g.filter(D=>{const V=`${D.id} ${D.userId}`.toLowerCase().includes(b.toLowerCase()),O=N==="all"||D.status===N;return V&&O});return p?o.jsx("div",{className:"min-h-screen bg-gradient-to-br from-background to-muted flex items-center justify-center",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-primary border-t-transparent mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:t==="ar"?"   ...":"Loading Admin Dashboard..."}),o.jsx("p",{className:"text-muted-foreground",children:t==="ar"?" ":"Please wait"})]})}):o.jsxs("div",{className:"space-y-6",children:[o.jsx($4,{isOpen:s.isOpen,onClose:R,onConfirm:T,title:s.title,message:s.message,confirmText:s.confirmText,cancelText:s.cancelText,variant:s.variant}),o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[o.jsxs("div",{children:[o.jsx("h1",{className:"text-3xl font-bold text-foreground",children:t==="ar"?"  ":"Admin Dashboard"}),o.jsx("p",{className:"text-muted-foreground mt-1",children:t==="ar"?"  ":"Comprehensive system management"})]}),o.jsxs(ye,{onClick:S,className:"w-full sm:w-auto",children:[o.jsx(ml,{className:"h-4 w-4 mr-2"}),t==="ar"?" ":"Refresh Data"]})]}),o.jsxs(s1e,{value:l,onValueChange:a,className:"w-full",children:[o.jsxs(i1e,{className:"grid w-full grid-cols-5",children:[o.jsxs(Ef,{value:"overview",className:"flex items-center gap-2",children:[o.jsx(tH,{className:"h-4 w-4"}),o.jsx("span",{className:"hidden sm:inline",children:t==="ar"?" ":"Overview"})]}),o.jsxs(Ef,{value:"users",className:"flex items-center gap-2",children:[o.jsx(kn,{className:"h-4 w-4"}),o.jsx("span",{className:"hidden sm:inline",children:t==="ar"?"":"Users"})]}),o.jsxs(Ef,{value:"trees",className:"flex items-center gap-2",children:[o.jsx(qn,{className:"h-4 w-4"}),o.jsx("span",{className:"hidden sm:inline",children:t==="ar"?"":"Trees"})]}),o.jsxs(Ef,{value:"subscriptions",className:"flex items-center gap-2",children:[o.jsx(hh,{className:"h-4 w-4"}),o.jsx("span",{className:"hidden sm:inline",children:t==="ar"?"":"Subscriptions"})]}),o.jsxs(Ef,{value:"limits",className:"flex items-center gap-2",children:[o.jsx(Di,{className:"h-4 w-4"}),o.jsx("span",{className:"hidden sm:inline",children:t==="ar"?"":"Limits"})]})]}),o.jsxs("div",{className:"mt-6",children:[o.jsx(Cf,{value:"overview",children:o.jsx(o1e,{stats:c,language:t,navigate:e})}),o.jsx(Cf,{value:"users",children:o.jsx(l1e,{users:P,searchQuery:b,setSearchQuery:w,filterStatus:N,setFilterStatus:k,language:t,onRefresh:_,openConfirmDialog:I,t:r})}),o.jsx(Cf,{value:"trees",children:o.jsx(c1e,{trees:B,searchQuery:b,setSearchQuery:w,language:t,navigate:e,onRefresh:M,openConfirmDialog:I,t:r})}),o.jsx(Cf,{value:"subscriptions",children:o.jsx(u1e,{subscriptions:L,searchQuery:b,setSearchQuery:w,filterStatus:N,setFilterStatus:k,language:t,onRefresh:A})}),o.jsx(Cf,{value:"limits",children:o.jsx(d1e,{users:u,language:t,onRefresh:S})})]})]})]})},o1e=({stats:e,language:t,navigate:n})=>{const r=[{title:t==="ar"?" ":"Total Users",value:e.userCount.toLocaleString(),icon:kn,color:"bg-primary",change:`+${e.growthRate.toFixed(1)}%`,changeType:"positive"},{title:t==="ar"?" ":"Total Trees",value:e.totalTrees.toLocaleString(),icon:qn,color:"bg-green-500",change:`+${e.growthRate.toFixed(1)}%`,changeType:"positive"},{title:t==="ar"?" ":"Active Subscriptions",value:e.activeSubscriptions.toLocaleString(),icon:hh,color:"bg-purple-500",change:`+${e.growthRate.toFixed(1)}%`,changeType:"positive"},{title:t==="ar"?" ":"Monthly Revenue",value:`$${e.monthlyRevenue.toLocaleString()}`,icon:aH,color:"bg-emerald-500",change:`+${(e.growthRate*1.5).toFixed(1)}%`,changeType:"positive"}];return o.jsxs("div",{className:"space-y-6",children:[o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:r.map((s,i)=>{const l=s.icon;return o.jsx(et,{className:"relative overflow-hidden",children:o.jsx(rt,{className:"p-6",children:o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{children:[o.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:s.title}),o.jsx("p",{className:"text-2xl font-bold text-foreground",children:s.value}),o.jsxs("div",{className:"flex items-center mt-2",children:[o.jsx(ng,{className:"h-4 w-4 text-green-500 mr-1"}),o.jsx("span",{className:"text-sm text-green-600 font-medium",children:s.change})]})]}),o.jsx("div",{className:`p-3 rounded-full ${s.color}`,children:o.jsx(l,{className:"h-6 w-6 text-white"})})]})})},`stat-${i}`)})}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[o.jsxs(et,{children:[o.jsx(ht,{children:o.jsxs(gt,{className:"flex items-center gap-2",children:[o.jsx(kn,{className:"h-5 w-5"}),t==="ar"?" ":"Recent Users"]})}),o.jsx(rt,{children:o.jsx("div",{className:"space-y-4",children:e.recentUsers.slice(0,5).map(s=>{var i,l;return o.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-muted",children:[o.jsx("div",{className:"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center",children:o.jsxs("span",{className:"text-primary font-medium text-sm",children:[(i=s.firstName)==null?void 0:i.charAt(0),(l=s.lastName)==null?void 0:l.charAt(0)]})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("p",{className:"font-medium text-sm truncate text-foreground",children:[s.firstName," ",s.lastName]}),o.jsx("p",{className:"text-xs text-muted-foreground truncate",children:s.email})]}),o.jsx(Gn,{variant:"outline",className:"text-xs",children:s.subscription.plan})]},s.id)})})})]}),o.jsxs(et,{children:[o.jsx(ht,{children:o.jsxs(gt,{className:"flex items-center gap-2",children:[o.jsx(qn,{className:"h-5 w-5"}),t==="ar"?" ":"Recent Trees"]})}),o.jsx(rt,{children:o.jsx("div",{className:"space-y-4",children:e.recentTrees.slice(0,5).map(s=>o.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-muted",children:[o.jsx("div",{className:"w-10 h-10 rounded-full bg-green-100 flex items-center justify-center",children:o.jsx(qn,{className:"h-5 w-5 text-green-600"})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("p",{className:"font-medium text-sm truncate text-foreground",children:s.name}),o.jsxs("p",{className:"text-xs text-muted-foreground",children:[s.personCount," ",t==="ar"?"":"people"]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[s.isPrivate?o.jsx(Di,{className:"h-4 w-4 text-gray-400"}):o.jsx(jo,{className:"h-4 w-4 text-gray-400"}),o.jsx(ye,{variant:"ghost",size:"sm",onClick:()=>n(`/trees/${s.id}`),children:o.jsx(ra,{className:"h-4 w-4"})})]})]},s.id))})})]})]}),o.jsxs(et,{children:[o.jsx(ht,{children:o.jsxs(gt,{className:"flex items-center gap-2",children:[o.jsx(Di,{className:"h-5 w-5"}),t==="ar"?"  ":"New Limitation Status"]})}),o.jsx(rt,{children:o.jsxs("div",{className:"space-y-4",children:[o.jsx("p",{className:"text-sm text-gray-600",children:t==="ar"?"      API.          10   .":"The system now fetches user limits from the API. Users without a subscription plan can create one tree and 10 people per tree."}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[o.jsxs("div",{className:"p-4 bg-primary/10 rounded-lg",children:[o.jsx("h4",{className:"font-medium text-primary-foreground mb-2",children:t==="ar"?" ":"Default Limits"}),o.jsxs("ul",{className:"text-sm text-primary-foreground space-y-1",children:[o.jsxs("li",{children:[" ",t==="ar"?"  ":"One tree only"]}),o.jsxs("li",{children:[" ",t==="ar"?"10   ":"10 people per tree"]}),o.jsxs("li",{children:[" ",t==="ar"?" ":"No photos"]}),o.jsxs("li",{children:[" ",t==="ar"?" ":"No sharing"]})]})]}),o.jsxs("div",{className:"p-4 bg-green-500/10 rounded-lg",children:[o.jsx("h4",{className:"font-medium text-green-900 mb-2",children:t==="ar"?" ":"Subscriber Limits"}),o.jsxs("ul",{className:"text-sm text-green-800 space-y-1",children:[o.jsxs("li",{children:[" ",t==="ar"?"    API":"Limits fetched from API"]}),o.jsxs("li",{children:[" ",t==="ar"?"   ":"Limits updated automatically"]}),o.jsxs("li",{children:[" ",t==="ar"?"   ":"Flexible limits based on plan"]})]})]})]})]})})]})]})},l1e=({users:e,searchQuery:t,setSearchQuery:n,filterStatus:r,setFilterStatus:s,language:i,onRefresh:l,openConfirmDialog:a,t:c})=>{const{showSuccess:d,showError:u}=Ft(),f=async(m,h)=>{const g=i==="ar"?" ":"Confirm Deletion",y=i==="ar"?`       "${h}"      .`:`Are you sure you want to delete the user "${h}"? This action cannot be undone.`;a({title:g,message:y,confirmText:i==="ar"?"":"Delete",cancelText:i==="ar"?"":"Cancel",variant:"destructive",onConfirm:async()=>{try{await Vn.deleteUser(m),l(),d(i==="ar"?"  ":"User Deleted",i==="ar"?"   ":"User deleted successfully")}catch(p){console.error("Error deleting user:",p),u(i==="ar"?"   ":"Failed to Delete User",i==="ar"?"   .    .":"Failed to delete user. Please try again.")}}})};return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-foreground",children:i==="ar"?" ":"User Management"}),o.jsx("p",{className:"text-muted-foreground",children:i==="ar"?"    ":"Manage all users in the system"})]}),o.jsxs(ye,{onClick:l,className:"w-full sm:w-auto",children:[o.jsx(ml,{className:"h-4 w-4 mr-2"}),i==="ar"?"":"Refresh"]})]}),o.jsx(et,{children:o.jsx(rt,{className:"p-4",children:o.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[o.jsx("div",{className:"flex-1",children:o.jsxs("div",{className:"relative",children:[o.jsx(Qi,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),o.jsx(Bt,{placeholder:i==="ar"?"  ...":"Search users...",value:t,onChange:m=>n(m.target.value),className:"pl-10"})]})}),o.jsxs("div",{className:"flex gap-2",children:[o.jsxs("select",{value:r,onChange:m=>s(m.target.value),className:"px-3 py-2 border border-input rounded-md text-sm bg-background text-foreground",children:[o.jsx("option",{value:"all",children:i==="ar"?" ":"All Status"}),o.jsx("option",{value:"active",children:i==="ar"?"":"Active"}),o.jsx("option",{value:"cancelled",children:i==="ar"?"":"Cancelled"}),o.jsx("option",{value:"past_due",children:i==="ar"?"":"Past Due"})]}),o.jsxs(ye,{variant:"outline",size:"sm",children:[o.jsx(eh,{className:"h-4 w-4 mr-2"}),i==="ar"?"":"Export"]})]})]})})}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map(m=>o.jsx(et,{className:"hover:shadow-md transition-shadow",children:o.jsxs(rt,{className:"p-4",children:[o.jsx("div",{className:"flex items-start justify-between mb-3",children:o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center",children:m.gender==="male"?o.jsx(Aa,{className:"h-6 w-6 text-primary"}):o.jsx(TI,{className:"h-6 w-6 text-primary"})}),o.jsxs("div",{children:[o.jsxs("h3",{className:"font-semibold text-foreground",children:[m.firstName," ",m.lastName]}),o.jsx("p",{className:"text-sm text-muted-foreground truncate",children:m.email})]})]})}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm text-muted-foreground",children:i==="ar"?":":"Role:"}),o.jsx(Gn,{variant:m.role==="admin"?"default":"secondary",children:m.role==="admin"?i==="ar"?"":"Admin":i==="ar"?"":"User"})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm text-muted-foreground",children:i==="ar"?":":"Subscription:"}),o.jsx(Gn,{variant:m.subscription.status==="active"?"default":"outline",className:"capitalize",children:m.subscription.plan})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm text-muted-foreground",children:i==="ar"?" :":"Joined:"}),o.jsx("span",{className:"text-sm text-foreground",children:new Date(m.createdAt).toLocaleDateString()})]})]}),o.jsx("div",{className:"flex gap-2 mt-4",children:o.jsxs(ye,{variant:"destructive",size:"sm",className:"flex-1",onClick:()=>f(m.email,`${m.firstName} ${m.lastName}`),children:[o.jsx($a,{className:"h-4 w-4 mr-1"}),i==="ar"?"":"Delete"]})})]})},m.id))}),e.length===0&&o.jsx(et,{children:o.jsxs(rt,{className:"p-8 text-center",children:[o.jsx(kn,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:i==="ar"?"  ":"No users found"}),o.jsx("p",{className:"text-muted-foreground mb-4",children:i==="ar"?"      ":"There are no users in the system yet"}),o.jsxs(ye,{onClick:l,children:[o.jsx(ml,{className:"h-4 w-4 mr-2"}),i==="ar"?"":"Refresh"]})]})})]})},c1e=({trees:e,searchQuery:t,setSearchQuery:n,language:r,navigate:s,onRefresh:i,openConfirmDialog:l,t:a})=>{const{showSuccess:c,showError:d}=Ft(),u=async(f,m)=>{const h=r==="ar"?" ":"Confirm Deletion",g=r==="ar"?`       "${m}"      .`:`Are you sure you want to delete the tree "${m}"? This action cannot be undone.`;l({title:h,message:g,confirmText:r==="ar"?"":"Delete",cancelText:r==="ar"?"":"Cancel",variant:"destructive",onConfirm:async()=>{try{const y=parseInt(f);if(isNaN(y))throw new Error("Invalid tree ID");await At.deleteTree(y),i(),c(r==="ar"?"  ":"Tree Deleted",r==="ar"?"   ":"Tree deleted successfully")}catch(y){console.error("Error deleting tree:",y),d(r==="ar"?"   ":"Failed to Delete Tree",r==="ar"?"   .    .":"Failed to delete tree. Please try again.")}}})};return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-foreground",children:r==="ar"?" ":"Tree Management"}),o.jsx("p",{className:"text-muted-foreground",children:r==="ar"?"     ":"Manage all family trees in the system"})]}),o.jsxs(ye,{onClick:i,className:"w-full sm:w-auto",children:[o.jsx(ml,{className:"h-4 w-4 mr-2"}),r==="ar"?"":"Refresh"]})]}),o.jsx(et,{children:o.jsx(rt,{className:"p-4",children:o.jsxs("div",{className:"relative",children:[o.jsx(Qi,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),o.jsx(Bt,{placeholder:r==="ar"?"  ...":"Search trees...",value:t,onChange:f=>n(f.target.value),className:"pl-10"})]})})}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map(f=>o.jsx(et,{className:"hover:shadow-md transition-shadow",children:o.jsxs(rt,{className:"p-4",children:[o.jsxs("div",{className:"flex items-start justify-between mb-3",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-12 h-12 rounded-full bg-green-100 flex items-center justify-center",children:o.jsx(qn,{className:"h-6 w-6 text-green-600"})}),o.jsxs("div",{children:[o.jsx("h3",{className:"font-semibold text-foreground truncate",children:f.name}),o.jsxs("p",{className:"text-sm text-muted-foreground",children:[f.owner.firstName," ",f.owner.lastName]})]})]}),o.jsx("div",{className:"flex items-center gap-1",children:f.isPrivate?o.jsx(Di,{className:"h-4 w-4 text-gray-400"}):o.jsx(jo,{className:"h-4 w-4 text-gray-400"})})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm text-gray-600",children:r==="ar"?" :":"People Count:"}),o.jsx("span",{className:"text-sm font-medium text-gray-900",children:f.personCount})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm text-gray-600",children:r==="ar"?":":"Type:"}),o.jsx(Gn,{variant:f.isPrivate?"default":"secondary",children:f.isPrivate?r==="ar"?"":"Private":r==="ar"?"":"Public"})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm text-gray-600",children:r==="ar"?" :":"Created:"}),o.jsx("span",{className:"text-sm text-gray-900",children:new Date(f.createdAt).toLocaleDateString()})]})]}),o.jsxs("div",{className:"flex gap-2 mt-4",children:[o.jsxs(ye,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>s(`/trees/${f.id}`),children:[o.jsx(ra,{className:"h-4 w-4 mr-1"}),r==="ar"?"":"View"]}),o.jsxs(ye,{variant:"destructive",size:"sm",className:"flex-1",onClick:()=>u(f.id,f.name),children:[o.jsx($a,{className:"h-4 w-4 mr-1"}),r==="ar"?"":"Delete"]})]})]})},f.id))}),e.length===0&&o.jsx(et,{children:o.jsxs(rt,{className:"p-8 text-center",children:[o.jsx(qn,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:r==="ar"?"  ":"No trees found"}),o.jsx("p",{className:"text-gray-600",children:a("      ","No trees match your search criteria")})]})})]})},u1e=({subscriptions:e,searchQuery:t,setSearchQuery:n,filterStatus:r,setFilterStatus:s,language:i,onRefresh:l})=>o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-foreground",children:i==="ar"?" ":"Subscription Management"}),o.jsx("p",{className:"text-muted-foreground",children:i==="ar"?"    ":"Manage all subscriptions in the system"})]}),o.jsxs(ye,{onClick:l,className:"w-full sm:w-auto",children:[o.jsx(ml,{className:"h-4 w-4 mr-2"}),i==="ar"?"":"Refresh"]})]}),o.jsx(et,{children:o.jsx(rt,{className:"p-4",children:o.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[o.jsx("div",{className:"flex-1",children:o.jsxs("div",{className:"relative",children:[o.jsx(Qi,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),o.jsx(Bt,{placeholder:i==="ar"?"  ...":"Search subscriptions...",value:t,onChange:a=>n(a.target.value),className:"pl-10"})]})}),o.jsxs("select",{value:r,onChange:a=>s(a.target.value),className:"px-3 py-2 border border-input rounded-md text-sm bg-background text-foreground",children:[o.jsx("option",{value:"all",children:i==="ar"?" ":"All Status"}),o.jsx("option",{value:"active",children:i==="ar"?"":"Active"}),o.jsx("option",{value:"cancelled",children:i==="ar"?"":"Cancelled"}),o.jsx("option",{value:"past_due",children:i==="ar"?"":"Past Due"})]})]})})}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map(a=>o.jsx(et,{className:"hover:shadow-md transition-shadow",children:o.jsxs(rt,{className:"p-4",children:[o.jsxs("div",{className:"flex items-start justify-between mb-3",children:[o.jsxs("div",{className:"flex items-center gap-3",children:[o.jsx("div",{className:"w-12 h-12 rounded-full bg-purple-500/10 flex items-center justify-center",children:o.jsx(hh,{className:"h-6 w-6 text-purple-600"})}),o.jsxs("div",{children:[o.jsxs("h3",{className:"font-semibold text-foreground capitalize",children:[a.plan," Plan"]}),o.jsxs("p",{className:"text-sm text-muted-foreground truncate",children:["ID: ",a.id]})]})]}),o.jsx(ye,{variant:"ghost",size:"sm",children:o.jsx(gH,{className:"h-4 w-4"})})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm text-gray-600",children:i==="ar"?":":"Status:"}),o.jsx(Gn,{variant:a.status==="active"?"default":a.status==="cancelled"?"destructive":"outline",children:a.status==="active"?i==="ar"?"":"Active":a.status==="cancelled"?i==="ar"?"":"Cancelled":i==="ar"?"":"Past Due"})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm text-muted-foreground",children:i==="ar"?":":"Amount:"}),o.jsxs("span",{className:"text-sm font-medium text-foreground",children:["$",a.amount," ",a.currency]})]}),o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("span",{className:"text-sm text-muted-foreground",children:i==="ar"?" :":"Expires:"}),o.jsx("span",{className:"text-sm text-foreground",children:new Date(a.currentPeriodEnd).toLocaleDateString()})]})]}),o.jsxs("div",{className:"flex gap-2 mt-4",children:[o.jsxs(ye,{variant:"outline",size:"sm",className:"flex-1",children:[o.jsx(ra,{className:"h-4 w-4 mr-1"}),i==="ar"?"":"View"]}),o.jsxs(ye,{variant:"outline",size:"sm",className:"flex-1",children:[o.jsx(sa,{className:"h-4 w-4 mr-1"}),i==="ar"?"":"Edit"]}),o.jsx(ye,{variant:"destructive",size:"sm",children:o.jsx($a,{className:"h-4 w-4"})})]})]})},a.id))}),e.length===0&&o.jsx(et,{children:o.jsxs(rt,{className:"p-8 text-center",children:[o.jsx(hh,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:i==="ar"?"  ":"No subscriptions found"}),o.jsx("p",{className:"text-muted-foreground",children:i==="ar"?"      ":"No subscriptions match your search criteria"})]})})]}),d1e=({users:e,language:t,onRefresh:n})=>{const r=e.reduce((s,i)=>{var a;const l=((a=i.subscription)==null?void 0:a.plan)||"free";return s[l]||(s[l]=[]),s[l].push(i),s},{});return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[o.jsxs("div",{children:[o.jsx("h2",{className:"text-2xl font-bold text-foreground",children:t==="ar"?" ":"Limit Management"}),o.jsx("p",{className:"text-muted-foreground",children:t==="ar"?"   ":"View and manage user limits"})]}),o.jsxs(ye,{onClick:n,className:"w-full sm:w-auto",children:[o.jsx(ml,{className:"h-4 w-4 mr-2"}),t==="ar"?"":"Refresh"]})]}),o.jsxs(et,{children:[o.jsx(ht,{children:o.jsxs(gt,{className:"flex items-center gap-2",children:[o.jsx(Di,{className:"h-5 w-5"}),t==="ar"?"  ":"New Limitation System"]})}),o.jsx(rt,{children:o.jsxs("div",{className:"space-y-4",children:[o.jsx("p",{className:"text-sm text-muted-foreground",children:t==="ar"?"      API.          10   .":"The system now fetches user limits from the API. Users without a subscription plan can create one tree and 10 people per tree."}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[o.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:t==="ar"?" ":"Default Limits"}),o.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[o.jsxs("li",{children:[" ",t==="ar"?"  ":"One tree only"]}),o.jsxs("li",{children:[" ",t==="ar"?"10   ":"10 people per tree"]}),o.jsxs("li",{children:[" ",t==="ar"?" ":"No photos"]}),o.jsxs("li",{children:[" ",t==="ar"?" ":"No sharing"]})]})]}),o.jsxs("div",{className:"p-4 bg-green-50 rounded-lg border border-green-200",children:[o.jsx("h4",{className:"font-medium text-green-900 mb-2",children:t==="ar"?" ":"Subscriber Limits"}),o.jsxs("ul",{className:"text-sm text-green-800 space-y-1",children:[o.jsxs("li",{children:[" ",t==="ar"?"    API":"Limits fetched from API"]}),o.jsxs("li",{children:[" ",t==="ar"?"   ":"Flexible limits based on plan"]}),o.jsxs("li",{children:[" ",t==="ar"?" ":"Automatic updates"]})]})]}),o.jsxs("div",{className:"p-4 bg-purple-50 rounded-lg border border-purple-200",children:[o.jsx("h4",{className:"font-medium text-purple-900 mb-2",children:t==="ar"?"  API":"API Endpoint"}),o.jsxs("p",{className:"text-sm text-purple-800",children:["GET /api/FamilyTree/UserTreeLimit/","{userId}"]}),o.jsx("p",{className:"text-xs text-purple-600 mt-2",children:t==="ar"?"       ":"This endpoint is used to fetch limits for each user"})]})]})]})})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Object.entries(r).map(([s,i])=>o.jsxs(et,{children:[o.jsx(ht,{children:o.jsxs(gt,{className:"flex items-center justify-between",children:[o.jsxs("span",{className:"capitalize",children:[s," ",t==="ar"?"":"Plan"]}),o.jsx(Gn,{variant:"secondary",children:i.length})]})}),o.jsx(rt,{children:o.jsxs("div",{className:"space-y-3",children:[i.slice(0,3).map(l=>{var a,c;return o.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg bg-muted",children:[o.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center",children:o.jsx("span",{className:"text-primary font-medium text-xs",children:(a=l.firstName)==null?void 0:a.charAt(0)})}),o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsxs("p",{className:"font-medium text-sm truncate text-foreground",children:[l.firstName," ",l.lastName]}),o.jsx("p",{className:"text-xs text-muted-foreground truncate",children:l.email})]}),o.jsx(Gn,{variant:"outline",className:"text-xs",children:((c=l.subscription)==null?void 0:c.status)||"active"})]},l.id)}),i.length>3&&o.jsx("p",{className:"text-xs text-muted-foreground text-center pt-2 border-t",children:t==="ar"?` ${i.length-3}  `:`And ${i.length-3} more users`})]})})]},s))})]})},f1e=()=>{const{language:e}=Ft(),[t,n]=J.useState([]),[r,s]=J.useState(!0),[i,l]=J.useState(null);J.useEffect(()=>{a()},[]);const a=async()=>{try{s(!0),l(null);const f=localStorage.getItem("authToken"),h=await fetch("https://qabael.premiumasp.net/api/admin/join-requests",{headers:{Authorization:f?`Bearer ${f}`:"","Content-Type":"application/json"}});if(!h.ok)throw new Error(`HTTP error! status: ${h.status}`);const g=await h.json();let y=[];Array.isArray(g)?y=g:g&&typeof g=="object"&&"data"in g?y=Array.isArray(g.data)?g.data:[]:y=[];const p=y.map(x=>{const b=x.id??x.Id??x.ID??0,w=x.familyTreeId??x.FamilyTreeId??0,N=x.name??x.Name??"",k=x.birthDate??x.BirthDate??"",I=x.birthPlace??x.BirthPlace??"",R=x.gender??x.Gender??"",T=x.occupation??x.Occupation??"",S=x.relatedPersonId??x.RelatedPersonId??0,E=x.status??x.Status??"Pending",_=x.requesterId??x.RequesterId??"",M=x.relationshipType??x.RelationshipType??"",A=x.createdAt??x.CreatedAt??new Date().toISOString();return{id:b,familyTreeId:w,name:N,birthDate:k,birthPlace:I,gender:R,occupation:T,relatedPersonId:S,status:E,requesterId:_,relationshipType:M,createdAt:A}}).filter(x=>x.id>0);n(p)}catch{l(e==="ar"?"    ":"Failed to load join requests")}finally{s(!1)}},c=async f=>{try{await en.acceptJoinRequest(f),tn.success({en:"Request accepted successfully",ar:"   "}),a()}catch{tn.error({en:"Failed to accept request",ar:"   "})}},d=async f=>{try{await en.rejectJoinRequest(f),tn.success({en:"Request rejected successfully",ar:"   "}),a()}catch{tn.error({en:"Failed to reject request",ar:"   "})}},u=f=>{switch(f.toLowerCase()){case"pending":return o.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[o.jsx(h0,{className:"h-3 w-3 mr-1"}),e==="ar"?" ":"Pending"]});case"accepted":return o.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[o.jsx(vi,{className:"h-3 w-3 mr-1"}),e==="ar"?"":"Accepted"]});case"rejected":return o.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[o.jsx(sg,{className:"h-3 w-3 mr-1"}),e==="ar"?"":"Rejected"]});default:return o.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:f})}};return r?o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsx(mr,{className:"h-12 w-12 animate-spin text-primary"})}):i?o.jsx("div",{className:"flex items-center justify-center h-64",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"mx-auto w-16 h-16 bg-destructive/10 rounded-full flex items-center justify-center mb-4",children:o.jsx(Qs,{className:"h-8 w-8 text-destructive"})}),o.jsx("h2",{className:"text-2xl font-bold text-destructive mb-4",children:i}),o.jsx(ye,{onClick:a,children:e==="ar"?" ":"Try Again"})]})}):o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsx("h1",{className:"text-2xl font-bold",children:e==="ar"?"  ":"Manage Join Requests"}),o.jsx(ye,{onClick:a,variant:"outline",size:"sm",children:e==="ar"?"":"Refresh"})]}),o.jsxs(et,{children:[o.jsx(ht,{children:o.jsxs(gt,{className:"flex items-center gap-2",children:[o.jsx(kn,{className:"h-5 w-5"}),e==="ar"?"  ":"Manage Join Requests"]})}),o.jsx(rt,{children:o.jsx("div",{className:"space-y-4",children:t.length===0?o.jsxs("div",{className:"text-center py-12",children:[o.jsx(kn,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),o.jsx("h3",{className:"text-lg font-medium mb-1",children:e==="ar"?"  ":"No Requests Found"}),o.jsx("p",{className:"text-muted-foreground",children:e==="ar"?"    ":"No join requests found currently"})]}):t.map(f=>o.jsx("div",{className:"border rounded-lg p-4",children:o.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[o.jsxs("div",{className:"flex-1",children:[o.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[o.jsx("h3",{className:"font-medium",children:f.name}),u(f.status)]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(Lr,{className:"h-4 w-4 text-muted-foreground"}),o.jsx("span",{children:new Date(f.birthDate).toLocaleDateString(e==="ar"?"ar-SA":"en-US")})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(ei,{className:"h-4 w-4 text-muted-foreground"}),o.jsx("span",{children:f.birthPlace})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(hl,{className:"h-4 w-4 text-muted-foreground"}),o.jsx("span",{children:f.occupation})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(kn,{className:"h-4 w-4 text-muted-foreground"}),o.jsx("span",{children:f.relationshipType})]})]}),o.jsxs("div",{className:"mt-2 text-xs text-muted-foreground",children:[e==="ar"?" :":"Requested by:"," ",f.requesterId]}),o.jsxs("div",{className:"mt-1 text-xs text-muted-foreground",children:[e==="ar"?" :":"Tree ID:"," ",f.familyTreeId]})]}),f.status.toLowerCase()==="pending"&&o.jsxs("div",{className:"flex gap-2",children:[o.jsxs(ye,{variant:"default",size:"sm",onClick:()=>c(f.id),className:"flex items-center gap-1",children:[o.jsx(Lp,{className:"h-4 w-4"}),e==="ar"?"":"Accept"]}),o.jsxs(ye,{variant:"destructive",size:"sm",onClick:()=>d(f.id),className:"flex items-center gap-1",children:[o.jsx(LI,{className:"h-4 w-4"}),e==="ar"?"":"Reject"]})]})]})},f.id))})})]})]})},h1e=e=>{var t,n,r;if(!navigator.onLine)return"   .       .";if(e.response){const s=e.response.status,i=(t=e.response.data)==null?void 0:t.message;switch(s){case 400:return i||"   .       .";case 401:return"   .     .";case 403:return"      .";case 404:return"    .";case 429:return"     .   .";case 500:return"  .        .";default:return i||`    (${s}).    .`}}return e.code==="NETWORK_ERROR"||(n=e.message)!=null&&n.includes("Network Error")?"   .       .":e.code==="ECONNABORTED"||(r=e.message)!=null&&r.includes("timeout")?"   .    .":e.message||"   .    ."},m1e="https://qabael.premiumasp.net/api/Payments",ic=or.create({baseURL:m1e,headers:{"Content-Type":"application/json"}});ic.interceptors.request.use(e=>{const t=localStorage.getItem("authToken");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));ic.interceptors.response.use(e=>e,e=>(console.error("Payment API Error:",e),e.userMessage=h1e(e),Promise.reject(e)));class Bh{static async createOneTimePayment(t){try{return(await ic.post("/OneTimePaid",t)).data}catch(n){throw console.error("One-time payment error:",n),n}}static async createSubscription(t){var n,r,s;try{console.log("Sending subscription request:",t);const i=await ic.post("/CreateSubscription",t);return console.log("Subscription response:",i.data),i.data}catch(i){throw console.error("Subscription creation error:",i),console.error("Error details:",{status:(n=i.response)==null?void 0:n.status,statusText:(r=i.response)==null?void 0:r.statusText,data:(s=i.response)==null?void 0:s.data,message:i.message}),i}}static async getAllPlans(){try{return(await ic.get("/GetAllPlans")).data}catch(t){throw console.error("Get plans error:",t),t}}static async unsubscribe(t){try{return(await ic.post(`/UnSubscripe?email=${t}`)).data}catch(n){throw console.error("Unsubscribe error:",n),n}}static async getUserSubscriptionStatus(t){var n;if(!t)throw new Error("      ");try{return(await ic.get(`/UserSubscriptionStatus?email=${encodeURIComponent(t)}`)).data}catch(r){throw console.error("Get subscription status error:",r),((n=r.response)==null?void 0:n.status)===404?new Error("     "):new Error(r.userMessage||"     ")}}}const p1e=()=>{const e=jr(),{language:t}=Ft(),[n,r]=J.useState([]),[s,i]=J.useState(!0),[l,a]=J.useState(null);J.useEffect(()=>{(async()=>{try{i(!0);const f=await Bh.getAllPlans();r(f)}catch(f){console.error("Error fetching plans:",f),a(t==="ar"?"   ":"Failed to load plans")}finally{i(!1)}})()},[t]);const[c,d]=be.useState("yearly");return o.jsx("div",{className:"min-h-screen bg-gray-50 py-12",children:o.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[o.jsxs("div",{className:"text-center mb-12",children:[o.jsx("h1",{className:"text-3xl font-bold text-gray-900 sm:text-4xl",children:t==="ar"?" ":"Pricing Plans"}),o.jsx("p",{className:"mt-4 text-lg text-gray-600 max-w-2xl mx-auto",children:t==="ar"?"      ":"Select the plan that fits your needs and enjoy all features"}),o.jsx("div",{className:"mt-8 flex justify-center",children:o.jsxs("div",{className:"inline-flex rounded-md shadow-sm",role:"group",children:[o.jsx("button",{type:"button",onClick:()=>d("monthly"),className:`px-4 py-2 text-sm font-medium rounded-l-lg ${c==="monthly"?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-100"}`,children:t==="ar"?"":"Monthly"}),o.jsxs("button",{type:"button",onClick:()=>d("yearly"),className:`px-4 py-2 text-sm font-medium rounded-r-md ${c==="yearly"?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-100"}`,children:[t==="ar"?"":"Yearly",o.jsx(Gn,{className:"ml-2 bg-green-100 text-green-800",children:t==="ar"?" 17%":"Save 17%"})]})]})})]}),s?o.jsx("div",{className:"flex justify-center items-center h-64",children:o.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):l?o.jsxs("div",{className:"text-center py-12",children:[o.jsx("p",{className:"text-red-500 mb-4",children:l}),o.jsx(ye,{onClick:()=>window.location.reload(),children:t==="ar"?" ":"Try Again"})]}):o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:n.map(u=>o.jsxs(et,{className:"flex flex-col",children:[u.name==="Yearly"&&o.jsx("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:o.jsx(Gn,{className:"bg-blue-500",children:t==="ar"?" ":"Most Popular"})}),o.jsxs(ht,{children:[o.jsx(gt,{className:"text-xl",children:u.name}),o.jsx(qr,{children:u.description})]}),o.jsxs(rt,{className:"flex-1",children:[o.jsxs("div",{className:"mb-6",children:[o.jsxs("span",{className:"text-4xl font-bold text-gray-900",children:["$",u.price]}),o.jsxs("span",{className:"text-gray-600",children:["/",u.billingCycle==="year"?t==="ar"?"":"year":t==="ar"?"":"month"]})]}),o.jsx("div",{className:"text-sm text-gray-600 mb-6",children:o.jsx("p",{children:u.description})}),o.jsx(ye,{onClick:()=>e(`/subscription/checkout/${u.productId}`,{state:{plan:u}}),className:"w-full",children:t==="ar"?"  ":"Choose This Plan"})]})]},u.id))}),o.jsxs("div",{className:"mt-16 max-w-3xl mx-auto",children:[o.jsx("div",{className:"text-center",children:o.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:t==="ar"?" ":"Frequently Asked Questions"})}),o.jsxs("div",{className:"space-y-4",children:[o.jsx(et,{children:o.jsxs(rt,{className:"p-6",children:[o.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:t==="ar"?"      ":"How can I change my subscription plan?"}),o.jsx("p",{className:"text-gray-600",children:t==="ar"?"              .":"You can upgrade or downgrade your subscription plan at any time from your account settings page."})]})}),o.jsx(et,{children:o.jsxs(rt,{className:"p-6",children:[o.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:t==="ar"?"      ":"Can I cancel my subscription at any time?"}),o.jsx("p",{className:"text-gray-600",children:t==="ar"?"      .       .":"Yes, you can cancel your subscription at any time. No automatic billing will occur after cancellation."})]})}),o.jsx(et,{children:o.jsxs(rt,{className:"p-6",children:[o.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:t==="ar"?"    ":"Do you offer a free trial period?"}),o.jsx("p",{className:"text-gray-600",children:t==="ar"?"      14     .":"Yes, we offer a 14-day free trial for all new subscription plans."})]})})]})]})]})})},uD=(e=!0)=>{const{user:t,isLoading:n}=Mr(),r=jr(),s=!!t,i=(t==null?void 0:t.email)||"";return J.useEffect(()=>{!n&&!s&&e&&r("/auth/login")},[s,n,e,r]),{user:t,userEmail:i,isAuthenticated:s,isLoading:n}},g1e=()=>{const e=jr(),{userEmail:t,isAuthenticated:n,isLoading:r}=uD(),{language:s}=Ft(),[i,l]=J.useState([]),[a,c]=J.useState(!0),[d,u]=J.useState(null);if(r)return o.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})});if(!n)return o.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:o.jsxs(et,{className:"max-w-md w-full mx-4",children:[o.jsx(ht,{children:o.jsx(gt,{children:s==="ar"?"  ":"Login Required"})}),o.jsx(rt,{children:o.jsx("p",{className:"text-muted-foreground",children:s==="ar"?"     ":"Please log in to view subscription plans"})}),o.jsx(rt,{children:o.jsx(ye,{onClick:()=>e("/login"),className:"w-full",children:s==="ar"?" ":"Login"})})]})});J.useEffect(()=>{f()},[]);const f=async()=>{try{c(!0);const g=await Bh.getAllPlans();l(g)}catch(g){console.error("Error fetching plans:",g),u(s==="ar"?"   ":"Failed to load plans")}finally{c(!1)}},m=g=>{e(`/subscription/checkout/${g.productId}`,{state:{plan:g,userEmail:t||""}})},h=g=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(g);return a?o.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):d?o.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:o.jsxs(et,{className:"max-w-md w-full mx-4",children:[o.jsx(ht,{children:o.jsx(gt,{className:"text-destructive",children:s==="ar"?"":"Error"})}),o.jsx(rt,{children:o.jsx("p",{className:"text-muted-foreground",children:d})}),o.jsx(rt,{children:o.jsx(ye,{onClick:f,className:"w-full",children:s==="ar"?" ":"Try Again"})})]})}):o.jsx("div",{className:"min-h-screen bg-background py-12",children:o.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[o.jsxs("div",{className:"text-center mb-12",children:[o.jsx("h1",{className:"text-3xl font-bold text-foreground sm:text-4xl",children:s==="ar"?"  ":"Choose Your Subscription Plan"}),o.jsx("p",{className:"mt-4 text-lg text-muted-foreground max-w-2xl mx-auto",children:s==="ar"?"      ":"Select the plan that fits your needs and enjoy all features"})]}),o.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:i.map(g=>{const y=g.billingCycle==="year";return o.jsxs(et,{className:"flex flex-col",children:[o.jsx(ht,{children:o.jsxs("div",{className:"flex justify-between items-start",children:[o.jsxs("div",{children:[o.jsx(gt,{className:"text-xl",children:g.name}),o.jsx(qr,{children:g.description})]}),g.name==="Yearly"&&o.jsx(Gn,{className:"bg-primary text-primary-foreground",children:s==="ar"?" ":"Most Popular"})]})}),o.jsxs(rt,{className:"flex-1",children:[o.jsxs("div",{className:"mb-6",children:[o.jsx("span",{className:"text-4xl font-bold text-foreground",children:h(g.price)}),o.jsxs("span",{className:"text-muted-foreground",children:["/",y?s==="ar"?"":"year":s==="ar"?"":"month"]})]}),o.jsx("div",{className:"text-sm text-muted-foreground mb-6",children:o.jsx("p",{children:g.description})})]}),o.jsx(rt,{children:o.jsx(ye,{onClick:()=>m(g),className:"w-full",children:s==="ar"?"  ":"Choose This Plan"})})]},g.id)})})]})})};var dD="https://js.stripe.com/v3",x1e=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/;var y1e=function(){for(var t=document.querySelectorAll('script[src^="'.concat(dD,'"]')),n=0;n<t.length;n++){var r=t[n];if(x1e.test(r.src))return r}return null},EP=function(t){var n="",r=document.createElement("script");r.src="".concat(dD).concat(n);var s=document.head||document.body;if(!s)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return s.appendChild(r),r},v1e=function(t,n){!t||!t._registerWrapper||t._registerWrapper({name:"stripe-js",version:"2.4.0",startTime:n})},Pf=null,Sp=null,Ap=null,b1e=function(t){return function(){t(new Error("Failed to load Stripe.js"))}},w1e=function(t,n){return function(){window.Stripe?t(window.Stripe):n(new Error("Stripe.js not available"))}},N1e=function(t){return Pf!==null?Pf:(Pf=new Promise(function(n,r){if(typeof window>"u"||typeof document>"u"){n(null);return}if(window.Stripe){n(window.Stripe);return}try{var s=y1e();if(!(s&&t)){if(!s)s=EP(t);else if(s&&Ap!==null&&Sp!==null){var i;s.removeEventListener("load",Ap),s.removeEventListener("error",Sp),(i=s.parentNode)===null||i===void 0||i.removeChild(s),s=EP(t)}}Ap=w1e(n,r),Sp=b1e(r),s.addEventListener("load",Ap),s.addEventListener("error",Sp)}catch(l){r(l);return}}),Pf.catch(function(n){return Pf=null,Promise.reject(n)}))},j1e=function(t,n,r){if(t===null)return null;var s=t.apply(void 0,n);return v1e(s,r),s},If,fD=!1,hD=function(){return If||(If=N1e(null).catch(function(t){return If=null,Promise.reject(t)}),If)};Promise.resolve().then(function(){return hD()}).catch(function(e){fD||console.warn(e)});var _1e=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];fD=!0;var s=Date.now();return hD().then(function(i){return j1e(i,n,s)})},mD={exports:{}},S1e="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",A1e=S1e,k1e=A1e;function pD(){}function gD(){}gD.resetWarningCache=pD;var E1e=function(){function e(r,s,i,l,a,c){if(c!==k1e){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}e.isRequired=e;function t(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:gD,resetWarningCache:pD};return n.PropTypes=n,n};mD.exports=E1e();var C1e=mD.exports;const dr=n0(C1e);function CP(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function PP(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?CP(Object(n),!0).forEach(function(r){xD(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):CP(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function Zp(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Zp=function(t){return typeof t}:Zp=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Zp(e)}function xD(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function yD(e,t){return P1e(e)||I1e(e,t)||T1e(e,t)||L1e()}function P1e(e){if(Array.isArray(e))return e}function I1e(e,t){var n=e&&(typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"]);if(n!=null){var r=[],s=!0,i=!1,l,a;try{for(n=n.call(e);!(s=(l=n.next()).done)&&(r.push(l.value),!(t&&r.length===t));s=!0);}catch(c){i=!0,a=c}finally{try{!s&&n.return!=null&&n.return()}finally{if(i)throw a}}return r}}function T1e(e,t){if(e){if(typeof e=="string")return IP(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return IP(e,t)}}function IP(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function L1e(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var hi=function(t,n,r){var s=!!r,i=be.useRef(r);be.useEffect(function(){i.current=r},[r]),be.useEffect(function(){if(!s||!t)return function(){};var l=function(){i.current&&i.current.apply(i,arguments)};return t.on(n,l),function(){t.off(n,l)}},[s,n,t,i])},ZN=function(t){var n=be.useRef(t);return be.useEffect(function(){n.current=t},[t]),n.current},md=function(t){return t!==null&&Zp(t)==="object"},M1e=function(t){return md(t)&&typeof t.then=="function"},R1e=function(t){return md(t)&&typeof t.elements=="function"&&typeof t.createToken=="function"&&typeof t.createPaymentMethod=="function"&&typeof t.confirmCardPayment=="function"},TP="[object Object]",$1e=function e(t,n){if(!md(t)||!md(n))return t===n;var r=Array.isArray(t),s=Array.isArray(n);if(r!==s)return!1;var i=Object.prototype.toString.call(t)===TP,l=Object.prototype.toString.call(n)===TP;if(i!==l)return!1;if(!i&&!r)return t===n;var a=Object.keys(t),c=Object.keys(n);if(a.length!==c.length)return!1;for(var d={},u=0;u<a.length;u+=1)d[a[u]]=!0;for(var f=0;f<c.length;f+=1)d[c[f]]=!0;var m=Object.keys(d);if(m.length!==a.length)return!1;var h=t,g=n,y=function(x){return e(h[x],g[x])};return m.every(y)},vD=function(t,n,r){return md(t)?Object.keys(t).reduce(function(s,i){var l=!md(n)||!$1e(t[i],n[i]);return r.includes(i)?(l&&console.warn("Unsupported prop change: options.".concat(i," is not a mutable property.")),s):l?PP(PP({},s||{}),{},xD({},i,t[i])):s},null):null},bD="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",LP=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:bD;if(t===null||R1e(t))return t;throw new Error(n)},O1e=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:bD;if(M1e(t))return{tag:"async",stripePromise:Promise.resolve(t).then(function(s){return LP(s,n)})};var r=LP(t,n);return r===null?{tag:"empty"}:{tag:"sync",stripe:r}},F1e=function(t){!t||!t._registerWrapper||!t.registerAppInfo||(t._registerWrapper({name:"react-stripe-js",version:"2.8.1"}),t.registerAppInfo({name:"react-stripe-js",version:"2.8.1",url:"https://stripe.com/docs/stripe-js/react"}))},E1=be.createContext(null);E1.displayName="ElementsContext";var wD=function(t,n){if(!t)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(n," in an <Elements> provider."));return t},ND=function(t){var n=t.stripe,r=t.options,s=t.children,i=be.useMemo(function(){return O1e(n)},[n]),l=be.useState(function(){return{stripe:i.tag==="sync"?i.stripe:null,elements:i.tag==="sync"?i.stripe.elements(r):null}}),a=yD(l,2),c=a[0],d=a[1];be.useEffect(function(){var m=!0,h=function(y){d(function(p){return p.stripe?p:{stripe:y,elements:y.elements(r)}})};return i.tag==="async"&&!c.stripe?i.stripePromise.then(function(g){g&&m&&h(g)}):i.tag==="sync"&&!c.stripe&&h(i.stripe),function(){m=!1}},[i,c,r]);var u=ZN(n);be.useEffect(function(){u!==null&&u!==n&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")},[u,n]);var f=ZN(r);return be.useEffect(function(){if(c.elements){var m=vD(r,f,["clientSecret","fonts"]);m&&c.elements.update(m)}},[r,f,c.elements]),be.useEffect(function(){F1e(c.stripe)},[c.stripe]),be.createElement(E1.Provider,{value:c},s)};ND.propTypes={stripe:dr.any,options:dr.object};var D1e=function(t){var n=be.useContext(E1);return wD(n,t)},q1e=function(){var t=D1e("calls useElements()"),n=t.elements;return n};dr.func.isRequired;var jD=be.createContext(null);jD.displayName="CustomCheckoutSdkContext";var B1e=function(t,n){if(!t)throw new Error("Could not find CustomCheckoutProvider context; You need to wrap the part of your app that ".concat(n," in an <CustomCheckoutProvider> provider."));return t},z1e=be.createContext(null);z1e.displayName="CustomCheckoutContext";dr.any,dr.shape({clientSecret:dr.string.isRequired,elementsOptions:dr.object}).isRequired;var QN=function(t){var n=be.useContext(jD),r=be.useContext(E1);if(n&&r)throw new Error("You cannot wrap the part of your app that ".concat(t," in both <CustomCheckoutProvider> and <Elements> providers."));return n?B1e(n,t):wD(r,t)},U1e=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},Ur=function(t,n){var r="".concat(U1e(t),"Element"),s=function(c){var d=c.id,u=c.className,f=c.options,m=f===void 0?{}:f,h=c.onBlur,g=c.onFocus,y=c.onReady,p=c.onChange,x=c.onEscape,b=c.onClick,w=c.onLoadError,N=c.onLoaderStart,k=c.onNetworksChange,I=c.onConfirm,R=c.onCancel,T=c.onShippingAddressChange,S=c.onShippingRateChange,E=QN("mounts <".concat(r,">")),_="elements"in E?E.elements:null,M="customCheckoutSdk"in E?E.customCheckoutSdk:null,A=be.useState(null),P=yD(A,2),B=P[0],L=P[1],D=be.useRef(null),V=be.useRef(null);hi(B,"blur",h),hi(B,"focus",g),hi(B,"escape",x),hi(B,"click",b),hi(B,"loaderror",w),hi(B,"loaderstart",N),hi(B,"networkschange",k),hi(B,"confirm",I),hi(B,"cancel",R),hi(B,"shippingaddresschange",T),hi(B,"shippingratechange",S),hi(B,"change",p);var O;y&&(t==="expressCheckout"?O=y:O=function(){y(B)}),hi(B,"ready",O),be.useLayoutEffect(function(){if(D.current===null&&V.current!==null&&(_||M)){var W=null;M?W=M.createElement(t,m):_&&(W=_.create(t,m)),D.current=W,L(W),W&&W.mount(V.current)}},[_,M,m]);var H=ZN(m);return be.useEffect(function(){if(D.current){var W=vD(m,H,["paymentRequest"]);W&&"update"in D.current&&D.current.update(W)}},[m,H]),be.useLayoutEffect(function(){return function(){if(D.current&&typeof D.current.destroy=="function")try{D.current.destroy(),D.current=null}catch{}}},[]),be.createElement("div",{id:d,className:u,ref:V})},i=function(c){QN("mounts <".concat(r,">"));var d=c.id,u=c.className;return be.createElement("div",{id:d,className:u})},l=n?i:s;return l.propTypes={id:dr.string,className:dr.string,onChange:dr.func,onBlur:dr.func,onFocus:dr.func,onReady:dr.func,onEscape:dr.func,onClick:dr.func,onLoadError:dr.func,onLoaderStart:dr.func,onNetworksChange:dr.func,onConfirm:dr.func,onCancel:dr.func,onShippingAddressChange:dr.func,onShippingRateChange:dr.func,options:dr.object},l.displayName=r,l.__elementType=t,l},Hr=typeof window>"u",H1e=be.createContext(null);H1e.displayName="EmbeddedCheckoutProviderContext";var V1e=function(){var t=QN("calls useStripe()"),n=t.stripe;return n};Ur("auBankAccount",Hr);var MP=Ur("card",Hr);Ur("cardNumber",Hr);Ur("cardExpiry",Hr);Ur("cardCvc",Hr);Ur("fpxBank",Hr);Ur("iban",Hr);Ur("idealBank",Hr);Ur("p24Bank",Hr);Ur("epsBank",Hr);Ur("payment",Hr);Ur("expressCheckout",Hr);Ur("currencySelector",Hr);Ur("paymentRequestButton",Hr);Ur("linkAuthentication",Hr);Ur("address",Hr);Ur("shippingAddress",Hr);Ur("paymentMethodMessaging",Hr);Ur("affirmMessage",Hr);Ur("afterpayClearpayMessage",Hr);const W1e=_1e("pk_live_51S6EXD5qoy7m34J1ssDHcQOn3qgDqmoZrfb6qI2Mjbtn5qagd5T3h8CXWsWdvFkFbpKkhyg3qeAMSc5izbzsISVd004l89jmyc"),m5=(e,t)=>{try{const r=e*({USD:1,AED:3.67,EGP:30.9,SAR:3.75}[t]||1);return new Intl.NumberFormat("en-US",{style:"currency",currency:t}).format(r)}catch{return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e)}},G1e=({plan:e,userEmail:t,selectedPaymentMethod:n,selectedCurrency:r,formatPrice:s,onPaymentComplete:i,onPaymentError:l})=>{const a=V1e(),c=q1e(),{language:d}=Ft(),[u,f]=J.useState(!1),[m,h]=J.useState(""),[g,y]=J.useState(""),p=async b=>{var w;if(b.preventDefault(),!a||!c){h(d==="ar"?" Stripe     ":" Stripe not loaded properly");return}if(!g){h(d==="ar"?"   ":" Please enter your name");return}f(!0),h("");try{const N={email:t,productId:e.productId,currency:r};let k;if(n==="recurring"?k=await Bh.createSubscription(N):k=await Bh.createOneTimePayment(N),!k||!k.clientSecret&&!k.url)throw new Error(d==="ar"?"   ":"Failed to create payment");if(k.url||k.Url){window.location.href=k.url||k.Url;return}const I=k.clientSecret,R=c.getElement(MP);if(!I||!R)throw new Error(d==="ar"?"   ":" Missing payment details");const T=await a.confirmCardPayment(I,{payment_method:{card:R,billing_details:{name:g,email:t}}});if(T.error)throw new Error(T.error.message||(d==="ar"?" ":"Payment failed"));((w=T.paymentIntent)==null?void 0:w.status)==="succeeded"&&(h(d==="ar"?"   !":" Payment succeeded!"),i())}catch(N){console.error("Payment error:",N);const k=N.message||(d==="ar"?"   ":"An unexpected error occurred");h(` ${k}`),l(k)}finally{f(!1)}},x={style:{base:{fontSize:"16px",color:"#424770","::placeholder":{color:"#aab7c4"}},invalid:{color:"#9e2146"}}};return o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-foreground",children:d==="ar"?"  ":"Name on Card"}),o.jsx(Bt,{id:"name",type:"text",value:g,onChange:b=>y(b.target.value),placeholder:d==="ar"?" ":"Full Name",required:!0})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{htmlFor:"card",className:"block text-sm font-medium text-foreground",children:d==="ar"?" ":"Card Information"}),o.jsx("div",{className:"border rounded-md p-3 bg-card",children:o.jsx(MP,{options:x})})]})]}),m&&o.jsx("div",{className:`p-3 rounded-md text-center ${m.includes("")?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-100":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-100"}`,children:m}),o.jsx("div",{className:"space-y-3",children:o.jsx(ye,{onClick:p,disabled:!a||u,className:"w-full",children:u?d==="ar"?" ...":"Processing...":`${d==="ar"?"":"Pay"} ${s(e.price,r)}`})})]})},Y1e=()=>{const e=jr(),t=e3(),{productId:n}=pd(),{userEmail:r,isAuthenticated:s,isLoading:i}=uD(),{language:l}=Ft(),a=t.state,[c,d]=J.useState((a==null?void 0:a.plan)||null),[u,f]=J.useState(null),[m,h]=J.useState("USD"),[g,y]=J.useState(!(a!=null&&a.plan)),[p,x]=J.useState(null);if(i)return o.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})});if(!s)return o.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:o.jsxs(et,{className:"max-w-md w-full mx-4",children:[o.jsx(ht,{children:o.jsx(gt,{children:l==="ar"?"  ":"Login Required"})}),o.jsxs(rt,{children:[o.jsx("p",{className:"text-muted-foreground",children:l==="ar"?"     ":"Please log in to complete payment"}),o.jsx(ye,{onClick:()=>e("/login"),className:"w-full mt-4",children:l==="ar"?" ":"Login"})]})]})});J.useEffect(()=>{(async()=>{if(n&&!c)try{y(!0);const R=(await Bh.getAllPlans()).find(T=>T.productId===n);R?d(R):x(l==="ar"?"  ":"Plan not found")}catch(I){console.error("Error fetching plan:",I),x(l==="ar"?"   ":"Failed to load plan")}finally{y(!1)}})()},[n,c,l]);const b=()=>{e("/subscription/success")},w=k=>{console.error("Payment error:",k)},N=async(k,I)=>{k.preventDefault(),f(I?"recurring":"one-time")};return g?o.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:o.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):p||!c?o.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:o.jsxs(et,{className:"max-w-md w-full mx-4",children:[o.jsx(ht,{children:o.jsx(gt,{className:"text-destructive",children:l==="ar"?"":"Error"})}),o.jsxs(rt,{children:[o.jsx("p",{className:"text-muted-foreground",children:p||(l==="ar"?"  ":"Plan not available")}),o.jsx(ye,{onClick:()=>e("/subscription"),className:"w-full mt-4",children:l==="ar"?"  ":"Back to Plans"})]})]})}):o.jsx("div",{className:"min-h-screen bg-background py-12",children:o.jsxs("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8",children:[o.jsxs("div",{className:"text-center mb-8",children:[o.jsx("h1",{className:"text-3xl font-bold text-foreground",children:l==="ar"?" ":"Complete Payment"}),o.jsx("p",{className:"mt-2 text-muted-foreground",children:l==="ar"?"     ":"Please enter your payment information"})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[o.jsxs(et,{children:[o.jsx(ht,{children:o.jsx(gt,{children:l==="ar"?" ":"Order Summary"})}),o.jsxs(rt,{className:"space-y-4",children:[o.jsxs("div",{className:"flex justify-between items-center",children:[o.jsxs("div",{children:[o.jsx("h3",{className:"font-medium text-foreground",children:c.name}),o.jsx("p",{className:"text-sm text-muted-foreground",children:c.billingCycle==="year"?l==="ar"?" ":"Yearly Subscription":l==="ar"?" ":"Monthly Subscription"})]}),o.jsxs("div",{className:"text-right",children:[o.jsx("p",{className:"font-medium text-foreground",children:m5(c.price,m)}),o.jsx("p",{className:"text-sm text-muted-foreground",children:m})]})]}),o.jsx("div",{className:"border-t border-border pt-4",children:o.jsxs("div",{className:"flex justify-between",children:[o.jsx("p",{className:"font-medium text-foreground",children:l==="ar"?"":"Total"}),o.jsx("p",{className:"font-medium text-foreground",children:m5(c.price,m)})]})})]})]}),o.jsxs(et,{children:[o.jsxs(ht,{children:[o.jsx(gt,{children:l==="ar"?" ":"Payment Information"}),o.jsx(qr,{children:l==="ar"?"   ":"Enter your credit card information"})]}),o.jsxs(rt,{children:[o.jsxs("div",{className:"space-y-4",children:[o.jsx("div",{className:"text-center",children:o.jsx("h3",{className:"text-lg font-medium text-gray-900",children:l==="ar"?"  ":"Choose Payment Method"})}),o.jsxs("div",{className:"flex items-center space-x-4",children:[o.jsx("label",{htmlFor:"currency",className:"text-sm font-medium text-gray-700",children:l==="ar"?":":"Currency:"}),o.jsxs("select",{id:"currency",value:m,onChange:k=>h(k.target.value),className:"border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[o.jsxs("option",{value:"USD",children:[l==="ar"?" ":"US Dollar"," (USD)"]}),o.jsxs("option",{value:"AED",children:[l==="ar"?" ":"UAE Dirham"," (AED)"]}),o.jsxs("option",{value:"EGP",children:[l==="ar"?" ":"Egyptian Pound"," (EGP)"]}),o.jsxs("option",{value:"SAR",children:[l==="ar"?" ":"Saudi Riyal"," (SAR)"]})]})]}),o.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[o.jsx(ye,{onClick:k=>N(k,!1),className:`w-full py-6 ${u==="one-time"?"ring-2 ring-blue-500":""}`,children:o.jsxs("div",{className:"flex flex-col items-center",children:[o.jsx("span",{className:"font-semibold text-lg",children:l==="ar"?" ":"One-time Payment"}),o.jsx("span",{className:"text-sm opacity-80",children:l==="ar"?"  ":"No auto-renewal"})]})}),o.jsx(ye,{onClick:k=>N(k,!0),variant:"outline",className:`w-full py-6 ${u==="recurring"?"ring-2 ring-blue-500":""}`,children:o.jsxs("div",{className:"flex flex-col items-center",children:[o.jsx("span",{className:"font-semibold text-lg",children:c.billingCycle==="year"?l==="ar"?"  ":"Annual Auto-renewal":l==="ar"?"  ":"Monthly Auto-renewal"}),o.jsx("span",{className:"text-sm opacity-80",children:c.billingCycle==="year"?l==="ar"?"   ":"Auto-renewal every year":l==="ar"?"   ":"Auto-renewal every month"})]})})]})]}),u&&o.jsxs("div",{className:"mt-8",children:[o.jsxs("div",{className:"flex justify-between items-center mb-4",children:[o.jsx("h4",{className:"text-md font-medium text-gray-900",children:l==="ar"?" ":"Card Information"}),o.jsx("div",{className:"text-sm text-gray-500",children:u==="recurring"?l==="ar"?" ":"Auto-renewal":l==="ar"?" ":"One-time payment"})]}),o.jsx(ND,{stripe:W1e,children:o.jsx(G1e,{plan:c,userEmail:r||"",selectedPaymentMethod:u,selectedCurrency:m,formatPrice:m5,onPaymentComplete:b,onPaymentError:w})})]})]})]})]})]})})},X1e=()=>{const e=jr(),{language:t}=Ft();return o.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:o.jsxs(et,{className:"max-w-md w-full mx-auto",children:[o.jsxs(ht,{className:"text-center",children:[o.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100 dark:bg-green-900",children:o.jsx(vi,{className:"h-6 w-6 text-green-600 dark:text-green-400"})}),o.jsx(gt,{className:"text-2xl",children:t==="ar"?"  !":"Payment Successful!"}),o.jsx(qr,{children:t==="ar"?"  ":"Thank you for your subscription"})]}),o.jsxs(rt,{className:"space-y-6",children:[o.jsx("div",{className:"text-center",children:o.jsx("p",{className:"text-muted-foreground",children:t==="ar"?"   .        .":"Your payment has been successfully confirmed. You now have access to all features of your chosen plan."})}),o.jsx("div",{className:"bg-green-50 border border-green-200 rounded-md p-4 dark:bg-green-900/20 dark:border-green-800",children:o.jsxs("div",{className:"flex",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx(vi,{className:"h-5 w-5 text-green-400 dark:text-green-500"})}),o.jsxs("div",{className:"ml-3",children:[o.jsx("h3",{className:"text-sm font-medium text-green-800 dark:text-green-200",children:t==="ar"?" ":"What's next?"}),o.jsx("div",{className:"mt-2 text-sm text-green-700 dark:text-green-300",children:o.jsxs("ul",{className:"list-disc space-y-1 pl-5",children:[o.jsx("li",{children:t==="ar"?"     ":"You can now create your family trees"}),o.jsx("li",{children:t==="ar"?"    ":"You can invite family members to collaborate"}),o.jsx("li",{children:t==="ar"?"     ":"You have access to all premium features"})]})})]})]})}),o.jsxs("div",{className:"flex flex-col space-y-3",children:[o.jsx(ye,{asChild:!0,children:o.jsx(_t,{to:"/dashboard",children:t==="ar"?"   ":"Go to Dashboard"})}),o.jsx(ye,{variant:"outline",onClick:()=>e("/subscription"),children:t==="ar"?"  ":"View Subscription Plans"})]})]})]})})},K1e=()=>{const e=jr(),{language:t}=Ft();return o.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:o.jsxs(et,{className:"max-w-md w-full mx-auto",children:[o.jsxs(ht,{className:"text-center",children:[o.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 dark:bg-red-900/20",children:o.jsx(sg,{className:"h-6 w-6 text-red-600 dark:text-red-400"})}),o.jsx(gt,{className:"text-2xl",children:t==="ar"?"  ":"Payment Cancelled"}),o.jsx(qr,{children:t==="ar"?"   ":"Your payment was cancelled"})]}),o.jsxs(rt,{className:"space-y-6",children:[o.jsx("div",{className:"text-center",children:o.jsx("p",{className:"text-muted-foreground",children:t==="ar"?"    .       .":"Your payment was not completed. You can try again when you're ready."})}),o.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-4 dark:bg-yellow-900/20 dark:border-yellow-800",children:o.jsxs("div",{className:"flex",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx(sg,{className:"h-5 w-5 text-yellow-400 dark:text-yellow-500"})}),o.jsxs("div",{className:"ml-3",children:[o.jsx("h3",{className:"text-sm font-medium text-yellow-800 dark:text-yellow-200",children:t==="ar"?"  ":"Need help?"}),o.jsx("div",{className:"mt-2 text-sm text-yellow-700 dark:text-yellow-300",children:o.jsx("p",{children:t==="ar"?"            .":"If you're having trouble completing payment, please contact our support team."})})]})]})}),o.jsxs("div",{className:"flex flex-col space-y-3",children:[o.jsx(ye,{onClick:()=>e("/subscription"),children:t==="ar"?"  ":"Try Again"}),o.jsx(ye,{variant:"outline",asChild:!0,children:o.jsx(_t,{to:"/support",children:t==="ar"?" ":"Contact Support"})})]})]})]})})},J1e=()=>{const{language:e}=Ft();return o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background px-4",children:o.jsxs("div",{className:"max-w-md w-full text-center",children:[o.jsxs("div",{className:"mb-8",children:[o.jsx("div",{className:"mx-auto w-32 h-32 bg-primary/10 rounded-full flex items-center justify-center mb-6",children:o.jsx("svg",{className:"w-16 h-16 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.172 16.172a4 4 0 015.656 0M9 12h6m-6-4h6m2 5.291A7.962 7.962 0 0112 15c-2.34 0-4.291-1.007-5.691-2.709M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})})}),o.jsx("h1",{className:"text-6xl font-bold text-primary mb-4",children:"404"})]}),o.jsxs("div",{className:"mb-8",children:[o.jsx("h2",{className:"text-2xl font-semibold text-foreground mb-4",children:e==="ar"?"  ":"Page Not Found"}),o.jsx("p",{className:"text-muted-foreground mb-6",children:e==="ar"?"            .":"Sorry, the page you're looking for doesn't exist or has been moved to another location."})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsx(ye,{asChild:!0,className:"w-full",children:o.jsxs(_t,{to:"/",children:[o.jsx(m0,{className:"w-4 h-4 mr-2"}),e==="ar"?" ":"Go Home"]})}),o.jsx(ye,{asChild:!0,variant:"outline",className:"w-full",children:o.jsxs(_t,{to:"#",onClick:()=>window.history.back(),children:[o.jsx(fl,{className:"w-4 h-4 mr-2"}),e==="ar"?" ":"Go Back"]})})]}),o.jsx("div",{className:"mt-8 pt-8 border-t border-border",children:o.jsxs("p",{className:"text-sm text-muted-foreground",children:[e==="ar"?"       ":"If you think this is an error, please ",o.jsx(_t,{to:"/contact",className:"text-primary hover:text-primary/80 underline",children:e==="ar"?" ":"contact us"}),"."]})})]})})},jj=()=>o.jsx("div",{className:"min-h-screen bg-background",children:o.jsxs("div",{className:"lg:pl-72",children:[o.jsxs("div",{className:"sticky top-0 z-40 flex h-16 shrink-0 items-center gap-x-4 border-b border-border bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 px-4 shadow-sm sm:gap-x-6 sm:px-6 lg:px-8",children:[o.jsx("div",{className:"flex flex-1"}),o.jsx("div",{className:"flex items-center gap-x-4 lg:gap-x-6",children:o.jsx("div",{className:"relative",children:o.jsxs("div",{className:"flex items-center space-x-3",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx("div",{className:"h-8 w-8 rounded-full bg-muted animate-pulse"})}),o.jsxs("div",{className:"hidden lg:block",children:[o.jsx("div",{className:"h-4 w-20 bg-muted rounded animate-pulse mb-1"}),o.jsx("div",{className:"h-3 w-16 bg-muted rounded animate-pulse"})]})]})})})]}),o.jsx("main",{className:"py-6",children:o.jsx("div",{className:"px-4 sm:px-6 lg:px-8",children:o.jsxs("div",{className:"space-y-8",children:[o.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[o.jsxs("div",{children:[o.jsx("div",{className:"h-8 w-48 bg-muted rounded animate-pulse mb-2"}),o.jsx("div",{className:"h-4 w-64 bg-muted rounded animate-pulse"})]}),o.jsx("div",{className:"mt-4 sm:mt-0",children:o.jsx("div",{className:"h-10 w-32 bg-muted rounded animate-pulse"})})]}),o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:[...Array(4)].map((e,t)=>o.jsxs("div",{className:"rounded-lg border bg-card text-card-foreground shadow-sm p-6",children:[o.jsxs("div",{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[o.jsx("div",{className:"h-4 w-24 bg-muted rounded animate-pulse"}),o.jsx("div",{className:"h-4 w-4 bg-muted rounded-full animate-pulse"})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("div",{className:"h-6 w-8 bg-muted rounded animate-pulse"}),o.jsx("div",{className:"h-3 w-16 bg-muted rounded animate-pulse"})]})]},t))}),o.jsxs("div",{children:[o.jsx("div",{className:"h-6 w-32 bg-muted rounded animate-pulse mb-4"}),o.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[...Array(4)].map((e,t)=>o.jsx("div",{className:"rounded-lg border bg-card text-card-foreground shadow-sm h-24 p-4",children:o.jsxs("div",{className:"space-y-3",children:[o.jsx("div",{className:"h-6 w-6 bg-muted rounded animate-pulse"}),o.jsx("div",{className:"h-4 w-20 bg-muted rounded animate-pulse"}),o.jsx("div",{className:"h-3 w-16 bg-muted rounded animate-pulse"})]})},t))})]}),o.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[o.jsx("div",{className:"rounded-lg border bg-card text-card-foreground shadow-sm",children:o.jsxs("div",{className:"p-6",children:[o.jsx("div",{className:"h-5 w-32 bg-muted rounded animate-pulse mb-4"}),o.jsx("div",{className:"space-y-4",children:[...Array(3)].map((e,t)=>o.jsxs("div",{className:"flex items-start space-x-3",children:[o.jsx("div",{className:"flex-shrink-0",children:o.jsx("div",{className:"w-8 h-8 bg-muted rounded-full animate-pulse"})}),o.jsxs("div",{className:"flex-1 min-w-0 space-y-2",children:[o.jsx("div",{className:"h-4 w-48 bg-muted rounded animate-pulse"}),o.jsx("div",{className:"h-3 w-20 bg-muted rounded animate-pulse"})]})]},t))})]})}),o.jsx("div",{className:"rounded-lg border bg-card text-card-foreground shadow-sm",children:o.jsxs("div",{className:"p-6",children:[o.jsx("div",{className:"h-5 w-32 bg-muted rounded animate-pulse mb-4"}),o.jsx("div",{className:"space-y-4",children:[...Array(3)].map((e,t)=>o.jsxs("div",{className:"flex items-start justify-between p-3 bg-muted/30 rounded-lg",children:[o.jsxs("div",{className:"flex-1 space-y-2",children:[o.jsx("div",{className:"h-4 w-32 bg-muted rounded animate-pulse"}),o.jsx("div",{className:"h-3 w-40 bg-muted rounded animate-pulse"})]}),o.jsx("div",{className:"h-6 w-6 bg-muted rounded animate-pulse"})]},t))})]})})]})]})})})]})}),Z1e=({onCancel:e,onSuccess:t})=>{const n=jr(),{language:r}=Ft(),{createTree:s,isLoading:i,trees:l}=As(),{limits:a,isLimitReached:c}=Oc(),d=J.useRef(null),{isMobile:u}=_r(),f=r==="ar",[m,h]=J.useState({name:"",nameEn:"",description:"",descriptionEn:"",isPublic:!0,allowCollaboration:!1}),[g,y]=J.useState(null),p=c("trees",l.length),x=N=>{var I;const k=(I=N.target.files)==null?void 0:I[0];if(k){const R=new FileReader;R.onload=T=>{var E;const S=(E=T.target)==null?void 0:E.result;h(_=>({..._,coverImage:S}))},R.readAsDataURL(k)}},b=async()=>{var N,k;try{if(y(null),p){const R=(a==null?void 0:a.trees)||1,T=f?`       (${R} ).     .`:`You've reached the maximum number of trees (${R} trees). Please upgrade your subscription to create more.`;y(T),tn.error({en:T,ar:T});return}const I=await At.createTree(f?m.name:m.nameEn,!m.isPublic,f?m.description||"":m.descriptionEn||"");tn.success({en:"Tree created successfully",ar:"   "}),t?t(I.id):n(`/trees/${I.id}`)}catch(I){let R=f?"   ":"Failed to create tree";if(I.response)if(I.response.status===400)if((N=I.response.data)!=null&&N.message){const T=I.response.data.message.toLowerCase();T.includes("duplicate")||T.includes("already exists")||T.includes("in use")||T.includes("unique")?R=f?"   .    .":"Tree name is already in use. Please choose a different name.":R+=`: ${I.response.data.message}`}else R=f?"  .     .":"Invalid request. Please check the entered information.";else(k=I.response.data)!=null&&k.message&&(R+=`: ${I.response.data.message}`);else I.message&&(R+=`: ${I.message}`);y(R),tn.error({en:R,ar:R})}},w=()=>m.name.trim()!==""&&m.nameEn.trim()!=="";return o.jsxs("div",{className:"space-y-6",children:[g&&o.jsx("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-3",children:o.jsxs("div",{className:"flex items-start gap-2",children:[o.jsx(No,{className:"h-5 w-5 text-destructive flex-shrink-0 mt-0.5"}),o.jsx("p",{className:"text-destructive text-sm",children:g})]})}),o.jsxs(et,{children:[o.jsx(ht,{children:o.jsxs(gt,{className:"flex items-center gap-2",children:[o.jsx(Wu,{className:"h-5 w-5"}),u?f?"":"Info":f?" ":"Tree Information"]})}),o.jsxs(rt,{className:"space-y-6",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-sm font-medium",children:u?f?"":"Image":f?" ":"Cover Image"}),o.jsxs("div",{className:"relative",children:[o.jsx("div",{className:`w-full rounded-lg bg-gradient-to-br from-primary/20 to-primary/40 flex items-center justify-center overflow-hidden ${u?"h-32":"h-48"}`,children:m.coverImage?o.jsx("img",{src:m.coverImage,alt:"Tree Cover",className:"w-full h-full object-cover"}):o.jsxs("div",{className:"text-center",children:[o.jsx(qn,{className:`mx-auto mb-2 ${u?"h-8 w-8":"h-16 w-16"}`}),o.jsx("p",{className:"text-sm text-muted-foreground",children:u?f?" ":"Choose Image":f?"   ":"Choose a cover image for the tree"})]})}),o.jsxs(ye,{size:u?"sm":"default",variant:"outline",className:`absolute bottom-2 right-2 flex items-center gap-2 ${u?"px-2 py-1 text-xs":""}`,onClick:()=>{var N;return(N=d.current)==null?void 0:N.click()},children:[o.jsx(Yh,{className:`h-4 w-4 ${u?"h-3 w-3":""}`}),u?f?"":"Image":f?" ":"Choose Image"]}),o.jsx("input",{ref:d,type:"file",accept:"image/*",onChange:x,className:"hidden"})]})]}),o.jsxs("div",{className:`grid grid-cols-1 ${u?"gap-4":"md:grid-cols-2 gap-6"}`,children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-sm font-medium",children:u?f?" ()":"Name (Ar)":f?"  () *":"Tree Name (Arabic) *"}),o.jsx(Bt,{value:m.name,onChange:N=>h(k=>({...k,name:N.target.value})),placeholder:u?f?" ":"Tree Name":f?":    ":"Example: Al-Ahmed Family Tree",required:!0})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-sm font-medium",children:u?f?" ()":"Name (En)":f?"  () *":"Tree Name (English) *"}),o.jsx(Bt,{value:m.nameEn,onChange:N=>h(k=>({...k,nameEn:N.target.value})),placeholder:u?"Tree Name":"Example: Al-Ahmed Family Tree",required:!0})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-sm font-medium",children:u?f?"":"Description":f?" ":"Tree Description"}),o.jsx(kd,{value:f?m.description||"":m.descriptionEn||"",onChange:N=>h(k=>({...k,[f?"description":"descriptionEn"]:N.target.value})),placeholder:u?f?" ":"Tree Description":f?"  ...":"Write a description for the tree...",rows:u?3:4})]}),o.jsxs("div",{className:"space-y-4",children:[o.jsx("h3",{className:`font-medium ${u?"text-base":"text-lg"}`,children:u?f?"":"Settings":f?" ":"Privacy Settings"}),o.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[o.jsxs("div",{children:[o.jsx("p",{className:`font-medium ${u?"text-sm":""}`,children:u?f?"":"Public":f?" ":"Public Tree"}),o.jsx("p",{className:`text-sm text-muted-foreground ${u?"text-xs":""}`,children:f?"   ":"Everyone can view the tree"})]}),o.jsx(ye,{variant:m.isPublic?"default":"outline",size:u?"sm":"default",onClick:()=>h(N=>({...N,isPublic:!N.isPublic})),children:m.isPublic?f?"":"Public":f?"":"Private"})]}),o.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[o.jsxs("div",{children:[o.jsx("p",{className:`font-medium ${u?"text-sm":""}`,children:u?f?"":"Collab":f?" ":"Allow Collaboration"}),o.jsx("p",{className:`text-sm text-muted-foreground ${u?"text-xs":""}`,children:f?"  ":"Allow others to contribute"})]}),o.jsx(ye,{variant:m.allowCollaboration?"default":"outline",size:u?"sm":"default",onClick:()=>h(N=>({...N,allowCollaboration:!N.allowCollaboration})),children:m.allowCollaboration?f?"":"On":f?"":"Off"})]})]}),o.jsxs("div",{className:`flex ${u?"flex-col gap-2":"gap-3 pt-4"}`,children:[o.jsxs(ye,{onClick:b,className:`flex items-center gap-2 ${u?"w-full":""}`,disabled:i||!w()||p,children:[i?o.jsx(mr,{className:`animate-spin ${u?"h-3 w-3":"h-4 w-4"}`}):o.jsx(Xu,{className:`h-4 w-4 ${u?"h-3 w-3":""}`}),u?f?"":"Create":f?" ":"Create Tree"]}),o.jsx(ye,{variant:"outline",onClick:e||(()=>n("/trees")),disabled:i,className:u?"w-full":"",children:f?"":"Cancel"})]})]})]})]})},Ms=({children:e})=>{const{isAuthenticated:t,isLoading:n,user:r}=Mr(),s=e3();if(n)return o.jsx(jj,{});if(!t){const i=s.pathname+s.search;return localStorage.setItem("attemptedUrl",i),o.jsx(uh,{to:"/login",replace:!0})}return o.jsx(o.Fragment,{children:e})},kp=({children:e})=>{const{isAuthenticated:t,isLoading:n}=Mr();if(n&&!t)return o.jsx(jj,{});if(t){const s=localStorage.getItem("attemptedUrl");return s?(localStorage.removeItem("attemptedUrl"),o.jsx(uh,{to:s,replace:!0})):o.jsx(uh,{to:"/dashboard",replace:!0})}return o.jsx(o.Fragment,{children:e})},Q1e=()=>{const{isLoading:e,isAuthenticated:t,user:n}=Mr(),{language:r,theme:s}=Ft();return be.useEffect(()=>{const i=document.documentElement;i.setAttribute("lang",r),i.setAttribute("dir",r==="ar"?"rtl":"ltr"),i.classList.toggle("dark",s==="dark")},[r,s]),e?o.jsx(jj,{}):o.jsx("div",{className:"min-h-screen bg-background text-foreground",children:o.jsxs(fq,{children:[o.jsx($n,{path:"/",element:o.jsx(Ko,{children:o.jsx(cae,{})})}),o.jsx($n,{path:"/login",element:o.jsx(kp,{children:o.jsx(uf,{children:o.jsx(mae,{})})})}),o.jsx($n,{path:"/register",element:o.jsx(kp,{children:o.jsx(uf,{children:o.jsx(gae,{})})})}),o.jsx($n,{path:"/forgot-password",element:o.jsx(kp,{children:o.jsx(uf,{children:o.jsx(yae,{})})})}),o.jsx($n,{path:"/reset-password",element:o.jsx(kp,{children:o.jsx(uf,{children:o.jsx(bae,{})})})}),o.jsx($n,{path:"/verify-email",element:o.jsx(uf,{children:o.jsx(wae,{})})}),o.jsx($n,{path:"/shared/:id",element:o.jsx(V0e,{})}),o.jsx($n,{path:"/dashboard",element:o.jsx(Ms,{children:o.jsx(fs,{children:o.jsx(Sae,{})})})}),o.jsx($n,{path:"/subscription",element:o.jsx(Ms,{children:o.jsx(fs,{children:o.jsx(g1e,{})})})}),o.jsx($n,{path:"/subscription/checkout/:productId",element:o.jsx(Ms,{children:o.jsx(fs,{children:o.jsx(Y1e,{})})})}),o.jsx($n,{path:"/subscription/success",element:o.jsx(Ms,{children:o.jsx(fs,{children:o.jsx(X1e,{})})})}),o.jsx($n,{path:"/subscription/cancel",element:o.jsx(Ms,{children:o.jsx(fs,{children:o.jsx(K1e,{})})})}),o.jsx($n,{path:"/trees",element:o.jsx(Ms,{children:o.jsx(fs,{children:o.jsx(Aae,{})})})}),o.jsx($n,{path:"/trees/create",element:o.jsx(Ms,{children:o.jsx(fs,{children:o.jsx(Z1e,{})})})}),o.jsx($n,{path:"/trees/:id",element:o.jsx(Ms,{children:o.jsx(fs,{children:o.jsx(D0e,{})})})}),o.jsx($n,{path:"/trees/:id/edit",element:o.jsx(Ms,{children:o.jsx(fs,{children:o.jsx(H0e,{})})})}),o.jsx($n,{path:"/persons/create",element:o.jsx(Ms,{children:o.jsx(fs,{children:o.jsx(e$,{})})})}),o.jsx($n,{path:"/persons/:id",element:o.jsx(Ms,{children:o.jsx(fs,{children:o.jsx(W0e,{})})})}),o.jsx($n,{path:"/persons/:id/edit",element:o.jsx(Ms,{children:o.jsx(fs,{children:o.jsx(G0e,{})})})}),o.jsx($n,{path:"/search",element:o.jsx(Ms,{children:o.jsx(fs,{children:o.jsx(Y0e,{})})})}),o.jsx($n,{path:"/contact",element:o.jsx(Ko,{children:o.jsx(t1e,{})})}),o.jsx($n,{path:"/profile",element:o.jsx(Ms,{children:o.jsx(fs,{children:o.jsx(K0e,{})})})}),o.jsx($n,{path:"/settings",element:o.jsx(Ms,{children:o.jsx(fs,{children:o.jsx(X0e,{})})})}),o.jsx($n,{path:"/pricing",element:o.jsx(Ko,{children:o.jsx(p1e,{})})}),o.jsx($n,{path:"/features",element:o.jsx(Ko,{children:o.jsx(J0e,{})})}),o.jsx($n,{path:"/about",element:o.jsx(Ko,{children:o.jsx(Q0e,{})})}),o.jsx($n,{path:"/privacy",element:o.jsx(Ko,{children:o.jsx(n1e,{})})}),o.jsx($n,{path:"/terms",element:o.jsx(Ko,{children:o.jsx(r1e,{})})}),o.jsx($n,{path:"/admin/dashboard",element:o.jsx(I_,{children:o.jsx(fs,{children:o.jsx(a1e,{})})})}),o.jsx($n,{path:"/admin/join-requests",element:o.jsx(I_,{children:o.jsx(fs,{children:o.jsx(f1e,{})})})}),o.jsx($n,{path:"*",element:o.jsx(Ko,{children:o.jsx(J1e,{})})})]})})};try{Mr.getState().initialize()}catch{}const exe=new cq({defaultOptions:{queries:{staleTime:5*60*1e3,gcTime:10*60*1e3,retry:(e,t)=>{var n,r;return((n=t==null?void 0:t.response)==null?void 0:n.status)>=400&&((r=t==null?void 0:t.response)==null?void 0:r.status)<500?!1:e<3},refetchOnWindowFocus:!1},mutations:{retry:!1}}});class txe extends be.Component{constructor(t){super(t),this.state={hasError:!1}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,n){}render(){return this.state.hasError?o.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:o.jsx("div",{className:"max-w-md w-full mx-auto p-6",children:o.jsxs("div",{className:"text-center",children:[o.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-destructive/10",children:o.jsx("svg",{className:"h-6 w-6 text-destructive",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",children:o.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})})}),o.jsx("h1",{className:"mt-4 text-xl font-semibold text-foreground",children:"Something went wrong"}),o.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:"We're sorry, but something unexpected happened. Please try refreshing the page."}),o.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row gap-3 justify-center",children:[o.jsx("button",{onClick:()=>window.location.reload(),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary",children:"Refresh Page"}),o.jsx("button",{onClick:()=>this.setState({hasError:!1}),className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary",children:"Try Again"})]}),!1]})})}):this.props.children}}const nxe={duration:4e3,position:"top-right",style:{background:"hsl(var(--background))",color:"hsl(var(--foreground))",border:"1px solid hsl(var(--border))"},success:{iconTheme:{primary:"hsl(var(--primary))",secondary:"hsl(var(--primary-foreground))"}},error:{iconTheme:{primary:"hsl(var(--destructive))",secondary:"hsl(var(--destructive-foreground))"}}};"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(e=>{}).catch(e=>{})});let p5=null;const rxe=()=>{const e=document.getElementById("root");if(!e)return;const t=document.getElementById("loading");t&&t.remove(),p5||(p5=g5.createRoot(e)),p5.render(o.jsx(be.StrictMode,{children:o.jsx(txe,{children:o.jsx(uq,{client:exe,children:o.jsxs(hq,{children:[o.jsx(Q1e,{}),o.jsx(lB,{toastOptions:nxe})]})})})}))};rxe();export{Wn as _};
//# sourceMappingURL=index-DRWvWV5g.js.map
