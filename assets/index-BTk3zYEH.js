const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index.es-BW6Mx094.js","assets/vendor-BKU87Gzz.js","assets/query-BznAFzS8.js","assets/router-CUTGSJan.js","assets/forms-Csk79DIL.js","assets/d3-D8AkCXfq.js"])))=>i.map(i=>d[i]);
var RE=Object.defineProperty;var $E=(e,t,n)=>t in e?RE(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var Zn=(e,t,n)=>$E(e,typeof t!="symbol"?t+"":t,n);import{j as a,Q as FE,a as OE}from"./query-BznAFzS8.js";import{b as DE,r as Y,g as f4,a as we}from"./vendor-BKU87Gzz.js";import{u as Ir,L as It,a as G2,N as Cf,b as Y2,c as Gu,R as BE,d as Un,B as zE}from"./router-CUTGSJan.js";import{o as UE,r as qE,a as HE,b as c0,s as io,u as ih,c as WE}from"./forms-Csk79DIL.js";import{i as Wl,z as h4,s as J2,p as m4,d as VE}from"./d3-D8AkCXfq.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var ux={},$v=DE;ux.createRoot=$v.createRoot,ux.hydrateRoot=$v.hydrateRoot;let GE={data:""},YE=e=>typeof window=="object"?((e?e.querySelector("#_goober"):window._goober)||Object.assign((e||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:e||GE,JE=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,ZE=/\/\*[^]*?\*\/|  +/g,Fv=/\n+/g,Vo=(e,t)=>{let n="",r="",s="";for(let i in e){let l=e[i];i[0]=="@"?i[1]=="i"?n=i+" "+l+";":r+=i[1]=="f"?Vo(l,i):i+"{"+Vo(l,i[1]=="k"?"":t)+"}":typeof l=="object"?r+=Vo(l,t?t.replace(/([^,])+/g,o=>i.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,c=>/&/.test(c)?c.replace(/&/g,o):o?o+" "+c:c)):i):l!=null&&(i=/^--/.test(i)?i:i.replace(/[A-Z]/g,"-$&").toLowerCase(),s+=Vo.p?Vo.p(i,l):i+":"+l+";")}return n+(t&&s?t+"{"+s+"}":s)+r},Ja={},p4=e=>{if(typeof e=="object"){let t="";for(let n in e)t+=n+p4(e[n]);return t}return e},XE=(e,t,n,r,s)=>{let i=p4(e),l=Ja[i]||(Ja[i]=(c=>{let u=0,d=11;for(;u<c.length;)d=101*d+c.charCodeAt(u++)>>>0;return"go"+d})(i));if(!Ja[l]){let c=i!==e?e:(u=>{let d,f,m=[{}];for(;d=JE.exec(u.replace(ZE,""));)d[4]?m.shift():d[3]?(f=d[3].replace(Fv," ").trim(),m.unshift(m[0][f]=m[0][f]||{})):m[0][d[1]]=d[2].replace(Fv," ").trim();return m[0]})(e);Ja[l]=Vo(s?{["@keyframes "+l]:c}:c,n?"":"."+l)}let o=n&&Ja.g?Ja.g:null;return n&&(Ja.g=Ja[l]),((c,u,d,f)=>{f?u.data=u.data.replace(f,c):u.data.indexOf(c)===-1&&(u.data=d?c+u.data:u.data+c)})(Ja[l],t,r,o),l},KE=(e,t,n)=>e.reduce((r,s,i)=>{let l=t[i];if(l&&l.call){let o=l(n),c=o&&o.props&&o.props.className||/^go/.test(o)&&o;l=c?"."+c:o&&typeof o=="object"?o.props?"":Vo(o,""):o===!1?"":o}return r+s+(l??"")},"");function u0(e){let t=this||{},n=e.call?e(t.p):e;return XE(n.unshift?n.raw?KE(n,[].slice.call(arguments,1),t.p):n.reduce((r,s)=>Object.assign(r,s&&s.call?s(t.p):s),{}):n,YE(t.target),t.g,t.o,t.k)}let g4,dx,fx;u0.bind({g:1});let uo=u0.bind({k:1});function QE(e,t,n,r){Vo.p=t,g4=e,dx=n,fx=r}function al(e,t){let n=this||{};return function(){let r=arguments;function s(i,l){let o=Object.assign({},i),c=o.className||s.className;n.p=Object.assign({theme:dx&&dx()},o),n.o=/ *go\d+/.test(c),o.className=u0.apply(n,r)+(c?" "+c:"");let u=e;return e[0]&&(u=o.as||e,delete o.as),fx&&u[0]&&fx(o),g4(u,o)}return s}}var eC=e=>typeof e=="function",up=(e,t)=>eC(e)?e(t):e,tC=(()=>{let e=0;return()=>(++e).toString()})(),x4=(()=>{let e;return()=>{if(e===void 0&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),nC=20,y4=(e,t)=>{switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,nC)};case 1:return{...e,toasts:e.toasts.map(i=>i.id===t.toast.id?{...i,...t.toast}:i)};case 2:let{toast:n}=t;return y4(e,{type:e.toasts.find(i=>i.id===n.id)?1:0,toast:n});case 3:let{toastId:r}=t;return{...e,toasts:e.toasts.map(i=>i.id===r||r===void 0?{...i,dismissed:!0,visible:!1}:i)};case 4:return t.toastId===void 0?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(i=>i.id!==t.toastId)};case 5:return{...e,pausedAt:t.time};case 6:let s=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map(i=>({...i,pauseDuration:i.pauseDuration+s}))}}},Dm=[],zl={toasts:[],pausedAt:void 0},cc=e=>{zl=y4(zl,e),Dm.forEach(t=>{t(zl)})},rC={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},sC=(e={})=>{let[t,n]=Y.useState(zl),r=Y.useRef(zl);Y.useEffect(()=>(r.current!==zl&&n(zl),Dm.push(n),()=>{let i=Dm.indexOf(n);i>-1&&Dm.splice(i,1)}),[]);let s=t.toasts.map(i=>{var l,o,c;return{...e,...e[i.type],...i,removeDelay:i.removeDelay||((l=e[i.type])==null?void 0:l.removeDelay)||(e==null?void 0:e.removeDelay),duration:i.duration||((o=e[i.type])==null?void 0:o.duration)||(e==null?void 0:e.duration)||rC[i.type],style:{...e.style,...(c=e[i.type])==null?void 0:c.style,...i.style}}});return{...t,toasts:s}},iC=(e,t="blank",n)=>({createdAt:Date.now(),visible:!0,dismissed:!1,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...n,id:(n==null?void 0:n.id)||tC()}),ah=e=>(t,n)=>{let r=iC(t,e,n);return cc({type:2,toast:r}),r.id},ei=(e,t)=>ah("blank")(e,t);ei.error=ah("error");ei.success=ah("success");ei.loading=ah("loading");ei.custom=ah("custom");ei.dismiss=e=>{cc({type:3,toastId:e})};ei.remove=e=>cc({type:4,toastId:e});ei.promise=(e,t,n)=>{let r=ei.loading(t.loading,{...n,...n==null?void 0:n.loading});return typeof e=="function"&&(e=e()),e.then(s=>{let i=t.success?up(t.success,s):void 0;return i?ei.success(i,{id:r,...n,...n==null?void 0:n.success}):ei.dismiss(r),s}).catch(s=>{let i=t.error?up(t.error,s):void 0;i?ei.error(i,{id:r,...n,...n==null?void 0:n.error}):ei.dismiss(r)}),e};var aC=(e,t)=>{cc({type:1,toast:{id:e,height:t}})},oC=()=>{cc({type:5,time:Date.now()})},bf=new Map,lC=1e3,cC=(e,t=lC)=>{if(bf.has(e))return;let n=setTimeout(()=>{bf.delete(e),cc({type:4,toastId:e})},t);bf.set(e,n)},uC=e=>{let{toasts:t,pausedAt:n}=sC(e);Y.useEffect(()=>{if(n)return;let i=Date.now(),l=t.map(o=>{if(o.duration===1/0)return;let c=(o.duration||0)+o.pauseDuration-(i-o.createdAt);if(c<0){o.visible&&ei.dismiss(o.id);return}return setTimeout(()=>ei.dismiss(o.id),c)});return()=>{l.forEach(o=>o&&clearTimeout(o))}},[t,n]);let r=Y.useCallback(()=>{n&&cc({type:6,time:Date.now()})},[n]),s=Y.useCallback((i,l)=>{let{reverseOrder:o=!1,gutter:c=8,defaultPosition:u}=l||{},d=t.filter(h=>(h.position||u)===(i.position||u)&&h.height),f=d.findIndex(h=>h.id===i.id),m=d.filter((h,x)=>x<f&&h.visible).length;return d.filter(h=>h.visible).slice(...o?[m+1]:[0,m]).reduce((h,x)=>h+(x.height||0)+c,0)},[t]);return Y.useEffect(()=>{t.forEach(i=>{if(i.dismissed)cC(i.id,i.removeDelay);else{let l=bf.get(i.id);l&&(clearTimeout(l),bf.delete(i.id))}})},[t]),{toasts:t,handlers:{updateHeight:aC,startPause:oC,endPause:r,calculateOffset:s}}},dC=uo`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,fC=uo`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,hC=uo`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,mC=al("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${dC} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${fC} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${hC} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,pC=uo`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,gC=al("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${pC} 1s linear infinite;
`,xC=uo`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,yC=uo`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,bC=al("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${xC} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${yC} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,vC=al("div")`
  position: absolute;
`,wC=al("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,NC=uo`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,jC=al("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${NC} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,SC=({toast:e})=>{let{icon:t,type:n,iconTheme:r}=e;return t!==void 0?typeof t=="string"?Y.createElement(jC,null,t):t:n==="blank"?null:Y.createElement(wC,null,Y.createElement(gC,{...r}),n!=="loading"&&Y.createElement(vC,null,n==="error"?Y.createElement(mC,{...r}):Y.createElement(bC,{...r})))},_C=e=>`
0% {transform: translate3d(0,${e*-200}%,0) scale(.6); opacity:.5;}
100% {transform: translate3d(0,0,0) scale(1); opacity:1;}
`,AC=e=>`
0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}
100% {transform: translate3d(0,${e*-150}%,-1px) scale(.6); opacity:0;}
`,kC="0%{opacity:0;} 100%{opacity:1;}",EC="0%{opacity:1;} 100%{opacity:0;}",CC=al("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,PC=al("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,IC=(e,t)=>{let n=e.includes("top")?1:-1,[r,s]=x4()?[kC,EC]:[_C(n),AC(n)];return{animation:t?`${uo(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${uo(s)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}},TC=Y.memo(({toast:e,position:t,style:n,children:r})=>{let s=e.height?IC(e.position||t||"top-center",e.visible):{opacity:0},i=Y.createElement(SC,{toast:e}),l=Y.createElement(PC,{...e.ariaProps},up(e.message,e));return Y.createElement(CC,{className:e.className,style:{...s,...n,...e.style}},typeof r=="function"?r({icon:i,message:l}):Y.createElement(Y.Fragment,null,i,l))});QE(Y.createElement);var LC=({id:e,className:t,style:n,onHeightUpdate:r,children:s})=>{let i=Y.useCallback(l=>{if(l){let o=()=>{let c=l.getBoundingClientRect().height;r(e,c)};o(),new MutationObserver(o).observe(l,{subtree:!0,childList:!0,characterData:!0})}},[e,r]);return Y.createElement("div",{ref:i,className:t,style:n},s)},MC=(e,t)=>{let n=e.includes("top"),r=n?{top:0}:{bottom:0},s=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:x4()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(n?1:-1)}px)`,...r,...s}},RC=u0`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,Kh=16,$C=({reverseOrder:e,position:t="top-center",toastOptions:n,gutter:r,children:s,containerStyle:i,containerClassName:l})=>{let{toasts:o,handlers:c}=uC(n);return Y.createElement("div",{id:"_rht_toaster",style:{position:"fixed",zIndex:9999,top:Kh,left:Kh,right:Kh,bottom:Kh,pointerEvents:"none",...i},className:l,onMouseEnter:c.startPause,onMouseLeave:c.endPause},o.map(u=>{let d=u.position||t,f=c.calculateOffset(u,{reverseOrder:e,gutter:r,defaultPosition:t}),m=MC(d,f);return Y.createElement(LC,{id:u.id,key:u.id,onHeightUpdate:c.updateHeight,className:u.visible?RC:"",style:m},u.type==="custom"?up(u.message,u):s?s(u):Y.createElement(TC,{toast:u,position:d}))}))};const FC={},Ov=e=>{let t;const n=new Set,r=(d,f)=>{const m=typeof d=="function"?d(t):d;if(!Object.is(m,t)){const h=t;t=f??(typeof m!="object"||m===null)?m:Object.assign({},t,m),n.forEach(x=>x(t,h))}},s=()=>t,c={setState:r,getState:s,getInitialState:()=>u,subscribe:d=>(n.add(d),()=>n.delete(d)),destroy:()=>{(FC?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},u=t=e(r,s,c);return c},b4=e=>e?Ov(e):Ov;var v4={exports:{}},w4={},N4={exports:{}},j4={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wu=Y;function OC(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var DC=typeof Object.is=="function"?Object.is:OC,BC=wu.useState,zC=wu.useEffect,UC=wu.useLayoutEffect,qC=wu.useDebugValue;function HC(e,t){var n=t(),r=BC({inst:{value:n,getSnapshot:t}}),s=r[0].inst,i=r[1];return UC(function(){s.value=n,s.getSnapshot=t,Rg(s)&&i({inst:s})},[e,n,t]),zC(function(){return Rg(s)&&i({inst:s}),e(function(){Rg(s)&&i({inst:s})})},[e]),qC(n),n}function Rg(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!DC(e,n)}catch{return!0}}function WC(e,t){return t()}var VC=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?WC:HC;j4.useSyncExternalStore=wu.useSyncExternalStore!==void 0?wu.useSyncExternalStore:VC;N4.exports=j4;var GC=N4.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var d0=Y,YC=GC;function JC(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ZC=typeof Object.is=="function"?Object.is:JC,XC=YC.useSyncExternalStore,KC=d0.useRef,QC=d0.useEffect,eP=d0.useMemo,tP=d0.useDebugValue;w4.useSyncExternalStoreWithSelector=function(e,t,n,r,s){var i=KC(null);if(i.current===null){var l={hasValue:!1,value:null};i.current=l}else l=i.current;i=eP(function(){function c(h){if(!u){if(u=!0,d=h,h=r(h),s!==void 0&&l.hasValue){var x=l.value;if(s(x,h))return f=x}return f=h}if(x=f,ZC(d,h))return x;var y=r(h);return s!==void 0&&s(x,y)?(d=h,x):(d=h,f=y)}var u=!1,d,f,m=n===void 0?null:n;return[function(){return c(t())},m===null?void 0:function(){return c(m())}]},[t,n,r,s]);var o=XC(e,i[0],i[1]);return QC(function(){l.hasValue=!0,l.value=o},[o]),tP(o),o};v4.exports=w4;var nP=v4.exports;const S4=f4(nP),_4={},{useDebugValue:rP}=we,{useSyncExternalStoreWithSelector:sP}=S4;let Dv=!1;const iP=e=>e;function aP(e,t=iP,n){(_4?"production":void 0)!=="production"&&n&&!Dv&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Dv=!0);const r=sP(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return rP(r),r}const oP=e=>{(_4?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?b4(e):e,n=(r,s)=>aP(t,r,s);return Object.assign(n,t),n},Z2=e=>oP,Bm={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_API_BASE_URL:"https://qabael.premiumasp.net/api",VITE_APP_DESCRIPTION:"Family Tree Management Application",VITE_APP_NAME:"Nasabna",VITE_APP_VERSION:"1.0.0",VITE_DEFAULT_LANGUAGE:"en",VITE_DEFAULT_THEME:"auto",VITE_ENABLE_DEVTOOLS:"true",VITE_ENABLE_MOCK_API:"false",VITE_ENABLE_RTL:"true",VITE_FEATURE_COLLABORATION:"true",VITE_FEATURE_OFFLINE_MODE:"true",VITE_FEATURE_TREE_VISUALIZATION:"true",VITE_NODE_ENV:"production",VITE_STRIPE_PUBLISHABLE_KEY:"pk_test_your-stripe-publishable-key",VITE_SUBSCRIPTION_API_BASE_URL:"https://qabael.premiumasp.net/api"},hx=new Map,Qh=e=>{const t=hx.get(e);return t?Object.fromEntries(Object.entries(t.stores).map(([n,r])=>[n,r.getState()])):{}},lP=(e,t,n)=>{if(e===void 0)return{type:"untracked",connection:t.connect(n)};const r=hx.get(n.name);if(r)return{type:"tracked",store:e,...r};const s={connection:t.connect(n),stores:{}};return hx.set(n.name,s),{type:"tracked",store:e,...s}},cP=(e,t={})=>(n,r,s)=>{const{enabled:i,anonymousActionType:l,store:o,...c}=t;let u;try{u=(i??(Bm?"production":void 0)!=="production")&&window.__REDUX_DEVTOOLS_EXTENSION__}catch{}if(!u)return(Bm?"production":void 0)!=="production"&&i&&console.warn("[zustand devtools middleware] Please install/enable Redux devtools extension"),e(n,r,s);const{connection:d,...f}=lP(o,u,c);let m=!0;s.setState=(y,p,g)=>{const w=n(y,p);if(!m)return w;const v=g===void 0?{type:l||"anonymous"}:typeof g=="string"?{type:g}:g;return o===void 0?(d==null||d.send(v,r()),w):(d==null||d.send({...v,type:`${o}/${v.type}`},{...Qh(c.name),[o]:s.getState()}),w)};const h=(...y)=>{const p=m;m=!1,n(...y),m=p},x=e(s.setState,r,s);if(f.type==="untracked"?d==null||d.init(x):(f.stores[f.store]=s,d==null||d.init(Object.fromEntries(Object.entries(f.stores).map(([y,p])=>[y,y===f.store?x:p.getState()])))),s.dispatchFromDevtools&&typeof s.dispatch=="function"){let y=!1;const p=s.dispatch;s.dispatch=(...g)=>{(Bm?"production":void 0)!=="production"&&g[0].type==="__setState"&&!y&&(console.warn('[zustand devtools middleware] "__setState" action type is reserved to set state from the devtools. Avoid using it.'),y=!0),p(...g)}}return d.subscribe(y=>{var p;switch(y.type){case"ACTION":if(typeof y.payload!="string"){console.error("[zustand devtools middleware] Unsupported action format");return}return $g(y.payload,g=>{if(g.type==="__setState"){if(o===void 0){h(g.state);return}Object.keys(g.state).length!==1&&console.error(`
                    [zustand devtools middleware] Unsupported __setState action format. 
                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),
                    and value of this only key should be a state object. Example: { "type": "__setState", "state": { "abc123Store": { "foo": "bar" } } }
                    `);const w=g.state[o];if(w==null)return;JSON.stringify(s.getState())!==JSON.stringify(w)&&h(w);return}s.dispatchFromDevtools&&typeof s.dispatch=="function"&&s.dispatch(g)});case"DISPATCH":switch(y.payload.type){case"RESET":return h(x),o===void 0?d==null?void 0:d.init(s.getState()):d==null?void 0:d.init(Qh(c.name));case"COMMIT":if(o===void 0){d==null||d.init(s.getState());return}return d==null?void 0:d.init(Qh(c.name));case"ROLLBACK":return $g(y.state,g=>{if(o===void 0){h(g),d==null||d.init(s.getState());return}h(g[o]),d==null||d.init(Qh(c.name))});case"JUMP_TO_STATE":case"JUMP_TO_ACTION":return $g(y.state,g=>{if(o===void 0){h(g);return}JSON.stringify(s.getState())!==JSON.stringify(g[o])&&h(g[o])});case"IMPORT_STATE":{const{nextLiftedState:g}=y.payload,w=(p=g.computedStates.slice(-1)[0])==null?void 0:p.state;if(!w)return;h(o===void 0?w:w[o]),d==null||d.send(null,g);return}case"PAUSE_RECORDING":return m=!m}return}}),x},A4=cP,$g=(e,t)=>{let n;try{n=JSON.parse(e)}catch(r){console.error("[zustand devtools middleware] Could not parse the received json",r)}n!==void 0&&t(n)};function uP(e,t){let n;try{n=e()}catch{return}return{getItem:s=>{var i;const l=c=>c===null?null:JSON.parse(c,void 0),o=(i=n.getItem(s))!=null?i:null;return o instanceof Promise?o.then(l):l(o)},setItem:(s,i)=>n.setItem(s,JSON.stringify(i,void 0)),removeItem:s=>n.removeItem(s)}}const Pf=e=>t=>{try{const n=e(t);return n instanceof Promise?n:{then(r){return Pf(r)(n)},catch(r){return this}}}catch(n){return{then(r){return this},catch(r){return Pf(r)(n)}}}},dP=(e,t)=>(n,r,s)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:p=>p,version:0,merge:(p,g)=>({...g,...p}),...t},l=!1;const o=new Set,c=new Set;let u;try{u=i.getStorage()}catch{}if(!u)return e((...p)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...p)},r,s);const d=Pf(i.serialize),f=()=>{const p=i.partialize({...r()});let g;const w=d({state:p,version:i.version}).then(v=>u.setItem(i.name,v)).catch(v=>{g=v});if(g)throw g;return w},m=s.setState;s.setState=(p,g)=>{m(p,g),f()};const h=e((...p)=>{n(...p),f()},r,s);let x;const y=()=>{var p;if(!u)return;l=!1,o.forEach(w=>w(r()));const g=((p=i.onRehydrateStorage)==null?void 0:p.call(i,r()))||void 0;return Pf(u.getItem.bind(u))(i.name).then(w=>{if(w)return i.deserialize(w)}).then(w=>{if(w)if(typeof w.version=="number"&&w.version!==i.version){if(i.migrate)return i.migrate(w.state,w.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return w.state}).then(w=>{var v;return x=i.merge(w,(v=r())!=null?v:h),n(x,!0),f()}).then(()=>{g==null||g(x,void 0),l=!0,c.forEach(w=>w(x))}).catch(w=>{g==null||g(void 0,w)})};return s.persist={setOptions:p=>{i={...i,...p},p.getStorage&&(u=p.getStorage())},clearStorage:()=>{u==null||u.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>y(),hasHydrated:()=>l,onHydrate:p=>(o.add(p),()=>{o.delete(p)}),onFinishHydration:p=>(c.add(p),()=>{c.delete(p)})},y(),x||h},fP=(e,t)=>(n,r,s)=>{let i={storage:uP(()=>localStorage),partialize:y=>y,version:0,merge:(y,p)=>({...p,...y}),...t},l=!1;const o=new Set,c=new Set;let u=i.storage;if(!u)return e((...y)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),n(...y)},r,s);const d=()=>{const y=i.partialize({...r()});return u.setItem(i.name,{state:y,version:i.version})},f=s.setState;s.setState=(y,p)=>{f(y,p),d()};const m=e((...y)=>{n(...y),d()},r,s);s.getInitialState=()=>m;let h;const x=()=>{var y,p;if(!u)return;l=!1,o.forEach(w=>{var v;return w((v=r())!=null?v:m)});const g=((p=i.onRehydrateStorage)==null?void 0:p.call(i,(y=r())!=null?y:m))||void 0;return Pf(u.getItem.bind(u))(i.name).then(w=>{if(w)if(typeof w.version=="number"&&w.version!==i.version){if(i.migrate)return[!0,i.migrate(w.state,w.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,w.state];return[!1,void 0]}).then(w=>{var v;const[N,A]=w;if(h=i.merge(A,(v=r())!=null?v:m),n(h,!0),N)return d()}).then(()=>{g==null||g(h,void 0),h=r(),l=!0,c.forEach(w=>w(h))}).catch(w=>{g==null||g(void 0,w)})};return s.persist={setOptions:y=>{i={...i,...y},y.storage&&(u=y.storage)},clearStorage:()=>{u==null||u.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>x(),hasHydrated:()=>l,onHydrate:y=>(o.add(y),()=>{o.delete(y)}),onFinishHydration:y=>(c.add(y),()=>{c.delete(y)})},i.skipHydration||x(),h||m},hP=(e,t)=>"getStorage"in t||"serialize"in t||"deserialize"in t?((Bm?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),dP(e,t)):fP(e,t),X2=hP;function k4(e,t){return function(){return e.apply(t,arguments)}}const{toString:mP}=Object.prototype,{getPrototypeOf:K2}=Object,{iterator:f0,toStringTag:E4}=Symbol,h0=(e=>t=>{const n=mP.call(t);return e[n]||(e[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),la=e=>(e=e.toLowerCase(),t=>h0(t)===e),m0=e=>t=>typeof t===e,{isArray:Yu}=Array,If=m0("undefined");function oh(e){return e!==null&&!If(e)&&e.constructor!==null&&!If(e.constructor)&&ni(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const C4=la("ArrayBuffer");function pP(e){let t;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?t=ArrayBuffer.isView(e):t=e&&e.buffer&&C4(e.buffer),t}const gP=m0("string"),ni=m0("function"),P4=m0("number"),lh=e=>e!==null&&typeof e=="object",xP=e=>e===!0||e===!1,zm=e=>{if(h0(e)!=="object")return!1;const t=K2(e);return(t===null||t===Object.prototype||Object.getPrototypeOf(t)===null)&&!(E4 in e)&&!(f0 in e)},yP=e=>{if(!lh(e)||oh(e))return!1;try{return Object.keys(e).length===0&&Object.getPrototypeOf(e)===Object.prototype}catch{return!1}},bP=la("Date"),vP=la("File"),wP=la("Blob"),NP=la("FileList"),jP=e=>lh(e)&&ni(e.pipe),SP=e=>{let t;return e&&(typeof FormData=="function"&&e instanceof FormData||ni(e.append)&&((t=h0(e))==="formdata"||t==="object"&&ni(e.toString)&&e.toString()==="[object FormData]"))},_P=la("URLSearchParams"),[AP,kP,EP,CP]=["ReadableStream","Request","Response","Headers"].map(la),PP=e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function ch(e,t,{allOwnKeys:n=!1}={}){if(e===null||typeof e>"u")return;let r,s;if(typeof e!="object"&&(e=[e]),Yu(e))for(r=0,s=e.length;r<s;r++)t.call(null,e[r],r,e);else{if(oh(e))return;const i=n?Object.getOwnPropertyNames(e):Object.keys(e),l=i.length;let o;for(r=0;r<l;r++)o=i[r],t.call(null,e[o],o,e)}}function I4(e,t){if(oh(e))return null;t=t.toLowerCase();const n=Object.keys(e);let r=n.length,s;for(;r-- >0;)if(s=n[r],t===s.toLowerCase())return s;return null}const Ul=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,T4=e=>!If(e)&&e!==Ul;function mx(){const{caseless:e}=T4(this)&&this||{},t={},n=(r,s)=>{const i=e&&I4(t,s)||s;zm(t[i])&&zm(r)?t[i]=mx(t[i],r):zm(r)?t[i]=mx({},r):Yu(r)?t[i]=r.slice():t[i]=r};for(let r=0,s=arguments.length;r<s;r++)arguments[r]&&ch(arguments[r],n);return t}const IP=(e,t,n,{allOwnKeys:r}={})=>(ch(t,(s,i)=>{n&&ni(s)?e[i]=k4(s,n):e[i]=s},{allOwnKeys:r}),e),TP=e=>(e.charCodeAt(0)===65279&&(e=e.slice(1)),e),LP=(e,t,n,r)=>{e.prototype=Object.create(t.prototype,r),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),n&&Object.assign(e.prototype,n)},MP=(e,t,n,r)=>{let s,i,l;const o={};if(t=t||{},e==null)return t;do{for(s=Object.getOwnPropertyNames(e),i=s.length;i-- >0;)l=s[i],(!r||r(l,e,t))&&!o[l]&&(t[l]=e[l],o[l]=!0);e=n!==!1&&K2(e)}while(e&&(!n||n(e,t))&&e!==Object.prototype);return t},RP=(e,t,n)=>{e=String(e),(n===void 0||n>e.length)&&(n=e.length),n-=t.length;const r=e.indexOf(t,n);return r!==-1&&r===n},$P=e=>{if(!e)return null;if(Yu(e))return e;let t=e.length;if(!P4(t))return null;const n=new Array(t);for(;t-- >0;)n[t]=e[t];return n},FP=(e=>t=>e&&t instanceof e)(typeof Uint8Array<"u"&&K2(Uint8Array)),OP=(e,t)=>{const r=(e&&e[f0]).call(e);let s;for(;(s=r.next())&&!s.done;){const i=s.value;t.call(e,i[0],i[1])}},DP=(e,t)=>{let n;const r=[];for(;(n=e.exec(t))!==null;)r.push(n);return r},BP=la("HTMLFormElement"),zP=e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,r,s){return r.toUpperCase()+s}),Bv=(({hasOwnProperty:e})=>(t,n)=>e.call(t,n))(Object.prototype),UP=la("RegExp"),L4=(e,t)=>{const n=Object.getOwnPropertyDescriptors(e),r={};ch(n,(s,i)=>{let l;(l=t(s,i,e))!==!1&&(r[i]=l||s)}),Object.defineProperties(e,r)},qP=e=>{L4(e,(t,n)=>{if(ni(e)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const r=e[n];if(ni(r)){if(t.enumerable=!1,"writable"in t){t.writable=!1;return}t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},HP=(e,t)=>{const n={},r=s=>{s.forEach(i=>{n[i]=!0})};return Yu(e)?r(e):r(String(e).split(t)),n},WP=()=>{},VP=(e,t)=>e!=null&&Number.isFinite(e=+e)?e:t;function GP(e){return!!(e&&ni(e.append)&&e[E4]==="FormData"&&e[f0])}const YP=e=>{const t=new Array(10),n=(r,s)=>{if(lh(r)){if(t.indexOf(r)>=0)return;if(oh(r))return r;if(!("toJSON"in r)){t[s]=r;const i=Yu(r)?[]:{};return ch(r,(l,o)=>{const c=n(l,s+1);!If(c)&&(i[o]=c)}),t[s]=void 0,i}}return r};return n(e,0)},JP=la("AsyncFunction"),ZP=e=>e&&(lh(e)||ni(e))&&ni(e.then)&&ni(e.catch),M4=((e,t)=>e?setImmediate:t?((n,r)=>(Ul.addEventListener("message",({source:s,data:i})=>{s===Ul&&i===n&&r.length&&r.shift()()},!1),s=>{r.push(s),Ul.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",ni(Ul.postMessage)),XP=typeof queueMicrotask<"u"?queueMicrotask.bind(Ul):typeof process<"u"&&process.nextTick||M4,KP=e=>e!=null&&ni(e[f0]),Be={isArray:Yu,isArrayBuffer:C4,isBuffer:oh,isFormData:SP,isArrayBufferView:pP,isString:gP,isNumber:P4,isBoolean:xP,isObject:lh,isPlainObject:zm,isEmptyObject:yP,isReadableStream:AP,isRequest:kP,isResponse:EP,isHeaders:CP,isUndefined:If,isDate:bP,isFile:vP,isBlob:wP,isRegExp:UP,isFunction:ni,isStream:jP,isURLSearchParams:_P,isTypedArray:FP,isFileList:NP,forEach:ch,merge:mx,extend:IP,trim:PP,stripBOM:TP,inherits:LP,toFlatObject:MP,kindOf:h0,kindOfTest:la,endsWith:RP,toArray:$P,forEachEntry:OP,matchAll:DP,isHTMLForm:BP,hasOwnProperty:Bv,hasOwnProp:Bv,reduceDescriptors:L4,freezeMethods:qP,toObjectSet:HP,toCamelCase:zP,noop:WP,toFiniteNumber:VP,findKey:I4,global:Ul,isContextDefined:T4,isSpecCompliantForm:GP,toJSONObject:YP,isAsyncFn:JP,isThenable:ZP,setImmediate:M4,asap:XP,isIterable:KP};function vn(e,t,n,r,s){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=e,this.name="AxiosError",t&&(this.code=t),n&&(this.config=n),r&&(this.request=r),s&&(this.response=s,this.status=s.status?s.status:null)}Be.inherits(vn,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:Be.toJSONObject(this.config),code:this.code,status:this.status}}});const R4=vn.prototype,$4={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{$4[e]={value:e}});Object.defineProperties(vn,$4);Object.defineProperty(R4,"isAxiosError",{value:!0});vn.from=(e,t,n,r,s,i)=>{const l=Object.create(R4);return Be.toFlatObject(e,l,function(c){return c!==Error.prototype},o=>o!=="isAxiosError"),vn.call(l,e.message,t,n,r,s),l.cause=e,l.name=e.name,i&&Object.assign(l,i),l};const QP=null;function px(e){return Be.isPlainObject(e)||Be.isArray(e)}function F4(e){return Be.endsWith(e,"[]")?e.slice(0,-2):e}function zv(e,t,n){return e?e.concat(t).map(function(s,i){return s=F4(s),!n&&i?"["+s+"]":s}).join(n?".":""):t}function e9(e){return Be.isArray(e)&&!e.some(px)}const t9=Be.toFlatObject(Be,{},null,function(t){return/^is[A-Z]/.test(t)});function p0(e,t,n){if(!Be.isObject(e))throw new TypeError("target must be an object");t=t||new FormData,n=Be.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(y,p){return!Be.isUndefined(p[y])});const r=n.metaTokens,s=n.visitor||d,i=n.dots,l=n.indexes,c=(n.Blob||typeof Blob<"u"&&Blob)&&Be.isSpecCompliantForm(t);if(!Be.isFunction(s))throw new TypeError("visitor must be a function");function u(x){if(x===null)return"";if(Be.isDate(x))return x.toISOString();if(Be.isBoolean(x))return x.toString();if(!c&&Be.isBlob(x))throw new vn("Blob is not supported. Use a Buffer instead.");return Be.isArrayBuffer(x)||Be.isTypedArray(x)?c&&typeof Blob=="function"?new Blob([x]):Buffer.from(x):x}function d(x,y,p){let g=x;if(x&&!p&&typeof x=="object"){if(Be.endsWith(y,"{}"))y=r?y:y.slice(0,-2),x=JSON.stringify(x);else if(Be.isArray(x)&&e9(x)||(Be.isFileList(x)||Be.endsWith(y,"[]"))&&(g=Be.toArray(x)))return y=F4(y),g.forEach(function(v,N){!(Be.isUndefined(v)||v===null)&&t.append(l===!0?zv([y],N,i):l===null?y:y+"[]",u(v))}),!1}return px(x)?!0:(t.append(zv(p,y,i),u(x)),!1)}const f=[],m=Object.assign(t9,{defaultVisitor:d,convertValue:u,isVisitable:px});function h(x,y){if(!Be.isUndefined(x)){if(f.indexOf(x)!==-1)throw Error("Circular reference detected in "+y.join("."));f.push(x),Be.forEach(x,function(g,w){(!(Be.isUndefined(g)||g===null)&&s.call(t,g,Be.isString(w)?w.trim():w,y,m))===!0&&h(g,y?y.concat(w):[w])}),f.pop()}}if(!Be.isObject(e))throw new TypeError("data must be an object");return h(e),t}function Uv(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(r){return t[r]})}function Q2(e,t){this._pairs=[],e&&p0(e,this,t)}const O4=Q2.prototype;O4.append=function(t,n){this._pairs.push([t,n])};O4.toString=function(t){const n=t?function(r){return t.call(this,r,Uv)}:Uv;return this._pairs.map(function(s){return n(s[0])+"="+n(s[1])},"").join("&")};function n9(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function D4(e,t,n){if(!t)return e;const r=n&&n.encode||n9;Be.isFunction(n)&&(n={serialize:n});const s=n&&n.serialize;let i;if(s?i=s(t,n):i=Be.isURLSearchParams(t)?t.toString():new Q2(t,n).toString(r),i){const l=e.indexOf("#");l!==-1&&(e=e.slice(0,l)),e+=(e.indexOf("?")===-1?"?":"&")+i}return e}class qv{constructor(){this.handlers=[]}use(t,n,r){return this.handlers.push({fulfilled:t,rejected:n,synchronous:r?r.synchronous:!1,runWhen:r?r.runWhen:null}),this.handlers.length-1}eject(t){this.handlers[t]&&(this.handlers[t]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(t){Be.forEach(this.handlers,function(r){r!==null&&t(r)})}}const B4={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},r9=typeof URLSearchParams<"u"?URLSearchParams:Q2,s9=typeof FormData<"u"?FormData:null,i9=typeof Blob<"u"?Blob:null,a9={isBrowser:!0,classes:{URLSearchParams:r9,FormData:s9,Blob:i9},protocols:["http","https","file","blob","url","data"]},ey=typeof window<"u"&&typeof document<"u",gx=typeof navigator=="object"&&navigator||void 0,o9=ey&&(!gx||["ReactNative","NativeScript","NS"].indexOf(gx.product)<0),l9=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",c9=ey&&window.location.href||"http://localhost",u9=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:ey,hasStandardBrowserEnv:o9,hasStandardBrowserWebWorkerEnv:l9,navigator:gx,origin:c9},Symbol.toStringTag,{value:"Module"})),Ts={...u9,...a9};function d9(e,t){return p0(e,new Ts.classes.URLSearchParams,{visitor:function(n,r,s,i){return Ts.isNode&&Be.isBuffer(n)?(this.append(r,n.toString("base64")),!1):i.defaultVisitor.apply(this,arguments)},...t})}function f9(e){return Be.matchAll(/\w+|\[(\w*)]/g,e).map(t=>t[0]==="[]"?"":t[1]||t[0])}function h9(e){const t={},n=Object.keys(e);let r;const s=n.length;let i;for(r=0;r<s;r++)i=n[r],t[i]=e[i];return t}function z4(e){function t(n,r,s,i){let l=n[i++];if(l==="__proto__")return!0;const o=Number.isFinite(+l),c=i>=n.length;return l=!l&&Be.isArray(s)?s.length:l,c?(Be.hasOwnProp(s,l)?s[l]=[s[l],r]:s[l]=r,!o):((!s[l]||!Be.isObject(s[l]))&&(s[l]=[]),t(n,r,s[l],i)&&Be.isArray(s[l])&&(s[l]=h9(s[l])),!o)}if(Be.isFormData(e)&&Be.isFunction(e.entries)){const n={};return Be.forEachEntry(e,(r,s)=>{t(f9(r),s,n,0)}),n}return null}function m9(e,t,n){if(Be.isString(e))try{return(t||JSON.parse)(e),Be.trim(e)}catch(r){if(r.name!=="SyntaxError")throw r}return(n||JSON.stringify)(e)}const uh={transitional:B4,adapter:["xhr","http","fetch"],transformRequest:[function(t,n){const r=n.getContentType()||"",s=r.indexOf("application/json")>-1,i=Be.isObject(t);if(i&&Be.isHTMLForm(t)&&(t=new FormData(t)),Be.isFormData(t))return s?JSON.stringify(z4(t)):t;if(Be.isArrayBuffer(t)||Be.isBuffer(t)||Be.isStream(t)||Be.isFile(t)||Be.isBlob(t)||Be.isReadableStream(t))return t;if(Be.isArrayBufferView(t))return t.buffer;if(Be.isURLSearchParams(t))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),t.toString();let o;if(i){if(r.indexOf("application/x-www-form-urlencoded")>-1)return d9(t,this.formSerializer).toString();if((o=Be.isFileList(t))||r.indexOf("multipart/form-data")>-1){const c=this.env&&this.env.FormData;return p0(o?{"files[]":t}:t,c&&new c,this.formSerializer)}}return i||s?(n.setContentType("application/json",!1),m9(t)):t}],transformResponse:[function(t){const n=this.transitional||uh.transitional,r=n&&n.forcedJSONParsing,s=this.responseType==="json";if(Be.isResponse(t)||Be.isReadableStream(t))return t;if(t&&Be.isString(t)&&(r&&!this.responseType||s)){const l=!(n&&n.silentJSONParsing)&&s;try{return JSON.parse(t)}catch(o){if(l)throw o.name==="SyntaxError"?vn.from(o,vn.ERR_BAD_RESPONSE,this,null,this.response):o}}return t}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Ts.classes.FormData,Blob:Ts.classes.Blob},validateStatus:function(t){return t>=200&&t<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};Be.forEach(["delete","get","head","post","put","patch"],e=>{uh.headers[e]={}});const p9=Be.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),g9=e=>{const t={};let n,r,s;return e&&e.split(`
`).forEach(function(l){s=l.indexOf(":"),n=l.substring(0,s).trim().toLowerCase(),r=l.substring(s+1).trim(),!(!n||t[n]&&p9[n])&&(n==="set-cookie"?t[n]?t[n].push(r):t[n]=[r]:t[n]=t[n]?t[n]+", "+r:r)}),t},Hv=Symbol("internals");function Cd(e){return e&&String(e).trim().toLowerCase()}function Um(e){return e===!1||e==null?e:Be.isArray(e)?e.map(Um):String(e)}function x9(e){const t=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let r;for(;r=n.exec(e);)t[r[1]]=r[2];return t}const y9=e=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim());function Fg(e,t,n,r,s){if(Be.isFunction(r))return r.call(this,t,n);if(s&&(t=n),!!Be.isString(t)){if(Be.isString(r))return t.indexOf(r)!==-1;if(Be.isRegExp(r))return r.test(t)}}function b9(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(t,n,r)=>n.toUpperCase()+r)}function v9(e,t){const n=Be.toCamelCase(" "+t);["get","set","has"].forEach(r=>{Object.defineProperty(e,r+n,{value:function(s,i,l){return this[r].call(this,t,s,i,l)},configurable:!0})})}let ri=class{constructor(t){t&&this.set(t)}set(t,n,r){const s=this;function i(o,c,u){const d=Cd(c);if(!d)throw new Error("header name must be a non-empty string");const f=Be.findKey(s,d);(!f||s[f]===void 0||u===!0||u===void 0&&s[f]!==!1)&&(s[f||c]=Um(o))}const l=(o,c)=>Be.forEach(o,(u,d)=>i(u,d,c));if(Be.isPlainObject(t)||t instanceof this.constructor)l(t,n);else if(Be.isString(t)&&(t=t.trim())&&!y9(t))l(g9(t),n);else if(Be.isObject(t)&&Be.isIterable(t)){let o={},c,u;for(const d of t){if(!Be.isArray(d))throw TypeError("Object iterator must return a key-value pair");o[u=d[0]]=(c=o[u])?Be.isArray(c)?[...c,d[1]]:[c,d[1]]:d[1]}l(o,n)}else t!=null&&i(n,t,r);return this}get(t,n){if(t=Cd(t),t){const r=Be.findKey(this,t);if(r){const s=this[r];if(!n)return s;if(n===!0)return x9(s);if(Be.isFunction(n))return n.call(this,s,r);if(Be.isRegExp(n))return n.exec(s);throw new TypeError("parser must be boolean|regexp|function")}}}has(t,n){if(t=Cd(t),t){const r=Be.findKey(this,t);return!!(r&&this[r]!==void 0&&(!n||Fg(this,this[r],r,n)))}return!1}delete(t,n){const r=this;let s=!1;function i(l){if(l=Cd(l),l){const o=Be.findKey(r,l);o&&(!n||Fg(r,r[o],o,n))&&(delete r[o],s=!0)}}return Be.isArray(t)?t.forEach(i):i(t),s}clear(t){const n=Object.keys(this);let r=n.length,s=!1;for(;r--;){const i=n[r];(!t||Fg(this,this[i],i,t,!0))&&(delete this[i],s=!0)}return s}normalize(t){const n=this,r={};return Be.forEach(this,(s,i)=>{const l=Be.findKey(r,i);if(l){n[l]=Um(s),delete n[i];return}const o=t?b9(i):String(i).trim();o!==i&&delete n[i],n[o]=Um(s),r[o]=!0}),this}concat(...t){return this.constructor.concat(this,...t)}toJSON(t){const n=Object.create(null);return Be.forEach(this,(r,s)=>{r!=null&&r!==!1&&(n[s]=t&&Be.isArray(r)?r.join(", "):r)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([t,n])=>t+": "+n).join(`
`)}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(t){return t instanceof this?t:new this(t)}static concat(t,...n){const r=new this(t);return n.forEach(s=>r.set(s)),r}static accessor(t){const r=(this[Hv]=this[Hv]={accessors:{}}).accessors,s=this.prototype;function i(l){const o=Cd(l);r[o]||(v9(s,l),r[o]=!0)}return Be.isArray(t)?t.forEach(i):i(t),this}};ri.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);Be.reduceDescriptors(ri.prototype,({value:e},t)=>{let n=t[0].toUpperCase()+t.slice(1);return{get:()=>e,set(r){this[n]=r}}});Be.freezeMethods(ri);function Og(e,t){const n=this||uh,r=t||n,s=ri.from(r.headers);let i=r.data;return Be.forEach(e,function(o){i=o.call(n,i,s.normalize(),t?t.status:void 0)}),s.normalize(),i}function U4(e){return!!(e&&e.__CANCEL__)}function Ju(e,t,n){vn.call(this,e??"canceled",vn.ERR_CANCELED,t,n),this.name="CanceledError"}Be.inherits(Ju,vn,{__CANCEL__:!0});function q4(e,t,n){const r=n.config.validateStatus;!n.status||!r||r(n.status)?e(n):t(new vn("Request failed with status code "+n.status,[vn.ERR_BAD_REQUEST,vn.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function w9(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}function N9(e,t){e=e||10;const n=new Array(e),r=new Array(e);let s=0,i=0,l;return t=t!==void 0?t:1e3,function(c){const u=Date.now(),d=r[i];l||(l=u),n[s]=c,r[s]=u;let f=i,m=0;for(;f!==s;)m+=n[f++],f=f%e;if(s=(s+1)%e,s===i&&(i=(i+1)%e),u-l<t)return;const h=d&&u-d;return h?Math.round(m*1e3/h):void 0}}function j9(e,t){let n=0,r=1e3/t,s,i;const l=(u,d=Date.now())=>{n=d,s=null,i&&(clearTimeout(i),i=null),e(...u)};return[(...u)=>{const d=Date.now(),f=d-n;f>=r?l(u,d):(s=u,i||(i=setTimeout(()=>{i=null,l(s)},r-f)))},()=>s&&l(s)]}const dp=(e,t,n=3)=>{let r=0;const s=N9(50,250);return j9(i=>{const l=i.loaded,o=i.lengthComputable?i.total:void 0,c=l-r,u=s(c),d=l<=o;r=l;const f={loaded:l,total:o,progress:o?l/o:void 0,bytes:c,rate:u||void 0,estimated:u&&o&&d?(o-l)/u:void 0,event:i,lengthComputable:o!=null,[t?"download":"upload"]:!0};e(f)},n)},Wv=(e,t)=>{const n=e!=null;return[r=>t[0]({lengthComputable:n,total:e,loaded:r}),t[1]]},Vv=e=>(...t)=>Be.asap(()=>e(...t)),S9=Ts.hasStandardBrowserEnv?((e,t)=>n=>(n=new URL(n,Ts.origin),e.protocol===n.protocol&&e.host===n.host&&(t||e.port===n.port)))(new URL(Ts.origin),Ts.navigator&&/(msie|trident)/i.test(Ts.navigator.userAgent)):()=>!0,_9=Ts.hasStandardBrowserEnv?{write(e,t,n,r,s,i){const l=[e+"="+encodeURIComponent(t)];Be.isNumber(n)&&l.push("expires="+new Date(n).toGMTString()),Be.isString(r)&&l.push("path="+r),Be.isString(s)&&l.push("domain="+s),i===!0&&l.push("secure"),document.cookie=l.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function A9(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}function k9(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}function H4(e,t,n){let r=!A9(t);return e&&(r||n==!1)?k9(e,t):t}const Gv=e=>e instanceof ri?{...e}:e;function Xl(e,t){t=t||{};const n={};function r(u,d,f,m){return Be.isPlainObject(u)&&Be.isPlainObject(d)?Be.merge.call({caseless:m},u,d):Be.isPlainObject(d)?Be.merge({},d):Be.isArray(d)?d.slice():d}function s(u,d,f,m){if(Be.isUndefined(d)){if(!Be.isUndefined(u))return r(void 0,u,f,m)}else return r(u,d,f,m)}function i(u,d){if(!Be.isUndefined(d))return r(void 0,d)}function l(u,d){if(Be.isUndefined(d)){if(!Be.isUndefined(u))return r(void 0,u)}else return r(void 0,d)}function o(u,d,f){if(f in t)return r(u,d);if(f in e)return r(void 0,u)}const c={url:i,method:i,data:i,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:o,headers:(u,d,f)=>s(Gv(u),Gv(d),f,!0)};return Be.forEach(Object.keys({...e,...t}),function(d){const f=c[d]||s,m=f(e[d],t[d],d);Be.isUndefined(m)&&f!==o||(n[d]=m)}),n}const W4=e=>{const t=Xl({},e);let{data:n,withXSRFToken:r,xsrfHeaderName:s,xsrfCookieName:i,headers:l,auth:o}=t;t.headers=l=ri.from(l),t.url=D4(H4(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),o&&l.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):"")));let c;if(Be.isFormData(n)){if(Ts.hasStandardBrowserEnv||Ts.hasStandardBrowserWebWorkerEnv)l.setContentType(void 0);else if((c=l.getContentType())!==!1){const[u,...d]=c?c.split(";").map(f=>f.trim()).filter(Boolean):[];l.setContentType([u||"multipart/form-data",...d].join("; "))}}if(Ts.hasStandardBrowserEnv&&(r&&Be.isFunction(r)&&(r=r(t)),r||r!==!1&&S9(t.url))){const u=s&&i&&_9.read(i);u&&l.set(s,u)}return t},E9=typeof XMLHttpRequest<"u",C9=E9&&function(e){return new Promise(function(n,r){const s=W4(e);let i=s.data;const l=ri.from(s.headers).normalize();let{responseType:o,onUploadProgress:c,onDownloadProgress:u}=s,d,f,m,h,x;function y(){h&&h(),x&&x(),s.cancelToken&&s.cancelToken.unsubscribe(d),s.signal&&s.signal.removeEventListener("abort",d)}let p=new XMLHttpRequest;p.open(s.method.toUpperCase(),s.url,!0),p.timeout=s.timeout;function g(){if(!p)return;const v=ri.from("getAllResponseHeaders"in p&&p.getAllResponseHeaders()),A={data:!o||o==="text"||o==="json"?p.responseText:p.response,status:p.status,statusText:p.statusText,headers:v,config:e,request:p};q4(function(U){n(U),y()},function(U){r(U),y()},A),p=null}"onloadend"in p?p.onloadend=g:p.onreadystatechange=function(){!p||p.readyState!==4||p.status===0&&!(p.responseURL&&p.responseURL.indexOf("file:")===0)||setTimeout(g)},p.onabort=function(){p&&(r(new vn("Request aborted",vn.ECONNABORTED,e,p)),p=null)},p.onerror=function(){r(new vn("Network Error",vn.ERR_NETWORK,e,p)),p=null},p.ontimeout=function(){let N=s.timeout?"timeout of "+s.timeout+"ms exceeded":"timeout exceeded";const A=s.transitional||B4;s.timeoutErrorMessage&&(N=s.timeoutErrorMessage),r(new vn(N,A.clarifyTimeoutError?vn.ETIMEDOUT:vn.ECONNABORTED,e,p)),p=null},i===void 0&&l.setContentType(null),"setRequestHeader"in p&&Be.forEach(l.toJSON(),function(N,A){p.setRequestHeader(A,N)}),Be.isUndefined(s.withCredentials)||(p.withCredentials=!!s.withCredentials),o&&o!=="json"&&(p.responseType=s.responseType),u&&([m,x]=dp(u,!0),p.addEventListener("progress",m)),c&&p.upload&&([f,h]=dp(c),p.upload.addEventListener("progress",f),p.upload.addEventListener("loadend",h)),(s.cancelToken||s.signal)&&(d=v=>{p&&(r(!v||v.type?new Ju(null,e,p):v),p.abort(),p=null)},s.cancelToken&&s.cancelToken.subscribe(d),s.signal&&(s.signal.aborted?d():s.signal.addEventListener("abort",d)));const w=w9(s.url);if(w&&Ts.protocols.indexOf(w)===-1){r(new vn("Unsupported protocol "+w+":",vn.ERR_BAD_REQUEST,e));return}p.send(i||null)})},P9=(e,t)=>{const{length:n}=e=e?e.filter(Boolean):[];if(t||n){let r=new AbortController,s;const i=function(u){if(!s){s=!0,o();const d=u instanceof Error?u:this.reason;r.abort(d instanceof vn?d:new Ju(d instanceof Error?d.message:d))}};let l=t&&setTimeout(()=>{l=null,i(new vn(`timeout ${t} of ms exceeded`,vn.ETIMEDOUT))},t);const o=()=>{e&&(l&&clearTimeout(l),l=null,e.forEach(u=>{u.unsubscribe?u.unsubscribe(i):u.removeEventListener("abort",i)}),e=null)};e.forEach(u=>u.addEventListener("abort",i));const{signal:c}=r;return c.unsubscribe=()=>Be.asap(o),c}},I9=function*(e,t){let n=e.byteLength;if(n<t){yield e;return}let r=0,s;for(;r<n;)s=r+t,yield e.slice(r,s),r=s},T9=async function*(e,t){for await(const n of L9(e))yield*I9(n,t)},L9=async function*(e){if(e[Symbol.asyncIterator]){yield*e;return}const t=e.getReader();try{for(;;){const{done:n,value:r}=await t.read();if(n)break;yield r}}finally{await t.cancel()}},Yv=(e,t,n,r)=>{const s=T9(e,t);let i=0,l,o=c=>{l||(l=!0,r&&r(c))};return new ReadableStream({async pull(c){try{const{done:u,value:d}=await s.next();if(u){o(),c.close();return}let f=d.byteLength;if(n){let m=i+=f;n(m)}c.enqueue(new Uint8Array(d))}catch(u){throw o(u),u}},cancel(c){return o(c),s.return()}},{highWaterMark:2})},g0=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",V4=g0&&typeof ReadableStream=="function",M9=g0&&(typeof TextEncoder=="function"?(e=>t=>e.encode(t))(new TextEncoder):async e=>new Uint8Array(await new Response(e).arrayBuffer())),G4=(e,...t)=>{try{return!!e(...t)}catch{return!1}},R9=V4&&G4(()=>{let e=!1;const t=new Request(Ts.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),Jv=64*1024,xx=V4&&G4(()=>Be.isReadableStream(new Response("").body)),fp={stream:xx&&(e=>e.body)};g0&&(e=>{["text","arrayBuffer","blob","formData","stream"].forEach(t=>{!fp[t]&&(fp[t]=Be.isFunction(e[t])?n=>n[t]():(n,r)=>{throw new vn(`Response type '${t}' is not supported`,vn.ERR_NOT_SUPPORT,r)})})})(new Response);const $9=async e=>{if(e==null)return 0;if(Be.isBlob(e))return e.size;if(Be.isSpecCompliantForm(e))return(await new Request(Ts.origin,{method:"POST",body:e}).arrayBuffer()).byteLength;if(Be.isArrayBufferView(e)||Be.isArrayBuffer(e))return e.byteLength;if(Be.isURLSearchParams(e)&&(e=e+""),Be.isString(e))return(await M9(e)).byteLength},F9=async(e,t)=>{const n=Be.toFiniteNumber(e.getContentLength());return n??$9(t)},O9=g0&&(async e=>{let{url:t,method:n,data:r,signal:s,cancelToken:i,timeout:l,onDownloadProgress:o,onUploadProgress:c,responseType:u,headers:d,withCredentials:f="same-origin",fetchOptions:m}=W4(e);u=u?(u+"").toLowerCase():"text";let h=P9([s,i&&i.toAbortSignal()],l),x;const y=h&&h.unsubscribe&&(()=>{h.unsubscribe()});let p;try{if(c&&R9&&n!=="get"&&n!=="head"&&(p=await F9(d,r))!==0){let A=new Request(t,{method:"POST",body:r,duplex:"half"}),P;if(Be.isFormData(r)&&(P=A.headers.get("content-type"))&&d.setContentType(P),A.body){const[U,M]=Wv(p,dp(Vv(c)));r=Yv(A.body,Jv,U,M)}}Be.isString(f)||(f=f?"include":"omit");const g="credentials"in Request.prototype;x=new Request(t,{...m,signal:h,method:n.toUpperCase(),headers:d.normalize().toJSON(),body:r,duplex:"half",credentials:g?f:void 0});let w=await fetch(x,m);const v=xx&&(u==="stream"||u==="response");if(xx&&(o||v&&y)){const A={};["status","statusText","headers"].forEach(S=>{A[S]=w[S]});const P=Be.toFiniteNumber(w.headers.get("content-length")),[U,M]=o&&Wv(P,dp(Vv(o),!0))||[];w=new Response(Yv(w.body,Jv,U,()=>{M&&M(),y&&y()}),A)}u=u||"text";let N=await fp[Be.findKey(fp,u)||"text"](w,e);return!v&&y&&y(),await new Promise((A,P)=>{q4(A,P,{data:N,headers:ri.from(w.headers),status:w.status,statusText:w.statusText,config:e,request:x})})}catch(g){throw y&&y(),g&&g.name==="TypeError"&&/Load failed|fetch/i.test(g.message)?Object.assign(new vn("Network Error",vn.ERR_NETWORK,e,x),{cause:g.cause||g}):vn.from(g,g&&g.code,e,x)}}),yx={http:QP,xhr:C9,fetch:O9};Be.forEach(yx,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch{}Object.defineProperty(e,"adapterName",{value:t})}});const Zv=e=>`- ${e}`,D9=e=>Be.isFunction(e)||e===null||e===!1,Y4={getAdapter:e=>{e=Be.isArray(e)?e:[e];const{length:t}=e;let n,r;const s={};for(let i=0;i<t;i++){n=e[i];let l;if(r=n,!D9(n)&&(r=yx[(l=String(n)).toLowerCase()],r===void 0))throw new vn(`Unknown adapter '${l}'`);if(r)break;s[l||"#"+i]=r}if(!r){const i=Object.entries(s).map(([o,c])=>`adapter ${o} `+(c===!1?"is not supported by the environment":"is not available in the build"));let l=t?i.length>1?`since :
`+i.map(Zv).join(`
`):" "+Zv(i[0]):"as no adapter specified";throw new vn("There is no suitable adapter to dispatch the request "+l,"ERR_NOT_SUPPORT")}return r},adapters:yx};function Dg(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new Ju(null,e)}function Xv(e){return Dg(e),e.headers=ri.from(e.headers),e.data=Og.call(e,e.transformRequest),["post","put","patch"].indexOf(e.method)!==-1&&e.headers.setContentType("application/x-www-form-urlencoded",!1),Y4.getAdapter(e.adapter||uh.adapter)(e).then(function(r){return Dg(e),r.data=Og.call(e,e.transformResponse,r),r.headers=ri.from(r.headers),r},function(r){return U4(r)||(Dg(e),r&&r.response&&(r.response.data=Og.call(e,e.transformResponse,r.response),r.response.headers=ri.from(r.response.headers))),Promise.reject(r)})}const J4="1.11.0",x0={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{x0[e]=function(r){return typeof r===e||"a"+(t<1?"n ":" ")+e}});const Kv={};x0.transitional=function(t,n,r){function s(i,l){return"[Axios v"+J4+"] Transitional option '"+i+"'"+l+(r?". "+r:"")}return(i,l,o)=>{if(t===!1)throw new vn(s(l," has been removed"+(n?" in "+n:"")),vn.ERR_DEPRECATED);return n&&!Kv[l]&&(Kv[l]=!0,console.warn(s(l," has been deprecated since v"+n+" and will be removed in the near future"))),t?t(i,l,o):!0}};x0.spelling=function(t){return(n,r)=>(console.warn(`${r} is likely a misspelling of ${t}`),!0)};function B9(e,t,n){if(typeof e!="object")throw new vn("options must be an object",vn.ERR_BAD_OPTION_VALUE);const r=Object.keys(e);let s=r.length;for(;s-- >0;){const i=r[s],l=t[i];if(l){const o=e[i],c=o===void 0||l(o,i,e);if(c!==!0)throw new vn("option "+i+" must be "+c,vn.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new vn("Unknown option "+i,vn.ERR_BAD_OPTION)}}const qm={assertOptions:B9,validators:x0},ga=qm.validators;let Vl=class{constructor(t){this.defaults=t||{},this.interceptors={request:new qv,response:new qv}}async request(t,n){try{return await this._request(t,n)}catch(r){if(r instanceof Error){let s={};Error.captureStackTrace?Error.captureStackTrace(s):s=new Error;const i=s.stack?s.stack.replace(/^.+\n/,""):"";try{r.stack?i&&!String(r.stack).endsWith(i.replace(/^.+\n.+\n/,""))&&(r.stack+=`
`+i):r.stack=i}catch{}}throw r}}_request(t,n){typeof t=="string"?(n=n||{},n.url=t):n=t||{},n=Xl(this.defaults,n);const{transitional:r,paramsSerializer:s,headers:i}=n;r!==void 0&&qm.assertOptions(r,{silentJSONParsing:ga.transitional(ga.boolean),forcedJSONParsing:ga.transitional(ga.boolean),clarifyTimeoutError:ga.transitional(ga.boolean)},!1),s!=null&&(Be.isFunction(s)?n.paramsSerializer={serialize:s}:qm.assertOptions(s,{encode:ga.function,serialize:ga.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),qm.assertOptions(n,{baseUrl:ga.spelling("baseURL"),withXsrfToken:ga.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let l=i&&Be.merge(i.common,i[n.method]);i&&Be.forEach(["delete","get","head","post","put","patch","common"],x=>{delete i[x]}),n.headers=ri.concat(l,i);const o=[];let c=!0;this.interceptors.request.forEach(function(y){typeof y.runWhen=="function"&&y.runWhen(n)===!1||(c=c&&y.synchronous,o.unshift(y.fulfilled,y.rejected))});const u=[];this.interceptors.response.forEach(function(y){u.push(y.fulfilled,y.rejected)});let d,f=0,m;if(!c){const x=[Xv.bind(this),void 0];for(x.unshift(...o),x.push(...u),m=x.length,d=Promise.resolve(n);f<m;)d=d.then(x[f++],x[f++]);return d}m=o.length;let h=n;for(f=0;f<m;){const x=o[f++],y=o[f++];try{h=x(h)}catch(p){y.call(this,p);break}}try{d=Xv.call(this,h)}catch(x){return Promise.reject(x)}for(f=0,m=u.length;f<m;)d=d.then(u[f++],u[f++]);return d}getUri(t){t=Xl(this.defaults,t);const n=H4(t.baseURL,t.url,t.allowAbsoluteUrls);return D4(n,t.params,t.paramsSerializer)}};Be.forEach(["delete","get","head","options"],function(t){Vl.prototype[t]=function(n,r){return this.request(Xl(r||{},{method:t,url:n,data:(r||{}).data}))}});Be.forEach(["post","put","patch"],function(t){function n(r){return function(i,l,o){return this.request(Xl(o||{},{method:t,headers:r?{"Content-Type":"multipart/form-data"}:{},url:i,data:l}))}}Vl.prototype[t]=n(),Vl.prototype[t+"Form"]=n(!0)});let z9=class Z4{constructor(t){if(typeof t!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(i){n=i});const r=this;this.promise.then(s=>{if(!r._listeners)return;let i=r._listeners.length;for(;i-- >0;)r._listeners[i](s);r._listeners=null}),this.promise.then=s=>{let i;const l=new Promise(o=>{r.subscribe(o),i=o}).then(s);return l.cancel=function(){r.unsubscribe(i)},l},t(function(i,l,o){r.reason||(r.reason=new Ju(i,l,o),n(r.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(t){if(this.reason){t(this.reason);return}this._listeners?this._listeners.push(t):this._listeners=[t]}unsubscribe(t){if(!this._listeners)return;const n=this._listeners.indexOf(t);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const t=new AbortController,n=r=>{t.abort(r)};return this.subscribe(n),t.signal.unsubscribe=()=>this.unsubscribe(n),t.signal}static source(){let t;return{token:new Z4(function(s){t=s}),cancel:t}}};function U9(e){return function(n){return e.apply(null,n)}}function q9(e){return Be.isObject(e)&&e.isAxiosError===!0}const bx={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(bx).forEach(([e,t])=>{bx[t]=e});function X4(e){const t=new Vl(e),n=k4(Vl.prototype.request,t);return Be.extend(n,Vl.prototype,t,{allOwnKeys:!0}),Be.extend(n,t,null,{allOwnKeys:!0}),n.create=function(s){return X4(Xl(e,s))},n}const gr=X4(uh);gr.Axios=Vl;gr.CanceledError=Ju;gr.CancelToken=z9;gr.isCancel=U4;gr.VERSION=J4;gr.toFormData=p0;gr.AxiosError=vn;gr.Cancel=gr.CanceledError;gr.all=function(t){return Promise.all(t)};gr.spread=U9;gr.isAxiosError=q9;gr.mergeConfig=Xl;gr.AxiosHeaders=ri;gr.formToJSON=e=>z4(Be.isHTMLForm(e)?new FormData(e):e);gr.getAdapter=Y4.getAdapter;gr.HttpStatusCode=bx;gr.default=gr;const{Axios:Rte,AxiosError:$te,CanceledError:Fte,isCancel:Ote,CancelToken:Dte,VERSION:Bte,all:zte,Cancel:Ute,isAxiosError:qte,spread:Hte,toFormData:Wte,AxiosHeaders:Vte,HttpStatusCode:Gte,formToJSON:Yte,getAdapter:Jte,mergeConfig:Zte}=gr;let Pd=null,Id=null;const Oc={},H9=3e4,un=gr.create({baseURL:"https://qabael.premiumasp.net/api",timeout:3e4,headers:{"Content-Type":"application/json"}}),su=gr.create({baseURL:"https://qabael.premiumasp.net/api",timeout:3e4,headers:{"Content-Type":"application/json"},maxRedirects:5,maxContentLength:50*1024*1024,maxBodyLength:50*1024*1024}),K4=gr.create({baseURL:"https://qabael.premiumasp.net/api",timeout:3e4,headers:{"Content-Type":"application/json"}});su.interceptors.request.use(e=>e,e=>Promise.reject(e));su.interceptors.response.use(e=>e,e=>(e.response||e.request,Promise.reject(e)));un.interceptors.request.use(e=>{const t=localStorage.getItem("authToken");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));un.interceptors.response.use(e=>e,e=>{var t;return((t=e.response)==null?void 0:t.status)===401&&(localStorage.removeItem("authToken"),window.location.href="/login"),Promise.reject(e)});K4.interceptors.request.use(e=>{const t=localStorage.getItem("authToken");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));K4.interceptors.response.use(e=>e,e=>{var t;return((t=e.response)==null?void 0:t.status)===401&&(localStorage.removeItem("authToken"),window.location.href="/login"),Promise.reject(e)});let xa=null;const W9=3e4,nn={login:(e,t)=>su.post("/account/login",{Email:e,Password:t}).then(n=>{const r=n.data;if(r.success===!1||r.error||r.errors){const l=r.message||r.error||"Login failed";throw new Error(l)}let s=r.token||r.accessToken||r.access_token,i=r.user||r.userData||r.userInfo;if(!s&&r.data&&(s=r.data.token||r.data.accessToken||r.data.access_token,i=i||r.data.user||r.data.userData||r.data.userInfo),!s&&typeof r=="string"&&(s=r),s&&!i)if(r.userName||r.email)i={id:r.id||r.userId||r.userID||r.user_id||"unknown",firstName:r.userName||r.firstName||"User",lastName:r.lastName||"",email:r.email||"",phone:r.phone||void 0,language:"ar",theme:"light"};else try{const l=s.split(".")[1];if(l){const o=l.replace(/-/g,"+").replace(/_/g,"/"),c=decodeURIComponent(atob(o).split("").map(function(d){return"%"+("00"+d.charCodeAt(0).toString(16)).slice(-2)}).join("")),u=JSON.parse(c);i={id:u.nameid||u.sub||u.userId||u.userID||u.user_id||u.id||"unknown",firstName:u["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname"]||u.given_name||u.name||u.userName||u["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name"]||"User",lastName:u.family_name||u["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/surname"]||"",email:u["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress"]||u.email||"",phone:u.phone_number||void 0,language:"ar",theme:"light"}}}catch(l){console.warn("Could not parse token for user data:",l)}if(!s)throw new Error("Invalid login response: No authentication token received");if(!i||i.id==="unknown"&&!i.email)throw new Error("Invalid login response: No valid user identifier received");return xa=null,{token:s,user:i,success:!0}}).catch(n=>{var r;if(n.response){const s=n.response.status,i=n.response.data;if(s===401)throw new Error("Invalid email or password");if(s===403)throw new Error("Account is disabled or suspended");if(s===429)throw new Error("Too many login attempts. Please try again later");if(s>=500)throw new Error("Server error. Please try again later");const l=(i==null?void 0:i.message)||(i==null?void 0:i.error)||((r=i==null?void 0:i.errors)==null?void 0:r[0])||`Login failed with status ${s}`;throw new Error(l)}else throw n.request?new Error("Network error: Unable to reach the server. Please check your connection."):new Error(n.message||"Login error occurred")}),register:(e,t,n,r)=>su.post("/account/register",{UserName:e,Email:t,Password:n,PasswordConfirmation:r}).then(s=>{const i=s.data;if(i.success===!1||i.error||i.errors){const c=i.message||i.error||"Registration failed";throw new Error(c)}let l=i.token||i.accessToken||i.access_token,o=i.user||i.userData||i.userInfo;if(!l&&i.data&&(l=i.data.token||i.data.accessToken||i.data.access_token,o=o||i.data.user||i.data.userData||i.data.userInfo),!l&&typeof i=="string"&&(l=i),l&&!o)if(i.userName||i.email)o={id:i.id||i.userId||"unknown",firstName:i.userName||i.firstName||"User",lastName:i.lastName||"",email:i.email||"",phone:i.phone||void 0,language:"ar",theme:"light"};else try{const c=l.split(".")[1];if(c){const u=c.replace(/-/g,"+").replace(/_/g,"/"),d=decodeURIComponent(atob(u).split("").map(function(m){return"%"+("00"+m.charCodeAt(0).toString(16)).slice(-2)}).join("")),f=JSON.parse(d);o={id:f.nameid||f.sub||f.userId||"unknown",firstName:f["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname"]||f.given_name||f.name||f.userName||"User",lastName:f.family_name||"",email:f["http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress"]||f.email||"",phone:f.phone_number||void 0,language:"ar",theme:"light"}}}catch(c){console.warn("Could not parse token for user data:",c)}if(!l)throw new Error("Invalid registration response: No authentication token received");if(!o||o.id==="unknown"&&!o.email)throw new Error("Invalid registration response: No valid user identifier received");return{token:l,user:o,success:!0}}).catch(s=>{var i;if(s.response){const l=s.response.status,o=s.response.data;if(l===400){if(o!=null&&o.errors){const u=Object.values(o.errors).flat();throw new Error(u.join(", ")||"Registration validation failed")}throw new Error("Invalid registration data")}else{if(l===409)throw new Error("Email or username already exists");if(l===422)throw new Error("Registration data validation failed");if(l>=500)throw new Error("Server error. Please try again later")}const c=(o==null?void 0:o.message)||(o==null?void 0:o.error)||((i=o==null?void 0:o.errors)==null?void 0:i[0])||`Registration failed with status ${l}`;throw new Error(c)}else throw s.request?new Error("Network error: Unable to reach the server. Please check your connection."):new Error(s.message||"Registration error occurred")}),getCurrentUser:()=>{const e=Date.now();return xa&&e-xa.timestamp<W9&&xa.data&&xa.data&&(xa.data.id!=="unknown"||xa.data.email)?Promise.resolve(xa.data):un.get("/account",{responseType:"json",decompress:!0}).then(t=>{const n=t.data;if(!n||n.id==="unknown"&&!n.email)throw new Error("Invalid user data received from server");return xa={data:n,timestamp:e},n})},emailExists:e=>un.get(`/account/Emailexists?email=${e}`).then(t=>t.data),signOut:()=>un.post("/account/SignOut").then(e=>e.data),forgetPassword:e=>su.post("https://qabael.premiumasp.net/api/account/ForgetPassword",{Email:e}).then(t=>t.data).catch(t=>{var n,r,s;if(t.response){if(t.response.status===404)return{};const i=((n=t.response.data)==null?void 0:n.message)||((r=t.response.data)==null?void 0:r.error)||"";if(i.includes("User not found")||i.includes("user not found"))return{}}else if(t.code==="ERR_NETWORK"||(s=t.message)!=null&&s.includes("Network Error"))return{};return{}}),resetPassword:(e,t,n,r)=>un.post(`/account/reset-password?email=${e}&token=${t}`,{NewPassword:n,ConfirmPassword:r}).then(s=>s.data),getProfile:()=>un.get("/Profile").then(e=>e.data),updateNotificationSettings:e=>un.put("/Profile/notifications",e).then(t=>t.data).catch(t=>{var n;if(((n=t.response)==null?void 0:n.status)===405)return un.post("/Profile/notifications",e).then(r=>r.data);throw t}),updatePrivacySettings:e=>un.put("/Profile/privacy",e).then(t=>t.data).catch(t=>{var n;if(((n=t.response)==null?void 0:n.status)===405)return un.post("/Profile/privacy",e).then(r=>r.data);throw t}),updateProfile:(e,t,n,r,s,i,l,o,c)=>un.post("/Profile",{userName:e,displayName:t,phoneNumber:n,age:r,nationality:s,nidOrPassport:i,city:l,country:o,gender:c}).then(u=>u.data).catch(u=>{var d;if(((d=u.response)==null?void 0:d.status)===405)return un.put("/Profile",{userName:e,displayName:t,phoneNumber:n,age:r,nationality:s,nidOrPassport:i,city:l,country:o,gender:c}).then(f=>f.data);throw u}),createOrUpdateProfile:(e,t,n,r,s,i,l,o,c)=>un.post("/Profile",{userName:e,displayName:t,phoneNumber:n,age:r,nationality:s,nidOrPassport:i,city:l,country:o,gender:c}).then(u=>u.data),uploadProfilePicture:e=>un.post("/Profile/upload-picture",e,{headers:{"Content-Type":"multipart/form-data"}}).then(t=>t.data),deleteProfilePicture:()=>un.delete("/Profile/delete-picture").then(e=>e.data),getTrees:()=>Pd||(Pd=un.get("/FamilyTree").then(e=>e.data).finally(()=>{Pd=null}),Pd),getAllPublicTrees:()=>Id||(Id=su.get("/FamilyTree/public").then(e=>e.data).finally(()=>{Id=null}),Id),addTree:(e,t,n)=>un.post("/FamilyTree",{name:e,IsPrivate:t,Description:n}).then(r=>r),getTreeById:e=>un.get(`/FamilyTree/${e}`).then(t=>t.data),updateTree:(e,t,n,r)=>{if(!t||t.trim()==="")return Promise.reject(new Error("Tree name is required"));const s={name:t.trim(),IsPrivate:n,Description:(r==null?void 0:r.trim())||""};return un.put(`/FamilyTree/${e}`,s).then(i=>i).catch(i=>{throw i.response,i})},deleteTree:e=>un.delete(`/FamilyTree/${e}`).then(t=>t.data),uploadTreePhoto:e=>un.post("/FamilyTree/upload-picture",e,{headers:{"Content-Type":"multipart/form-data"}}).then(t=>t.data),deleteTreePhoto:e=>un.delete(`/FamilyTree/Delete-photo/${e}`).then(t=>t.data),addPerson:(e,t,n,r,s,i,l,o)=>{const c={name:e};return t&&t.trim()!==""&&(c.birthDate=t),n&&n.trim()!==""&&(c.birthPlace=n),r&&r.trim()!==""&&(c.occupation=r),s&&s.trim()!==""&&(c.gender=s),i&&i.trim()!==""&&(c.DeathDate=i),c.IsDeceased=l,c.FamilyTreeId=o,un.post("/Person",c).then(u=>u).catch(u=>{throw u.response,u})},getPersonsInTree:e=>{const t=e.toString(),n=Date.now();return Oc[t]&&n-Oc[t].timestamp<H9?Promise.resolve(Oc[t].data):un.get(`/Person/person_in_tree?familyTreeId=${e}`).then(r=>(Oc[t]={data:r.data,timestamp:n},r.data))},updatePerson:(e,t,n,r,s,i,l,o,c,u,d,f)=>{const m={name:t};return n&&n.trim()!==""&&(m.birthDate=n),r&&r.trim()!==""&&(m.birthPlace=r),s&&s.trim()!==""&&(m.occupation=s),i&&i.trim()!==""&&(m.gender=i),l&&(m.familyTreeId=l),typeof o=="number"&&(m.Latitude=o),typeof c=="number"&&(m.Longitude=c),u&&u.trim()!==""&&(m.ColorCode=u),typeof d=="boolean"&&(m.IsDeceased=d),f&&f.trim()!==""&&(m.DeathDate=f),un.put(`/Person/${e}`,m).then(h=>h).catch(h=>{throw h})},updatePersonPosition:(e,t,n)=>un.put(`/Person/${e}`,{Latitude:t,Longitude:n}).then(r=>r).catch(r=>{throw r}),getPersonById:e=>un.get(`/Person/${e}`).then(t=>t.data).catch(t=>{throw t}),deletePerson:e=>un.delete(`/Person/${e}`).then(t=>t.data).catch(t=>{var n,r;if(t.response){const s=((n=t.response.data)==null?void 0:n.message)||((r=t.response.data)==null?void 0:r.error)||JSON.stringify(t.response.data);throw new Error(`Server error ${t.response.status}: ${s||"Unknown server error"}`)}else throw t.request?new Error("Network error: No response received from server"):new Error(`Request error: ${t.message}`)}),uploadPersonPicture:e=>un.post("/Person/upload-picture",e,{headers:{"Content-Type":"multipart/form-data"}}).then(t=>t.data),deletePersonPicture:e=>un.delete(`/Person/delete-photo/${e}`).then(t=>t.data),addRelationship:(e,t,n)=>un.post("/Relationship",{personId:e,relatedPersonId:t,relationshipType:n}).then(r=>r.data),getRelationships:()=>un.get("/Relationship").then(e=>e.data),deleteRelationship:e=>un.delete(`/Relationship/${e}`).then(t=>t.data),testApiConnectivity:async()=>{var e;try{return(await un.get("/health",{timeout:5e3})).status===200}catch(t){return((e=t.response)==null?void 0:e.status)===404}},createJoinRequest:async(e,t,n,r,s,i,l,o,c,u)=>{var f,m;if(!e||e<=0)throw new Error("Invalid family tree ID");if(!t||t.trim().length<2)throw new Error("Name must be at least 2 characters");if(!n)throw new Error("Birth date is required");if(!r||r.trim().length<2)throw new Error("Birth place must be at least 2 characters");if(!s||!["Male","Female"].includes(s))throw new Error("Gender must be either Male or Female");if(!i||i.trim().length<2)throw new Error("Occupation must be at least 2 characters");const d={FamilyTreeId:e,Name:t,BirthDate:n,BirthPlace:r,Gender:s,Occupation:i,RelatedPersonId:l,Status:o,RequesterId:c,RelationshipType:u};try{return(await un.post("/JoinRequest",d)).data}catch(h){if(h.response){const x=((f=h.response.data)==null?void 0:f.message)||((m=h.response.data)==null?void 0:m.error)||JSON.stringify(h.response.data);throw new Error(`Server error ${h.response.status}: ${x||"Unknown server error"}`)}else throw h.request?new Error("Network error: No response received from server"):new Error(`Request error: ${h.message}`)}},getJoinRequestsByTree:e=>un.get(`/JoinRequest/by-tree/${e}`).then(t=>t.data),acceptJoinRequest:e=>un.put(`/JoinRequest/${e}/accept`,{}).then(t=>t.data),rejectJoinRequest:e=>un.put(`/JoinRequest/${e}/reject`,{}).then(t=>t.data),getAdminTrees:()=>un.get("/FamilyTree/Admin_FamilyTrees").then(e=>e.data).catch(e=>{var t;return((t=e.response)==null?void 0:t.status)===404?{data:[]}:{data:[]}}),getUserCount:()=>un.get("/admin/users/count").then(e=>e.data).catch(e=>{var t;return((t=e.response)==null?void 0:t.status)===404?{count:0}:{count:0}}),getTotalTreeCount:()=>un.get("/admin/familytrees/count").then(e=>e.data).catch(e=>{var t;return((t=e.response)==null?void 0:t.status)===404?{count:0}:{count:0}}),getPrivateTreeCount:()=>un.get("/admin/familytrees/private/count").then(e=>e.data).catch(e=>{var t;return((t=e.response)==null?void 0:t.status)===404?{count:0}:{count:0}}),getPublicTreeCount:()=>un.get("/admin/familytrees/public/count").then(e=>e.data).catch(e=>{var t;return((t=e.response)==null?void 0:t.status)===404?{count:0}:{count:0}}),getPersonCount:()=>un.get("/admin/persons/count").then(e=>e.data).catch(e=>{var t;return((t=e.response)==null?void 0:t.status)===404?{count:0}:{count:0}}),getAllSubscriptions:()=>un.get("/admin/subscriptions").then(e=>e.data).catch(e=>{var t;return((t=e.response)==null?void 0:t.status)===404?{data:[]}:{data:[]}}),getSubscriptionById:e=>un.get(`/admin/subscriptions/${e}`).then(t=>t.data).catch(t=>{var n;return((n=t.response)==null?void 0:n.status)===404,null}),updateSubscription:(e,t)=>un.put(`/admin/subscriptions/${e}`,t).then(n=>n.data).catch(n=>{var r;return((r=n.response)==null?void 0:r.status)===404,null}),cancelSubscription:e=>un.post(`/admin/subscriptions/${e}/cancel`).then(t=>t.data).catch(t=>{var n;return((n=t.response)==null?void 0:n.status)===404,null}),refundSubscription:(e,t)=>un.post(`/admin/subscriptions/${e}/refund`,{amount:t}).then(n=>n.data).catch(n=>{var r;return((r=n.response)==null?void 0:r.status)===404,null}),getAllUsers:()=>un.get("/admin/users").then(e=>e.data).catch(e=>{var t;return((t=e.response)==null?void 0:t.status)===404?{data:[],count:0}:{data:[],count:0}}),deleteUser:e=>un.delete(`/admin/users/${e}`).then(t=>t.data),blockUser:e=>Promise.resolve({success:!0,message:`User with email ${e} blocked successfully`}),clearPersonsInTreeCache:()=>{Object.keys(Oc).forEach(e=>{delete Oc[e]})},clearUserCache:()=>{xa=null}},V9=e=>{if(!e||!e.token||typeof e.token!="string"||e.token.trim()===""||!e.user||!e.user.id||!e.user.email)return!1;const t=e.token.split(".");if(t.length!==3)return!1;try{const r=t[1].replace(/-/g,"+").replace(/_/g,"/"),s=decodeURIComponent(atob(r).split("").map(function(o){return"%"+("00"+o.charCodeAt(0).toString(16)).slice(-2)}).join("")),i=JSON.parse(s),l=Math.floor(Date.now()/1e3);return!(i.exp&&i.exp<l)}catch{return!1}},G9=e=>{try{const n=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent(atob(n).split("").map(function(i){return"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(r)}catch{return null}},Td=(e,t)=>{const n=G9(t),r=(e==null?void 0:e.role)==="admin",s=(n==null?void 0:n.role)==="admin",i=(e==null?void 0:e.email)==="alkarbi.mohamed@gmail.com"||(n==null?void 0:n.email)==="alkarbi.mohamed@gmail.com",l=r||s||i;return{id:(e==null?void 0:e.id)||(n==null?void 0:n.nameid)||(n==null?void 0:n.sub)||(n==null?void 0:n.userId)||(e==null?void 0:e.userId)||"unknown",firstName:(e==null?void 0:e.firstName)||(e==null?void 0:e.userName)||(n==null?void 0:n.given_name)||(n==null?void 0:n.name)||"User",lastName:(e==null?void 0:e.lastName)||"",email:(e==null?void 0:e.email)||(n==null?void 0:n.email)||"",phone:(e==null?void 0:e.phone)||(e==null?void 0:e.phoneNumber)||(n==null?void 0:n.phone_number)||void 0,dateOfBirth:(e==null?void 0:e.dateOfBirth)||void 0,gender:(e==null?void 0:e.gender)||(e==null?void 0:e.gender)||(n==null?void 0:n.gender)||void 0,country:(e==null?void 0:e.country)||(e==null?void 0:e.nationality)||(n==null?void 0:n.country)||void 0,city:(e==null?void 0:e.city)||void 0,language:(e==null?void 0:e.language)||"en",theme:(e==null?void 0:e.theme)||"light",timezone:(e==null?void 0:e.timezone)||(n==null?void 0:n.zoneinfo)||void 0,avatar:(e==null?void 0:e.avatar)||void 0,isEmailVerified:(e==null?void 0:e.isEmailVerified)||!1,stats:(e==null?void 0:e.stats)||{treesCreated:0,totalPeople:0,photosUploaded:0,documentsUploaded:0,storageUsed:0,totalLogins:0},notifications:(e==null?void 0:e.notifications)||{email:{newSuggestions:!0,treeUpdates:!0,subscriptionUpdates:!0,marketing:!1},push:{enabled:!0}},privacy:(e==null?void 0:e.privacy)||{profileVisibility:"public",allowSearchEngines:!1,showOnlineStatus:!0},createdAt:(e==null?void 0:e.createdAt)||new Date().toISOString(),lastLoginAt:(e==null?void 0:e.lastLoginAt)||void 0,role:l?"admin":(e==null?void 0:e.role)||(n==null?void 0:n.role)||"user"}},Xn={login:async e=>{try{const t=await nn.login(e.email,e.password);if(!V9(t))throw new Error("Invalid login response: Authentication failed");localStorage.setItem("authToken",t.token);let n={};try{n=await nn.getProfile()}catch(i){console.warn("Failed to fetch profile data:",i)}const r={...t.user,...n,firstName:n.userName||n.firstName||t.user.firstName||"User",lastName:n.lastName||t.user.lastName||"",phone:n.phoneNumber!==void 0?n.phoneNumber:t.user.phone,country:n.country||n.nationality||t.user.country,city:n.city||t.user.city,dateOfBirth:n.dateOfBirth||t.user.dateOfBirth,gender:n.gender||t.user.gender,email:t.user.email||n.email||""},s=Td(r,t.token);return localStorage.setItem("user",JSON.stringify(s)),t.user=s,t}catch(t){if(localStorage.removeItem("authToken"),localStorage.removeItem("user"),t.response){const n=t.response.status,r=t.response.data;switch(n){case 400:throw new Error("Invalid email or password format");case 401:throw new Error("Invalid email or password");case 403:throw new Error("Account is disabled or suspended");case 429:throw new Error("Too many login attempts. Please try again later");case 500:throw new Error("Server error. Please try again later");default:throw new Error((r==null?void 0:r.message)||"Login failed. Please try again")}}else throw t.code==="ERR_NETWORK"?new Error("Network error. Please check your internet connection"):t.message?new Error(t.message):new Error("Login failed. Please check your credentials and try again")}},register:async e=>{try{const t=await nn.register(e.name||e.firstName,e.email,e.password,e.confirmPassword);if(t.token&&localStorage.setItem("authToken",t.token),t.user||t.token){const n=Td(t.user||{},t.token);localStorage.setItem("user",JSON.stringify(n)),t.user=n}return t}catch(t){throw t}},logout:async()=>{try{await nn.signOut()}catch{}finally{localStorage.removeItem("authToken"),localStorage.removeItem("user")}},getCurrentUser:async()=>{try{const e=await nn.getCurrentUser();let t={};try{t=await nn.getProfile()}catch(i){console.warn("Failed to fetch profile data:",i)}const n={...e,...t,firstName:t.userName||t.firstName||e.firstName||"User",lastName:t.lastName||e.lastName||"",phone:t.phoneNumber!==void 0?t.phoneNumber:e.phone,country:t.country||t.nationality||e.country,city:t.city||e.city,dateOfBirth:t.dateOfBirth||e.dateOfBirth,gender:t.gender||e.gender,email:e.email||t.email||""},r=localStorage.getItem("authToken");if(r){const i=Td(n,r);return localStorage.setItem("user",JSON.stringify(i)),i}return Td(n,"")}catch(e){throw e}},emailExists:async e=>{try{return await nn.emailExists(e)}catch(t){throw t}},forgotPassword:async e=>{try{await nn.forgetPassword(e)}catch{}},resetPassword:async(e,t,n,r)=>{try{await nn.resetPassword(e,t,n,r)}catch(s){throw s}},verifyEmail:async e=>{try{await new Promise(t=>setTimeout(t,1e3))}catch(t){throw t}},resendVerificationEmail:async()=>{try{await new Promise(e=>setTimeout(e,1e3))}catch(e){throw e}},getStoredToken:()=>localStorage.getItem("authToken"),getStoredUser:()=>{const e=localStorage.getItem("user");if(!e)return null;try{const t=JSON.parse(e);if(t&&typeof t=="object"&&!t.firstName&&t.userName){const n=localStorage.getItem("authToken");if(n)return Td(t,n)}return t}catch{return null}},storeUser:e=>{localStorage.setItem("user",JSON.stringify(e))},clearStoredAuth:()=>{localStorage.removeItem("authToken"),localStorage.removeItem("user")},isTokenExpired:()=>{const e=localStorage.getItem("authToken");if(!e)return!0;try{const t=e.split(".")[1];if(!t)return!0;const n=t.replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent(atob(n).split("").map(function(o){return"%"+("00"+o.charCodeAt(0).toString(16)).slice(-2)}).join("")),s=JSON.parse(r),i=Math.floor(Date.now()/1e3);return s.exp<i}catch{return!1}},refreshToken:async()=>{throw new Error("Token refresh not implemented")},updateProfile:async e=>{try{const t=Xn.getStoredUser();if(!t)throw new Error("No user data found");const n={userName:e.firstName||t.firstName||"",displayName:e.firstName||t.firstName||"",phoneNumber:e.phone||t.phone||"",age:e.dateOfBirth?Math.floor((Date.now()-new Date(e.dateOfBirth).getTime())/(1e3*365*24*60*60)).toString():t.dateOfBirth?Math.floor((Date.now()-new Date(t.dateOfBirth).getTime())/(1e3*365*24*60*60)).toString():"",nationality:e.country||t.country||"",nidOrPassport:"",city:e.city||t.city||"",country:e.country||t.country||"",gender:e.gender||t.gender||""};await nn.updateProfile(n.userName,n.displayName,n.phoneNumber,n.age,n.nationality,n.nidOrPassport,n.city,n.country,n.gender);const r={...t,...e,firstName:e.firstName!==void 0?e.firstName:t.firstName,lastName:e.lastName!==void 0?e.lastName:t.lastName,phone:e.phone!==void 0?e.phone:t.phone,dateOfBirth:e.dateOfBirth!==void 0?e.dateOfBirth:t.dateOfBirth,country:e.country!==void 0?e.country:t.country,city:e.city!==void 0?e.city:t.city,gender:e.gender!==void 0?e.gender:t.gender};return Xn.storeUser(r),r}catch(t){throw t}},uploadAvatar:async e=>{try{const t=new FormData;t.append("picture",e);const n=await nn.uploadProfilePicture(t),r=Xn.getStoredUser();if(r){const s={...r,avatar:n};Xn.storeUser(s)}return{avatar:n}}catch(t){throw t}},deleteAvatar:async()=>{try{await nn.deleteProfilePicture();const e=Xn.getStoredUser();if(e){const t={...e,avatar:void 0};Xn.storeUser(t)}}catch(e){throw e}},changePassword:async(e,t,n)=>{throw new Error("Change password not implemented")},updateNotificationSettings:async e=>{try{return await nn.updateNotificationSettings(e)}catch(t){throw t}},updatePrivacySettings:async e=>{try{return await nn.updatePrivacySettings(e)}catch(t){throw t}},deleteAccount:async()=>{throw new Error("Delete account not implemented")},deleteUser:async e=>{try{await nn.deleteUser(e)}catch(t){throw t}}};let Bg=null,zg="",Ld=null;const Pl=e=>{if(!e)return Bg=null,zg="",null;const t=JSON.stringify(e);return t!==zg&&(Bg=e,zg=t),Bg},Pr=Z2()(A4(X2((e,t)=>({user:null,token:null,isAuthenticated:!1,isLoading:!0,login:async n=>{e({isLoading:!0});try{const r=await Xn.login(n);if(!r.user||!r.token)throw new Error("Invalid login response");return e({user:Pl(r.user),token:r.token,isAuthenticated:!0,isLoading:!1}),r}catch(r){throw e({user:null,token:null,isAuthenticated:!1,isLoading:!1}),r}},register:async n=>{e({isLoading:!0});try{const r=await Xn.register(n);if(!r.user||!r.token)throw new Error("Invalid registration response");return e({user:Pl(r.user),token:r.token,isAuthenticated:!0,isLoading:!1}),r}catch(r){throw e({user:null,token:null,isAuthenticated:!1,isLoading:!1}),r}},logout:async()=>{e({isLoading:!0});try{await Xn.logout()}catch{}finally{e({user:null,token:null,isAuthenticated:!1,isLoading:!1})}},updateUser:n=>{const r=t().user;if(r){const s={...r,...n};e({user:Pl(s)})}},setAuthData:(n,r)=>{e({user:Pl(n),token:r,isAuthenticated:!0,isLoading:!1})},clearAuth:()=>{e({user:null,token:null,isAuthenticated:!1,isLoading:!1})},refreshToken:async()=>{try{const n=await Xn.refreshToken();e({user:Pl(n.user),token:n.token,isAuthenticated:!0})}catch(n){throw e({user:null,token:null,isAuthenticated:!1}),n}},initialize:()=>{const n=Xn.getStoredUser(),r=Xn.getStoredToken(),s=Xn.isTokenExpired();return n&&r&&!s?e({user:Pl(n),token:r,isAuthenticated:!0,isLoading:!1}):((r||n)&&Xn.clearStoredAuth(),e({user:null,token:null,isAuthenticated:!1,isLoading:!1})),Promise.resolve()},getCurrentUser:async()=>Ld||(Ld=(async()=>{try{const n=await Xn.getCurrentUser();if(!n||n.id==="unknown"&&!n.email)throw new Error("Invalid user data received");return e({user:Pl(n),isAuthenticated:!0,isLoading:!1}),n}catch(n){throw e({user:null,token:null,isAuthenticated:!1,isLoading:!1}),n}finally{Ld=null}})(),Ld),updateProfile:async n=>{e({isLoading:!0});try{const r=await Xn.updateProfile(n);return e({user:r,isLoading:!1}),r}catch(r){throw e({isLoading:!1}),r}},uploadAvatar:async n=>{e({isLoading:!0});try{const r=await Xn.uploadAvatar(n),s=t().user;return s&&e({user:{...s,avatar:r.avatar},isLoading:!1}),r}catch(r){throw e({isLoading:!1}),r}},deleteAvatar:async()=>{e({isLoading:!0});try{await Xn.deleteAvatar();const n=t().user;n&&e({user:{...n,avatar:void 0},isLoading:!1})}catch(n){throw e({isLoading:!1}),n}},changePassword:async(n,r,s)=>{e({isLoading:!0});try{await Xn.changePassword(n,r,s),e({isLoading:!1})}catch(i){throw e({isLoading:!1}),i}},updateNotificationSettings:async n=>{e({isLoading:!0});try{const r=await Xn.updateNotificationSettings(n),s=t().user;return s&&e({user:{...s,notifications:r},isLoading:!1}),r}catch(r){throw e({isLoading:!1}),r}},updatePrivacySettings:async n=>{e({isLoading:!0});try{const r=await Xn.updatePrivacySettings(n),s=t().user;return s&&e({user:{...s,privacy:r},isLoading:!1}),r}catch(r){throw e({isLoading:!1}),r}},deleteAccount:async()=>{e({isLoading:!0});try{await Xn.deleteAccount(),e({user:null,token:null,isAuthenticated:!1,isLoading:!1})}catch(n){throw e({isLoading:!1}),n}}}),{name:"auth-storage",partialize:e=>({user:e.user,token:e.token,isAuthenticated:e.isAuthenticated})}),{name:"auth-store"})),Xt=Z2()(X2((e,t)=>({language:"ar",theme:"light",sidebarCollapsed:!1,notifications:[],setLanguage:n=>e({language:n}),setTheme:n=>e({theme:n}),setSidebarCollapsed:n=>e({sidebarCollapsed:n}),addNotification:n=>{const r=Math.random().toString(36).substr(2,9),s={...n,id:r};e(l=>({notifications:[...l.notifications,s]}));const i=n.duration||5e3;return setTimeout(()=>{t().removeNotification(r)},i),r},removeNotification:n=>e(r=>({notifications:r.notifications.filter(s=>s.id!==n)})),clearNotifications:()=>e({notifications:[]}),showSuccess:(n,r)=>t().addNotification({type:"success",title:n,message:r||"",duration:5e3}),showError:(n,r)=>t().addNotification({type:"error",title:n,message:r||"",duration:7e3}),showErrorWithAction:(n,r,s)=>t().addNotification({type:"error",title:n,message:r||"",action:s,duration:7e3}),showWarning:(n,r)=>t().addNotification({type:"warning",title:n,message:r||"",duration:6e3}),showInfo:(n,r)=>t().addNotification({type:"info",title:n,message:r||"",duration:5e3})}),{name:"ui-store",partialize:e=>({language:e.language,theme:e.theme,sidebarCollapsed:e.sidebarCollapsed})})),Q4=(e=10)=>{const t=Y.useRef(null),n=Y.useRef(null),{logout:r}=Pr(),s=Ir(),i=()=>{t.current&&clearTimeout(t.current),n.current&&clearTimeout(n.current);const l=e*60*1e3-60*1e3;n.current=setTimeout(()=>{window.dispatchEvent(new CustomEvent("inactivity-warning"))},l),t.current=setTimeout(async()=>{try{await r(),s("/login")}catch{s("/login")}},e*60*1e3)};return Y.useEffect(()=>{const l=["mousedown","mousemove","keypress","scroll","touchstart","click"],o=()=>{i()};return l.forEach(c=>{window.addEventListener(c,o,{passive:!0})}),i(),()=>{t.current&&clearTimeout(t.current),n.current&&clearTimeout(n.current),l.forEach(c=>{window.removeEventListener(c,o)})}},[e]),{resetLogoutTimer:i}};function ej(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(n=ej(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function Y9(){for(var e,t,n=0,r="",s=arguments.length;n<s;n++)(e=arguments[n])&&(t=ej(e))&&(r&&(r+=" "),r+=t);return r}const ty="-",J9=e=>{const t=X9(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:l=>{const o=l.split(ty);return o[0]===""&&o.length!==1&&o.shift(),tj(o,t)||Z9(l)},getConflictingClassGroupIds:(l,o)=>{const c=n[l]||[];return o&&r[l]?[...c,...r[l]]:c}}},tj=(e,t)=>{var l;if(e.length===0)return t.classGroupId;const n=e[0],r=t.nextPart.get(n),s=r?tj(e.slice(1),r):void 0;if(s)return s;if(t.validators.length===0)return;const i=e.join(ty);return(l=t.validators.find(({validator:o})=>o(i)))==null?void 0:l.classGroupId},Qv=/^\[(.+)\]$/,Z9=e=>{if(Qv.test(e)){const t=Qv.exec(e)[1],n=t==null?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},X9=e=>{const{theme:t,prefix:n}=e,r={nextPart:new Map,validators:[]};return Q9(Object.entries(e.classGroups),n).forEach(([i,l])=>{vx(l,r,i,t)}),r},vx=(e,t,n,r)=>{e.forEach(s=>{if(typeof s=="string"){const i=s===""?t:e5(t,s);i.classGroupId=n;return}if(typeof s=="function"){if(K9(s)){vx(s(r),t,n,r);return}t.validators.push({validator:s,classGroupId:n});return}Object.entries(s).forEach(([i,l])=>{vx(l,e5(t,i),n,r)})})},e5=(e,t)=>{let n=e;return t.split(ty).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},K9=e=>e.isThemeGetter,Q9=(e,t)=>t?e.map(([n,r])=>{const s=r.map(i=>typeof i=="string"?t+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([l,o])=>[t+l,o])):i);return[n,s]}):e,eI=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,r=new Map;const s=(i,l)=>{n.set(i,l),t++,t>e&&(t=0,r=n,n=new Map)};return{get(i){let l=n.get(i);if(l!==void 0)return l;if((l=r.get(i))!==void 0)return s(i,l),l},set(i,l){n.has(i)?n.set(i,l):s(i,l)}}},nj="!",tI=e=>{const{separator:t,experimentalParseClassName:n}=e,r=t.length===1,s=t[0],i=t.length,l=o=>{const c=[];let u=0,d=0,f;for(let p=0;p<o.length;p++){let g=o[p];if(u===0){if(g===s&&(r||o.slice(p,p+i)===t)){c.push(o.slice(d,p)),d=p+i;continue}if(g==="/"){f=p;continue}}g==="["?u++:g==="]"&&u--}const m=c.length===0?o:o.substring(d),h=m.startsWith(nj),x=h?m.substring(1):m,y=f&&f>d?f-d:void 0;return{modifiers:c,hasImportantModifier:h,baseClassName:x,maybePostfixModifierPosition:y}};return n?o=>n({className:o,parseClassName:l}):l},nI=e=>{if(e.length<=1)return e;const t=[];let n=[];return e.forEach(r=>{r[0]==="["?(t.push(...n.sort(),r),n=[]):n.push(r)}),t.push(...n.sort()),t},rI=e=>({cache:eI(e.cacheSize),parseClassName:tI(e),...J9(e)}),sI=/\s+/,iI=(e,t)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:s}=t,i=[],l=e.trim().split(sI);let o="";for(let c=l.length-1;c>=0;c-=1){const u=l[c],{modifiers:d,hasImportantModifier:f,baseClassName:m,maybePostfixModifierPosition:h}=n(u);let x=!!h,y=r(x?m.substring(0,h):m);if(!y){if(!x){o=u+(o.length>0?" "+o:o);continue}if(y=r(m),!y){o=u+(o.length>0?" "+o:o);continue}x=!1}const p=nI(d).join(":"),g=f?p+nj:p,w=g+y;if(i.includes(w))continue;i.push(w);const v=s(y,x);for(let N=0;N<v.length;++N){const A=v[N];i.push(g+A)}o=u+(o.length>0?" "+o:o)}return o};function aI(){let e=0,t,n,r="";for(;e<arguments.length;)(t=arguments[e++])&&(n=rj(t))&&(r&&(r+=" "),r+=n);return r}const rj=e=>{if(typeof e=="string")return e;let t,n="";for(let r=0;r<e.length;r++)e[r]&&(t=rj(e[r]))&&(n&&(n+=" "),n+=t);return n};function oI(e,...t){let n,r,s,i=l;function l(c){const u=t.reduce((d,f)=>f(d),e());return n=rI(u),r=n.cache.get,s=n.cache.set,i=o,o(c)}function o(c){const u=r(c);if(u)return u;const d=iI(c,n);return s(c,d),d}return function(){return i(aI.apply(null,arguments))}}const dr=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},sj=/^\[(?:([a-z-]+):)?(.+)\]$/i,lI=/^\d+\/\d+$/,cI=new Set(["px","full","screen"]),uI=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,dI=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,fI=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,hI=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,mI=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Za=e=>uu(e)||cI.has(e)||lI.test(e),Fo=e=>Zu(e,"length",NI),uu=e=>!!e&&!Number.isNaN(Number(e)),Ug=e=>Zu(e,"number",uu),Md=e=>!!e&&Number.isInteger(Number(e)),pI=e=>e.endsWith("%")&&uu(e.slice(0,-1)),jn=e=>sj.test(e),Oo=e=>uI.test(e),gI=new Set(["length","size","percentage"]),xI=e=>Zu(e,gI,ij),yI=e=>Zu(e,"position",ij),bI=new Set(["image","url"]),vI=e=>Zu(e,bI,SI),wI=e=>Zu(e,"",jI),Rd=()=>!0,Zu=(e,t,n)=>{const r=sj.exec(e);return r?r[1]?typeof t=="string"?r[1]===t:t.has(r[1]):n(r[2]):!1},NI=e=>dI.test(e)&&!fI.test(e),ij=()=>!1,jI=e=>hI.test(e),SI=e=>mI.test(e),_I=()=>{const e=dr("colors"),t=dr("spacing"),n=dr("blur"),r=dr("brightness"),s=dr("borderColor"),i=dr("borderRadius"),l=dr("borderSpacing"),o=dr("borderWidth"),c=dr("contrast"),u=dr("grayscale"),d=dr("hueRotate"),f=dr("invert"),m=dr("gap"),h=dr("gradientColorStops"),x=dr("gradientColorStopPositions"),y=dr("inset"),p=dr("margin"),g=dr("opacity"),w=dr("padding"),v=dr("saturate"),N=dr("scale"),A=dr("sepia"),P=dr("skew"),U=dr("space"),M=dr("translate"),S=()=>["auto","contain","none"],C=()=>["auto","hidden","clip","visible","scroll"],_=()=>["auto",jn,t],T=()=>[jn,t],B=()=>["",Za,Fo],$=()=>["auto",uu,jn],D=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],L=()=>["solid","dashed","dotted","double","none"],O=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],W=()=>["start","end","center","between","around","evenly","stretch"],E=()=>["","0",jn],H=()=>["auto","avoid","all","avoid-page","page","left","right","column"],V=()=>[uu,jn];return{cacheSize:500,separator:":",theme:{colors:[Rd],spacing:[Za,Fo],blur:["none","",Oo,jn],brightness:V(),borderColor:[e],borderRadius:["none","","full",Oo,jn],borderSpacing:T(),borderWidth:B(),contrast:V(),grayscale:E(),hueRotate:V(),invert:E(),gap:T(),gradientColorStops:[e],gradientColorStopPositions:[pI,Fo],inset:_(),margin:_(),opacity:V(),padding:T(),saturate:V(),scale:V(),sepia:E(),skew:V(),space:T(),translate:T()},classGroups:{aspect:[{aspect:["auto","square","video",jn]}],container:["container"],columns:[{columns:[Oo]}],"break-after":[{"break-after":H()}],"break-before":[{"break-before":H()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...D(),jn]}],overflow:[{overflow:C()}],"overflow-x":[{"overflow-x":C()}],"overflow-y":[{"overflow-y":C()}],overscroll:[{overscroll:S()}],"overscroll-x":[{"overscroll-x":S()}],"overscroll-y":[{"overscroll-y":S()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[y]}],"inset-x":[{"inset-x":[y]}],"inset-y":[{"inset-y":[y]}],start:[{start:[y]}],end:[{end:[y]}],top:[{top:[y]}],right:[{right:[y]}],bottom:[{bottom:[y]}],left:[{left:[y]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Md,jn]}],basis:[{basis:_()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",jn]}],grow:[{grow:E()}],shrink:[{shrink:E()}],order:[{order:["first","last","none",Md,jn]}],"grid-cols":[{"grid-cols":[Rd]}],"col-start-end":[{col:["auto",{span:["full",Md,jn]},jn]}],"col-start":[{"col-start":$()}],"col-end":[{"col-end":$()}],"grid-rows":[{"grid-rows":[Rd]}],"row-start-end":[{row:["auto",{span:[Md,jn]},jn]}],"row-start":[{"row-start":$()}],"row-end":[{"row-end":$()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",jn]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",jn]}],gap:[{gap:[m]}],"gap-x":[{"gap-x":[m]}],"gap-y":[{"gap-y":[m]}],"justify-content":[{justify:["normal",...W()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...W(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...W(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[w]}],px:[{px:[w]}],py:[{py:[w]}],ps:[{ps:[w]}],pe:[{pe:[w]}],pt:[{pt:[w]}],pr:[{pr:[w]}],pb:[{pb:[w]}],pl:[{pl:[w]}],m:[{m:[p]}],mx:[{mx:[p]}],my:[{my:[p]}],ms:[{ms:[p]}],me:[{me:[p]}],mt:[{mt:[p]}],mr:[{mr:[p]}],mb:[{mb:[p]}],ml:[{ml:[p]}],"space-x":[{"space-x":[U]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[U]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",jn,t]}],"min-w":[{"min-w":[jn,t,"min","max","fit"]}],"max-w":[{"max-w":[jn,t,"none","full","min","max","fit","prose",{screen:[Oo]},Oo]}],h:[{h:[jn,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[jn,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[jn,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[jn,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Oo,Fo]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Ug]}],"font-family":[{font:[Rd]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",jn]}],"line-clamp":[{"line-clamp":["none",uu,Ug]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Za,jn]}],"list-image":[{"list-image":["none",jn]}],"list-style-type":[{list:["none","disc","decimal",jn]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[g]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[g]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...L(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Za,Fo]}],"underline-offset":[{"underline-offset":["auto",Za,jn]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:T()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",jn]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",jn]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[g]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...D(),yI]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",xI]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},vI]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[x]}],"gradient-via-pos":[{via:[x]}],"gradient-to-pos":[{to:[x]}],"gradient-from":[{from:[h]}],"gradient-via":[{via:[h]}],"gradient-to":[{to:[h]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[g]}],"border-style":[{border:[...L(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[g]}],"divide-style":[{divide:L()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...L()]}],"outline-offset":[{"outline-offset":[Za,jn]}],"outline-w":[{outline:[Za,Fo]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:B()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[g]}],"ring-offset-w":[{"ring-offset":[Za,Fo]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Oo,wI]}],"shadow-color":[{shadow:[Rd]}],opacity:[{opacity:[g]}],"mix-blend":[{"mix-blend":[...O(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":O()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",Oo,jn]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[f]}],saturate:[{saturate:[v]}],sepia:[{sepia:[A]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[f]}],"backdrop-opacity":[{"backdrop-opacity":[g]}],"backdrop-saturate":[{"backdrop-saturate":[v]}],"backdrop-sepia":[{"backdrop-sepia":[A]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[l]}],"border-spacing-x":[{"border-spacing-x":[l]}],"border-spacing-y":[{"border-spacing-y":[l]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",jn]}],duration:[{duration:V()}],ease:[{ease:["linear","in","out","in-out",jn]}],delay:[{delay:V()}],animate:[{animate:["none","spin","ping","pulse","bounce",jn]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[N]}],"scale-x":[{"scale-x":[N]}],"scale-y":[{"scale-y":[N]}],rotate:[{rotate:[Md,jn]}],"translate-x":[{"translate-x":[M]}],"translate-y":[{"translate-y":[M]}],"skew-x":[{"skew-x":[P]}],"skew-y":[{"skew-y":[P]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",jn]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",jn]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":T()}],"scroll-mx":[{"scroll-mx":T()}],"scroll-my":[{"scroll-my":T()}],"scroll-ms":[{"scroll-ms":T()}],"scroll-me":[{"scroll-me":T()}],"scroll-mt":[{"scroll-mt":T()}],"scroll-mr":[{"scroll-mr":T()}],"scroll-mb":[{"scroll-mb":T()}],"scroll-ml":[{"scroll-ml":T()}],"scroll-p":[{"scroll-p":T()}],"scroll-px":[{"scroll-px":T()}],"scroll-py":[{"scroll-py":T()}],"scroll-ps":[{"scroll-ps":T()}],"scroll-pe":[{"scroll-pe":T()}],"scroll-pt":[{"scroll-pt":T()}],"scroll-pr":[{"scroll-pr":T()}],"scroll-pb":[{"scroll-pb":T()}],"scroll-pl":[{"scroll-pl":T()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",jn]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Za,Fo,Ug]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},AI=oI(_I);function Ai(...e){return AI(Y9(e))}/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var kI={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EI=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),bt=(e,t)=>{const n=Y.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:l,className:o="",children:c,...u},d)=>Y.createElement("svg",{ref:d,...kI,width:s,height:s,stroke:r,strokeWidth:l?Number(i)*24/Number(s):i,className:["lucide",`lucide-${EI(e)}`,o].join(" "),...u},[...t.map(([f,m])=>Y.createElement(f,m)),...Array.isArray(c)?c:[c]]));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ii=bt("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fo=bt("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ho=bt("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zi=bt("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const na=bt("Baby",[["path",{d:"M9 12h.01",key:"157uk2"}],["path",{d:"M15 12h.01",key:"1k8ypt"}],["path",{d:"M10 16c.5.3 1.2.5 2 .5s1.5-.2 2-.5",key:"1u7htd"}],["path",{d:"M19 6.3a9 9 0 0 1 1.8 3.9 2 2 0 0 1 0 3.6 9 9 0 0 1-17.6 0 2 2 0 0 1 0-3.6A9 9 0 0 1 12 3c2 0 3.5 1.1 3.5 2.5s-.9 2.5-2 2.5c-.8 0-1.5-.4-1.5-1",key:"5yv0yz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CI=bt("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PI=bt("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qo=bt("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ur=bt("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dh=bt("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Si=bt("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bs=bt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ny=bt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aj=bt("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y0=bt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const II=bt("Cloud",[["path",{d:"M17.5 19H9a7 7 0 1 1 6.71-9h1.79a4.5 4.5 0 1 1 0 9Z",key:"p7xjir"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tf=bt("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nu=bt("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TI=bt("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LI=bt("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ry=bt("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oj=bt("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ra=bt("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MI=bt("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const du=bt("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mo=bt("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RI=bt("GraduationCap",[["path",{d:"M22 10v6M2 10l10-5 10 5-10 5z",key:"1ef52a"}],["path",{d:"M6 12v5c3 3 9 3 12 0v-5",key:"1f75yj"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $I=bt("HardDrive",[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FI=bt("Headphones",[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Or=bt("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b0=bt("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OI=bt("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ju=bt("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DI=bt("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lj=bt("Languages",[["path",{d:"m5 8 6 6",key:"1wu5hv"}],["path",{d:"m4 14 6-6 2-3",key:"1k1g8d"}],["path",{d:"M2 5h12",key:"or177f"}],["path",{d:"M7 2h1",key:"1t2jsx"}],["path",{d:"m22 22-5-10-5 10",key:"don7ne"}],["path",{d:"M14 18h6",key:"1m8k6r"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BI=bt("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zI=bt("Linkedin",[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UI=bt("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wr=bt("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zi=bt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wx=bt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pa=bt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ai=bt("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qI=bt("Maximize",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cj=bt("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HI=bt("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uj=bt("Minimize",[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3",key:"hohbtr"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3",key:"5jw1f3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3",key:"198tvr"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3",key:"ph8mxp"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t5=bt("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lf=bt("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WI=bt("MoreVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VI=bt("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",key:"1xcu5"}],["circle",{cx:"17.5",cy:"10.5",r:".5",key:"736e4u"}],["circle",{cx:"8.5",cy:"7.5",r:".5",key:"clrty"}],["circle",{cx:"6.5",cy:"12.5",r:".5",key:"1s4xz9"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sa=bt("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Su=bt("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _u=bt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const po=bt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Au=bt("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qi=bt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n5=bt("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mf=bt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fh=bt("Share2",[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v0=bt("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GI=bt("SlidersHorizontal",[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YI=bt("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JI=bt("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dj=bt("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rf=bt("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZI=bt("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ia=bt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qn=bt("TreePine",[["path",{d:"m17 14 3 3.3a1 1 0 0 1-.7 1.7H4.7a1 1 0 0 1-.7-1.7L7 14h-.3a1 1 0 0 1-.7-1.7L9 9h-.2A1 1 0 0 1 8 7.3L12 3l4 4.3a1 1 0 0 1-.8 1.7H15l3 3.3a1 1 0 0 1-.7 1.7H17Z",key:"cpyugq"}],["path",{d:"M12 22v-3",key:"kmzjlo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hp=bt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XI=bt("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KI=bt("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hm=bt("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nx=bt("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fj=bt("UserRoundCheck",[["path",{d:"M2 21a8 8 0 0 1 13.292-6",key:"bjp14o"}],["circle",{cx:"10",cy:"8",r:"5",key:"o932ke"}],["path",{d:"m16 19 2 2 4-4",key:"1b14m6"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Na=bt("UserRound",[["circle",{cx:"12",cy:"8",r:"5",key:"1hypcn"}],["path",{d:"M20 21a8 8 0 0 0-16 0",key:"rfgkzh"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hj=bt("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sn=bt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const In=bt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vf=bt("VenetianMask",[["path",{d:"M2 12a5 5 0 0 0 5 5 8 8 0 0 1 5 2 8 8 0 0 1 5-2 5 5 0 0 0 5-5V7h-5a8 8 0 0 0-5 2 8 8 0 0 0-5-2H2Z",key:"1g6z3j"}],["path",{d:"M6 11c1.5 0 3 .5 3 2-2 0-3 0-3-2Z",key:"c2lwnf"}],["path",{d:"M18 11c-1.5 0-3 .5-3 2 2 0 3 0 3-2Z",key:"njd9zo"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QI=bt("Volume2",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["path",{d:"M15.54 8.46a5 5 0 0 1 0 7.07",key:"ltjumu"}],["path",{d:"M19.07 4.93a10 10 0 0 1 0 14.14",key:"1kegas"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eT=bt("VolumeX",[["polygon",{points:"11 5 6 9 2 9 2 15 6 15 11 19 11 5",key:"16drj5"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sy=bt("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ia=bt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.294.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tT=bt("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),ge=({className:e,variant:t="default",size:n="default",asChild:r=!1,loading:s=!1,loadingText:i,children:l,disabled:o,...c})=>{const u={default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},d={default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"},f={...c};return delete f.asChild,delete f.loading,delete f.loadingText,a.jsxs("button",{className:Ai("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",u[t],d[n],e),disabled:o||s,...f,children:[s&&a.jsx(wr,{className:"mr-2 h-4 w-4 animate-spin"}),s&&i?i:l]})},$d=({children:e})=>{const{language:t,theme:n,setLanguage:r,setTheme:s}=Xt(),i=()=>{r(t==="en"?"ar":"en")},l=()=>{s(n==="light"?"dark":"light")};return a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-primary/5 via-background to-primary/5",children:[a.jsx("header",{className:"absolute top-0 left-0 right-0 z-10",children:a.jsxs("div",{className:"flex items-center justify-between p-6",children:[a.jsxs(It,{to:"/",className:"flex items-center space-x-2",children:[a.jsxs("svg",{className:"h-8 w-8 text-primary",viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("circle",{cx:"50",cy:"50",r:"45",stroke:"currentColor",strokeWidth:"2",fill:"none",opacity:"0.3"}),a.jsx("path",{d:"M50 20 L35 35 L50 50 L65 35 Z",fill:"currentColor"}),a.jsx("path",{d:"M35 35 L20 50 L35 65 L50 50 Z",fill:"currentColor",opacity:"0.8"}),a.jsx("path",{d:"M65 35 L80 50 L65 65 L50 50 Z",fill:"currentColor",opacity:"0.8"}),a.jsx("path",{d:"M35 65 L50 80 L65 65 L50 50 Z",fill:"currentColor",opacity:"0.6"}),a.jsx("circle",{cx:"50",cy:"35",r:"3",fill:"currentColor"}),a.jsx("circle",{cx:"35",cy:"50",r:"3",fill:"currentColor"}),a.jsx("circle",{cx:"65",cy:"50",r:"3",fill:"currentColor"}),a.jsx("circle",{cx:"50",cy:"65",r:"3",fill:"currentColor"})]}),a.jsx("span",{className:"text-xl font-bold text-foreground",children:t==="ar"?"":"Nasabna"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(ge,{variant:"ghost",size:"icon",onClick:l,className:"h-9 w-9",children:n==="light"?a.jsx(Lf,{className:"h-4 w-4"}):a.jsx(Rf,{className:"h-4 w-4"})}),a.jsx(ge,{variant:"ghost",size:"icon",onClick:i,className:"h-9 w-9",children:a.jsx(mo,{className:"h-4 w-4"})})]})]})}),a.jsxs("div",{className:"flex min-h-screen",children:[a.jsx("div",{className:"hidden lg:flex lg:flex-1 lg:flex-col lg:justify-center lg:px-8",children:a.jsx("div",{className:"mx-auto max-w-md",children:a.jsxs("div",{className:"text-center",children:[a.jsxs("svg",{className:"mx-auto h-24 w-24 text-primary mb-8",viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("circle",{cx:"50",cy:"50",r:"45",stroke:"currentColor",strokeWidth:"2",fill:"none",opacity:"0.3"}),a.jsx("path",{d:"M50 20 L35 35 L50 50 L65 35 Z",fill:"currentColor"}),a.jsx("path",{d:"M35 35 L20 50 L35 65 L50 50 Z",fill:"currentColor",opacity:"0.8"}),a.jsx("path",{d:"M65 35 L80 50 L65 65 L50 50 Z",fill:"currentColor",opacity:"0.8"}),a.jsx("path",{d:"M35 65 L50 80 L65 65 L50 50 Z",fill:"currentColor",opacity:"0.6"}),a.jsx("circle",{cx:"50",cy:"35",r:"3",fill:"currentColor"}),a.jsx("circle",{cx:"35",cy:"50",r:"3",fill:"currentColor"}),a.jsx("circle",{cx:"65",cy:"50",r:"3",fill:"currentColor"}),a.jsx("circle",{cx:"50",cy:"65",r:"3",fill:"currentColor"})]}),a.jsx("h1",{className:"text-3xl font-bold text-foreground mb-4",children:t==="ar"?"":"Nasabna"}),a.jsx("p",{className:"text-lg text-muted-foreground mb-8",children:t==="ar"?"        ":"Discover your family history and build your genealogy with our comprehensive platform"}),a.jsxs("div",{className:"space-y-4 text-left",children:[a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"flex-shrink-0 w-2 h-2 bg-primary rounded-full"}),a.jsx("span",{className:"text-sm text-muted-foreground",children:t==="ar"?"   ":"Full Arabic language support"})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"flex-shrink-0 w-2 h-2 bg-primary rounded-full"}),a.jsx("span",{className:"text-sm text-muted-foreground",children:t==="ar"?"  ":"Interactive family trees"})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"flex-shrink-0 w-2 h-2 bg-primary rounded-full"}),a.jsx("span",{className:"text-sm text-muted-foreground",children:t==="ar"?"   ":"Secure family sharing"})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"flex-shrink-0 w-2 h-2 bg-primary rounded-full"}),a.jsx("span",{className:"text-sm text-muted-foreground",children:t==="ar"?"  ":"Photo and document storage"})]})]})]})})}),a.jsx("div",{className:"flex flex-1 flex-col justify-center px-6 py-12 lg:px-8",children:a.jsx("div",{className:"mx-auto w-full max-w-md",children:e})})]}),a.jsx("footer",{className:"absolute bottom-0 left-0 right-0 p-6",children:a.jsx("div",{className:"text-center",children:a.jsxs("p",{className:"text-xs text-muted-foreground",children:[" 2024 ",t==="ar"?"":"Nasabna",". ",t==="ar"?"  ":"All rights reserved","."]})})})]})},nT=e=>e&&typeof e=="object"&&("en"in e||"ar"in e),mj=()=>{const{language:e,showSuccess:t,showError:n,showWarning:r,showInfo:s}=Xt();return{success:(u,d)=>{t(u,d)},error:(u,d)=>{n(u,d)},warning:(u,d)=>{r(u,d)},info:(u,d)=>{s(u,d)}}},r5=(e,t)=>nT(e)?t==="ar"?e.ar:e.en:e,rT=({notification:e,onClose:t})=>{const{type:n,title:r,message:s,id:i,action:l}=e,{language:o}=Xt(),c=()=>r5(r,o),u=()=>r5(s,o),d=()=>{switch(n){case"success":return a.jsx(Si,{className:"h-5 w-5 text-green-500"});case"error":return a.jsx(ii,{className:"h-5 w-5 text-red-500"});case"warning":return a.jsx(fo,{className:"h-5 w-5 text-yellow-500"});case"info":return a.jsx(ju,{className:"h-5 w-5 text-blue-500"});default:return null}},f=()=>{switch(n){case"success":return"bg-green-50 border-green-200";case"error":return"bg-red-50 border-red-200";case"warning":return"bg-yellow-50 border-yellow-200";case"info":return"bg-blue-50 border-blue-200";default:return"bg-white border-gray-200"}},m=()=>{switch(n){case"success":return"text-green-800";case"error":return"text-red-800";case"warning":return"text-yellow-800";case"info":return"text-blue-800";default:return"text-gray-800"}},h=()=>{switch(n){case"success":return"text-green-700";case"error":return"text-red-700";case"warning":return"text-yellow-700";case"info":return"text-blue-700";default:return"text-gray-700"}};return a.jsxs("div",{className:`flex items-start p-4 rounded-lg border shadow-lg max-w-sm w-full ${f()}`,role:"alert","aria-live":"assertive",dir:o==="ar"?"rtl":"ltr",children:[a.jsx("div",{className:"flex-shrink-0",children:d()}),a.jsxs("div",{className:"ml-3 flex-1",children:[a.jsx("h3",{className:`text-sm font-medium ${m()}`,children:c()}),u()&&a.jsx("div",{className:`mt-1 text-sm ${h()}`,children:a.jsx("p",{children:u()})}),l&&a.jsx("div",{className:"mt-3",children:a.jsx("button",{type:"button",onClick:l.onClick,className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded text-white bg-primary hover:bg-primary/90 focus:outline-none",children:l.label})})]}),a.jsx("div",{className:"ml-4 flex-shrink-0",children:a.jsx("button",{type:"button",className:"inline-flex rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2",onClick:()=>t(i),"aria-label":o==="ar"?"":"Close",children:a.jsx(ia,{className:"h-5 w-5 text-gray-400 hover:text-gray-500"})})})]})},sT=()=>{const{notifications:e,removeNotification:t}=Xt(),n=e.slice(-3);return a.jsx("div",{className:"fixed top-4 left-1/2 transform -translate-x-1/2 z-50 space-y-2 w-full px-4 flex flex-col items-center",style:{direction:"ltr"},children:n.map(r=>a.jsx(rT,{notification:r,onClose:t},r.id))})},Fd={},s5=5*60*1e3,i5={},iT=[{id:"basic",name:"Basic",price:{month:1,year:12},currency:"USD",features:{maxTrees:1,maxPeoplePerTree:50,maxPhotosPerPerson:0,maxDocumentsPerPerson:0,storage:1073741824,canShare:!0,canExport:!1,smartSuggestions:!1,prioritySupport:!1,customThemes:!1,advancedSearch:!1,collaborators:1},popular:!1},{id:"premium",name:"Premium",price:{month:19.99,year:199.99},currency:"USD",features:{maxTrees:3,maxPeoplePerTree:150,maxPhotosPerPerson:5,maxDocumentsPerPerson:0,storage:10737418240,canShare:!0,canExport:!0,smartSuggestions:!0,prioritySupport:!0,customThemes:!1,advancedSearch:!1,collaborators:5},popular:!0},{id:"family",name:"Family",price:{month:29.99,year:299.99},currency:"USD",features:{maxTrees:0,maxPeoplePerTree:0,maxPhotosPerPerson:20,maxDocumentsPerPerson:5,storage:53687091200,canShare:!0,canExport:!0,smartSuggestions:!0,prioritySupport:!0,customThemes:!0,advancedSearch:!0,collaborators:0},popular:!1}],jx={getSubscriptionPlans:async()=>(await new Promise(e=>setTimeout(e,500)),iT),subscribeToPlan:async(e,t,n="usd",r="year")=>{try{const s="https://qabael.premiumasp.net/api";let i="";r==="year"||t.includes("_year")?i=`${s}/Payments/CreateSubscription/`:i=`${s}/payments/OneTimePaid/`;const l=await fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e,currency:n,productId:t})});if(!l.ok)return console.warn("Subscription API not available, simulating success"),{url:"/subscription/success"};const o=await l.json();if(o.url){window.location.href=o.url;return}else if(o.Url){window.location.href=o.Url;return}if(o.clientSecret)return{clientSecret:o.clientSecret};throw new Error("Failed to create subscription")}catch(s){return console.warn("Subscription API error, simulating success:",s),{url:"/subscription/success"}}},getUserSubscriptionStatus:async e=>{if(!e||e==="unknown"||e.trim()==="")return console.warn("Invalid userId provided to getUserSubscriptionStatus:",e),{isActive:!1,planId:"basic",status:"inactive"};const t=i5[e]||0,n=Date.now();if(n-t<3e4){const s=Fd[e];return s&&n-s.timestamp<s5?s.data:{isActive:!1,planId:"basic",status:"inactive"}}i5[e]=n;const r=Fd[e];if(r&&n-r.timestamp<s5)return r.data;try{const i=await fetch(`https://qabael.premiumasp.net/api/payments/UserSubscriptionStatus/${e}`);if(!i.ok){const o={isActive:!1,planId:"basic",status:"inactive"};return Fd[e]={data:o,timestamp:n},o}const l=await i.json();return Fd[e]={data:l,timestamp:n},l}catch{const i={isActive:!1,planId:"basic",status:"inactive"};return Fd[e]={data:i,timestamp:n},i}},getCurrentSubscription:async e=>(await new Promise(t=>setTimeout(t,300)),null),getUsage:async()=>(await new Promise(e=>setTimeout(e,300)),{trees:0,members:0,photos:0,documents:0,storage:0})},gs=({children:e})=>{var M,S,C,_,T;const[t,n]=we.useState(!1),[r,s]=we.useState(!1),[i,l]=we.useState(null),[o,c]=we.useState(!1),u=G2(),d=Ir(),{user:f,logout:m,updateUser:h}=Pr(),{language:x,theme:y,setLanguage:p,setTheme:g}=Xt(),w=!!f;Y.useEffect(()=>{if(!f||!f.id&&!f.email&&!f.firstName)return;const B=f.id||f.email||f.firstName;if(!B||B==="unknown"||f!=null&&f.subscription)return;const $=setTimeout(()=>{(async()=>{c(!0);try{let L="unknown";if(f!=null&&f.id&&f.id!=="unknown"&&f.id.trim()!==""?L=f.id:f!=null&&f.email&&f.email.trim()!==""?L=f.email:f!=null&&f.firstName&&f.firstName.trim()!==""&&(L=f.firstName),!L||L==="unknown"||L.trim()===""){console.warn("Unable to fetch subscription status: No valid user identifier"),c(!1);return}const O=`subscription_${L}`,W=sessionStorage.getItem(O);if(W){const{timestamp:H,data:V}=JSON.parse(W);if(Date.now()-H<3e5){l(V),c(!1);return}}const E=await jx.getUserSubscriptionStatus(L);sessionStorage.setItem(O,JSON.stringify({timestamp:Date.now(),data:E})),E&&(l(E),E&&E.plan&&h({subscription:{id:E.id||"sub_"+Date.now(),plan:E.plan,status:E.status||"active",currentPeriodStart:E.currentPeriodStart||new Date().toISOString(),currentPeriodEnd:E.currentPeriodEnd||new Date(Date.now()+2592e6).toISOString(),cancelAtPeriodEnd:E.cancelAtPeriodEnd||!1,createdAt:E.createdAt||new Date().toISOString(),updatedAt:E.updatedAt||new Date().toISOString(),billing:{amount:0,currency:"usd",interval:"month"},features:{maxTrees:1,maxPeoplePerTree:5,maxPhotosPerPerson:0,maxDocumentsPerPerson:0,storage:1073741824,canShare:!0,canExport:!1,smartSuggestions:!1,prioritySupport:!1,customThemes:!1,advancedSearch:!1,collaborators:1},limits:{trees:1,people:5,photos:0,documents:0,storage:1073741824,collaborators:1},usage:{trees:0,people:0,photos:0,documents:0,storage:0,collaborators:0}}}))}catch(L){console.warn("Failed to fetch subscription status:",L)}finally{c(!1)}})()},1e3);return()=>clearTimeout($)},[f,h]);const v=[{name:"Dashboard",nameAr:" ",href:"/dashboard",icon:b0},{name:"Family Trees",nameAr:" ",href:"/trees",icon:In},{name:"Profile",nameAr:" ",href:"/profile",icon:sn},{name:"Subscription",nameAr:"",href:"/subscription",icon:Tf},{name:"Settings",nameAr:"",href:"/settings",icon:Mf},...(f==null?void 0:f.role)==="admin"?[{name:"Admin Dashboard",nameAr:" ",href:"/admin/dashboard",icon:In}]:[]],N=()=>{p(x==="en"?"ar":"en")},A=()=>{g(y==="light"?"dark":"light")},P=async()=>{try{await m(),d("/")}catch{}},U=B=>u.pathname===B||u.pathname.startsWith(B+"/");return we.useEffect(()=>{x==="ar"?document.documentElement.setAttribute("dir","rtl"):document.documentElement.setAttribute("dir","ltr")},[x]),we.useEffect(()=>{const B=()=>{window.innerWidth>=1024&&n(!1)};return window.addEventListener("resize",B),()=>window.removeEventListener("resize",B)},[]),we.useEffect(()=>{const B=$=>{if(r){const D=document.getElementById("profile-dropdown"),L=document.getElementById("profile-button");D&&L&&!D.contains($.target)&&!L.contains($.target)&&s(!1)}};return document.addEventListener("mousedown",B),()=>document.removeEventListener("mousedown",B)},[r]),w?a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsx(sT,{}),a.jsx("div",{className:`hidden lg:fixed lg:inset-y-0 lg:z-50 lg:flex lg:w-72 lg:flex-col ${x==="ar"?"lg:right-0":"lg:left-0"}`,children:a.jsxs("div",{className:"flex grow flex-col gap-y-5 overflow-y-auto bg-card border-border px-6 pb-4 lg:border-r",children:[a.jsx("div",{className:"flex h-16 shrink-0 items-center",children:a.jsxs(It,{to:"/dashboard",className:`flex items-center ${x==="ar"?"space-x-reverse":"space-x-2"}`,children:[a.jsxs("svg",{className:"h-8 w-8 text-primary",viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("circle",{cx:"50",cy:"50",r:"45",stroke:"currentColor",strokeWidth:"2",fill:"none",opacity:"0.3"}),a.jsx("path",{d:"M50 20 L35 35 L50 50 L65 35 Z",fill:"currentColor"}),a.jsx("path",{d:"M35 35 L20 50 L35 65 L50 50 Z",fill:"currentColor",opacity:"0.8"}),a.jsx("path",{d:"M65 35 L80 50 L65 65 L50 50 Z",fill:"currentColor",opacity:"0.8"}),a.jsx("path",{d:"M35 65 L50 80 L65 65 L50 50 Z",fill:"currentColor",opacity:"0.6"}),a.jsx("circle",{cx:"50",cy:"35",r:"3",fill:"currentColor"}),a.jsx("circle",{cx:"35",cy:"50",r:"3",fill:"currentColor"}),a.jsx("circle",{cx:"65",cy:"50",r:"3",fill:"currentColor"}),a.jsx("circle",{cx:"50",cy:"65",r:"3",fill:"currentColor"})]}),a.jsx("span",{className:`text-lg font-semibold text-foreground ${x==="ar"?"rtl:text-right":""}`,children:x==="ar"?"":"Nasabna"})]})}),a.jsx("nav",{className:"flex flex-1 flex-col",children:a.jsxs("ul",{role:"list",className:"flex flex-1 flex-col gap-y-7",children:[a.jsx("li",{children:a.jsx("ul",{role:"list",className:"-mx-2 space-y-1",children:v.map(B=>a.jsx("li",{children:a.jsxs(It,{to:B.href,className:`group flex items-center rounded-md p-2 text-sm leading-6 font-semibold transition-colors ${U(B.href)?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground hover:bg-muted"} ${x==="ar"?"flex-row-reverse":""}`,children:[a.jsx(B.icon,{className:"h-6 w-6 shrink-0","aria-hidden":"true"}),a.jsx("span",{className:`truncate ${x==="ar"?"mr-3":"ml-3"}`,children:x==="ar"?B.nameAr:B.name})]})},B.name))})}),a.jsxs("li",{children:[a.jsx("div",{className:"text-xs font-semibold leading-6 text-muted-foreground px-2 py-1",children:x==="ar"?"":"Subscription"}),a.jsx("ul",{role:"list",className:"-mx-2 space-y-1",children:o?a.jsx("li",{children:a.jsxs("div",{className:"group flex items-center rounded-md p-2 text-sm leading-6 font-semibold bg-muted",children:[a.jsx("div",{className:"h-4 w-4 rounded-full bg-muted animate-pulse mr-3"}),a.jsx("div",{className:"h-4 w-20 bg-muted rounded animate-pulse"})]})}):f!=null&&f.subscription||i?a.jsx("li",{children:a.jsxs("div",{className:"group flex items-center rounded-md p-2 text-sm leading-6 font-semibold bg-muted",children:[a.jsx(hp,{className:"h-5 w-5 shrink-0 text-green-500","aria-hidden":"true"}),a.jsxs("div",{className:"ml-3 flex-1 min-w-0",children:[a.jsx("div",{className:"truncate capitalize",children:((M=f==null?void 0:f.subscription)==null?void 0:M.plan)||(i==null?void 0:i.plan)||"basic"}),a.jsx("div",{className:"text-xs text-muted-foreground",children:((S=f==null?void 0:f.subscription)==null?void 0:S.status)==="active"||(i==null?void 0:i.status)==="active"?x==="ar"?"":"Active":x==="ar"?"":"Expired"})]})]})}):a.jsx("li",{children:a.jsxs(It,{to:"/subscription",className:"group flex items-center rounded-md p-2 text-sm leading-6 font-semibold text-muted-foreground hover:text-foreground hover:bg-muted",children:[a.jsx(ii,{className:"h-5 w-5 shrink-0","aria-hidden":"true"}),a.jsx("span",{className:"ml-3 truncate",children:x==="ar"?" ":"Subscribe Now"})]})})})]})]})})]})}),a.jsxs("div",{className:`${x==="ar"?"lg:pr-72":"lg:pl-72"}`,children:[a.jsxs("div",{className:"sticky top-0 z-40 flex h-16 shrink-0 items-center gap-x-4 border-b border-border bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 px-4 shadow-sm sm:gap-x-6 sm:px-6 lg:px-8",children:[a.jsxs("button",{type:"button",className:"-m-2.5 p-2.5 text-muted-foreground lg:hidden",onClick:()=>n(!0),children:[a.jsx("span",{className:"sr-only",children:"Open sidebar"}),a.jsx(cj,{className:"h-6 w-6","aria-hidden":"true"})]}),a.jsx("div",{className:"h-6 w-px bg-border lg:hidden","aria-hidden":"true"}),a.jsxs("div",{className:"flex flex-1 gap-x-4 self-stretch lg:gap-x-6",children:[a.jsx("div",{className:"flex flex-1"}),a.jsxs("div",{className:"flex items-center gap-x-4 lg:gap-x-6",children:[a.jsx(ge,{variant:"ghost",size:"icon",onClick:A,className:"h-9 w-9",children:y==="light"?a.jsx(Lf,{className:"h-4 w-4"}):a.jsx(Rf,{className:"h-4 w-4"})}),a.jsx(ge,{variant:"ghost",size:"icon",onClick:N,className:"h-9 w-9",children:a.jsx(mo,{className:"h-4 w-4"})}),a.jsx("div",{className:"hidden lg:block lg:h-6 lg:w-px lg:bg-border","aria-hidden":"true"}),a.jsxs("div",{className:"relative",children:[a.jsxs(ge,{id:"profile-button",variant:"ghost",className:"flex items-center space-x-2 rounded-full p-1 hover:bg-muted",onClick:()=>s(!r),children:[a.jsx("div",{className:"flex-shrink-0",children:(C=f==null?void 0:f.avatar)!=null&&C.url?a.jsx("img",{className:"h-8 w-8 rounded-full object-cover",src:f.avatar.url,alt:`${(f==null?void 0:f.firstName)||""} ${(f==null?void 0:f.lastName)||""}`}):a.jsx("div",{className:"h-8 w-8 rounded-full bg-primary/10 flex items-center justify-center",children:a.jsx(sn,{className:"h-4 w-4 text-primary"})})}),a.jsxs("div",{className:"hidden lg:block text-left",children:[a.jsx("p",{className:"text-sm font-medium text-foreground",children:f!=null&&f.firstName?`${f.firstName} ${(f==null?void 0:f.lastName)||""}`.trim():(f==null?void 0:f.email)||"User"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:(f==null?void 0:f.email)||""})]}),a.jsx(ny,{className:"hidden lg:block h-4 w-4 text-muted-foreground"})]}),r&&a.jsx("div",{id:"profile-dropdown",className:`absolute z-10 mt-2 w-56 origin-top-right rounded-md bg-card shadow-lg ring-1 ring-border focus:outline-none ${x==="ar"?"left-0":"right-0"}`,children:a.jsxs("div",{className:"p-1",children:[a.jsxs("div",{className:"px-4 py-2 border-b border-border",children:[a.jsx("p",{className:"text-sm font-medium text-foreground",children:f!=null&&f.firstName?`${f.firstName} ${(f==null?void 0:f.lastName)||""}`.trim():(f==null?void 0:f.email)||"User"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:(f==null?void 0:f.email)||""})]}),a.jsx(It,{to:"/profile",className:"block px-4 py-2 text-sm text-foreground hover:bg-muted rounded-md",onClick:()=>s(!1),children:x==="ar"?" ":"Profile"}),a.jsx(It,{to:"/settings",className:"block px-4 py-2 text-sm text-foreground hover:bg-muted rounded-md",onClick:()=>s(!1),children:x==="ar"?"":"Settings"}),a.jsxs("button",{onClick:()=>{s(!1),P()},className:"w-full text-left px-4 py-2 text-sm text-foreground hover:bg-muted rounded-md flex items-center",children:[a.jsx(wx,{className:"mr-2 h-4 w-4"}),x==="ar"?" ":"Logout"]})]})})]})]})]})]}),a.jsx("main",{className:"py-6",children:a.jsx("div",{className:"px-4 sm:px-6 lg:px-8",children:e})})]}),t&&a.jsxs("div",{className:"lg:hidden fixed inset-0 z-50",children:[a.jsx("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm",onClick:()=>n(!1)}),a.jsx("div",{className:"fixed inset-0 flex",children:a.jsxs("div",{className:`relative flex w-full max-w-xs flex-1 ${x==="ar"?"ml-16":"mr-16"}`,children:[a.jsx("div",{className:`absolute top-0 flex w-16 justify-center pt-5 ${x==="ar"?"right-full":"left-full"}`,children:a.jsxs("button",{type:"button",className:"-m-2.5 p-2.5",onClick:()=>n(!1),children:[a.jsx("span",{className:"sr-only",children:"Close sidebar"}),a.jsx(ia,{className:"h-6 w-6 text-foreground","aria-hidden":"true"})]})}),a.jsxs("div",{className:"flex grow flex-col gap-y-5 overflow-y-auto bg-card px-6 pb-4 ring-1 ring-border/10",children:[a.jsx("div",{className:"flex h-16 shrink-0 items-center",children:a.jsxs(It,{to:"/dashboard",className:`flex items-center ${x==="ar"?"space-x-reverse":"space-x-2"}`,onClick:()=>n(!1),children:[a.jsxs("svg",{className:"h-8 w-8 text-primary",viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("circle",{cx:"50",cy:"50",r:"45",stroke:"currentColor",strokeWidth:"2",fill:"none",opacity:"0.3"}),a.jsx("path",{d:"M50 20 L35 35 L50 50 L65 35 Z",fill:"currentColor"}),a.jsx("path",{d:"M35 35 L20 50 L35 65 L50 50 Z",fill:"currentColor",opacity:"0.8"}),a.jsx("path",{d:"M65 35 L80 50 L65 65 L50 50 Z",fill:"currentColor",opacity:"0.8"}),a.jsx("path",{d:"M35 65 L50 80 L65 65 L50 50 Z",fill:"currentColor",opacity:"0.6"}),a.jsx("circle",{cx:"50",cy:"35",r:"3",fill:"currentColor"}),a.jsx("circle",{cx:"35",cy:"50",r:"3",fill:"currentColor"}),a.jsx("circle",{cx:"65",cy:"50",r:"3",fill:"currentColor"}),a.jsx("circle",{cx:"50",cy:"65",r:"3",fill:"currentColor"})]}),a.jsx("span",{className:`text-lg font-semibold text-foreground ${x==="ar"?"rtl:text-right":""}`,children:x==="ar"?"":"Nasabna"})]})}),a.jsx("nav",{className:"flex flex-1 flex-col",children:a.jsxs("ul",{role:"list",className:"flex flex-1 flex-col gap-y-7",children:[a.jsx("li",{children:a.jsx("ul",{role:"list",className:"-mx-2 space-y-1",children:v.map(B=>a.jsx("li",{children:a.jsxs(It,{to:B.href,className:`group flex items-center rounded-md p-2 text-sm leading-6 font-semibold transition-colors ${U(B.href)?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground hover:bg-muted"} ${x==="ar"?"flex-row-reverse":""}`,onClick:()=>n(!1),children:[a.jsx(B.icon,{className:"h-6 w-6 shrink-0","aria-hidden":"true"}),a.jsx("span",{className:`truncate ${x==="ar"?"mr-3":"ml-3"}`,children:x==="ar"?B.nameAr:B.name})]})},B.name))})}),a.jsxs("li",{children:[a.jsx("div",{className:"text-xs font-semibold leading-6 text-muted-foreground px-2 py-1",children:x==="ar"?"":"Subscription"}),a.jsx("ul",{role:"list",className:"-mx-2 space-y-1",children:o?a.jsx("li",{children:a.jsxs("div",{className:"group flex items-center rounded-md p-2 text-sm leading-6 font-semibold bg-muted",children:[a.jsx("div",{className:"h-4 w-4 rounded-full bg-muted animate-pulse mr-3"}),a.jsx("div",{className:"h-4 w-20 bg-muted rounded animate-pulse"})]})}):f!=null&&f.subscription||i?a.jsx("li",{children:a.jsxs("div",{className:"group flex items-center rounded-md p-2 text-sm leading-6 font-semibold bg-muted",children:[a.jsx(hp,{className:"h-5 w-5 shrink-0 text-green-500","aria-hidden":"true"}),a.jsxs("div",{className:"ml-3 flex-1 min-w-0",children:[a.jsx("div",{className:"truncate capitalize",children:((_=f==null?void 0:f.subscription)==null?void 0:_.plan)||(i==null?void 0:i.plan)||"basic"}),a.jsx("div",{className:"text-xs text-muted-foreground",children:((T=f==null?void 0:f.subscription)==null?void 0:T.status)==="active"||(i==null?void 0:i.status)==="active"?x==="ar"?"":"Active":x==="ar"?"":"Expired"})]})]})}):a.jsx("li",{children:a.jsxs(It,{to:"/subscription",className:"group flex items-center rounded-md p-2 text-sm leading-6 font-semibold text-muted-foreground hover:text-foreground hover:bg-muted",onClick:()=>n(!1),children:[a.jsx(ii,{className:"h-5 w-5 shrink-0","aria-hidden":"true"}),a.jsx("span",{className:"ml-3 truncate",children:x==="ar"?" ":"Subscribe Now"})]})})})]})]})})]})]})})]})]}):a.jsx("div",{className:"min-h-screen bg-background",children:a.jsxs("div",{className:`${x==="ar"?"lg:pr-72":"lg:pl-72"}`,children:[a.jsxs("div",{className:"sticky top-0 z-40 flex h-16 shrink-0 items-center gap-x-4 border-b border-border bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 px-4 shadow-sm sm:gap-x-6 sm:px-6 lg:px-8",children:[a.jsx("div",{className:"flex flex-1"}),a.jsx("div",{className:"flex items-center gap-x-4 lg:gap-x-6",children:a.jsx("div",{className:"relative",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("div",{className:"h-8 w-8 rounded-full bg-muted animate-pulse"})}),a.jsxs("div",{className:"hidden lg:block",children:[a.jsx("div",{className:"h-4 w-20 bg-muted rounded animate-pulse mb-1"}),a.jsx("div",{className:"h-3 w-16 bg-muted rounded animate-pulse"})]})]})})})]}),a.jsx("main",{className:"py-6",children:a.jsx("div",{className:"px-4 sm:px-6 lg:px-8",children:e})})]})})},aT=()=>{const{language:e}=Xt(),t=e==="ar",n={product:[{name:"Features",nameAr:"",href:"/features"},{name:"Pricing",nameAr:"",href:"/pricing"}],company:[{name:"About",nameAr:"",href:"/about"},{name:"Contact",nameAr:" ",href:"/contact"}],legal:[{name:"Privacy",nameAr:"",href:"/privacy"},{name:"Terms",nameAr:"",href:"/terms"}]};return a.jsx("footer",{className:"bg-muted border-t",children:a.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-8",children:[a.jsxs("div",{className:"lg:col-span-2",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(Qn,{className:"h-8 w-8 text-primary"}),a.jsx("span",{className:"ml-2 text-xl font-bold",children:t?"":"Nasabna"})]}),a.jsx("p",{className:"mt-4 text-muted-foreground max-w-md",children:t?"      .       .":"A comprehensive platform for building, exploring, and sharing family trees. Connect with your roots and preserve your family's story for future generations."}),a.jsxs("div",{className:"flex space-x-4 mt-6",children:[a.jsx("a",{href:"#",className:"text-muted-foreground hover:text-foreground transition-colors",children:a.jsx(MI,{className:"h-5 w-5"})}),a.jsx("a",{href:"#",className:"text-muted-foreground hover:text-foreground transition-colors",children:a.jsx(XI,{className:"h-5 w-5"})}),a.jsx("a",{href:"#",className:"text-muted-foreground hover:text-foreground transition-colors",children:a.jsx(DI,{className:"h-5 w-5"})}),a.jsx("a",{href:"#",className:"text-muted-foreground hover:text-foreground transition-colors",children:a.jsx(zI,{className:"h-5 w-5"})})]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-semibold uppercase tracking-wider",children:t?"":"Product"}),a.jsx("ul",{className:"mt-4 space-y-2",children:n.product.map(r=>a.jsx("li",{children:a.jsx(It,{to:r.href,className:"text-sm font-semibold leading-6 text-muted-foreground hover:text-foreground transition-colors",children:t?r.nameAr:r.name})},r.name))})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-semibold uppercase tracking-wider",children:t?"":"Company"}),a.jsx("ul",{className:"mt-4 space-y-2",children:n.company.map(r=>a.jsx("li",{children:a.jsx(It,{to:r.href,className:"text-sm font-semibold leading-6 text-muted-foreground hover:text-foreground transition-colors",children:t?r.nameAr:r.name})},r.name))})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-sm font-semibold uppercase tracking-wider",children:t?"":"Legal"}),a.jsx("ul",{className:"mt-4 space-y-2",children:n.legal.map(r=>a.jsx("li",{children:a.jsx(It,{to:r.href,className:"text-sm font-semibold leading-6 text-muted-foreground hover:text-foreground transition-colors",children:t?r.nameAr:r.name})},r.name))})]})]}),a.jsxs("div",{className:"mt-12 pt-8 border-t border-muted-foreground/20 flex flex-col md:flex-row justify-between items-center",children:[a.jsxs("p",{className:"text-muted-foreground",children:[" ",new Date().getFullYear()," ",t?"":"Nasabna",". ",t?"  .":"All rights reserved."]}),a.jsxs("div",{className:"mt-4 md:mt-0 flex space-x-6",children:[a.jsxs("div",{className:"flex items-center text-muted-foreground hover:text-foreground transition-colors",children:[a.jsx(Pa,{className:"h-4 w-4 mr-2"}),a.jsx("span",{children:"support@nasabna.com"})]}),a.jsxs("div",{className:"flex items-center text-muted-foreground hover:text-foreground transition-colors",children:[a.jsx(Su,{className:"h-4 w-4 mr-2"}),a.jsx("span",{children:"+1 (555) 123-4567"})]})]})]})]})})},Do=({children:e})=>{const[t,n]=we.useState(!1),{language:r,theme:s,setLanguage:i,setTheme:l}=Xt(),{isAuthenticated:o,logout:c}=Pr(),u=Ir(),d=[{name:"Home",nameAr:"",href:"/"},{name:"Features",nameAr:"",href:"/features"},{name:"Pricing",nameAr:"",href:"/pricing"},{name:"About",nameAr:" ",href:"/about"},...o?[{name:"Dashboard",nameAr:" ",href:"/dashboard"}]:[]],f=()=>{i(r==="en"?"ar":"en")},m=()=>{l(s==="light"?"dark":"light")},h=async()=>{try{await c(),u("/")}catch(x){console.error("Logout failed:",x)}};return we.useEffect(()=>{const x=()=>{window.innerWidth>=1024&&n(!1)};return window.addEventListener("resize",x),()=>window.removeEventListener("resize",x)},[]),a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsx("header",{className:"bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 sticky top-0 z-40 w-full border-b border-border/40",children:a.jsxs("nav",{className:"mx-auto flex max-w-7xl items-center justify-between p-6 lg:px-8","aria-label":"Global",children:[a.jsx("div",{className:"flex lg:flex-1",children:a.jsxs(It,{to:"/",className:"-m-1.5 p-1.5",children:[a.jsx("span",{className:"sr-only",children:r==="ar"?"":"Nasabna"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs("svg",{className:"h-8 w-8 text-primary",viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("circle",{cx:"50",cy:"50",r:"45",stroke:"currentColor",strokeWidth:"2",fill:"none",opacity:"0.3"}),a.jsx("path",{d:"M50 20 L35 35 L50 50 L65 35 Z",fill:"currentColor"}),a.jsx("path",{d:"M35 35 L20 50 L35 65 L50 50 Z",fill:"currentColor",opacity:"0.8"}),a.jsx("path",{d:"M65 35 L80 50 L65 65 L50 50 Z",fill:"currentColor",opacity:"0.8"}),a.jsx("path",{d:"M35 65 L50 80 L65 65 L50 50 Z",fill:"currentColor",opacity:"0.6"}),a.jsx("circle",{cx:"50",cy:"35",r:"3",fill:"currentColor"}),a.jsx("circle",{cx:"35",cy:"50",r:"3",fill:"currentColor"}),a.jsx("circle",{cx:"65",cy:"50",r:"3",fill:"currentColor"}),a.jsx("circle",{cx:"50",cy:"65",r:"3",fill:"currentColor"})]}),a.jsx("span",{className:"text-xl font-bold text-foreground",children:r==="ar"?"":"Nasabna"})]})]})}),a.jsx("div",{className:"flex lg:hidden",children:a.jsxs("button",{type:"button",className:"-m-2.5 inline-flex items-center justify-center rounded-md p-2.5 text-muted-foreground",onClick:()=>n(!0),children:[a.jsx("span",{className:"sr-only",children:"Open main menu"}),a.jsx(cj,{className:"h-6 w-6","aria-hidden":"true"})]})}),a.jsx("div",{className:"hidden lg:flex lg:gap-x-12",children:d.map(x=>a.jsx(It,{to:x.href,className:"text-sm font-semibold leading-6 text-muted-foreground hover:text-foreground transition-colors",children:r==="ar"?x.nameAr:x.name},x.name))}),a.jsxs("div",{className:"hidden lg:flex lg:flex-1 lg:justify-end lg:items-center lg:space-x-4",children:[a.jsx(ge,{variant:"ghost",size:"icon",onClick:m,className:"h-9 w-9",children:s==="light"?a.jsx(Lf,{className:"h-4 w-4"}):a.jsx(Rf,{className:"h-4 w-4"})}),a.jsx(ge,{variant:"ghost",size:"icon",onClick:f,className:"h-9 w-9",children:a.jsx(mo,{className:"h-4 w-4"})}),o?a.jsxs(ge,{variant:"ghost",onClick:h,className:"flex items-center",children:[a.jsx(wx,{className:"h-4 w-4 mr-2"}),r==="ar"?" ":"Logout"]}):a.jsxs(a.Fragment,{children:[a.jsx(ge,{asChild:!0,variant:"ghost",children:a.jsx(It,{to:"/login",children:r==="ar"?" ":"Sign In"})}),a.jsx(ge,{asChild:!0,children:a.jsx(It,{to:"/register",children:r==="ar"?" ":"Get Started"})})]})]})]})}),t&&a.jsxs("div",{className:"lg:hidden fixed inset-0 z-50",children:[a.jsx("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm",onClick:()=>n(!1)}),a.jsxs("div",{className:"fixed inset-y-0 right-0 z-50 w-full overflow-y-auto bg-background px-6 py-6 sm:max-w-sm sm:ring-1 sm:ring-border/10",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs(It,{to:"/",className:"-m-1.5 p-1.5",onClick:()=>n(!1),children:[a.jsx("span",{className:"sr-only",children:r==="ar"?"":"Nasabna"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs("svg",{className:"h-8 w-8 text-primary",viewBox:"0 0 100 100",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[a.jsx("circle",{cx:"50",cy:"50",r:"45",stroke:"currentColor",strokeWidth:"2",fill:"none",opacity:"0.3"}),a.jsx("path",{d:"M50 20 L35 35 L50 50 L65 35 Z",fill:"currentColor"}),a.jsx("path",{d:"M35 35 L20 50 L35 65 L50 50 Z",fill:"currentColor",opacity:"0.8"}),a.jsx("path",{d:"M65 35 L80 50 L65 65 L50 50 Z",fill:"currentColor",opacity:"0.8"}),a.jsx("path",{d:"M35 65 L50 80 L65 65 L50 50 Z",fill:"currentColor",opacity:"0.6"}),a.jsx("circle",{cx:"50",cy:"35",r:"3",fill:"currentColor"}),a.jsx("circle",{cx:"35",cy:"50",r:"3",fill:"currentColor"}),a.jsx("circle",{cx:"65",cy:"50",r:"3",fill:"currentColor"}),a.jsx("circle",{cx:"50",cy:"65",r:"3",fill:"currentColor"})]}),a.jsx("span",{className:"text-xl font-bold text-foreground",children:r==="ar"?"":"Nasabna"})]})]}),a.jsxs("button",{type:"button",className:"-m-2.5 rounded-md p-2.5 text-muted-foreground",onClick:()=>n(!1),children:[a.jsx("span",{className:"sr-only",children:"Close menu"}),a.jsx(ia,{className:"h-6 w-6","aria-hidden":"true"})]})]}),a.jsx("div",{className:"mt-6 flow-root",children:a.jsxs("div",{className:"-my-6 divide-y divide-border/10",children:[a.jsx("div",{className:"space-y-2 py-6",children:d.map(x=>a.jsx(It,{to:x.href,className:"-mx-3 block rounded-lg px-3 py-2 text-base font-semibold leading-7 text-foreground hover:bg-muted",onClick:()=>n(!1),children:r==="ar"?x.nameAr:x.name},x.name))}),a.jsxs("div",{className:"py-6 space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm font-medium",children:"Theme"}),a.jsx(ge,{variant:"ghost",size:"icon",onClick:x=>{x.stopPropagation(),m()},className:"h-9 w-9",children:s==="light"?a.jsx(Lf,{className:"h-4 w-4"}):a.jsx(Rf,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm font-medium",children:"Language"}),a.jsx(ge,{variant:"ghost",size:"icon",onClick:x=>{x.stopPropagation(),f()},className:"h-9 w-9",children:a.jsx(mo,{className:"h-4 w-4"})})]}),a.jsx("div",{className:"space-y-2",children:o?a.jsxs(ge,{variant:"outline",className:"w-full",onClick:()=>{n(!1),h()},children:[a.jsx(wx,{className:"h-4 w-4 mr-2"}),r==="ar"?" ":"Logout"]}):a.jsxs(a.Fragment,{children:[a.jsx(ge,{asChild:!0,variant:"outline",className:"w-full",onClick:()=>n(!1),children:a.jsx(It,{to:"/login",children:r==="ar"?" ":"Sign In"})}),a.jsx(ge,{asChild:!0,className:"w-full",onClick:()=>n(!1),children:a.jsx(It,{to:"/register",children:r==="ar"?" ":"Get Started"})})]})})]})]})})]})]}),a.jsx("main",{children:e}),a.jsx(aT,{})]})},a5=({children:e})=>{const{user:t,isAuthenticated:n}=Pr();return n?(t==null?void 0:t.role)!=="admin"?a.jsx(Cf,{to:"/dashboard",replace:!0}):a.jsx(a.Fragment,{children:e}):a.jsx(Cf,{to:"/login",replace:!0})},oT=e=>{var t,n;if(e.code==="ERR_NETWORK"||(t=e.message)!=null&&t.includes("Network Error"))return{message:"Network connection error. Please check your internet connection.",code:"NETWORK_ERROR"};if(e.code==="ECONNABORTED"||(n=e.message)!=null&&n.includes("timeout"))return{message:"Request timeout. Please try again.",code:"TIMEOUT_ERROR"};if(e.response){const r=e.response.status,s=e.response.data;switch(r){case 400:return{message:(s==null?void 0:s.message)||"Invalid request. Please check your input.",status:r,code:"BAD_REQUEST"};case 401:return{message:"Authentication required. Please log in.",status:r,code:"UNAUTHORIZED"};case 403:return{message:"Access denied. You don't have permission for this action.",status:r,code:"FORBIDDEN"};case 404:return{message:"Resource not found.",status:r,code:"NOT_FOUND"};case 429:return{message:"Too many requests. Please wait before trying again.",status:r,code:"RATE_LIMITED"};case 500:return{message:"Server error. Please try again later.",status:r,code:"SERVER_ERROR"};case 502:case 503:case 504:return{message:"Service temporarily unavailable. Please try again later.",status:r,code:"SERVICE_UNAVAILABLE"};default:return{message:(s==null?void 0:s.message)||`HTTP Error ${r}`,status:r,code:"HTTP_ERROR"}}}return{message:e.message||"An unexpected error occurred.",code:"UNKNOWN_ERROR"}},lT=e=>!["NOT_FOUND"].includes(e.code||""),Pt={getTrees:async()=>{try{return await nn.getTrees()||[]}catch(e){throw e}},getPublicTrees:async()=>{try{return await nn.getAllPublicTrees()||[]}catch(e){const t=oT(e);if(t.code==="NOT_FOUND")return console.warn("Public trees endpoint not available, returning empty array"),[];if(lT(t))throw new Error(t.message);return[]}},createTree:async(e,t,n)=>{try{return(await nn.addTree(e,t,n)).data}catch(r){throw r}},getTreeById:async e=>{try{return await nn.getTreeById(e)}catch(t){throw t}},updateTree:async(e,t,n,r)=>{try{if(!e||e<=0)throw new Error("Invalid tree ID");if(!t||t.trim()==="")throw new Error("Tree name is required");return(await nn.updateTree(e,t.trim(),n,(r==null?void 0:r.trim())||"")).data}catch(s){throw s.response?s.response.status===403?new Error("You do not have permission to edit this tree"):new Error(`Failed to update tree: ${JSON.stringify(s.response.data)}`):new Error("Failed to update tree: "+(s.message||"Unknown error"))}},deleteTree:async e=>{try{await nn.deleteTree(e)}catch(t){throw t}},uploadTreePhoto:async(e,t)=>{try{const n=new FormData;return n.append("picture",t),n.append("FamilyTreeId",e.toString()),(await nn.uploadTreePhoto(n)).data}catch(n){throw n}},deleteTreePhoto:async e=>{try{await nn.deleteTreePhoto(e)}catch(t){throw t}},getPersonsInTree:async e=>{try{return await nn.getPersonsInTree(e)||[]}catch(t){throw t}},addPersonToTree:async(e,t,n,r,s,i,l,o)=>{try{const c=await nn.addPerson(e,t,n,r,s,i,l,o);return nn.clearPersonsInTreeCache(),c.data}catch(c){throw c.response,c}},updatePerson:async(e,t,n,r,s,i,l,o,c,u,d,f)=>{try{const m=await nn.updatePerson(e,t,n,r,s,i,l,o,c,u,d,f);if(!m||!m.data)throw new Error("No data in response");return nn.clearPersonsInTreeCache(),m.data}catch(m){throw m.response?m.response.status===403?new Error("You do not have permission to edit this person"):new Error(`Failed to update person: ${JSON.stringify(m.response.data)}`):new Error("Failed to update person: "+(m.message||"Unknown error"))}},updatePersonPosition:async(e,t,n)=>{try{await nn.updatePersonPosition(e,t,n),nn.clearPersonsInTreeCache()}catch(r){throw r}},safeUpdatePersonPosition:async(e,t,n,r)=>{var s,i,l,o,c,u,d;try{const f=await nn.getPersonById(e);if(!f)throw new Error("Person not found");const m=f.name||[f.firstName,f.lastName].filter(Boolean).join(" ").trim()||"Unknown",h=f.birthDate||((s=f.birth)==null?void 0:s.date)||"",x=f.birthPlace||((i=f.birth)==null?void 0:i.place)||"",y=(Array.isArray(f.occupation)?(o=(l=f.occupation)==null?void 0:l[0])==null?void 0:o.title:f.occupation)||"",p=f.gender||((c=f.attributes)==null?void 0:c.gender)||(typeof f.gender=="string"?f.gender:""),g=f.ColorCode||f.colorCode||"",w=typeof f.IsDeceased=="boolean"?f.IsDeceased:!!((u=f.death)!=null&&u.date||f.deathDate),v=((d=f.death)==null?void 0:d.date)||f.deathDate||"",N=t??f.FamilyTreeId??f.familyTreeId??f.treeId??void 0;await nn.updatePerson(e,m,h,x,y,p,N,typeof n=="number"?n:f.Latitude??f.latitude,typeof r=="number"?r:f.Longitude??f.longitude,g||void 0,w,v),nn.clearPersonsInTreeCache()}catch(f){throw f}},getPersonById:async e=>{var t;try{const n=await nn.getPersonById(e);if(n)return typeof n=="object"&&(n.hasOwnProperty("id")||n.hasOwnProperty("firstName")||n.hasOwnProperty("lastName"))?n:n.hasOwnProperty("data")?n.data:n;throw new Error("Empty response from API")}catch(n){if(((t=n.response)==null?void 0:t.status)===404)try{const s=(await Pt.getAllPersons()).find(i=>i.id&&(parseInt(i.id.toString())===e||i.id.toString()===e.toString()));if(s)return s}catch{}throw n.response?new Error(`API Error: ${n.response.status} - ${JSON.stringify(n.response.data)}`):new Error(`Network Error: ${n.message||"Unknown error"}`)}},deletePerson:async e=>{var t,n;try{await nn.deletePerson(e),nn.clearPersonsInTreeCache()}catch(r){if(r.response){const s=((t=r.response.data)==null?void 0:t.message)||((n=r.response.data)==null?void 0:n.error)||JSON.stringify(r.response.data);throw new Error(`Server error: ${r.response.status} - ${s||"Unknown server error"}`)}else throw r.request?new Error("Network error: No response received from server. Please check your internet connection and try again."):new Error(`Request setup error: ${r.message}`)}},uploadPersonPhoto:async(e,t)=>{try{const n=new FormData;return n.append("picture",t),n.append("PersonId",e.toString()),(await nn.uploadPersonPicture(n)).data}catch(n){throw n}},deletePersonPhoto:async e=>{try{await nn.deletePersonPicture(e)}catch(t){throw t}},addRelationship:async(e,t,n)=>{try{return await nn.addRelationship(e,t,n)}catch(r){throw r}},getRelationships:async()=>{try{return await nn.getRelationships()||[]}catch(e){throw e}},deleteRelationship:async e=>{try{await nn.deleteRelationship(e)}catch(t){throw t}},getAllPersons:async()=>{try{const e=await Pt.getTrees(),t=[];for(const n of e)try{const r=await Pt.getPersonsInTree(parseInt(n.id));t.push(...r)}catch{}return t}catch(e){throw e}},searchPersons:async e=>{try{const t=await Pt.getAllPersons();if(!e)return t;const n=e.toLowerCase();return t.filter(r=>r.firstName&&r.firstName.toLowerCase().includes(n)||r.lastName&&r.lastName.toLowerCase().includes(n)||r.fullName&&r.fullName.toLowerCase().includes(n))}catch(t){throw t}},searchTrees:async e=>{try{const t=await Pt.getTrees(),n=await Pt.getPublicTrees(),r=new Map;t.forEach(l=>{r.has(l.id.toString())||r.set(l.id.toString(),l)}),n.forEach(l=>{r.has(l.id.toString())||r.set(l.id.toString(),l)});const s=Array.from(r.values());if(!e)return s;const i=e.toLowerCase();return s.filter(l=>l.name&&l.name.toLowerCase().includes(i)||l.description&&l.description.toLowerCase().includes(i))}catch(t){throw t}},createJoinRequest:async(e,t,n,r,s,i,l,o,c,u)=>{var d,f;try{return await nn.createJoinRequest(e,t,n,r,s,i,l,o,c,u)}catch(m){if(m.response){const h=((d=m.response.data)==null?void 0:d.message)||((f=m.response.data)==null?void 0:f.error)||JSON.stringify(m.response.data);throw new Error(`Server error: ${m.response.status} - ${h||"Unknown server error"}`)}else throw m.request?new Error("Network error: No response received from server. Please check your internet connection and try again."):new Error(`Request setup error: ${m.message}`)}},getIncomingJoinRequests:async e=>{try{const t=await nn.getJoinRequestsByTree(e);let n=[];return Array.isArray(t)?n=t:t&&t.data&&Array.isArray(t.data)?n=t.data:t&&typeof t=="object"&&(Array.isArray(t.requests)?n=t.requests:t.id&&(n=[t])),n}catch{return[]}},getOutgoingJoinRequests:async e=>{try{return[]}catch{return[]}},acceptJoinRequest:async e=>{try{return await nn.acceptJoinRequest(e)}catch(t){throw new Error(`Failed to accept join request: ${t.message}`)}},rejectJoinRequest:async e=>{try{return await nn.rejectJoinRequest(e)}catch(t){throw new Error(`Failed to reject join request: ${t.message}`)}}},qg=50,Hg=(e,t)=>e.length<=t?e:e.slice(-t);let Od=null,Dd=null;const em={},xs=Z2()(A4(X2((e,t)=>({trees:[],publicTrees:[],currentTree:null,currentPerson:null,isLoading:!1,error:null,fetchTrees:async()=>Od||(Od=(async()=>{e({isLoading:!0,error:null});try{const n=await Pt.getTrees(),r=t().trees,s=n.map(l=>{var c,u,d,f,m,h,x,y,p,g,w,v;const o=r.find(N=>N.id===l.id.toString());return{...l,id:l.id.toString(),ownerId:l.ownerId||(l.owner?l.owner.id:void 0),userRole:l.userRole||"owner",category:l.category||"family",tags:l.tags||[],settings:{isPublic:((c=l.settings)==null?void 0:c.isPublic)!==void 0?l.settings.isPublic:!l.isPrivate,theme:((u=l.settings)==null?void 0:u.theme)||"default",layout:((d=l.settings)==null?void 0:d.layout)||"vertical",showPhotos:((f=l.settings)==null?void 0:f.showPhotos)!==void 0?l.settings.showPhotos:!0,showDates:((m=l.settings)==null?void 0:m.showDates)!==void 0?l.settings.showDates:!0,showPlaces:((h=l.settings)==null?void 0:h.showPlaces)!==void 0?l.settings.showPlaces:!0,allowComments:((x=l.settings)==null?void 0:x.allowComments)!==void 0?l.settings.allowComments:!0,allowSuggestions:((y=l.settings)==null?void 0:y.allowSuggestions)!==void 0?l.settings.allowSuggestions:!0},sharing:l.sharing||{isShared:l.members&&l.members.length>0||!1,allowedUsers:[],shareToken:void 0,publicUrl:void 0},stats:{totalPeople:((p=l.members)==null?void 0:p.length)||0,totalGenerations:((g=o==null?void 0:o.stats)==null?void 0:g.totalGenerations)!==void 0?o.stats.totalGenerations:((w=l.stats)==null?void 0:w.totalGenerations)||0,totalPhotos:((v=l.stats)==null?void 0:v.totalPhotos)||0,completionPercentage:l.members&&l.members.length>0?50:0},createdAt:l.createdAt||new Date().toISOString(),updatedAt:l.updatedAt||new Date().toISOString()}}),i=Hg(s,qg);e({trees:i,isLoading:!1})}catch(n){throw e({error:n.message||"Failed to fetch trees",isLoading:!1}),n}finally{Od=null}})(),Od),fetchPublicTrees:async()=>Dd||(Dd=(async()=>{var n,r;e({isLoading:!0,error:null});try{const s=await Pt.getPublicTrees(),i=t().publicTrees,l=s.map(c=>{var d,f,m,h,x,y,p,g,w,v,N,A;const u=i.find(P=>P.id===c.id.toString());return{...c,id:c.id.toString(),ownerId:c.ownerId||(c.owner?c.owner.id:void 0),userRole:c.userRole||"viewer",category:c.category||"family",tags:c.tags||[],settings:{isPublic:((d=c.settings)==null?void 0:d.isPublic)!==void 0?c.settings.isPublic:!c.isPrivate,theme:((f=c.settings)==null?void 0:f.theme)||"default",layout:((m=c.settings)==null?void 0:m.layout)||"vertical",showPhotos:((h=c.settings)==null?void 0:h.showPhotos)!==void 0?c.settings.showPhotos:!0,showDates:((x=c.settings)==null?void 0:x.showDates)!==void 0?c.settings.showDates:!0,showPlaces:((y=c.settings)==null?void 0:y.showPlaces)!==void 0?c.settings.showPlaces:!0,allowComments:((p=c.settings)==null?void 0:p.allowComments)!==void 0?c.settings.allowComments:!0,allowSuggestions:((g=c.settings)==null?void 0:g.allowSuggestions)!==void 0?c.settings.allowSuggestions:!0},sharing:c.sharing||{isShared:!0,allowedUsers:[],shareToken:void 0,publicUrl:void 0},stats:{totalPeople:((w=c.members)==null?void 0:w.length)||0,totalGenerations:((v=u==null?void 0:u.stats)==null?void 0:v.totalGenerations)!==void 0?u.stats.totalGenerations:((N=c.stats)==null?void 0:N.totalGenerations)||0,totalPhotos:((A=c.stats)==null?void 0:A.totalPhotos)||0,completionPercentage:c.members&&c.members.length>0?50:0},createdAt:c.createdAt||new Date().toISOString(),updatedAt:c.updatedAt||new Date().toISOString()}}),o=Hg(l,qg);e({publicTrees:o,isLoading:!1})}catch(s){if(((n=s.response)==null?void 0:n.status)===404){e({publicTrees:[],isLoading:!1,error:null}),console.warn("Public trees endpoint not found, using empty array");return}const i=((r=s.response)==null?void 0:r.status)===500?"Server temporarily unavailable. Please try again later.":s.message||"Failed to fetch public trees";e({publicTrees:[],isLoading:!1,error:i}),console.error("Error fetching public trees:",s)}finally{Dd=null}})(),Dd),createTree:async n=>{var r,s,i,l,o,c,u,d,f,m,h,x;e({isLoading:!0,error:null});try{const y=await Pt.createTree(n.name||"Untitled Tree",((r=n.settings)==null?void 0:r.isPublic)!==void 0?!n.settings.isPublic:!0,n.description||""),p={...y,id:y.id.toString(),ownerId:y.ownerId||(y.owner?y.owner.id:void 0),userRole:"owner",category:y.category||"family",tags:y.tags||[],settings:{isPublic:((s=y.settings)==null?void 0:s.isPublic)!==void 0?y.settings.isPublic:!y.isPrivate,theme:((i=y.settings)==null?void 0:i.theme)||"default",layout:((l=y.settings)==null?void 0:l.layout)||"vertical",showPhotos:((o=y.settings)==null?void 0:o.showPhotos)!==void 0?y.settings.showPhotos:!0,showDates:((c=y.settings)==null?void 0:c.showDates)!==void 0?y.settings.showDates:!0,showPlaces:((u=y.settings)==null?void 0:u.showPlaces)!==void 0?y.settings.showPlaces:!0,allowComments:((d=y.settings)==null?void 0:d.allowComments)!==void 0?y.settings.allowComments:!0,allowSuggestions:((f=y.settings)==null?void 0:f.allowSuggestions)!==void 0?y.settings.allowSuggestions:!0},sharing:y.sharing||{isShared:y.members&&y.members.length>0||!1,allowedUsers:[],shareToken:void 0,publicUrl:void 0},stats:{totalPeople:((m=y.members)==null?void 0:m.length)||0,totalGenerations:((h=y.stats)==null?void 0:h.totalGenerations)!==void 0?y.stats.totalGenerations:0,totalPhotos:((x=y.stats)==null?void 0:x.totalPhotos)!==void 0?y.stats.totalPhotos:0,completionPercentage:y.members&&y.members.length>0?50:0},createdAt:y.createdAt||new Date().toISOString(),updatedAt:y.updatedAt||new Date().toISOString()};return e(g=>({trees:Hg([...g.trees,p],qg),isLoading:!1})),p}catch(y){throw e({error:y.message||"Failed to create tree",isLoading:!1}),y}},updateTree:async(n,r)=>{var s;e({isLoading:!0,error:null});try{const i=await Pt.updateTree(parseInt(n),r.name||"",r.isPrivate!==void 0?r.isPrivate:((s=r.settings)==null?void 0:s.isPublic)!==void 0?!r.settings.isPublic:!0,r.description||"");return e(l=>{var o,c,u,d,f,m,h,x,y,p,g,w,v,N,A,P,U,M,S,C,_,T,B,$,D,L,O,W;return{trees:l.trees.map(E=>{var H,V,R,q,F,G,ee,ae,re,Q,fe,Se,oe,pe,me,ne,it,$e,Oe,qe,gt,ut,Rt,Nt,ye,ze,Ze;return E.id===n?{...E,...i,id:((H=i.id)==null?void 0:H.toString())||n,category:i.category||E.category||"family",tags:i.tags||E.tags||[],settings:{...E.settings,...i.settings,isPublic:i.isPrivate!==void 0?!i.isPrivate:((V=E.settings)==null?void 0:V.isPublic)!==void 0?E.settings.isPublic:!0,theme:((R=i.settings)==null?void 0:R.theme)||((q=E.settings)==null?void 0:q.theme)||"default",layout:((F=i.settings)==null?void 0:F.layout)||((G=E.settings)==null?void 0:G.layout)||"vertical",showPhotos:((ee=i.settings)==null?void 0:ee.showPhotos)!==void 0?i.settings.showPhotos:((ae=E.settings)==null?void 0:ae.showPhotos)!==void 0?E.settings.showPhotos:!0,showDates:((re=i.settings)==null?void 0:re.showDates)!==void 0?i.settings.showDates:((Q=E.settings)==null?void 0:Q.showDates)!==void 0?E.settings.showDates:!0,showPlaces:((fe=i.settings)==null?void 0:fe.showPlaces)!==void 0?i.settings.showPlaces:((Se=E.settings)==null?void 0:Se.showPlaces)!==void 0?E.settings.showPlaces:!0,allowComments:((oe=i.settings)==null?void 0:oe.allowComments)!==void 0?i.settings.allowComments:((pe=E.settings)==null?void 0:pe.allowComments)!==void 0?E.settings.allowComments:!0,allowSuggestions:((me=i.settings)==null?void 0:me.allowSuggestions)!==void 0?i.settings.allowSuggestions:((ne=E.settings)==null?void 0:ne.allowSuggestions)!==void 0?E.settings.allowSuggestions:!0},sharing:{...E.sharing,...i.sharing,isShared:((it=i.sharing)==null?void 0:it.isShared)||i.members&&i.members.length>0||(($e=E.sharing)==null?void 0:$e.isShared)||!1,allowedUsers:((Oe=i.sharing)==null?void 0:Oe.allowedUsers)||((qe=E.sharing)==null?void 0:qe.allowedUsers)||[]},stats:{...E.stats,...i.stats,totalPeople:((gt=i.members)==null?void 0:gt.length)||((ut=E.stats)==null?void 0:ut.totalPeople)||0,totalGenerations:((Rt=E.stats)==null?void 0:Rt.totalGenerations)||((Nt=i.stats)==null?void 0:Nt.totalGenerations)||0,totalPhotos:((ye=E.stats)==null?void 0:ye.totalPhotos)||((ze=i.stats)==null?void 0:ze.totalPhotos)||0,completionPercentage:i.members&&i.members.length>0?50:((Ze=E.stats)==null?void 0:Ze.completionPercentage)||0},createdAt:i.createdAt||E.createdAt||new Date().toISOString(),updatedAt:i.updatedAt||new Date().toISOString()}:E}),currentTree:((o=l.currentTree)==null?void 0:o.id)===n?{...l.currentTree,...i,id:((c=i.id)==null?void 0:c.toString())||n,category:i.category||l.currentTree.category||"family",tags:i.tags||l.currentTree.tags||[],settings:{...l.currentTree.settings,...i.settings,isPublic:i.isPrivate!==void 0?!i.isPrivate:((u=l.currentTree.settings)==null?void 0:u.isPublic)!==void 0?l.currentTree.settings.isPublic:!0,theme:((d=i.settings)==null?void 0:d.theme)||((f=l.currentTree.settings)==null?void 0:f.theme)||"default",layout:((m=i.settings)==null?void 0:m.layout)||((h=l.currentTree.settings)==null?void 0:h.layout)||"vertical",showPhotos:((x=i.settings)==null?void 0:x.showPhotos)!==void 0?i.settings.showPhotos:((y=l.currentTree.settings)==null?void 0:y.showPhotos)!==void 0?l.currentTree.settings.showPhotos:!0,showDates:((p=i.settings)==null?void 0:p.showDates)!==void 0?i.settings.showDates:((g=l.currentTree.settings)==null?void 0:g.showDates)!==void 0?l.currentTree.settings.showDates:!0,showPlaces:((w=i.settings)==null?void 0:w.showPlaces)!==void 0?i.settings.showPlaces:((v=l.currentTree.settings)==null?void 0:v.showPlaces)!==void 0?l.currentTree.settings.showPlaces:!0,allowComments:((N=i.settings)==null?void 0:N.allowComments)!==void 0?i.settings.allowComments:((A=l.currentTree.settings)==null?void 0:A.allowComments)!==void 0?l.currentTree.settings.allowComments:!0,allowSuggestions:((P=i.settings)==null?void 0:P.allowSuggestions)!==void 0?i.settings.allowSuggestions:((U=l.currentTree.settings)==null?void 0:U.allowSuggestions)!==void 0?l.currentTree.settings.allowSuggestions:!0},sharing:{...l.currentTree.sharing,...i.sharing,isShared:((M=i.sharing)==null?void 0:M.isShared)||i.members&&i.members.length>0||((S=l.currentTree.sharing)==null?void 0:S.isShared)||!1,allowedUsers:((C=i.sharing)==null?void 0:C.allowedUsers)||((_=l.currentTree.sharing)==null?void 0:_.allowedUsers)||[]},stats:{...l.currentTree.stats,...i.stats,totalPeople:((T=i.members)==null?void 0:T.length)||((B=l.currentTree.stats)==null?void 0:B.totalPeople)||0,totalGenerations:(($=l.currentTree.stats)==null?void 0:$.totalGenerations)||((D=i.stats)==null?void 0:D.totalGenerations)||0,totalPhotos:((L=l.currentTree.stats)==null?void 0:L.totalPhotos)||((O=i.stats)==null?void 0:O.totalPhotos)||0,completionPercentage:i.members&&i.members.length>0?50:((W=l.currentTree.stats)==null?void 0:W.completionPercentage)||0},createdAt:i.createdAt||l.currentTree.createdAt||new Date().toISOString(),updatedAt:i.updatedAt||new Date().toISOString()}:l.currentTree,isLoading:!1}}),i}catch(i){throw e({error:i.message||"Failed to update tree",isLoading:!1}),i}},deleteTree:async n=>{e({isLoading:!0,error:null});try{await Pt.deleteTree(parseInt(n)),e(r=>{var s;return{trees:r.trees.filter(i=>i.id!==n),currentTree:((s=r.currentTree)==null?void 0:s.id)===n?null:r.currentTree,isLoading:!1}})}catch(r){throw e({error:r.message||"Failed to delete tree",isLoading:!1}),r}},setCurrentTree:n=>{e({currentTree:n})},setCurrentPerson:n=>{e({currentPerson:n})},fetchPersonsInTree:async n=>{const r=n.toString();if(em[r])return em[r];const s=(async()=>{e({isLoading:!0,error:null});try{const i=await Pt.getPersonsInTree(parseInt(n));try{const l=await Pt.getRelationships()}catch{}return e({isLoading:!1}),i}catch(i){throw e({error:i.message||"Failed to fetch persons",isLoading:!1}),i}finally{delete em[r]}})();return em[r]=s,s},addPersonToTree:async n=>{var r,s,i,l,o,c;e({isLoading:!0,error:null});try{const u=await Pt.addPersonToTree(n.firstName||"",((r=n.birth)==null?void 0:r.date)||"",((i=(s=n.birth)==null?void 0:s.place)==null?void 0:i.city)||"",((o=(l=n.occupation)==null?void 0:l[0])==null?void 0:o.title)||"",n.gender||"unknown",((c=n.death)==null?void 0:c.date)||"",n.isDeceased||!1,parseInt(n.tree||"0"));return e(d=>({trees:d.trees.map(m=>{var h;return m.id===n.tree?{...m,stats:{...m.stats,totalPeople:(((h=m.stats)==null?void 0:h.totalPeople)||0)+1}}:m}),isLoading:!1})),u}catch(u){throw e({error:u.message||"Failed to add person",isLoading:!1}),u}},updatePerson:async(n,r)=>{var s,i,l,o,c;e({isLoading:!0,error:null});try{const u=await Pt.updatePerson(parseInt(n),r.firstName||"",((s=r.birth)==null?void 0:s.date)||"",((l=(i=r.birth)==null?void 0:i.place)==null?void 0:l.city)||"",((c=(o=r.occupation)==null?void 0:o[0])==null?void 0:c.title)||"",r.gender||"unknown",parseInt(r.tree||"0"));return e({isLoading:!1}),u}catch(u){throw e({error:u.message||"Failed to update person",isLoading:!1}),u}},deletePerson:async n=>{e({isLoading:!0,error:null});try{await Pt.deletePerson(parseInt(n)),e({isLoading:!1})}catch(r){throw e({error:r.message||"Failed to delete person",isLoading:!1}),r}},addRelationship:async(n,r,s)=>{e({isLoading:!0,error:null});try{const i=await Pt.addRelationship(parseInt(n),parseInt(r),s);return e({isLoading:!1}),i}catch(i){throw e({error:i.message||"Failed to add relationship",isLoading:!1}),i}},deleteRelationship:async n=>{e({isLoading:!0,error:null});try{await Pt.deleteRelationship(parseInt(n)),e({isLoading:!1})}catch(r){throw e({error:r.message||"Failed to delete relationship",isLoading:!1}),r}},getRelationships:async()=>{e({isLoading:!0,error:null});try{const n=await Pt.getRelationships();return e({isLoading:!1}),n}catch(n){throw e({error:n.message||"Failed to fetch relationships",isLoading:!1}),n}},uploadTreePhoto:async(n,r)=>{e({isLoading:!0,error:null});try{const s=await Pt.uploadTreePhoto(parseInt(n),r);return e({isLoading:!1}),s}catch(s){throw e({error:s.message||"Failed to upload tree photo",isLoading:!1}),s}},uploadPersonPhoto:async(n,r)=>{e({isLoading:!0,error:null});try{const s=await Pt.uploadPersonPhoto(parseInt(n),r);return e({isLoading:!1}),s}catch(s){throw e({error:s.message||"Failed to upload person photo",isLoading:!1}),s}},updateTreeGenerations:(n,r)=>{e(s=>{var i;return{trees:s.trees.map(l=>l.id===n?{...l,stats:{...l.stats,totalGenerations:r}}:l),currentTree:((i=s.currentTree)==null?void 0:i.id)===n?{...s.currentTree,stats:{...s.currentTree.stats,totalGenerations:r}}:s.currentTree}})}}),{name:"tree-storage",partialize:e=>({trees:e.trees,publicTrees:e.publicTrees})}),{name:"tree-store"})),Qe=({className:e,children:t,...n})=>a.jsx("div",{className:Ai("rounded-lg border bg-card text-card-foreground shadow-sm",e),...n,children:t}),xt=({className:e,children:t,...n})=>a.jsx("div",{className:Ai("flex flex-col space-y-1.5 p-6",e),...n,children:t}),yt=({className:e,children:t,...n})=>a.jsx("h3",{className:Ai("text-2xl font-semibold leading-none tracking-tight",e),...n,children:t}),bs=({className:e,children:t,...n})=>a.jsx("p",{className:Ai("text-sm text-muted-foreground",e),...n,children:t}),tt=({className:e,children:t,...n})=>a.jsx("div",{className:Ai("p-6 pt-0",e),...n,children:t}),cT="/assets/hero-C8KRVFcu.jpg",pj="/assets/aboutimg-D4G8moL-.png";var uT="6.7.0";function Vr(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function w0(e){let t=e,n=e;e.length===1&&(t=(l,o)=>e(l)-o,n=dT(e));function r(l,o,c,u){for(c==null&&(c=0),u==null&&(u=l.length);c<u;){const d=c+u>>>1;n(l[d],o)<0?c=d+1:u=d}return c}function s(l,o,c,u){for(c==null&&(c=0),u==null&&(u=l.length);c<u;){const d=c+u>>>1;n(l[d],o)>0?u=d:c=d+1}return c}function i(l,o,c,u){c==null&&(c=0),u==null&&(u=l.length);const d=r(l,o,c,u-1);return d>c&&t(l[d-1],o)>-t(l[d],o)?d-1:d}return{left:r,center:i,right:s}}function dT(e){return(t,n)=>Vr(e(t),n)}function gj(e){return e===null?NaN:+e}function*fT(e,t){if(t===void 0)for(let n of e)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of e)(r=t(r,++n,e))!=null&&(r=+r)>=r&&(yield r)}}const xj=w0(Vr),el=xj.right,hT=xj.left,mT=w0(gj).center;function N0(e,t){let n=0;if(t===void 0)for(let r of e)r!=null&&(r=+r)>=r&&++n;else{let r=-1;for(let s of e)(s=t(s,++r,e))!=null&&(s=+s)>=s&&++n}return n}function pT(e){return e.length|0}function gT(e){return!(e>0)}function xT(e){return typeof e!="object"||"length"in e?e:Array.from(e)}function yT(e){return t=>e(...t)}function bT(...e){const t=typeof e[e.length-1]=="function"&&yT(e.pop());e=e.map(xT);const n=e.map(pT),r=e.length-1,s=new Array(r+1).fill(0),i=[];if(r<0||n.some(gT))return i;for(;;){i.push(s.map((o,c)=>e[c][o]));let l=r;for(;++s[l]===n[l];){if(l===0)return t?i.map(t):i;s[l--]=0}}}function vT(e,t){var n=0,r=0;return Float64Array.from(e,t===void 0?s=>n+=+s||0:s=>n+=+t(s,r++,e)||0)}function wT(e,t){return t<e?-1:t>e?1:t>=e?0:NaN}function yj(e,t){let n=0,r,s=0,i=0;if(t===void 0)for(let l of e)l!=null&&(l=+l)>=l&&(r=l-s,s+=r/++n,i+=r*(l-s));else{let l=-1;for(let o of e)(o=t(o,++l,e))!=null&&(o=+o)>=o&&(r=o-s,s+=r/++n,i+=r*(o-s))}if(n>1)return i/(n-1)}function bj(e,t){const n=yj(e,t);return n&&Math.sqrt(n)}function wf(e,t){let n,r;if(t===void 0)for(const s of e)s!=null&&(n===void 0?s>=s&&(n=r=s):(n>s&&(n=s),r<s&&(r=s)));else{let s=-1;for(let i of e)(i=t(i,++s,e))!=null&&(n===void 0?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)))}return[n,r]}class ns{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const n=this._partials;let r=0;for(let s=0;s<this._n&&s<32;s++){const i=n[s],l=t+i,o=Math.abs(t)<Math.abs(i)?t-(l-i):i-(l-t);o&&(n[r++]=o),t=l}return n[r]=t,this._n=r+1,this}valueOf(){const t=this._partials;let n=this._n,r,s,i,l=0;if(n>0){for(l=t[--n];n>0&&(r=l,s=t[--n],l=r+s,i=s-(l-r),!i););n>0&&(i<0&&t[n-1]<0||i>0&&t[n-1]>0)&&(s=i*2,r=l+s,s==r-l&&(l=r))}return l}}function NT(e,t){const n=new ns;if(t===void 0)for(let r of e)(r=+r)&&n.add(r);else{let r=-1;for(let s of e)(s=+t(s,++r,e))&&n.add(s)}return+n}function jT(e,t){const n=new ns;let r=-1;return Float64Array.from(e,t===void 0?s=>n.add(+s||0):s=>n.add(+t(s,++r,e)||0))}class vj extends Map{constructor(t,n=jj){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const[r,s]of t)this.set(r,s)}get(t){return super.get(Sx(this,t))}has(t){return super.has(Sx(this,t))}set(t,n){return super.set(wj(this,t),n)}delete(t){return super.delete(Nj(this,t))}}class ST extends Set{constructor(t,n=jj){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),t!=null)for(const r of t)this.add(r)}has(t){return super.has(Sx(this,t))}add(t){return super.add(wj(this,t))}delete(t){return super.delete(Nj(this,t))}}function Sx({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):n}function wj({_intern:e,_key:t},n){const r=t(n);return e.has(r)?e.get(r):(e.set(r,n),n)}function Nj({_intern:e,_key:t},n){const r=t(n);return e.has(r)&&(n=e.get(n),e.delete(r)),n}function jj(e){return e!==null&&typeof e=="object"?e.valueOf():e}function ku(e){return e}function Sj(e,...t){return Xu(e,ku,ku,t)}function _T(e,...t){return Xu(e,Array.from,ku,t)}function _j(e,t,...n){return Xu(e,ku,t,n)}function AT(e,t,...n){return Xu(e,Array.from,t,n)}function kT(e,...t){return Xu(e,ku,Aj,t)}function ET(e,...t){return Xu(e,Array.from,Aj,t)}function Aj(e){if(e.length!==1)throw new Error("duplicate key");return e[0]}function Xu(e,t,n,r){return function s(i,l){if(l>=r.length)return n(i);const o=new vj,c=r[l++];let u=-1;for(const d of i){const f=c(d,++u,i),m=o.get(f);m?m.push(d):o.set(f,[d])}for(const[d,f]of o)o.set(d,s(f,l));return t(o)}(e,0)}function kj(e,t){return Array.from(t,n=>e[n])}function _x(e,...t){if(typeof e[Symbol.iterator]!="function")throw new TypeError("values is not iterable");e=Array.from(e);let[n=Vr]=t;if(n.length===1||t.length>1){const r=Uint32Array.from(e,(s,i)=>i);return t.length>1?(t=t.map(s=>e.map(s)),r.sort((s,i)=>{for(const l of t){const o=Vr(l[s],l[i]);if(o)return o}})):(n=e.map(n),r.sort((s,i)=>Vr(n[s],n[i]))),kj(e,r)}return e.sort(n)}function CT(e,t,n){return(t.length===1?_x(_j(e,t,n),([r,s],[i,l])=>Vr(s,l)||Vr(r,i)):_x(Sj(e,n),([r,s],[i,l])=>t(s,l)||Vr(r,i))).map(([r])=>r)}var PT=Array.prototype,IT=PT.slice;function tm(e){return function(){return e}}var Ax=Math.sqrt(50),kx=Math.sqrt(10),Ex=Math.sqrt(2);function $f(e,t,n){var r,s=-1,i,l,o;if(t=+t,e=+e,n=+n,e===t&&n>0)return[e];if((r=t<e)&&(i=e,e=t,t=i),(o=hh(e,t,n))===0||!isFinite(o))return[];if(o>0){let c=Math.round(e/o),u=Math.round(t/o);for(c*o<e&&++c,u*o>t&&--u,l=new Array(i=u-c+1);++s<i;)l[s]=(c+s)*o}else{o=-o;let c=Math.round(e*o),u=Math.round(t*o);for(c/o<e&&++c,u/o>t&&--u,l=new Array(i=u-c+1);++s<i;)l[s]=(c+s)/o}return r&&l.reverse(),l}function hh(e,t,n){var r=(t-e)/Math.max(0,n),s=Math.floor(Math.log(r)/Math.LN10),i=r/Math.pow(10,s);return s>=0?(i>=Ax?10:i>=kx?5:i>=Ex?2:1)*Math.pow(10,s):-Math.pow(10,-s)/(i>=Ax?10:i>=kx?5:i>=Ex?2:1)}function Eu(e,t,n){var r=Math.abs(t-e)/Math.max(0,n),s=Math.pow(10,Math.floor(Math.log(r)/Math.LN10)),i=r/s;return i>=Ax?s*=10:i>=kx?s*=5:i>=Ex&&(s*=2),t<e?-s:s}function Ej(e,t,n){let r;for(;;){const s=hh(e,t,n);if(s===r||s===0||!isFinite(s))return[e,t];s>0?(e=Math.floor(e/s)*s,t=Math.ceil(t/s)*s):s<0&&(e=Math.ceil(e*s)/s,t=Math.floor(t*s)/s),r=s}}function iy(e){return Math.ceil(Math.log(N0(e))/Math.LN2)+1}function o5(){var e=ku,t=wf,n=iy;function r(s){Array.isArray(s)||(s=Array.from(s));var i,l=s.length,o,c=new Array(l);for(i=0;i<l;++i)c[i]=e(s[i],i,s);var u=t(c),d=u[0],f=u[1],m=n(c,d,f);if(!Array.isArray(m)){const p=f,g=+m;if(t===wf&&([d,f]=Ej(d,f,g)),m=$f(d,f,g),m[m.length-1]>=f)if(p>=f&&t===wf){const w=hh(d,f,g);isFinite(w)&&(w>0?f=(Math.floor(f/w)+1)*w:w<0&&(f=(Math.ceil(f*-w)+1)/-w))}else m.pop()}for(var h=m.length;m[0]<=d;)m.shift(),--h;for(;m[h-1]>f;)m.pop(),--h;var x=new Array(h+1),y;for(i=0;i<=h;++i)y=x[i]=[],y.x0=i>0?m[i-1]:d,y.x1=i<h?m[i]:f;for(i=0;i<l;++i)o=c[i],d<=o&&o<=f&&x[el(m,o,0,h)].push(s[i]);return x}return r.value=function(s){return arguments.length?(e=typeof s=="function"?s:tm(s),r):e},r.domain=function(s){return arguments.length?(t=typeof s=="function"?s:tm([s[0],s[1]]),r):t},r.thresholds=function(s){return arguments.length?(n=typeof s=="function"?s:Array.isArray(s)?tm(IT.call(s)):tm(s),r):n},r}function mp(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let s of e)(s=t(s,++r,e))!=null&&(n<s||n===void 0&&s>=s)&&(n=s)}return n}function pp(e,t){let n;if(t===void 0)for(const r of e)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let s of e)(s=t(s,++r,e))!=null&&(n>s||n===void 0&&s>=s)&&(n=s)}return n}function ay(e,t,n=0,r=e.length-1,s=Vr){for(;r>n;){if(r-n>600){const c=r-n+1,u=t-n+1,d=Math.log(c),f=.5*Math.exp(2*d/3),m=.5*Math.sqrt(d*f*(c-f)/c)*(u-c/2<0?-1:1),h=Math.max(n,Math.floor(t-u*f/c+m)),x=Math.min(r,Math.floor(t+(c-u)*f/c+m));ay(e,t,h,x,s)}const i=e[t];let l=n,o=r;for(Bd(e,n,t),s(e[r],i)>0&&Bd(e,n,r);l<o;){for(Bd(e,l,o),++l,--o;s(e[l],i)<0;)++l;for(;s(e[o],i)>0;)--o}s(e[n],i)===0?Bd(e,n,o):(++o,Bd(e,o,r)),o<=t&&(n=o+1),t<=o&&(r=o-1)}return e}function Bd(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function Ff(e,t,n){if(e=Float64Array.from(fT(e,n)),!!(r=e.length)){if((t=+t)<=0||r<2)return pp(e);if(t>=1)return mp(e);var r,s=(r-1)*t,i=Math.floor(s),l=mp(ay(e,i).subarray(0,i+1)),o=pp(e.subarray(i+1));return l+(o-l)*(s-i)}}function Cj(e,t,n=gj){if(r=e.length){if((t=+t)<=0||r<2)return+n(e[0],0,e);if(t>=1)return+n(e[r-1],r-1,e);var r,s=(r-1)*t,i=Math.floor(s),l=+n(e[i],i,e),o=+n(e[i+1],i+1,e);return l+(o-l)*(s-i)}}function TT(e,t,n){return Math.ceil((n-t)/(2*(Ff(e,.75)-Ff(e,.25))*Math.pow(N0(e),-1/3)))}function LT(e,t,n){return Math.ceil((n-t)/(3.5*bj(e)*Math.pow(N0(e),-1/3)))}function Pj(e,t){let n,r=-1,s=-1;if(t===void 0)for(const i of e)++s,i!=null&&(n<i||n===void 0&&i>=i)&&(n=i,r=s);else for(let i of e)(i=t(i,++s,e))!=null&&(n<i||n===void 0&&i>=i)&&(n=i,r=s);return r}function MT(e,t){let n=0,r=0;if(t===void 0)for(let s of e)s!=null&&(s=+s)>=s&&(++n,r+=s);else{let s=-1;for(let i of e)(i=t(i,++s,e))!=null&&(i=+i)>=i&&(++n,r+=i)}if(n)return r/n}function RT(e,t){return Ff(e,.5,t)}function*$T(e){for(const t of e)yield*t}function oy(e){return Array.from($T(e))}function Ij(e,t){let n,r=-1,s=-1;if(t===void 0)for(const i of e)++s,i!=null&&(n>i||n===void 0&&i>=i)&&(n=i,r=s);else for(let i of e)(i=t(i,++s,e))!=null&&(n>i||n===void 0&&i>=i)&&(n=i,r=s);return r}function FT(e,t=OT){const n=[];let r,s=!1;for(const i of e)s&&n.push(t(r,i)),r=i,s=!0;return n}function OT(e,t){return[e,t]}function Aa(e,t,n){e=+e,t=+t,n=(s=arguments.length)<2?(t=e,e=0,1):s<3?1:+n;for(var r=-1,s=Math.max(0,Math.ceil((t-e)/n))|0,i=new Array(s);++r<s;)i[r]=e+r*n;return i}function DT(e,t=Vr){let n,r=!1;if(t.length===1){let s;for(const i of e){const l=t(i);(r?Vr(l,s)<0:Vr(l,l)===0)&&(n=i,s=l,r=!0)}}else for(const s of e)(r?t(s,n)<0:t(s,s)===0)&&(n=s,r=!0);return n}function Tj(e,t=Vr){if(t.length===1)return Ij(e,t);let n,r=-1,s=-1;for(const i of e)++s,(r<0?t(i,i)===0:t(i,n)<0)&&(n=i,r=s);return r}function BT(e,t=Vr){let n,r=!1;if(t.length===1){let s;for(const i of e){const l=t(i);(r?Vr(l,s)>0:Vr(l,l)===0)&&(n=i,s=l,r=!0)}}else for(const s of e)(r?t(s,n)>0:t(s,s)===0)&&(n=s,r=!0);return n}function zT(e,t=Vr){if(t.length===1)return Pj(e,t);let n,r=-1,s=-1;for(const i of e)++s,(r<0?t(i,i)===0:t(i,n)>0)&&(n=i,r=s);return r}function UT(e,t){const n=Tj(e,t);return n<0?void 0:n}const qT=Lj(Math.random);function Lj(e){return function(n,r=0,s=n.length){let i=s-(r=+r);for(;i;){const l=e()*i--|0,o=n[i+r];n[i+r]=n[l+r],n[l+r]=o}return n}}function HT(e,t){let n=0;if(t===void 0)for(let r of e)(r=+r)&&(n+=r);else{let r=-1;for(let s of e)(s=+t(s,++r,e))&&(n+=s)}return n}function Mj(e){if(!(i=e.length))return[];for(var t=-1,n=pp(e,WT),r=new Array(n);++t<n;)for(var s=-1,i,l=r[t]=new Array(i);++s<i;)l[s]=e[s][t];return r}function WT(e){return e.length}function VT(){return Mj(arguments)}function GT(e,t){if(typeof t!="function")throw new TypeError("test is not a function");let n=-1;for(const r of e)if(!t(r,++n,e))return!1;return!0}function YT(e,t){if(typeof t!="function")throw new TypeError("test is not a function");let n=-1;for(const r of e)if(t(r,++n,e))return!0;return!1}function JT(e,t){if(typeof t!="function")throw new TypeError("test is not a function");const n=[];let r=-1;for(const s of e)t(s,++r,e)&&n.push(s);return n}function ZT(e,t){if(typeof e[Symbol.iterator]!="function")throw new TypeError("values is not iterable");if(typeof t!="function")throw new TypeError("mapper is not a function");return Array.from(e,(n,r)=>t(n,r,e))}function XT(e,t,n){if(typeof t!="function")throw new TypeError("reducer is not a function");const r=e[Symbol.iterator]();let s,i,l=-1;if(arguments.length<3){if({done:s,value:n}=r.next(),s)return;++l}for(;{done:s,value:i}=r.next(),!s;)n=t(n,i,++l,e);return n}function KT(e){if(typeof e[Symbol.iterator]!="function")throw new TypeError("values is not iterable");return Array.from(e).reverse()}function QT(e,...t){e=new Set(e);for(const n of t)for(const r of n)e.delete(r);return e}function eL(e,t){const n=t[Symbol.iterator](),r=new Set;for(const s of e){if(r.has(s))return!1;let i,l;for(;({value:i,done:l}=n.next())&&!l;){if(Object.is(s,i))return!1;r.add(i)}}return!0}function tL(e){return e instanceof Set?e:new Set(e)}function nL(e,...t){e=new Set(e),t=t.map(tL);e:for(const n of e)for(const r of t)if(!r.has(n)){e.delete(n);continue e}return e}function Rj(e,t){const n=e[Symbol.iterator](),r=new Set;for(const s of t){if(r.has(s))continue;let i,l;for(;{value:i,done:l}=n.next();){if(l)return!1;if(r.add(i),Object.is(s,i))break}}return!0}function rL(e,t){return Rj(t,e)}function sL(...e){const t=new Set;for(const n of e)for(const r of n)t.add(r);return t}var Wg=Array.prototype.slice;function iL(e){return e}var Wm=1,Vm=2,Cx=3,sf=4,l5=1e-6;function aL(e){return"translate("+e+",0)"}function oL(e){return"translate(0,"+e+")"}function lL(e){return t=>+e(t)}function cL(e,t){return t=Math.max(0,e.bandwidth()-t*2)/2,e.round()&&(t=Math.round(t)),n=>+e(n)+t}function uL(){return!this.__axis}function j0(e,t){var n=[],r=null,s=null,i=6,l=6,o=3,c=typeof window<"u"&&window.devicePixelRatio>1?0:.5,u=e===Wm||e===sf?-1:1,d=e===sf||e===Vm?"x":"y",f=e===Wm||e===Cx?aL:oL;function m(h){var x=r??(t.ticks?t.ticks.apply(t,n):t.domain()),y=s??(t.tickFormat?t.tickFormat.apply(t,n):iL),p=Math.max(i,0)+o,g=t.range(),w=+g[0]+c,v=+g[g.length-1]+c,N=(t.bandwidth?cL:lL)(t.copy(),c),A=h.selection?h.selection():h,P=A.selectAll(".domain").data([null]),U=A.selectAll(".tick").data(x,t).order(),M=U.exit(),S=U.enter().append("g").attr("class","tick"),C=U.select("line"),_=U.select("text");P=P.merge(P.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),U=U.merge(S),C=C.merge(S.append("line").attr("stroke","currentColor").attr(d+"2",u*i)),_=_.merge(S.append("text").attr("fill","currentColor").attr(d,u*p).attr("dy",e===Wm?"0em":e===Cx?"0.71em":"0.32em")),h!==A&&(P=P.transition(h),U=U.transition(h),C=C.transition(h),_=_.transition(h),M=M.transition(h).attr("opacity",l5).attr("transform",function(T){return isFinite(T=N(T))?f(T+c):this.getAttribute("transform")}),S.attr("opacity",l5).attr("transform",function(T){var B=this.parentNode.__axis;return f((B&&isFinite(B=B(T))?B:N(T))+c)})),M.remove(),P.attr("d",e===sf||e===Vm?l?"M"+u*l+","+w+"H"+c+"V"+v+"H"+u*l:"M"+c+","+w+"V"+v:l?"M"+w+","+u*l+"V"+c+"H"+v+"V"+u*l:"M"+w+","+c+"H"+v),U.attr("opacity",1).attr("transform",function(T){return f(N(T)+c)}),C.attr(d+"2",u*i),_.attr(d,u*p).text(y),A.filter(uL).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",e===Vm?"start":e===sf?"end":"middle"),A.each(function(){this.__axis=N})}return m.scale=function(h){return arguments.length?(t=h,m):t},m.ticks=function(){return n=Wg.call(arguments),m},m.tickArguments=function(h){return arguments.length?(n=h==null?[]:Wg.call(h),m):n.slice()},m.tickValues=function(h){return arguments.length?(r=h==null?null:Wg.call(h),m):r&&r.slice()},m.tickFormat=function(h){return arguments.length?(s=h,m):s},m.tickSize=function(h){return arguments.length?(i=l=+h,m):i},m.tickSizeInner=function(h){return arguments.length?(i=+h,m):i},m.tickSizeOuter=function(h){return arguments.length?(l=+h,m):l},m.tickPadding=function(h){return arguments.length?(o=+h,m):o},m.offset=function(h){return arguments.length?(c=+h,m):c},m}function dL(e){return j0(Wm,e)}function fL(e){return j0(Vm,e)}function hL(e){return j0(Cx,e)}function mL(e){return j0(sf,e)}var pL={value:()=>{}};function uc(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new Gm(n)}function Gm(e){this._=e}function gL(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",s=n.indexOf(".");if(s>=0&&(r=n.slice(s+1),n=n.slice(0,s)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}Gm.prototype=uc.prototype={constructor:Gm,on:function(e,t){var n=this._,r=gL(e+"",n),s,i=-1,l=r.length;if(arguments.length<2){for(;++i<l;)if((s=(e=r[i]).type)&&(s=xL(n[s],e.name)))return s;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<l;)if(s=(e=r[i]).type)n[s]=c5(n[s],e.name,t);else if(t==null)for(s in n)n[s]=c5(n[s],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new Gm(e)},call:function(e,t){if((s=arguments.length-2)>0)for(var n=new Array(s),r=0,s,i;r<s;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],r=0,s=i.length;r<s;++r)i[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],s=0,i=r.length;s<i;++s)r[s].value.apply(t,n)}};function xL(e,t){for(var n=0,r=e.length,s;n<r;++n)if((s=e[n]).name===t)return s.value}function c5(e,t,n){for(var r=0,s=e.length;r<s;++r)if(e[r].name===t){e[r]=pL,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var Px="http://www.w3.org/1999/xhtml";const Ix={svg:"http://www.w3.org/2000/svg",xhtml:Px,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function mh(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),Ix.hasOwnProperty(t)?{space:Ix[t],local:e}:e}function yL(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===Px&&t.documentElement.namespaceURI===Px?t.createElement(e):t.createElementNS(n,e)}}function bL(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function S0(e){var t=mh(e);return(t.local?bL:yL)(t)}function vL(){}function _0(e){return e==null?vL:function(){return this.querySelector(e)}}function wL(e){typeof e!="function"&&(e=_0(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var i=t[s],l=i.length,o=r[s]=new Array(l),c,u,d=0;d<l;++d)(c=i[d])&&(u=e.call(c,c.__data__,d,i))&&("__data__"in c&&(u.__data__=c.__data__),o[d]=u);return new Ms(r,this._parents)}function ly(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function NL(){return[]}function cy(e){return e==null?NL:function(){return this.querySelectorAll(e)}}function jL(e){return function(){var t=e.apply(this,arguments);return t==null?[]:ly(t)}}function SL(e){typeof e=="function"?e=jL(e):e=cy(e);for(var t=this._groups,n=t.length,r=[],s=[],i=0;i<n;++i)for(var l=t[i],o=l.length,c,u=0;u<o;++u)(c=l[u])&&(r.push(e.call(c,c.__data__,u,l)),s.push(c));return new Ms(r,s)}function uy(e){return function(){return this.matches(e)}}function $j(e){return function(t){return t.matches(e)}}var _L=Array.prototype.find;function AL(e){return function(){return _L.call(this.children,e)}}function kL(){return this.firstElementChild}function EL(e){return this.select(e==null?kL:AL(typeof e=="function"?e:$j(e)))}var CL=Array.prototype.filter;function PL(){return this.children}function IL(e){return function(){return CL.call(this.children,e)}}function TL(e){return this.selectAll(e==null?PL:IL(typeof e=="function"?e:$j(e)))}function LL(e){typeof e!="function"&&(e=uy(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var i=t[s],l=i.length,o=r[s]=[],c,u=0;u<l;++u)(c=i[u])&&e.call(c,c.__data__,u,i)&&o.push(c);return new Ms(r,this._parents)}function Fj(e){return new Array(e.length)}function ML(){return new Ms(this._enter||this._groups.map(Fj),this._parents)}function gp(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}gp.prototype={constructor:gp,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function RL(e){return function(){return e}}function $L(e,t,n,r,s,i){for(var l=0,o,c=t.length,u=i.length;l<u;++l)(o=t[l])?(o.__data__=i[l],r[l]=o):n[l]=new gp(e,i[l]);for(;l<c;++l)(o=t[l])&&(s[l]=o)}function FL(e,t,n,r,s,i,l){var o,c,u=new Map,d=t.length,f=i.length,m=new Array(d),h;for(o=0;o<d;++o)(c=t[o])&&(m[o]=h=l.call(c,c.__data__,o,t)+"",u.has(h)?s[o]=c:u.set(h,c));for(o=0;o<f;++o)h=l.call(e,i[o],o,i)+"",(c=u.get(h))?(r[o]=c,c.__data__=i[o],u.delete(h)):n[o]=new gp(e,i[o]);for(o=0;o<d;++o)(c=t[o])&&u.get(m[o])===c&&(s[o]=c)}function OL(e){return e.__data__}function DL(e,t){if(!arguments.length)return Array.from(this,OL);var n=t?FL:$L,r=this._parents,s=this._groups;typeof e!="function"&&(e=RL(e));for(var i=s.length,l=new Array(i),o=new Array(i),c=new Array(i),u=0;u<i;++u){var d=r[u],f=s[u],m=f.length,h=ly(e.call(d,d&&d.__data__,u,r)),x=h.length,y=o[u]=new Array(x),p=l[u]=new Array(x),g=c[u]=new Array(m);n(d,f,y,p,g,h,t);for(var w=0,v=0,N,A;w<x;++w)if(N=y[w]){for(w>=v&&(v=w+1);!(A=p[v])&&++v<x;);N._next=A||null}}return l=new Ms(l,r),l._enter=o,l._exit=c,l}function BL(){return new Ms(this._exit||this._groups.map(Fj),this._parents)}function zL(e,t,n){var r=this.enter(),s=this,i=this.exit();return r=typeof e=="function"?e(r):r.append(e+""),t!=null&&(s=t(s)),n==null?i.remove():n(i),r&&s?r.merge(s).order():s}function UL(e){if(!(e instanceof Ms))throw new Error("invalid merge");for(var t=this._groups,n=e._groups,r=t.length,s=n.length,i=Math.min(r,s),l=new Array(r),o=0;o<i;++o)for(var c=t[o],u=n[o],d=c.length,f=l[o]=new Array(d),m,h=0;h<d;++h)(m=c[h]||u[h])&&(f[h]=m);for(;o<r;++o)l[o]=t[o];return new Ms(l,this._parents)}function qL(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],s=r.length-1,i=r[s],l;--s>=0;)(l=r[s])&&(i&&l.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(l,i),i=l);return this}function HL(e){e||(e=WL);function t(f,m){return f&&m?e(f.__data__,m.__data__):!f-!m}for(var n=this._groups,r=n.length,s=new Array(r),i=0;i<r;++i){for(var l=n[i],o=l.length,c=s[i]=new Array(o),u,d=0;d<o;++d)(u=l[d])&&(c[d]=u);c.sort(t)}return new Ms(s,this._parents).order()}function WL(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function VL(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function GL(){return Array.from(this)}function YL(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],s=0,i=r.length;s<i;++s){var l=r[s];if(l)return l}return null}function JL(){let e=0;for(const t of this)++e;return e}function ZL(){return!this.node()}function XL(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var s=t[n],i=0,l=s.length,o;i<l;++i)(o=s[i])&&e.call(o,o.__data__,i,s);return this}function KL(e){return function(){this.removeAttribute(e)}}function QL(e){return function(){this.removeAttributeNS(e.space,e.local)}}function eM(e,t){return function(){this.setAttribute(e,t)}}function tM(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function nM(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function rM(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function sM(e,t){var n=mh(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?QL:KL:typeof t=="function"?n.local?rM:nM:n.local?tM:eM)(n,t))}function dy(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function iM(e){return function(){this.style.removeProperty(e)}}function aM(e,t,n){return function(){this.style.setProperty(e,t,n)}}function oM(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function lM(e,t,n){return arguments.length>1?this.each((t==null?iM:typeof t=="function"?oM:aM)(e,t,n??"")):Kl(this.node(),e)}function Kl(e,t){return e.style.getPropertyValue(t)||dy(e).getComputedStyle(e,null).getPropertyValue(t)}function cM(e){return function(){delete this[e]}}function uM(e,t){return function(){this[e]=t}}function dM(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function fM(e,t){return arguments.length>1?this.each((t==null?cM:typeof t=="function"?dM:uM)(e,t)):this.node()[e]}function Oj(e){return e.trim().split(/^|\s+/)}function fy(e){return e.classList||new Dj(e)}function Dj(e){this._node=e,this._names=Oj(e.getAttribute("class")||"")}Dj.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Bj(e,t){for(var n=fy(e),r=-1,s=t.length;++r<s;)n.add(t[r])}function zj(e,t){for(var n=fy(e),r=-1,s=t.length;++r<s;)n.remove(t[r])}function hM(e){return function(){Bj(this,e)}}function mM(e){return function(){zj(this,e)}}function pM(e,t){return function(){(t.apply(this,arguments)?Bj:zj)(this,e)}}function gM(e,t){var n=Oj(e+"");if(arguments.length<2){for(var r=fy(this.node()),s=-1,i=n.length;++s<i;)if(!r.contains(n[s]))return!1;return!0}return this.each((typeof t=="function"?pM:t?hM:mM)(n,t))}function xM(){this.textContent=""}function yM(e){return function(){this.textContent=e}}function bM(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function vM(e){return arguments.length?this.each(e==null?xM:(typeof e=="function"?bM:yM)(e)):this.node().textContent}function wM(){this.innerHTML=""}function NM(e){return function(){this.innerHTML=e}}function jM(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function SM(e){return arguments.length?this.each(e==null?wM:(typeof e=="function"?jM:NM)(e)):this.node().innerHTML}function _M(){this.nextSibling&&this.parentNode.appendChild(this)}function AM(){return this.each(_M)}function kM(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function EM(){return this.each(kM)}function CM(e){var t=typeof e=="function"?e:S0(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function PM(){return null}function IM(e,t){var n=typeof e=="function"?e:S0(e),r=t==null?PM:typeof t=="function"?t:_0(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function TM(){var e=this.parentNode;e&&e.removeChild(this)}function LM(){return this.each(TM)}function MM(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function RM(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function $M(e){return this.select(e?RM:MM)}function FM(e){return arguments.length?this.property("__data__",e):this.node().__data__}function OM(e){return function(t){e.call(this,t,this.__data__)}}function DM(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function BM(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,s=t.length,i;n<s;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++r]=i;++r?t.length=r:delete this.__on}}}function zM(e,t,n){return function(){var r=this.__on,s,i=OM(t);if(r){for(var l=0,o=r.length;l<o;++l)if((s=r[l]).type===e.type&&s.name===e.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=i,s.options=n),s.value=t;return}}this.addEventListener(e.type,i,n),s={type:e.type,name:e.name,value:t,listener:i,options:n},r?r.push(s):this.__on=[s]}}function UM(e,t,n){var r=DM(e+""),s,i=r.length,l;if(arguments.length<2){var o=this.node().__on;if(o){for(var c=0,u=o.length,d;c<u;++c)for(s=0,d=o[c];s<i;++s)if((l=r[s]).type===d.type&&l.name===d.name)return d.value}return}for(o=t?zM:BM,s=0;s<i;++s)this.each(o(r[s],t,n));return this}function Uj(e,t,n){var r=dy(e),s=r.CustomEvent;typeof s=="function"?s=new s(t,n):(s=r.document.createEvent("Event"),n?(s.initEvent(t,n.bubbles,n.cancelable),s.detail=n.detail):s.initEvent(t,!1,!1)),e.dispatchEvent(s)}function qM(e,t){return function(){return Uj(this,e,t)}}function HM(e,t){return function(){return Uj(this,e,t.apply(this,arguments))}}function WM(e,t){return this.each((typeof t=="function"?HM:qM)(e,t))}function*VM(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],s=0,i=r.length,l;s<i;++s)(l=r[s])&&(yield l)}var hy=[null];function Ms(e,t){this._groups=e,this._parents=t}function dc(){return new Ms([[document.documentElement]],hy)}function GM(){return this}Ms.prototype=dc.prototype={constructor:Ms,select:wL,selectAll:SL,selectChild:EL,selectChildren:TL,filter:LL,data:DL,enter:ML,exit:BL,join:zL,merge:UL,selection:GM,order:qL,sort:HL,call:VL,nodes:GL,node:YL,size:JL,empty:ZL,each:XL,attr:sM,style:lM,property:fM,classed:gM,text:vM,html:SM,raise:AM,lower:EM,append:CM,insert:IM,remove:LM,clone:$M,datum:FM,on:UM,dispatch:WM,[Symbol.iterator]:VM};function Ls(e){return typeof e=="string"?new Ms([[document.querySelector(e)]],[document.documentElement]):new Ms([[e]],hy)}function YM(e){return Ls(S0(e).call(document.documentElement))}var JM=0;function qj(){return new Tx}function Tx(){this._="@"+(++JM).toString(36)}Tx.prototype=qj.prototype={constructor:Tx,get:function(e){for(var t=this._;!(t in e);)if(!(e=e.parentNode))return;return e[t]},set:function(e,t){return e[this._]=t},remove:function(e){return this._ in e&&delete e[this._]},toString:function(){return this._}};function Hj(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Ni(e,t){if(e=Hj(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var s=t.getBoundingClientRect();return[e.clientX-s.left-t.clientLeft,e.clientY-s.top-t.clientTop]}}return[e.pageX,e.pageY]}function ZM(e,t){return e.target&&(e=Hj(e),t===void 0&&(t=e.currentTarget),e=e.touches||[e]),Array.from(e,n=>Ni(n,t))}function XM(e){return typeof e=="string"?new Ms([document.querySelectorAll(e)],[document.documentElement]):new Ms([e==null?[]:ly(e)],hy)}function Vg(e){e.stopImmediatePropagation()}function fu(e){e.preventDefault(),e.stopImmediatePropagation()}function A0(e){var t=e.document.documentElement,n=Ls(e).on("dragstart.drag",fu,!0);"onselectstart"in t?n.on("selectstart.drag",fu,!0):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function k0(e,t){var n=e.document.documentElement,r=Ls(e).on("dragstart.drag",null);t&&(r.on("click.drag",fu,!0),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const nm=e=>()=>e;function Lx(e,{sourceEvent:t,subject:n,target:r,identifier:s,active:i,x:l,y:o,dx:c,dy:u,dispatch:d}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:l,enumerable:!0,configurable:!0},y:{value:o,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:d}})}Lx.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function KM(e){return!e.ctrlKey&&!e.button}function QM(){return this.parentNode}function eR(e,t){return t??{x:e.x,y:e.y}}function tR(){return navigator.maxTouchPoints||"ontouchstart"in this}function nR(){var e=KM,t=QM,n=eR,r=tR,s={},i=uc("start","drag","end"),l=0,o,c,u,d,f=0;function m(N){N.on("mousedown.drag",h).filter(r).on("touchstart.drag",p).on("touchmove.drag",g).on("touchend.drag touchcancel.drag",w).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(N,A){if(!(d||!e.call(this,N,A))){var P=v(this,t.call(this,N,A),N,A,"mouse");P&&(Ls(N.view).on("mousemove.drag",x,!0).on("mouseup.drag",y,!0),A0(N.view),Vg(N),u=!1,o=N.clientX,c=N.clientY,P("start",N))}}function x(N){if(fu(N),!u){var A=N.clientX-o,P=N.clientY-c;u=A*A+P*P>f}s.mouse("drag",N)}function y(N){Ls(N.view).on("mousemove.drag mouseup.drag",null),k0(N.view,u),fu(N),s.mouse("end",N)}function p(N,A){if(e.call(this,N,A)){var P=N.changedTouches,U=t.call(this,N,A),M=P.length,S,C;for(S=0;S<M;++S)(C=v(this,U,N,A,P[S].identifier,P[S]))&&(Vg(N),C("start",N,P[S]))}}function g(N){var A=N.changedTouches,P=A.length,U,M;for(U=0;U<P;++U)(M=s[A[U].identifier])&&(fu(N),M("drag",N,A[U]))}function w(N){var A=N.changedTouches,P=A.length,U,M;for(d&&clearTimeout(d),d=setTimeout(function(){d=null},500),U=0;U<P;++U)(M=s[A[U].identifier])&&(Vg(N),M("end",N,A[U]))}function v(N,A,P,U,M,S){var C=i.copy(),_=Ni(S||P,A),T,B,$;if(($=n.call(N,new Lx("beforestart",{sourceEvent:P,target:m,identifier:M,active:l,x:_[0],y:_[1],dx:0,dy:0,dispatch:C}),U))!=null)return T=$.x-_[0]||0,B=$.y-_[1]||0,function D(L,O,W){var E=_,H;switch(L){case"start":s[M]=D,H=l++;break;case"end":delete s[M],--l;case"drag":_=Ni(W||O,A),H=l;break}C.call(L,N,new Lx(L,{sourceEvent:O,subject:$,target:m,identifier:M,active:H,x:_[0]+T,y:_[1]+B,dx:_[0]-E[0],dy:_[1]-E[1],dispatch:C}),U)}}return m.filter=function(N){return arguments.length?(e=typeof N=="function"?N:nm(!!N),m):e},m.container=function(N){return arguments.length?(t=typeof N=="function"?N:nm(N),m):t},m.subject=function(N){return arguments.length?(n=typeof N=="function"?N:nm(N),m):n},m.touchable=function(N){return arguments.length?(r=typeof N=="function"?N:nm(!!N),m):r},m.on=function(){var N=i.on.apply(i,arguments);return N===i?m:N},m.clickDistance=function(N){return arguments.length?(f=(N=+N)*N,m):Math.sqrt(f)},m}function Ku(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function ph(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function ol(){}var Ql=.7,Cu=1/Ql,hu="\\s*([+-]?\\d+)\\s*",Of="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ca="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",rR=/^#([0-9a-f]{3,8})$/,sR=new RegExp("^rgb\\("+[hu,hu,hu]+"\\)$"),iR=new RegExp("^rgb\\("+[Ca,Ca,Ca]+"\\)$"),aR=new RegExp("^rgba\\("+[hu,hu,hu,Of]+"\\)$"),oR=new RegExp("^rgba\\("+[Ca,Ca,Ca,Of]+"\\)$"),lR=new RegExp("^hsl\\("+[Of,Ca,Ca]+"\\)$"),cR=new RegExp("^hsla\\("+[Of,Ca,Ca,Of]+"\\)$"),u5={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Ku(ol,tl,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:d5,formatHex:d5,formatHsl:uR,formatRgb:f5,toString:f5});function d5(){return this.rgb().formatHex()}function uR(){return Wj(this).formatHsl()}function f5(){return this.rgb().formatRgb()}function tl(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=rR.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?h5(t):n===3?new ys(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?rm(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?rm(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=sR.exec(e))?new ys(t[1],t[2],t[3],1):(t=iR.exec(e))?new ys(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=aR.exec(e))?rm(t[1],t[2],t[3],t[4]):(t=oR.exec(e))?rm(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=lR.exec(e))?g5(t[1],t[2]/100,t[3]/100,1):(t=cR.exec(e))?g5(t[1],t[2]/100,t[3]/100,t[4]):u5.hasOwnProperty(e)?h5(u5[e]):e==="transparent"?new ys(NaN,NaN,NaN,0):null}function h5(e){return new ys(e>>16&255,e>>8&255,e&255,1)}function rm(e,t,n,r){return r<=0&&(e=t=n=NaN),new ys(e,t,n,r)}function my(e){return e instanceof ol||(e=tl(e)),e?(e=e.rgb(),new ys(e.r,e.g,e.b,e.opacity)):new ys}function Pu(e,t,n,r){return arguments.length===1?my(e):new ys(e,t,n,r??1)}function ys(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}Ku(ys,Pu,ph(ol,{brighter:function(e){return e=e==null?Cu:Math.pow(Cu,e),new ys(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?Ql:Math.pow(Ql,e),new ys(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:m5,formatHex:m5,formatRgb:p5,toString:p5}));function m5(){return"#"+Gg(this.r)+Gg(this.g)+Gg(this.b)}function p5(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function Gg(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function g5(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new ja(e,t,n,r)}function Wj(e){if(e instanceof ja)return new ja(e.h,e.s,e.l,e.opacity);if(e instanceof ol||(e=tl(e)),!e)return new ja;if(e instanceof ja)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,s=Math.min(t,n,r),i=Math.max(t,n,r),l=NaN,o=i-s,c=(i+s)/2;return o?(t===i?l=(n-r)/o+(n<r)*6:n===i?l=(r-t)/o+2:l=(t-n)/o+4,o/=c<.5?i+s:2-i-s,l*=60):o=c>0&&c<1?0:l,new ja(l,o,c,e.opacity)}function xp(e,t,n,r){return arguments.length===1?Wj(e):new ja(e,t,n,r??1)}function ja(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Ku(ja,xp,ph(ol,{brighter:function(e){return e=e==null?Cu:Math.pow(Cu,e),new ja(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Ql:Math.pow(Ql,e),new ja(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,s=2*n-r;return new ys(Yg(e>=240?e-240:e+120,s,r),Yg(e,s,r),Yg(e<120?e+240:e-120,s,r),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function Yg(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const Vj=Math.PI/180,Gj=180/Math.PI,yp=18,Yj=.96422,Jj=1,Zj=.82521,Xj=4/29,mu=6/29,Kj=3*mu*mu,dR=mu*mu*mu;function Qj(e){if(e instanceof ta)return new ta(e.l,e.a,e.b,e.opacity);if(e instanceof ka)return t6(e);e instanceof ys||(e=my(e));var t=Kg(e.r),n=Kg(e.g),r=Kg(e.b),s=Jg((.2225045*t+.7168786*n+.0606169*r)/Jj),i,l;return t===n&&n===r?i=l=s:(i=Jg((.4360747*t+.3850649*n+.1430804*r)/Yj),l=Jg((.0139322*t+.0971045*n+.7141733*r)/Zj)),new ta(116*s-16,500*(i-s),200*(s-l),e.opacity)}function fR(e,t){return new ta(e,0,0,t??1)}function bp(e,t,n,r){return arguments.length===1?Qj(e):new ta(e,t,n,r??1)}function ta(e,t,n,r){this.l=+e,this.a=+t,this.b=+n,this.opacity=+r}Ku(ta,bp,ph(ol,{brighter:function(e){return new ta(this.l+yp*(e??1),this.a,this.b,this.opacity)},darker:function(e){return new ta(this.l-yp*(e??1),this.a,this.b,this.opacity)},rgb:function(){var e=(this.l+16)/116,t=isNaN(this.a)?e:e+this.a/500,n=isNaN(this.b)?e:e-this.b/200;return t=Yj*Zg(t),e=Jj*Zg(e),n=Zj*Zg(n),new ys(Xg(3.1338561*t-1.6168667*e-.4906146*n),Xg(-.9787684*t+1.9161415*e+.033454*n),Xg(.0719453*t-.2289914*e+1.4052427*n),this.opacity)}}));function Jg(e){return e>dR?Math.pow(e,1/3):e/Kj+Xj}function Zg(e){return e>mu?e*e*e:Kj*(e-Xj)}function Xg(e){return 255*(e<=.0031308?12.92*e:1.055*Math.pow(e,1/2.4)-.055)}function Kg(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function e6(e){if(e instanceof ka)return new ka(e.h,e.c,e.l,e.opacity);if(e instanceof ta||(e=Qj(e)),e.a===0&&e.b===0)return new ka(NaN,0<e.l&&e.l<100?0:NaN,e.l,e.opacity);var t=Math.atan2(e.b,e.a)*Gj;return new ka(t<0?t+360:t,Math.sqrt(e.a*e.a+e.b*e.b),e.l,e.opacity)}function hR(e,t,n,r){return arguments.length===1?e6(e):new ka(n,t,e,r??1)}function vp(e,t,n,r){return arguments.length===1?e6(e):new ka(e,t,n,r??1)}function ka(e,t,n,r){this.h=+e,this.c=+t,this.l=+n,this.opacity=+r}function t6(e){if(isNaN(e.h))return new ta(e.l,0,0,e.opacity);var t=e.h*Vj;return new ta(e.l,Math.cos(t)*e.c,Math.sin(t)*e.c,e.opacity)}Ku(ka,vp,ph(ol,{brighter:function(e){return new ka(this.h,this.c,this.l+yp*(e??1),this.opacity)},darker:function(e){return new ka(this.h,this.c,this.l-yp*(e??1),this.opacity)},rgb:function(){return t6(this).rgb()}}));var n6=-.14861,py=1.78277,gy=-.29227,E0=-.90649,Df=1.97294,x5=Df*E0,y5=Df*py,b5=py*gy-E0*n6;function mR(e){if(e instanceof Gl)return new Gl(e.h,e.s,e.l,e.opacity);e instanceof ys||(e=my(e));var t=e.r/255,n=e.g/255,r=e.b/255,s=(b5*r+x5*t-y5*n)/(b5+x5-y5),i=r-s,l=(Df*(n-s)-gy*i)/E0,o=Math.sqrt(l*l+i*i)/(Df*s*(1-s)),c=o?Math.atan2(l,i)*Gj-120:NaN;return new Gl(c<0?c+360:c,o,s,e.opacity)}function aa(e,t,n,r){return arguments.length===1?mR(e):new Gl(e,t,n,r??1)}function Gl(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}Ku(Gl,aa,ph(ol,{brighter:function(e){return e=e==null?Cu:Math.pow(Cu,e),new Gl(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?Ql:Math.pow(Ql,e),new Gl(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=isNaN(this.h)?0:(this.h+120)*Vj,t=+this.l,n=isNaN(this.s)?0:this.s*t*(1-t),r=Math.cos(e),s=Math.sin(e);return new ys(255*(t+n*(n6*r+py*s)),255*(t+n*(gy*r+E0*s)),255*(t+n*(Df*r)),this.opacity)}}));function r6(e,t,n,r,s){var i=e*e,l=i*e;return((1-3*e+3*i-l)*t+(4-6*i+3*l)*n+(1+3*e+3*i-3*l)*r+l*s)/6}function s6(e){var t=e.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,t-1):Math.floor(n*t),s=e[r],i=e[r+1],l=r>0?e[r-1]:2*s-i,o=r<t-1?e[r+2]:2*i-s;return r6((n-r/t)*t,l,s,i,o)}}function i6(e){var t=e.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*t),s=e[(r+t-1)%t],i=e[r%t],l=e[(r+1)%t],o=e[(r+2)%t];return r6((n-r/t)*t,s,i,l,o)}}const C0=e=>()=>e;function a6(e,t){return function(n){return e+n*t}}function pR(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function P0(e,t){var n=t-e;return n?a6(e,n>180||n<-180?n-360*Math.round(n/360):n):C0(isNaN(e)?t:e)}function gR(e){return(e=+e)==1?as:function(t,n){return n-t?pR(t,n,e):C0(isNaN(t)?n:t)}}function as(e,t){var n=t-e;return n?a6(e,n):C0(isNaN(e)?t:e)}const Bf=function e(t){var n=gR(t);function r(s,i){var l=n((s=Pu(s)).r,(i=Pu(i)).r),o=n(s.g,i.g),c=n(s.b,i.b),u=as(s.opacity,i.opacity);return function(d){return s.r=l(d),s.g=o(d),s.b=c(d),s.opacity=u(d),s+""}}return r.gamma=e,r}(1);function o6(e){return function(t){var n=t.length,r=new Array(n),s=new Array(n),i=new Array(n),l,o;for(l=0;l<n;++l)o=Pu(t[l]),r[l]=o.r||0,s[l]=o.g||0,i[l]=o.b||0;return r=e(r),s=e(s),i=e(i),o.opacity=1,function(c){return o.r=r(c),o.g=s(c),o.b=i(c),o+""}}}var l6=o6(s6),xR=o6(i6);function xy(e,t){t||(t=[]);var n=e?Math.min(t.length,e.length):0,r=t.slice(),s;return function(i){for(s=0;s<n;++s)r[s]=e[s]*(1-i)+t[s]*i;return r}}function c6(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function yR(e,t){return(c6(t)?xy:u6)(e,t)}function u6(e,t){var n=t?t.length:0,r=e?Math.min(n,e.length):0,s=new Array(r),i=new Array(n),l;for(l=0;l<r;++l)s[l]=ll(e[l],t[l]);for(;l<n;++l)i[l]=t[l];return function(o){for(l=0;l<r;++l)i[l]=s[l](o);return i}}function d6(e,t){var n=new Date;return e=+e,t=+t,function(r){return n.setTime(e*(1-r)+t*r),n}}function Mi(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}function f6(e,t){var n={},r={},s;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(s in t)s in e?n[s]=ll(e[s],t[s]):r[s]=t[s];return function(i){for(s in n)r[s]=n[s](i);return r}}var Mx=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Qg=new RegExp(Mx.source,"g");function bR(e){return function(){return e}}function vR(e){return function(t){return e(t)+""}}function yy(e,t){var n=Mx.lastIndex=Qg.lastIndex=0,r,s,i,l=-1,o=[],c=[];for(e=e+"",t=t+"";(r=Mx.exec(e))&&(s=Qg.exec(t));)(i=s.index)>n&&(i=t.slice(n,i),o[l]?o[l]+=i:o[++l]=i),(r=r[0])===(s=s[0])?o[l]?o[l]+=s:o[++l]=s:(o[++l]=null,c.push({i:l,x:Mi(r,s)})),n=Qg.lastIndex;return n<t.length&&(i=t.slice(n),o[l]?o[l]+=i:o[++l]=i),o.length<2?c[0]?vR(c[0].x):bR(t):(t=c.length,function(u){for(var d=0,f;d<t;++d)o[(f=c[d]).i]=f.x(u);return o.join("")})}function ll(e,t){var n=typeof t,r;return t==null||n==="boolean"?C0(t):(n==="number"?Mi:n==="string"?(r=tl(t))?(t=r,Bf):yy:t instanceof tl?Bf:t instanceof Date?d6:c6(t)?xy:Array.isArray(t)?u6:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?f6:Mi)(e,t)}function wR(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}function NR(e,t){var n=P0(+e,+t);return function(r){var s=n(r);return s-360*Math.floor(s/360)}}function I0(e,t){return e=+e,t=+t,function(n){return Math.round(e*(1-n)+t*n)}}var v5=180/Math.PI,Rx={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function h6(e,t,n,r,s,i){var l,o,c;return(l=Math.sqrt(e*e+t*t))&&(e/=l,t/=l),(c=e*n+t*r)&&(n-=e*c,r-=t*c),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,c/=o),e*r<t*n&&(e=-e,t=-t,c=-c,l=-l),{translateX:s,translateY:i,rotate:Math.atan2(t,e)*v5,skewX:Math.atan(c)*v5,scaleX:l,scaleY:o}}var sm;function jR(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?Rx:h6(t.a,t.b,t.c,t.d,t.e,t.f)}function SR(e){return e==null||(sm||(sm=document.createElementNS("http://www.w3.org/2000/svg","g")),sm.setAttribute("transform",e),!(e=sm.transform.baseVal.consolidate()))?Rx:(e=e.matrix,h6(e.a,e.b,e.c,e.d,e.e,e.f))}function m6(e,t,n,r){function s(u){return u.length?u.pop()+" ":""}function i(u,d,f,m,h,x){if(u!==f||d!==m){var y=h.push("translate(",null,t,null,n);x.push({i:y-4,x:Mi(u,f)},{i:y-2,x:Mi(d,m)})}else(f||m)&&h.push("translate("+f+t+m+n)}function l(u,d,f,m){u!==d?(u-d>180?d+=360:d-u>180&&(u+=360),m.push({i:f.push(s(f)+"rotate(",null,r)-2,x:Mi(u,d)})):d&&f.push(s(f)+"rotate("+d+r)}function o(u,d,f,m){u!==d?m.push({i:f.push(s(f)+"skewX(",null,r)-2,x:Mi(u,d)}):d&&f.push(s(f)+"skewX("+d+r)}function c(u,d,f,m,h,x){if(u!==f||d!==m){var y=h.push(s(h)+"scale(",null,",",null,")");x.push({i:y-4,x:Mi(u,f)},{i:y-2,x:Mi(d,m)})}else(f!==1||m!==1)&&h.push(s(h)+"scale("+f+","+m+")")}return function(u,d){var f=[],m=[];return u=e(u),d=e(d),i(u.translateX,u.translateY,d.translateX,d.translateY,f,m),l(u.rotate,d.rotate,f,m),o(u.skewX,d.skewX,f,m),c(u.scaleX,u.scaleY,d.scaleX,d.scaleY,f,m),u=d=null,function(h){for(var x=-1,y=m.length,p;++x<y;)f[(p=m[x]).i]=p.x(h);return f.join("")}}}var p6=m6(jR,"px, ","px)","deg)"),g6=m6(SR,", ",")",")"),_R=1e-12;function w5(e){return((e=Math.exp(e))+1/e)/2}function AR(e){return((e=Math.exp(e))-1/e)/2}function kR(e){return((e=Math.exp(2*e))-1)/(e+1)}const x6=function e(t,n,r){function s(i,l){var o=i[0],c=i[1],u=i[2],d=l[0],f=l[1],m=l[2],h=d-o,x=f-c,y=h*h+x*x,p,g;if(y<_R)g=Math.log(m/u)/t,p=function(U){return[o+U*h,c+U*x,u*Math.exp(t*U*g)]};else{var w=Math.sqrt(y),v=(m*m-u*u+r*y)/(2*u*n*w),N=(m*m-u*u-r*y)/(2*m*n*w),A=Math.log(Math.sqrt(v*v+1)-v),P=Math.log(Math.sqrt(N*N+1)-N);g=(P-A)/t,p=function(U){var M=U*g,S=w5(A),C=u/(n*w)*(S*kR(t*M+A)-AR(A));return[o+C*h,c+C*x,u*S/w5(t*M+A)]}}return p.duration=g*1e3*t/Math.SQRT2,p}return s.rho=function(i){var l=Math.max(.001,+i),o=l*l,c=o*o;return e(l,o,c)},s}(Math.SQRT2,2,4);function y6(e){return function(t,n){var r=e((t=xp(t)).h,(n=xp(n)).h),s=as(t.s,n.s),i=as(t.l,n.l),l=as(t.opacity,n.opacity);return function(o){return t.h=r(o),t.s=s(o),t.l=i(o),t.opacity=l(o),t+""}}}const ER=y6(P0);var CR=y6(as);function PR(e,t){var n=as((e=bp(e)).l,(t=bp(t)).l),r=as(e.a,t.a),s=as(e.b,t.b),i=as(e.opacity,t.opacity);return function(l){return e.l=n(l),e.a=r(l),e.b=s(l),e.opacity=i(l),e+""}}function b6(e){return function(t,n){var r=e((t=vp(t)).h,(n=vp(n)).h),s=as(t.c,n.c),i=as(t.l,n.l),l=as(t.opacity,n.opacity);return function(o){return t.h=r(o),t.c=s(o),t.l=i(o),t.opacity=l(o),t+""}}}const IR=b6(P0);var TR=b6(as);function v6(e){return function t(n){n=+n;function r(s,i){var l=e((s=aa(s)).h,(i=aa(i)).h),o=as(s.s,i.s),c=as(s.l,i.l),u=as(s.opacity,i.opacity);return function(d){return s.h=l(d),s.s=o(d),s.l=c(Math.pow(d,n)),s.opacity=u(d),s+""}}return r.gamma=t,r}(1)}const LR=v6(P0);var T0=v6(as);function w6(e,t){t===void 0&&(t=e,e=ll);for(var n=0,r=t.length-1,s=t[0],i=new Array(r<0?0:r);n<r;)i[n]=e(s,s=t[++n]);return function(l){var o=Math.max(0,Math.min(r-1,Math.floor(l*=r)));return i[o](l-o)}}function MR(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e(r/(t-1));return n}var Iu=0,af=0,zd=0,N6=1e3,wp,of,Np=0,ec=0,L0=0,zf=typeof performance=="object"&&performance.now?performance:Date,j6=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function gh(){return ec||(j6(RR),ec=zf.now()+L0)}function RR(){ec=0}function Uf(){this._call=this._time=this._next=null}Uf.prototype=M0.prototype={constructor:Uf,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?gh():+n)+(t==null?0:+t),!this._next&&of!==this&&(of?of._next=this:wp=this,of=this),this._call=e,this._time=n,$x()},stop:function(){this._call&&(this._call=null,this._time=1/0,$x())}};function M0(e,t,n){var r=new Uf;return r.restart(e,t,n),r}function S6(){gh(),++Iu;for(var e=wp,t;e;)(t=ec-e._time)>=0&&e._call.call(null,t),e=e._next;--Iu}function N5(){ec=(Np=zf.now())+L0,Iu=af=0;try{S6()}finally{Iu=0,FR(),ec=0}}function $R(){var e=zf.now(),t=e-Np;t>N6&&(L0-=t,Np=e)}function FR(){for(var e,t=wp,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:wp=n);of=e,$x(r)}function $x(e){if(!Iu){af&&(af=clearTimeout(af));var t=e-ec;t>24?(e<1/0&&(af=setTimeout(N5,e-zf.now()-L0)),zd&&(zd=clearInterval(zd))):(zd||(Np=zf.now(),zd=setInterval($R,N6)),Iu=1,j6(N5))}}function Fx(e,t,n){var r=new Uf;return t=t==null?0:+t,r.restart(s=>{r.stop(),e(s+t)},t,n),r}function OR(e,t,n){var r=new Uf,s=t;return t==null?(r.restart(e,t,n),r):(r._restart=r.restart,r.restart=function(i,l,o){l=+l,o=o==null?gh():+o,r._restart(function c(u){u+=s,r._restart(c,s+=l,o),i(u)},l,o)},r.restart(e,t,n),r)}var DR=uc("start","end","cancel","interrupt"),BR=[],_6=0,Ox=1,Dx=2,Ym=3,j5=4,Bx=5,Jm=6;function R0(e,t,n,r,s,i){var l=e.__transition;if(!l)e.__transition={};else if(n in l)return;zR(e,n,{name:t,index:r,group:s,on:DR,tween:BR,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:_6})}function by(e,t){var n=ca(e,t);if(n.state>_6)throw new Error("too late; already scheduled");return n}function $a(e,t){var n=ca(e,t);if(n.state>Ym)throw new Error("too late; already running");return n}function ca(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function zR(e,t,n){var r=e.__transition,s;r[t]=n,n.timer=M0(i,0,n.time);function i(u){n.state=Ox,n.timer.restart(l,n.delay,n.time),n.delay<=u&&l(u-n.delay)}function l(u){var d,f,m,h;if(n.state!==Ox)return c();for(d in r)if(h=r[d],h.name===n.name){if(h.state===Ym)return Fx(l);h.state===j5?(h.state=Jm,h.timer.stop(),h.on.call("interrupt",e,e.__data__,h.index,h.group),delete r[d]):+d<t&&(h.state=Jm,h.timer.stop(),h.on.call("cancel",e,e.__data__,h.index,h.group),delete r[d])}if(Fx(function(){n.state===Ym&&(n.state=j5,n.timer.restart(o,n.delay,n.time),o(u))}),n.state=Dx,n.on.call("start",e,e.__data__,n.index,n.group),n.state===Dx){for(n.state=Ym,s=new Array(m=n.tween.length),d=0,f=-1;d<m;++d)(h=n.tween[d].value.call(e,e.__data__,n.index,n.group))&&(s[++f]=h);s.length=f+1}}function o(u){for(var d=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(c),n.state=Bx,1),f=-1,m=s.length;++f<m;)s[f].call(e,d);n.state===Bx&&(n.on.call("end",e,e.__data__,n.index,n.group),c())}function c(){n.state=Jm,n.timer.stop(),delete r[t];for(var u in r)return;delete e.__transition}}function Yl(e,t){var n=e.__transition,r,s,i=!0,l;if(n){t=t==null?null:t+"";for(l in n){if((r=n[l]).name!==t){i=!1;continue}s=r.state>Dx&&r.state<Bx,r.state=Jm,r.timer.stop(),r.on.call(s?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[l]}i&&delete e.__transition}}function UR(e){return this.each(function(){Yl(this,e)})}function qR(e,t){var n,r;return function(){var s=$a(this,e),i=s.tween;if(i!==n){r=n=i;for(var l=0,o=r.length;l<o;++l)if(r[l].name===t){r=r.slice(),r.splice(l,1);break}}s.tween=r}}function HR(e,t,n){var r,s;if(typeof n!="function")throw new Error;return function(){var i=$a(this,e),l=i.tween;if(l!==r){s=(r=l).slice();for(var o={name:t,value:n},c=0,u=s.length;c<u;++c)if(s[c].name===t){s[c]=o;break}c===u&&s.push(o)}i.tween=s}}function WR(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=ca(this.node(),n).tween,s=0,i=r.length,l;s<i;++s)if((l=r[s]).name===e)return l.value;return null}return this.each((t==null?qR:HR)(n,e,t))}function vy(e,t,n){var r=e._id;return e.each(function(){var s=$a(this,r);(s.value||(s.value={}))[t]=n.apply(this,arguments)}),function(s){return ca(s,r).value[t]}}function A6(e,t){var n;return(typeof t=="number"?Mi:t instanceof tl?Bf:(n=tl(t))?(t=n,Bf):yy)(e,t)}function VR(e){return function(){this.removeAttribute(e)}}function GR(e){return function(){this.removeAttributeNS(e.space,e.local)}}function YR(e,t,n){var r,s=n+"",i;return function(){var l=this.getAttribute(e);return l===s?null:l===r?i:i=t(r=l,n)}}function JR(e,t,n){var r,s=n+"",i;return function(){var l=this.getAttributeNS(e.space,e.local);return l===s?null:l===r?i:i=t(r=l,n)}}function ZR(e,t,n){var r,s,i;return function(){var l,o=n(this),c;return o==null?void this.removeAttribute(e):(l=this.getAttribute(e),c=o+"",l===c?null:l===r&&c===s?i:(s=c,i=t(r=l,o)))}}function XR(e,t,n){var r,s,i;return function(){var l,o=n(this),c;return o==null?void this.removeAttributeNS(e.space,e.local):(l=this.getAttributeNS(e.space,e.local),c=o+"",l===c?null:l===r&&c===s?i:(s=c,i=t(r=l,o)))}}function KR(e,t){var n=mh(e),r=n==="transform"?g6:A6;return this.attrTween(e,typeof t=="function"?(n.local?XR:ZR)(n,r,vy(this,"attr."+e,t)):t==null?(n.local?GR:VR)(n):(n.local?JR:YR)(n,r,t))}function QR(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function e$(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function t$(e,t){var n,r;function s(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&e$(e,i)),n}return s._value=t,s}function n$(e,t){var n,r;function s(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&QR(e,i)),n}return s._value=t,s}function r$(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=mh(e);return this.tween(n,(r.local?t$:n$)(r,t))}function s$(e,t){return function(){by(this,e).delay=+t.apply(this,arguments)}}function i$(e,t){return t=+t,function(){by(this,e).delay=t}}function a$(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?s$:i$)(t,e)):ca(this.node(),t).delay}function o$(e,t){return function(){$a(this,e).duration=+t.apply(this,arguments)}}function l$(e,t){return t=+t,function(){$a(this,e).duration=t}}function c$(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?o$:l$)(t,e)):ca(this.node(),t).duration}function u$(e,t){if(typeof t!="function")throw new Error;return function(){$a(this,e).ease=t}}function d$(e){var t=this._id;return arguments.length?this.each(u$(t,e)):ca(this.node(),t).ease}function f$(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;$a(this,e).ease=n}}function h$(e){if(typeof e!="function")throw new Error;return this.each(f$(this._id,e))}function m$(e){typeof e!="function"&&(e=uy(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var i=t[s],l=i.length,o=r[s]=[],c,u=0;u<l;++u)(c=i[u])&&e.call(c,c.__data__,u,i)&&o.push(c);return new Ta(r,this._parents,this._name,this._id)}function p$(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,s=n.length,i=Math.min(r,s),l=new Array(r),o=0;o<i;++o)for(var c=t[o],u=n[o],d=c.length,f=l[o]=new Array(d),m,h=0;h<d;++h)(m=c[h]||u[h])&&(f[h]=m);for(;o<r;++o)l[o]=t[o];return new Ta(l,this._parents,this._name,this._id)}function g$(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function x$(e,t,n){var r,s,i=g$(t)?by:$a;return function(){var l=i(this,e),o=l.on;o!==r&&(s=(r=o).copy()).on(t,n),l.on=s}}function y$(e,t){var n=this._id;return arguments.length<2?ca(this.node(),n).on.on(e):this.each(x$(n,e,t))}function b$(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function v$(){return this.on("end.remove",b$(this._id))}function w$(e){var t=this._name,n=this._id;typeof e!="function"&&(e=_0(e));for(var r=this._groups,s=r.length,i=new Array(s),l=0;l<s;++l)for(var o=r[l],c=o.length,u=i[l]=new Array(c),d,f,m=0;m<c;++m)(d=o[m])&&(f=e.call(d,d.__data__,m,o))&&("__data__"in d&&(f.__data__=d.__data__),u[m]=f,R0(u[m],t,n,m,u,ca(d,n)));return new Ta(i,this._parents,t,n)}function N$(e){var t=this._name,n=this._id;typeof e!="function"&&(e=cy(e));for(var r=this._groups,s=r.length,i=[],l=[],o=0;o<s;++o)for(var c=r[o],u=c.length,d,f=0;f<u;++f)if(d=c[f]){for(var m=e.call(d,d.__data__,f,c),h,x=ca(d,n),y=0,p=m.length;y<p;++y)(h=m[y])&&R0(h,t,n,y,m,x);i.push(m),l.push(d)}return new Ta(i,l,t,n)}var j$=dc.prototype.constructor;function S$(){return new j$(this._groups,this._parents)}function _$(e,t){var n,r,s;return function(){var i=Kl(this,e),l=(this.style.removeProperty(e),Kl(this,e));return i===l?null:i===n&&l===r?s:s=t(n=i,r=l)}}function k6(e){return function(){this.style.removeProperty(e)}}function A$(e,t,n){var r,s=n+"",i;return function(){var l=Kl(this,e);return l===s?null:l===r?i:i=t(r=l,n)}}function k$(e,t,n){var r,s,i;return function(){var l=Kl(this,e),o=n(this),c=o+"";return o==null&&(c=o=(this.style.removeProperty(e),Kl(this,e))),l===c?null:l===r&&c===s?i:(s=c,i=t(r=l,o))}}function E$(e,t){var n,r,s,i="style."+t,l="end."+i,o;return function(){var c=$a(this,e),u=c.on,d=c.value[i]==null?o||(o=k6(t)):void 0;(u!==n||s!==d)&&(r=(n=u).copy()).on(l,s=d),c.on=r}}function C$(e,t,n){var r=(e+="")=="transform"?p6:A6;return t==null?this.styleTween(e,_$(e,r)).on("end.style."+e,k6(e)):typeof t=="function"?this.styleTween(e,k$(e,r,vy(this,"style."+e,t))).each(E$(this._id,e)):this.styleTween(e,A$(e,r,t),n).on("end.style."+e,null)}function P$(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function I$(e,t,n){var r,s;function i(){var l=t.apply(this,arguments);return l!==s&&(r=(s=l)&&P$(e,l,n)),r}return i._value=t,i}function T$(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,I$(e,t,n??""))}function L$(e){return function(){this.textContent=e}}function M$(e){return function(){var t=e(this);this.textContent=t??""}}function R$(e){return this.tween("text",typeof e=="function"?M$(vy(this,"text",e)):L$(e==null?"":e+""))}function $$(e){return function(t){this.textContent=e.call(this,t)}}function F$(e){var t,n;function r(){var s=e.apply(this,arguments);return s!==n&&(t=(n=s)&&$$(s)),t}return r._value=e,r}function O$(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,F$(e))}function D$(){for(var e=this._name,t=this._id,n=C6(),r=this._groups,s=r.length,i=0;i<s;++i)for(var l=r[i],o=l.length,c,u=0;u<o;++u)if(c=l[u]){var d=ca(c,t);R0(c,e,n,u,l,{time:d.time+d.delay+d.duration,delay:0,duration:d.duration,ease:d.ease})}return new Ta(r,this._parents,e,n)}function B$(){var e,t,n=this,r=n._id,s=n.size();return new Promise(function(i,l){var o={value:l},c={value:function(){--s===0&&i()}};n.each(function(){var u=$a(this,r),d=u.on;d!==e&&(t=(e=d).copy(),t._.cancel.push(o),t._.interrupt.push(o),t._.end.push(c)),u.on=t}),s===0&&i()})}var z$=0;function Ta(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function E6(e){return dc().transition(e)}function C6(){return++z$}var Il=dc.prototype;Ta.prototype=E6.prototype={constructor:Ta,select:w$,selectAll:N$,filter:m$,merge:p$,selection:S$,transition:D$,call:Il.call,nodes:Il.nodes,node:Il.node,size:Il.size,empty:Il.empty,each:Il.each,on:y$,attr:KR,attrTween:r$,style:C$,styleTween:T$,text:R$,textTween:O$,remove:v$,tween:WR,delay:a$,duration:c$,ease:d$,easeVarying:h$,end:B$,[Symbol.iterator]:Il[Symbol.iterator]};const U$=e=>+e;function q$(e){return e*e}function H$(e){return e*(2-e)}function S5(e){return((e*=2)<=1?e*e:--e*(2-e)+1)/2}function W$(e){return e*e*e}function V$(e){return--e*e*e+1}function zx(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var wy=3,G$=function e(t){t=+t;function n(r){return Math.pow(r,t)}return n.exponent=e,n}(wy),Y$=function e(t){t=+t;function n(r){return 1-Math.pow(1-r,t)}return n.exponent=e,n}(wy),_5=function e(t){t=+t;function n(r){return((r*=2)<=1?Math.pow(r,t):2-Math.pow(2-r,t))/2}return n.exponent=e,n}(wy),P6=Math.PI,I6=P6/2;function J$(e){return+e==1?1:1-Math.cos(e*I6)}function Z$(e){return Math.sin(e*I6)}function A5(e){return(1-Math.cos(P6*e))/2}function nl(e){return(Math.pow(2,-10*e)-.0009765625)*1.0009775171065494}function X$(e){return nl(1-+e)}function K$(e){return 1-nl(e)}function k5(e){return((e*=2)<=1?nl(1-e):2-nl(e-1))/2}function Q$(e){return 1-Math.sqrt(1-e*e)}function eF(e){return Math.sqrt(1- --e*e)}function E5(e){return((e*=2)<=1?1-Math.sqrt(1-e*e):Math.sqrt(1-(e-=2)*e)+1)/2}var Ux=4/11,tF=6/11,nF=8/11,rF=3/4,sF=9/11,iF=10/11,aF=15/16,oF=21/22,lF=63/64,im=1/Ux/Ux;function cF(e){return 1-qf(1-e)}function qf(e){return(e=+e)<Ux?im*e*e:e<nF?im*(e-=tF)*e+rF:e<iF?im*(e-=sF)*e+aF:im*(e-=oF)*e+lF}function uF(e){return((e*=2)<=1?1-qf(1-e):qf(e-1)+1)/2}var Ny=1.70158,dF=function e(t){t=+t;function n(r){return(r=+r)*r*(t*(r-1)+r)}return n.overshoot=e,n}(Ny),fF=function e(t){t=+t;function n(r){return--r*r*((r+1)*t+r)+1}return n.overshoot=e,n}(Ny),C5=function e(t){t=+t;function n(r){return((r*=2)<1?r*r*((t+1)*r-t):(r-=2)*r*((t+1)*r+t)+2)/2}return n.overshoot=e,n}(Ny),Tu=2*Math.PI,jy=1,Sy=.3,hF=function e(t,n){var r=Math.asin(1/(t=Math.max(1,t)))*(n/=Tu);function s(i){return t*nl(- --i)*Math.sin((r-i)/n)}return s.amplitude=function(i){return e(i,n*Tu)},s.period=function(i){return e(t,i)},s}(jy,Sy),P5=function e(t,n){var r=Math.asin(1/(t=Math.max(1,t)))*(n/=Tu);function s(i){return 1-t*nl(i=+i)*Math.sin((i+r)/n)}return s.amplitude=function(i){return e(i,n*Tu)},s.period=function(i){return e(t,i)},s}(jy,Sy),mF=function e(t,n){var r=Math.asin(1/(t=Math.max(1,t)))*(n/=Tu);function s(i){return((i=i*2-1)<0?t*nl(-i)*Math.sin((r-i)/n):2-t*nl(i)*Math.sin((r+i)/n))/2}return s.amplitude=function(i){return e(i,n*Tu)},s.period=function(i){return e(t,i)},s}(jy,Sy),pF={time:null,delay:0,duration:250,ease:zx};function gF(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function xF(e){var t,n;e instanceof Ta?(t=e._id,e=e._name):(t=C6(),(n=pF).time=gh(),e=e==null?null:e+"");for(var r=this._groups,s=r.length,i=0;i<s;++i)for(var l=r[i],o=l.length,c,u=0;u<o;++u)(c=l[u])&&R0(c,e,t,u,l,n||gF(c,t));return new Ta(r,this._parents,e,t)}dc.prototype.interrupt=UR;dc.prototype.transition=xF;var yF=[null];function bF(e,t){var n=e.__transition,r,s;if(n){t=t==null?null:t+"";for(s in n)if((r=n[s]).state>Ox&&r.name===t)return new Ta([[e]],yF,t,+s)}return null}const e1=e=>()=>e;function vF(e,{sourceEvent:t,target:n,selection:r,mode:s,dispatch:i}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},selection:{value:r,enumerable:!0,configurable:!0},mode:{value:s,enumerable:!0,configurable:!0},_:{value:i}})}function wF(e){e.stopImmediatePropagation()}function t1(e){e.preventDefault(),e.stopImmediatePropagation()}var I5={name:"drag"},n1={name:"space"},Dc={name:"handle"},Bc={name:"center"};const{abs:T5,max:Ss,min:_s}=Math;function L5(e){return[+e[0],+e[1]]}function qx(e){return[L5(e[0]),L5(e[1])]}var Zm={name:"x",handles:["w","e"].map(Hf),input:function(e,t){return e==null?null:[[+e[0],t[0][1]],[+e[1],t[1][1]]]},output:function(e){return e&&[e[0][0],e[1][0]]}},Xm={name:"y",handles:["n","s"].map(Hf),input:function(e,t){return e==null?null:[[t[0][0],+e[0]],[t[1][0],+e[1]]]},output:function(e){return e&&[e[0][1],e[1][1]]}},NF={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(Hf),input:function(e){return e==null?null:qx(e)},output:function(e){return e}},Xa={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},M5={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},R5={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},jF={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},SF={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function Hf(e){return{type:e}}function _F(e){return!e.ctrlKey&&!e.button}function AF(){var e=this.ownerSVGElement||this;return e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]}function kF(){return navigator.maxTouchPoints||"ontouchstart"in this}function r1(e){for(;!e.__brush;)if(!(e=e.parentNode))return;return e.__brush}function EF(e){return e[0][0]===e[1][0]||e[0][1]===e[1][1]}function CF(e){var t=e.__brush;return t?t.dim.output(t.selection):null}function PF(){return _y(Zm)}function IF(){return _y(Xm)}function TF(){return _y(NF)}function _y(e){var t=AF,n=_F,r=kF,s=!0,i=uc("start","brush","end"),l=6,o;function c(p){var g=p.property("__brush",y).selectAll(".overlay").data([Hf("overlay")]);g.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",Xa.overlay).merge(g).each(function(){var v=r1(this).extent;Ls(this).attr("x",v[0][0]).attr("y",v[0][1]).attr("width",v[1][0]-v[0][0]).attr("height",v[1][1]-v[0][1])}),p.selectAll(".selection").data([Hf("selection")]).enter().append("rect").attr("class","selection").attr("cursor",Xa.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var w=p.selectAll(".handle").data(e.handles,function(v){return v.type});w.exit().remove(),w.enter().append("rect").attr("class",function(v){return"handle handle--"+v.type}).attr("cursor",function(v){return Xa[v.type]}),p.each(u).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",m).filter(r).on("touchstart.brush",m).on("touchmove.brush",h).on("touchend.brush touchcancel.brush",x).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}c.move=function(p,g){p.tween?p.on("start.brush",function(w){d(this,arguments).beforestart().start(w)}).on("interrupt.brush end.brush",function(w){d(this,arguments).end(w)}).tween("brush",function(){var w=this,v=w.__brush,N=d(w,arguments),A=v.selection,P=e.input(typeof g=="function"?g.apply(this,arguments):g,v.extent),U=ll(A,P);function M(S){v.selection=S===1&&P===null?null:U(S),u.call(w),N.brush()}return A!==null&&P!==null?M:M(1)}):p.each(function(){var w=this,v=arguments,N=w.__brush,A=e.input(typeof g=="function"?g.apply(w,v):g,N.extent),P=d(w,v).beforestart();Yl(w),N.selection=A===null?null:A,u.call(w),P.start().brush().end()})},c.clear=function(p){c.move(p,null)};function u(){var p=Ls(this),g=r1(this).selection;g?(p.selectAll(".selection").style("display",null).attr("x",g[0][0]).attr("y",g[0][1]).attr("width",g[1][0]-g[0][0]).attr("height",g[1][1]-g[0][1]),p.selectAll(".handle").style("display",null).attr("x",function(w){return w.type[w.type.length-1]==="e"?g[1][0]-l/2:g[0][0]-l/2}).attr("y",function(w){return w.type[0]==="s"?g[1][1]-l/2:g[0][1]-l/2}).attr("width",function(w){return w.type==="n"||w.type==="s"?g[1][0]-g[0][0]+l:l}).attr("height",function(w){return w.type==="e"||w.type==="w"?g[1][1]-g[0][1]+l:l})):p.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function d(p,g,w){var v=p.__brush.emitter;return v&&(!w||!v.clean)?v:new f(p,g,w)}function f(p,g,w){this.that=p,this.args=g,this.state=p.__brush,this.active=0,this.clean=w}f.prototype={beforestart:function(){return++this.active===1&&(this.state.emitter=this,this.starting=!0),this},start:function(p,g){return this.starting?(this.starting=!1,this.emit("start",p,g)):this.emit("brush",p),this},brush:function(p,g){return this.emit("brush",p,g),this},end:function(p,g){return--this.active===0&&(delete this.state.emitter,this.emit("end",p,g)),this},emit:function(p,g,w){var v=Ls(this.that).datum();i.call(p,this.that,new vF(p,{sourceEvent:g,target:c,selection:e.output(this.state.selection),mode:w,dispatch:i}),v)}};function m(p){if(o&&!p.touches||!n.apply(this,arguments))return;var g=this,w=p.target.__data__.type,v=(s&&p.metaKey?w="overlay":w)==="selection"?I5:s&&p.altKey?Bc:Dc,N=e===Xm?null:jF[w],A=e===Zm?null:SF[w],P=r1(g),U=P.extent,M=P.selection,S=U[0][0],C,_,T=U[0][1],B,$,D=U[1][0],L,O,W=U[1][1],E,H,V=0,R=0,q,F=N&&A&&s&&p.shiftKey,G,ee,ae=Array.from(p.touches||[p],$e=>{const Oe=$e.identifier;return $e=Ni($e,g),$e.point0=$e.slice(),$e.identifier=Oe,$e});if(w==="overlay"){M&&(q=!0);const $e=[ae[0],ae[1]||ae[0]];P.selection=M=[[C=e===Xm?S:_s($e[0][0],$e[1][0]),B=e===Zm?T:_s($e[0][1],$e[1][1])],[L=e===Xm?D:Ss($e[0][0],$e[1][0]),E=e===Zm?W:Ss($e[0][1],$e[1][1])]],ae.length>1&&pe()}else C=M[0][0],B=M[0][1],L=M[1][0],E=M[1][1];_=C,$=B,O=L,H=E;var re=Ls(g).attr("pointer-events","none"),Q=re.selectAll(".overlay").attr("cursor",Xa[w]);Yl(g);var fe=d(g,arguments,!0).beforestart();if(p.touches)fe.moved=oe,fe.ended=me;else{var Se=Ls(p.view).on("mousemove.brush",oe,!0).on("mouseup.brush",me,!0);s&&Se.on("keydown.brush",ne,!0).on("keyup.brush",it,!0),A0(p.view)}u.call(g),fe.start(p,v.name);function oe($e){for(const Oe of $e.changedTouches||[$e])for(const qe of ae)qe.identifier===Oe.identifier&&(qe.cur=Ni(Oe,g));if(F&&!G&&!ee&&ae.length===1){const Oe=ae[0];T5(Oe.cur[0]-Oe[0])>T5(Oe.cur[1]-Oe[1])?ee=!0:G=!0}for(const Oe of ae)Oe.cur&&(Oe[0]=Oe.cur[0],Oe[1]=Oe.cur[1]);q=!0,t1($e),pe($e)}function pe($e){const Oe=ae[0],qe=Oe.point0;var gt;switch(V=Oe[0]-qe[0],R=Oe[1]-qe[1],v){case n1:case I5:{N&&(V=Ss(S-C,_s(D-L,V)),_=C+V,O=L+V),A&&(R=Ss(T-B,_s(W-E,R)),$=B+R,H=E+R);break}case Dc:{ae[1]?(N&&(_=Ss(S,_s(D,ae[0][0])),O=Ss(S,_s(D,ae[1][0])),N=1),A&&($=Ss(T,_s(W,ae[0][1])),H=Ss(T,_s(W,ae[1][1])),A=1)):(N<0?(V=Ss(S-C,_s(D-C,V)),_=C+V,O=L):N>0&&(V=Ss(S-L,_s(D-L,V)),_=C,O=L+V),A<0?(R=Ss(T-B,_s(W-B,R)),$=B+R,H=E):A>0&&(R=Ss(T-E,_s(W-E,R)),$=B,H=E+R));break}case Bc:{N&&(_=Ss(S,_s(D,C-V*N)),O=Ss(S,_s(D,L+V*N))),A&&($=Ss(T,_s(W,B-R*A)),H=Ss(T,_s(W,E+R*A)));break}}O<_&&(N*=-1,gt=C,C=L,L=gt,gt=_,_=O,O=gt,w in M5&&Q.attr("cursor",Xa[w=M5[w]])),H<$&&(A*=-1,gt=B,B=E,E=gt,gt=$,$=H,H=gt,w in R5&&Q.attr("cursor",Xa[w=R5[w]])),P.selection&&(M=P.selection),G&&(_=M[0][0],O=M[1][0]),ee&&($=M[0][1],H=M[1][1]),(M[0][0]!==_||M[0][1]!==$||M[1][0]!==O||M[1][1]!==H)&&(P.selection=[[_,$],[O,H]],u.call(g),fe.brush($e,v.name))}function me($e){if(wF($e),$e.touches){if($e.touches.length)return;o&&clearTimeout(o),o=setTimeout(function(){o=null},500)}else k0($e.view,q),Se.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);re.attr("pointer-events","all"),Q.attr("cursor",Xa.overlay),P.selection&&(M=P.selection),EF(M)&&(P.selection=null,u.call(g)),fe.end($e,v.name)}function ne($e){switch($e.keyCode){case 16:{F=N&&A;break}case 18:{v===Dc&&(N&&(L=O-V*N,C=_+V*N),A&&(E=H-R*A,B=$+R*A),v=Bc,pe());break}case 32:{(v===Dc||v===Bc)&&(N<0?L=O-V:N>0&&(C=_-V),A<0?E=H-R:A>0&&(B=$-R),v=n1,Q.attr("cursor",Xa.selection),pe());break}default:return}t1($e)}function it($e){switch($e.keyCode){case 16:{F&&(G=ee=F=!1,pe());break}case 18:{v===Bc&&(N<0?L=O:N>0&&(C=_),A<0?E=H:A>0&&(B=$),v=Dc,pe());break}case 32:{v===n1&&($e.altKey?(N&&(L=O-V*N,C=_+V*N),A&&(E=H-R*A,B=$+R*A),v=Bc):(N<0?L=O:N>0&&(C=_),A<0?E=H:A>0&&(B=$),v=Dc),Q.attr("cursor",Xa[w]),pe());break}default:return}t1($e)}}function h(p){d(this,arguments).moved(p)}function x(p){d(this,arguments).ended(p)}function y(){var p=this.__brush||{selection:null};return p.extent=qx(t.apply(this,arguments)),p.dim=e,p}return c.extent=function(p){return arguments.length?(t=typeof p=="function"?p:e1(qx(p)),c):t},c.filter=function(p){return arguments.length?(n=typeof p=="function"?p:e1(!!p),c):n},c.touchable=function(p){return arguments.length?(r=typeof p=="function"?p:e1(!!p),c):r},c.handleSize=function(p){return arguments.length?(l=+p,c):l},c.keyModifiers=function(p){return arguments.length?(s=!!p,c):s},c.on=function(){var p=i.on.apply(i,arguments);return p===i?c:p},c}var $5=Math.abs,zc=Math.cos,Uc=Math.sin,T6=Math.PI,am=T6/2,F5=T6*2,O5=Math.max,s1=1e-12;function i1(e,t){return Array.from({length:t-e},(n,r)=>e+r)}function LF(e){return function(t,n){return e(t.source.value+t.target.value,n.source.value+n.target.value)}}function MF(){return Ay(!1,!1)}function RF(){return Ay(!1,!0)}function $F(){return Ay(!0,!1)}function Ay(e,t){var n=0,r=null,s=null,i=null;function l(o){var c=o.length,u=new Array(c),d=i1(0,c),f=new Array(c*c),m=new Array(c),h=0,x;o=Float64Array.from({length:c*c},t?(y,p)=>o[p%c][p/c|0]:(y,p)=>o[p/c|0][p%c]);for(let y=0;y<c;++y){let p=0;for(let g=0;g<c;++g)p+=o[y*c+g]+e*o[g*c+y];h+=u[y]=p}h=O5(0,F5-n*c)/h,x=h?n:F5/c;{let y=0;r&&d.sort((p,g)=>r(u[p],u[g]));for(const p of d){const g=y;if(e){const w=i1(~c+1,c).filter(v=>v<0?o[~v*c+p]:o[p*c+v]);s&&w.sort((v,N)=>s(v<0?-o[~v*c+p]:o[p*c+v],N<0?-o[~N*c+p]:o[p*c+N]));for(const v of w)if(v<0){const N=f[~v*c+p]||(f[~v*c+p]={source:null,target:null});N.target={index:p,startAngle:y,endAngle:y+=o[~v*c+p]*h,value:o[~v*c+p]}}else{const N=f[p*c+v]||(f[p*c+v]={source:null,target:null});N.source={index:p,startAngle:y,endAngle:y+=o[p*c+v]*h,value:o[p*c+v]}}m[p]={index:p,startAngle:g,endAngle:y,value:u[p]}}else{const w=i1(0,c).filter(v=>o[p*c+v]||o[v*c+p]);s&&w.sort((v,N)=>s(o[p*c+v],o[p*c+N]));for(const v of w){let N;if(p<v?(N=f[p*c+v]||(f[p*c+v]={source:null,target:null}),N.source={index:p,startAngle:y,endAngle:y+=o[p*c+v]*h,value:o[p*c+v]}):(N=f[v*c+p]||(f[v*c+p]={source:null,target:null}),N.target={index:p,startAngle:y,endAngle:y+=o[p*c+v]*h,value:o[p*c+v]},p===v&&(N.source=N.target)),N.source&&N.target&&N.source.value<N.target.value){const A=N.source;N.source=N.target,N.target=A}}m[p]={index:p,startAngle:g,endAngle:y,value:u[p]}}y+=x}}return f=Object.values(f),f.groups=m,i?f.sort(i):f}return l.padAngle=function(o){return arguments.length?(n=O5(0,o),l):n},l.sortGroups=function(o){return arguments.length?(r=o,l):r},l.sortSubgroups=function(o){return arguments.length?(s=o,l):s},l.sortChords=function(o){return arguments.length?(o==null?i=null:(i=LF(o))._=o,l):i&&i._},l}const Hx=Math.PI,Wx=2*Hx,Ml=1e-6,FF=Wx-Ml;function Vx(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function cl(){return new Vx}Vx.prototype=cl.prototype={constructor:Vx,moveTo:function(e,t){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)},closePath:function(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(e,t){this._+="L"+(this._x1=+e)+","+(this._y1=+t)},quadraticCurveTo:function(e,t,n,r){this._+="Q"+ +e+","+ +t+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(e,t,n,r,s,i){this._+="C"+ +e+","+ +t+","+ +n+","+ +r+","+(this._x1=+s)+","+(this._y1=+i)},arcTo:function(e,t,n,r,s){e=+e,t=+t,n=+n,r=+r,s=+s;var i=this._x1,l=this._y1,o=n-e,c=r-t,u=i-e,d=l-t,f=u*u+d*d;if(s<0)throw new Error("negative radius: "+s);if(this._x1===null)this._+="M"+(this._x1=e)+","+(this._y1=t);else if(f>Ml)if(!(Math.abs(d*o-c*u)>Ml)||!s)this._+="L"+(this._x1=e)+","+(this._y1=t);else{var m=n-i,h=r-l,x=o*o+c*c,y=m*m+h*h,p=Math.sqrt(x),g=Math.sqrt(f),w=s*Math.tan((Hx-Math.acos((x+f-y)/(2*p*g)))/2),v=w/g,N=w/p;Math.abs(v-1)>Ml&&(this._+="L"+(e+v*u)+","+(t+v*d)),this._+="A"+s+","+s+",0,0,"+ +(d*m>u*h)+","+(this._x1=e+N*o)+","+(this._y1=t+N*c)}},arc:function(e,t,n,r,s,i){e=+e,t=+t,n=+n,i=!!i;var l=n*Math.cos(r),o=n*Math.sin(r),c=e+l,u=t+o,d=1^i,f=i?r-s:s-r;if(n<0)throw new Error("negative radius: "+n);this._x1===null?this._+="M"+c+","+u:(Math.abs(this._x1-c)>Ml||Math.abs(this._y1-u)>Ml)&&(this._+="L"+c+","+u),n&&(f<0&&(f=f%Wx+Wx),f>FF?this._+="A"+n+","+n+",0,1,"+d+","+(e-l)+","+(t-o)+"A"+n+","+n+",0,1,"+d+","+(this._x1=c)+","+(this._y1=u):f>Ml&&(this._+="A"+n+","+n+",0,"+ +(f>=Hx)+","+d+","+(this._x1=e+n*Math.cos(s))+","+(this._y1=t+n*Math.sin(s))))},rect:function(e,t,n,r){this._+="M"+(this._x0=this._x1=+e)+","+(this._y0=this._y1=+t)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};var OF=Array.prototype.slice;function Tl(e){return function(){return e}}function DF(e){return e.source}function BF(e){return e.target}function D5(e){return e.radius}function zF(e){return e.startAngle}function UF(e){return e.endAngle}function qF(){return 0}function HF(){return 10}function L6(e){var t=DF,n=BF,r=D5,s=D5,i=zF,l=UF,o=qF,c=null;function u(){var d,f=t.apply(this,arguments),m=n.apply(this,arguments),h=o.apply(this,arguments)/2,x=OF.call(arguments),y=+r.apply(this,(x[0]=f,x)),p=i.apply(this,x)-am,g=l.apply(this,x)-am,w=+s.apply(this,(x[0]=m,x)),v=i.apply(this,x)-am,N=l.apply(this,x)-am;if(c||(c=d=cl()),h>s1&&($5(g-p)>h*2+s1?g>p?(p+=h,g-=h):(p-=h,g+=h):p=g=(p+g)/2,$5(N-v)>h*2+s1?N>v?(v+=h,N-=h):(v-=h,N+=h):v=N=(v+N)/2),c.moveTo(y*zc(p),y*Uc(p)),c.arc(0,0,y,p,g),p!==v||g!==N)if(e){var A=+e.apply(this,arguments),P=w-A,U=(v+N)/2;c.quadraticCurveTo(0,0,P*zc(v),P*Uc(v)),c.lineTo(w*zc(U),w*Uc(U)),c.lineTo(P*zc(N),P*Uc(N))}else c.quadraticCurveTo(0,0,w*zc(v),w*Uc(v)),c.arc(0,0,w,v,N);if(c.quadraticCurveTo(0,0,y*zc(p),y*Uc(p)),c.closePath(),d)return c=null,d+""||null}return e&&(u.headRadius=function(d){return arguments.length?(e=typeof d=="function"?d:Tl(+d),u):e}),u.radius=function(d){return arguments.length?(r=s=typeof d=="function"?d:Tl(+d),u):r},u.sourceRadius=function(d){return arguments.length?(r=typeof d=="function"?d:Tl(+d),u):r},u.targetRadius=function(d){return arguments.length?(s=typeof d=="function"?d:Tl(+d),u):s},u.startAngle=function(d){return arguments.length?(i=typeof d=="function"?d:Tl(+d),u):i},u.endAngle=function(d){return arguments.length?(l=typeof d=="function"?d:Tl(+d),u):l},u.padAngle=function(d){return arguments.length?(o=typeof d=="function"?d:Tl(+d),u):o},u.source=function(d){return arguments.length?(t=d,u):t},u.target=function(d){return arguments.length?(n=d,u):n},u.context=function(d){return arguments.length?(c=d??null,u):c},u}function WF(){return L6()}function VF(){return L6(HF)}var GF=Array.prototype,M6=GF.slice;function YF(e,t){return e-t}function JF(e){for(var t=0,n=e.length,r=e[n-1][1]*e[0][0]-e[n-1][0]*e[0][1];++t<n;)r+=e[t-1][1]*e[t][0]-e[t-1][0]*e[t][1];return r}const qo=e=>()=>e;function ZF(e,t){for(var n=-1,r=t.length,s;++n<r;)if(s=XF(e,t[n]))return s;return 0}function XF(e,t){for(var n=t[0],r=t[1],s=-1,i=0,l=e.length,o=l-1;i<l;o=i++){var c=e[i],u=c[0],d=c[1],f=e[o],m=f[0],h=f[1];if(KF(c,f,t))return 0;d>r!=h>r&&n<(m-u)*(r-d)/(h-d)+u&&(s=-s)}return s}function KF(e,t,n){var r;return QF(e,t,n)&&eO(e[r=+(e[0]===t[0])],n[r],t[r])}function QF(e,t,n){return(t[0]-e[0])*(n[1]-e[1])===(n[0]-e[0])*(t[1]-e[1])}function eO(e,t,n){return e<=t&&t<=n||n<=t&&t<=e}function tO(){}var Ka=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function R6(){var e=1,t=1,n=iy,r=c;function s(u){var d=n(u);if(Array.isArray(d))d=d.slice().sort(YF);else{var f=wf(u),m=f[0],h=f[1];d=Eu(m,h,d),d=Aa(Math.floor(m/d)*d,Math.floor(h/d)*d,d)}return d.map(function(x){return i(u,x)})}function i(u,d){var f=[],m=[];return l(u,d,function(h){r(h,u,d),JF(h)>0?f.push([h]):m.push(h)}),m.forEach(function(h){for(var x=0,y=f.length,p;x<y;++x)if(ZF((p=f[x])[0],h)!==-1){p.push(h);return}}),{type:"MultiPolygon",value:d,coordinates:f}}function l(u,d,f){var m=new Array,h=new Array,x,y,p,g,w,v;for(x=y=-1,g=u[0]>=d,Ka[g<<1].forEach(N);++x<e-1;)p=g,g=u[x+1]>=d,Ka[p|g<<1].forEach(N);for(Ka[g<<0].forEach(N);++y<t-1;){for(x=-1,g=u[y*e+e]>=d,w=u[y*e]>=d,Ka[g<<1|w<<2].forEach(N);++x<e-1;)p=g,g=u[y*e+e+x+1]>=d,v=w,w=u[y*e+x+1]>=d,Ka[p|g<<1|w<<2|v<<3].forEach(N);Ka[g|w<<3].forEach(N)}for(x=-1,w=u[y*e]>=d,Ka[w<<2].forEach(N);++x<e-1;)v=w,w=u[y*e+x+1]>=d,Ka[w<<2|v<<3].forEach(N);Ka[w<<3].forEach(N);function N(A){var P=[A[0][0]+x,A[0][1]+y],U=[A[1][0]+x,A[1][1]+y],M=o(P),S=o(U),C,_;(C=h[M])?(_=m[S])?(delete h[C.end],delete m[_.start],C===_?(C.ring.push(U),f(C.ring)):m[C.start]=h[_.end]={start:C.start,end:_.end,ring:C.ring.concat(_.ring)}):(delete h[C.end],C.ring.push(U),h[C.end=S]=C):(C=m[S])?(_=h[M])?(delete m[C.start],delete h[_.end],C===_?(C.ring.push(U),f(C.ring)):m[_.start]=h[C.end]={start:_.start,end:C.end,ring:_.ring.concat(C.ring)}):(delete m[C.start],C.ring.unshift(P),m[C.start=M]=C):m[M]=h[S]={start:M,end:S,ring:[P,U]}}}function o(u){return u[0]*2+u[1]*(e+1)*4}function c(u,d,f){u.forEach(function(m){var h=m[0],x=m[1],y=h|0,p=x|0,g,w=d[p*e+y];h>0&&h<e&&y===h&&(g=d[p*e+y-1],m[0]=h+(f-g)/(w-g)-.5),x>0&&x<t&&p===x&&(g=d[(p-1)*e+y],m[1]=x+(f-g)/(w-g)-.5)})}return s.contour=i,s.size=function(u){if(!arguments.length)return[e,t];var d=Math.floor(u[0]),f=Math.floor(u[1]);if(!(d>=0&&f>=0))throw new Error("invalid size");return e=d,t=f,s},s.thresholds=function(u){return arguments.length?(n=typeof u=="function"?u:Array.isArray(u)?qo(M6.call(u)):qo(u),s):n},s.smooth=function(u){return arguments.length?(r=u?c:tO,s):r===c},s}function a1(e,t,n){for(var r=e.width,s=e.height,i=(n<<1)+1,l=0;l<s;++l)for(var o=0,c=0;o<r+n;++o)o<r&&(c+=e.data[o+l*r]),o>=n&&(o>=i&&(c-=e.data[o-i+l*r]),t.data[o-n+l*r]=c/Math.min(o+1,r-1+i-o,i))}function o1(e,t,n){for(var r=e.width,s=e.height,i=(n<<1)+1,l=0;l<r;++l)for(var o=0,c=0;o<s+n;++o)o<s&&(c+=e.data[l+o*r]),o>=n&&(o>=i&&(c-=e.data[l+(o-i)*r]),t.data[l+(o-n)*r]=c/Math.min(o+1,s-1+i-o,i))}function nO(e){return e[0]}function rO(e){return e[1]}function sO(){return 1}function iO(){var e=nO,t=rO,n=sO,r=960,s=500,i=20,l=2,o=i*3,c=r+o*2>>l,u=s+o*2>>l,d=qo(20);function f(g){var w=new Float32Array(c*u),v=new Float32Array(c*u);g.forEach(function(P,U,M){var S=+e(P,U,M)+o>>l,C=+t(P,U,M)+o>>l,_=+n(P,U,M);S>=0&&S<c&&C>=0&&C<u&&(w[S+C*c]+=_)}),a1({width:c,height:u,data:w},{data:v},i>>l),o1({width:c,height:u,data:v},{data:w},i>>l),a1({width:c,height:u,data:w},{data:v},i>>l),o1({width:c,height:u,data:v},{data:w},i>>l),a1({width:c,height:u,data:w},{data:v},i>>l),o1({width:c,height:u,data:v},{data:w},i>>l);var N=d(w);if(!Array.isArray(N)){var A=mp(w);N=Eu(0,A,N),N=Aa(0,Math.floor(A/N)*N,N),N.shift()}return R6().thresholds(N).size([c,u])(w).map(m)}function m(g){return g.value*=Math.pow(2,-2*l),g.coordinates.forEach(h),g}function h(g){g.forEach(x)}function x(g){g.forEach(y)}function y(g){g[0]=g[0]*Math.pow(2,l)-o,g[1]=g[1]*Math.pow(2,l)-o}function p(){return o=i*3,c=r+o*2>>l,u=s+o*2>>l,f}return f.x=function(g){return arguments.length?(e=typeof g=="function"?g:qo(+g),f):e},f.y=function(g){return arguments.length?(t=typeof g=="function"?g:qo(+g),f):t},f.weight=function(g){return arguments.length?(n=typeof g=="function"?g:qo(+g),f):n},f.size=function(g){if(!arguments.length)return[r,s];var w=+g[0],v=+g[1];if(!(w>=0&&v>=0))throw new Error("invalid size");return r=w,s=v,p()},f.cellSize=function(g){if(!arguments.length)return 1<<l;if(!((g=+g)>=1))throw new Error("invalid cell size");return l=Math.floor(Math.log(g)/Math.LN2),p()},f.thresholds=function(g){return arguments.length?(d=typeof g=="function"?g:Array.isArray(g)?qo(M6.call(g)):qo(g),f):d},f.bandwidth=function(g){if(!arguments.length)return Math.sqrt(i*(i+1));if(!((g=+g)>=0))throw new Error("invalid bandwidth");return i=Math.round((Math.sqrt(4*g*g+1)-1)/2),p()},f}const B5=Math.pow(2,-52),om=new Uint32Array(512);class jp{static from(t,n=uO,r=dO){const s=t.length,i=new Float64Array(s*2);for(let l=0;l<s;l++){const o=t[l];i[2*l]=n(o),i[2*l+1]=r(o)}return new jp(i)}constructor(t){const n=t.length>>1;if(n>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const r=Math.max(2*n-5,0);this._triangles=new Uint32Array(r*3),this._halfedges=new Int32Array(r*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:r,_hullTri:s,_hullHash:i}=this,l=t.length>>1;let o=1/0,c=1/0,u=-1/0,d=-1/0;for(let C=0;C<l;C++){const _=t[2*C],T=t[2*C+1];_<o&&(o=_),T<c&&(c=T),_>u&&(u=_),T>d&&(d=T),this._ids[C]=C}const f=(o+u)/2,m=(c+d)/2;let h=1/0,x,y,p;for(let C=0;C<l;C++){const _=l1(f,m,t[2*C],t[2*C+1]);_<h&&(x=C,h=_)}const g=t[2*x],w=t[2*x+1];h=1/0;for(let C=0;C<l;C++){if(C===x)continue;const _=l1(g,w,t[2*C],t[2*C+1]);_<h&&_>0&&(y=C,h=_)}let v=t[2*y],N=t[2*y+1],A=1/0;for(let C=0;C<l;C++){if(C===x||C===y)continue;const _=lO(g,w,v,N,t[2*C],t[2*C+1]);_<A&&(p=C,A=_)}let P=t[2*p],U=t[2*p+1];if(A===1/0){for(let T=0;T<l;T++)this._dists[T]=t[2*T]-t[0]||t[2*T+1]-t[1];iu(this._ids,this._dists,0,l-1);const C=new Uint32Array(l);let _=0;for(let T=0,B=-1/0;T<l;T++){const $=this._ids[T];this._dists[$]>B&&(C[_++]=$,B=this._dists[$])}this.hull=C.subarray(0,_),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(lm(g,w,v,N,P,U)){const C=y,_=v,T=N;y=p,v=P,N=U,p=C,P=_,U=T}const M=cO(g,w,v,N,P,U);this._cx=M.x,this._cy=M.y;for(let C=0;C<l;C++)this._dists[C]=l1(t[2*C],t[2*C+1],M.x,M.y);iu(this._ids,this._dists,0,l-1),this._hullStart=x;let S=3;r[x]=n[p]=y,r[y]=n[x]=p,r[p]=n[y]=x,s[x]=0,s[y]=1,s[p]=2,i.fill(-1),i[this._hashKey(g,w)]=x,i[this._hashKey(v,N)]=y,i[this._hashKey(P,U)]=p,this.trianglesLen=0,this._addTriangle(x,y,p,-1,-1,-1);for(let C=0,_,T;C<this._ids.length;C++){const B=this._ids[C],$=t[2*B],D=t[2*B+1];if(C>0&&Math.abs($-_)<=B5&&Math.abs(D-T)<=B5||(_=$,T=D,B===x||B===y||B===p))continue;let L=0;for(let V=0,R=this._hashKey($,D);V<this._hashSize&&(L=i[(R+V)%this._hashSize],!(L!==-1&&L!==r[L]));V++);L=n[L];let O=L,W;for(;W=r[O],!lm($,D,t[2*O],t[2*O+1],t[2*W],t[2*W+1]);)if(O=W,O===L){O=-1;break}if(O===-1)continue;let E=this._addTriangle(O,B,r[O],-1,-1,s[O]);s[B]=this._legalize(E+2),s[O]=E,S++;let H=r[O];for(;W=r[H],lm($,D,t[2*H],t[2*H+1],t[2*W],t[2*W+1]);)E=this._addTriangle(H,B,W,s[B],-1,s[H]),s[B]=this._legalize(E+2),r[H]=H,S--,H=W;if(O===L)for(;W=n[O],lm($,D,t[2*W],t[2*W+1],t[2*O],t[2*O+1]);)E=this._addTriangle(W,B,O,-1,s[O],s[W]),this._legalize(E+2),s[W]=E,r[O]=O,S--,O=W;this._hullStart=n[B]=O,r[O]=n[H]=B,r[B]=H,i[this._hashKey($,D)]=B,i[this._hashKey(t[2*O],t[2*O+1])]=O}this.hull=new Uint32Array(S);for(let C=0,_=this._hullStart;C<S;C++)this.hull[C]=_,_=r[_];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(aO(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:r,coords:s}=this;let i=0,l=0;for(;;){const o=r[t],c=t-t%3;if(l=c+(t+2)%3,o===-1){if(i===0)break;t=om[--i];continue}const u=o-o%3,d=c+(t+1)%3,f=u+(o+2)%3,m=n[l],h=n[t],x=n[d],y=n[f];if(oO(s[2*m],s[2*m+1],s[2*h],s[2*h+1],s[2*x],s[2*x+1],s[2*y],s[2*y+1])){n[t]=y,n[o]=m;const g=r[f];if(g===-1){let v=this._hullStart;do{if(this._hullTri[v]===f){this._hullTri[v]=t;break}v=this._hullPrev[v]}while(v!==this._hullStart)}this._link(t,g),this._link(o,r[l]),this._link(l,f);const w=u+(o+1)%3;i<om.length&&(om[i++]=w)}else{if(i===0)break;t=om[--i]}}return l}_link(t,n){this._halfedges[t]=n,n!==-1&&(this._halfedges[n]=t)}_addTriangle(t,n,r,s,i,l){const o=this.trianglesLen;return this._triangles[o]=t,this._triangles[o+1]=n,this._triangles[o+2]=r,this._link(o,s),this._link(o+1,i),this._link(o+2,l),this.trianglesLen+=3,o}}function aO(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function l1(e,t,n,r){const s=e-n,i=t-r;return s*s+i*i}function c1(e,t,n,r,s,i){const l=(r-t)*(s-e),o=(n-e)*(i-t);return Math.abs(l-o)>=33306690738754716e-32*Math.abs(l+o)?l-o:0}function lm(e,t,n,r,s,i){return(c1(s,i,e,t,n,r)||c1(e,t,n,r,s,i)||c1(n,r,s,i,e,t))<0}function oO(e,t,n,r,s,i,l,o){const c=e-l,u=t-o,d=n-l,f=r-o,m=s-l,h=i-o,x=c*c+u*u,y=d*d+f*f,p=m*m+h*h;return c*(f*p-y*h)-u*(d*p-y*m)+x*(d*h-f*m)<0}function lO(e,t,n,r,s,i){const l=n-e,o=r-t,c=s-e,u=i-t,d=l*l+o*o,f=c*c+u*u,m=.5/(l*u-o*c),h=(u*d-o*f)*m,x=(l*f-c*d)*m;return h*h+x*x}function cO(e,t,n,r,s,i){const l=n-e,o=r-t,c=s-e,u=i-t,d=l*l+o*o,f=c*c+u*u,m=.5/(l*u-o*c),h=e+(u*d-o*f)*m,x=t+(l*f-c*d)*m;return{x:h,y:x}}function iu(e,t,n,r){if(r-n<=20)for(let s=n+1;s<=r;s++){const i=e[s],l=t[i];let o=s-1;for(;o>=n&&t[e[o]]>l;)e[o+1]=e[o--];e[o+1]=i}else{const s=n+r>>1;let i=n+1,l=r;Ud(e,s,i),t[e[n]]>t[e[r]]&&Ud(e,n,r),t[e[i]]>t[e[r]]&&Ud(e,i,r),t[e[n]]>t[e[i]]&&Ud(e,n,i);const o=e[i],c=t[o];for(;;){do i++;while(t[e[i]]<c);do l--;while(t[e[l]]>c);if(l<i)break;Ud(e,i,l)}e[n+1]=e[l],e[l]=o,r-i+1>=l-n?(iu(e,t,i,r),iu(e,t,n,l-1)):(iu(e,t,n,l-1),iu(e,t,i,r))}}function Ud(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function uO(e){return e[0]}function dO(e){return e[1]}const z5=1e-6;class ql{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,n){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,n){this._+=`L${this._x1=+t},${this._y1=+n}`}arc(t,n,r){t=+t,n=+n,r=+r;const s=t+r,i=n;if(r<0)throw new Error("negative radius");this._x1===null?this._+=`M${s},${i}`:(Math.abs(this._x1-s)>z5||Math.abs(this._y1-i)>z5)&&(this._+="L"+s+","+i),r&&(this._+=`A${r},${r},0,1,1,${t-r},${n}A${r},${r},0,1,1,${this._x1=s},${this._y1=i}`)}rect(t,n,r,s){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${+r}v${+s}h${-r}Z`}value(){return this._||null}}class Gx{constructor(){this._=[]}moveTo(t,n){this._.push([t,n])}closePath(){this._.push(this._[0].slice())}lineTo(t,n){this._.push([t,n])}value(){return this._.length?this._:null}}class $6{constructor(t,[n,r,s,i]=[0,0,960,500]){if(!((s=+s)>=(n=+n))||!((i=+i)>=(r=+r)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(t.points.length*2),this.vectors=new Float64Array(t.points.length*2),this.xmax=s,this.xmin=n,this.ymax=i,this.ymin=r,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:n,triangles:r},vectors:s}=this,i=this.circumcenters=this._circumcenters.subarray(0,r.length/3*2);for(let h=0,x=0,y=r.length,p,g;h<y;h+=3,x+=2){const w=r[h]*2,v=r[h+1]*2,N=r[h+2]*2,A=t[w],P=t[w+1],U=t[v],M=t[v+1],S=t[N],C=t[N+1],_=U-A,T=M-P,B=S-A,$=C-P,D=_*_+T*T,L=B*B+$*$,O=(_*$-T*B)*2;if(!O)p=(A+S)/2-1e8*$,g=(P+C)/2+1e8*B;else if(Math.abs(O)<1e-8)p=(A+S)/2,g=(P+C)/2;else{const W=1/O;p=A+($*D-T*L)*W,g=P+(_*L-B*D)*W}i[x]=p,i[x+1]=g}let l=n[n.length-1],o,c=l*4,u,d=t[2*l],f,m=t[2*l+1];s.fill(0);for(let h=0;h<n.length;++h)l=n[h],o=c,u=d,f=m,c=l*4,d=t[2*l],m=t[2*l+1],s[o+2]=s[c]=f-m,s[o+3]=s[c+1]=d-u}render(t){const n=t==null?t=new ql:void 0,{delaunay:{halfedges:r,inedges:s,hull:i},circumcenters:l,vectors:o}=this;if(i.length<=1)return null;for(let d=0,f=r.length;d<f;++d){const m=r[d];if(m<d)continue;const h=Math.floor(d/3)*2,x=Math.floor(m/3)*2,y=l[h],p=l[h+1],g=l[x],w=l[x+1];this._renderSegment(y,p,g,w,t)}let c,u=i[i.length-1];for(let d=0;d<i.length;++d){c=u,u=i[d];const f=Math.floor(s[u]/3)*2,m=l[f],h=l[f+1],x=c*4,y=this._project(m,h,o[x+2],o[x+3]);y&&this._renderSegment(m,h,y[0],y[1],t)}return n&&n.value()}renderBounds(t){const n=t==null?t=new ql:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(t,n){const r=n==null?n=new ql:void 0,s=this._clip(t);if(s===null||!s.length)return;n.moveTo(s[0],s[1]);let i=s.length;for(;s[0]===s[i-2]&&s[1]===s[i-1]&&i>1;)i-=2;for(let l=2;l<i;l+=2)(s[l]!==s[l-2]||s[l+1]!==s[l-1])&&n.lineTo(s[l],s[l+1]);return n.closePath(),r&&r.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let n=0,r=t.length/2;n<r;++n){const s=this.cellPolygon(n);s&&(s.index=n,yield s)}}cellPolygon(t){const n=new Gx;return this.renderCell(t,n),n.value()}_renderSegment(t,n,r,s,i){let l;const o=this._regioncode(t,n),c=this._regioncode(r,s);o===0&&c===0?(i.moveTo(t,n),i.lineTo(r,s)):(l=this._clipSegment(t,n,r,s,o,c))&&(i.moveTo(l[0],l[1]),i.lineTo(l[2],l[3]))}contains(t,n,r){return n=+n,n!==n||(r=+r,r!==r)?!1:this.delaunay._step(t,n,r)===t}*neighbors(t){const n=this._clip(t);if(n)for(const r of this.delaunay.neighbors(t)){const s=this._clip(r);if(s){e:for(let i=0,l=n.length;i<l;i+=2)for(let o=0,c=s.length;o<c;o+=2)if(n[i]==s[o]&&n[i+1]==s[o+1]&&n[(i+2)%l]==s[(o+c-2)%c]&&n[(i+3)%l]==s[(o+c-1)%c]){yield r;break e}}}}_cell(t){const{circumcenters:n,delaunay:{inedges:r,halfedges:s,triangles:i}}=this,l=r[t];if(l===-1)return null;const o=[];let c=l;do{const u=Math.floor(c/3);if(o.push(n[u*2],n[u*2+1]),c=c%3===2?c-2:c+1,i[c]!==t)break;c=s[c]}while(c!==l&&c!==-1);return o}_clip(t){if(t===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(t);if(n===null)return null;const{vectors:r}=this,s=t*4;return r[s]||r[s+1]?this._clipInfinite(t,n,r[s],r[s+1],r[s+2],r[s+3]):this._clipFinite(t,n)}_clipFinite(t,n){const r=n.length;let s=null,i,l,o=n[r-2],c=n[r-1],u,d=this._regioncode(o,c),f,m;for(let h=0;h<r;h+=2)if(i=o,l=c,o=n[h],c=n[h+1],u=d,d=this._regioncode(o,c),u===0&&d===0)f=m,m=0,s?s.push(o,c):s=[o,c];else{let x,y,p,g,w;if(u===0){if((x=this._clipSegment(i,l,o,c,u,d))===null)continue;[y,p,g,w]=x}else{if((x=this._clipSegment(o,c,i,l,d,u))===null)continue;[g,w,y,p]=x,f=m,m=this._edgecode(y,p),f&&m&&this._edge(t,f,m,s,s.length),s?s.push(y,p):s=[y,p]}f=m,m=this._edgecode(g,w),f&&m&&this._edge(t,f,m,s,s.length),s?s.push(g,w):s=[g,w]}if(s)f=m,m=this._edgecode(s[0],s[1]),f&&m&&this._edge(t,f,m,s,s.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return s}_clipSegment(t,n,r,s,i,l){for(;;){if(i===0&&l===0)return[t,n,r,s];if(i&l)return null;let o,c,u=i||l;u&8?(o=t+(r-t)*(this.ymax-n)/(s-n),c=this.ymax):u&4?(o=t+(r-t)*(this.ymin-n)/(s-n),c=this.ymin):u&2?(c=n+(s-n)*(this.xmax-t)/(r-t),o=this.xmax):(c=n+(s-n)*(this.xmin-t)/(r-t),o=this.xmin),i?(t=o,n=c,i=this._regioncode(t,n)):(r=o,s=c,l=this._regioncode(r,s))}}_clipInfinite(t,n,r,s,i,l){let o=Array.from(n),c;if((c=this._project(o[0],o[1],r,s))&&o.unshift(c[0],c[1]),(c=this._project(o[o.length-2],o[o.length-1],i,l))&&o.push(c[0],c[1]),o=this._clipFinite(t,o))for(let u=0,d=o.length,f,m=this._edgecode(o[d-2],o[d-1]);u<d;u+=2)f=m,m=this._edgecode(o[u],o[u+1]),f&&m&&(u=this._edge(t,f,m,o,u),d=o.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(o=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return o}_edge(t,n,r,s,i){for(;n!==r;){let l,o;switch(n){case 5:n=4;continue;case 4:n=6,l=this.xmax,o=this.ymin;break;case 6:n=2;continue;case 2:n=10,l=this.xmax,o=this.ymax;break;case 10:n=8;continue;case 8:n=9,l=this.xmin,o=this.ymax;break;case 9:n=1;continue;case 1:n=5,l=this.xmin,o=this.ymin;break}(s[i]!==l||s[i+1]!==o)&&this.contains(t,l,o)&&(s.splice(i,0,l,o),i+=2)}if(s.length>4)for(let l=0;l<s.length;l+=2){const o=(l+2)%s.length,c=(l+4)%s.length;(s[l]===s[o]&&s[o]===s[c]||s[l+1]===s[o+1]&&s[o+1]===s[c+1])&&(s.splice(o,2),l-=2)}return i}_project(t,n,r,s){let i=1/0,l,o,c;if(s<0){if(n<=this.ymin)return null;(l=(this.ymin-n)/s)<i&&(c=this.ymin,o=t+(i=l)*r)}else if(s>0){if(n>=this.ymax)return null;(l=(this.ymax-n)/s)<i&&(c=this.ymax,o=t+(i=l)*r)}if(r>0){if(t>=this.xmax)return null;(l=(this.xmax-t)/r)<i&&(o=this.xmax,c=n+(i=l)*s)}else if(r<0){if(t<=this.xmin)return null;(l=(this.xmin-t)/r)<i&&(o=this.xmin,c=n+(i=l)*s)}return[o,c]}_edgecode(t,n){return(t===this.xmin?1:t===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(t,n){return(t<this.xmin?1:t>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}}const fO=2*Math.PI,qc=Math.pow;function hO(e){return e[0]}function mO(e){return e[1]}function pO(e){const{triangles:t,coords:n}=e;for(let r=0;r<t.length;r+=3){const s=2*t[r],i=2*t[r+1],l=2*t[r+2];if((n[l]-n[s])*(n[i+1]-n[s+1])-(n[i]-n[s])*(n[l+1]-n[s+1])>1e-10)return!1}return!0}function gO(e,t,n){return[e+Math.sin(e+t)*n,t+Math.cos(e-t)*n]}class ky{static from(t,n=hO,r=mO,s){return new ky("length"in t?xO(t,n,r,s):Float64Array.from(yO(t,n,r,s)))}constructor(t){this._delaunator=new jp(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&pO(t)){this.collinear=Int32Array.from({length:n.length/2},(m,h)=>h).sort((m,h)=>n[2*m]-n[2*h]||n[2*m+1]-n[2*h+1]);const c=this.collinear[0],u=this.collinear[this.collinear.length-1],d=[n[2*c],n[2*c+1],n[2*u],n[2*u+1]],f=1e-8*Math.hypot(d[3]-d[1],d[2]-d[0]);for(let m=0,h=n.length/2;m<h;++m){const x=gO(n[2*m],n[2*m+1],f);n[2*m]=x[0],n[2*m+1]=x[1]}this._delaunator=new jp(n)}else delete this.collinear;const r=this.halfedges=this._delaunator.halfedges,s=this.hull=this._delaunator.hull,i=this.triangles=this._delaunator.triangles,l=this.inedges.fill(-1),o=this._hullIndex.fill(-1);for(let c=0,u=r.length;c<u;++c){const d=i[c%3===2?c-2:c+1];(r[c]===-1||l[d]===-1)&&(l[d]=c)}for(let c=0,u=s.length;c<u;++c)o[s[c]]=c;s.length<=2&&s.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=s[0],this.triangles[1]=s[1],this.triangles[2]=s[1],l[s[0]]=1,s.length===2&&(l[s[1]]=0))}voronoi(t){return new $6(this,t)}*neighbors(t){const{inedges:n,hull:r,_hullIndex:s,halfedges:i,triangles:l,collinear:o}=this;if(o){const f=o.indexOf(t);f>0&&(yield o[f-1]),f<o.length-1&&(yield o[f+1]);return}const c=n[t];if(c===-1)return;let u=c,d=-1;do{if(yield d=l[u],u=u%3===2?u-2:u+1,l[u]!==t)return;if(u=i[u],u===-1){const f=r[(s[t]+1)%r.length];f!==d&&(yield f);return}}while(u!==c)}find(t,n,r=0){if(t=+t,t!==t||(n=+n,n!==n))return-1;const s=r;let i;for(;(i=this._step(r,t,n))>=0&&i!==r&&i!==s;)r=i;return i}_step(t,n,r){const{inedges:s,hull:i,_hullIndex:l,halfedges:o,triangles:c,points:u}=this;if(s[t]===-1||!u.length)return(t+1)%(u.length>>1);let d=t,f=qc(n-u[t*2],2)+qc(r-u[t*2+1],2);const m=s[t];let h=m;do{let x=c[h];const y=qc(n-u[x*2],2)+qc(r-u[x*2+1],2);if(y<f&&(f=y,d=x),h=h%3===2?h-2:h+1,c[h]!==t)break;if(h=o[h],h===-1){if(h=i[(l[t]+1)%i.length],h!==x&&qc(n-u[h*2],2)+qc(r-u[h*2+1],2)<f)return h;break}}while(h!==m);return d}render(t){const n=t==null?t=new ql:void 0,{points:r,halfedges:s,triangles:i}=this;for(let l=0,o=s.length;l<o;++l){const c=s[l];if(c<l)continue;const u=i[l]*2,d=i[c]*2;t.moveTo(r[u],r[u+1]),t.lineTo(r[d],r[d+1])}return this.renderHull(t),n&&n.value()}renderPoints(t,n=2){const r=t==null?t=new ql:void 0,{points:s}=this;for(let i=0,l=s.length;i<l;i+=2){const o=s[i],c=s[i+1];t.moveTo(o+n,c),t.arc(o,c,n,0,fO)}return r&&r.value()}renderHull(t){const n=t==null?t=new ql:void 0,{hull:r,points:s}=this,i=r[0]*2,l=r.length;t.moveTo(s[i],s[i+1]);for(let o=1;o<l;++o){const c=2*r[o];t.lineTo(s[c],s[c+1])}return t.closePath(),n&&n.value()}hullPolygon(){const t=new Gx;return this.renderHull(t),t.value()}renderTriangle(t,n){const r=n==null?n=new ql:void 0,{points:s,triangles:i}=this,l=i[t*=3]*2,o=i[t+1]*2,c=i[t+2]*2;return n.moveTo(s[l],s[l+1]),n.lineTo(s[o],s[o+1]),n.lineTo(s[c],s[c+1]),n.closePath(),r&&r.value()}*trianglePolygons(){const{triangles:t}=this;for(let n=0,r=t.length/3;n<r;++n)yield this.trianglePolygon(n)}trianglePolygon(t){const n=new Gx;return this.renderTriangle(t,n),n.value()}}function xO(e,t,n,r){const s=e.length,i=new Float64Array(s*2);for(let l=0;l<s;++l){const o=e[l];i[l*2]=t.call(r,o,l,e),i[l*2+1]=n.call(r,o,l,e)}return i}function*yO(e,t,n,r){let s=0;for(const i of e)yield t.call(r,i,s,e),yield n.call(r,i,s,e),++s}var U5={},u1={},d1=34,qd=10,f1=13;function F6(e){return new Function("d","return {"+e.map(function(t,n){return JSON.stringify(t)+": d["+n+'] || ""'}).join(",")+"}")}function bO(e,t){var n=F6(e);return function(r,s){return t(n(r),s,e)}}function q5(e){var t=Object.create(null),n=[];return e.forEach(function(r){for(var s in r)s in t||n.push(t[s]=s)}),n}function Qs(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function vO(e){return e<0?"-"+Qs(-e,6):e>9999?"+"+Qs(e,6):Qs(e,4)}function wO(e){var t=e.getUTCHours(),n=e.getUTCMinutes(),r=e.getUTCSeconds(),s=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":vO(e.getUTCFullYear())+"-"+Qs(e.getUTCMonth()+1,2)+"-"+Qs(e.getUTCDate(),2)+(s?"T"+Qs(t,2)+":"+Qs(n,2)+":"+Qs(r,2)+"."+Qs(s,3)+"Z":r?"T"+Qs(t,2)+":"+Qs(n,2)+":"+Qs(r,2)+"Z":n||t?"T"+Qs(t,2)+":"+Qs(n,2)+"Z":"")}function $0(e){var t=new RegExp('["'+e+`
\r]`),n=e.charCodeAt(0);function r(f,m){var h,x,y=s(f,function(p,g){if(h)return h(p,g-1);x=p,h=m?bO(p,m):F6(p)});return y.columns=x||[],y}function s(f,m){var h=[],x=f.length,y=0,p=0,g,w=x<=0,v=!1;f.charCodeAt(x-1)===qd&&--x,f.charCodeAt(x-1)===f1&&--x;function N(){if(w)return u1;if(v)return v=!1,U5;var P,U=y,M;if(f.charCodeAt(U)===d1){for(;y++<x&&f.charCodeAt(y)!==d1||f.charCodeAt(++y)===d1;);return(P=y)>=x?w=!0:(M=f.charCodeAt(y++))===qd?v=!0:M===f1&&(v=!0,f.charCodeAt(y)===qd&&++y),f.slice(U+1,P-1).replace(/""/g,'"')}for(;y<x;){if((M=f.charCodeAt(P=y++))===qd)v=!0;else if(M===f1)v=!0,f.charCodeAt(y)===qd&&++y;else if(M!==n)continue;return f.slice(U,P)}return w=!0,f.slice(U,x)}for(;(g=N())!==u1;){for(var A=[];g!==U5&&g!==u1;)A.push(g),g=N();m&&(A=m(A,p++))==null||h.push(A)}return h}function i(f,m){return f.map(function(h){return m.map(function(x){return d(h[x])}).join(e)})}function l(f,m){return m==null&&(m=q5(f)),[m.map(d).join(e)].concat(i(f,m)).join(`
`)}function o(f,m){return m==null&&(m=q5(f)),i(f,m).join(`
`)}function c(f){return f.map(u).join(`
`)}function u(f){return f.map(d).join(e)}function d(f){return f==null?"":f instanceof Date?wO(f):t.test(f+="")?'"'+f.replace(/"/g,'""')+'"':f}return{parse:r,parseRows:s,format:l,formatBody:o,formatRows:c,formatRow:u,formatValue:d}}var fc=$0(","),O6=fc.parse,NO=fc.parseRows,jO=fc.format,SO=fc.formatBody,_O=fc.formatRows,AO=fc.formatRow,kO=fc.formatValue,hc=$0("	"),D6=hc.parse,EO=hc.parseRows,CO=hc.format,PO=hc.formatBody,IO=hc.formatRows,TO=hc.formatRow,LO=hc.formatValue;function MO(e){for(var t in e){var n=e[t].trim(),r,s;if(!n)n=null;else if(n==="true")n=!0;else if(n==="false")n=!1;else if(n==="NaN")n=NaN;else if(!isNaN(r=+n))n=r;else if(s=n.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/))RO&&s[4]&&!s[7]&&(n=n.replace(/-/g,"/").replace(/T/," ")),n=new Date(n);else continue;e[t]=n}return e}const RO=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();function $O(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.blob()}function FO(e,t){return fetch(e,t).then($O)}function OO(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.arrayBuffer()}function DO(e,t){return fetch(e,t).then(OO)}function BO(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);return e.text()}function F0(e,t){return fetch(e,t).then(BO)}function B6(e){return function(t,n,r){return arguments.length===2&&typeof n=="function"&&(r=n,n=void 0),F0(t,n).then(function(s){return e(s,r)})}}function zO(e,t,n,r){arguments.length===3&&typeof n=="function"&&(r=n,n=void 0);var s=$0(e);return F0(t,n).then(function(i){return s.parse(i,r)})}var UO=B6(O6),qO=B6(D6);function HO(e,t){return new Promise(function(n,r){var s=new Image;for(var i in t)s[i]=t[i];s.onerror=r,s.onload=function(){n(s)},s.src=e})}function WO(e){if(!e.ok)throw new Error(e.status+" "+e.statusText);if(!(e.status===204||e.status===205))return e.json()}function VO(e,t){return fetch(e,t).then(WO)}function Ey(e){return(t,n)=>F0(t,n).then(r=>new DOMParser().parseFromString(r,e))}const GO=Ey("application/xml");var YO=Ey("text/html"),JO=Ey("image/svg+xml");function ZO(e,t){var n,r=1;e==null&&(e=0),t==null&&(t=0);function s(){var i,l=n.length,o,c=0,u=0;for(i=0;i<l;++i)o=n[i],c+=o.x,u+=o.y;for(c=(c/l-e)*r,u=(u/l-t)*r,i=0;i<l;++i)o=n[i],o.x-=c,o.y-=u}return s.initialize=function(i){n=i},s.x=function(i){return arguments.length?(e=+i,s):e},s.y=function(i){return arguments.length?(t=+i,s):t},s.strength=function(i){return arguments.length?(r=+i,s):r},s}function XO(e){const t=+this._x.call(null,e),n=+this._y.call(null,e);return z6(this.cover(t,n),t,n,e)}function z6(e,t,n,r){if(isNaN(t)||isNaN(n))return e;var s,i=e._root,l={data:r},o=e._x0,c=e._y0,u=e._x1,d=e._y1,f,m,h,x,y,p,g,w;if(!i)return e._root=l,e;for(;i.length;)if((y=t>=(f=(o+u)/2))?o=f:u=f,(p=n>=(m=(c+d)/2))?c=m:d=m,s=i,!(i=i[g=p<<1|y]))return s[g]=l,e;if(h=+e._x.call(null,i.data),x=+e._y.call(null,i.data),t===h&&n===x)return l.next=i,s?s[g]=l:e._root=l,e;do s=s?s[g]=new Array(4):e._root=new Array(4),(y=t>=(f=(o+u)/2))?o=f:u=f,(p=n>=(m=(c+d)/2))?c=m:d=m;while((g=p<<1|y)===(w=(x>=m)<<1|h>=f));return s[w]=i,s[g]=l,e}function KO(e){var t,n,r=e.length,s,i,l=new Array(r),o=new Array(r),c=1/0,u=1/0,d=-1/0,f=-1/0;for(n=0;n<r;++n)isNaN(s=+this._x.call(null,t=e[n]))||isNaN(i=+this._y.call(null,t))||(l[n]=s,o[n]=i,s<c&&(c=s),s>d&&(d=s),i<u&&(u=i),i>f&&(f=i));if(c>d||u>f)return this;for(this.cover(c,u).cover(d,f),n=0;n<r;++n)z6(this,l[n],o[n],e[n]);return this}function QO(e,t){if(isNaN(e=+e)||isNaN(t=+t))return this;var n=this._x0,r=this._y0,s=this._x1,i=this._y1;if(isNaN(n))s=(n=Math.floor(e))+1,i=(r=Math.floor(t))+1;else{for(var l=s-n||1,o=this._root,c,u;n>e||e>=s||r>t||t>=i;)switch(u=(t<r)<<1|e<n,c=new Array(4),c[u]=o,o=c,l*=2,u){case 0:s=n+l,i=r+l;break;case 1:n=s-l,i=r+l;break;case 2:s=n+l,r=i-l;break;case 3:n=s-l,r=i-l;break}this._root&&this._root.length&&(this._root=o)}return this._x0=n,this._y0=r,this._x1=s,this._y1=i,this}function eD(){var e=[];return this.visit(function(t){if(!t.length)do e.push(t.data);while(t=t.next)}),e}function tD(e){return arguments.length?this.cover(+e[0][0],+e[0][1]).cover(+e[1][0],+e[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function Hs(e,t,n,r,s){this.node=e,this.x0=t,this.y0=n,this.x1=r,this.y1=s}function nD(e,t,n){var r,s=this._x0,i=this._y0,l,o,c,u,d=this._x1,f=this._y1,m=[],h=this._root,x,y;for(h&&m.push(new Hs(h,s,i,d,f)),n==null?n=1/0:(s=e-n,i=t-n,d=e+n,f=t+n,n*=n);x=m.pop();)if(!(!(h=x.node)||(l=x.x0)>d||(o=x.y0)>f||(c=x.x1)<s||(u=x.y1)<i))if(h.length){var p=(l+c)/2,g=(o+u)/2;m.push(new Hs(h[3],p,g,c,u),new Hs(h[2],l,g,p,u),new Hs(h[1],p,o,c,g),new Hs(h[0],l,o,p,g)),(y=(t>=g)<<1|e>=p)&&(x=m[m.length-1],m[m.length-1]=m[m.length-1-y],m[m.length-1-y]=x)}else{var w=e-+this._x.call(null,h.data),v=t-+this._y.call(null,h.data),N=w*w+v*v;if(N<n){var A=Math.sqrt(n=N);s=e-A,i=t-A,d=e+A,f=t+A,r=h.data}}return r}function rD(e){if(isNaN(d=+this._x.call(null,e))||isNaN(f=+this._y.call(null,e)))return this;var t,n=this._root,r,s,i,l=this._x0,o=this._y0,c=this._x1,u=this._y1,d,f,m,h,x,y,p,g;if(!n)return this;if(n.length)for(;;){if((x=d>=(m=(l+c)/2))?l=m:c=m,(y=f>=(h=(o+u)/2))?o=h:u=h,t=n,!(n=n[p=y<<1|x]))return this;if(!n.length)break;(t[p+1&3]||t[p+2&3]||t[p+3&3])&&(r=t,g=p)}for(;n.data!==e;)if(s=n,!(n=n.next))return this;return(i=n.next)&&delete n.next,s?(i?s.next=i:delete s.next,this):t?(i?t[p]=i:delete t[p],(n=t[0]||t[1]||t[2]||t[3])&&n===(t[3]||t[2]||t[1]||t[0])&&!n.length&&(r?r[g]=n:this._root=n),this):(this._root=i,this)}function sD(e){for(var t=0,n=e.length;t<n;++t)this.remove(e[t]);return this}function iD(){return this._root}function aD(){var e=0;return this.visit(function(t){if(!t.length)do++e;while(t=t.next)}),e}function oD(e){var t=[],n,r=this._root,s,i,l,o,c;for(r&&t.push(new Hs(r,this._x0,this._y0,this._x1,this._y1));n=t.pop();)if(!e(r=n.node,i=n.x0,l=n.y0,o=n.x1,c=n.y1)&&r.length){var u=(i+o)/2,d=(l+c)/2;(s=r[3])&&t.push(new Hs(s,u,d,o,c)),(s=r[2])&&t.push(new Hs(s,i,d,u,c)),(s=r[1])&&t.push(new Hs(s,u,l,o,d)),(s=r[0])&&t.push(new Hs(s,i,l,u,d))}return this}function lD(e){var t=[],n=[],r;for(this._root&&t.push(new Hs(this._root,this._x0,this._y0,this._x1,this._y1));r=t.pop();){var s=r.node;if(s.length){var i,l=r.x0,o=r.y0,c=r.x1,u=r.y1,d=(l+c)/2,f=(o+u)/2;(i=s[0])&&t.push(new Hs(i,l,o,d,f)),(i=s[1])&&t.push(new Hs(i,d,o,c,f)),(i=s[2])&&t.push(new Hs(i,l,f,d,u)),(i=s[3])&&t.push(new Hs(i,d,f,c,u))}n.push(r)}for(;r=n.pop();)e(r.node,r.x0,r.y0,r.x1,r.y1);return this}function cD(e){return e[0]}function uD(e){return arguments.length?(this._x=e,this):this._x}function dD(e){return e[1]}function fD(e){return arguments.length?(this._y=e,this):this._y}function O0(e,t,n){var r=new Cy(t??cD,n??dD,NaN,NaN,NaN,NaN);return e==null?r:r.addAll(e)}function Cy(e,t,n,r,s,i){this._x=e,this._y=t,this._x0=n,this._y0=r,this._x1=s,this._y1=i,this._root=void 0}function H5(e){for(var t={data:e.data},n=t;e=e.next;)n=n.next={data:e.data};return t}var Js=O0.prototype=Cy.prototype;Js.copy=function(){var e=new Cy(this._x,this._y,this._x0,this._y0,this._x1,this._y1),t=this._root,n,r;if(!t)return e;if(!t.length)return e._root=H5(t),e;for(n=[{source:t,target:e._root=new Array(4)}];t=n.pop();)for(var s=0;s<4;++s)(r=t.source[s])&&(r.length?n.push({source:r,target:t.target[s]=new Array(4)}):t.target[s]=H5(r));return e};Js.add=XO;Js.addAll=KO;Js.cover=QO;Js.data=eD;Js.extent=tD;Js.find=nD;Js.remove=rD;Js.removeAll=sD;Js.root=iD;Js.size=aD;Js.visit=oD;Js.visitAfter=lD;Js.x=uD;Js.y=fD;function ts(e){return function(){return e}}function Yo(e){return(e()-.5)*1e-6}function hD(e){return e.x+e.vx}function mD(e){return e.y+e.vy}function pD(e){var t,n,r,s=1,i=1;typeof e!="function"&&(e=ts(e==null?1:+e));function l(){for(var u,d=t.length,f,m,h,x,y,p,g=0;g<i;++g)for(f=O0(t,hD,mD).visitAfter(o),u=0;u<d;++u)m=t[u],y=n[m.index],p=y*y,h=m.x+m.vx,x=m.y+m.vy,f.visit(w);function w(v,N,A,P,U){var M=v.data,S=v.r,C=y+S;if(M){if(M.index>m.index){var _=h-M.x-M.vx,T=x-M.y-M.vy,B=_*_+T*T;B<C*C&&(_===0&&(_=Yo(r),B+=_*_),T===0&&(T=Yo(r),B+=T*T),B=(C-(B=Math.sqrt(B)))/B*s,m.vx+=(_*=B)*(C=(S*=S)/(p+S)),m.vy+=(T*=B)*C,M.vx-=_*(C=1-C),M.vy-=T*C)}return}return N>h+C||P<h-C||A>x+C||U<x-C}}function o(u){if(u.data)return u.r=n[u.data.index];for(var d=u.r=0;d<4;++d)u[d]&&u[d].r>u.r&&(u.r=u[d].r)}function c(){if(t){var u,d=t.length,f;for(n=new Array(d),u=0;u<d;++u)f=t[u],n[f.index]=+e(f,u,t)}}return l.initialize=function(u,d){t=u,r=d,c()},l.iterations=function(u){return arguments.length?(i=+u,l):i},l.strength=function(u){return arguments.length?(s=+u,l):s},l.radius=function(u){return arguments.length?(e=typeof u=="function"?u:ts(+u),c(),l):e},l}function gD(e){return e.index}function W5(e,t){var n=e.get(t);if(!n)throw new Error("node not found: "+t);return n}function xD(e){var t=gD,n=f,r,s=ts(30),i,l,o,c,u,d=1;e==null&&(e=[]);function f(p){return 1/Math.min(o[p.source.index],o[p.target.index])}function m(p){for(var g=0,w=e.length;g<d;++g)for(var v=0,N,A,P,U,M,S,C;v<w;++v)N=e[v],A=N.source,P=N.target,U=P.x+P.vx-A.x-A.vx||Yo(u),M=P.y+P.vy-A.y-A.vy||Yo(u),S=Math.sqrt(U*U+M*M),S=(S-i[v])/S*p*r[v],U*=S,M*=S,P.vx-=U*(C=c[v]),P.vy-=M*C,A.vx+=U*(C=1-C),A.vy+=M*C}function h(){if(l){var p,g=l.length,w=e.length,v=new Map(l.map((A,P)=>[t(A,P,l),A])),N;for(p=0,o=new Array(g);p<w;++p)N=e[p],N.index=p,typeof N.source!="object"&&(N.source=W5(v,N.source)),typeof N.target!="object"&&(N.target=W5(v,N.target)),o[N.source.index]=(o[N.source.index]||0)+1,o[N.target.index]=(o[N.target.index]||0)+1;for(p=0,c=new Array(w);p<w;++p)N=e[p],c[p]=o[N.source.index]/(o[N.source.index]+o[N.target.index]);r=new Array(w),x(),i=new Array(w),y()}}function x(){if(l)for(var p=0,g=e.length;p<g;++p)r[p]=+n(e[p],p,e)}function y(){if(l)for(var p=0,g=e.length;p<g;++p)i[p]=+s(e[p],p,e)}return m.initialize=function(p,g){l=p,u=g,h()},m.links=function(p){return arguments.length?(e=p,h(),m):e},m.id=function(p){return arguments.length?(t=p,m):t},m.iterations=function(p){return arguments.length?(d=+p,m):d},m.strength=function(p){return arguments.length?(n=typeof p=="function"?p:ts(+p),x(),m):n},m.distance=function(p){return arguments.length?(s=typeof p=="function"?p:ts(+p),y(),m):s},m}const yD=1664525,bD=1013904223,V5=4294967296;function vD(){let e=1;return()=>(e=(yD*e+bD)%V5)/V5}function wD(e){return e.x}function ND(e){return e.y}var jD=10,SD=Math.PI*(3-Math.sqrt(5));function _D(e){var t,n=1,r=.001,s=1-Math.pow(r,1/300),i=0,l=.6,o=new Map,c=M0(f),u=uc("tick","end"),d=vD();e==null&&(e=[]);function f(){m(),u.call("tick",t),n<r&&(c.stop(),u.call("end",t))}function m(y){var p,g=e.length,w;y===void 0&&(y=1);for(var v=0;v<y;++v)for(n+=(i-n)*s,o.forEach(function(N){N(n)}),p=0;p<g;++p)w=e[p],w.fx==null?w.x+=w.vx*=l:(w.x=w.fx,w.vx=0),w.fy==null?w.y+=w.vy*=l:(w.y=w.fy,w.vy=0);return t}function h(){for(var y=0,p=e.length,g;y<p;++y){if(g=e[y],g.index=y,g.fx!=null&&(g.x=g.fx),g.fy!=null&&(g.y=g.fy),isNaN(g.x)||isNaN(g.y)){var w=jD*Math.sqrt(.5+y),v=y*SD;g.x=w*Math.cos(v),g.y=w*Math.sin(v)}(isNaN(g.vx)||isNaN(g.vy))&&(g.vx=g.vy=0)}}function x(y){return y.initialize&&y.initialize(e,d),y}return h(),t={tick:m,restart:function(){return c.restart(f),t},stop:function(){return c.stop(),t},nodes:function(y){return arguments.length?(e=y,h(),o.forEach(x),t):e},alpha:function(y){return arguments.length?(n=+y,t):n},alphaMin:function(y){return arguments.length?(r=+y,t):r},alphaDecay:function(y){return arguments.length?(s=+y,t):+s},alphaTarget:function(y){return arguments.length?(i=+y,t):i},velocityDecay:function(y){return arguments.length?(l=1-y,t):1-l},randomSource:function(y){return arguments.length?(d=y,o.forEach(x),t):d},force:function(y,p){return arguments.length>1?(p==null?o.delete(y):o.set(y,x(p)),t):o.get(y)},find:function(y,p,g){var w=0,v=e.length,N,A,P,U,M;for(g==null?g=1/0:g*=g,w=0;w<v;++w)U=e[w],N=y-U.x,A=p-U.y,P=N*N+A*A,P<g&&(M=U,g=P);return M},on:function(y,p){return arguments.length>1?(u.on(y,p),t):u.on(y)}}}function AD(){var e,t,n,r,s=ts(-30),i,l=1,o=1/0,c=.81;function u(h){var x,y=e.length,p=O0(e,wD,ND).visitAfter(f);for(r=h,x=0;x<y;++x)t=e[x],p.visit(m)}function d(){if(e){var h,x=e.length,y;for(i=new Array(x),h=0;h<x;++h)y=e[h],i[y.index]=+s(y,h,e)}}function f(h){var x=0,y,p,g=0,w,v,N;if(h.length){for(w=v=N=0;N<4;++N)(y=h[N])&&(p=Math.abs(y.value))&&(x+=y.value,g+=p,w+=p*y.x,v+=p*y.y);h.x=w/g,h.y=v/g}else{y=h,y.x=y.data.x,y.y=y.data.y;do x+=i[y.data.index];while(y=y.next)}h.value=x}function m(h,x,y,p){if(!h.value)return!0;var g=h.x-t.x,w=h.y-t.y,v=p-x,N=g*g+w*w;if(v*v/c<N)return N<o&&(g===0&&(g=Yo(n),N+=g*g),w===0&&(w=Yo(n),N+=w*w),N<l&&(N=Math.sqrt(l*N)),t.vx+=g*h.value*r/N,t.vy+=w*h.value*r/N),!0;if(h.length||N>=o)return;(h.data!==t||h.next)&&(g===0&&(g=Yo(n),N+=g*g),w===0&&(w=Yo(n),N+=w*w),N<l&&(N=Math.sqrt(l*N)));do h.data!==t&&(v=i[h.data.index]*r/N,t.vx+=g*v,t.vy+=w*v);while(h=h.next)}return u.initialize=function(h,x){e=h,n=x,d()},u.strength=function(h){return arguments.length?(s=typeof h=="function"?h:ts(+h),d(),u):s},u.distanceMin=function(h){return arguments.length?(l=h*h,u):Math.sqrt(l)},u.distanceMax=function(h){return arguments.length?(o=h*h,u):Math.sqrt(o)},u.theta=function(h){return arguments.length?(c=h*h,u):Math.sqrt(c)},u}function kD(e,t,n){var r,s=ts(.1),i,l;typeof e!="function"&&(e=ts(+e)),t==null&&(t=0),n==null&&(n=0);function o(u){for(var d=0,f=r.length;d<f;++d){var m=r[d],h=m.x-t||1e-6,x=m.y-n||1e-6,y=Math.sqrt(h*h+x*x),p=(l[d]-y)*i[d]*u/y;m.vx+=h*p,m.vy+=x*p}}function c(){if(r){var u,d=r.length;for(i=new Array(d),l=new Array(d),u=0;u<d;++u)l[u]=+e(r[u],u,r),i[u]=isNaN(l[u])?0:+s(r[u],u,r)}}return o.initialize=function(u){r=u,c()},o.strength=function(u){return arguments.length?(s=typeof u=="function"?u:ts(+u),c(),o):s},o.radius=function(u){return arguments.length?(e=typeof u=="function"?u:ts(+u),c(),o):e},o.x=function(u){return arguments.length?(t=+u,o):t},o.y=function(u){return arguments.length?(n=+u,o):n},o}function ED(e){var t=ts(.1),n,r,s;typeof e!="function"&&(e=ts(e==null?0:+e));function i(o){for(var c=0,u=n.length,d;c<u;++c)d=n[c],d.vx+=(s[c]-d.x)*r[c]*o}function l(){if(n){var o,c=n.length;for(r=new Array(c),s=new Array(c),o=0;o<c;++o)r[o]=isNaN(s[o]=+e(n[o],o,n))?0:+t(n[o],o,n)}}return i.initialize=function(o){n=o,l()},i.strength=function(o){return arguments.length?(t=typeof o=="function"?o:ts(+o),l(),i):t},i.x=function(o){return arguments.length?(e=typeof o=="function"?o:ts(+o),l(),i):e},i}function CD(e){var t=ts(.1),n,r,s;typeof e!="function"&&(e=ts(e==null?0:+e));function i(o){for(var c=0,u=n.length,d;c<u;++c)d=n[c],d.vy+=(s[c]-d.y)*r[c]*o}function l(){if(n){var o,c=n.length;for(r=new Array(c),s=new Array(c),o=0;o<c;++o)r[o]=isNaN(s[o]=+e(n[o],o,n))?0:+t(n[o],o,n)}}return i.initialize=function(o){n=o,l()},i.strength=function(o){return arguments.length?(t=typeof o=="function"?o:ts(+o),l(),i):t},i.y=function(o){return arguments.length?(e=typeof o=="function"?o:ts(+o),l(),i):e},i}function PD(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Sp(e,t){if((n=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var n,r=e.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+e.slice(n+1)]}function Lu(e){return e=Sp(Math.abs(e)),e?e[1]:NaN}function ID(e,t){return function(n,r){for(var s=n.length,i=[],l=0,o=e[0],c=0;s>0&&o>0&&(c+o+1>r&&(o=Math.max(1,r-c)),i.push(n.substring(s-=o,s+o)),!((c+=o+1)>r));)o=e[l=(l+1)%e.length];return i.reverse().join(t)}}function TD(e){return function(t){return t.replace(/[0-9]/g,function(n){return e[+n]})}}var LD=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Wf(e){if(!(t=LD.exec(e)))throw new Error("invalid format: "+e);var t;return new D0({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}Wf.prototype=D0.prototype;function D0(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}D0.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function MD(e){e:for(var t=e.length,n=1,r=-1,s;n<t;++n)switch(e[n]){case".":r=s=n;break;case"0":r===0&&(r=n),s=n;break;default:if(!+e[n])break e;r>0&&(r=0);break}return r>0?e.slice(0,r)+e.slice(s+1):e}var U6;function RD(e,t){var n=Sp(e,t);if(!n)return e+"";var r=n[0],s=n[1],i=s-(U6=Math.max(-8,Math.min(8,Math.floor(s/3)))*3)+1,l=r.length;return i===l?r:i>l?r+new Array(i-l+1).join("0"):i>0?r.slice(0,i)+"."+r.slice(i):"0."+new Array(1-i).join("0")+Sp(e,Math.max(0,t+i-1))[0]}function G5(e,t){var n=Sp(e,t);if(!n)return e+"";var r=n[0],s=n[1];return s<0?"0."+new Array(-s).join("0")+r:r.length>s+1?r.slice(0,s+1)+"."+r.slice(s+1):r+new Array(s-r.length+2).join("0")}const Y5={"%":(e,t)=>(e*100).toFixed(t),b:e=>Math.round(e).toString(2),c:e=>e+"",d:PD,e:(e,t)=>e.toExponential(t),f:(e,t)=>e.toFixed(t),g:(e,t)=>e.toPrecision(t),o:e=>Math.round(e).toString(8),p:(e,t)=>G5(e*100,t),r:G5,s:RD,X:e=>Math.round(e).toString(16).toUpperCase(),x:e=>Math.round(e).toString(16)};function J5(e){return e}var Z5=Array.prototype.map,X5=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function q6(e){var t=e.grouping===void 0||e.thousands===void 0?J5:ID(Z5.call(e.grouping,Number),e.thousands+""),n=e.currency===void 0?"":e.currency[0]+"",r=e.currency===void 0?"":e.currency[1]+"",s=e.decimal===void 0?".":e.decimal+"",i=e.numerals===void 0?J5:TD(Z5.call(e.numerals,String)),l=e.percent===void 0?"%":e.percent+"",o=e.minus===void 0?"":e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function u(f){f=Wf(f);var m=f.fill,h=f.align,x=f.sign,y=f.symbol,p=f.zero,g=f.width,w=f.comma,v=f.precision,N=f.trim,A=f.type;A==="n"?(w=!0,A="g"):Y5[A]||(v===void 0&&(v=12),N=!0,A="g"),(p||m==="0"&&h==="=")&&(p=!0,m="0",h="=");var P=y==="$"?n:y==="#"&&/[boxX]/.test(A)?"0"+A.toLowerCase():"",U=y==="$"?r:/[%p]/.test(A)?l:"",M=Y5[A],S=/[defgprs%]/.test(A);v=v===void 0?6:/[gprs]/.test(A)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v));function C(_){var T=P,B=U,$,D,L;if(A==="c")B=M(_)+B,_="";else{_=+_;var O=_<0||1/_<0;if(_=isNaN(_)?c:M(Math.abs(_),v),N&&(_=MD(_)),O&&+_==0&&x!=="+"&&(O=!1),T=(O?x==="("?x:o:x==="-"||x==="("?"":x)+T,B=(A==="s"?X5[8+U6/3]:"")+B+(O&&x==="("?")":""),S){for($=-1,D=_.length;++$<D;)if(L=_.charCodeAt($),48>L||L>57){B=(L===46?s+_.slice($+1):_.slice($))+B,_=_.slice(0,$);break}}}w&&!p&&(_=t(_,1/0));var W=T.length+_.length+B.length,E=W<g?new Array(g-W+1).join(m):"";switch(w&&p&&(_=t(E+_,E.length?g-B.length:1/0),E=""),h){case"<":_=T+_+B+E;break;case"=":_=T+E+_+B;break;case"^":_=E.slice(0,W=E.length>>1)+T+_+B+E.slice(W);break;default:_=E+T+_+B;break}return i(_)}return C.toString=function(){return f+""},C}function d(f,m){var h=u((f=Wf(f),f.type="f",f)),x=Math.max(-8,Math.min(8,Math.floor(Lu(m)/3)))*3,y=Math.pow(10,-x),p=X5[8+x/3];return function(g){return h(y*g)+p}}return{format:u,formatPrefix:d}}var cm,B0,Py;H6({thousands:",",grouping:[3],currency:["$",""]});function H6(e){return cm=q6(e),B0=cm.format,Py=cm.formatPrefix,cm}function W6(e){return Math.max(0,-Lu(Math.abs(e)))}function V6(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Lu(t)/3)))*3-Lu(Math.abs(e)))}function G6(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Lu(t)-Lu(e))+1}var ln=1e-6,Vf=1e-12,An=Math.PI,Er=An/2,_p=An/4,Vs=An*2,sr=180/An,cn=An/180,Tn=Math.abs,Qu=Math.atan,Gs=Math.atan2,Wt=Math.cos,um=Math.ceil,Y6=Math.exp,Yx=Math.hypot,Ap=Math.log,h1=Math.pow,Tt=Math.sin,$i=Math.sign||function(e){return e>0?1:e<0?-1:0},os=Math.sqrt,Iy=Math.tan;function J6(e){return e>1?0:e<-1?An:Math.acos(e)}function Ys(e){return e>1?Er:e<-1?-Er:Math.asin(e)}function K5(e){return(e=Tt(e/2))*e}function vr(){}function kp(e,t){e&&ew.hasOwnProperty(e.type)&&ew[e.type](e,t)}var Q5={Feature:function(e,t){kp(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,s=n.length;++r<s;)kp(n[r].geometry,t)}},ew={Sphere:function(e,t){t.sphere()},Point:function(e,t){e=e.coordinates,t.point(e[0],e[1],e[2])},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,s=n.length;++r<s;)e=n[r],t.point(e[0],e[1],e[2])},LineString:function(e,t){Jx(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,s=n.length;++r<s;)Jx(n[r],t,0)},Polygon:function(e,t){tw(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,s=n.length;++r<s;)tw(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,s=n.length;++r<s;)kp(n[r],t)}};function Jx(e,t,n){var r=-1,s=e.length-n,i;for(t.lineStart();++r<s;)i=e[r],t.point(i[0],i[1],i[2]);t.lineEnd()}function tw(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)Jx(e[n],t,1);t.polygonEnd()}function Ki(e,t){e&&Q5.hasOwnProperty(e.type)?Q5[e.type](e,t):kp(e,t)}var Ep=new ns,Cp=new ns,Z6,X6,Zx,Xx,Kx,La={point:vr,lineStart:vr,lineEnd:vr,polygonStart:function(){Ep=new ns,La.lineStart=$D,La.lineEnd=FD},polygonEnd:function(){var e=+Ep;Cp.add(e<0?Vs+e:e),this.lineStart=this.lineEnd=this.point=vr},sphere:function(){Cp.add(Vs)}};function $D(){La.point=OD}function FD(){K6(Z6,X6)}function OD(e,t){La.point=K6,Z6=e,X6=t,e*=cn,t*=cn,Zx=e,Xx=Wt(t=t/2+_p),Kx=Tt(t)}function K6(e,t){e*=cn,t*=cn,t=t/2+_p;var n=e-Zx,r=n>=0?1:-1,s=r*n,i=Wt(t),l=Tt(t),o=Kx*l,c=Xx*i+o*Wt(s),u=o*r*Tt(s);Ep.add(Gs(u,c)),Zx=e,Xx=i,Kx=l}function DD(e){return Cp=new ns,Ki(e,La),Cp*2}function Pp(e){return[Gs(e[1],e[0]),Ys(e[2])]}function tc(e){var t=e[0],n=e[1],r=Wt(n);return[r*Wt(t),r*Tt(t),Tt(n)]}function dm(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Mu(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function m1(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function fm(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function Ip(e){var t=os(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}var br,ti,Ar,ji,Rl,Q6,eS,pu,Nf,Ho,go,to={point:Qx,lineStart:nw,lineEnd:rw,polygonStart:function(){to.point=nS,to.lineStart=BD,to.lineEnd=zD,Nf=new ns,La.polygonStart()},polygonEnd:function(){La.polygonEnd(),to.point=Qx,to.lineStart=nw,to.lineEnd=rw,Ep<0?(br=-(Ar=180),ti=-(ji=90)):Nf>ln?ji=90:Nf<-ln&&(ti=-90),go[0]=br,go[1]=Ar},sphere:function(){br=-(Ar=180),ti=-(ji=90)}};function Qx(e,t){Ho.push(go=[br=e,Ar=e]),t<ti&&(ti=t),t>ji&&(ji=t)}function tS(e,t){var n=tc([e*cn,t*cn]);if(pu){var r=Mu(pu,n),s=[r[1],-r[0],0],i=Mu(s,r);Ip(i),i=Pp(i);var l=e-Rl,o=l>0?1:-1,c=i[0]*sr*o,u,d=Tn(l)>180;d^(o*Rl<c&&c<o*e)?(u=i[1]*sr,u>ji&&(ji=u)):(c=(c+360)%360-180,d^(o*Rl<c&&c<o*e)?(u=-i[1]*sr,u<ti&&(ti=u)):(t<ti&&(ti=t),t>ji&&(ji=t))),d?e<Rl?wi(br,e)>wi(br,Ar)&&(Ar=e):wi(e,Ar)>wi(br,Ar)&&(br=e):Ar>=br?(e<br&&(br=e),e>Ar&&(Ar=e)):e>Rl?wi(br,e)>wi(br,Ar)&&(Ar=e):wi(e,Ar)>wi(br,Ar)&&(br=e)}else Ho.push(go=[br=e,Ar=e]);t<ti&&(ti=t),t>ji&&(ji=t),pu=n,Rl=e}function nw(){to.point=tS}function rw(){go[0]=br,go[1]=Ar,to.point=Qx,pu=null}function nS(e,t){if(pu){var n=e-Rl;Nf.add(Tn(n)>180?n+(n>0?360:-360):n)}else Q6=e,eS=t;La.point(e,t),tS(e,t)}function BD(){La.lineStart()}function zD(){nS(Q6,eS),La.lineEnd(),Tn(Nf)>ln&&(br=-(Ar=180)),go[0]=br,go[1]=Ar,pu=null}function wi(e,t){return(t-=e)<0?t+360:t}function UD(e,t){return e[0]-t[0]}function sw(e,t){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}function qD(e){var t,n,r,s,i,l,o;if(ji=Ar=-(br=ti=1/0),Ho=[],Ki(e,to),n=Ho.length){for(Ho.sort(UD),t=1,r=Ho[0],i=[r];t<n;++t)s=Ho[t],sw(r,s[0])||sw(r,s[1])?(wi(r[0],s[1])>wi(r[0],r[1])&&(r[1]=s[1]),wi(s[0],r[1])>wi(r[0],r[1])&&(r[0]=s[0])):i.push(r=s);for(l=-1/0,n=i.length-1,t=0,r=i[n];t<=n;r=s,++t)s=i[t],(o=wi(r[1],s[0]))>l&&(l=o,br=s[0],Ar=r[1])}return Ho=go=null,br===1/0||ti===1/0?[[NaN,NaN],[NaN,NaN]]:[[br,ti],[Ar,ji]]}var lf,Tp,Lp,Mp,Rp,$p,Fp,Op,e2,t2,n2,rS,sS,zs,Us,qs,ea={sphere:vr,point:Ty,lineStart:iw,lineEnd:aw,polygonStart:function(){ea.lineStart=VD,ea.lineEnd=GD},polygonEnd:function(){ea.lineStart=iw,ea.lineEnd=aw}};function Ty(e,t){e*=cn,t*=cn;var n=Wt(t);xh(n*Wt(e),n*Tt(e),Tt(t))}function xh(e,t,n){++lf,Lp+=(e-Lp)/lf,Mp+=(t-Mp)/lf,Rp+=(n-Rp)/lf}function iw(){ea.point=HD}function HD(e,t){e*=cn,t*=cn;var n=Wt(t);zs=n*Wt(e),Us=n*Tt(e),qs=Tt(t),ea.point=WD,xh(zs,Us,qs)}function WD(e,t){e*=cn,t*=cn;var n=Wt(t),r=n*Wt(e),s=n*Tt(e),i=Tt(t),l=Gs(os((l=Us*i-qs*s)*l+(l=qs*r-zs*i)*l+(l=zs*s-Us*r)*l),zs*r+Us*s+qs*i);Tp+=l,$p+=l*(zs+(zs=r)),Fp+=l*(Us+(Us=s)),Op+=l*(qs+(qs=i)),xh(zs,Us,qs)}function aw(){ea.point=Ty}function VD(){ea.point=YD}function GD(){iS(rS,sS),ea.point=Ty}function YD(e,t){rS=e,sS=t,e*=cn,t*=cn,ea.point=iS;var n=Wt(t);zs=n*Wt(e),Us=n*Tt(e),qs=Tt(t),xh(zs,Us,qs)}function iS(e,t){e*=cn,t*=cn;var n=Wt(t),r=n*Wt(e),s=n*Tt(e),i=Tt(t),l=Us*i-qs*s,o=qs*r-zs*i,c=zs*s-Us*r,u=Yx(l,o,c),d=Ys(u),f=u&&-d/u;e2.add(f*l),t2.add(f*o),n2.add(f*c),Tp+=d,$p+=d*(zs+(zs=r)),Fp+=d*(Us+(Us=s)),Op+=d*(qs+(qs=i)),xh(zs,Us,qs)}function JD(e){lf=Tp=Lp=Mp=Rp=$p=Fp=Op=0,e2=new ns,t2=new ns,n2=new ns,Ki(e,ea);var t=+e2,n=+t2,r=+n2,s=Yx(t,n,r);return s<Vf&&(t=$p,n=Fp,r=Op,Tp<ln&&(t=Lp,n=Mp,r=Rp),s=Yx(t,n,r),s<Vf)?[NaN,NaN]:[Gs(n,t)*sr,Ys(r/s)*sr]}function Hc(e){return function(){return e}}function r2(e,t){function n(r,s){return r=e(r,s),t(r[0],r[1])}return e.invert&&t.invert&&(n.invert=function(r,s){return r=t.invert(r,s),r&&e.invert(r[0],r[1])}),n}function s2(e,t){return[Tn(e)>An?e+Math.round(-e/Vs)*Vs:e,t]}s2.invert=s2;function Ly(e,t,n){return(e%=Vs)?t||n?r2(lw(e),cw(t,n)):lw(e):t||n?cw(t,n):s2}function ow(e){return function(t,n){return t+=e,[t>An?t-Vs:t<-An?t+Vs:t,n]}}function lw(e){var t=ow(e);return t.invert=ow(-e),t}function cw(e,t){var n=Wt(e),r=Tt(e),s=Wt(t),i=Tt(t);function l(o,c){var u=Wt(c),d=Wt(o)*u,f=Tt(o)*u,m=Tt(c),h=m*n+d*r;return[Gs(f*s-h*i,d*n-m*r),Ys(h*s+f*i)]}return l.invert=function(o,c){var u=Wt(c),d=Wt(o)*u,f=Tt(o)*u,m=Tt(c),h=m*s-f*i;return[Gs(f*s+m*i,d*n+h*r),Ys(h*n-d*r)]},l}function aS(e){e=Ly(e[0]*cn,e[1]*cn,e.length>2?e[2]*cn:0);function t(n){return n=e(n[0]*cn,n[1]*cn),n[0]*=sr,n[1]*=sr,n}return t.invert=function(n){return n=e.invert(n[0]*cn,n[1]*cn),n[0]*=sr,n[1]*=sr,n},t}function oS(e,t,n,r,s,i){if(n){var l=Wt(t),o=Tt(t),c=r*n;s==null?(s=t+r*Vs,i=t-c/2):(s=uw(l,s),i=uw(l,i),(r>0?s<i:s>i)&&(s+=r*Vs));for(var u,d=s;r>0?d>i:d<i;d-=c)u=Pp([l,-o*Wt(d),-o*Tt(d)]),e.point(u[0],u[1])}}function uw(e,t){t=tc(t),t[0]-=e,Ip(t);var n=J6(-t[1]);return((-t[2]<0?-n:n)+Vs-ln)%Vs}function ZD(){var e=Hc([0,0]),t=Hc(90),n=Hc(6),r,s,i={point:l};function l(c,u){r.push(c=s(c,u)),c[0]*=sr,c[1]*=sr}function o(){var c=e.apply(this,arguments),u=t.apply(this,arguments)*cn,d=n.apply(this,arguments)*cn;return r=[],s=Ly(-c[0]*cn,-c[1]*cn,0).invert,oS(i,u,d,1),c={type:"Polygon",coordinates:[r]},r=s=null,c}return o.center=function(c){return arguments.length?(e=typeof c=="function"?c:Hc([+c[0],+c[1]]),o):e},o.radius=function(c){return arguments.length?(t=typeof c=="function"?c:Hc(+c),o):t},o.precision=function(c){return arguments.length?(n=typeof c=="function"?c:Hc(+c),o):n},o}function lS(){var e=[],t;return{point:function(n,r,s){t.push([n,r,s])},lineStart:function(){e.push(t=[])},lineEnd:vr,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function Km(e,t){return Tn(e[0]-t[0])<ln&&Tn(e[1]-t[1])<ln}function hm(e,t,n,r){this.x=e,this.z=t,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function cS(e,t,n,r,s){var i=[],l=[],o,c;if(e.forEach(function(x){if(!((y=x.length-1)<=0)){var y,p=x[0],g=x[y],w;if(Km(p,g)){if(!p[2]&&!g[2]){for(s.lineStart(),o=0;o<y;++o)s.point((p=x[o])[0],p[1]);s.lineEnd();return}g[0]+=2*ln}i.push(w=new hm(p,x,null,!0)),l.push(w.o=new hm(p,null,w,!1)),i.push(w=new hm(g,x,null,!1)),l.push(w.o=new hm(g,null,w,!0))}}),!!i.length){for(l.sort(t),dw(i),dw(l),o=0,c=l.length;o<c;++o)l[o].e=n=!n;for(var u=i[0],d,f;;){for(var m=u,h=!0;m.v;)if((m=m.n)===u)return;d=m.z,s.lineStart();do{if(m.v=m.o.v=!0,m.e){if(h)for(o=0,c=d.length;o<c;++o)s.point((f=d[o])[0],f[1]);else r(m.x,m.n.x,1,s);m=m.n}else{if(h)for(d=m.p.z,o=d.length-1;o>=0;--o)s.point((f=d[o])[0],f[1]);else r(m.x,m.p.x,-1,s);m=m.p}m=m.o,d=m.z,h=!h}while(!m.v);s.lineEnd()}}}function dw(e){if(t=e.length){for(var t,n=0,r=e[0],s;++n<t;)r.n=s=e[n],s.p=r,r=s;r.n=s=e[0],s.p=r}}function p1(e){return Tn(e[0])<=An?e[0]:$i(e[0])*((Tn(e[0])+An)%Vs-An)}function uS(e,t){var n=p1(t),r=t[1],s=Tt(r),i=[Tt(n),-Wt(n),0],l=0,o=0,c=new ns;s===1?r=Er+ln:s===-1&&(r=-Er-ln);for(var u=0,d=e.length;u<d;++u)if(m=(f=e[u]).length)for(var f,m,h=f[m-1],x=p1(h),y=h[1]/2+_p,p=Tt(y),g=Wt(y),w=0;w<m;++w,x=N,p=P,g=U,h=v){var v=f[w],N=p1(v),A=v[1]/2+_p,P=Tt(A),U=Wt(A),M=N-x,S=M>=0?1:-1,C=S*M,_=C>An,T=p*P;if(c.add(Gs(T*S*Tt(C),g*U+T*Wt(C))),l+=_?M+S*Vs:M,_^x>=n^N>=n){var B=Mu(tc(h),tc(v));Ip(B);var $=Mu(i,B);Ip($);var D=(_^M>=0?-1:1)*Ys($[2]);(r>D||r===D&&(B[0]||B[1]))&&(o+=_^M>=0?1:-1)}}return(l<-ln||l<ln&&c<-Vf)^o&1}function dS(e,t,n,r){return function(s){var i=t(s),l=lS(),o=t(l),c=!1,u,d,f,m={point:h,lineStart:y,lineEnd:p,polygonStart:function(){m.point=g,m.lineStart=w,m.lineEnd=v,d=[],u=[]},polygonEnd:function(){m.point=h,m.lineStart=y,m.lineEnd=p,d=oy(d);var N=uS(u,r);d.length?(c||(s.polygonStart(),c=!0),cS(d,KD,N,n,s)):N&&(c||(s.polygonStart(),c=!0),s.lineStart(),n(null,null,1,s),s.lineEnd()),c&&(s.polygonEnd(),c=!1),d=u=null},sphere:function(){s.polygonStart(),s.lineStart(),n(null,null,1,s),s.lineEnd(),s.polygonEnd()}};function h(N,A){e(N,A)&&s.point(N,A)}function x(N,A){i.point(N,A)}function y(){m.point=x,i.lineStart()}function p(){m.point=h,i.lineEnd()}function g(N,A){f.push([N,A]),o.point(N,A)}function w(){o.lineStart(),f=[]}function v(){g(f[0][0],f[0][1]),o.lineEnd();var N=o.clean(),A=l.result(),P,U=A.length,M,S,C;if(f.pop(),u.push(f),f=null,!!U){if(N&1){if(S=A[0],(M=S.length-1)>0){for(c||(s.polygonStart(),c=!0),s.lineStart(),P=0;P<M;++P)s.point((C=S[P])[0],C[1]);s.lineEnd()}return}U>1&&N&2&&A.push(A.pop().concat(A.shift())),d.push(A.filter(XD))}}return m}}function XD(e){return e.length>1}function KD(e,t){return((e=e.x)[0]<0?e[1]-Er-ln:Er-e[1])-((t=t.x)[0]<0?t[1]-Er-ln:Er-t[1])}const i2=dS(function(){return!0},QD,tB,[-An,-Er]);function QD(e){var t=NaN,n=NaN,r=NaN,s;return{lineStart:function(){e.lineStart(),s=1},point:function(i,l){var o=i>0?An:-An,c=Tn(i-t);Tn(c-An)<ln?(e.point(t,n=(n+l)/2>0?Er:-Er),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(o,n),e.point(i,n),s=0):r!==o&&c>=An&&(Tn(t-r)<ln&&(t-=r*ln),Tn(i-o)<ln&&(i-=o*ln),n=eB(t,n,i,l),e.point(r,n),e.lineEnd(),e.lineStart(),e.point(o,n),s=0),e.point(t=i,n=l),r=o},lineEnd:function(){e.lineEnd(),t=n=NaN},clean:function(){return 2-s}}}function eB(e,t,n,r){var s,i,l=Tt(e-n);return Tn(l)>ln?Qu((Tt(t)*(i=Wt(r))*Tt(n)-Tt(r)*(s=Wt(t))*Tt(e))/(s*i*l)):(t+r)/2}function tB(e,t,n,r){var s;if(e==null)s=n*Er,r.point(-An,s),r.point(0,s),r.point(An,s),r.point(An,0),r.point(An,-s),r.point(0,-s),r.point(-An,-s),r.point(-An,0),r.point(-An,s);else if(Tn(e[0]-t[0])>ln){var i=e[0]<t[0]?An:-An;s=n*i/2,r.point(-i,s),r.point(0,s),r.point(i,s)}else r.point(t[0],t[1])}function fS(e){var t=Wt(e),n=6*cn,r=t>0,s=Tn(t)>ln;function i(d,f,m,h){oS(h,e,n,m,d,f)}function l(d,f){return Wt(d)*Wt(f)>t}function o(d){var f,m,h,x,y;return{lineStart:function(){x=h=!1,y=1},point:function(p,g){var w=[p,g],v,N=l(p,g),A=r?N?0:u(p,g):N?u(p+(p<0?An:-An),g):0;if(!f&&(x=h=N)&&d.lineStart(),N!==h&&(v=c(f,w),(!v||Km(f,v)||Km(w,v))&&(w[2]=1)),N!==h)y=0,N?(d.lineStart(),v=c(w,f),d.point(v[0],v[1])):(v=c(f,w),d.point(v[0],v[1],2),d.lineEnd()),f=v;else if(s&&f&&r^N){var P;!(A&m)&&(P=c(w,f,!0))&&(y=0,r?(d.lineStart(),d.point(P[0][0],P[0][1]),d.point(P[1][0],P[1][1]),d.lineEnd()):(d.point(P[1][0],P[1][1]),d.lineEnd(),d.lineStart(),d.point(P[0][0],P[0][1],3)))}N&&(!f||!Km(f,w))&&d.point(w[0],w[1]),f=w,h=N,m=A},lineEnd:function(){h&&d.lineEnd(),f=null},clean:function(){return y|(x&&h)<<1}}}function c(d,f,m){var h=tc(d),x=tc(f),y=[1,0,0],p=Mu(h,x),g=dm(p,p),w=p[0],v=g-w*w;if(!v)return!m&&d;var N=t*g/v,A=-t*w/v,P=Mu(y,p),U=fm(y,N),M=fm(p,A);m1(U,M);var S=P,C=dm(U,S),_=dm(S,S),T=C*C-_*(dm(U,U)-1);if(!(T<0)){var B=os(T),$=fm(S,(-C-B)/_);if(m1($,U),$=Pp($),!m)return $;var D=d[0],L=f[0],O=d[1],W=f[1],E;L<D&&(E=D,D=L,L=E);var H=L-D,V=Tn(H-An)<ln,R=V||H<ln;if(!V&&W<O&&(E=O,O=W,W=E),R?V?O+W>0^$[1]<(Tn($[0]-D)<ln?O:W):O<=$[1]&&$[1]<=W:H>An^(D<=$[0]&&$[0]<=L)){var q=fm(S,(-C+B)/_);return m1(q,U),[$,Pp(q)]}}}function u(d,f){var m=r?e:An-e,h=0;return d<-m?h|=1:d>m&&(h|=2),f<-m?h|=4:f>m&&(h|=8),h}return dS(l,o,i,r?[0,-e]:[-An,e-An])}function nB(e,t,n,r,s,i){var l=e[0],o=e[1],c=t[0],u=t[1],d=0,f=1,m=c-l,h=u-o,x;if(x=n-l,!(!m&&x>0)){if(x/=m,m<0){if(x<d)return;x<f&&(f=x)}else if(m>0){if(x>f)return;x>d&&(d=x)}if(x=s-l,!(!m&&x<0)){if(x/=m,m<0){if(x>f)return;x>d&&(d=x)}else if(m>0){if(x<d)return;x<f&&(f=x)}if(x=r-o,!(!h&&x>0)){if(x/=h,h<0){if(x<d)return;x<f&&(f=x)}else if(h>0){if(x>f)return;x>d&&(d=x)}if(x=i-o,!(!h&&x<0)){if(x/=h,h<0){if(x>f)return;x>d&&(d=x)}else if(h>0){if(x<d)return;x<f&&(f=x)}return d>0&&(e[0]=l+d*m,e[1]=o+d*h),f<1&&(t[0]=l+f*m,t[1]=o+f*h),!0}}}}}var cf=1e9,mm=-cf;function z0(e,t,n,r){function s(u,d){return e<=u&&u<=n&&t<=d&&d<=r}function i(u,d,f,m){var h=0,x=0;if(u==null||(h=l(u,f))!==(x=l(d,f))||c(u,d)<0^f>0)do m.point(h===0||h===3?e:n,h>1?r:t);while((h=(h+f+4)%4)!==x);else m.point(d[0],d[1])}function l(u,d){return Tn(u[0]-e)<ln?d>0?0:3:Tn(u[0]-n)<ln?d>0?2:1:Tn(u[1]-t)<ln?d>0?1:0:d>0?3:2}function o(u,d){return c(u.x,d.x)}function c(u,d){var f=l(u,1),m=l(d,1);return f!==m?f-m:f===0?d[1]-u[1]:f===1?u[0]-d[0]:f===2?u[1]-d[1]:d[0]-u[0]}return function(u){var d=u,f=lS(),m,h,x,y,p,g,w,v,N,A,P,U={point:M,lineStart:T,lineEnd:B,polygonStart:C,polygonEnd:_};function M(D,L){s(D,L)&&d.point(D,L)}function S(){for(var D=0,L=0,O=h.length;L<O;++L)for(var W=h[L],E=1,H=W.length,V=W[0],R,q,F=V[0],G=V[1];E<H;++E)R=F,q=G,V=W[E],F=V[0],G=V[1],q<=r?G>r&&(F-R)*(r-q)>(G-q)*(e-R)&&++D:G<=r&&(F-R)*(r-q)<(G-q)*(e-R)&&--D;return D}function C(){d=f,m=[],h=[],P=!0}function _(){var D=S(),L=P&&D,O=(m=oy(m)).length;(L||O)&&(u.polygonStart(),L&&(u.lineStart(),i(null,null,1,u),u.lineEnd()),O&&cS(m,o,D,i,u),u.polygonEnd()),d=u,m=h=x=null}function T(){U.point=$,h&&h.push(x=[]),A=!0,N=!1,w=v=NaN}function B(){m&&($(y,p),g&&N&&f.rejoin(),m.push(f.result())),U.point=M,N&&d.lineEnd()}function $(D,L){var O=s(D,L);if(h&&x.push([D,L]),A)y=D,p=L,g=O,A=!1,O&&(d.lineStart(),d.point(D,L));else if(O&&N)d.point(D,L);else{var W=[w=Math.max(mm,Math.min(cf,w)),v=Math.max(mm,Math.min(cf,v))],E=[D=Math.max(mm,Math.min(cf,D)),L=Math.max(mm,Math.min(cf,L))];nB(W,E,e,t,n,r)?(N||(d.lineStart(),d.point(W[0],W[1])),d.point(E[0],E[1]),O||d.lineEnd(),P=!1):O&&(d.lineStart(),d.point(D,L),P=!1)}w=D,v=L,N=O}return U}}function rB(){var e=0,t=0,n=960,r=500,s,i,l;return l={stream:function(o){return s&&i===o?s:s=z0(e,t,n,r)(i=o)},extent:function(o){return arguments.length?(e=+o[0][0],t=+o[0][1],n=+o[1][0],r=+o[1][1],s=i=null,l):[[e,t],[n,r]]}}}var a2,o2,Qm,ep,Ru={sphere:vr,point:vr,lineStart:sB,lineEnd:vr,polygonStart:vr,polygonEnd:vr};function sB(){Ru.point=aB,Ru.lineEnd=iB}function iB(){Ru.point=Ru.lineEnd=vr}function aB(e,t){e*=cn,t*=cn,o2=e,Qm=Tt(t),ep=Wt(t),Ru.point=oB}function oB(e,t){e*=cn,t*=cn;var n=Tt(t),r=Wt(t),s=Tn(e-o2),i=Wt(s),l=Tt(s),o=r*l,c=ep*n-Qm*r*i,u=Qm*n+ep*r*i;a2.add(Gs(os(o*o+c*c),u)),o2=e,Qm=n,ep=r}function hS(e){return a2=new ns,Ki(e,Ru),+a2}var l2=[null,null],lB={type:"LineString",coordinates:l2};function Dp(e,t){return l2[0]=e,l2[1]=t,hS(lB)}var fw={Feature:function(e,t){return Bp(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,s=n.length;++r<s;)if(Bp(n[r].geometry,t))return!0;return!1}},hw={Sphere:function(){return!0},Point:function(e,t){return mw(e.coordinates,t)},MultiPoint:function(e,t){for(var n=e.coordinates,r=-1,s=n.length;++r<s;)if(mw(n[r],t))return!0;return!1},LineString:function(e,t){return pw(e.coordinates,t)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,s=n.length;++r<s;)if(pw(n[r],t))return!0;return!1},Polygon:function(e,t){return gw(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,s=n.length;++r<s;)if(gw(n[r],t))return!0;return!1},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,s=n.length;++r<s;)if(Bp(n[r],t))return!0;return!1}};function Bp(e,t){return e&&hw.hasOwnProperty(e.type)?hw[e.type](e,t):!1}function mw(e,t){return Dp(e,t)===0}function pw(e,t){for(var n,r,s,i=0,l=e.length;i<l;i++){if(r=Dp(e[i],t),r===0||i>0&&(s=Dp(e[i],e[i-1]),s>0&&n<=s&&r<=s&&(n+r-s)*(1-Math.pow((n-r)/s,2))<Vf*s))return!0;n=r}return!1}function gw(e,t){return!!uS(e.map(cB),mS(t))}function cB(e){return e=e.map(mS),e.pop(),e}function mS(e){return[e[0]*cn,e[1]*cn]}function uB(e,t){return(e&&fw.hasOwnProperty(e.type)?fw[e.type]:Bp)(e,t)}function xw(e,t,n){var r=Aa(e,t-ln,n).concat(t);return function(s){return r.map(function(i){return[s,i]})}}function yw(e,t,n){var r=Aa(e,t-ln,n).concat(t);return function(s){return r.map(function(i){return[i,s]})}}function pS(){var e,t,n,r,s,i,l,o,c=10,u=c,d=90,f=360,m,h,x,y,p=2.5;function g(){return{type:"MultiLineString",coordinates:w()}}function w(){return Aa(um(r/d)*d,n,d).map(x).concat(Aa(um(o/f)*f,l,f).map(y)).concat(Aa(um(t/c)*c,e,c).filter(function(v){return Tn(v%d)>ln}).map(m)).concat(Aa(um(i/u)*u,s,u).filter(function(v){return Tn(v%f)>ln}).map(h))}return g.lines=function(){return w().map(function(v){return{type:"LineString",coordinates:v}})},g.outline=function(){return{type:"Polygon",coordinates:[x(r).concat(y(l).slice(1),x(n).reverse().slice(1),y(o).reverse().slice(1))]}},g.extent=function(v){return arguments.length?g.extentMajor(v).extentMinor(v):g.extentMinor()},g.extentMajor=function(v){return arguments.length?(r=+v[0][0],n=+v[1][0],o=+v[0][1],l=+v[1][1],r>n&&(v=r,r=n,n=v),o>l&&(v=o,o=l,l=v),g.precision(p)):[[r,o],[n,l]]},g.extentMinor=function(v){return arguments.length?(t=+v[0][0],e=+v[1][0],i=+v[0][1],s=+v[1][1],t>e&&(v=t,t=e,e=v),i>s&&(v=i,i=s,s=v),g.precision(p)):[[t,i],[e,s]]},g.step=function(v){return arguments.length?g.stepMajor(v).stepMinor(v):g.stepMinor()},g.stepMajor=function(v){return arguments.length?(d=+v[0],f=+v[1],g):[d,f]},g.stepMinor=function(v){return arguments.length?(c=+v[0],u=+v[1],g):[c,u]},g.precision=function(v){return arguments.length?(p=+v,m=xw(i,s,90),h=yw(t,e,p),x=xw(o,l,90),y=yw(r,n,p),g):p},g.extentMajor([[-180,-90+ln],[180,90-ln]]).extentMinor([[-180,-80-ln],[180,80+ln]])}function dB(){return pS()()}function fB(e,t){var n=e[0]*cn,r=e[1]*cn,s=t[0]*cn,i=t[1]*cn,l=Wt(r),o=Tt(r),c=Wt(i),u=Tt(i),d=l*Wt(n),f=l*Tt(n),m=c*Wt(s),h=c*Tt(s),x=2*Ys(os(K5(i-r)+l*c*K5(s-n))),y=Tt(x),p=x?function(g){var w=Tt(g*=x)/y,v=Tt(x-g)/y,N=v*d+w*m,A=v*f+w*h,P=v*o+w*u;return[Gs(A,N)*sr,Gs(P,os(N*N+A*A))*sr]}:function(){return[n*sr,r*sr]};return p.distance=x,p}const Gf=e=>e;var g1=new ns,c2=new ns,gS,xS,u2,d2,so={point:vr,lineStart:vr,lineEnd:vr,polygonStart:function(){so.lineStart=hB,so.lineEnd=pB},polygonEnd:function(){so.lineStart=so.lineEnd=so.point=vr,g1.add(Tn(c2)),c2=new ns},result:function(){var e=g1/2;return g1=new ns,e}};function hB(){so.point=mB}function mB(e,t){so.point=yS,gS=u2=e,xS=d2=t}function yS(e,t){c2.add(d2*e-u2*t),u2=e,d2=t}function pB(){yS(gS,xS)}var $u=1/0,zp=$u,Yf=-$u,Up=Yf,qp={point:gB,lineStart:vr,lineEnd:vr,polygonStart:vr,polygonEnd:vr,result:function(){var e=[[$u,zp],[Yf,Up]];return Yf=Up=-(zp=$u=1/0),e}};function gB(e,t){e<$u&&($u=e),e>Yf&&(Yf=e),t<zp&&(zp=t),t>Up&&(Up=t)}var f2=0,h2=0,uf=0,Hp=0,Wp=0,au=0,m2=0,p2=0,df=0,bS,vS,Sa,_a,Ri={point:nc,lineStart:bw,lineEnd:vw,polygonStart:function(){Ri.lineStart=bB,Ri.lineEnd=vB},polygonEnd:function(){Ri.point=nc,Ri.lineStart=bw,Ri.lineEnd=vw},result:function(){var e=df?[m2/df,p2/df]:au?[Hp/au,Wp/au]:uf?[f2/uf,h2/uf]:[NaN,NaN];return f2=h2=uf=Hp=Wp=au=m2=p2=df=0,e}};function nc(e,t){f2+=e,h2+=t,++uf}function bw(){Ri.point=xB}function xB(e,t){Ri.point=yB,nc(Sa=e,_a=t)}function yB(e,t){var n=e-Sa,r=t-_a,s=os(n*n+r*r);Hp+=s*(Sa+e)/2,Wp+=s*(_a+t)/2,au+=s,nc(Sa=e,_a=t)}function vw(){Ri.point=nc}function bB(){Ri.point=wB}function vB(){wS(bS,vS)}function wB(e,t){Ri.point=wS,nc(bS=Sa=e,vS=_a=t)}function wS(e,t){var n=e-Sa,r=t-_a,s=os(n*n+r*r);Hp+=s*(Sa+e)/2,Wp+=s*(_a+t)/2,au+=s,s=_a*e-Sa*t,m2+=s*(Sa+e),p2+=s*(_a+t),df+=s*3,nc(Sa=e,_a=t)}function NS(e){this._context=e}NS.prototype={_radius:4.5,pointRadius:function(e){return this._radius=e,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._context.moveTo(e,t),this._point=1;break}case 1:{this._context.lineTo(e,t);break}default:{this._context.moveTo(e+this._radius,t),this._context.arc(e,t,this._radius,0,Vs);break}}},result:vr};var g2=new ns,x1,jS,SS,ff,hf,Jf={point:vr,lineStart:function(){Jf.point=NB},lineEnd:function(){x1&&_S(jS,SS),Jf.point=vr},polygonStart:function(){x1=!0},polygonEnd:function(){x1=null},result:function(){var e=+g2;return g2=new ns,e}};function NB(e,t){Jf.point=_S,jS=ff=e,SS=hf=t}function _S(e,t){ff-=e,hf-=t,g2.add(os(ff*ff+hf*hf)),ff=e,hf=t}function AS(){this._string=[]}AS.prototype={_radius:4.5,_circle:ww(4.5),pointRadius:function(e){return(e=+e)!==this._radius&&(this._radius=e,this._circle=null),this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._string.push("Z"),this._point=NaN},point:function(e,t){switch(this._point){case 0:{this._string.push("M",e,",",t),this._point=1;break}case 1:{this._string.push("L",e,",",t);break}default:{this._circle==null&&(this._circle=ww(this._radius)),this._string.push("M",e,",",t,this._circle);break}}},result:function(){if(this._string.length){var e=this._string.join("");return this._string=[],e}else return null}};function ww(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+-2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function jB(e,t){var n=4.5,r,s;function i(l){return l&&(typeof n=="function"&&s.pointRadius(+n.apply(this,arguments)),Ki(l,r(s))),s.result()}return i.area=function(l){return Ki(l,r(so)),so.result()},i.measure=function(l){return Ki(l,r(Jf)),Jf.result()},i.bounds=function(l){return Ki(l,r(qp)),qp.result()},i.centroid=function(l){return Ki(l,r(Ri)),Ri.result()},i.projection=function(l){return arguments.length?(r=l==null?(e=null,Gf):(e=l).stream,i):e},i.context=function(l){return arguments.length?(s=l==null?(t=null,new AS):new NS(t=l),typeof n!="function"&&s.pointRadius(n),i):t},i.pointRadius=function(l){return arguments.length?(n=typeof l=="function"?l:(s.pointRadius(+l),+l),i):n},i.projection(e).context(t)}function SB(e){return{stream:yh(e)}}function yh(e){return function(t){var n=new x2;for(var r in e)n[r]=e[r];return n.stream=t,n}}function x2(){}x2.prototype={constructor:x2,point:function(e,t){this.stream.point(e,t)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function My(e,t,n){var r=e.clipExtent&&e.clipExtent();return e.scale(150).translate([0,0]),r!=null&&e.clipExtent(null),Ki(n,e.stream(qp)),t(qp.result()),r!=null&&e.clipExtent(r),e}function U0(e,t,n){return My(e,function(r){var s=t[1][0]-t[0][0],i=t[1][1]-t[0][1],l=Math.min(s/(r[1][0]-r[0][0]),i/(r[1][1]-r[0][1])),o=+t[0][0]+(s-l*(r[1][0]+r[0][0]))/2,c=+t[0][1]+(i-l*(r[1][1]+r[0][1]))/2;e.scale(150*l).translate([o,c])},n)}function Ry(e,t,n){return U0(e,[[0,0],t],n)}function $y(e,t,n){return My(e,function(r){var s=+t,i=s/(r[1][0]-r[0][0]),l=(s-i*(r[1][0]+r[0][0]))/2,o=-i*r[0][1];e.scale(150*i).translate([l,o])},n)}function Fy(e,t,n){return My(e,function(r){var s=+t,i=s/(r[1][1]-r[0][1]),l=-i*r[0][0],o=(s-i*(r[1][1]+r[0][1]))/2;e.scale(150*i).translate([l,o])},n)}var Nw=16,_B=Wt(30*cn);function jw(e,t){return+t?kB(e,t):AB(e)}function AB(e){return yh({point:function(t,n){t=e(t,n),this.stream.point(t[0],t[1])}})}function kB(e,t){function n(r,s,i,l,o,c,u,d,f,m,h,x,y,p){var g=u-r,w=d-s,v=g*g+w*w;if(v>4*t&&y--){var N=l+m,A=o+h,P=c+x,U=os(N*N+A*A+P*P),M=Ys(P/=U),S=Tn(Tn(P)-1)<ln||Tn(i-f)<ln?(i+f)/2:Gs(A,N),C=e(S,M),_=C[0],T=C[1],B=_-r,$=T-s,D=w*B-g*$;(D*D/v>t||Tn((g*B+w*$)/v-.5)>.3||l*m+o*h+c*x<_B)&&(n(r,s,i,l,o,c,_,T,S,N/=U,A/=U,P,y,p),p.point(_,T),n(_,T,S,N,A,P,u,d,f,m,h,x,y,p))}}return function(r){var s,i,l,o,c,u,d,f,m,h,x,y,p={point:g,lineStart:w,lineEnd:N,polygonStart:function(){r.polygonStart(),p.lineStart=A},polygonEnd:function(){r.polygonEnd(),p.lineStart=w}};function g(M,S){M=e(M,S),r.point(M[0],M[1])}function w(){f=NaN,p.point=v,r.lineStart()}function v(M,S){var C=tc([M,S]),_=e(M,S);n(f,m,d,h,x,y,f=_[0],m=_[1],d=M,h=C[0],x=C[1],y=C[2],Nw,r),r.point(f,m)}function N(){p.point=g,r.lineEnd()}function A(){w(),p.point=P,p.lineEnd=U}function P(M,S){v(s=M,S),i=f,l=m,o=h,c=x,u=y,p.point=v}function U(){n(f,m,d,h,x,y,i,l,s,o,c,u,Nw,r),p.lineEnd=N,N()}return p}}var EB=yh({point:function(e,t){this.stream.point(e*cn,t*cn)}});function CB(e){return yh({point:function(t,n){var r=e(t,n);return this.stream.point(r[0],r[1])}})}function PB(e,t,n,r,s){function i(l,o){return l*=r,o*=s,[t+e*l,n-e*o]}return i.invert=function(l,o){return[(l-t)/e*r,(n-o)/e*s]},i}function Sw(e,t,n,r,s,i){if(!i)return PB(e,t,n,r,s);var l=Wt(i),o=Tt(i),c=l*e,u=o*e,d=l/e,f=o/e,m=(o*n-l*t)/e,h=(o*t+l*n)/e;function x(y,p){return y*=r,p*=s,[c*y-u*p+t,n-u*y-c*p]}return x.invert=function(y,p){return[r*(d*y-f*p+m),s*(h-f*y-d*p)]},x}function Fa(e){return Oy(function(){return e})()}function Oy(e){var t,n=150,r=480,s=250,i=0,l=0,o=0,c=0,u=0,d,f=0,m=1,h=1,x=null,y=i2,p=null,g,w,v,N=Gf,A=.5,P,U,M,S,C;function _(D){return M(D[0]*cn,D[1]*cn)}function T(D){return D=M.invert(D[0],D[1]),D&&[D[0]*sr,D[1]*sr]}_.stream=function(D){return S&&C===D?S:S=EB(CB(d)(y(P(N(C=D)))))},_.preclip=function(D){return arguments.length?(y=D,x=void 0,$()):y},_.postclip=function(D){return arguments.length?(N=D,p=g=w=v=null,$()):N},_.clipAngle=function(D){return arguments.length?(y=+D?fS(x=D*cn):(x=null,i2),$()):x*sr},_.clipExtent=function(D){return arguments.length?(N=D==null?(p=g=w=v=null,Gf):z0(p=+D[0][0],g=+D[0][1],w=+D[1][0],v=+D[1][1]),$()):p==null?null:[[p,g],[w,v]]},_.scale=function(D){return arguments.length?(n=+D,B()):n},_.translate=function(D){return arguments.length?(r=+D[0],s=+D[1],B()):[r,s]},_.center=function(D){return arguments.length?(i=D[0]%360*cn,l=D[1]%360*cn,B()):[i*sr,l*sr]},_.rotate=function(D){return arguments.length?(o=D[0]%360*cn,c=D[1]%360*cn,u=D.length>2?D[2]%360*cn:0,B()):[o*sr,c*sr,u*sr]},_.angle=function(D){return arguments.length?(f=D%360*cn,B()):f*sr},_.reflectX=function(D){return arguments.length?(m=D?-1:1,B()):m<0},_.reflectY=function(D){return arguments.length?(h=D?-1:1,B()):h<0},_.precision=function(D){return arguments.length?(P=jw(U,A=D*D),$()):os(A)},_.fitExtent=function(D,L){return U0(_,D,L)},_.fitSize=function(D,L){return Ry(_,D,L)},_.fitWidth=function(D,L){return $y(_,D,L)},_.fitHeight=function(D,L){return Fy(_,D,L)};function B(){var D=Sw(n,0,0,m,h,f).apply(null,t(i,l)),L=Sw(n,r-D[0],s-D[1],m,h,f);return d=Ly(o,c,u),U=r2(t,L),M=r2(d,U),P=jw(U,A),$()}function $(){return S=C=null,_}return function(){return t=e.apply(this,arguments),_.invert=t.invert&&T,B()}}function Dy(e){var t=0,n=An/3,r=Oy(e),s=r(t,n);return s.parallels=function(i){return arguments.length?r(t=i[0]*cn,n=i[1]*cn):[t*sr,n*sr]},s}function IB(e){var t=Wt(e);function n(r,s){return[r*t,Tt(s)/t]}return n.invert=function(r,s){return[r/t,Ys(s*t)]},n}function kS(e,t){var n=Tt(e),r=(n+Tt(t))/2;if(Tn(r)<ln)return IB(e);var s=1+n*(2*r-n),i=os(s)/r;function l(o,c){var u=os(s-2*r*Tt(c))/r;return[u*Tt(o*=r),i-u*Wt(o)]}return l.invert=function(o,c){var u=i-c,d=Gs(o,Tn(u))*$i(u);return u*r<0&&(d-=An*$i(o)*$i(u)),[d/r,Ys((s-(o*o+u*u)*r*r)/(2*r))]},l}function Vp(){return Dy(kS).scale(155.424).center([0,33.6442])}function ES(){return Vp().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function TB(e){var t=e.length;return{point:function(n,r){for(var s=-1;++s<t;)e[s].point(n,r)},sphere:function(){for(var n=-1;++n<t;)e[n].sphere()},lineStart:function(){for(var n=-1;++n<t;)e[n].lineStart()},lineEnd:function(){for(var n=-1;++n<t;)e[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<t;)e[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<t;)e[n].polygonEnd()}}}function LB(){var e,t,n=ES(),r,s=Vp().rotate([154,0]).center([-2,58.5]).parallels([55,65]),i,l=Vp().rotate([157,0]).center([-3,19.9]).parallels([8,18]),o,c,u={point:function(m,h){c=[m,h]}};function d(m){var h=m[0],x=m[1];return c=null,r.point(h,x),c||(i.point(h,x),c)||(o.point(h,x),c)}d.invert=function(m){var h=n.scale(),x=n.translate(),y=(m[0]-x[0])/h,p=(m[1]-x[1])/h;return(p>=.12&&p<.234&&y>=-.425&&y<-.214?s:p>=.166&&p<.234&&y>=-.214&&y<-.115?l:n).invert(m)},d.stream=function(m){return e&&t===m?e:e=TB([n.stream(t=m),s.stream(m),l.stream(m)])},d.precision=function(m){return arguments.length?(n.precision(m),s.precision(m),l.precision(m),f()):n.precision()},d.scale=function(m){return arguments.length?(n.scale(m),s.scale(m*.35),l.scale(m),d.translate(n.translate())):n.scale()},d.translate=function(m){if(!arguments.length)return n.translate();var h=n.scale(),x=+m[0],y=+m[1];return r=n.translate(m).clipExtent([[x-.455*h,y-.238*h],[x+.455*h,y+.238*h]]).stream(u),i=s.translate([x-.307*h,y+.201*h]).clipExtent([[x-.425*h+ln,y+.12*h+ln],[x-.214*h-ln,y+.234*h-ln]]).stream(u),o=l.translate([x-.205*h,y+.212*h]).clipExtent([[x-.214*h+ln,y+.166*h+ln],[x-.115*h-ln,y+.234*h-ln]]).stream(u),f()},d.fitExtent=function(m,h){return U0(d,m,h)},d.fitSize=function(m,h){return Ry(d,m,h)},d.fitWidth=function(m,h){return $y(d,m,h)},d.fitHeight=function(m,h){return Fy(d,m,h)};function f(){return e=t=null,d}return d.scale(1070)}function CS(e){return function(t,n){var r=Wt(t),s=Wt(n),i=e(r*s);return i===1/0?[2,0]:[i*s*Tt(t),i*Tt(n)]}}function bh(e){return function(t,n){var r=os(t*t+n*n),s=e(r),i=Tt(s),l=Wt(s);return[Gs(t*i,r*l),Ys(r&&n*i/r)]}}var By=CS(function(e){return os(2/(1+e))});By.invert=bh(function(e){return 2*Ys(e/2)});function MB(){return Fa(By).scale(124.75).clipAngle(180-.001)}var zy=CS(function(e){return(e=J6(e))&&e/Tt(e)});zy.invert=bh(function(e){return e});function RB(){return Fa(zy).scale(79.4188).clipAngle(180-.001)}function vh(e,t){return[e,Ap(Iy((Er+t)/2))]}vh.invert=function(e,t){return[e,2*Qu(Y6(t))-Er]};function $B(){return PS(vh).scale(961/Vs)}function PS(e){var t=Fa(e),n=t.center,r=t.scale,s=t.translate,i=t.clipExtent,l=null,o,c,u;t.scale=function(f){return arguments.length?(r(f),d()):r()},t.translate=function(f){return arguments.length?(s(f),d()):s()},t.center=function(f){return arguments.length?(n(f),d()):n()},t.clipExtent=function(f){return arguments.length?(f==null?l=o=c=u=null:(l=+f[0][0],o=+f[0][1],c=+f[1][0],u=+f[1][1]),d()):l==null?null:[[l,o],[c,u]]};function d(){var f=An*r(),m=t(aS(t.rotate()).invert([0,0]));return i(l==null?[[m[0]-f,m[1]-f],[m[0]+f,m[1]+f]]:e===vh?[[Math.max(m[0]-f,l),o],[Math.min(m[0]+f,c),u]]:[[l,Math.max(m[1]-f,o)],[c,Math.min(m[1]+f,u)]])}return d()}function pm(e){return Iy((Er+e)/2)}function IS(e,t){var n=Wt(e),r=e===t?Tt(e):Ap(n/Wt(t))/Ap(pm(t)/pm(e)),s=n*h1(pm(e),r)/r;if(!r)return vh;function i(l,o){s>0?o<-Er+ln&&(o=-Er+ln):o>Er-ln&&(o=Er-ln);var c=s/h1(pm(o),r);return[c*Tt(r*l),s-c*Wt(r*l)]}return i.invert=function(l,o){var c=s-o,u=$i(r)*os(l*l+c*c),d=Gs(l,Tn(c))*$i(c);return c*r<0&&(d-=An*$i(l)*$i(c)),[d/r,2*Qu(h1(s/u,1/r))-Er]},i}function FB(){return Dy(IS).scale(109.5).parallels([30,30])}function Zf(e,t){return[e,t]}Zf.invert=Zf;function OB(){return Fa(Zf).scale(152.63)}function TS(e,t){var n=Wt(e),r=e===t?Tt(e):(n-Wt(t))/(t-e),s=n/r+e;if(Tn(r)<ln)return Zf;function i(l,o){var c=s-o,u=r*l;return[c*Tt(u),s-c*Wt(u)]}return i.invert=function(l,o){var c=s-o,u=Gs(l,Tn(c))*$i(c);return c*r<0&&(u-=An*$i(l)*$i(c)),[u/r,s-$i(r)*os(l*l+c*c)]},i}function DB(){return Dy(TS).scale(131.154).center([0,13.9389])}var jf=1.340264,Sf=-.081106,_f=893e-6,Af=.003796,Gp=os(3)/2,BB=12;function Uy(e,t){var n=Ys(Gp*Tt(t)),r=n*n,s=r*r*r;return[e*Wt(n)/(Gp*(jf+3*Sf*r+s*(7*_f+9*Af*r))),n*(jf+Sf*r+s*(_f+Af*r))]}Uy.invert=function(e,t){for(var n=t,r=n*n,s=r*r*r,i=0,l,o,c;i<BB&&(o=n*(jf+Sf*r+s*(_f+Af*r))-t,c=jf+3*Sf*r+s*(7*_f+9*Af*r),n-=l=o/c,r=n*n,s=r*r*r,!(Tn(l)<Vf));++i);return[Gp*e*(jf+3*Sf*r+s*(7*_f+9*Af*r))/Wt(n),Ys(Tt(n)/Gp)]};function zB(){return Fa(Uy).scale(177.158)}function qy(e,t){var n=Wt(t),r=Wt(e)*n;return[n*Tt(e)/r,Tt(t)/r]}qy.invert=bh(Qu);function UB(){return Fa(qy).scale(144.049).clipAngle(60)}function qB(){var e=1,t=0,n=0,r=1,s=1,i=0,l,o,c=null,u,d,f,m=1,h=1,x=yh({point:function(N,A){var P=v([N,A]);this.stream.point(P[0],P[1])}}),y=Gf,p,g;function w(){return m=e*r,h=e*s,p=g=null,v}function v(N){var A=N[0]*m,P=N[1]*h;if(i){var U=P*l-A*o;A=A*l+P*o,P=U}return[A+t,P+n]}return v.invert=function(N){var A=N[0]-t,P=N[1]-n;if(i){var U=P*l+A*o;A=A*l-P*o,P=U}return[A/m,P/h]},v.stream=function(N){return p&&g===N?p:p=x(y(g=N))},v.postclip=function(N){return arguments.length?(y=N,c=u=d=f=null,w()):y},v.clipExtent=function(N){return arguments.length?(y=N==null?(c=u=d=f=null,Gf):z0(c=+N[0][0],u=+N[0][1],d=+N[1][0],f=+N[1][1]),w()):c==null?null:[[c,u],[d,f]]},v.scale=function(N){return arguments.length?(e=+N,w()):e},v.translate=function(N){return arguments.length?(t=+N[0],n=+N[1],w()):[t,n]},v.angle=function(N){return arguments.length?(i=N%360*cn,o=Tt(i),l=Wt(i),w()):i*sr},v.reflectX=function(N){return arguments.length?(r=N?-1:1,w()):r<0},v.reflectY=function(N){return arguments.length?(s=N?-1:1,w()):s<0},v.fitExtent=function(N,A){return U0(v,N,A)},v.fitSize=function(N,A){return Ry(v,N,A)},v.fitWidth=function(N,A){return $y(v,N,A)},v.fitHeight=function(N,A){return Fy(v,N,A)},v}function Hy(e,t){var n=t*t,r=n*n;return[e*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),t*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}Hy.invert=function(e,t){var n=t,r=25,s;do{var i=n*n,l=i*i;n-=s=(n*(1.007226+i*(.015085+l*(-.044475+.028874*i-.005916*l)))-t)/(1.007226+i*(.015085*3+l*(-.044475*7+.028874*9*i-.005916*11*l)))}while(Tn(s)>ln&&--r>0);return[e/(.8707+(i=n*n)*(-.131979+i*(-.013791+i*i*i*(.003971-.001529*i)))),n]};function HB(){return Fa(Hy).scale(175.295)}function Wy(e,t){return[Wt(t)*Tt(e),Tt(t)]}Wy.invert=bh(Ys);function WB(){return Fa(Wy).scale(249.5).clipAngle(90+ln)}function Vy(e,t){var n=Wt(t),r=1+Wt(e)*n;return[n*Tt(e)/r,Tt(t)/r]}Vy.invert=bh(function(e){return 2*Qu(e)});function VB(){return Fa(Vy).scale(250).clipAngle(142)}function Gy(e,t){return[Ap(Iy((Er+t)/2)),-e]}Gy.invert=function(e,t){return[-t,2*Qu(Y6(e))-Er]};function GB(){var e=PS(Gy),t=e.center,n=e.rotate;return e.center=function(r){return arguments.length?t([-r[1],r[0]]):(r=t(),[r[1],-r[0]])},e.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)}function YB(e,t){return e.parent===t.parent?1:2}function JB(e){return e.reduce(ZB,0)/e.length}function ZB(e,t){return e+t.x}function XB(e){return 1+e.reduce(KB,0)}function KB(e,t){return Math.max(e,t.y)}function QB(e){for(var t;t=e.children;)e=t[0];return e}function ez(e){for(var t;t=e.children;)e=t[t.length-1];return e}function tz(){var e=YB,t=1,n=1,r=!1;function s(i){var l,o=0;i.eachAfter(function(m){var h=m.children;h?(m.x=JB(h),m.y=XB(h)):(m.x=l?o+=e(m,l):0,m.y=0,l=m)});var c=QB(i),u=ez(i),d=c.x-e(c,u)/2,f=u.x+e(u,c)/2;return i.eachAfter(r?function(m){m.x=(m.x-i.x)*t,m.y=(i.y-m.y)*n}:function(m){m.x=(m.x-d)/(f-d)*t,m.y=(1-(i.y?m.y/i.y:1))*n})}return s.separation=function(i){return arguments.length?(e=i,s):e},s.size=function(i){return arguments.length?(r=!1,t=+i[0],n=+i[1],s):r?null:[t,n]},s.nodeSize=function(i){return arguments.length?(r=!0,t=+i[0],n=+i[1],s):r?[t,n]:null},s}function nz(e){var t=0,n=e.children,r=n&&n.length;if(!r)t=1;else for(;--r>=0;)t+=n[r].value;e.value=t}function rz(){return this.eachAfter(nz)}function sz(e,t){let n=-1;for(const r of this)e.call(t,r,++n,this);return this}function iz(e,t){for(var n=this,r=[n],s,i,l=-1;n=r.pop();)if(e.call(t,n,++l,this),s=n.children)for(i=s.length-1;i>=0;--i)r.push(s[i]);return this}function az(e,t){for(var n=this,r=[n],s=[],i,l,o,c=-1;n=r.pop();)if(s.push(n),i=n.children)for(l=0,o=i.length;l<o;++l)r.push(i[l]);for(;n=s.pop();)e.call(t,n,++c,this);return this}function oz(e,t){let n=-1;for(const r of this)if(e.call(t,r,++n,this))return r}function lz(e){return this.eachAfter(function(t){for(var n=+e(t.data)||0,r=t.children,s=r&&r.length;--s>=0;)n+=r[s].value;t.value=n})}function cz(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})}function uz(e){for(var t=this,n=dz(t,e),r=[t];t!==n;)t=t.parent,r.push(t);for(var s=r.length;e!==n;)r.splice(s,0,e),e=e.parent;return r}function dz(e,t){if(e===t)return e;var n=e.ancestors(),r=t.ancestors(),s=null;for(e=n.pop(),t=r.pop();e===t;)s=e,e=n.pop(),t=r.pop();return s}function fz(){for(var e=this,t=[e];e=e.parent;)t.push(e);return t}function hz(){return Array.from(this)}function mz(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e}function pz(){var e=this,t=[];return e.each(function(n){n!==e&&t.push({source:n.parent,target:n})}),t}function*gz(){var e=this,t,n=[e],r,s,i;do for(t=n.reverse(),n=[];e=t.pop();)if(yield e,r=e.children)for(s=0,i=r.length;s<i;++s)n.push(r[s]);while(n.length)}function Yy(e,t){e instanceof Map?(e=[void 0,e],t===void 0&&(t=bz)):t===void 0&&(t=yz);for(var n=new Fu(e),r,s=[n],i,l,o,c;r=s.pop();)if((l=t(r.data))&&(c=(l=Array.from(l)).length))for(r.children=l,o=c-1;o>=0;--o)s.push(i=l[o]=new Fu(l[o])),i.parent=r,i.depth=r.depth+1;return n.eachBefore(LS)}function xz(){return Yy(this).eachBefore(vz)}function yz(e){return e.children}function bz(e){return Array.isArray(e)?e[1]:null}function vz(e){e.data.value!==void 0&&(e.value=e.data.value),e.data=e.data.data}function LS(e){var t=0;do e.height=t;while((e=e.parent)&&e.height<++t)}function Fu(e){this.data=e,this.depth=this.height=0,this.parent=null}Fu.prototype=Yy.prototype={constructor:Fu,count:rz,each:sz,eachAfter:az,eachBefore:iz,find:oz,sum:lz,sort:cz,path:uz,ancestors:fz,descendants:hz,leaves:mz,links:pz,copy:xz,[Symbol.iterator]:gz};function wz(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function Nz(e){for(var t=e.length,n,r;t;)r=Math.random()*t--|0,n=e[t],e[t]=e[r],e[r]=n;return e}function MS(e){for(var t=0,n=(e=Nz(Array.from(e))).length,r=[],s,i;t<n;)s=e[t],i&&RS(i,s)?++t:(i=Sz(r=jz(r,s)),t=0);return i}function jz(e,t){var n,r;if(y1(t,e))return[t];for(n=0;n<e.length;++n)if(gm(t,e[n])&&y1(mf(e[n],t),e))return[e[n],t];for(n=0;n<e.length-1;++n)for(r=n+1;r<e.length;++r)if(gm(mf(e[n],e[r]),t)&&gm(mf(e[n],t),e[r])&&gm(mf(e[r],t),e[n])&&y1($S(e[n],e[r],t),e))return[e[n],e[r],t];throw new Error}function gm(e,t){var n=e.r-t.r,r=t.x-e.x,s=t.y-e.y;return n<0||n*n<r*r+s*s}function RS(e,t){var n=e.r-t.r+Math.max(e.r,t.r,1)*1e-9,r=t.x-e.x,s=t.y-e.y;return n>0&&n*n>r*r+s*s}function y1(e,t){for(var n=0;n<t.length;++n)if(!RS(e,t[n]))return!1;return!0}function Sz(e){switch(e.length){case 1:return _z(e[0]);case 2:return mf(e[0],e[1]);case 3:return $S(e[0],e[1],e[2])}}function _z(e){return{x:e.x,y:e.y,r:e.r}}function mf(e,t){var n=e.x,r=e.y,s=e.r,i=t.x,l=t.y,o=t.r,c=i-n,u=l-r,d=o-s,f=Math.sqrt(c*c+u*u);return{x:(n+i+c/f*d)/2,y:(r+l+u/f*d)/2,r:(f+s+o)/2}}function $S(e,t,n){var r=e.x,s=e.y,i=e.r,l=t.x,o=t.y,c=t.r,u=n.x,d=n.y,f=n.r,m=r-l,h=r-u,x=s-o,y=s-d,p=c-i,g=f-i,w=r*r+s*s-i*i,v=w-l*l-o*o+c*c,N=w-u*u-d*d+f*f,A=h*x-m*y,P=(x*N-y*v)/(A*2)-r,U=(y*p-x*g)/A,M=(h*v-m*N)/(A*2)-s,S=(m*g-h*p)/A,C=U*U+S*S-1,_=2*(i+P*U+M*S),T=P*P+M*M-i*i,B=-(C?(_+Math.sqrt(_*_-4*C*T))/(2*C):T/_);return{x:r+P+U*B,y:s+M+S*B,r:B}}function _w(e,t,n){var r=e.x-t.x,s,i,l=e.y-t.y,o,c,u=r*r+l*l;u?(i=t.r+n.r,i*=i,c=e.r+n.r,c*=c,i>c?(s=(u+c-i)/(2*u),o=Math.sqrt(Math.max(0,c/u-s*s)),n.x=e.x-s*r-o*l,n.y=e.y-s*l+o*r):(s=(u+i-c)/(2*u),o=Math.sqrt(Math.max(0,i/u-s*s)),n.x=t.x+s*r-o*l,n.y=t.y+s*l+o*r)):(n.x=t.x+n.r,n.y=t.y)}function Aw(e,t){var n=e.r+t.r-1e-6,r=t.x-e.x,s=t.y-e.y;return n>0&&n*n>r*r+s*s}function kw(e){var t=e._,n=e.next._,r=t.r+n.r,s=(t.x*n.r+n.x*t.r)/r,i=(t.y*n.r+n.y*t.r)/r;return s*s+i*i}function xm(e){this._=e,this.next=null,this.previous=null}function FS(e){if(!(s=(e=wz(e)).length))return 0;var t,n,r,s,i,l,o,c,u,d,f;if(t=e[0],t.x=0,t.y=0,!(s>1))return t.r;if(n=e[1],t.x=-n.r,n.x=t.r,n.y=0,!(s>2))return t.r+n.r;_w(n,t,r=e[2]),t=new xm(t),n=new xm(n),r=new xm(r),t.next=r.previous=n,n.next=t.previous=r,r.next=n.previous=t;e:for(o=3;o<s;++o){_w(t._,n._,r=e[o]),r=new xm(r),c=n.next,u=t.previous,d=n._.r,f=t._.r;do if(d<=f){if(Aw(c._,r._)){n=c,t.next=n,n.previous=t,--o;continue e}d+=c._.r,c=c.next}else{if(Aw(u._,r._)){t=u,t.next=n,n.previous=t,--o;continue e}f+=u._.r,u=u.previous}while(c!==u.next);for(r.previous=t,r.next=n,t.next=n.previous=n=r,i=kw(t);(r=r.next)!==n;)(l=kw(r))<i&&(t=r,i=l);n=t.next}for(t=[n._],r=n;(r=r.next)!==n;)t.push(r._);for(r=MS(t),o=0;o<s;++o)t=e[o],t.x-=r.x,t.y-=r.y;return r.r}function Az(e){return FS(e),e}function kz(e){return e==null?null:Yp(e)}function Yp(e){if(typeof e!="function")throw new Error;return e}function Ol(){return 0}function tu(e){return function(){return e}}function Ez(e){return Math.sqrt(e.value)}function Cz(){var e=null,t=1,n=1,r=Ol;function s(i){return i.x=t/2,i.y=n/2,e?i.eachBefore(Ew(e)).eachAfter(b1(r,.5)).eachBefore(Cw(1)):i.eachBefore(Ew(Ez)).eachAfter(b1(Ol,1)).eachAfter(b1(r,i.r/Math.min(t,n))).eachBefore(Cw(Math.min(t,n)/(2*i.r))),i}return s.radius=function(i){return arguments.length?(e=kz(i),s):e},s.size=function(i){return arguments.length?(t=+i[0],n=+i[1],s):[t,n]},s.padding=function(i){return arguments.length?(r=typeof i=="function"?i:tu(+i),s):r},s}function Ew(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function b1(e,t){return function(n){if(r=n.children){var r,s,i=r.length,l=e(n)*t||0,o;if(l)for(s=0;s<i;++s)r[s].r+=l;if(o=FS(r),l)for(s=0;s<i;++s)r[s].r-=l;n.r=o+l}}}function Cw(e){return function(t){var n=t.parent;t.r*=e,n&&(t.x=n.x+e*t.x,t.y=n.y+e*t.y)}}function OS(e){e.x0=Math.round(e.x0),e.y0=Math.round(e.y0),e.x1=Math.round(e.x1),e.y1=Math.round(e.y1)}function wh(e,t,n,r,s){for(var i=e.children,l,o=-1,c=i.length,u=e.value&&(r-t)/e.value;++o<c;)l=i[o],l.y0=n,l.y1=s,l.x0=t,l.x1=t+=l.value*u}function Pz(){var e=1,t=1,n=0,r=!1;function s(l){var o=l.height+1;return l.x0=l.y0=n,l.x1=e,l.y1=t/o,l.eachBefore(i(t,o)),r&&l.eachBefore(OS),l}function i(l,o){return function(c){c.children&&wh(c,c.x0,l*(c.depth+1)/o,c.x1,l*(c.depth+2)/o);var u=c.x0,d=c.y0,f=c.x1-n,m=c.y1-n;f<u&&(u=f=(u+f)/2),m<d&&(d=m=(d+m)/2),c.x0=u,c.y0=d,c.x1=f,c.y1=m}}return s.round=function(l){return arguments.length?(r=!!l,s):r},s.size=function(l){return arguments.length?(e=+l[0],t=+l[1],s):[e,t]},s.padding=function(l){return arguments.length?(n=+l,s):n},s}var Iz={depth:-1},Pw={};function Tz(e){return e.id}function Lz(e){return e.parentId}function Mz(){var e=Tz,t=Lz;function n(r){var s=Array.from(r),i=s.length,l,o,c,u,d,f,m,h=new Map;for(o=0;o<i;++o)l=s[o],d=s[o]=new Fu(l),(f=e(l,o,r))!=null&&(f+="")&&(m=d.id=f,h.set(m,h.has(m)?Pw:d)),(f=t(l,o,r))!=null&&(f+="")&&(d.parent=f);for(o=0;o<i;++o)if(d=s[o],f=d.parent){if(u=h.get(f),!u)throw new Error("missing: "+f);if(u===Pw)throw new Error("ambiguous: "+f);u.children?u.children.push(d):u.children=[d],d.parent=u}else{if(c)throw new Error("multiple roots");c=d}if(!c)throw new Error("no root");if(c.parent=Iz,c.eachBefore(function(x){x.depth=x.parent.depth+1,--i}).eachBefore(LS),c.parent=null,i>0)throw new Error("cycle");return c}return n.id=function(r){return arguments.length?(e=Yp(r),n):e},n.parentId=function(r){return arguments.length?(t=Yp(r),n):t},n}function Rz(e,t){return e.parent===t.parent?1:2}function v1(e){var t=e.children;return t?t[0]:e.t}function w1(e){var t=e.children;return t?t[t.length-1]:e.t}function $z(e,t,n){var r=n/(t.i-e.i);t.c-=r,t.s+=n,e.c+=r,t.z+=n,t.m+=n}function Fz(e){for(var t=0,n=0,r=e.children,s=r.length,i;--s>=0;)i=r[s],i.z+=t,i.m+=t,t+=i.s+(n+=i.c)}function Oz(e,t,n){return e.a.parent===t.parent?e.a:n}function tp(e,t){this._=e,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=t}tp.prototype=Object.create(Fu.prototype);function Dz(e){for(var t=new tp(e,0),n,r=[t],s,i,l,o;n=r.pop();)if(i=n._.children)for(n.children=new Array(o=i.length),l=o-1;l>=0;--l)r.push(s=n.children[l]=new tp(i[l],l)),s.parent=n;return(t.parent=new tp(null,0)).children=[t],t}function Bz(){var e=Rz,t=1,n=1,r=null;function s(u){var d=Dz(u);if(d.eachAfter(i),d.parent.m=-d.z,d.eachBefore(l),r)u.eachBefore(c);else{var f=u,m=u,h=u;u.eachBefore(function(w){w.x<f.x&&(f=w),w.x>m.x&&(m=w),w.depth>h.depth&&(h=w)});var x=f===m?1:e(f,m)/2,y=x-f.x,p=t/(m.x+x+y),g=n/(h.depth||1);u.eachBefore(function(w){w.x=(w.x+y)*p,w.y=w.depth*g})}return u}function i(u){var d=u.children,f=u.parent.children,m=u.i?f[u.i-1]:null;if(d){Fz(u);var h=(d[0].z+d[d.length-1].z)/2;m?(u.z=m.z+e(u._,m._),u.m=u.z-h):u.z=h}else m&&(u.z=m.z+e(u._,m._));u.parent.A=o(u,m,u.parent.A||f[0])}function l(u){u._.x=u.z+u.parent.m,u.m+=u.parent.m}function o(u,d,f){if(d){for(var m=u,h=u,x=d,y=m.parent.children[0],p=m.m,g=h.m,w=x.m,v=y.m,N;x=w1(x),m=v1(m),x&&m;)y=v1(y),h=w1(h),h.a=u,N=x.z+w-m.z-p+e(x._,m._),N>0&&($z(Oz(x,u,f),u,N),p+=N,g+=N),w+=x.m,p+=m.m,v+=y.m,g+=h.m;x&&!w1(h)&&(h.t=x,h.m+=w-g),m&&!v1(y)&&(y.t=m,y.m+=p-v,f=u)}return f}function c(u){u.x*=t,u.y=u.depth*n}return s.separation=function(u){return arguments.length?(e=u,s):e},s.size=function(u){return arguments.length?(r=!1,t=+u[0],n=+u[1],s):r?null:[t,n]},s.nodeSize=function(u){return arguments.length?(r=!0,t=+u[0],n=+u[1],s):r?[t,n]:null},s}function q0(e,t,n,r,s){for(var i=e.children,l,o=-1,c=i.length,u=e.value&&(s-n)/e.value;++o<c;)l=i[o],l.x0=t,l.x1=r,l.y0=n,l.y1=n+=l.value*u}var DS=(1+Math.sqrt(5))/2;function BS(e,t,n,r,s,i){for(var l=[],o=t.children,c,u,d=0,f=0,m=o.length,h,x,y=t.value,p,g,w,v,N,A,P;d<m;){h=s-n,x=i-r;do p=o[f++].value;while(!p&&f<m);for(g=w=p,A=Math.max(x/h,h/x)/(y*e),P=p*p*A,N=Math.max(w/P,P/g);f<m;++f){if(p+=u=o[f].value,u<g&&(g=u),u>w&&(w=u),P=p*p*A,v=Math.max(w/P,P/g),v>N){p-=u;break}N=v}l.push(c={value:p,dice:h<x,children:o.slice(d,f)}),c.dice?wh(c,n,r,s,y?r+=x*p/y:i):q0(c,n,r,y?n+=h*p/y:s,i),y-=p,d=f}return l}const zS=function e(t){function n(r,s,i,l,o){BS(t,r,s,i,l,o)}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(DS);function zz(){var e=zS,t=!1,n=1,r=1,s=[0],i=Ol,l=Ol,o=Ol,c=Ol,u=Ol;function d(m){return m.x0=m.y0=0,m.x1=n,m.y1=r,m.eachBefore(f),s=[0],t&&m.eachBefore(OS),m}function f(m){var h=s[m.depth],x=m.x0+h,y=m.y0+h,p=m.x1-h,g=m.y1-h;p<x&&(x=p=(x+p)/2),g<y&&(y=g=(y+g)/2),m.x0=x,m.y0=y,m.x1=p,m.y1=g,m.children&&(h=s[m.depth+1]=i(m)/2,x+=u(m)-h,y+=l(m)-h,p-=o(m)-h,g-=c(m)-h,p<x&&(x=p=(x+p)/2),g<y&&(y=g=(y+g)/2),e(m,x,y,p,g))}return d.round=function(m){return arguments.length?(t=!!m,d):t},d.size=function(m){return arguments.length?(n=+m[0],r=+m[1],d):[n,r]},d.tile=function(m){return arguments.length?(e=Yp(m),d):e},d.padding=function(m){return arguments.length?d.paddingInner(m).paddingOuter(m):d.paddingInner()},d.paddingInner=function(m){return arguments.length?(i=typeof m=="function"?m:tu(+m),d):i},d.paddingOuter=function(m){return arguments.length?d.paddingTop(m).paddingRight(m).paddingBottom(m).paddingLeft(m):d.paddingTop()},d.paddingTop=function(m){return arguments.length?(l=typeof m=="function"?m:tu(+m),d):l},d.paddingRight=function(m){return arguments.length?(o=typeof m=="function"?m:tu(+m),d):o},d.paddingBottom=function(m){return arguments.length?(c=typeof m=="function"?m:tu(+m),d):c},d.paddingLeft=function(m){return arguments.length?(u=typeof m=="function"?m:tu(+m),d):u},d}function Uz(e,t,n,r,s){var i=e.children,l,o=i.length,c,u=new Array(o+1);for(u[0]=c=l=0;l<o;++l)u[l+1]=c+=i[l].value;d(0,o,e.value,t,n,r,s);function d(f,m,h,x,y,p,g){if(f>=m-1){var w=i[f];w.x0=x,w.y0=y,w.x1=p,w.y1=g;return}for(var v=u[f],N=h/2+v,A=f+1,P=m-1;A<P;){var U=A+P>>>1;u[U]<N?A=U+1:P=U}N-u[A-1]<u[A]-N&&f+1<A&&--A;var M=u[A]-v,S=h-M;if(p-x>g-y){var C=h?(x*S+p*M)/h:p;d(f,A,M,x,y,C,g),d(A,m,S,C,y,p,g)}else{var _=h?(y*S+g*M)/h:g;d(f,A,M,x,y,p,_),d(A,m,S,x,_,p,g)}}}function qz(e,t,n,r,s){(e.depth&1?q0:wh)(e,t,n,r,s)}const Hz=function e(t){function n(r,s,i,l,o){if((c=r._squarify)&&c.ratio===t)for(var c,u,d,f,m=-1,h,x=c.length,y=r.value;++m<x;){for(u=c[m],d=u.children,f=u.value=0,h=d.length;f<h;++f)u.value+=d[f].value;u.dice?wh(u,s,i,l,y?i+=(o-i)*u.value/y:o):q0(u,s,i,y?s+=(l-s)*u.value/y:l,o),y-=u.value}else r._squarify=c=BS(t,r,s,i,l,o),c.ratio=t}return n.ratio=function(r){return e((r=+r)>1?r:1)},n}(DS);function Wz(e){for(var t=-1,n=e.length,r,s=e[n-1],i=0;++t<n;)r=s,s=e[t],i+=r[1]*s[0]-r[0]*s[1];return i/2}function Vz(e){for(var t=-1,n=e.length,r=0,s=0,i,l=e[n-1],o,c=0;++t<n;)i=l,l=e[t],c+=o=i[0]*l[1]-l[0]*i[1],r+=(i[0]+l[0])*o,s+=(i[1]+l[1])*o;return c*=3,[r/c,s/c]}function Gz(e,t,n){return(t[0]-e[0])*(n[1]-e[1])-(t[1]-e[1])*(n[0]-e[0])}function Yz(e,t){return e[0]-t[0]||e[1]-t[1]}function Iw(e){const t=e.length,n=[0,1];let r=2,s;for(s=2;s<t;++s){for(;r>1&&Gz(e[n[r-2]],e[n[r-1]],e[s])<=0;)--r;n[r++]=s}return n.slice(0,r)}function Jz(e){if((n=e.length)<3)return null;var t,n,r=new Array(n),s=new Array(n);for(t=0;t<n;++t)r[t]=[+e[t][0],+e[t][1],t];for(r.sort(Yz),t=0;t<n;++t)s[t]=[r[t][0],-r[t][1]];var i=Iw(r),l=Iw(s),o=l[0]===i[0],c=l[l.length-1]===i[i.length-1],u=[];for(t=i.length-1;t>=0;--t)u.push(e[r[i[t]][2]]);for(t=+o;t<l.length-c;++t)u.push(e[r[l[t]][2]]);return u}function Zz(e,t){for(var n=e.length,r=e[n-1],s=t[0],i=t[1],l=r[0],o=r[1],c,u,d=!1,f=0;f<n;++f)r=e[f],c=r[0],u=r[1],u>i!=o>i&&s<(l-c)*(i-u)/(o-u)+c&&(d=!d),l=c,o=u;return d}function Xz(e){for(var t=-1,n=e.length,r=e[n-1],s,i,l=r[0],o=r[1],c=0;++t<n;)s=l,i=o,r=e[t],l=r[0],o=r[1],s-=l,i-=o,c+=Math.hypot(s,i);return c}const vs=Math.random,Kz=function e(t){function n(r,s){return r=r==null?0:+r,s=s==null?1:+s,arguments.length===1?(s=r,r=0):s-=r,function(){return t()*s+r}}return n.source=e,n}(vs),Qz=function e(t){function n(r,s){return arguments.length<2&&(s=r,r=0),r=Math.floor(r),s=Math.floor(s)-r,function(){return Math.floor(t()*s+r)}}return n.source=e,n}(vs),Jy=function e(t){function n(r,s){var i,l;return r=r==null?0:+r,s=s==null?1:+s,function(){var o;if(i!=null)o=i,i=null;else do i=t()*2-1,o=t()*2-1,l=i*i+o*o;while(!l||l>1);return r+s*o*Math.sqrt(-2*Math.log(l)/l)}}return n.source=e,n}(vs),eU=function e(t){var n=Jy.source(t);function r(){var s=n.apply(this,arguments);return function(){return Math.exp(s())}}return r.source=e,r}(vs),US=function e(t){function n(r){return(r=+r)<=0?()=>0:function(){for(var s=0,i=r;i>1;--i)s+=t();return s+i*t()}}return n.source=e,n}(vs),tU=function e(t){var n=US.source(t);function r(s){if((s=+s)==0)return t;var i=n(s);return function(){return i()/s}}return r.source=e,r}(vs),nU=function e(t){function n(r){return function(){return-Math.log1p(-t())/r}}return n.source=e,n}(vs),rU=function e(t){function n(r){if((r=+r)<0)throw new RangeError("invalid alpha");return r=1/-r,function(){return Math.pow(1-t(),r)}}return n.source=e,n}(vs),sU=function e(t){function n(r){if((r=+r)<0||r>1)throw new RangeError("invalid p");return function(){return Math.floor(t()+r)}}return n.source=e,n}(vs),qS=function e(t){function n(r){if((r=+r)<0||r>1)throw new RangeError("invalid p");return r===0?()=>1/0:r===1?()=>1:(r=Math.log1p(-r),function(){return 1+Math.floor(Math.log1p(-t())/r)})}return n.source=e,n}(vs),Zy=function e(t){var n=Jy.source(t)();function r(s,i){if((s=+s)<0)throw new RangeError("invalid k");if(s===0)return()=>0;if(i=i==null?1:+i,s===1)return()=>-Math.log1p(-t())*i;var l=(s<1?s+1:s)-1/3,o=1/(3*Math.sqrt(l)),c=s<1?()=>Math.pow(t(),1/s):()=>1;return function(){do{do var u=n(),d=1+o*u;while(d<=0);d*=d*d;var f=1-t()}while(f>=1-.0331*u*u*u*u&&Math.log(f)>=.5*u*u+l*(1-d+Math.log(d)));return l*d*c()*i}}return r.source=e,r}(vs),HS=function e(t){var n=Zy.source(t);function r(s,i){var l=n(s),o=n(i);return function(){var c=l();return c===0?0:c/(c+o())}}return r.source=e,r}(vs),WS=function e(t){var n=qS.source(t),r=HS.source(t);function s(i,l){return i=+i,(l=+l)>=1?()=>i:l<=0?()=>0:function(){for(var o=0,c=i,u=l;c*u>16&&c*(1-u)>16;){var d=Math.floor((c+1)*u),f=r(d,c-d+1)();f<=u?(o+=d,c-=d,u=(u-f)/(1-f)):(c=d-1,u/=f)}for(var m=u<.5,h=m?u:1-u,x=n(h),y=x(),p=0;y<=c;++p)y+=x();return o+(m?p:c-p)}}return s.source=e,s}(vs),iU=function e(t){function n(r,s,i){var l;return(r=+r)==0?l=o=>-Math.log(o):(r=1/r,l=o=>Math.pow(o,r)),s=s==null?0:+s,i=i==null?1:+i,function(){return s+i*l(-Math.log1p(-t()))}}return n.source=e,n}(vs),aU=function e(t){function n(r,s){return r=r==null?0:+r,s=s==null?1:+s,function(){return r+s*Math.tan(Math.PI*t())}}return n.source=e,n}(vs),oU=function e(t){function n(r,s){return r=r==null?0:+r,s=s==null?1:+s,function(){var i=t();return r+s*Math.log(i/(1-i))}}return n.source=e,n}(vs),lU=function e(t){var n=Zy.source(t),r=WS.source(t);function s(i){return function(){for(var l=0,o=i;o>16;){var c=Math.floor(.875*o),u=n(c)();if(u>o)return l+r(c-1,o/u)();l+=c,o-=u}for(var d=-Math.log1p(-t()),f=0;d<=o;++f)d-=Math.log1p(-t());return l+f}}return s.source=e,s}(vs),cU=1664525,uU=1013904223,Tw=1/4294967296;function dU(e=Math.random()){let t=(0<=e&&e<1?e/Tw:Math.abs(e))|0;return()=>(t=cU*t+uU|0,Tw*(t>>>0))}function qi(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function yo(e,t){switch(arguments.length){case 0:break;case 1:{typeof e=="function"?this.interpolator(e):this.range(e);break}default:{this.domain(e),typeof t=="function"?this.interpolator(t):this.range(t);break}}return this}const y2=Symbol("implicit");function Xy(){var e=new Map,t=[],n=[],r=y2;function s(i){var l=i+"",o=e.get(l);if(!o){if(r!==y2)return r;e.set(l,o=t.push(i))}return n[(o-1)%n.length]}return s.domain=function(i){if(!arguments.length)return t.slice();t=[],e=new Map;for(const l of i){const o=l+"";e.has(o)||e.set(o,t.push(l))}return s},s.range=function(i){return arguments.length?(n=Array.from(i),s):n.slice()},s.unknown=function(i){return arguments.length?(r=i,s):r},s.copy=function(){return Xy(t,n).unknown(r)},qi.apply(s,arguments),s}function Ky(){var e=Xy().unknown(void 0),t=e.domain,n=e.range,r=0,s=1,i,l,o=!1,c=0,u=0,d=.5;delete e.unknown;function f(){var m=t().length,h=s<r,x=h?s:r,y=h?r:s;i=(y-x)/Math.max(1,m-c+u*2),o&&(i=Math.floor(i)),x+=(y-x-i*(m-c))*d,l=i*(1-c),o&&(x=Math.round(x),l=Math.round(l));var p=Aa(m).map(function(g){return x+i*g});return n(h?p.reverse():p)}return e.domain=function(m){return arguments.length?(t(m),f()):t()},e.range=function(m){return arguments.length?([r,s]=m,r=+r,s=+s,f()):[r,s]},e.rangeRound=function(m){return[r,s]=m,r=+r,s=+s,o=!0,f()},e.bandwidth=function(){return l},e.step=function(){return i},e.round=function(m){return arguments.length?(o=!!m,f()):o},e.padding=function(m){return arguments.length?(c=Math.min(1,u=+m),f()):c},e.paddingInner=function(m){return arguments.length?(c=Math.min(1,m),f()):c},e.paddingOuter=function(m){return arguments.length?(u=+m,f()):u},e.align=function(m){return arguments.length?(d=Math.max(0,Math.min(1,m)),f()):d},e.copy=function(){return Ky(t(),[r,s]).round(o).paddingInner(c).paddingOuter(u).align(d)},qi.apply(f(),arguments)}function VS(e){var t=e.copy;return e.padding=e.paddingOuter,delete e.paddingInner,delete e.paddingOuter,e.copy=function(){return VS(t())},e}function fU(){return VS(Ky.apply(null,arguments).paddingInner(1))}function hU(e){return function(){return e}}function Jp(e){return+e}var Lw=[0,1];function Ws(e){return e}function b2(e,t){return(t-=e=+e)?function(n){return(n-e)/t}:hU(isNaN(t)?NaN:.5)}function mU(e,t){var n;return e>t&&(n=e,e=t,t=n),function(r){return Math.max(e,Math.min(t,r))}}function pU(e,t,n){var r=e[0],s=e[1],i=t[0],l=t[1];return s<r?(r=b2(s,r),i=n(l,i)):(r=b2(r,s),i=n(i,l)),function(o){return i(r(o))}}function gU(e,t,n){var r=Math.min(e.length,t.length)-1,s=new Array(r),i=new Array(r),l=-1;for(e[r]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++l<r;)s[l]=b2(e[l],e[l+1]),i[l]=n(t[l],t[l+1]);return function(o){var c=el(e,o,1,r)-1;return i[c](s[c](o))}}function Nh(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function H0(){var e=Lw,t=Lw,n=ll,r,s,i,l=Ws,o,c,u;function d(){var m=Math.min(e.length,t.length);return l!==Ws&&(l=mU(e[0],e[m-1])),o=m>2?gU:pU,c=u=null,f}function f(m){return m==null||isNaN(m=+m)?i:(c||(c=o(e.map(r),t,n)))(r(l(m)))}return f.invert=function(m){return l(s((u||(u=o(t,e.map(r),Mi)))(m)))},f.domain=function(m){return arguments.length?(e=Array.from(m,Jp),d()):e.slice()},f.range=function(m){return arguments.length?(t=Array.from(m),d()):t.slice()},f.rangeRound=function(m){return t=Array.from(m),n=I0,d()},f.clamp=function(m){return arguments.length?(l=m?!0:Ws,d()):l!==Ws},f.interpolate=function(m){return arguments.length?(n=m,d()):n},f.unknown=function(m){return arguments.length?(i=m,f):i},function(m,h){return r=m,s=h,d()}}function Qy(){return H0()(Ws,Ws)}function GS(e,t,n,r){var s=Eu(e,t,n),i;switch(r=Wf(r??",f"),r.type){case"s":{var l=Math.max(Math.abs(e),Math.abs(t));return r.precision==null&&!isNaN(i=V6(s,l))&&(r.precision=i),Py(r,l)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(i=G6(s,Math.max(Math.abs(e),Math.abs(t))))&&(r.precision=i-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(i=W6(s))&&(r.precision=i-(r.type==="%")*2);break}}return B0(r)}function ul(e){var t=e.domain;return e.ticks=function(n){var r=t();return $f(r[0],r[r.length-1],n??10)},e.tickFormat=function(n,r){var s=t();return GS(s[0],s[s.length-1],n??10,r)},e.nice=function(n){n==null&&(n=10);var r=t(),s=0,i=r.length-1,l=r[s],o=r[i],c,u,d=10;for(o<l&&(u=l,l=o,o=u,u=s,s=i,i=u);d-- >0;){if(u=hh(l,o,n),u===c)return r[s]=l,r[i]=o,t(r);if(u>0)l=Math.floor(l/u)*u,o=Math.ceil(o/u)*u;else if(u<0)l=Math.ceil(l*u)/u,o=Math.floor(o*u)/u;else break;c=u}return e},e}function YS(){var e=Qy();return e.copy=function(){return Nh(e,YS())},qi.apply(e,arguments),ul(e)}function JS(e){var t;function n(r){return r==null||isNaN(r=+r)?t:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(e=Array.from(r,Jp),n):e.slice()},n.unknown=function(r){return arguments.length?(t=r,n):t},n.copy=function(){return JS(e).unknown(t)},e=arguments.length?Array.from(e,Jp):[0,1],ul(n)}function ZS(e,t){e=e.slice();var n=0,r=e.length-1,s=e[n],i=e[r],l;return i<s&&(l=n,n=r,r=l,l=s,s=i,i=l),e[n]=t.floor(s),e[r]=t.ceil(i),e}function Mw(e){return Math.log(e)}function Rw(e){return Math.exp(e)}function xU(e){return-Math.log(-e)}function yU(e){return-Math.exp(-e)}function bU(e){return isFinite(e)?+("1e"+e):e<0?0:e}function vU(e){return e===10?bU:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function wU(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function $w(e){return function(t){return-e(-t)}}function eb(e){var t=e(Mw,Rw),n=t.domain,r=10,s,i;function l(){return s=wU(r),i=vU(r),n()[0]<0?(s=$w(s),i=$w(i),e(xU,yU)):e(Mw,Rw),t}return t.base=function(o){return arguments.length?(r=+o,l()):r},t.domain=function(o){return arguments.length?(n(o),l()):n()},t.ticks=function(o){var c=n(),u=c[0],d=c[c.length-1],f;(f=d<u)&&(m=u,u=d,d=m);var m=s(u),h=s(d),x,y,p,g=o==null?10:+o,w=[];if(!(r%1)&&h-m<g){if(m=Math.floor(m),h=Math.ceil(h),u>0){for(;m<=h;++m)for(y=1,x=i(m);y<r;++y)if(p=x*y,!(p<u)){if(p>d)break;w.push(p)}}else for(;m<=h;++m)for(y=r-1,x=i(m);y>=1;--y)if(p=x*y,!(p<u)){if(p>d)break;w.push(p)}w.length*2<g&&(w=$f(u,d,g))}else w=$f(m,h,Math.min(h-m,g)).map(i);return f?w.reverse():w},t.tickFormat=function(o,c){if(c==null&&(c=r===10?".0e":","),typeof c!="function"&&(c=B0(c)),o===1/0)return c;o==null&&(o=10);var u=Math.max(1,r*o/t.ticks().length);return function(d){var f=d/i(Math.round(s(d)));return f*r<r-.5&&(f*=r),f<=u?c(d):""}},t.nice=function(){return n(ZS(n(),{floor:function(o){return i(Math.floor(s(o)))},ceil:function(o){return i(Math.ceil(s(o)))}}))},t}function XS(){var e=eb(H0()).domain([1,10]);return e.copy=function(){return Nh(e,XS()).base(e.base())},qi.apply(e,arguments),e}function Fw(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Ow(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function tb(e){var t=1,n=e(Fw(t),Ow(t));return n.constant=function(r){return arguments.length?e(Fw(t=+r),Ow(t)):t},ul(n)}function KS(){var e=tb(H0());return e.copy=function(){return Nh(e,KS()).constant(e.constant())},qi.apply(e,arguments)}function Dw(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function NU(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function jU(e){return e<0?-e*e:e*e}function nb(e){var t=e(Ws,Ws),n=1;function r(){return n===1?e(Ws,Ws):n===.5?e(NU,jU):e(Dw(n),Dw(1/n))}return t.exponent=function(s){return arguments.length?(n=+s,r()):n},ul(t)}function rb(){var e=nb(H0());return e.copy=function(){return Nh(e,rb()).exponent(e.exponent())},qi.apply(e,arguments),e}function SU(){return rb.apply(null,arguments).exponent(.5)}function Bw(e){return Math.sign(e)*e*e}function _U(e){return Math.sign(e)*Math.sqrt(Math.abs(e))}function QS(){var e=Qy(),t=[0,1],n=!1,r;function s(i){var l=_U(e(i));return isNaN(l)?r:n?Math.round(l):l}return s.invert=function(i){return e.invert(Bw(i))},s.domain=function(i){return arguments.length?(e.domain(i),s):e.domain()},s.range=function(i){return arguments.length?(e.range((t=Array.from(i,Jp)).map(Bw)),s):t.slice()},s.rangeRound=function(i){return s.range(i).round(!0)},s.round=function(i){return arguments.length?(n=!!i,s):n},s.clamp=function(i){return arguments.length?(e.clamp(i),s):e.clamp()},s.unknown=function(i){return arguments.length?(r=i,s):r},s.copy=function(){return QS(e.domain(),t).round(n).clamp(e.clamp()).unknown(r)},qi.apply(s,arguments),ul(s)}function e_(){var e=[],t=[],n=[],r;function s(){var l=0,o=Math.max(1,t.length);for(n=new Array(o-1);++l<o;)n[l-1]=Cj(e,l/o);return i}function i(l){return l==null||isNaN(l=+l)?r:t[el(n,l)]}return i.invertExtent=function(l){var o=t.indexOf(l);return o<0?[NaN,NaN]:[o>0?n[o-1]:e[0],o<n.length?n[o]:e[e.length-1]]},i.domain=function(l){if(!arguments.length)return e.slice();e=[];for(let o of l)o!=null&&!isNaN(o=+o)&&e.push(o);return e.sort(Vr),s()},i.range=function(l){return arguments.length?(t=Array.from(l),s()):t.slice()},i.unknown=function(l){return arguments.length?(r=l,i):r},i.quantiles=function(){return n.slice()},i.copy=function(){return e_().domain(e).range(t).unknown(r)},qi.apply(i,arguments)}function t_(){var e=0,t=1,n=1,r=[.5],s=[0,1],i;function l(c){return c!=null&&c<=c?s[el(r,c,0,n)]:i}function o(){var c=-1;for(r=new Array(n);++c<n;)r[c]=((c+1)*t-(c-n)*e)/(n+1);return l}return l.domain=function(c){return arguments.length?([e,t]=c,e=+e,t=+t,o()):[e,t]},l.range=function(c){return arguments.length?(n=(s=Array.from(c)).length-1,o()):s.slice()},l.invertExtent=function(c){var u=s.indexOf(c);return u<0?[NaN,NaN]:u<1?[e,r[0]]:u>=n?[r[n-1],t]:[r[u-1],r[u]]},l.unknown=function(c){return arguments.length&&(i=c),l},l.thresholds=function(){return r.slice()},l.copy=function(){return t_().domain([e,t]).range(s).unknown(i)},qi.apply(ul(l),arguments)}function n_(){var e=[.5],t=[0,1],n,r=1;function s(i){return i!=null&&i<=i?t[el(e,i,0,r)]:n}return s.domain=function(i){return arguments.length?(e=Array.from(i),r=Math.min(e.length,t.length-1),s):e.slice()},s.range=function(i){return arguments.length?(t=Array.from(i),r=Math.min(e.length,t.length-1),s):t.slice()},s.invertExtent=function(i){var l=t.indexOf(i);return[e[l-1],e[l]]},s.unknown=function(i){return arguments.length?(n=i,s):n},s.copy=function(){return n_().domain(e).range(t).unknown(n)},qi.apply(s,arguments)}var N1=new Date,j1=new Date;function rs(e,t,n,r){function s(i){return e(i=arguments.length===0?new Date:new Date(+i)),i}return s.floor=function(i){return e(i=new Date(+i)),i},s.ceil=function(i){return e(i=new Date(i-1)),t(i,1),e(i),i},s.round=function(i){var l=s(i),o=s.ceil(i);return i-l<o-i?l:o},s.offset=function(i,l){return t(i=new Date(+i),l==null?1:Math.floor(l)),i},s.range=function(i,l,o){var c=[],u;if(i=s.ceil(i),o=o==null?1:Math.floor(o),!(i<l)||!(o>0))return c;do c.push(u=new Date(+i)),t(i,o),e(i);while(u<i&&i<l);return c},s.filter=function(i){return rs(function(l){if(l>=l)for(;e(l),!i(l);)l.setTime(l-1)},function(l,o){if(l>=l)if(o<0)for(;++o<=0;)for(;t(l,-1),!i(l););else for(;--o>=0;)for(;t(l,1),!i(l););})},n&&(s.count=function(i,l){return N1.setTime(+i),j1.setTime(+l),e(N1),e(j1),Math.floor(n(N1,j1))},s.every=function(i){return i=Math.floor(i),!isFinite(i)||!(i>0)?null:i>1?s.filter(r?function(l){return r(l)%i===0}:function(l){return s.count(0,l)%i===0}):s}),s}var Ou=rs(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});Ou.every=function(e){return e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?rs(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):Ou};var zw=Ou.range;const ao=1e3,Fi=ao*60,oo=Fi*60,rc=oo*24,sb=rc*7,Uw=rc*30,S1=rc*365;var lo=rs(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+t*ao)},function(e,t){return(t-e)/ao},function(e){return e.getUTCSeconds()}),qw=lo.range,W0=rs(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*ao)},function(e,t){e.setTime(+e+t*Fi)},function(e,t){return(t-e)/Fi},function(e){return e.getMinutes()}),AU=W0.range,V0=rs(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*ao-e.getMinutes()*Fi)},function(e,t){e.setTime(+e+t*oo)},function(e,t){return(t-e)/oo},function(e){return e.getHours()}),kU=V0.range,ed=rs(e=>e.setHours(0,0,0,0),(e,t)=>e.setDate(e.getDate()+t),(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Fi)/rc,e=>e.getDate()-1),EU=ed.range;function mc(e){return rs(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,n){t.setDate(t.getDate()+n*7)},function(t,n){return(n-t-(n.getTimezoneOffset()-t.getTimezoneOffset())*Fi)/sb})}var Du=mc(0),Xf=mc(1),r_=mc(2),s_=mc(3),sc=mc(4),i_=mc(5),a_=mc(6),Hw=Du.range,CU=Xf.range,PU=r_.range,IU=s_.range,TU=sc.range,LU=i_.range,MU=a_.range,G0=rs(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()}),RU=G0.range,Ma=rs(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});Ma.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:rs(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,n){t.setFullYear(t.getFullYear()+n*e)})};var $U=Ma.range,Y0=rs(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+t*Fi)},function(e,t){return(t-e)/Fi},function(e){return e.getUTCMinutes()}),FU=Y0.range,J0=rs(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+t*oo)},function(e,t){return(t-e)/oo},function(e){return e.getUTCHours()}),OU=J0.range,td=rs(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/rc},function(e){return e.getUTCDate()-1}),DU=td.range;function pc(e){return rs(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCDate(t.getUTCDate()+n*7)},function(t,n){return(n-t)/sb})}var Bu=pc(0),Kf=pc(1),o_=pc(2),l_=pc(3),ic=pc(4),c_=pc(5),u_=pc(6),Ww=Bu.range,BU=Kf.range,zU=o_.range,UU=l_.range,qU=ic.range,HU=c_.range,WU=u_.range,Z0=rs(function(e){e.setUTCDate(1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+(t.getUTCFullYear()-e.getUTCFullYear())*12},function(e){return e.getUTCMonth()}),VU=Z0.range,Ra=rs(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});Ra.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:rs(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,n){t.setUTCFullYear(t.getUTCFullYear()+n*e)})};var GU=Ra.range;function d_(e,t,n,r,s,i){const l=[[lo,1,ao],[lo,5,5*ao],[lo,15,15*ao],[lo,30,30*ao],[i,1,Fi],[i,5,5*Fi],[i,15,15*Fi],[i,30,30*Fi],[s,1,oo],[s,3,3*oo],[s,6,6*oo],[s,12,12*oo],[r,1,rc],[r,2,2*rc],[n,1,sb],[t,1,Uw],[t,3,3*Uw],[e,1,S1]];function o(u,d,f){const m=d<u;m&&([u,d]=[d,u]);const h=f&&typeof f.range=="function"?f:c(u,d,f),x=h?h.range(u,+d+1):[];return m?x.reverse():x}function c(u,d,f){const m=Math.abs(d-u)/f,h=w0(([,,p])=>p).right(l,m);if(h===l.length)return e.every(Eu(u/S1,d/S1,f));if(h===0)return Ou.every(Math.max(Eu(u,d,f),1));const[x,y]=l[m/l[h-1][2]<l[h][2]/m?h-1:h];return x.every(y)}return[o,c]}const[f_,h_]=d_(Ra,Z0,Bu,td,J0,Y0),[m_,p_]=d_(Ma,G0,Du,ed,V0,W0);function _1(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function A1(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Hd(e,t,n){return{y:e,m:t,d:n,H:0,M:0,S:0,L:0}}function g_(e){var t=e.dateTime,n=e.date,r=e.time,s=e.periods,i=e.days,l=e.shortDays,o=e.months,c=e.shortMonths,u=Wd(s),d=Vd(s),f=Wd(i),m=Vd(i),h=Wd(l),x=Vd(l),y=Wd(o),p=Vd(o),g=Wd(c),w=Vd(c),v={a:O,A:W,b:E,B:H,c:null,d:Xw,e:Xw,f:gq,g:Aq,G:Eq,H:hq,I:mq,j:pq,L:x_,m:xq,M:yq,p:V,q:R,Q:eN,s:tN,S:bq,u:vq,U:wq,V:Nq,w:jq,W:Sq,x:null,X:null,y:_q,Y:kq,Z:Cq,"%":Qw},N={a:q,A:F,b:G,B:ee,c:null,d:Kw,e:Kw,f:Lq,g:qq,G:Wq,H:Pq,I:Iq,j:Tq,L:b_,m:Mq,M:Rq,p:ae,q:re,Q:eN,s:tN,S:$q,u:Fq,U:Oq,V:Dq,w:Bq,W:zq,x:null,X:null,y:Uq,Y:Hq,Z:Vq,"%":Qw},A={a:C,A:_,b:T,B,c:$,d:Jw,e:Jw,f:cq,g:Yw,G:Gw,H:Zw,I:Zw,j:iq,L:lq,m:sq,M:aq,p:S,q:rq,Q:dq,s:fq,S:oq,u:KU,U:QU,V:eq,w:XU,W:tq,x:D,X:L,y:Yw,Y:Gw,Z:nq,"%":uq};v.x=P(n,v),v.X=P(r,v),v.c=P(t,v),N.x=P(n,N),N.X=P(r,N),N.c=P(t,N);function P(Q,fe){return function(Se){var oe=[],pe=-1,me=0,ne=Q.length,it,$e,Oe;for(Se instanceof Date||(Se=new Date(+Se));++pe<ne;)Q.charCodeAt(pe)===37&&(oe.push(Q.slice(me,pe)),($e=Vw[it=Q.charAt(++pe)])!=null?it=Q.charAt(++pe):$e=it==="e"?" ":"0",(Oe=fe[it])&&(it=Oe(Se,$e)),oe.push(it),me=pe+1);return oe.push(Q.slice(me,pe)),oe.join("")}}function U(Q,fe){return function(Se){var oe=Hd(1900,void 0,1),pe=M(oe,Q,Se+="",0),me,ne;if(pe!=Se.length)return null;if("Q"in oe)return new Date(oe.Q);if("s"in oe)return new Date(oe.s*1e3+("L"in oe?oe.L:0));if(fe&&!("Z"in oe)&&(oe.Z=0),"p"in oe&&(oe.H=oe.H%12+oe.p*12),oe.m===void 0&&(oe.m="q"in oe?oe.q:0),"V"in oe){if(oe.V<1||oe.V>53)return null;"w"in oe||(oe.w=1),"Z"in oe?(me=A1(Hd(oe.y,0,1)),ne=me.getUTCDay(),me=ne>4||ne===0?Kf.ceil(me):Kf(me),me=td.offset(me,(oe.V-1)*7),oe.y=me.getUTCFullYear(),oe.m=me.getUTCMonth(),oe.d=me.getUTCDate()+(oe.w+6)%7):(me=_1(Hd(oe.y,0,1)),ne=me.getDay(),me=ne>4||ne===0?Xf.ceil(me):Xf(me),me=ed.offset(me,(oe.V-1)*7),oe.y=me.getFullYear(),oe.m=me.getMonth(),oe.d=me.getDate()+(oe.w+6)%7)}else("W"in oe||"U"in oe)&&("w"in oe||(oe.w="u"in oe?oe.u%7:"W"in oe?1:0),ne="Z"in oe?A1(Hd(oe.y,0,1)).getUTCDay():_1(Hd(oe.y,0,1)).getDay(),oe.m=0,oe.d="W"in oe?(oe.w+6)%7+oe.W*7-(ne+5)%7:oe.w+oe.U*7-(ne+6)%7);return"Z"in oe?(oe.H+=oe.Z/100|0,oe.M+=oe.Z%100,A1(oe)):_1(oe)}}function M(Q,fe,Se,oe){for(var pe=0,me=fe.length,ne=Se.length,it,$e;pe<me;){if(oe>=ne)return-1;if(it=fe.charCodeAt(pe++),it===37){if(it=fe.charAt(pe++),$e=A[it in Vw?fe.charAt(pe++):it],!$e||(oe=$e(Q,Se,oe))<0)return-1}else if(it!=Se.charCodeAt(oe++))return-1}return oe}function S(Q,fe,Se){var oe=u.exec(fe.slice(Se));return oe?(Q.p=d.get(oe[0].toLowerCase()),Se+oe[0].length):-1}function C(Q,fe,Se){var oe=h.exec(fe.slice(Se));return oe?(Q.w=x.get(oe[0].toLowerCase()),Se+oe[0].length):-1}function _(Q,fe,Se){var oe=f.exec(fe.slice(Se));return oe?(Q.w=m.get(oe[0].toLowerCase()),Se+oe[0].length):-1}function T(Q,fe,Se){var oe=g.exec(fe.slice(Se));return oe?(Q.m=w.get(oe[0].toLowerCase()),Se+oe[0].length):-1}function B(Q,fe,Se){var oe=y.exec(fe.slice(Se));return oe?(Q.m=p.get(oe[0].toLowerCase()),Se+oe[0].length):-1}function $(Q,fe,Se){return M(Q,t,fe,Se)}function D(Q,fe,Se){return M(Q,n,fe,Se)}function L(Q,fe,Se){return M(Q,r,fe,Se)}function O(Q){return l[Q.getDay()]}function W(Q){return i[Q.getDay()]}function E(Q){return c[Q.getMonth()]}function H(Q){return o[Q.getMonth()]}function V(Q){return s[+(Q.getHours()>=12)]}function R(Q){return 1+~~(Q.getMonth()/3)}function q(Q){return l[Q.getUTCDay()]}function F(Q){return i[Q.getUTCDay()]}function G(Q){return c[Q.getUTCMonth()]}function ee(Q){return o[Q.getUTCMonth()]}function ae(Q){return s[+(Q.getUTCHours()>=12)]}function re(Q){return 1+~~(Q.getUTCMonth()/3)}return{format:function(Q){var fe=P(Q+="",v);return fe.toString=function(){return Q},fe},parse:function(Q){var fe=U(Q+="",!1);return fe.toString=function(){return Q},fe},utcFormat:function(Q){var fe=P(Q+="",N);return fe.toString=function(){return Q},fe},utcParse:function(Q){var fe=U(Q+="",!0);return fe.toString=function(){return Q},fe}}}var Vw={"-":"",_:" ",0:"0"},cs=/^\s*\d+/,YU=/^%/,JU=/[\\^$*+?|[\]().{}]/g;function $n(e,t,n){var r=e<0?"-":"",s=(r?-e:e)+"",i=s.length;return r+(i<n?new Array(n-i+1).join(t)+s:s)}function ZU(e){return e.replace(JU,"\\$&")}function Wd(e){return new RegExp("^(?:"+e.map(ZU).join("|")+")","i")}function Vd(e){return new Map(e.map((t,n)=>[t.toLowerCase(),n]))}function XU(e,t,n){var r=cs.exec(t.slice(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function KU(e,t,n){var r=cs.exec(t.slice(n,n+1));return r?(e.u=+r[0],n+r[0].length):-1}function QU(e,t,n){var r=cs.exec(t.slice(n,n+2));return r?(e.U=+r[0],n+r[0].length):-1}function eq(e,t,n){var r=cs.exec(t.slice(n,n+2));return r?(e.V=+r[0],n+r[0].length):-1}function tq(e,t,n){var r=cs.exec(t.slice(n,n+2));return r?(e.W=+r[0],n+r[0].length):-1}function Gw(e,t,n){var r=cs.exec(t.slice(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function Yw(e,t,n){var r=cs.exec(t.slice(n,n+2));return r?(e.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function nq(e,t,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(n,n+6));return r?(e.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function rq(e,t,n){var r=cs.exec(t.slice(n,n+1));return r?(e.q=r[0]*3-3,n+r[0].length):-1}function sq(e,t,n){var r=cs.exec(t.slice(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function Jw(e,t,n){var r=cs.exec(t.slice(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function iq(e,t,n){var r=cs.exec(t.slice(n,n+3));return r?(e.m=0,e.d=+r[0],n+r[0].length):-1}function Zw(e,t,n){var r=cs.exec(t.slice(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function aq(e,t,n){var r=cs.exec(t.slice(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function oq(e,t,n){var r=cs.exec(t.slice(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function lq(e,t,n){var r=cs.exec(t.slice(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function cq(e,t,n){var r=cs.exec(t.slice(n,n+6));return r?(e.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function uq(e,t,n){var r=YU.exec(t.slice(n,n+1));return r?n+r[0].length:-1}function dq(e,t,n){var r=cs.exec(t.slice(n));return r?(e.Q=+r[0],n+r[0].length):-1}function fq(e,t,n){var r=cs.exec(t.slice(n));return r?(e.s=+r[0],n+r[0].length):-1}function Xw(e,t){return $n(e.getDate(),t,2)}function hq(e,t){return $n(e.getHours(),t,2)}function mq(e,t){return $n(e.getHours()%12||12,t,2)}function pq(e,t){return $n(1+ed.count(Ma(e),e),t,3)}function x_(e,t){return $n(e.getMilliseconds(),t,3)}function gq(e,t){return x_(e,t)+"000"}function xq(e,t){return $n(e.getMonth()+1,t,2)}function yq(e,t){return $n(e.getMinutes(),t,2)}function bq(e,t){return $n(e.getSeconds(),t,2)}function vq(e){var t=e.getDay();return t===0?7:t}function wq(e,t){return $n(Du.count(Ma(e)-1,e),t,2)}function y_(e){var t=e.getDay();return t>=4||t===0?sc(e):sc.ceil(e)}function Nq(e,t){return e=y_(e),$n(sc.count(Ma(e),e)+(Ma(e).getDay()===4),t,2)}function jq(e){return e.getDay()}function Sq(e,t){return $n(Xf.count(Ma(e)-1,e),t,2)}function _q(e,t){return $n(e.getFullYear()%100,t,2)}function Aq(e,t){return e=y_(e),$n(e.getFullYear()%100,t,2)}function kq(e,t){return $n(e.getFullYear()%1e4,t,4)}function Eq(e,t){var n=e.getDay();return e=n>=4||n===0?sc(e):sc.ceil(e),$n(e.getFullYear()%1e4,t,4)}function Cq(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+$n(t/60|0,"0",2)+$n(t%60,"0",2)}function Kw(e,t){return $n(e.getUTCDate(),t,2)}function Pq(e,t){return $n(e.getUTCHours(),t,2)}function Iq(e,t){return $n(e.getUTCHours()%12||12,t,2)}function Tq(e,t){return $n(1+td.count(Ra(e),e),t,3)}function b_(e,t){return $n(e.getUTCMilliseconds(),t,3)}function Lq(e,t){return b_(e,t)+"000"}function Mq(e,t){return $n(e.getUTCMonth()+1,t,2)}function Rq(e,t){return $n(e.getUTCMinutes(),t,2)}function $q(e,t){return $n(e.getUTCSeconds(),t,2)}function Fq(e){var t=e.getUTCDay();return t===0?7:t}function Oq(e,t){return $n(Bu.count(Ra(e)-1,e),t,2)}function v_(e){var t=e.getUTCDay();return t>=4||t===0?ic(e):ic.ceil(e)}function Dq(e,t){return e=v_(e),$n(ic.count(Ra(e),e)+(Ra(e).getUTCDay()===4),t,2)}function Bq(e){return e.getUTCDay()}function zq(e,t){return $n(Kf.count(Ra(e)-1,e),t,2)}function Uq(e,t){return $n(e.getUTCFullYear()%100,t,2)}function qq(e,t){return e=v_(e),$n(e.getUTCFullYear()%100,t,2)}function Hq(e,t){return $n(e.getUTCFullYear()%1e4,t,4)}function Wq(e,t){var n=e.getUTCDay();return e=n>=4||n===0?ic(e):ic.ceil(e),$n(e.getUTCFullYear()%1e4,t,4)}function Vq(){return"+0000"}function Qw(){return"%"}function eN(e){return+e}function tN(e){return Math.floor(+e/1e3)}var Wc,ib,w_,X0,ab;N_({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function N_(e){return Wc=g_(e),ib=Wc.format,w_=Wc.parse,X0=Wc.utcFormat,ab=Wc.utcParse,Wc}var j_="%Y-%m-%dT%H:%M:%S.%LZ";function Gq(e){return e.toISOString()}var Yq=Date.prototype.toISOString?Gq:X0(j_);function Jq(e){var t=new Date(e);return isNaN(t)?null:t}var Zq=+new Date("2000-01-01T00:00:00.000Z")?Jq:ab(j_);function Xq(e){return new Date(e)}function Kq(e){return e instanceof Date?+e:+new Date(+e)}function ob(e,t,n,r,s,i,l,o,c,u){var d=Qy(),f=d.invert,m=d.domain,h=u(".%L"),x=u(":%S"),y=u("%I:%M"),p=u("%I %p"),g=u("%a %d"),w=u("%b %d"),v=u("%B"),N=u("%Y");function A(P){return(c(P)<P?h:o(P)<P?x:l(P)<P?y:i(P)<P?p:r(P)<P?s(P)<P?g:w:n(P)<P?v:N)(P)}return d.invert=function(P){return new Date(f(P))},d.domain=function(P){return arguments.length?m(Array.from(P,Kq)):m().map(Xq)},d.ticks=function(P){var U=m();return e(U[0],U[U.length-1],P??10)},d.tickFormat=function(P,U){return U==null?A:u(U)},d.nice=function(P){var U=m();return(!P||typeof P.range!="function")&&(P=t(U[0],U[U.length-1],P??10)),P?m(ZS(U,P)):d},d.copy=function(){return Nh(d,ob(e,t,n,r,s,i,l,o,c,u))},d}function Qq(){return qi.apply(ob(m_,p_,Ma,G0,Du,ed,V0,W0,lo,ib).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function eH(){return qi.apply(ob(f_,h_,Ra,Z0,Bu,td,J0,Y0,lo,X0).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function K0(){var e=0,t=1,n,r,s,i,l=Ws,o=!1,c;function u(f){return f==null||isNaN(f=+f)?c:l(s===0?.5:(f=(i(f)-n)*s,o?Math.max(0,Math.min(1,f)):f))}u.domain=function(f){return arguments.length?([e,t]=f,n=i(e=+e),r=i(t=+t),s=n===r?0:1/(r-n),u):[e,t]},u.clamp=function(f){return arguments.length?(o=!!f,u):o},u.interpolator=function(f){return arguments.length?(l=f,u):l};function d(f){return function(m){var h,x;return arguments.length?([h,x]=m,l=f(h,x),u):[l(0),l(1)]}}return u.range=d(ll),u.rangeRound=d(I0),u.unknown=function(f){return arguments.length?(c=f,u):c},function(f){return i=f,n=f(e),r=f(t),s=n===r?0:1/(r-n),u}}function dl(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function S_(){var e=ul(K0()(Ws));return e.copy=function(){return dl(e,S_())},yo.apply(e,arguments)}function __(){var e=eb(K0()).domain([1,10]);return e.copy=function(){return dl(e,__()).base(e.base())},yo.apply(e,arguments)}function A_(){var e=tb(K0());return e.copy=function(){return dl(e,A_()).constant(e.constant())},yo.apply(e,arguments)}function lb(){var e=nb(K0());return e.copy=function(){return dl(e,lb()).exponent(e.exponent())},yo.apply(e,arguments)}function tH(){return lb.apply(null,arguments).exponent(.5)}function k_(){var e=[],t=Ws;function n(r){if(r!=null&&!isNaN(r=+r))return t((el(e,r,1)-1)/(e.length-1))}return n.domain=function(r){if(!arguments.length)return e.slice();e=[];for(let s of r)s!=null&&!isNaN(s=+s)&&e.push(s);return e.sort(Vr),n},n.interpolator=function(r){return arguments.length?(t=r,n):t},n.range=function(){return e.map((r,s)=>t(s/(e.length-1)))},n.quantiles=function(r){return Array.from({length:r+1},(s,i)=>Ff(e,i/r))},n.copy=function(){return k_(t).domain(e)},yo.apply(n,arguments)}function Q0(){var e=0,t=.5,n=1,r=1,s,i,l,o,c,u=Ws,d,f=!1,m;function h(y){return isNaN(y=+y)?m:(y=.5+((y=+d(y))-i)*(r*y<r*i?o:c),u(f?Math.max(0,Math.min(1,y)):y))}h.domain=function(y){return arguments.length?([e,t,n]=y,s=d(e=+e),i=d(t=+t),l=d(n=+n),o=s===i?0:.5/(i-s),c=i===l?0:.5/(l-i),r=i<s?-1:1,h):[e,t,n]},h.clamp=function(y){return arguments.length?(f=!!y,h):f},h.interpolator=function(y){return arguments.length?(u=y,h):u};function x(y){return function(p){var g,w,v;return arguments.length?([g,w,v]=p,u=w6(y,[g,w,v]),h):[u(0),u(.5),u(1)]}}return h.range=x(ll),h.rangeRound=x(I0),h.unknown=function(y){return arguments.length?(m=y,h):m},function(y){return d=y,s=y(e),i=y(t),l=y(n),o=s===i?0:.5/(i-s),c=i===l?0:.5/(l-i),r=i<s?-1:1,h}}function E_(){var e=ul(Q0()(Ws));return e.copy=function(){return dl(e,E_())},yo.apply(e,arguments)}function C_(){var e=eb(Q0()).domain([.1,1,10]);return e.copy=function(){return dl(e,C_()).base(e.base())},yo.apply(e,arguments)}function P_(){var e=tb(Q0());return e.copy=function(){return dl(e,P_()).constant(e.constant())},yo.apply(e,arguments)}function cb(){var e=nb(Q0());return e.copy=function(){return dl(e,cb()).exponent(e.exponent())},yo.apply(e,arguments)}function nH(){return cb.apply(null,arguments).exponent(.5)}function Sn(e){for(var t=e.length/6|0,n=new Array(t),r=0;r<t;)n[r]="#"+e.slice(r*6,++r*6);return n}const rH=Sn("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),sH=Sn("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),iH=Sn("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),aH=Sn("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),oH=Sn("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),lH=Sn("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),cH=Sn("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),uH=Sn("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),dH=Sn("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),fH=Sn("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab"),ir=e=>l6(e[e.length-1]);var I_=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(Sn);const hH=ir(I_);var T_=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(Sn);const mH=ir(T_);var L_=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(Sn);const pH=ir(L_);var M_=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(Sn);const gH=ir(M_);var R_=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(Sn);const xH=ir(R_);var $_=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(Sn);const yH=ir($_);var F_=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(Sn);const bH=ir(F_);var O_=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(Sn);const vH=ir(O_);var D_=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(Sn);const wH=ir(D_);var B_=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(Sn);const NH=ir(B_);var z_=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(Sn);const jH=ir(z_);var U_=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(Sn);const SH=ir(U_);var q_=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(Sn);const _H=ir(q_);var H_=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(Sn);const AH=ir(H_);var W_=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(Sn);const kH=ir(W_);var V_=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(Sn);const EH=ir(V_);var G_=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(Sn);const CH=ir(G_);var Y_=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(Sn);const PH=ir(Y_);var J_=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(Sn);const IH=ir(J_);var Z_=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(Sn);const TH=ir(Z_);var X_=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(Sn);const LH=ir(X_);var K_=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(Sn);const MH=ir(K_);var Q_=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(Sn);const RH=ir(Q_);var e8=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(Sn);const $H=ir(e8);var t8=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(Sn);const FH=ir(t8);var n8=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(Sn);const OH=ir(n8);var r8=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(Sn);const DH=ir(r8);function BH(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-e*(35.34-e*(2381.73-e*(6402.7-e*(7024.72-e*2710.57)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+e*(170.73+e*(52.82-e*(131.46-e*(176.58-e*67.37)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+e*(442.36-e*(2482.43-e*(6167.24-e*(6614.94-e*2475.67)))))))+")"}const zH=T0(aa(300,.5,0),aa(-240,.5,1));var UH=T0(aa(-100,.75,.35),aa(80,1.5,.8)),qH=T0(aa(260,.75,.35),aa(80,1.5,.8)),ym=aa();function HH(e){(e<0||e>1)&&(e-=Math.floor(e));var t=Math.abs(e-.5);return ym.h=360*e-100,ym.s=1.5-1.5*t,ym.l=.8-.9*t,ym+""}var bm=Pu(),WH=Math.PI/3,VH=Math.PI*2/3;function GH(e){var t;return e=(.5-e)*Math.PI,bm.r=255*(t=Math.sin(e))*t,bm.g=255*(t=Math.sin(e+WH))*t,bm.b=255*(t=Math.sin(e+VH))*t,bm+""}function YH(e){return e=Math.max(0,Math.min(1,e)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+e*(1172.33-e*(10793.56-e*(33300.12-e*(38394.49-e*14825.05)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+e*(557.33+e*(1225.33-e*(3574.96-e*(1073.77+e*707.56)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+e*(3211.1-e*(15327.97-e*(27814-e*(22569.18-e*6838.66)))))))+")"}function eg(e){var t=e.length;return function(n){return e[Math.max(0,Math.min(t-1,Math.floor(n*t)))]}}const JH=eg(Sn("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));var ZH=eg(Sn("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),XH=eg(Sn("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),KH=eg(Sn("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function yn(e){return function(){return e}}var nN=Math.abs,As=Math.atan2,Ll=Math.cos,QH=Math.max,k1=Math.min,ya=Math.sin,ou=Math.sqrt,Is=1e-12,rl=Math.PI,Zp=rl/2,Zo=2*rl;function eW(e){return e>1?0:e<-1?rl:Math.acos(e)}function rN(e){return e>=1?Zp:e<=-1?-Zp:Math.asin(e)}function tW(e){return e.innerRadius}function nW(e){return e.outerRadius}function rW(e){return e.startAngle}function sW(e){return e.endAngle}function iW(e){return e&&e.padAngle}function aW(e,t,n,r,s,i,l,o){var c=n-e,u=r-t,d=l-s,f=o-i,m=f*c-d*u;if(!(m*m<Is))return m=(d*(t-i)-f*(e-s))/m,[e+m*c,t+m*u]}function vm(e,t,n,r,s,i,l){var o=e-n,c=t-r,u=(l?i:-i)/ou(o*o+c*c),d=u*c,f=-u*o,m=e+d,h=t+f,x=n+d,y=r+f,p=(m+x)/2,g=(h+y)/2,w=x-m,v=y-h,N=w*w+v*v,A=s-i,P=m*y-x*h,U=(v<0?-1:1)*ou(QH(0,A*A*N-P*P)),M=(P*v-w*U)/N,S=(-P*w-v*U)/N,C=(P*v+w*U)/N,_=(-P*w+v*U)/N,T=M-p,B=S-g,$=C-p,D=_-g;return T*T+B*B>$*$+D*D&&(M=C,S=_),{cx:M,cy:S,x01:-d,y01:-f,x11:M*(s/A-1),y11:S*(s/A-1)}}function oW(){var e=tW,t=nW,n=yn(0),r=null,s=rW,i=sW,l=iW,o=null;function c(){var u,d,f=+e.apply(this,arguments),m=+t.apply(this,arguments),h=s.apply(this,arguments)-Zp,x=i.apply(this,arguments)-Zp,y=nN(x-h),p=x>h;if(o||(o=u=cl()),m<f&&(d=m,m=f,f=d),!(m>Is))o.moveTo(0,0);else if(y>Zo-Is)o.moveTo(m*Ll(h),m*ya(h)),o.arc(0,0,m,h,x,!p),f>Is&&(o.moveTo(f*Ll(x),f*ya(x)),o.arc(0,0,f,x,h,p));else{var g=h,w=x,v=h,N=x,A=y,P=y,U=l.apply(this,arguments)/2,M=U>Is&&(r?+r.apply(this,arguments):ou(f*f+m*m)),S=k1(nN(m-f)/2,+n.apply(this,arguments)),C=S,_=S,T,B;if(M>Is){var $=rN(M/f*ya(U)),D=rN(M/m*ya(U));(A-=$*2)>Is?($*=p?1:-1,v+=$,N-=$):(A=0,v=N=(h+x)/2),(P-=D*2)>Is?(D*=p?1:-1,g+=D,w-=D):(P=0,g=w=(h+x)/2)}var L=m*Ll(g),O=m*ya(g),W=f*Ll(N),E=f*ya(N);if(S>Is){var H=m*Ll(w),V=m*ya(w),R=f*Ll(v),q=f*ya(v),F;if(y<rl&&(F=aW(L,O,R,q,H,V,W,E))){var G=L-F[0],ee=O-F[1],ae=H-F[0],re=V-F[1],Q=1/ya(eW((G*ae+ee*re)/(ou(G*G+ee*ee)*ou(ae*ae+re*re)))/2),fe=ou(F[0]*F[0]+F[1]*F[1]);C=k1(S,(f-fe)/(Q-1)),_=k1(S,(m-fe)/(Q+1))}}P>Is?_>Is?(T=vm(R,q,L,O,m,_,p),B=vm(H,V,W,E,m,_,p),o.moveTo(T.cx+T.x01,T.cy+T.y01),_<S?o.arc(T.cx,T.cy,_,As(T.y01,T.x01),As(B.y01,B.x01),!p):(o.arc(T.cx,T.cy,_,As(T.y01,T.x01),As(T.y11,T.x11),!p),o.arc(0,0,m,As(T.cy+T.y11,T.cx+T.x11),As(B.cy+B.y11,B.cx+B.x11),!p),o.arc(B.cx,B.cy,_,As(B.y11,B.x11),As(B.y01,B.x01),!p))):(o.moveTo(L,O),o.arc(0,0,m,g,w,!p)):o.moveTo(L,O),!(f>Is)||!(A>Is)?o.lineTo(W,E):C>Is?(T=vm(W,E,H,V,f,-C,p),B=vm(L,O,R,q,f,-C,p),o.lineTo(T.cx+T.x01,T.cy+T.y01),C<S?o.arc(T.cx,T.cy,C,As(T.y01,T.x01),As(B.y01,B.x01),!p):(o.arc(T.cx,T.cy,C,As(T.y01,T.x01),As(T.y11,T.x11),!p),o.arc(0,0,f,As(T.cy+T.y11,T.cx+T.x11),As(B.cy+B.y11,B.cx+B.x11),p),o.arc(B.cx,B.cy,C,As(B.y11,B.x11),As(B.y01,B.x01),!p))):o.arc(0,0,f,N,v,p)}if(o.closePath(),u)return o=null,u+""||null}return c.centroid=function(){var u=(+e.apply(this,arguments)+ +t.apply(this,arguments))/2,d=(+s.apply(this,arguments)+ +i.apply(this,arguments))/2-rl/2;return[Ll(d)*u,ya(d)*u]},c.innerRadius=function(u){return arguments.length?(e=typeof u=="function"?u:yn(+u),c):e},c.outerRadius=function(u){return arguments.length?(t=typeof u=="function"?u:yn(+u),c):t},c.cornerRadius=function(u){return arguments.length?(n=typeof u=="function"?u:yn(+u),c):n},c.padRadius=function(u){return arguments.length?(r=u==null?null:typeof u=="function"?u:yn(+u),c):r},c.startAngle=function(u){return arguments.length?(s=typeof u=="function"?u:yn(+u),c):s},c.endAngle=function(u){return arguments.length?(i=typeof u=="function"?u:yn(+u),c):i},c.padAngle=function(u){return arguments.length?(l=typeof u=="function"?u:yn(+u),c):l},c.context=function(u){return arguments.length?(o=u??null,c):o},c}var lW=Array.prototype.slice;function tg(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function s8(e){this._context=e}s8.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function ng(e){return new s8(e)}function ub(e){return e[0]}function db(e){return e[1]}function fb(e,t){var n=yn(!0),r=null,s=ng,i=null;e=typeof e=="function"?e:e===void 0?ub:yn(e),t=typeof t=="function"?t:t===void 0?db:yn(t);function l(o){var c,u=(o=tg(o)).length,d,f=!1,m;for(r==null&&(i=s(m=cl())),c=0;c<=u;++c)!(c<u&&n(d=o[c],c,o))===f&&((f=!f)?i.lineStart():i.lineEnd()),f&&i.point(+e(d,c,o),+t(d,c,o));if(m)return i=null,m+""||null}return l.x=function(o){return arguments.length?(e=typeof o=="function"?o:yn(+o),l):e},l.y=function(o){return arguments.length?(t=typeof o=="function"?o:yn(+o),l):t},l.defined=function(o){return arguments.length?(n=typeof o=="function"?o:yn(!!o),l):n},l.curve=function(o){return arguments.length?(s=o,r!=null&&(i=s(r)),l):s},l.context=function(o){return arguments.length?(o==null?r=i=null:i=s(r=o),l):r},l}function i8(e,t,n){var r=null,s=yn(!0),i=null,l=ng,o=null;e=typeof e=="function"?e:e===void 0?ub:yn(+e),t=typeof t=="function"?t:yn(t===void 0?0:+t),n=typeof n=="function"?n:n===void 0?db:yn(+n);function c(d){var f,m,h,x=(d=tg(d)).length,y,p=!1,g,w=new Array(x),v=new Array(x);for(i==null&&(o=l(g=cl())),f=0;f<=x;++f){if(!(f<x&&s(y=d[f],f,d))===p)if(p=!p)m=f,o.areaStart(),o.lineStart();else{for(o.lineEnd(),o.lineStart(),h=f-1;h>=m;--h)o.point(w[h],v[h]);o.lineEnd(),o.areaEnd()}p&&(w[f]=+e(y,f,d),v[f]=+t(y,f,d),o.point(r?+r(y,f,d):w[f],n?+n(y,f,d):v[f]))}if(g)return o=null,g+""||null}function u(){return fb().defined(s).curve(l).context(i)}return c.x=function(d){return arguments.length?(e=typeof d=="function"?d:yn(+d),r=null,c):e},c.x0=function(d){return arguments.length?(e=typeof d=="function"?d:yn(+d),c):e},c.x1=function(d){return arguments.length?(r=d==null?null:typeof d=="function"?d:yn(+d),c):r},c.y=function(d){return arguments.length?(t=typeof d=="function"?d:yn(+d),n=null,c):t},c.y0=function(d){return arguments.length?(t=typeof d=="function"?d:yn(+d),c):t},c.y1=function(d){return arguments.length?(n=d==null?null:typeof d=="function"?d:yn(+d),c):n},c.lineX0=c.lineY0=function(){return u().x(e).y(t)},c.lineY1=function(){return u().x(e).y(n)},c.lineX1=function(){return u().x(r).y(t)},c.defined=function(d){return arguments.length?(s=typeof d=="function"?d:yn(!!d),c):s},c.curve=function(d){return arguments.length?(l=d,i!=null&&(o=l(i)),c):l},c.context=function(d){return arguments.length?(d==null?i=o=null:o=l(i=d),c):i},c}function cW(e,t){return t<e?-1:t>e?1:t>=e?0:NaN}function uW(e){return e}function dW(){var e=uW,t=cW,n=null,r=yn(0),s=yn(Zo),i=yn(0);function l(o){var c,u=(o=tg(o)).length,d,f,m=0,h=new Array(u),x=new Array(u),y=+r.apply(this,arguments),p=Math.min(Zo,Math.max(-Zo,s.apply(this,arguments)-y)),g,w=Math.min(Math.abs(p)/u,i.apply(this,arguments)),v=w*(p<0?-1:1),N;for(c=0;c<u;++c)(N=x[h[c]=c]=+e(o[c],c,o))>0&&(m+=N);for(t!=null?h.sort(function(A,P){return t(x[A],x[P])}):n!=null&&h.sort(function(A,P){return n(o[A],o[P])}),c=0,f=m?(p-u*v)/m:0;c<u;++c,y=g)d=h[c],N=x[d],g=y+(N>0?N*f:0)+v,x[d]={data:o[d],index:c,value:N,startAngle:y,endAngle:g,padAngle:w};return x}return l.value=function(o){return arguments.length?(e=typeof o=="function"?o:yn(+o),l):e},l.sortValues=function(o){return arguments.length?(t=o,n=null,l):t},l.sort=function(o){return arguments.length?(n=o,t=null,l):n},l.startAngle=function(o){return arguments.length?(r=typeof o=="function"?o:yn(+o),l):r},l.endAngle=function(o){return arguments.length?(s=typeof o=="function"?o:yn(+o),l):s},l.padAngle=function(o){return arguments.length?(i=typeof o=="function"?o:yn(+o),l):i},l}var a8=hb(ng);function o8(e){this._curve=e}o8.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(e,t){this._curve.point(t*Math.sin(e),t*-Math.cos(e))}};function hb(e){function t(n){return new o8(e(n))}return t._curve=e,t}function pf(e){var t=e.curve;return e.angle=e.x,delete e.x,e.radius=e.y,delete e.y,e.curve=function(n){return arguments.length?t(hb(n)):t()._curve},e}function sN(){return pf(fb().curve(a8))}function iN(){var e=i8().curve(a8),t=e.curve,n=e.lineX0,r=e.lineX1,s=e.lineY0,i=e.lineY1;return e.angle=e.x,delete e.x,e.startAngle=e.x0,delete e.x0,e.endAngle=e.x1,delete e.x1,e.radius=e.y,delete e.y,e.innerRadius=e.y0,delete e.y0,e.outerRadius=e.y1,delete e.y1,e.lineStartAngle=function(){return pf(n())},delete e.lineX0,e.lineEndAngle=function(){return pf(r())},delete e.lineX1,e.lineInnerRadius=function(){return pf(s())},delete e.lineY0,e.lineOuterRadius=function(){return pf(i())},delete e.lineY1,e.curve=function(l){return arguments.length?t(hb(l)):t()._curve},e}function gf(e,t){return[(t=+t)*Math.cos(e-=Math.PI/2),t*Math.sin(e)]}function fW(e){return e.source}function hW(e){return e.target}function mb(e){var t=fW,n=hW,r=ub,s=db,i=null;function l(){var o,c=lW.call(arguments),u=t.apply(this,c),d=n.apply(this,c);if(i||(i=o=cl()),e(i,+r.apply(this,(c[0]=u,c)),+s.apply(this,c),+r.apply(this,(c[0]=d,c)),+s.apply(this,c)),o)return i=null,o+""||null}return l.source=function(o){return arguments.length?(t=o,l):t},l.target=function(o){return arguments.length?(n=o,l):n},l.x=function(o){return arguments.length?(r=typeof o=="function"?o:yn(+o),l):r},l.y=function(o){return arguments.length?(s=typeof o=="function"?o:yn(+o),l):s},l.context=function(o){return arguments.length?(i=o??null,l):i},l}function mW(e,t,n,r,s){e.moveTo(t,n),e.bezierCurveTo(t=(t+r)/2,n,t,s,r,s)}function pW(e,t,n,r,s){e.moveTo(t,n),e.bezierCurveTo(t,n=(n+s)/2,r,n,r,s)}function gW(e,t,n,r,s){var i=gf(t,n),l=gf(t,n=(n+s)/2),o=gf(r,n),c=gf(r,s);e.moveTo(i[0],i[1]),e.bezierCurveTo(l[0],l[1],o[0],o[1],c[0],c[1])}function xW(){return mb(mW)}function yW(){return mb(pW)}function bW(){var e=mb(gW);return e.angle=e.x,delete e.x,e.radius=e.y,delete e.y,e}const pb={draw:function(e,t){var n=Math.sqrt(t/rl);e.moveTo(n,0),e.arc(0,0,n,0,Zo)}},l8={draw:function(e,t){var n=Math.sqrt(t/5)/2;e.moveTo(-3*n,-n),e.lineTo(-n,-n),e.lineTo(-n,-3*n),e.lineTo(n,-3*n),e.lineTo(n,-n),e.lineTo(3*n,-n),e.lineTo(3*n,n),e.lineTo(n,n),e.lineTo(n,3*n),e.lineTo(-n,3*n),e.lineTo(-n,n),e.lineTo(-3*n,n),e.closePath()}};var c8=Math.sqrt(1/3),vW=c8*2;const u8={draw:function(e,t){var n=Math.sqrt(t/vW),r=n*c8;e.moveTo(0,-n),e.lineTo(r,0),e.lineTo(0,n),e.lineTo(-r,0),e.closePath()}};var wW=.8908130915292852,d8=Math.sin(rl/10)/Math.sin(7*rl/10),NW=Math.sin(Zo/10)*d8,jW=-Math.cos(Zo/10)*d8;const f8={draw:function(e,t){var n=Math.sqrt(t*wW),r=NW*n,s=jW*n;e.moveTo(0,-n),e.lineTo(r,s);for(var i=1;i<5;++i){var l=Zo*i/5,o=Math.cos(l),c=Math.sin(l);e.lineTo(c*n,-o*n),e.lineTo(o*r-c*s,c*r+o*s)}e.closePath()}},h8={draw:function(e,t){var n=Math.sqrt(t),r=-n/2;e.rect(r,r,n,n)}};var E1=Math.sqrt(3);const m8={draw:function(e,t){var n=-Math.sqrt(t/(E1*3));e.moveTo(0,n*2),e.lineTo(-E1*n,-n),e.lineTo(E1*n,-n),e.closePath()}};var Ti=-.5,Li=Math.sqrt(3)/2,v2=1/Math.sqrt(12),SW=(v2/2+1)*3;const p8={draw:function(e,t){var n=Math.sqrt(t/SW),r=n/2,s=n*v2,i=r,l=n*v2+n,o=-i,c=l;e.moveTo(r,s),e.lineTo(i,l),e.lineTo(o,c),e.lineTo(Ti*r-Li*s,Li*r+Ti*s),e.lineTo(Ti*i-Li*l,Li*i+Ti*l),e.lineTo(Ti*o-Li*c,Li*o+Ti*c),e.lineTo(Ti*r+Li*s,Ti*s-Li*r),e.lineTo(Ti*i+Li*l,Ti*l-Li*i),e.lineTo(Ti*o+Li*c,Ti*c-Li*o),e.closePath()}};var _W=[pb,l8,u8,h8,f8,m8,p8];function AW(e,t){var n=null;e=typeof e=="function"?e:yn(e||pb),t=typeof t=="function"?t:yn(t===void 0?64:+t);function r(){var s;if(n||(n=s=cl()),e.apply(this,arguments).draw(n,+t.apply(this,arguments)),s)return n=null,s+""||null}return r.type=function(s){return arguments.length?(e=typeof s=="function"?s:yn(s),r):e},r.size=function(s){return arguments.length?(t=typeof s=="function"?s:yn(+s),r):t},r.context=function(s){return arguments.length?(n=s??null,r):n},r}function sl(){}function Xp(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function rg(e){this._context=e}rg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Xp(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Xp(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function kW(e){return new rg(e)}function g8(e){this._context=e}g8.prototype={areaStart:sl,areaEnd:sl,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:Xp(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function EW(e){return new g8(e)}function x8(e){this._context=e}x8.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:Xp(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function CW(e){return new x8(e)}class y8{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function PW(e){return new y8(e,!0)}function IW(e){return new y8(e,!1)}function b8(e,t){this._basis=new rg(e),this._beta=t}b8.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],s=t[0],i=e[n]-r,l=t[n]-s,o=-1,c;++o<=n;)c=o/n,this._basis.point(this._beta*e[o]+(1-this._beta)*(r+c*i),this._beta*t[o]+(1-this._beta)*(s+c*l));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const TW=function e(t){function n(r){return t===1?new rg(r):new b8(r,t)}return n.beta=function(r){return e(+r)},n}(.85);function Kp(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function gb(e,t){this._context=e,this._k=(1-t)/6}gb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Kp(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:Kp(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const LW=function e(t){function n(r){return new gb(r,t)}return n.tension=function(r){return e(+r)},n}(0);function xb(e,t){this._context=e,this._k=(1-t)/6}xb.prototype={areaStart:sl,areaEnd:sl,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:Kp(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const MW=function e(t){function n(r){return new xb(r,t)}return n.tension=function(r){return e(+r)},n}(0);function yb(e,t){this._context=e,this._k=(1-t)/6}yb.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Kp(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const RW=function e(t){function n(r){return new yb(r,t)}return n.tension=function(r){return e(+r)},n}(0);function bb(e,t,n){var r=e._x1,s=e._y1,i=e._x2,l=e._y2;if(e._l01_a>Is){var o=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,c=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*o-e._x0*e._l12_2a+e._x2*e._l01_2a)/c,s=(s*o-e._y0*e._l12_2a+e._y2*e._l01_2a)/c}if(e._l23_a>Is){var u=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,d=3*e._l23_a*(e._l23_a+e._l12_a);i=(i*u+e._x1*e._l23_2a-t*e._l12_2a)/d,l=(l*u+e._y1*e._l23_2a-n*e._l12_2a)/d}e._context.bezierCurveTo(r,s,i,l,e._x2,e._y2)}function v8(e,t){this._context=e,this._alpha=t}v8.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:bb(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const $W=function e(t){function n(r){return t?new v8(r,t):new gb(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function w8(e,t){this._context=e,this._alpha=t}w8.prototype={areaStart:sl,areaEnd:sl,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:bb(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const FW=function e(t){function n(r){return t?new w8(r,t):new xb(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function N8(e,t){this._context=e,this._alpha=t}N8.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:bb(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const OW=function e(t){function n(r){return t?new N8(r,t):new yb(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function j8(e){this._context=e}j8.prototype={areaStart:sl,areaEnd:sl,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function DW(e){return new j8(e)}function aN(e){return e<0?-1:1}function oN(e,t,n){var r=e._x1-e._x0,s=t-e._x1,i=(e._y1-e._y0)/(r||s<0&&-0),l=(n-e._y1)/(s||r<0&&-0),o=(i*s+l*r)/(r+s);return(aN(i)+aN(l))*Math.min(Math.abs(i),Math.abs(l),.5*Math.abs(o))||0}function lN(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function C1(e,t,n){var r=e._x0,s=e._y0,i=e._x1,l=e._y1,o=(i-r)/3;e._context.bezierCurveTo(r+o,s+o*t,i-o,l-o*n,i,l)}function Qp(e){this._context=e}Qp.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:C1(this,this._t0,lN(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,C1(this,lN(this,n=oN(this,e,t)),n);break;default:C1(this,this._t0,n=oN(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function S8(e){this._context=new _8(e)}(S8.prototype=Object.create(Qp.prototype)).point=function(e,t){Qp.prototype.point.call(this,t,e)};function _8(e){this._context=e}_8.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,s,i){this._context.bezierCurveTo(t,e,r,n,i,s)}};function BW(e){return new Qp(e)}function zW(e){return new S8(e)}function A8(e){this._context=e}A8.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=cN(e),s=cN(t),i=0,l=1;l<n;++i,++l)this._context.bezierCurveTo(r[0][i],s[0][i],r[1][i],s[1][i],e[l],t[l]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function cN(e){var t,n=e.length-1,r,s=new Array(n),i=new Array(n),l=new Array(n);for(s[0]=0,i[0]=2,l[0]=e[0]+2*e[1],t=1;t<n-1;++t)s[t]=1,i[t]=4,l[t]=4*e[t]+2*e[t+1];for(s[n-1]=2,i[n-1]=7,l[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=s[t]/i[t-1],i[t]-=r,l[t]-=r*l[t-1];for(s[n-1]=l[n-1]/i[n-1],t=n-2;t>=0;--t)s[t]=(l[t]-s[t+1])/i[t];for(i[n-1]=(e[n]+s[n-1])/2,t=0;t<n-1;++t)i[t]=2*e[t+1]-s[t+1];return[s,i]}function UW(e){return new A8(e)}function sg(e,t){this._context=e,this._t=t}sg.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function qW(e){return new sg(e,.5)}function HW(e){return new sg(e,0)}function WW(e){return new sg(e,1)}function zu(e,t){if((l=e.length)>1)for(var n=1,r,s,i=e[t[0]],l,o=i.length;n<l;++n)for(s=i,i=e[t[n]],r=0;r<o;++r)i[r][1]+=i[r][0]=isNaN(s[r][1])?s[r][0]:s[r][1]}function Uu(e){for(var t=e.length,n=new Array(t);--t>=0;)n[t]=t;return n}function VW(e,t){return e[t]}function GW(e){const t=[];return t.key=e,t}function YW(){var e=yn([]),t=Uu,n=zu,r=VW;function s(i){var l=Array.from(e.apply(this,arguments),GW),o,c=l.length,u=-1,d;for(const f of i)for(o=0,++u;o<c;++o)(l[o][u]=[0,+r(f,l[o].key,u,i)]).data=f;for(o=0,d=tg(t(l));o<c;++o)l[d[o]].index=o;return n(l,d),l}return s.keys=function(i){return arguments.length?(e=typeof i=="function"?i:yn(Array.from(i)),s):e},s.value=function(i){return arguments.length?(r=typeof i=="function"?i:yn(+i),s):r},s.order=function(i){return arguments.length?(t=i==null?Uu:typeof i=="function"?i:yn(Array.from(i)),s):t},s.offset=function(i){return arguments.length?(n=i??zu,s):n},s}function JW(e,t){if((r=e.length)>0){for(var n,r,s=0,i=e[0].length,l;s<i;++s){for(l=n=0;n<r;++n)l+=e[n][s][1]||0;if(l)for(n=0;n<r;++n)e[n][s][1]/=l}zu(e,t)}}function ZW(e,t){if((c=e.length)>0)for(var n,r=0,s,i,l,o,c,u=e[t[0]].length;r<u;++r)for(l=o=0,n=0;n<c;++n)(i=(s=e[t[n]][r])[1]-s[0])>0?(s[0]=l,s[1]=l+=i):i<0?(s[1]=o,s[0]=o+=i):(s[0]=0,s[1]=i)}function XW(e,t){if((s=e.length)>0){for(var n=0,r=e[t[0]],s,i=r.length;n<i;++n){for(var l=0,o=0;l<s;++l)o+=e[l][n][1]||0;r[n][1]+=r[n][0]=-o/2}zu(e,t)}}function KW(e,t){if(!(!((l=e.length)>0)||!((i=(s=e[t[0]]).length)>0))){for(var n=0,r=1,s,i,l;r<i;++r){for(var o=0,c=0,u=0;o<l;++o){for(var d=e[t[o]],f=d[r][1]||0,m=d[r-1][1]||0,h=(f-m)/2,x=0;x<o;++x){var y=e[t[x]],p=y[r][1]||0,g=y[r-1][1]||0;h+=p-g}c+=f,u+=h*f}s[r-1][1]+=s[r-1][0]=n,c&&(n-=u/c)}s[r-1][1]+=s[r-1][0]=n,zu(e,t)}}function k8(e){var t=e.map(QW);return Uu(e).sort(function(n,r){return t[n]-t[r]})}function QW(e){for(var t=-1,n=0,r=e.length,s,i=-1/0;++t<r;)(s=+e[t][1])>i&&(i=s,n=t);return n}function E8(e){var t=e.map(C8);return Uu(e).sort(function(n,r){return t[n]-t[r]})}function C8(e){for(var t=0,n=-1,r=e.length,s;++n<r;)(s=+e[n][1])&&(t+=s);return t}function eV(e){return E8(e).reverse()}function tV(e){var t=e.length,n,r,s=e.map(C8),i=k8(e),l=0,o=0,c=[],u=[];for(n=0;n<t;++n)r=i[n],l<o?(l+=s[r],c.push(r)):(o+=s[r],u.push(r));return u.reverse().concat(c)}function nV(e){return Uu(e).reverse()}const wm=e=>()=>e;function rV(e,{sourceEvent:t,target:n,transform:r,dispatch:s}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:s}})}function co(e,t,n){this.k=e,this.x=t,this.y=n}co.prototype={constructor:co,scale:function(e){return e===1?this:new co(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new co(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var ig=new co(1,0,0);P8.prototype=co.prototype;function P8(e){for(;!e.__zoom;)if(!(e=e.parentNode))return ig;return e.__zoom}function P1(e){e.stopImmediatePropagation()}function Gd(e){e.preventDefault(),e.stopImmediatePropagation()}function sV(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function iV(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function uN(){return this.__zoom||ig}function aV(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function oV(){return navigator.maxTouchPoints||"ontouchstart"in this}function lV(e,t,n){var r=e.invertX(t[0][0])-n[0][0],s=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],l=e.invertY(t[1][1])-n[1][1];return e.translate(s>r?(r+s)/2:Math.min(0,r)||Math.max(0,s),l>i?(i+l)/2:Math.min(0,i)||Math.max(0,l))}function cV(){var e=sV,t=iV,n=lV,r=aV,s=oV,i=[0,1/0],l=[[-1/0,-1/0],[1/0,1/0]],o=250,c=x6,u=uc("start","zoom","end"),d,f,m,h=500,x=150,y=0,p=10;function g($){$.property("__zoom",uN).on("wheel.zoom",M).on("mousedown.zoom",S).on("dblclick.zoom",C).filter(s).on("touchstart.zoom",_).on("touchmove.zoom",T).on("touchend.zoom touchcancel.zoom",B).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}g.transform=function($,D,L,O){var W=$.selection?$.selection():$;W.property("__zoom",uN),$!==W?A($,D,L,O):W.interrupt().each(function(){P(this,arguments).event(O).start().zoom(null,typeof D=="function"?D.apply(this,arguments):D).end()})},g.scaleBy=function($,D,L,O){g.scaleTo($,function(){var W=this.__zoom.k,E=typeof D=="function"?D.apply(this,arguments):D;return W*E},L,O)},g.scaleTo=function($,D,L,O){g.transform($,function(){var W=t.apply(this,arguments),E=this.__zoom,H=L==null?N(W):typeof L=="function"?L.apply(this,arguments):L,V=E.invert(H),R=typeof D=="function"?D.apply(this,arguments):D;return n(v(w(E,R),H,V),W,l)},L,O)},g.translateBy=function($,D,L,O){g.transform($,function(){return n(this.__zoom.translate(typeof D=="function"?D.apply(this,arguments):D,typeof L=="function"?L.apply(this,arguments):L),t.apply(this,arguments),l)},null,O)},g.translateTo=function($,D,L,O,W){g.transform($,function(){var E=t.apply(this,arguments),H=this.__zoom,V=O==null?N(E):typeof O=="function"?O.apply(this,arguments):O;return n(ig.translate(V[0],V[1]).scale(H.k).translate(typeof D=="function"?-D.apply(this,arguments):-D,typeof L=="function"?-L.apply(this,arguments):-L),E,l)},O,W)};function w($,D){return D=Math.max(i[0],Math.min(i[1],D)),D===$.k?$:new co(D,$.x,$.y)}function v($,D,L){var O=D[0]-L[0]*$.k,W=D[1]-L[1]*$.k;return O===$.x&&W===$.y?$:new co($.k,O,W)}function N($){return[(+$[0][0]+ +$[1][0])/2,(+$[0][1]+ +$[1][1])/2]}function A($,D,L,O){$.on("start.zoom",function(){P(this,arguments).event(O).start()}).on("interrupt.zoom end.zoom",function(){P(this,arguments).event(O).end()}).tween("zoom",function(){var W=this,E=arguments,H=P(W,E).event(O),V=t.apply(W,E),R=L==null?N(V):typeof L=="function"?L.apply(W,E):L,q=Math.max(V[1][0]-V[0][0],V[1][1]-V[0][1]),F=W.__zoom,G=typeof D=="function"?D.apply(W,E):D,ee=c(F.invert(R).concat(q/F.k),G.invert(R).concat(q/G.k));return function(ae){if(ae===1)ae=G;else{var re=ee(ae),Q=q/re[2];ae=new co(Q,R[0]-re[0]*Q,R[1]-re[1]*Q)}H.zoom(null,ae)}})}function P($,D,L){return!L&&$.__zooming||new U($,D)}function U($,D){this.that=$,this.args=D,this.active=0,this.sourceEvent=null,this.extent=t.apply($,D),this.taps=0}U.prototype={event:function($){return $&&(this.sourceEvent=$),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function($,D){return this.mouse&&$!=="mouse"&&(this.mouse[1]=D.invert(this.mouse[0])),this.touch0&&$!=="touch"&&(this.touch0[1]=D.invert(this.touch0[0])),this.touch1&&$!=="touch"&&(this.touch1[1]=D.invert(this.touch1[0])),this.that.__zoom=D,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function($){var D=Ls(this.that).datum();u.call($,this.that,new rV($,{sourceEvent:this.sourceEvent,target:g,transform:this.that.__zoom,dispatch:u}),D)}};function M($,...D){if(!e.apply(this,arguments))return;var L=P(this,D).event($),O=this.__zoom,W=Math.max(i[0],Math.min(i[1],O.k*Math.pow(2,r.apply(this,arguments)))),E=Ni($);if(L.wheel)(L.mouse[0][0]!==E[0]||L.mouse[0][1]!==E[1])&&(L.mouse[1]=O.invert(L.mouse[0]=E)),clearTimeout(L.wheel);else{if(O.k===W)return;L.mouse=[E,O.invert(E)],Yl(this),L.start()}Gd($),L.wheel=setTimeout(H,x),L.zoom("mouse",n(v(w(O,W),L.mouse[0],L.mouse[1]),L.extent,l));function H(){L.wheel=null,L.end()}}function S($,...D){if(m||!e.apply(this,arguments))return;var L=P(this,D,!0).event($),O=Ls($.view).on("mousemove.zoom",R,!0).on("mouseup.zoom",q,!0),W=Ni($,E),E=$.currentTarget,H=$.clientX,V=$.clientY;A0($.view),P1($),L.mouse=[W,this.__zoom.invert(W)],Yl(this),L.start();function R(F){if(Gd(F),!L.moved){var G=F.clientX-H,ee=F.clientY-V;L.moved=G*G+ee*ee>y}L.event(F).zoom("mouse",n(v(L.that.__zoom,L.mouse[0]=Ni(F,E),L.mouse[1]),L.extent,l))}function q(F){O.on("mousemove.zoom mouseup.zoom",null),k0(F.view,L.moved),Gd(F),L.event(F).end()}}function C($,...D){if(e.apply(this,arguments)){var L=this.__zoom,O=Ni($.changedTouches?$.changedTouches[0]:$,this),W=L.invert(O),E=L.k*($.shiftKey?.5:2),H=n(v(w(L,E),O,W),t.apply(this,D),l);Gd($),o>0?Ls(this).transition().duration(o).call(A,H,O,$):Ls(this).call(g.transform,H,O,$)}}function _($,...D){if(e.apply(this,arguments)){var L=$.touches,O=L.length,W=P(this,D,$.changedTouches.length===O).event($),E,H,V,R;for(P1($),H=0;H<O;++H)V=L[H],R=Ni(V,this),R=[R,this.__zoom.invert(R),V.identifier],W.touch0?!W.touch1&&W.touch0[2]!==R[2]&&(W.touch1=R,W.taps=0):(W.touch0=R,E=!0,W.taps=1+!!d);d&&(d=clearTimeout(d)),E&&(W.taps<2&&(f=R[0],d=setTimeout(function(){d=null},h)),Yl(this),W.start())}}function T($,...D){if(this.__zooming){var L=P(this,D).event($),O=$.changedTouches,W=O.length,E,H,V,R;for(Gd($),E=0;E<W;++E)H=O[E],V=Ni(H,this),L.touch0&&L.touch0[2]===H.identifier?L.touch0[0]=V:L.touch1&&L.touch1[2]===H.identifier&&(L.touch1[0]=V);if(H=L.that.__zoom,L.touch1){var q=L.touch0[0],F=L.touch0[1],G=L.touch1[0],ee=L.touch1[1],ae=(ae=G[0]-q[0])*ae+(ae=G[1]-q[1])*ae,re=(re=ee[0]-F[0])*re+(re=ee[1]-F[1])*re;H=w(H,Math.sqrt(ae/re)),V=[(q[0]+G[0])/2,(q[1]+G[1])/2],R=[(F[0]+ee[0])/2,(F[1]+ee[1])/2]}else if(L.touch0)V=L.touch0[0],R=L.touch0[1];else return;L.zoom("touch",n(v(H,V,R),L.extent,l))}}function B($,...D){if(this.__zooming){var L=P(this,D).event($),O=$.changedTouches,W=O.length,E,H;for(P1($),m&&clearTimeout(m),m=setTimeout(function(){m=null},h),E=0;E<W;++E)H=O[E],L.touch0&&L.touch0[2]===H.identifier?delete L.touch0:L.touch1&&L.touch1[2]===H.identifier&&delete L.touch1;if(L.touch1&&!L.touch0&&(L.touch0=L.touch1,delete L.touch1),L.touch0)L.touch0[1]=this.__zoom.invert(L.touch0[0]);else if(L.end(),L.taps===2&&(H=Ni(H,this),Math.hypot(f[0]-H[0],f[1]-H[1])<p)){var V=Ls(this).on("dblclick.zoom");V&&V.apply(this,arguments)}}}return g.wheelDelta=function($){return arguments.length?(r=typeof $=="function"?$:wm(+$),g):r},g.filter=function($){return arguments.length?(e=typeof $=="function"?$:wm(!!$),g):e},g.touchable=function($){return arguments.length?(s=typeof $=="function"?$:wm(!!$),g):s},g.extent=function($){return arguments.length?(t=typeof $=="function"?$:wm([[+$[0][0],+$[0][1]],[+$[1][0],+$[1][1]]]),g):t},g.scaleExtent=function($){return arguments.length?(i[0]=+$[0],i[1]=+$[1],g):[i[0],i[1]]},g.translateExtent=function($){return arguments.length?(l[0][0]=+$[0][0],l[1][0]=+$[1][0],l[0][1]=+$[0][1],l[1][1]=+$[1][1],g):[[l[0][0],l[0][1]],[l[1][0],l[1][1]]]},g.constrain=function($){return arguments.length?(n=$,g):n},g.duration=function($){return arguments.length?(o=+$,g):o},g.interpolate=function($){return arguments.length?(c=$,g):c},g.on=function(){var $=u.on.apply(u,arguments);return $===u?g:$},g.clickDistance=function($){return arguments.length?(y=($=+$)*$,g):Math.sqrt(y)},g.tapDistance=function($){return arguments.length?(p=+$,g):p},g}const uV=Object.freeze(Object.defineProperty({__proto__:null,Adder:ns,Delaunay:ky,FormatSpecifier:D0,InternMap:vj,InternSet:ST,Voronoi:$6,active:bF,arc:oW,area:i8,areaRadial:iN,ascending:Vr,autoType:MO,axisBottom:hL,axisLeft:mL,axisRight:fL,axisTop:dL,bin:o5,bisect:el,bisectCenter:mT,bisectLeft:hT,bisectRight:el,bisector:w0,blob:FO,brush:TF,brushSelection:CF,brushX:PF,brushY:IF,buffer:DO,chord:MF,chordDirected:$F,chordTranspose:RF,cluster:tz,color:tl,contourDensity:iO,contours:R6,count:N0,create:YM,creator:S0,cross:bT,csv:UO,csvFormat:jO,csvFormatBody:SO,csvFormatRow:AO,csvFormatRows:_O,csvFormatValue:kO,csvParse:O6,csvParseRows:NO,cubehelix:aa,cumsum:vT,curveBasis:kW,curveBasisClosed:EW,curveBasisOpen:CW,curveBumpX:PW,curveBumpY:IW,curveBundle:TW,curveCardinal:LW,curveCardinalClosed:MW,curveCardinalOpen:RW,curveCatmullRom:$W,curveCatmullRomClosed:FW,curveCatmullRomOpen:OW,curveLinear:ng,curveLinearClosed:DW,curveMonotoneX:BW,curveMonotoneY:zW,curveNatural:UW,curveStep:qW,curveStepAfter:WW,curveStepBefore:HW,descending:wT,deviation:bj,difference:QT,disjoint:eL,dispatch:uc,drag:nR,dragDisable:A0,dragEnable:k0,dsv:zO,dsvFormat:$0,easeBack:C5,easeBackIn:dF,easeBackInOut:C5,easeBackOut:fF,easeBounce:qf,easeBounceIn:cF,easeBounceInOut:uF,easeBounceOut:qf,easeCircle:E5,easeCircleIn:Q$,easeCircleInOut:E5,easeCircleOut:eF,easeCubic:zx,easeCubicIn:W$,easeCubicInOut:zx,easeCubicOut:V$,easeElastic:P5,easeElasticIn:hF,easeElasticInOut:mF,easeElasticOut:P5,easeExp:k5,easeExpIn:X$,easeExpInOut:k5,easeExpOut:K$,easeLinear:U$,easePoly:_5,easePolyIn:G$,easePolyInOut:_5,easePolyOut:Y$,easeQuad:S5,easeQuadIn:q$,easeQuadInOut:S5,easeQuadOut:H$,easeSin:A5,easeSinIn:J$,easeSinInOut:A5,easeSinOut:Z$,every:GT,extent:wf,fcumsum:jT,filter:JT,forceCenter:ZO,forceCollide:pD,forceLink:xD,forceManyBody:AD,forceRadial:kD,forceSimulation:_D,forceX:ED,forceY:CD,get format(){return B0},formatDefaultLocale:H6,formatLocale:q6,get formatPrefix(){return Py},formatSpecifier:Wf,fsum:NT,geoAlbers:ES,geoAlbersUsa:LB,geoArea:DD,geoAzimuthalEqualArea:MB,geoAzimuthalEqualAreaRaw:By,geoAzimuthalEquidistant:RB,geoAzimuthalEquidistantRaw:zy,geoBounds:qD,geoCentroid:JD,geoCircle:ZD,geoClipAntimeridian:i2,geoClipCircle:fS,geoClipExtent:rB,geoClipRectangle:z0,geoConicConformal:FB,geoConicConformalRaw:IS,geoConicEqualArea:Vp,geoConicEqualAreaRaw:kS,geoConicEquidistant:DB,geoConicEquidistantRaw:TS,geoContains:uB,geoDistance:Dp,geoEqualEarth:zB,geoEqualEarthRaw:Uy,geoEquirectangular:OB,geoEquirectangularRaw:Zf,geoGnomonic:UB,geoGnomonicRaw:qy,geoGraticule:pS,geoGraticule10:dB,geoIdentity:qB,geoInterpolate:fB,geoLength:hS,geoMercator:$B,geoMercatorRaw:vh,geoNaturalEarth1:HB,geoNaturalEarth1Raw:Hy,geoOrthographic:WB,geoOrthographicRaw:Wy,geoPath:jB,geoProjection:Fa,geoProjectionMutator:Oy,geoRotation:aS,geoStereographic:VB,geoStereographicRaw:Vy,geoStream:Ki,geoTransform:SB,geoTransverseMercator:GB,geoTransverseMercatorRaw:Gy,gray:fR,greatest:BT,greatestIndex:zT,group:Sj,groupSort:CT,groups:_T,hcl:vp,hierarchy:Yy,histogram:o5,hsl:xp,html:YO,image:HO,index:kT,indexes:ET,interpolate:ll,interpolateArray:yR,interpolateBasis:s6,interpolateBasisClosed:i6,interpolateBlues:MH,interpolateBrBG:hH,interpolateBuGn:NH,interpolateBuPu:jH,interpolateCividis:BH,interpolateCool:qH,interpolateCubehelix:LR,interpolateCubehelixDefault:zH,interpolateCubehelixLong:T0,interpolateDate:d6,interpolateDiscrete:wR,interpolateGnBu:SH,interpolateGreens:RH,interpolateGreys:$H,interpolateHcl:IR,interpolateHclLong:TR,interpolateHsl:ER,interpolateHslLong:CR,interpolateHue:NR,interpolateInferno:XH,interpolateLab:PR,interpolateMagma:ZH,interpolateNumber:Mi,interpolateNumberArray:xy,interpolateObject:f6,interpolateOrRd:_H,interpolateOranges:DH,interpolatePRGn:mH,interpolatePiYG:pH,interpolatePlasma:KH,interpolatePuBu:kH,interpolatePuBuGn:AH,interpolatePuOr:gH,interpolatePuRd:EH,interpolatePurples:FH,interpolateRainbow:HH,interpolateRdBu:xH,interpolateRdGy:yH,interpolateRdPu:CH,interpolateRdYlBu:bH,interpolateRdYlGn:vH,interpolateReds:OH,interpolateRgb:Bf,interpolateRgbBasis:l6,interpolateRgbBasisClosed:xR,interpolateRound:I0,interpolateSinebow:GH,interpolateSpectral:wH,interpolateString:yy,interpolateTransformCss:p6,interpolateTransformSvg:g6,interpolateTurbo:YH,interpolateViridis:JH,interpolateWarm:UH,interpolateYlGn:IH,interpolateYlGnBu:PH,interpolateYlOrBr:TH,interpolateYlOrRd:LH,interpolateZoom:x6,interrupt:Yl,intersection:nL,interval:OR,isoFormat:Yq,isoParse:Zq,json:VO,lab:bp,lch:hR,least:DT,leastIndex:Tj,line:fb,lineRadial:sN,linkHorizontal:xW,linkRadial:bW,linkVertical:yW,local:qj,map:ZT,matcher:uy,max:mp,maxIndex:Pj,mean:MT,median:RT,merge:oy,min:pp,minIndex:Ij,namespace:mh,namespaces:Ix,nice:Ej,now:gh,pack:Cz,packEnclose:MS,packSiblings:Az,pairs:FT,partition:Pz,path:cl,permute:kj,pie:dW,piecewise:w6,pointRadial:gf,pointer:Ni,pointers:ZM,polygonArea:Wz,polygonCentroid:Vz,polygonContains:Zz,polygonHull:Jz,polygonLength:Xz,precisionFixed:W6,precisionPrefix:V6,precisionRound:G6,quadtree:O0,quantile:Ff,quantileSorted:Cj,quantize:MR,quickselect:ay,radialArea:iN,radialLine:sN,randomBates:tU,randomBernoulli:sU,randomBeta:HS,randomBinomial:WS,randomCauchy:aU,randomExponential:nU,randomGamma:Zy,randomGeometric:qS,randomInt:Qz,randomIrwinHall:US,randomLcg:dU,randomLogNormal:eU,randomLogistic:oU,randomNormal:Jy,randomPareto:rU,randomPoisson:lU,randomUniform:Kz,randomWeibull:iU,range:Aa,reduce:XT,reverse:KT,rgb:Pu,ribbon:WF,ribbonArrow:VF,rollup:_j,rollups:AT,scaleBand:Ky,scaleDiverging:E_,scaleDivergingLog:C_,scaleDivergingPow:cb,scaleDivergingSqrt:nH,scaleDivergingSymlog:P_,scaleIdentity:JS,scaleImplicit:y2,scaleLinear:YS,scaleLog:XS,scaleOrdinal:Xy,scalePoint:fU,scalePow:rb,scaleQuantile:e_,scaleQuantize:t_,scaleRadial:QS,scaleSequential:S_,scaleSequentialLog:__,scaleSequentialPow:lb,scaleSequentialQuantile:k_,scaleSequentialSqrt:tH,scaleSequentialSymlog:A_,scaleSqrt:SU,scaleSymlog:KS,scaleThreshold:n_,scaleTime:Qq,scaleUtc:eH,scan:UT,schemeAccent:sH,schemeBlues:K_,schemeBrBG:I_,schemeBuGn:B_,schemeBuPu:z_,schemeCategory10:rH,schemeDark2:iH,schemeGnBu:U_,schemeGreens:Q_,schemeGreys:e8,schemeOrRd:q_,schemeOranges:r8,schemePRGn:T_,schemePaired:aH,schemePastel1:oH,schemePastel2:lH,schemePiYG:L_,schemePuBu:W_,schemePuBuGn:H_,schemePuOr:M_,schemePuRd:V_,schemePurples:t8,schemeRdBu:R_,schemeRdGy:$_,schemeRdPu:G_,schemeRdYlBu:F_,schemeRdYlGn:O_,schemeReds:n8,schemeSet1:cH,schemeSet2:uH,schemeSet3:dH,schemeSpectral:D_,schemeTableau10:fH,schemeYlGn:J_,schemeYlGnBu:Y_,schemeYlOrBr:Z_,schemeYlOrRd:X_,select:Ls,selectAll:XM,selection:dc,selector:_0,selectorAll:cy,shuffle:qT,shuffler:Lj,some:YT,sort:_x,stack:YW,stackOffsetDiverging:ZW,stackOffsetExpand:JW,stackOffsetNone:zu,stackOffsetSilhouette:XW,stackOffsetWiggle:KW,stackOrderAppearance:k8,stackOrderAscending:E8,stackOrderDescending:eV,stackOrderInsideOut:tV,stackOrderNone:Uu,stackOrderReverse:nV,stratify:Mz,style:Kl,subset:rL,sum:HT,superset:Rj,svg:JO,symbol:AW,symbolCircle:pb,symbolCross:l8,symbolDiamond:u8,symbolSquare:h8,symbolStar:f8,symbolTriangle:m8,symbolWye:p8,symbols:_W,text:F0,thresholdFreedmanDiaconis:TT,thresholdScott:LT,thresholdSturges:iy,tickFormat:GS,tickIncrement:hh,tickStep:Eu,ticks:$f,timeDay:ed,timeDays:EU,get timeFormat(){return ib},timeFormatDefaultLocale:N_,timeFormatLocale:g_,timeFriday:i_,timeFridays:LU,timeHour:V0,timeHours:kU,timeInterval:rs,timeMillisecond:Ou,timeMilliseconds:zw,timeMinute:W0,timeMinutes:AU,timeMonday:Xf,timeMondays:CU,timeMonth:G0,timeMonths:RU,get timeParse(){return w_},timeSaturday:a_,timeSaturdays:MU,timeSecond:lo,timeSeconds:qw,timeSunday:Du,timeSundays:Hw,timeThursday:sc,timeThursdays:TU,timeTickInterval:p_,timeTicks:m_,timeTuesday:r_,timeTuesdays:PU,timeWednesday:s_,timeWednesdays:IU,timeWeek:Du,timeWeeks:Hw,timeYear:Ma,timeYears:$U,timeout:Fx,timer:M0,timerFlush:S6,transition:E6,transpose:Mj,tree:Bz,treemap:zz,treemapBinary:Uz,treemapDice:wh,treemapResquarify:Hz,treemapSlice:q0,treemapSliceDice:qz,treemapSquarify:zS,tsv:qO,tsvFormat:CO,tsvFormatBody:PO,tsvFormatRow:TO,tsvFormatRows:IO,tsvFormatValue:LO,tsvParse:D6,tsvParseRows:EO,union:sL,utcDay:td,utcDays:DU,get utcFormat(){return X0},utcFriday:c_,utcFridays:HU,utcHour:J0,utcHours:OU,utcMillisecond:Ou,utcMilliseconds:zw,utcMinute:Y0,utcMinutes:FU,utcMonday:Kf,utcMondays:BU,utcMonth:Z0,utcMonths:VU,get utcParse(){return ab},utcSaturday:u_,utcSaturdays:WU,utcSecond:lo,utcSeconds:qw,utcSunday:Bu,utcSundays:Ww,utcThursday:ic,utcThursdays:qU,utcTickInterval:h_,utcTicks:f_,utcTuesday:o_,utcTuesdays:zU,utcWednesday:l_,utcWednesdays:UU,utcWeek:Bu,utcWeeks:Ww,utcYear:Ra,utcYears:GU,variance:yj,version:uT,window:dy,xml:GO,zip:VT,zoom:cV,zoomIdentity:ig,zoomTransform:P8},Symbol.toStringTag,{value:"Module"}));var Je=typeof window=="object"&&window.d3?window.d3:uV;function dV(e,t,n){if(!t.rels.children)return;const r=t.rels.spouses||[];return e.sort((s,i)=>{const l=dN(s,t,n)||{},o=dN(i,t,n)||{},c=r.indexOf(l.id),u=r.indexOf(o.id);return t.data.gender==="M"?c-u:u-c})}function fV(e){return e.sort((t,n)=>{const r=t._new_rel_data,s=n._new_rel_data;return r&&!s?1:!r&&s?-1:0})}function dN(e,t,n){return n.find(r=>r.id!==t.id&&(r.id===e.rels.mother||r.id===e.rels.father))}function qu(e,t,n){if(e.exiting=n,t)e.depth===0&&!e.spouse?(e._x=e.x,e._y=e.y):e.spouse?(e._x=e.spouse.x,e._y=e.spouse.y):e.is_ancestry?(e._x=e.parent.x,e._y=e.parent.y):(e._x=e.psx,e._y=e.psy);else if(n){const r=e.x>0?1:-1,s=e.y>0?1:-1;e._x=e.x+400*r,e._y=e.y+400*s}}function I8(e,t){const n=t?"rels":"_rels",r=t?"_rels":"rels";e.is_ancestry||e.data.main?(s("father"),s("mother")):i();function s(l){!e.data[n]||!e.data[n][l]||(e.data[r]||(e.data[r]={}),e.data[r][l]=e.data[n][l],delete e.data[n][l])}function i(){if(!e.data[n]||!e.data[n].children)return;const l=e.data[n].children.slice(0),o=e.spouse?[e.spouse]:e.spouses||[];[e,...o].forEach(c=>l.forEach(u=>{c.data[n].children.includes(u)&&(c.data[r]||(c.data[r]={}),c.data[r].children||(c.data[r].children=[]),c.data[r].children.push(u),c.data[n].children.splice(c.data[n].children.indexOf(u),1))}))}}function hV(e,t){e.forEach(n=>{n.data.hide_rels=t,I8(n,t)})}function mV({tree:e,data_stash:t,node_separation:n,sortChildrenFunction:r}){const s=e.find(m=>m.data.main),i=s.data.rels.father,l=s.data.rels.mother,o=u(),c=d();f();function u(){return t.filter(m=>m.id===s.data.id?!1:!!(i&&m.rels.father===i||l&&m.rels.mother===l))}function d(){const m=[];for(let h=0;h<o.length;h++){const x={data:o[h],sibling:!0};x.parents=[];const y=s.parents.find(g=>g.data.id===x.data.rels.father),p=s.parents.find(g=>g.data.id===x.data.rels.mother);y&&x.parents.push(y),p&&x.parents.push(p),x.x=void 0,x.y=s.y,x.depth=s.depth-1,e.push(x),m.push(x)}return m}function f(){const m=[s,...c];r&&m.sort((g,w)=>r(g.data,w.data)),m.sort((g,w)=>{const v=s.parents.find(U=>U.data.id===g.data.rels.father),N=s.parents.find(U=>U.data.id===g.data.rels.mother),A=s.parents.find(U=>U.data.id===w.data.rels.father),P=s.parents.find(U=>U.data.id===w.data.rels.mother);return!N&&P?-1:N&&!P||!v&&A?1:v&&!A?-1:0});const h=s.x,x=(s.spouses||[]).map(g=>g.x),y=Je.extent([h,...x]),p=m.findIndex(g=>g.data.id===s.data.id);for(let g=0;g<m.length;g++){if(g===p)continue;const w=m[g];g<p?w.x=y[0]-n*(p-g):w.x=y[1]+n*(g-p)}}}function pV({tree:e,data_stash:t,private_cards_config:n}){const r={},s=n.condition;if(!s)return console.error("private_cards_config.condition is not set");e.forEach(l=>{if(l.data._new_rel_data)return;const o=i(l.data.id);o&&(l.is_private=o)});function i(l){const o=[];let c=!1;return u(l),r[l]=c,c;function u(d){if(c)return;if(r.hasOwnProperty(d))return c=r[d],c;const f=t.find(h=>h.id===d);if(f._new_rel_data)return;if(s(f))return c=!0,!0;const m=f.rels;[m.father,m.mother,...m.spouses||[]].forEach(h=>{h&&(o.includes(h)||(o.push(h),u(h)))})}}}function gV(e,t){const n=t.find(o=>o.id===e),r=Je.hierarchy(n,l),s=Je.hierarchy(n,i);return{ancestry:r.height,progeny:s.height};function i(o){return[...o.rels.children||[]].map(c=>t.find(u=>u.id===c)).filter(c=>c&&!c._new_rel_data&&!c.to_add)}function l(o){return[o.rels.father,o.rels.mother].filter(c=>c).map(c=>t.find(u=>u.id===c)).filter(c=>c&&!c._new_rel_data&&!c.to_add)}}function T8(e,t){const n=e.rels,r=[n.father,n.mother,...n.spouses||[],...n.children||[]].filter(s=>!!s);for(const s of r){const i=t.find(l=>l.id===s);if(!vb(i,t,[e.id]))return!1}return!0}function vb(e,t,n=[]){const r=t[0];if(e.id===r.id)return!0;const s=[...n];let i=!1;return l(e),i;function l(o){if(i)return;const c=o.rels;[c.father,c.mother,...c.spouses||[],...c.children||[]].filter(d=>!!d).forEach(d=>{if(s.includes(d))return;s.push(d);const f=t.find(m=>m.id===d);f.id===r.id?i=!0:l(f)})}}function L8(e,t,n){const r=e.id;n.forEach(l=>{l.rels.father===r&&(l.rels.father=t),l.rels.mother===r&&(l.rels.mother=t),(l.rels.spouses||[]).includes(r)&&(l.rels.spouses=l.rels.spouses.filter(o=>o!==r),l.rels.spouses.includes(t)||l.rels.spouses.push(t)),(l.rels.children||[]).includes(r)&&(l.rels.children=l.rels.children.filter(o=>o!==r),l.rels.children.includes(t)||l.rels.children.push(t))});const s=n.find(l=>l.id===t),i=n.find(l=>l.id===r);(i.rels.children||[]).forEach(l=>{s.rels.children||(s.rels.children=[]),s.rels.children.includes(l)||s.rels.children.push(l)}),(i.rels.spouses||[]).forEach(l=>{s.rels.spouses||(s.rels.spouses=[]),s.rels.spouses.includes(l)||s.rels.spouses.push(l)}),s.rels.father&&i.rels.father&&console.error("link rel already has father"),s.rels.mother&&i.rels.mother&&console.error("link rel already has mother"),i.rels.father&&(s.rels.father=i.rels.father),i.rels.mother&&(s.rels.mother=i.rels.mother),n.splice(n.findIndex(l=>l.id===r),1)}function xV(e,t){const n=e._new_rel_data?t.find(o=>o.id===e._new_rel_data.rel_id):null,r=i(e,t),s=l(e,t);return e._new_rel_data&&["son","daughter"].includes(e._new_rel_data.rel_type)&&s.push(...l(n,t)),t.filter(o=>o.id!==e.id&&o.id!==(n==null?void 0:n.id)&&!o._new_rel_data&&!o.to_add&&!o.unknown).filter(o=>!r.includes(o.id)).filter(o=>!s.includes(o.id)).filter(o=>!(o.rels.spouses||[]).includes(e.id));function i(o,c){const u=[];return d(o),u;function d(f){[f.rels.father,f.rels.mother].forEach(h=>{h&&(u.push(h),d(c.find(x=>x.id===h)))})}}function l(o,c){const u=[];return d(o),u;function d(f){(f.rels.children?[...f.rels.children]:[]).forEach(h=>{u.push(h),d(c.find(x=>x.id===h))})}}}function yV({datum:e,store:t,fields:n,postSubmit:r,addRelative:s,removeRelative:i,deletePerson:l,onCancel:o,editFirst:c,link_existing_rel_config:u,getKinshipInfo:d,onFormCreation:f}){const m={datum_id:e.id,fields:[],onSubmit:g,getKinshipInfo:d,onFormCreation:f};e._new_rel_data||(m.onDelete=v,m.addRelative=()=>s.activate(e),m.addRelativeCancel=()=>s.onCancel(),m.addRelativeActive=s.is_active,m.removeRelative=()=>i.activate(e),m.removeRelativeCancel=()=>i.onCancel(),m.removeRelativeActive=i.is_active,m.editable=!1),e._new_rel_data&&(m.title=e._new_rel_data.label,m.new_rel=!0,m.editable=!0,m.onCancel=o),(e._new_rel_data||e.to_add||e.unknown)&&u&&(m.linkExistingRelative=p(e,t.getData(),u)),m.onDelete&&(m.can_delete=!0),c&&(m.editable=!0);const h=(e.rels.children||[]).some(N=>!t.getDatum(N)._new_rel_data);return m.gender_field={id:"gender",type:"switch",label:"Gender",initial_value:e.data.gender,disabled:["father","mother"].some(N=>{var A;return N===((A=e._new_rel_data)==null?void 0:A.rel_type)})||h,options:[{value:"M",label:"Male"},{value:"F",label:"Female"}]},n.forEach(N=>{N.type==="rel_reference"?x(N):N.type==="select"?y(N):m.fields.push({id:N.id,type:N.type,label:N.label,initial_value:e.data[N.id]})}),m;function x(N){N.getRelLabel||console.error("getRelLabel is not set"),N.rel_type==="spouse"&&(e.rels.spouses||[]).forEach(A=>{const P=t.getDatum(A),U=`${N.id}__ref__${A}`;m.fields.push({id:U,type:"rel_reference",label:N.label,rel_id:A,rel_label:N.getRelLabel(P),initial_value:e.data[U]})})}function y(N){if(!N.optionCreator&&!N.options)return console.error("optionCreator or options is not set for field",N);m.fields.push({id:N.id,type:N.type,label:N.label,initial_value:e.data[N.id],placeholder:N.placeholder,options:N.options||N.optionCreator(e)})}function p(N,A,P){return{label:P.label,options:xV(N,A).map(M=>({value:M.id,label:P.linkRelLabel(M)})).sort((M,S)=>typeof M.label=="string"&&typeof S.label=="string"?M.label.localeCompare(S.label):M.label<S.label?-1:1),onSelect:w}}function g(N){N.preventDefault(),new FormData(N.target).forEach((P,U)=>e.data[U]=P),M8(e,t.getData()),e.to_add&&delete e.to_add,e.unknown&&delete e.unknown,r()}function w(N){const A=N.target.value;r({link_rel_id:A})}function v(){l(),r({delete:!0})}}function M8(e,t){Object.keys(e.data).forEach(n=>{if(n.includes("__ref__")){const r=n.split("__ref__")[1],s=t.find(l=>l.id===r);if(!s)return;const i=n.split("__ref__")[0]+"__ref__"+e.id;s.data[i]=e.data[n]}})}function w2(e,t){Object.keys(e.data).forEach(n=>{if(n.includes("__ref__")){const r=n.split("__ref__")[1],s=t.find(l=>l.id===r);if(!s)return;const i=n.split("__ref__")[0]+"__ref__"+e.id;delete s.data[i]}})}function R8(e,t){return delete e.to_add,e}function e0(e,t){return ag(e,t),!1}function ag(e,t){if(T8(e,t))return n(),{success:!0};return r(),{success:!0};function n(){t.forEach(s=>{for(let i in s.rels)s.rels.hasOwnProperty(i)&&(s.rels[i]===e.id?delete s.rels[i]:Array.isArray(s.rels[i])&&s.rels[i].includes(e.id)&&s.rels[i].splice(s.rels[i].findIndex(l=>l===e.id),1))}),w2(e,t),t.splice(t.findIndex(s=>s.id===e.id),1),t.length===0&&t.push(D8({}).data[0])}function r(){w2(e,t),e.data={gender:e.data.gender},e.unknown=!0}}function bV(e){return $8(e),e.forEach(t=>{delete t.main,delete t._tgdp,delete t._tgdp_sp,delete t.__tgdp_sp}),e.forEach(t=>{Object.keys(t).forEach(n=>{n[0]==="_"&&console.error("key starts with _",n)})}),e}function $8(e){for(let t=e.length-1;t>=0;t--)e[t].to_add&&e0(e[t],e)}function F8({datum:e,data_stash:t,rel_type:n,rel_datum:r}){n==="daughter"||n==="son"?s(e):n==="father"||n==="mother"?i(e):n==="spouse"&&l(e);function s(o){return o.data.other_parent&&(c(o.data.other_parent),delete o.data.other_parent),o.rels[r.data.gender==="M"?"father":"mother"]=r.id,r.rels.children||(r.rels.children=[]),r.rels.children.push(o.id),o;function c(u){u==="_new"&&(u=f().id);const d=t.find(m=>m.id===u);o.rels[d.data.gender==="M"?"father":"mother"]=d.id,d.rels.hasOwnProperty("children")||(d.rels.children=[]),d.rels.children.push(o.id);function f(){const m=O8({rel_type:"spouse",rel_datum:r});return l(m),wb({data_stash:t,datum:m}),m}}}function i(o){const c=o.data.gender==="M",u=r.rels[c?"father":"mother"];u&&e0(t.find(f=>f.id===u),t),d();function d(){return r.rels[c?"father":"mother"]=o.id,f(),o.rels.children=[r.id],o;function f(){const m=r.rels[c?"mother":"father"];if(!m)return;const h=t.find(x=>x.id===m);return o.rels.spouses=[m],h.rels.spouses||(h.rels.spouses=[]),h.rels.spouses.push(o.id),h}}}function l(o){c(),r.rels.spouses||(r.rels.spouses=[]),r.rels.spouses.push(o.id),o.rels.spouses=[r.id];function c(){r.rels.spouses&&r.rels.spouses.forEach(u=>{const d=t.find(f=>f.id===u);d.to_add&&e0(d,t)})}}}function Xi({data:e,rels:t}){return{id:wV(),data:e||{},rels:t||{}}}function O8({data:e,rel_type:t,rel_datum:n}){const r=s(n,t);return e=Object.assign(e||{},{gender:r}),Xi({data:e});function s(i,l){return["daughter","mother"].includes(l)||l==="spouse"&&i.data.gender==="M"?"F":"M"}}function wb({data_stash:e,datum:t}){e.push(t)}function D8({data:e,version:t}){return{data:[Xi({data:e})],version:t}}function vV({datum:e,data_stash:t,rel_type:n,rel_datum:r}){wb({data_stash:t,datum:e}),F8({datum:e,data_stash:t,rel_type:n,rel_datum:r})}function wV(){var e=new Date().getTime(),t=performance&&performance.now&&performance.now()*1e3||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var r=Math.random()*16;return e>0?(r=(e+r)%16|0,e=Math.floor(e/16)):(r=(t+r)%16|0,t=Math.floor(t/16)),(n==="x"?r:r&3|8).toString(16)})}function B8({amount:e,svg:t,transition_time:n=500}){const r=t.__zoomObj?t:t.parentNode,s=r.__zoomObj;Je.select(r).transition().duration(n||0).delay(n?100:0).call(s.scaleBy,e)}function NV(e){const t=e.__zoomObj?e:e.parentNode;return Je.zoomTransform(t)}function jV(e,t){const n=e.__zoomObj?e:e.parentNode,r=Je.zoomTransform(n);B8({amount:t/r.k,svg:e})}function z8(e,t){const n=e.data.rels;return[n.father,n.mother,...n.spouses||[],...n.children||[]].filter(s=>s).every(s=>t.some(i=>i.data.id===s))}function SV(e){e.forEach(t=>{var r;if(!t.spouse)return;const n=t.spouse;if(t.duplicate&&n.data._tgdp_sp){const s=n.data.main?"main":n.parent.data.id;(r=n.data._tgdp_sp[s])!=null&&r.hasOwnProperty(t.data.id)&&(t._toggle=n.data._tgdp_sp[s][t.data.id])}})}function _V(e,t,n=!0){const r=[];s(e),m(r);function s(h){if(!h.children)return;const x=h.data,y=(h.data.rels.spouses||[]).map(g=>t.find(w=>w.id===g)),p=f(h);y.forEach(g=>{if(r.some(v=>v.some(N=>d([x,g],[N.p1,N.p2]))))return;const w=u(h,x,g);if(w.length>0){const v=[{d:h,p1:x,p2:g},...w];r.push(v),i(v),l(v)}else{let v=e===h?"main":h.parent.data.id;o(h,v,g),(p[g.id]||[]).forEach(N=>{s(N)})}})}function i(h){if(h.forEach(({d:x,p1:y,p2:p},g)=>{x.data._tgdp_sp||(x.data._tgdp_sp={});let w=e===x?"main":x.parent.data.id;c(x,w,p),x.data._tgdp_sp[w]||(x.data._tgdp_sp[w]={});let v=1;x.data._tgdp_sp[w].hasOwnProperty(p.id)?v=x.data._tgdp_sp[w][p.id]:x.data._tgdp_sp[w][p.id]=v,h[g].val=v}),n){if(h.every(x=>x.val<0)){const x=h.sort((v,N)=>N.val-v.val)[0],{d:y,p1:p,p2:g}=x,w=e===y?"main":y.parent.data.id;y.data._tgdp_sp[w][g.id]=1}if(h.filter(x=>x.val>0).length>1){const x=h.sort((y,p)=>p.val-y.val)[0];h.forEach(y=>{if(y===x)return;const{d:p,p1:g,p2:w}=y,v=e===p?"main":p.parent.data.id;p.data._tgdp_sp[v][w.id]=-1})}}}function l(h){h.forEach(({d:x,p1:y,p2:p})=>{const g=e===x?"main":x.parent.data.id;if(x.data._tgdp_sp[g][p.id]<0){const w=f(x);w[p.id]&&(x.children=x.children.filter(v=>!w[p.id].includes(v)),x.children.length===0&&delete x.children)}})}function o(h,x,y){h.data._tgdp_sp&&h.data._tgdp_sp[x]&&h.data._tgdp_sp[x].hasOwnProperty(y.id)&&(h.data.__tgdp_sp||(h.data.__tgdp_sp={}),h.data.__tgdp_sp[x]||(h.data.__tgdp_sp[x]={}),h.data.__tgdp_sp[x][y.id]=h.data._tgdp_sp[x][y.id],delete h.data._tgdp_sp[x][y.id])}function c(h,x,y){h.data.__tgdp_sp&&h.data.__tgdp_sp[x]&&h.data.__tgdp_sp[x].hasOwnProperty(y.id)&&(h.data._tgdp_sp[x][y.id]=h.data.__tgdp_sp[x][y.id],delete h.data.__tgdp_sp[x][y.id])}function u(h,x,y){const p=[];return g(e),p;function g(w){if(w!==h&&w.children){const v=w.data,N=(w.data.rels.spouses||[]).map(P=>t.find(U=>U.id===P)),A=f(w);N.forEach(P=>{d([x,y],[v,P])?p.push({d:w,p1:v,p2:P}):(A[P.id]||[]).forEach(U=>{g(U)})})}}}function d(h,x){return h.every(y=>x.some(p=>y.id===p.id))}function f(h){const x={},y=h;return(h.children||[]).forEach(p=>{const g=p.data.rels,w=g.father===y.data.id?g.mother:g.father;x[w]||(x[w]=[]),x[w].push(p)}),x}function m(h){let x=0;h.forEach(y=>{x=x+1,y.forEach(p=>{p.d._toggle_id_sp||(p.d._toggle_id_sp={}),p.d._toggle_id_sp[p.p2.id]=x})})}}function AV(e,t=!0){const n=[];r(e),c(n);function r(u){if(u.children){if(n.some(f=>f.includes(u)))return;const d=l(u.children);if(d.length>0){const f=[u,...d];n.push(f),s(f),i(f)}else u.children.forEach(f=>{r(f)})}}function s(u){if(u.forEach(d=>{d.data._tgdp||(d.data._tgdp={});const f=e===d?"main":d.parent.data.id;d.data._tgdp[f]||(d.data._tgdp[f]=-1),d._toggle=d.data._tgdp[f]}),t){if(u.every(d=>d._toggle<0)){const f=u.sort((h,x)=>x._toggle-h._toggle)[0],m=e===f?"main":f.parent.data.id;f.data._tgdp[m]=1}if(u.filter(d=>d._toggle>0).length>1){const d=u.sort((f,m)=>m._toggle-f._toggle)[0];u.forEach(f=>{if(f===d)return;const m=f,h=e===m?"main":m.parent.data.id;m.data._tgdp[h]=-1})}}}function i(u){u.forEach(d=>{const f=e===d?"main":d.parent.data.id;d.data._tgdp[f]<0&&delete d.children})}function l(u){const d=[];return f(e),d;function f(m){m.children&&(o(u,m.children)?d.push(m):m.children.forEach(h=>{f(h)}))}}function o(u,d){return u!==d&&u.every(f=>d.some(m=>f.data.id===m.data.id))}function c(u){let d=0;u.forEach(f=>{d=d+1,f.forEach(m=>{m._toggle_id=d})})}}function U8({data:e,main_id:t=null,node_separation:n=250,level_separation:r=150,single_parent_empty_card:s=!0,is_horizontal:i=!1,one_level_rels:l=!1,sortChildrenFunction:o=void 0,sortSpousesFunction:c=void 0,ancestry_depth:u=void 0,progeny_depth:d=void 0,show_siblings_of_main:f=!1,modifyTreeHierarchy:m=void 0,private_cards_config:h=void 0,duplicate_branch_toggle:x=!1,on_toggle_one_close_others:y=!0}){if(!e||!e.length)return{data:[],data_stash:[],dim:{width:0,height:0},main_id:null};i&&([n,r]=[r,n]);const p=s?$(e):e,g=t!==null&&p.find(E=>E.id===t)||p[0],w=P(g,"children",!1),v=P(g,"parents",!0);p.forEach(E=>E.main=E===g),U(v,w);const N=M(v,w);T({tree:N}),C({tree:N,node_separation:n}),f&&!l&&mV({tree:N,data_stash:p,node_separation:n,sortChildrenFunction:o}),_({tree:N}),S({tree:N}),N.forEach(E=>E.all_rels_displayed=z8(E,N)),h&&pV({tree:N,data_stash:p,private_cards_config:h}),kV({tree:N}),O(N),x&&SV(N);const A=B(N,n,r);return{data:N,data_stash:p,dim:A,main_id:g.id,is_horizontal:i};function P(E,H,V){const R=H==="children"?fe:Se,q=Je.tree().nodeSize([n,r]).separation(G),F=Je.hierarchy(E,R);return V&&L(F),D(F,V),x&&W(F,p,V),m&&m(F,V),q(F),F.descendants();function G(pe,me){let ne=1;return V||(ee(pe,me)||(ne+=.25),l||Q(pe,me)&&(ne+=oe(pe,me)),ee(pe,me)&&!ae(pe,me)&&(ne+=.125)),ne}function ee(pe,me){return pe.parent==me.parent}function ae(pe,me){return pe.data.rels.father===me.data.rels.father&&pe.data.rels.mother===me.data.rels.mother}function re(pe){return pe.data.rels.spouses&&pe.data.rels.spouses.length>0}function Q(pe,me){return re(pe)||re(me)}function fe(pe){const me=[...pe.rels.children||[]].map(ne=>p.find(it=>it.id===ne));return o&&me.sort(o),fV(me),c&&c(pe,p),dV(me,pe,p),me}function Se(pe){return[pe.rels.father,pe.rels.mother].filter(me=>me).map(me=>p.find(ne=>ne.id===me))}function oe(pe,me){return((pe.data.rels.spouses||[]).length+(me.data.rels.spouses||[]).length)*.5}}function U(E,H){const V=(E[0].x-H[0].x)/2;E.forEach(R=>R.x-=V),H.forEach(R=>R.x+=V)}function M(E,H){return E.forEach(V=>{V.is_ancestry=!0}),E.forEach(V=>V.depth===1?V.parent=H[0]:null),[...H,...E.slice(1)]}function S({tree:E}){E.forEach(H=>{if(H.y*=H.is_ancestry?-1:1,i){const V=H.x;H.x=H.y,H.y=V}})}function C({tree:E,node_separation:H}){for(let V=E.length;V--;){const R=E[V];if(!R.is_ancestry){let q=R.data.rels.spouses;if(R._ignore_spouses&&(q=q.filter(F=>!R._ignore_spouses.includes(F))),q&&q.length>0){if(l&&R.depth>0)continue;const F=R.data.data.gender==="M"?-1:1;R.x+=q.length/2*H*F,q.forEach((G,ee)=>{if(R._ignore_spouses&&R._ignore_spouses.includes(G))return;const ae={data:p.find(re=>re.id===G),added:!0};ae.x=R.x-H*(ee+1)*F,ae.y=R.y,ae.sx=ee>0?ae.x:ae.x+H/2*F,ae.sy=ee>0?ae.y:ae.y+H/2*F,ae.depth=R.depth,ae.spouse=R,R.spouses||(R.spouses=[]),R.spouses.push(ae),E.push(ae)})}}if(R.parents&&R.parents.length===2){const q=R.parents[0],F=R.parents[1],G=q.x-(q.x-F.x)/2,ee=(ae,re)=>G+H/2*(ae.x<re.x?1:-1);F.x=ee(q,F),q.x=ee(F,q)}}}function _({tree:E}){E.forEach(H=>{if(H.is_ancestry||H.depth===0||H.added||H.sibling)return;const V=H.parent,R=(V.spouses||[]).find(F=>F.data.id===H.data.rels.father||F.data.id===H.data.rels.mother);if(V&&R){!V.added&&!R.added&&console.error("no added spouse",V,R);const F=V.added?V:R;q(H,F)}else if(V||R){const F=V||R;F.sx=F.x,F.sy=F.y,q(H,F)}function q(F,G){F.psx=i?G.y:G.sx,F.psy=i?G.sx:G.y}})}function T({tree:E}){E.forEach(H=>{delete H.children,E.forEach(V=>{V.parent===H&&(V.is_ancestry?(H.parents||(H.parents=[]),H.parents.push(V)):(H.children||(H.children=[]),H.children.push(V)))})})}function B(E,H,V){i&&([H,V]=[V,H]);const R=Je.extent(E,F=>F.x),q=Je.extent(E,F=>F.y);return{width:R[1]-R[0]+H,height:q[1]-q[0]+V,x_off:-R[0]+H/2,y_off:-q[0]+V/2}}function $(E){const H=[];for(let q=0;q<E.length;q++){const F=E[q];if(F.rels.children&&F.rels.children.length>0){F.rels.spouses||(F.rels.spouses=[]);const G=F.data.gender==="M";let ee;F.rels.children.forEach(ae=>{const re=E.find(Q=>Q.id===ae);re.rels[G?"father":"mother"]===F.id&&(re.rels[G?"mother":"father"]||(ee||(ee=V(F)),ee.rels.children.push(re.id),re.rels[G?"mother":"father"]=ee.id))})}}return H.forEach(q=>E.push(q)),E;function V(q){return q.rels.spouses.map(G=>E.find(ee=>ee.id===G)).find(G=>G.to_add)||R(q)}function R(q){const F=Xi({data:{gender:q.data.gender==="M"?"F":"M"},rels:{spouses:[q.id],children:[]}});return F.to_add=!0,H.push(F),q.rels.spouses.push(F.id),F}}function D(E,H){let V=H?u:d;if(l&&(V=1),!V&&V!==0)return E;return R(E,0),E;function R(q,F){F===V?q.children&&delete q.children:q.children&&q.children.forEach(G=>{R(G,F+1)})}}function L(E){H(E);function H(V){V.children&&V.children.length===2&&(V.children[0]._spouse=V.children[1],V.children[1]._spouse=V.children[0]),V.children&&V.children.forEach(R=>H(R))}}function O(E){E.forEach(H=>{if(H.data.main)H.from=[],H.to=[],H.to_ancestry=H.parents;else if(H.is_ancestry)H.from=[H.parent],H.to=H.parents;else{if(H.added){H.from=[],H.from_spouse=H.spouse,H.to=[];return}if(H.sibling)return;const V=H.parent,R=(H.parent.spouses||[]).find(q=>q.data.id===H.data.rels.father||q.data.id===H.data.rels.mother);H.from=[V],R&&H.from.push(R),V.to||(V.to=[]),V.to.push(H),R&&(R.to||(R.to=[]),R.to.push(H))}})}function W(E,H,V){V?AV(E,y):_V(E,H,y)}}function kV({tree:e}){const t=[];e.forEach(n=>{if(t.includes(n.data.id)){const r=e.filter(s=>s.data.id===n.data.id);r.forEach((s,i)=>{s.tid=`${n.data.id}--x${i+1}`,s.duplicate=r.length,t.push(n.data.id)})}else n.tid=n.data.id,t.push(n.data.id)})}function EV(e){let t;const n=e;return n.main_id_history=[],{state:n,updateTree:f=>{n.tree=s(),n.main_id||u(n.tree.main_id),t&&t(f)},updateData:f=>n.data=f,updateMainId:u,getMainId:()=>n.main_id,getData:()=>n.data,getTree:()=>n.tree,setOnUpdate:f=>t=f,getMainDatum:i,getDatum:l,getTreeMainDatum:o,getTreeDatum:c,getLastAvailableMainDatum:d,methods:{}};function s(){return U8({data:n.data,main_id:n.main_id,node_separation:n.node_separation,level_separation:n.level_separation,single_parent_empty_card:n.single_parent_empty_card,is_horizontal:n.is_horizontal,one_level_rels:n.one_level_rels,sortChildrenFunction:n.sortChildrenFunction,sortSpousesFunction:n.sortSpousesFunction,ancestry_depth:n.ancestry_depth,progeny_depth:n.progeny_depth,show_siblings_of_main:n.show_siblings_of_main,modifyTreeHierarchy:n.modifyTreeHierarchy,private_cards_config:n.private_cards_config,duplicate_branch_toggle:n.duplicate_branch_toggle})}function i(){return n.data.find(f=>f.id===n.main_id)}function l(f){return n.data.find(m=>m.id===f)}function o(){return n.tree?n.tree.data.find(f=>f.data.id===n.main_id):null}function c(f){return n.tree?n.tree.data.find(m=>m.data.id===f):null}function u(f){f!==n.main_id&&(n.main_id_history=n.main_id_history.filter(m=>m!==f).slice(-10),n.main_id_history.push(f),n.main_id=f)}function d(){let f=n.main_id_history.slice(0).reverse().find(m=>l(m));return f||(f=n.data[0].id),f!==n.main_id&&u(f),l(f)}}function q8({t:e,svg:t,transition_time:n=2e3}){const r=t.__zoomObj?t:t.parentNode,s=r.__zoomObj;Je.select(r).transition().duration(n||0).delay(n?100:0).call(s.transform,Je.zoomIdentity.scale(e.k).translate(e.x,e.y))}function N2({svg:e,svg_dim:t,tree_dim:n,with_transition:r,transition_time:s}){const i=H8(t,n);q8({t:i,svg:e,transition_time:s})}function H8(e,t){let n=Math.min(e.width/t.width,e.height/t.height);n>1&&(n=1);const r=t.x_off+(e.width-t.width*n)/n/2,s=t.y_off+(e.height-t.height*n)/n/2;return{k:n,x:r,y:s}}function W8({datum:e,svg:t,svg_dim:n,scale:r,transition_time:s}){const i=r||1,l=n.width/2-e.x*i,o=n.height/2-e.y,c={k:i,x:l/i,y:o/i};q8({t:c,svg:t,transition_time:s})}function CV({d:e,tree:t,is_horizontal:n=!1}){const r=[];return(e.spouses||e._spouse)&&l({d:e}),s({d:e}),i({d:e}),r;function s({d:x}){if(!x.parents)return;const y=x.parents[0],p=x.parents[1]||y,g={x:o(y,p,"x"),y:o(y,p,"y")};r.push({d:u(x,g),_d:()=>{const w={x:x.x,y:x.y},v={x:x.x,y:x.y};return u(w,v)},curve:!0,id:m(x,y,p),depth:x.depth+1,is_ancestry:!0,source:x,target:[y,p]})}function i({d:x}){!x.children||x.children.length===0||x.children.forEach((y,p)=>{const g=h(y,x)||x,w=g.sx,v=n?{x:x.x,y:w}:{x:w,y:x.y};r.push({d:u(y,v),_d:()=>u(v,{x:c(v,"x"),y:c(v,"y")}),curve:!0,id:m(y,x,g),depth:x.depth+1,is_ancestry:!1,source:[x,g],target:y})})}function l({d:x}){x.spouses?x.spouses.forEach(p=>r.push(y(x,p))):x._spouse&&r.push(y(x,x._spouse));function y(p,g){return{d:[[p.x,p.y],[g.x,g.y]],_d:()=>[p.is_ancestry?[c(p,"x")-1e-4,c(p,"y")]:[p.x,p.y],p.is_ancestry?[c(g,"x"),c(g,"y")]:[p.x-1e-4,p.y]],curve:!1,id:m(p,g),depth:p.depth,spouse:!0,is_ancestry:g.is_ancestry,source:p,target:g}}}function o(x,y,p,g){return x[p]-(x[p]-y[p])/2}function c(x,y){return x.hasOwnProperty("_"+y)?x["_"+y]:x[y]}function u(x,y){return n?f(x,y):d(x,y)}function d(x,y){const p=x.y+(y.y-x.y)/2;return[[x.x,x.y],[x.x,p],[x.x,p],[y.x,p],[y.x,p],[y.x,y.y]]}function f(x,y){const p=x.x+(y.x-x.x)/2;return[[x.x,x.y],[p,x.y],[p,x.y],[p,y.y],[p,y.y],[y.x,y.y]]}function m(...x){return x.map(y=>y.tid).sort().join(", ")}function h(x,y){return(y.spouses||[]).find(g=>g.data.id===x.data.rels.mother||g.data.id===x.data.rels.father)}}function PV(e,t,n,r){const s=n.is_ancestry,i=t.data();let l=[],o=[];if(s){const f=[];let m=n,h=0;for(;m!==r.data&&h<100;){h++;const y=i.find(p=>p.spouse===!0&&(p.source===m||p.target===m));if(y){const p=i.filter(w=>Array.isArray(w.target)&&w.target.includes(y.source)&&w.target.includes(y.target)),g=d(p,r);if(!g)break;f.push(y),f.push(g),m=g.source}else{const p=i.filter(w=>Array.isArray(w.target)&&w.target.includes(m)),g=d(p,r);if(!g)break;f.push(g),m=g.source}}t.each(function(y){f.includes(y)&&l.push({link:y,node:this})});const x=u(n,f);e.each(function(y){x.includes(y)&&o.push({card:y,node:this})})}else if(n.spouse&&n.spouse.data===r.data){t.each(function(m){m.target===n&&l.push({link:m,node:this})});const f=[r,n];e.each(function(m){f.includes(m)&&o.push({card:m,node:this})})}else if(n.sibling){t.each(function(m){m.source===n&&l.push({link:m,node:this}),m.source===r&&m.target.length===2&&l.push({link:m,node:this}),n.parents.includes(m.source)&&n.parents.includes(m.target)&&l.push({link:m,node:this})});const f=[r,n,...n.parents];e.each(function(m){f.includes(m)&&o.push({card:m,node:this})})}else{let f=[],m=n,h=0;for(;m!==r.data&&h<100;){h++;const y=i.find(p=>p.target===m&&Array.isArray(p.source));if(y){const p=i.find(g=>g.spouse===!0&&c([g.source,g.target],y.source));f.push(y),f.push(p),p?m=p.source:m=y.source[0]}else{const p=i.find(g=>g.target===m&&!Array.isArray(g.source));if(!p)break;f.push(p),m=p.source}}t.each(function(y){f.includes(y)&&l.push({link:y,node:this})});const x=u(r,f);e.each(function(y){x.includes(y)&&o.push({card:y,node:this})})}return[o,l];function c(f,m){return f.every(h=>m.some(x=>h===x))}function u(f,m){const h=m.filter(p=>p).reduce((p,g)=>(Array.isArray(g.target)?p.push(...g.target):p.push(g.target),Array.isArray(g.source)?p.push(...g.source):p.push(g.source),p),[]),x=[r,n];return y(f),x;function y(p){p.data.rels.children&&p.data.rels.children.forEach(g=>{const w=h.find(v=>v.data.id===g);w&&(x.push(w),y(w))})}}function d(f,m){return f.length===0?null:f.length===1?f[0]:f.find(h=>h.source===m)}}function I1(e,t){const n=Je.line().curve(Je.curveMonotoneY),r=Je.line().curve(Je.curveBasis),s=t?e._d():e.d;if(e.curve){if(e.curve===!0)return r(s)}else return n(s)}function IV(e,t,n={}){const r=t.data.reduce((m,h)=>(CV({d:h,tree:t.data,is_horizontal:t.is_horizontal}).forEach(x=>m[x.id]=x),m),{}),s=Object.values(r),i=Je.select(e).select(".links_view").selectAll("path.link").data(s,m=>m.id),l=i.exit(),o=i.enter().append("path").attr("class","link"),c=o.merge(i);l.each(f),o.each(u),c.each(d);function u(m){Je.select(this).attr("fill","none").attr("stroke","#fff").attr("stroke-width",1).style("opacity",0).attr("d",I1(m,!0))}function d(m){const h=Je.select(this),x=n.initial?jh(t,m,n.transition_time):0;h.transition("path").duration(n.transition_time).delay(x).attr("d",I1(m)).style("opacity",1)}function f(m){const h=Je.select(this);h.transition("op").duration(800).style("opacity",0),h.transition("path").duration(n.transition_time).attr("d",I1(m,!0)).on("end",()=>h.remove())}}function TV(e,t,n,r={}){const s=Je.select(e).select(".cards_view").selectAll("g.card_cont").data(t.data,m=>m.data.id),i=s.exit(),l=s.enter().append("g").attr("class","card_cont"),o=l.merge(s);i.each(m=>qu(m,!1,!0)),l.each(m=>qu(m,!0,!1)),i.each(f),s.each(u),l.each(c),o.each(d);function c(m){Je.select(this).attr("transform",`translate(${m._x}, ${m._y})`).style("opacity",0),n.call(this,m)}function u(m){}function d(m){n.call(this,m);const h=r.initial?jh(t,m,r.transition_time):0;Je.select(this).transition().duration(r.transition_time).delay(h).attr("transform",`translate(${m.x}, ${m.y})`).style("opacity",1)}function f(m){const h=Je.select(this);h.transition().duration(r.transition_time).style("opacity",0).attr("transform",`translate(${m._x}, ${m._y})`).on("end",()=>h.remove())}}function LV(e,t,n,r={}){const s=Je.select(e).select(".cards_view").selectAll("div.card_cont").data(t.data,m=>m.tid),i=s.exit(),l=s.enter().append("div").attr("class","card_cont").style("pointer-events","none"),o=l.merge(s);i.each(m=>qu(m,!1,!0)),l.each(m=>qu(m,!0,!1)),i.each(f),s.each(u),l.each(c),o.each(d);function c(m){Je.select(this).style("position","absolute").style("top","0").style("left","0").style("transform",`translate(${m._x}px, ${m._y}px)`).style("opacity",0),n.call(this,m)}function u(m){}function d(m){n.call(this,m);const h=r.initial?jh(t,m,r.transition_time):0;Je.select(this).transition().duration(r.transition_time).delay(h).style("transform",`translate(${m.x}px, ${m.y}px)`).style("opacity",1)}function f(m){const h=Je.select(this);h.transition().duration(r.transition_time).style("opacity",0).style("transform",`translate(${m._x}px, ${m._y}px)`).on("end",()=>h.remove())}}function V8(e,t){const n=Je.select(e).selectAll("div.card_cont_2fake").data(t,u=>u.data.id),r=n.exit(),s=n.enter().append("div").attr("class","card_cont_2fake").style("display","none").attr("data-id",()=>Math.random()),i=s.merge(n);r.each(c),s.each(l),i.each(o);function l(u){u.unique_id=Je.select(this).attr("data-id")}function o(u){u.unique_id=Je.select(this).attr("data-id")}function c(u){u.unique_id=Je.select(this).attr("data-id"),Je.select(this).remove()}}function G8(e){Je.select(e()).append("div").attr("class","cards_view_fake").style("display","none")}function Nb(e){return Je.select(e()).select("div.cards_view_fake").node()}function MV(e,t){return function(r){const s=r.transform;Je.select(e()).style("transform",`translate(${s.x}px, ${s.y}px) scale(${s.k}) `),Je.select(t()).style("transform",`translate(${s.x}px, ${s.y}px) scale(${s.k}) `)}}function RV(e){let t=[];return function(r){const s=FV(r,t);return t=[...r,...s],V8(Nb(e),t),t}}function $V(e){const n=Je.select(e).select("#f3Canvas").append("div").attr("id","htmlSvg").attr("style","position: absolute; width: 100%; height: 100%; z-index: 2; top: 0; left: 0");return n.append("div").attr("class","cards_view").style("transform-origin","0 0"),G8(()=>n.node()),n.node()}function FV(e,t){return t.length>0?t.filter(n=>!e.find(r=>r.data.id===n.data.id)):[]}function OV(e){return e.unique_id}var DV=Object.freeze({__proto__:null,assignUniqueIdToTreeData:V8,setupHtmlSvg:G8,getCardsViewFake:Nb,onZoomSetup:MV,setupReactiveTreeData:RV,createHtmlSvg:$V,getUniqueId:OV});function BV(e,t,n,r={}){const s=Je.select(Nb(()=>e)).selectAll("div.card_cont_fake").data(t.data,m=>m.data.id),i=s.exit(),l=s.enter().append("div").attr("class","card_cont_fake").style("display","none"),o=l.merge(s);i.each(m=>qu(m,!1,!0)),l.each(m=>qu(m,!0,!1)),i.each(f),s.each(u),l.each(c),o.each(d);function c(m){Je.select(n(m)).style("position","absolute").style("top","0").style("left","0").style("opacity",0).style("transform",`translate(${m._x}px, ${m._y}px)`)}function u(m){}function d(m){const h=Je.select(n(m)),x=r.initial?jh(t,m,r.transition_time):0;h.transition().duration(r.transition_time).delay(x).style("transform",`translate(${m.x}px, ${m.y}px)`).style("opacity",1)}function f(m){const h=Je.select(n(m)),x=Je.select(this);h.transition().duration(r.transition_time).style("opacity",0).style("transform",`translate(${m._x}px, ${m._y}px)`).on("end",()=>x.remove())}}function zV(e,t,n,r={}){r.initial=r.hasOwnProperty("initial")?r.initial:!Je.select(t.parentNode).select(".card_cont").node(),r.transition_time=r.hasOwnProperty("transition_time")?r.transition_time:2e3,r.cardComponent?BV(r.cardComponent,e,n,r):r.cardHtml?LV(r.cardHtml,e,n,r):TV(t,e,n,r),IV(t,e,r);const s=r.tree_position||"fit";return r.initial?N2({svg:t,svg_dim:t.getBoundingClientRect(),tree_dim:e.dim,transition_time:0}):s==="fit"?N2({svg:t,svg_dim:t.getBoundingClientRect(),tree_dim:e.dim,transition_time:r.transition_time}):s==="main_to_middle"&&W8({datum:e.data[0],svg:t,svg_dim:t.getBoundingClientRect(),scale:r.scale,transition_time:r.transition_time}),!0}function jh(e,t,n){const r=n*.4,s=Math.max(...e.data.map(l=>l.is_ancestry?l.depth:0));let i=t.depth*r;return(t.depth!==0||t.spouse)&&!t.is_ancestry&&(i+=s*r,t.spouse&&(i+=r),i+=t.depth*r),i}function UV(e,t={}){const n=e.getBoundingClientRect(),r=`
    <svg class="main_svg">
      <rect width="${n.width}" height="${n.height}" fill="transparent" />
      <g class="view">
        <g class="links_view"></g>
        <g class="cards_view"></g>
      </g>
      <g style="transform: translate(100%, 100%)">
        <g class="fit_screen_icon cursor-pointer" style="transform: translate(-50px, -50px); display: none">
          <rect width="27" height="27" stroke-dasharray="${27/2}" stroke-dashoffset="${27/4}" 
            style="stroke:#fff;stroke-width:4px;fill:transparent;"/>
          <circle r="5" cx="${27/2}" cy="${27/2}" style="fill:#fff" />          
        </g>
      </g>
    </svg>
  `,s=o(e),i=Je.create("div").node();i.innerHTML=r;const l=i.querySelector("svg");return s.appendChild(l),e.appendChild(s),qV(s,t),l;function o(c){let u=c.querySelector("#f3Canvas");return u||(u=Je.create("div").attr("id","f3Canvas").attr("style","position: relative; overflow: hidden; width: 100%; height: 100%;").node()),u}}function qV(e,t={}){if(e.__zoom)return;const n=e.querySelector(".view"),r=Je.zoom().on("zoom",t.onZoom||s);Je.select(e).call(r),e.__zoomObj=r,t.zoom_polite&&r.filter(i);function s(l){Je.select(n).attr("transform",l.transform)}function i(l){return l.type==="wheel"&&!l.ctrlKey?!1:!(l.touches&&l.touches.length<2)}}function jb(e,{d:t}){return hV(e.getTree().data,!1),e.updateMainId(t.data.id),e.updateTree({tree_position:e.state.tree_fit_on_change}),!0}function Sb(e,{d:t,cardEditForm:n}){const r=t.data;n({datum:r,postSubmit:i=>{r.to_add&&R8(r,e.getData()),i&&i.delete&&(r.main&&e.updateMainId(null),ag(r,e.getData())),e.updateTree()},store:e})}function Y8(e,{d:t}){t.data.hide_rels=!t.data.hide_rels,I8(t,t.data.hide_rels),e.updateTree({tree_position:e.state.tree_fit_on_change})}function J8(){return`
    <g data-icon="user">
      ${Rs()}
      <path d="M12,4A4,4 0 0,1 16,8A4,4 0 0,1 12,12A4,4 0 0,1 8,8A4,4 0 0,1 12,4M12,14C16.42,14 20,15.79 20,18V20H4V18C4,15.79 7.58,14 12,14Z" />
    </g>
  `}function Z8(){return`
    <g data-icon="user-edit">
      ${Rs()}
      <path d="M21.7,13.35L20.7,14.35L18.65,12.3L19.65,11.3C19.86,11.09 20.21,11.09 20.42,11.3L21.7,12.58C21.91,
      12.79 21.91,13.14 21.7,13.35M12,18.94L18.06,12.88L20.11,14.93L14.06,21H12V18.94M12,14C7.58,14 4,15.79 4,
      18V20H10V18.11L14,14.11C13.34,14.03 12.67,14 12,14M12,4A4,4 0 0,0 8,8A4,4 0 0,0 12,12A4,4 0 0,0 16,8A4,4 0 0,0 12,4Z" />
    </g>
  `}function X8(){return`
    <g data-icon="user-plus">
      ${Rs()}
      <path d="M15,14C12.33,14 7,15.33 7,18V20H23V18C23,15.33 17.67,14 15,14M6,10V7H4V10H1V12H4V15H6V12H9V10M15,12A4,4 0 0,0 19,8A4,4 0 0,0 15,4A4,4 0 0,0 11,8A4,4 0 0,0 15,12Z" />
    </g>
  `}function K8(){return`
    <g data-icon="user-plus-close">
      ${Rs()}
      <path d="M15,14C12.33,14 7,15.33 7,18V20H23V18C23,15.33 17.67,14 15,14M6,10V7H4V10H1V12H4V15H6V12H9V10M15,12A4,4 0 0,0 19,8A4,4 0 0,0 15,4A4,4 0 0,0 11,8A4,4 0 0,0 15,12Z" />
      <line x1="3" y1="3" x2="24" y2="24" stroke="currentColor" stroke-width="2" />
    </g>
  `}function _b(){return`
    <g data-icon="plus">
      ${Rs()}
      <path d="M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z" />
    </g>
  `}function Q8(){return`
    <g data-icon="pencil">
      ${Rs()}
      <path d="M20.71,7.04C21.1,6.65 21.1,6 20.71,5.63L18.37,3.29C18,2.9 17.35,2.9 16.96,3.29L15.12,5.12L18.87,8.87M3,17.25V21H6.75L17.81,9.93L14.06,6.18L3,17.25Z" />
    </g>
  `}function eA(){return`
    <g data-icon="pencil-off">
      ${Rs()}
      <path d="M18.66,2C18.4,2 18.16,2.09 17.97,2.28L16.13,4.13L19.88,7.88L21.72,6.03C22.11,5.64 22.11,5 21.72,4.63L19.38,2.28C19.18,2.09 18.91,2 18.66,2M3.28,4L2,5.28L8.5,11.75L4,16.25V20H7.75L12.25,15.5L18.72,22L20,20.72L13.5,14.25L9.75,10.5L3.28,4M15.06,5.19L11.03,9.22L14.78,12.97L18.81,8.94L15.06,5.19Z" />
    </g>
  `}function tA(){return`
    <g data-icon="trash">
      ${Rs()}
      <path d="M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19M8,9H16V19H8V9M15.5,4L14.5,3H9.5L8.5,4H5V6H19V4H15.5Z" />
    </g>
  `}function nA(){return`
    <g data-icon="history-back">
      ${Rs()}
      <path d="M20 13.5C20 17.09 17.09 20 13.5 20H6V18H13.5C16 18 18 16 18 13.5S16 9 13.5 9H7.83L10.91 12.09L9.5 13.5L4 8L9.5 2.5L10.92 3.91L7.83 7H13.5C17.09 7 20 9.91 20 13.5Z" />
    </g>
  `}function rA(){return`
    <g data-icon="history-forward">
      ${Rs()}
      <path d="M10.5 18H18V20H10.5C6.91 20 4 17.09 4 13.5S6.91 7 10.5 7H16.17L13.08 3.91L14.5 2.5L20 8L14.5 13.5L13.09 12.09L16.17 9H10.5C8 9 6 11 6 13.5S8 18 10.5 18Z" />
    </g>
  `}function sA(){return`
    <g data-icon="person">
      <path d="M256 288c79.5 0 144-64.5 144-144S335.5 0 256 0 112 
        64.5 112 144s64.5 144 144 144zm128 32h-55.1c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16H128C57.3 320 0 377.3 
        0 448v16c0 26.5 21.5 48 48 48h416c26.5 0 48-21.5 48-48v-16c0-70.7-57.3-128-128-128z" />
    </g>
  `}function iA(){return`
    <g transform="translate(31,25)" data-icon="mini-tree">
      <rect x="-31" y="-25" width="72" height="15" fill="rgba(0,0,0,0)"></rect>
      <g>
        <rect x="-31" y="-25" width="72" height="15" fill="rgba(0,0,0,0)"></rect>
        <line y2="-17.5" stroke="#fff" />
        <line x1="-20" x2="20" y1="-17.5" y2="-17.5" stroke="#fff" />
        <rect x="-31" y="-25" width="25" height="15" rx="5" ry="5" class="card-male" />
        <rect x="6" y="-25" width="25" height="15" rx="5" ry="5" class="card-female" />
      </g>
    </g>
  `}function aA(){return`
    <g data-icon="toggle-on">
      ${Rs()}
      <circle class="f3-small-circle" r="4" cx="18" cy="12" />
      <path d="M17,7H7A5,5 0 0,0 2,12A5,5 0 0,0 7,17H17A5,5 0 0,0 22,12A5,5 0 0,0 17,7M17,15A3,3 0 0,1 14,12A3,3 0 0,1 17,9A3,3 0 0,1 20,12A3,3 0 0,1 17,15Z" />
    </g>
  `}function oA(){return`
    <g data-icon="toggle-off">
      ${Rs()}
      <circle class="f3-small-circle" r="4" cx="6" cy="12" />
      <path d="M17,7H7A5,5 0 0,0 2,12A5,5 0 0,0 7,17H17A5,5 0 0,0 22,12A5,5 0 0,0 17,7M7,15A3,3 0 0,1 4,12A3,3 0 0,1 7,9A3,3 0 0,1 10,12A3,3 0 0,1 7,15Z" />
    </g>
  `}function lA(){return`
    <g data-icon="chevron-down">
      ${Rs()}
      <path d="M7.41,8.58L12,13.17L16.59,8.58L18,10L12,16L6,10L7.41,8.58Z" />
    </g>
  `}function cA(){return`
    <g data-icon="chevron-up">
      ${Rs()}
      <path d="M7.41,15.41L12,10.83L16.59,15.41L18,14L12,8L6,14L7.41,15.41Z" />
    </g>
  `}function uA(){return`
    <g data-icon="link-off">
      ${Rs()}
      <path d="M17,7H13V8.9H17C18.71,8.9 20.1,10.29 20.1,12C20.1,13.43 19.12,14.63 17.79,15L19.25,16.44C20.88,15.61 22,13.95 
      22,12A5,5 0 0,0 17,7M16,11H13.81L15.81,13H16V11M2,4.27L5.11,7.38C3.29,8.12 2,9.91 2,12A5,5 0 0,0 7,17H11V15.1H7C5.29,15.1 
      3.9,13.71 3.9,12C3.9,10.41 5.11,9.1 6.66,8.93L8.73,11H8V13H10.73L13,15.27V17H14.73L18.74,21L20,19.74L3.27,3L2,4.27Z" />
    </g>
  `}function dA(){return`
    <g data-icon="info">
      ${Rs()}
      <path d="M13,9H11V7H13M13,17H11V11H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z" />
    </g>
  `}function HV(){return us(J8())}function WV(){return us(Z8())}function fA(){return us(X8())}function hA(){return us(K8())}function mA(){return us(_b())}function pA(){return us(Q8())}function gA(){return us(eA())}function VV(){return us(tA())}function xA(){return us(nA())}function yA(){return us(rA())}function Ab(){return us(sA(),"0 0 512 512")}function kb(){return us(iA(),"0 0 72 25")}function bA(){return us(aA())}function vA(){return us(oA())}function wA(){return us(lA())}function GV(){return us(cA())}function NA(){return us(uA())}function jA(){return us(dA())}function us(e,t="0 0 24 24"){const n=e.match(/data-icon="([^"]+)"/),r=n?`data-icon="${n[1]}"`:"";return`
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="${t}" style="fill: currentColor" ${r}>
      ${e}
    </svg>
  `}function Rs(){return`
    <circle r="12" cx="12" cy="12" style="fill: rgba(0,0,0,0)" />
  `}var YV=Object.freeze({__proto__:null,userIcon:J8,userEditIcon:Z8,userPlusIcon:X8,userPlusCloseIcon:K8,plusIcon:_b,pencilIcon:Q8,pencilOffIcon:eA,trashIcon:tA,historyBackIcon:nA,historyForwardIcon:rA,personIcon:sA,miniTreeIcon:iA,toggleIconOn:aA,toggleIconOff:oA,chevronDownIcon:lA,chevronUpIcon:cA,linkOffIcon:uA,infoIcon:dA,userSvgIcon:HV,userEditSvgIcon:WV,userPlusSvgIcon:fA,userPlusCloseSvgIcon:hA,plusSvgIcon:mA,pencilSvgIcon:pA,pencilOffSvgIcon:gA,trashSvgIcon:VV,historyBackSvgIcon:xA,historyForwardSvgIcon:yA,personSvgIcon:Ab,miniTreeSvgIcon:kb,toggleSvgIconOn:bA,toggleSvgIconOff:vA,chevronDownSvgIcon:wA,chevronUpSvgIcon:GV,linkOffSvgIcon:NA,infoSvgIcon:jA});function JV(e,t){const n=document.createElement("div");return r(),n;function r(){const i=ZV(e);return n.innerHTML=i,s(),n}function s(){const i=n.querySelector("form");i.addEventListener("submit",e.onSubmit),i.querySelector(".f3-cancel-btn").addEventListener("click",h);const o=i.querySelector(".f3-edit-btn");o&&o.addEventListener("click",x);const c=i.querySelector(".f3-delete-btn");c&&e.onDelete&&c.addEventListener("click",e.onDelete);const u=i.querySelector(".f3-add-relative-btn");u&&e.addRelative&&u.addEventListener("click",()=>{e.addRelativeActive?e.addRelativeCancel():e.addRelative(),e.addRelativeActive=!e.addRelativeActive,r()});const d=i.querySelector(".f3-remove-relative-btn");d&&e.removeRelative&&d.addEventListener("click",()=>{e.removeRelativeActive?e.removeRelativeCancel():e.removeRelative(),e.removeRelativeActive=!e.removeRelativeActive,r()}),i.querySelector(".f3-close-btn").addEventListener("click",t);const m=i.querySelector(".f3-link-existing-relative select");if(m&&m.addEventListener("change",e.linkExistingRelative.onSelect),e.onFormCreation&&e.onFormCreation({cont:n,form_creator:e}),e.getKinshipInfo){const y=e.getKinshipInfo();y&&n.appendChild(y)}function h(){e.editable=!1,e.onCancel&&e.onCancel(),r()}function x(){e.editable=!e.editable,r()}}}function ZV(e){return` 
    <form id="familyForm" class="f3-form ${e.editable?"":"non-editable"}">
      ${c()}
      ${e.title?`<h3 class="f3-form-title">${e.title}</h3>`:""}
      <div style="text-align: right; display: ${e.new_rel?"none":"block"}">
        ${e.addRelative&&!e.no_edit?r():""}
        ${e.no_edit?u():s()}
      </div>

      ${i()}

      ${l()}
      
      <div class="f3-form-buttons">
        <button type="button" class="f3-cancel-btn">Cancel</button>
        <button type="submit">Submit</button>
      </div>

      ${e.linkExistingRelative?o():""}

      <hr>

      ${e.onDelete?t():""}

      ${e.removeRelative?n():""}
    </form>
  `;function t(){return`
      <div>
        <button type="button" class="f3-delete-btn" ${e.can_delete?"":"disabled"}>
          Delete
        </button>
      </div>
    `}function n(){return`
      <div>
        <button type="button" class="f3-remove-relative-btn${e.removeRelativeActive?" active":""}">
          ${e.removeRelativeActive?"Cancel Remove Relation":"Remove Relation"}
        </button>
      </div>
    `}function r(){return`
      <span class="f3-add-relative-btn">
        ${e.addRelativeActive?hA():fA()}
      </span>
    `}function s(){return`
      <span class="f3-edit-btn">
        ${e.editable?gA():pA()}
      </span>
    `}function i(){return e.editable?`
      <div class="f3-radio-group">
        ${e.gender_field.options.map(d=>`
          <label>
            <input type="radio" name="${e.gender_field.id}" 
              value="${d.value}" 
              ${d.value===e.gender_field.initial_value?"checked":""}
              ${e.gender_field.disabled?"disabled":""}
            >
            ${d.label}
          </label>
        `).join("")}
      </div>
    `:""}function l(){if(!e.editable)return f();let d="";return e.fields.forEach(m=>{m.type==="text"?d+=`
        <div class="f3-form-field">
          <label>${m.label}</label>
          <input type="${m.type}" 
            name="${m.id}" 
            value="${m.initial_value||""}"
            placeholder="${m.label}">
        </div>`:m.type==="textarea"?d+=`
        <div class="f3-form-field">
          <label>${m.label}</label>
          <textarea name="${m.id}" 
            placeholder="${m.label}">${m.initial_value||""}</textarea>
        </div>`:m.type==="select"?d+=`
        <div class="f3-form-field">
          <label>${m.label}</label>
          <select name="${m.id}" value="${m.initial_value||""}">
            <option value="">${m.placeholder||`Select ${m.label}`}</option>
            ${m.options.map(h=>`<option ${h.value===m.initial_value?"selected":""} value="${h.value}">${h.label}</option>`).join("")}
          </select>
        </div>`:m.type==="rel_reference"&&(d+=`
        <div class="f3-form-field">
          <label>${m.label} - <i>${m.rel_label}</i></label>
          <input type="text" 
            name="${m.id}" 
            value="${m.initial_value||""}"
            placeholder="${m.label}">
        </div>`)}),d;function f(){let m="";return e.fields.forEach(h=>{var x;if(h.type==="rel_reference"){if(!h.initial_value)return;m+=`
          <div class="f3-info-field">
            <span class="f3-info-field-label">${h.label} - <i>${h.rel_label}</i></span>
            <span class="f3-info-field-value">${h.initial_value||""}</span>
          </div>`}else if(h.type==="select"){if(!h.initial_value)return;m+=`
          <div class="f3-info-field">
            <span class="f3-info-field-label">${h.label}</span>
            <span class="f3-info-field-value">${((x=h.options.find(y=>y.value===h.initial_value))==null?void 0:x.label)||""}</span>
          </div>`}else m+=`
          <div class="f3-info-field">
            <span class="f3-info-field-label">${h.label}</span>
            <span class="f3-info-field-value">${h.initial_value||""}</span>
          </div>`}),m}}function o(){const d=e.linkExistingRelative.hasOwnProperty("title")?e.linkExistingRelative.title:"Profile already exists?",f=e.linkExistingRelative.hasOwnProperty("select_placeholder")?e.linkExistingRelative.select_placeholder:"Select profile",m=e.linkExistingRelative.options;return`
      <div>
        <hr>
        <div class="f3-link-existing-relative">
          <label>${d}</label>
          <select>
            <option value="">${f}</option>
            ${m.map(h=>`<option value="${h.value}">${h.label}</option>`).join("")}
          </select>
        </div>
      </div>
    `}function c(){return`
      <span class="f3-close-btn">
        
      </span>
    `}function u(){return'<div style="height: 24px;"></div>'}}function XV(e,t,n){let r=[],s=-1;return{changed:i,back:l,forward:o,canForward:c,canBack:u};function i(){s<r.length-1&&(r=r.slice(0,s+1));const f=t();f.main_id=e.getMainId(),r.push(f),s++}function l(){u()&&(s--,d(r[s]))}function o(){c()&&(s++,d(r[s]))}function c(){return s<r.length-1}function u(){return s>0}function d(f){const m=e.getMainId();f=JSON.parse(JSON.stringify(f)),f.find(h=>h.id===m)||e.updateMainId(f.main_id),e.updateData(f),n()}}function KV(e,t){const n=Je.select(e).append("div").attr("class","f3-history-controls");e.insertBefore(n.node(),e.firstChild);const r=n.append("button").attr("class","f3-back-button").on("click",()=>{t.back(),i()}),s=n.append("button").attr("class","f3-forward-button").on("click",()=>{t.forward(),i()});return r.html(xA()),s.html(yA()),{back_btn:r.node(),forward_btn:s.node(),updateButtons:i,destroy:l};function i(){r.classed("disabled",!t.canBack()),s.classed("disabled",!t.canForward()),!t.canBack()&&!t.canForward()?n.style("opacity",0).style("pointer-events","none"):n.style("opacity",1).style("pointer-events","auto")}function l(){t=null,Je.select(e).select(".f3-history-controls").remove()}}var QV=Object.freeze({__proto__:null,manualZoom:B8,getCurrentZoom:NV,zoomTo:jV,isAllRelativeDisplayed:z8,cardChangeMain:jb,cardEdit:Sb,cardShowHideRels:Y8,handleRelsOfNewDatum:F8,createNewPerson:Xi,createNewPersonWithGenderFromRel:O8,addNewPerson:wb,createTreeDataWithMainNode:D8,addNewPersonAndHandleRels:vV,checkIfRelativesConnectedWithoutPerson:T8,checkIfConnectedToFirstPerson:vb,createForm:yV,syncRelReference:M8,onDeleteSyncRelReference:w2,moveToAddToAdded:R8,removeToAdd:e0,deletePerson:ag,cleanupDataJson:bV,removeToAddFromData:$8,formInfoSetup:JV,createHistory:XV,createHistoryControls:KV,treeFit:N2,calculateTreeFit:H8,cardToMiddle:W8});function SA({d:e,card_dim:t,card_display:n}){return{template:`
    <g class="card-body">
      <rect width="${t.w}" height="${t.h}" class="card-body-rect" />
      ${eG({d:e,card_dim:t,card_display:n}).template}
    </g>
  `}}function eG({d:e,card_dim:t,card_display:n}){return{template:`
    <g>
      <g class="card-text" clip-path="url(#card_text_clip)">
        <g transform="translate(${t.text_x}, ${t.text_y})">
          <text>
            ${Array.isArray(n)?n.map(r=>`<tspan x="0" dy="14">${r(e.data)}</tspan>`).join(`
`):n(e.data)}
          </text>
        </g>
      </g>
      <rect width="${t.w-10}" height="${t.h}" style="mask: url(#fade)" class="text-overflow-mask" /> 
    </g>
  `}}function tG({d:e,card_dim:t,card_add:n,label:r}){return{template:`
    <g class="card-body ${n?"card_add":"card-unknown"}">
      <rect class="card-body-rect" width="${t.w}" height="${t.h}" fill="rgb(59, 85, 96)" />
      <text transform="translate(${t.w/2}, ${t.h/2})" text-anchor="middle" fill="#fff">
        <tspan font-size="18" dy="8">${r}</tspan>
      </text>
    </g>
  `}}function nG({d:e,card_dim:t,label:n}){return{template:`
    <g class="card-body">
      <rect class="card-body-rect" width="${t.w}" height="${t.h}" />
      <text transform="translate(${t.img_w+5}, ${t.h/2})">
        <tspan font-size="18" dy="8" pointer-events="none">${n}</tspan>
      </text>
    </g>
  `}}function j2({d:e,card_dim:t,is_new:n}){return{template:`
    <rect width="${t.w}" height="${t.h}" rx="4" ry="4" class="card-outline ${e.data.main&&!n?"card-main-outline":""} ${n?"card-new-outline":""}" />
  `}}function rG({d:e,card_dim:t,x:n,y:r}){return{template:`
    <g transform="translate(${n||t.w-20},${r||t.h-20})scale(.6)" style="cursor: pointer" class="card_edit pencil_icon">
      <circle fill="rgba(0,0,0,0)" r="17" cx="8.5" cy="8.5" />
      <path fill="currentColor" transform="translate(-1.5, -1.5)"
         d="M19.082,2.123L17.749,0.79c-1.052-1.052-2.766-1.054-3.819,0L1.925,12.794c-0.06,0.06-0.104,0.135-0.127,0.216
          l-1.778,6.224c-0.05,0.175-0.001,0.363,0.127,0.491c0.095,0.095,0.223,0.146,0.354,0.146c0.046,0,0.092-0.006,0.137-0.02
          l6.224-1.778c0.082-0.023,0.156-0.066,0.216-0.127L19.082,5.942C20.134,4.89,20.134,3.176,19.082,2.123z M3.076,13.057l9.428-9.428
          l3.738,3.739l-9.428,9.428L3.076,13.057z M2.566,13.961l3.345,3.344l-4.683,1.339L2.566,13.961z M18.375,5.235L16.95,6.66
          l-3.738-3.739l1.425-1.425c0.664-0.663,1.741-0.664,2.405,0l1.333,1.333C19.038,3.493,19.038,4.572,18.375,5.235z"/>
    </g>
  `}}function sG({d:e,card_dim:t}){return{template:`
    <g class="card_family_tree" style="cursor: pointer">
      <rect x="-31" y="-25" width="72" height="15" fill="rgba(0,0,0,0)"></rect>
      <g transform="translate(${t.w*.8},6)scale(.9)">
        <rect x="-31" y="-25" width="72" height="15" fill="rgba(0,0,0,0)"></rect>
        <line y2="-17.5" stroke="#fff" />
        <line x1="-20" x2="20" y1="-17.5" y2="-17.5" stroke="#fff" />
        <rect x="-31" y="-25" width="25" height="15" rx="5" ry="5" class="card-male" />
        <rect x="6" y="-25" width="25" height="15" rx="5" ry="5" class="card-female" />
      </g>
    </g>
  `}}function iG({d:e,card_dim:t,x:n,y:r}){return{template:`
    <g class="card_add_relative">
      <g transform="translate(${n||t.w/2},${r||t.h})scale(.13)">
        <circle r="80" cx="40" cy="40" fill="rgba(0,0,0,0)" />
        <g transform="translate(-10, -8)">
          <line
            x1="10" x2="90" y1="50" y2="50"
            stroke="currentColor" stroke-width="15" stroke-linecap="round"
          />
          <line
            x1="50" x2="50" y1="10" y2="90"
            stroke="currentColor" stroke-width="15" stroke-linecap="round"
          />
        </g>
      </g>
    </g>
  `}}function fN({x:e,y:t,rt:n,closed:r}){return{template:`
    <g style="
          transform: translate(-12.2px, -.5px);
          cursor: pointer;
        " 
        fill="currentColor" class="card_break_link${r?" closed":""}"
      >
      <g style="transform: translate(${e}px,${t}px)scale(.02)rotate(${n+"deg"})">
        <rect width="1000" height="700" y="150" style="opacity: 0" />
        <g class="link_upper">
          <g>
            <path d="M616.3,426.4c19,4.5,38.1-7.4,42.6-26.4c4.4-19-7.4-38-26.5-42.5L522.5,332c-18,11.1-53.9,33.4-53.9,33.4l80.4,18.6c-7.8,4.9-19.5,12.1-31.3,19.4L616.3,426.4L616.3,426.4z"/>
            <path d="M727.4,244.2c-50.2-11.6-100.3,3.3-135.7,35.4c28.6,22.6,64.5,30.2,116.4,51.3l141,32.6c23.9,5.6,56.6,47.2,51.1,71l-4.1,17c-5.6,23.7-47.3,56.4-71.2,51l-143.4-33.2c-66.8-8.6-104.1-16.6-132.9-7.5c17.4,44.9,55.9,80.8,106.5,92.4L800.9,588c81.3,18.8,162.3-31.5,181.2-112.4l4-17c18.8-81.1-31.7-161.8-112.9-180.6L727.4,244.2z"/>
          </g>
        </g>
        <g class="link_lower">
          <path d="M421.2,384.9l-128,127.6c-13.9,13.8-13.9,36.2,0,50s36.3,13.8,50.2,0.1l136.2-135.8v-36.7l-58.4,58.1V384.9L421.2,384.9z"/>
          <path d="M204.6,742.8c-17.4,17.3-63.3,17.2-80.6,0.1l-12.3-12.3c-17.3-17.3,0.6-81.2,17.9-98.5l100.2-99.9c12.5-14.9,45.8-40.8,66.1-103.7c-47.7-9.4-98.9,4.2-135.8,40.9L54.2,575c-58.9,58.8-58.9,154,0,212.8L66.6,800c58.9,58.8,154.5,58.8,213.4,0l105.8-105.6c38.4-38.3,51.3-91.9,39.7-141c-44,22.7-89,62.3-116,84.8L204.6,742.8z"/>
        </g>
        <g class="link_particles">
          <path d="M351.9,248.4l-26.5,63.4l80.6,30.1L351.9,248.4z"/>
          <path d="M529.3,208l-43,26.6l35.4,52.3L529.3,208z"/>
          <path d="M426.6,158.8l-44-2.9l61.7,134.6L426.6,158.8z"/>
        </g>
      </g>
    </g>
  `}}function aG({d:e,card_dim:t}){let n="",r=e.data.rels,s=e.data._rels||{},i=e.data.hide_rels,l=c=>c.father||c.mother,o=c=>c.children&&c.children.length>0;if((e.is_ancestry||e.data.main)&&(l(r)||l(s))&&(n+=fN({x:t.w/2,y:0,rt:-45,closed:i}).template),!e.is_ancestry&&e.added){const c=e.spouse,u=c.data.rels,d=c.data._rels||{};(o(r)||o(s))&&(o(u)||o(d))&&(n+=fN({x:e.sx-e.x+t.w/2+24.4,y:(e.x!==e.sx?t.h/2:t.h)+1,rt:135,closed:i}).template)}return{template:n}}function oG({d:e,image:t,card_dim:n,maleIcon:r,femaleIcon:s}){return{template:`
    <g style="transform: translate(${n.img_x}px,${n.img_y}px);" class="card_image" clip-path="url(#card_image_clip)">
      ${t?`<image href="${t}" height="${n.img_h}" width="${n.img_w}" preserveAspectRatio="xMidYMin slice" />`:(e.data.data.gender,e.data.data.gender,i())}      
    </g>
  `};function i(){return`
      <g class="genderless-icon">
        <rect height="${n.img_h}" width="${n.img_w}" fill="rgb(59, 85, 96)" />
        <g transform="scale(${n.img_w*.001616})">
         <path transform="translate(50,40)" fill="lightgrey" d="M256 288c79.5 0 144-64.5 144-144S335.5 0 256 0 112 
            64.5 112 144s64.5 144 144 144zm128 32h-55.1c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16H128C57.3 320 0 377.3 
            0 448v16c0 26.5 21.5 48 48 48h416c26.5 0 48-21.5 48-48v-16c0-70.7-57.3-128-128-128z" />
        </g>
      </g>
    `}}function xf(e,t,n){const r=document.createElementNS("http://www.w3.org/2000/svg","g");r.innerHTML=e,n?t.insertBefore(r,t.firstChild):t.appendChild(r)}const no={miniTree:lG,lineBreak:cG,cardBody:uG,cardImage:dG,cardEdit:fG,cardAdd:hG};function lG(e,t){if(e.data.to_add)return;const n=t.card_dim;if(e.all_rels_displayed)return;const r=Je.create("svg:g").html(sG({d:e,card_dim:n}).template);return r.on("click",function(s){s.stopPropagation(),t.onMiniTreeClick?t.onMiniTreeClick.call(this,s,e):jb(t.store,{d:e})}),r.node()}function cG(e,t){if(e.data.to_add)return;const n=t.card_dim,r=Je.create("svg:g").html(aG({d:e,card_dim:n}).template);return r.on("click",s=>{s.stopPropagation(),Y8(t.store,{d:e})}),r.node()}function uG(e,t){const n=t.cardEditForm?"ADD":"UNKNOWN",r=t.card_dim;let s;return e.data.to_add?(s=Je.create("svg:g").html(tG({d:e,card_dim:r,card_add:t.cardEditForm,label:n}).template),s.on("click",i=>{i.stopPropagation(),Sb(t.store,{d:e,cardEditForm:t.cardEditForm})})):(s=Je.create("svg:g").html(SA({d:e,card_dim:r,card_display:t.card_display}).template),s.on("click",function(i){i.stopPropagation(),t.onCardClick?t.onCardClick.call(this,i,e):jb(t.store,{d:e})})),s.node()}function dG(e,t){if(e.data.to_add)return;const n=t.card_dim;return Je.create("svg:g").html(oG({d:e,image:e.data.data.avatar||null,card_dim:n,maleIcon:null,femaleIcon:null}).template).node()}function fG(e,t){if(e.data.to_add)return;const n=t.card_dim,r=Je.create("svg:g").html(rG({card_dim:n,x:n.w-46,y:n.h-20}).template);return r.on("click",s=>{s.stopPropagation(),Sb(t.store,{d:e,cardEditForm:t.cardEditForm})}),r.node()}function hG(e,t){if(e.data.to_add)return;const n=t.card_dim,r=Je.create("svg:g").html(iG({card_dim:n,x:n.w-26,y:n.h-20}).template);return r.on("click",s=>{s.stopPropagation(),t.addRelative({d:e})}),r.node()}function wa(e,t,n){e&&(n?t.insertBefore(e,t.firstChild):t.appendChild(e))}function Eb(e,t){if(e.querySelector("defs#f3CardDef"))return;e.insertAdjacentHTML("afterbegin",`
      <defs id="f3CardDef">
        <linearGradient id="fadeGrad">
          <stop offset="0.9" stop-color="white" stop-opacity="0"/>
          <stop offset=".91" stop-color="white" stop-opacity=".5"/>
          <stop offset="1" stop-color="white" stop-opacity="1"/>
        </linearGradient>
        <mask id="fade" maskContentUnits="objectBoundingBox"><rect width="1" height="1" fill="url(#fadeGrad)"/></mask>
        <clipPath id="card_clip"><path d="${n({w:t.w,h:t.h},5)}"></clipPath>
        <clipPath id="card_text_clip"><rect width="${t.w-10}" height="${t.h}"></rect></clipPath>
        <clipPath id="card_image_clip"><path d="M0,0 Q 0,0 0,0 H${t.img_w} V${t.img_h} H0 Q 0,${t.img_h} 0,${t.img_h} z"></clipPath>
        <clipPath id="card_image_clip_curved"><path d="${n({w:t.img_w,h:t.img_h},5,["rx","ry"])}"></clipPath>
      </defs>
    `);function n(r,s,i){const{w:l,h:o}=r,c=s,u=i||[],d=y=>u.includes(y),f=d("lx")?"M0,0":`M0,${c} Q 0,0 5,0`,m=d("rx")?`H${l}`:`H${l-c} Q ${l},0 ${l},5`,h=d("ry")?`V${o}`:`V${o-c} Q ${l},${o} ${l-c},${o}`,x=d("ly")?"H0":`H${c} Q 0,${o} 0,${o-c}`;return`${f} ${m} ${h} ${x} z`}}function mG(e,t){e.querySelector("defs#f3CardDef")&&e.querySelector("defs#f3CardDef").remove(),Eb(e,t)}function pG(e){return e=t(e),Eb(e.svg,e.card_dim),function(n){const r=n.data.data.gender==="M"?"card-male":n.data.data.gender==="F"?"card-female":"card-genderless",s=e.card_dim,i=Je.create("svg:g").attr("class",`card ${r}`).attr("transform",`translate(${[-s.w/2,-s.h/2]})`);i.append("g").attr("class","card-inner").attr("clip-path","url(#card_clip)"),this.innerHTML="",this.appendChild(i.node()),xf(j2({d:n,card_dim:s,is_new:n.data.to_add}).template,i.node(),!0),wa(no.cardBody(n,e),this.querySelector(".card-inner")),e.img&&wa(no.cardImage(n,e),this.querySelector(".card")),e.mini_tree&&wa(no.miniTree(n,e),this.querySelector(".card"),!0),e.link_break&&wa(no.lineBreak(n,e),this.querySelector(".card")),e.cardEditForm&&(wa(no.cardEdit(n,e),this.querySelector(".card-inner")),wa(no.cardAdd(n,e),this.querySelector(".card-inner"))),e.onCardUpdates&&e.onCardUpdates.map(l=>l.call(this,n)),e.onCardUpdate&&e.onCardUpdate.call(this,n)};function t(n){const r={img:!0,mini_tree:!0,link_break:!1,card_dim:{w:220,h:70,text_x:75,text_y:15,img_w:60,img_h:60,img_x:5,img_y:5}};n||(n={});for(const s in r)typeof n[s]>"u"&&(n[s]=r[s]);return n}}function gG(e,t,n,r){if(!t.hasOwnProperty("_toggle"))return;const s=e.querySelector(".card"),i=s.querySelector(".card-inner"),l=e.querySelector(".card").offsetWidth;e.querySelector(".card").offsetHeight;let o,c;const u={};if(t.spouse){const f=t.spouse,m=f.data.main?"main":f.parent.data.id;if(o=f.data._tgdp_sp[m][t.data.id]<0,u.top=60,u.left=t.sx-t.x-30+l/2,n&&(u.top=t.sy-t.x+4,u.left=l/2+4,Math.abs(t.sx-t.y)<10&&(u.left=l-4)),c=f._toggle_id_sp?f._toggle_id_sp[t.data.id]:-1,c===-1)return}else{const f=t.data.main?"main":t.parent.data.id;o=t.data._tgdp[f]<0,u.top=-65,u.left=-30+l/2,n&&(u.top=5,u.left=-55),c=t._toggle_id}if(i.style.zIndex=1,Je.select(s).append("div").attr("class","f3-toggle-div").attr("style","cursor: pointer; width: 60px; height: 60px;position: absolute; z-index: -1;").style("top",u.top+"px").style("left",u.left+"px").on("click",f=>{if(f.stopPropagation(),t.spouse){const m=t.spouse,h=m.data.main?"main":m.parent.data.id;m.data._tgdp_sp[h].hasOwnProperty(t.data.id)||console.error("no toggle",t,m);let x=m.data._tgdp_sp[h][t.data.id];x<0?x=new Date().getTime():x=-new Date().getTime(),m.data._tgdp_sp[h][t.data.id]=x}else{const m=t.data.main?"main":t.parent.data.id;let h=t.data._tgdp[m];h<0?h=new Date().getTime():h=-new Date().getTime(),t.data._tgdp[m]=h}r()}).append("div").html(o?vA():bA()).select("svg").classed("f3-toggle-icon",!0).style("color",o?"#585656":"#61bf52").style("padding","0"),Je.select(s).select(".f3-toggle-icon .f3-small-circle").style("fill","#fff"),Je.select(s).select(".f3-toggle-icon").append("text").attr("transform",o?"translate(10.6, 14.5)":"translate(4.1, 14.5)").attr("fill","#fff").attr("font-size","7px").text("C"+c),o){let f;t.is_ancestry?n?f="translate(5, -30)rotate(-90)":f="translate(0, -10)":n?f="translate(11, -22)rotate(90)":f="translate(-7, -32)rotate(180)",Je.select(s).select(".f3-toggle-div").insert("div").html(kb()).select("svg").attr("style","position: absolute; z-index: -1;top: 0;left: 0;border-radius: 0;").style("width","66px").style("height","112px").attr("transform",f).attr("viewBox","0 0 72 125").select("line").attr("y1",t.is_ancestry?"62":"92")}}function xG(e){const t=e.style==="default"?u:e.style==="imageCircleRect"?c:e.style==="imageCircle"?d:e.style==="imageRect"?f:e.style==="rect"?m:u;return function(v){if(this.innerHTML=`
    <div class="card ${h(v).join(" ")}" data-id="${v.tid}" style="transform: translate(-50%, -50%); pointer-events: auto;">
      ${e.mini_tree?o(v):""}
      ${e.cardInnerHtmlCreator&&!v.data._new_rel_data?e.cardInnerHtmlCreator(v):t(v)}
    </div>
    `,this.querySelector(".card").addEventListener("click",N=>e.onCardClick(N,v)),e.onCardUpdate&&e.onCardUpdate.call(this,v),e.onCardMouseenter&&Je.select(this).select(".card").on("mouseenter",N=>e.onCardMouseenter(N,v)),e.onCardMouseleave&&Je.select(this).select(".card").on("mouseleave",N=>e.onCardMouseleave(N,v)),v.duplicate&&w(this,v),e.duplicate_branch_toggle&&gG(this,v,e.store.state.is_horizontal,e.store.updateTree),location.origin.includes("localhost")&&(v.__node=this.querySelector(".card"),v.__label=v.data.data["first name"],v.data.to_add)){const N=v.spouse||v._spouse||null;N&&Je.select(this).select(".card").attr("data-to-add",N.data.data["first name"])}};function n(v){return`
    <div class="card-inner card-image-circle" ${x()}>
      ${v.data.data[e.cardImageField]?`<img src="${v.data.data[e.cardImageField]}" ${y()}>`:p(v)}
      <div class="card-label">${i(v)}</div>
      ${v.duplicate?g(v):""}
    </div>
    `}function r(v){return`
    <div class="card-inner card-image-rect" ${x()}>
      ${v.data.data[e.cardImageField]?`<img src="${v.data.data[e.cardImageField]}" ${y()}>`:p(v)}
      <div class="card-label">${i(v)}</div>
      ${v.duplicate?g(v):""}
    </div>
    `}function s(v){return`
    <div class="card-inner card-rect" ${x()}>
      ${i(v)}
      ${v.duplicate?g(v):""}
    </div>
    `}function i(v){return v.data._new_rel_data?l(v):v.data.to_add?`<div>${e.empty_card_label||"ADD"}</div>`:v.data.unknown?`<div>${e.unknown_card_label||"UNKNOWN"}</div>`:`
      ${e.card_display.map(N=>`<div>${N(v.data)}</div>`).join("")}
    `}function l(v){const N=[];return N.push(`data-rel-type="${v.data._new_rel_data.rel_type}"`),["son","daughter"].includes(v.data._new_rel_data.rel_type)&&N.push(`data-other-parent-id="${v.data._new_rel_data.other_parent_id}"`),`<div ${N.join(" ")}>${v.data._new_rel_data.label}</div>`}function o(v){return!e.mini_tree||v.data.to_add||v.data._new_rel_data||v.all_rels_displayed?"":`<div class="mini-tree">${kb()}</div>`}function c(v){return v.data.data[e.cardImageField]?d(v):m(v)}function u(v){return r(v)}function d(v){return n(v)}function f(v){return r(v)}function m(v){return s(v)}function h(v){const N=[];return v.data.data.gender==="M"?N.push("card-male"):v.data.data.gender==="F"?N.push("card-female"):N.push("card-genderless"),N.push(`card-depth-${v.is_ancestry?-v.depth:v.depth}`),v.data.main&&N.push("card-main"),v.data._new_rel_data&&N.push("card-new-rel"),v.data.to_add&&N.push("card-to-add"),v.data.unknown&&N.push("card-unknown"),N}function x(){let v='style="';if(e.card_dim.w||e.card_dim.h)v+=`width: ${e.card_dim.w}px; min-height: ${e.card_dim.h}px;`,e.card_dim.height_auto?v+="height: auto;":v+=`height: ${e.card_dim.h}px;`;else return"";return v+='"',v}function y(){let v='style="position: relative;';if(e.card_dim.img_w||e.card_dim.img_h||e.card_dim.img_x||e.card_dim.img_y)v+=`width: ${e.card_dim.img_w}px; height: ${e.card_dim.img_h}px;`,v+=`left: ${e.card_dim.img_x}px; top: ${e.card_dim.img_y}px;`;else return"";return v+='"',v}function p(v){return v.data._new_rel_data?`<div class="person-icon" ${y()}>${mA()}</div>`:`<div class="person-icon" ${y()}>${e.defaultPersonIcon?e.defaultPersonIcon(v):Ab()}</div>`}function g(v){return`<div class="f3-card-duplicate-tag">x${v.duplicate}</div>`}function w(v,N){Je.select(v).on("mouseenter",A=>{Je.select(v.closest(".cards_view")).selectAll(".card_cont").select(".card").classed("f3-card-duplicate-hover",P=>P.data.id===N.data.id)}),Je.select(v).on("mouseleave",A=>{Je.select(v.closest(".cards_view")).selectAll(".card_cont").select(".card").classed("f3-card-duplicate-hover",!1)})}}function yG(e){return e=t(e),Eb(e.svg,e.card_dim),function(n){const r=n.data.data.gender==="M"?"card-male":n.data.data.gender==="F"?"card-female":"card-genderless",s=e.card_dim,i=Je.create("svg:g").attr("class",`card ${r}`).attr("transform",`translate(${[-s.w/2,-s.h/2]})`);i.append("g").attr("class","card-inner").attr("clip-path","url(#card_clip)"),this.innerHTML="",this.appendChild(i.node()),i.on("click",function(l){l.stopPropagation(),e.onCardClick.call(this,l,n)}),n.data._new_rel_data?(xf(j2({d:n,card_dim:s,is_new:n.data.to_add}).template,i.node(),!0),xf(nG({d:n,card_dim:s,label:n.data._new_rel_data.label}).template,this.querySelector(".card-inner"),!0),Je.select(this.querySelector(".card-inner")).append("g").attr("class","card-edit-icon").attr("fill","currentColor").attr("transform",`translate(-1,2)scale(${s.img_h/22})`).html(_b())):(xf(j2({d:n,card_dim:s,is_new:n.data.to_add}).template,i.node(),!0),xf(SA({d:n,card_dim:s,card_display:e.card_display}).template,this.querySelector(".card-inner")),e.img&&wa(no.cardImage(n,e),this.querySelector(".card")),e.mini_tree&&wa(no.miniTree(n,e),this.querySelector(".card"),!0),e.link_break&&wa(no.lineBreak(n,e),this.querySelector(".card"))),e.onCardUpdate&&e.onCardUpdate.call(this,n)};function t(n){const r={img:!0,mini_tree:!0,link_break:!1,card_dim:{w:220,h:70,text_x:75,text_y:15,img_w:60,img_h:60,img_x:5,img_y:5}};n||(n={});for(const s in r)typeof n[s]>"u"&&(n[s]=r[s]);return n}}function bG(...e){return new nd(...e)}function nd(e,t){this.cont=e,this.popup_cont=null,this.active=!1,this.onClose=t,this.init()}nd.prototype.init=function(){this.popup_cont=Je.select(this.cont).append("div").attr("class","f3-popup").node(),this.create()};nd.prototype.create=function(){const e=Je.select(this.popup_cont);e.html(`
    <div class="f3-popup-content">
      <span class="f3-popup-close">&times;</span>
      <div class="f3-popup-content-inner"></div>
    </div>
  `),e.select(".f3-popup-close").on("click",()=>{this.close()}),e.on("click",t=>{t.target==e.node()&&this.close()})};nd.prototype.activate=function(e){e&&Je.select(this.popup_cont).select(".f3-popup-content-inner").node().appendChild(e),this.open()};nd.prototype.open=function(){this.active=!0};nd.prototype.close=function(){this.popup_cont.remove(),this.active=!1,this.onClose&&this.onClose()};var vG=Object.freeze({__proto__:null,infoPopup:bG,appendElement:wa,Card:pG,CardHtml:xG,CardSvg:yG}),wG=(...e)=>new rd(...e);function rd(e,t,n){return this.store=e,this.onActivate=t,this.cancelCallback=n,this.datum=null,this.onChange=null,this.onCancel=null,this.is_active=!1,this.addRelLabels=this.addRelLabelsDefault(),this}rd.prototype.activate=function(e){this.is_active&&this.onCancel(),this.onActivate(),this.is_active=!0,this.store.state.one_level_rels=!0;const t=this.store;this.datum=e;let n=this.datum.data.gender;NG(e,this.getStoreData(),this.addRelLabels),t.updateTree({}),this.onChange=r.bind(this),this.onCancel=s.bind(this);function r(i,l){i!=null&&i._new_rel_data?l!=null&&l.link_rel_id?L8(i,l.link_rel_id,t.getData()):delete i._new_rel_data:i.id===e.id?i.data.gender!==n&&o():console.error("Something went wrong");function o(){n=i.data.gender,t.getData().forEach(u=>{const d=u._new_rel_data;d&&(d.rel_type==="spouse"&&(u.data.gender=u.data.gender==="M"?"F":"M"),["son","daughter"].includes(d.rel_type)&&([u.rels.father,u.rels.mother]=[u.rels.mother,u.rels.father]))})}}function s(){this.is_active&&(this.is_active=!1,this.store.state.one_level_rels=!1,this.cleanUp(),this.cancelCallback(this.datum),this.datum=null,this.onChange=null,this.onCancel=null)}};rd.prototype.setAddRelLabels=function(e){if(typeof e!="object"){console.error("add_rel_labels must be an object");return}for(let t in e)this.addRelLabels[t]=e[t];return this};rd.prototype.addRelLabelsDefault=function(){return{father:"Add Father",mother:"Add Mother",spouse:"Add Spouse",son:"Add Son",daughter:"Add Daughter"}};rd.prototype.getStoreData=function(){return this.store.getData()};rd.prototype.cleanUp=function(e){e||(e=this.store.getData());for(let t=e.length-1;t>=0;t--){const n=e[t];n._new_rel_data&&(e.forEach(r=>{r.rels.father===n.id&&delete r.rels.father,r.rels.mother===n.id&&delete r.rels.mother,(r.rels.children||[]).includes(n.id)&&r.rels.children.splice(r.rels.children.indexOf(n.id),1),(r.rels.spouses||[]).includes(n.id)&&r.rels.spouses.splice(r.rels.spouses.indexOf(n.id),1)}),e.splice(t,1))}return e};function NG(e,t,n){if(!e.rels.father){const o=Xi({data:{gender:"M"},rels:{children:[e.id]}});o._new_rel_data={rel_type:"father",label:n.father,rel_id:e.id},e.rels.father=o.id,t.push(o)}if(!e.rels.mother){const o=Xi({data:{gender:"F"},rels:{children:[e.id]}});o._new_rel_data={rel_type:"mother",label:n.mother,rel_id:e.id},e.rels.mother=o.id,t.push(o)}const r=t.find(o=>o.id===e.rels.mother),s=t.find(o=>o.id===e.rels.father);if(r.rels.spouses||(r.rels.spouses=[]),s.rels.spouses||(s.rels.spouses=[]),r.rels.spouses.includes(s.id)||r.rels.spouses.push(s.id),s.rels.spouses.includes(r.id)||s.rels.spouses.push(r.id),r.rels.children||(r.rels.children=[]),s.rels.children||(s.rels.children=[]),r.rels.children.includes(e.id)||r.rels.children.push(e.id),s.rels.children.includes(e.id)||s.rels.children.push(e.id),e.rels.spouses||(e.rels.spouses=[]),e.rels.children){let o;e.rels.children.forEach(c=>{const u=t.find(d=>d.id===c);u.rels.mother||(o||(o=Xi({data:{gender:"F"},rels:{spouses:[e.id],children:[]}})),o._new_rel_data={rel_type:"spouse",label:n.spouse,rel_id:e.id},o.rels.children.push(u.id),e.rels.spouses.push(o.id),u.rels.mother=o.id,t.push(o)),u.rels.father||(o||(o=Xi({data:{gender:"M"},rels:{spouses:[e.id],children:[]}})),o._new_rel_data={rel_type:"spouse",label:n.spouse,rel_id:e.id},o.rels.children.push(u.id),e.rels.spouses.push(o.id),u.rels.father=o.id,t.push(o))})}const i=e.data.gender==="M"?"F":"M",l=Xi({data:{gender:i},rels:{spouses:[e.id]}});return l._new_rel_data={rel_type:"spouse",label:n.spouse,rel_id:e.id},e.rels.spouses.push(l.id),t.push(l),e.rels.children||(e.rels.children=[]),e.rels.spouses.forEach(o=>{const c=t.find(h=>h.id===o),u=e.data.gender==="M"?c.id:e.id,d=e.data.gender==="F"?c.id:e.id;c.rels.children||(c.rels.children=[]);const f=Xi({data:{gender:"M"},rels:{father:d,mother:u}});f._new_rel_data={rel_type:"son",label:n.son,other_parent_id:c.id,rel_id:e.id},c.rels.children.push(f.id),e.rels.children.push(f.id),t.push(f);const m=Xi({data:{gender:"F"},rels:{mother:u,father:d}});m._new_rel_data={rel_type:"daughter",label:n.daughter,other_parent_id:c.id,rel_id:e.id},c.rels.children.push(m.id),e.rels.children.push(m.id),t.push(m)}),t}var jG=(...e)=>new _A(...e);function _A(e,t,n,r){return this.store=e,this.onActivate=t,this.cancelCallback=n,this.modal=r,this.datum=null,this.onChange=null,this.onCancel=null,this.is_active=!1,this}_A.prototype.activate=function(e){this.is_active&&this.onCancel(),this.onActivate(),this.is_active=!0,this.store.state.one_level_rels=!0;const t=this.store;this.datum=e,t.updateTree({}),this.onChange=n.bind(this),this.onCancel=r.bind(this);function n(s,i){const l=m(s),o=e.rels;l==="father"?c.call(this):l==="mother"?u.call(this):l==="spouse"?d.call(this):l==="children"&&f.call(this);function c(){const h=t.getDatum(o.father);h.rels.children=h.rels.children.filter(x=>x!==e.id),o.father=null,i()}function u(){const h=t.getDatum(o.mother);h.rels.children=h.rels.children.filter(x=>x!==e.id),o.mother=null,i()}function d(){const h=s.data;x()?y.call(this):p.call(this,!0);function x(){return(h.rels.children||[]).some(w=>{const v=t.getDatum(w);return v.rels.father===h.id||v.rels.mother===h.id})}function y(){const g=e.data.gender==="M"?"f3-male-bg":e.data.gender==="F"?"f3-female-bg":null,w=h.data.gender==="M"?"f3-male-bg":h.data.gender==="F"?"f3-female-bg":null,v=Je.create("div").html(`
          <p>You are removing a spouse relationship. Since there are shared children, please choose which parent should keep them in the family tree.</p>
          <div class="f3-modal-options">
            <button data-option="assign-to-current" class="f3-btn ${g}">Keep children with current person</button>
            <button data-option="assign-to-spouse" class="f3-btn ${w}">Keep children with spouse</button>
          </div>
        `);v.selectAll('[data-option="assign-to-current"]').on("click",()=>{p(!0),this.modal.close()}),v.selectAll('[data-option="assign-to-spouse"]').on("click",()=>{p(!1),this.modal.close()}),this.modal.activate(v.node())}function p(g){s.data.rels.spouses=s.data.rels.spouses.filter(N=>N!==e.id),o.spouses=o.spouses.filter(N=>N!==s.data.id);const w=g?e:s.data,v=g?s.data:e;(o.children||[]).forEach(N=>{const A=t.getDatum(N);A.rels.father===v.id&&(A.rels.father=null),A.rels.mother===v.id&&(A.rels.mother=null)}),v.rels.children&&(v.rels.children=v.rels.children.filter(N=>!(w.rels.children||[]).includes(N))),i()}}function f(){o.children=o.children.filter(x=>x!==s.data.id);const h=s.data.rels.father===e.id?"father":"mother";s.data.rels[h]=null,i()}function m(h){if(h.is_ancestry){if(e.rels.father===h.data.id)return"father";if(e.rels.mother===h.data.id)return"mother"}else if(h.spouse){if(e.rels.spouses.includes(h.data.id))return"spouse"}else if(e.rels.children.includes(h.data.id))return"children";return null}}function r(){this.is_active&&(this.is_active=!1,this.store.state.one_level_rels=!1,this.cancelCallback(this.datum),this.datum=null,this.onChange=null,this.onCancel=null)}};function SG(...e){return new gc(...e)}function gc(e){this.cont=e,this.modal_cont=null,this.active=!1,this.onClose=null,this.init()}gc.prototype.init=function(){this.modal_cont=Je.select(this.cont).append("div").attr("class","f3-modal").node(),Je.select(this.modal_cont).style("display","none"),this.create()};gc.prototype.create=function(){const e=Je.select(this.modal_cont);e.html(`
    <div class="f3-modal-content">
      <span class="f3-modal-close">&times;</span>
      <div class="f3-modal-content-inner"></div>
      <div class="f3-modal-content-bottom"></div>
    </div>
  `),e.select(".f3-modal-close").on("click",()=>{this.close()}),e.on("click",t=>{t.target==e.node()&&this.close()})};gc.prototype.activate=function(e,{boolean:t,onAccept:n,onCancel:r}={}){this.reset(),typeof e=="string"?Je.select(this.modal_cont).select(".f3-modal-content-inner").html(e):Je.select(this.modal_cont).select(".f3-modal-content-inner").node().appendChild(e),t&&(Je.select(this.modal_cont).select(".f3-modal-content-bottom").html(`
      <button class="f3-modal-accept f3-btn">Accept</button>
      <button class="f3-modal-cancel f3-btn">Cancel</button>
    `),Je.select(this.modal_cont).select(".f3-modal-accept").on("click",()=>{n(),this.reset(),this.close()}),Je.select(this.modal_cont).select(".f3-modal-cancel").on("click",()=>{this.close()}),this.onClose=r),this.open()};gc.prototype.reset=function(){this.onClose=null,Je.select(this.modal_cont).select(".f3-modal-content-inner").html(""),Je.select(this.modal_cont).select(".f3-modal-content-bottom").html("")};gc.prototype.open=function(){this.modal_cont.style.display="block",this.active=!0};gc.prototype.close=function(){this.modal_cont.style.display="none",this.active=!1,this.onClose&&this.onClose()};function AA(e,t,n={}){const r=t.find(d=>d.id===e),s={};return i(r.id,"self",0),l(s),n.show_in_law&&o(s,t),c(s),s;function i(d,f,m,h=void 0){if(!d||(s[d]&&s[d]!==f&&console.error("kinship mismatch, kinship 1: ",s[d],"kinship 2: ",f),s[d]))return;f&&(s[d]=f);const y=t.find(p=>p.id===d).rels;if(f==="self")i(y.father,"parent",m-1,d),i(y.mother,"parent",m-1,d),(y.spouses||[]).forEach(p=>i(p,"spouse",m)),(y.children||[]).forEach(p=>i(p,"child",m+1));else if(f==="parent")i(y.father,"grandparent",m-1,d),i(y.mother,"grandparent",m-1,d),(y.children||[]).forEach(p=>{h&&h===p||i(p,"sibling",m+1)});else if(f!=="spouse")if(f==="child")(y.children||[]).forEach(p=>i(p,"grandchild",m+1));else if(f==="sibling")(y.children||[]).forEach(p=>i(p,"nephew",m+1));else if(f==="grandparent")h||console.error(`${f} should have prev_rel_id`),i(y.father,"great-grandparent",m-1,d),i(y.mother,"great-grandparent",m-1,d),(y.children||[]).forEach(p=>{h&&h===p||i(p,"uncle",m+1)});else if(f.includes("grandchild"))(y.children||[]).forEach(p=>i(p,Yd(f,m+1),m+1));else if(f.includes("great-grandparent"))h||console.error(`${f} should have prev_rel_id`),i(y.father,Yd(f,m-1),m-1,d),i(y.mother,Yd(f,m-1),m-1,d),(y.children||[]).forEach(p=>{if(h&&h===p)return;const g=CA(m+1);g===0?i(p,"granduncle",m+1):g>0?i(p,Yd("granduncle",m+1),m+1):console.error(`${f} should have great_count > -1`)});else if(f==="nephew")(y.children||[]).forEach(p=>i(p,"grandnephew",m+1));else if(f.includes("grandnephew"))(y.children||[]).forEach(p=>i(p,Yd(f,m+1),m+1));else if(f==="uncle")(y.children||[]).forEach(p=>i(p,"1st Cousin",m+1));else if(f==="granduncle")(y.children||[]).forEach(p=>i(p,"1st Cousin 1x removed",m+1));else if(f.includes("great-granduncle")){const p=m+1,g=Math.abs(p);(y.children||[]).forEach(w=>i(w,`1st Cousin ${g}x removed`,p))}else f.slice(4).startsWith("Cousin")?(y.children||[]).forEach(p=>{const g=m+1,w=Math.abs(g),v=+f[0];g===0?i(p,`${T1(v+1)} Cousin`,g):g<0?i(p,`${T1(v+1)} Cousin ${w}x removed`,g):g>0&&i(p,`${T1(v)} Cousin ${w}x removed`,g)}):console.error(`${f} not found`)}function l(d){const f=[];Object.keys(d).forEach(m=>{const h=d[m];if(h.includes("child")||h==="spouse")return;const x=kA(r.id,m,t);if(!x)return console.error(`${t.find(y=>y.id===m).data} not found in main_ancestry`);x.is_half_kin&&f.push(m)}),f.forEach(m=>{d[m]=`Half ${d[m]}`})}function o(d,f){Object.keys(d).forEach(m=>{const h=d[m],x=f.find(y=>y.id===m);if(h==="spouse"){const y=[];x.rels.mother&&(u(x.rels.mother).rels.children||[]).forEach(p=>y.push(p)),x.rels.father&&(u(x.rels.father).rels.children||[]).forEach(p=>y.push(p)),y.forEach(p=>{d[p]||(d[p]="sibling-in-law")})}h==="sibling"&&(x.rels.spouses||[]).forEach(y=>{d[y]||(d[y]="sibling-in-law")}),h==="child"&&(x.rels.spouses||[]).forEach(y=>{d[y]||(d[y]="child-in-law")}),h==="uncle"&&(x.rels.spouses||[]).forEach(y=>{d[y]||(d[y]="uncle-in-law")}),h.includes("Cousin")&&(x.rels.spouses||[]).forEach(y=>{d[y]||(d[y]=`${h} in-law`)})})}function c(d){Object.keys(d).forEach(f=>{const m=d[f],x=t.find(y=>y.id===f).data.gender;if(m.includes("parent")){const p=x==="M"?"father":x==="F"?"mother":"parent";d[f]=d[f].replace("parent",p)}else if(m.includes("sibling")){const p=x==="M"?"brother":x==="F"?"sister":"sibling";d[f]=d[f].replace("sibling",p)}else if(m.includes("child")){const p=x==="M"?"son":x==="F"?"daughter":"child";d[f]=d[f].replace("child",p)}else if(m.includes("uncle")){const p=x==="M"?"uncle":x==="F"?"aunt":"aunt/uncle";d[f]=d[f].replace("uncle",p)}else if(m.includes("nephew")){const p=x==="M"?"nephew":x==="F"?"niece":"neice/nephew";d[f]=d[f].replace("nephew",p)}})}function u(d){return t.find(f=>f.id===d)}}function kA(e,t,n){const r=c(e);let s,i,l;if(d(t),f(t),o(t),!s)return null;return{found:s,is_ancestor:i,is_half_kin:l};function o(h){if(s)return;if(h===e){i=!0,s=h,l=!1;return}const y=n.find(w=>w.id===h).rels,p=u(y),g=r.find(w=>w[0]&&p[0]&&w[0]===p[0]||w[1]&&p[1]&&w[1]===p[1]);if(g){s=p.filter((w,v)=>w===g[v]),l=m(p,g);return}y.father&&o(y.father),y.mother&&o(y.mother)}function c(h){const x=[];return y(h),x;function y(p){const w=n.find(v=>v.id===p).rels;x.push(u(w)),w.father&&y(w.father),w.mother&&y(w.mother)}}function u(h){return[h.father,h.mother]}function d(h){const x=n.find(p=>p.id===h);r.find(p=>p[0]===x.id||p[1]===x.id)&&(i=!0,s=h,l=!1)}function f(h){(n.find(y=>y.id===e).rels.spouses||[]).includes(h)&&(s=[e,h])}function m(h,x){return h[0]!==x[0]||h[1]!==x[1]}}function EA(e,t,n,r){let s;const i=r[t].toLowerCase();if(i.includes("in-law")){s=t;const P=n.find(U=>U.id===s);i.includes("sister")||i.includes("brother")?t=e:t=P.rels.spouses.find(U=>r[U]&&!r[U].includes("in-law"))}const l=kA(e,t,n);if(!l)return console.error(`${t} not found in main_ancestry`);const o=l.is_ancestor?l.found:l.found[0],c=n.find(P=>P.id===o),u=Je.hierarchy(c,y),d=u.descendants().map(P=>P.data.id),f=p(e,d),m=p(t,d);x(u);const h=u.descendants().map(P=>{const U={id:P.data.id,data:JSON.parse(JSON.stringify(P.data.data)),kinship:r[P.data.id],rels:{}};return P.children&&P.children.length>0&&(U.rels.children=P.children.map(M=>M.data.id)),U});return h.length>0&&!l.is_ancestor&&!l.is_half_kin&&g(h),s&&w(h),h;function x(P){P.children=(P.children||[]).filter(U=>!!(f.includes(U.data.id)||m.includes(U.data.id))),P.children.forEach(U=>x(U)),P.children.length===0&&delete P.children}function y(P){return[...P.rels.children||[]].map(M=>n.find(S=>S.id===M))}function p(P,U){const M=[P];return S(P),M;function S(C){const T=n.find(B=>B.id===C).rels;U.includes(T.mother)&&(M.push(T.mother),S(T.mother)),U.includes(T.father)&&(M.push(T.father),S(T.father))}}function g(P){const U=P[0],M=o===l.found[0]?l.found[1]:l.found[0];U.rels.spouses=[M];const S=n.find(_=>_.id===M),C={id:S.id,data:JSON.parse(JSON.stringify(S.data)),kinship:r[S.id],rels:{spouses:[U.id],children:U.rels.children}};P.push(C),(U.rels.children||[]).forEach(_=>{const T=n.find($=>$.id===_),B=P.find($=>$.id===_);B.rels.father=T.rels.father,B.rels.mother=T.rels.mother})}function w(P){i.includes("sister")||i.includes("brother")?N(P):v(P)}function v(P){const U=P.find(_=>_.id===t),M=s;U.rels.spouses=[M];const S=n.find(_=>_.id===M),C={id:S.id,data:JSON.parse(JSON.stringify(S.data)),kinship:r[S.id],rels:{spouses:[U.id],children:[]}};P.push(C)}function N(P){const U=P.find(B=>B.id===t),M=A(s);P.push({id:s,data:JSON.parse(JSON.stringify(M.data)),kinship:r[s],rels:{spouses:[],children:[]}});const S=[];M.rels.mother&&(A(M.rels.mother).rels.children||[]).forEach(B=>S.push(B)),M.rels.father&&(A(M.rels.father).rels.children||[]).forEach(B=>S.push(B));const C=A(t).rels.spouses.find(B=>S.includes(B));U.rels.spouses=[C];const _=A(C),T={id:_.id,data:JSON.parse(JSON.stringify(_.data)),kinship:r[_.id],rels:{spouses:[U.id],children:[]}};if(P.push(T),M.rels.father){const B=M.rels.father,$=A(B),D={id:$.id,data:JSON.parse(JSON.stringify($.data)),kinship:"Father-in-law",rels:{spouses:[],children:[C,s]}};M.rels.mother&&D.rels.spouses.push(M.rels.mother),P.unshift(D)}if(M.rels.mother){const B=M.rels.mother,$=A(B),D={id:$.id,data:JSON.parse(JSON.stringify($.data)),kinship:"Mother-in-law",rels:{spouses:[],children:[C,s]}};M.rels.father&&D.rels.spouses.push(M.rels.father),P.unshift(D)}}function A(P){return n.find(U=>U.id===P)}}function T1(e){const t=["st","nd","rd"];return t[e-1]?e+t[e-1]:e+"th"}function CA(e){return Math.abs(e)-2}function Yd(e,t){const n=CA(t);return e.includes("great-")&&(e=e.split("great-")[1]),n===1?`great-${e}`:n>1?`${n}x-great-${e}`:(console.error(`${e} should have great_count > 1`),e)}function _G(e,t,n){const{self_id:r,getLabel:s,title:i}=e,l=AA(r,n,e),o=l[t];if(!o)return;let c=o;o==="self"?c="You":c=PA(c);const u=`
    <div class="f3-kinship-info">
      <div class="f3-info-field">
        <span class="f3-info-field-label">${i}</span>
        <span class="f3-info-field-value">
          <span>${c}</span>
          <span class="f3-kinship-info-icon">${jA()}</span>
        </span>
      </div>
    </div>
  `,d=Je.create("div").html(u).select("div").node();let f;return Je.select(d).select(".f3-kinship-info-icon").on("click",h=>m(h,d)),d;function m(h,x){let g=h.clientX-250-10,w=h.clientY-400-10;if(g+250>window.innerWidth&&(g=window.innerWidth-250-10),w<0&&(w=10),f&&f.active){f.close(),f=null;return}f=Wr.elements.infoPopup(x),Je.select(f.popup_cont).style("width","250px").style("height","400px").style("left",`${g}px`).style("top",`${w}px`);const v=f.popup_cont.querySelector(".f3-popup-content-inner");f.activate(),AG(r,t,n,l,v,s)}}function AG(e,t,n,r,s,i){Je.select(s).select("#SmallChart").node()||Je.select(s).append("div").attr("id","SmallChart").attr("class","f3");const l=Je.select("#SmallChart");l.selectAll("*").remove();const o=EA(e,t,n,r);let c=!0;const u=l.append("div");d(o);function d(f){const m=Wr.createChart("#SmallChart",f).setTransitionTime(500).setCardXSpacing(170).setCardYSpacing(70).setSingleParentEmptyCard(!1),h=m.setCard(Wr.CardHtml).setStyle("rect").setCardInnerHtmlCreator(g=>x(g)).setOnCardUpdate(function(g){Je.select(this).select(".card").classed("card-main",!1)});h.onCardClick=(g,w)=>{},m.updateTree({initial:!0}),setTimeout(()=>p(.65),100),y();function x(g){let w=g.data.kinship==="self"?"You":g.data.kinship;return w=PA(w),c||(w=i(g.data)),`
        <div class="card-inner card-rect ${v()}">
          <div class="card-label">${w}</div>
        </div>
      `;function v(){return g.data.kinship==="self"?"card-kinship-self"+(c?"":" f3-real-label"):g.data.id===t?"card-kinship-rel":"card-kinship-default"}}function y(){u.classed("f3-kinship-labels-toggle",!0),u.append("label").text("Kinship labels").append("input").attr("type","checkbox").attr("checked",!0).on("change",g=>{c=!c,m.updateTree({initial:!1,tree_position:"inherit"})})}function p(g){const w=m.cont.querySelector("svg.main_svg");Wr.handlers.getCurrentZoom(w).k>g&&Wr.handlers.zoomTo(w,g)}}}function PA(e){return e=e[0].toUpperCase()+e.slice(1),e.includes("great-")&&(e=e.replace("great-","Great-")),e}function kG(...e){return new Fn(...e)}function Fn(e,t){return this.cont=e,this.store=t,this.fields=[{type:"text",label:"first name",id:"first name"},{type:"text",label:"last name",id:"last name"},{type:"text",label:"birthday",id:"birthday"},{type:"text",label:"avatar",id:"avatar"}],this.form_cont=null,this.is_fixed=!0,this.history=null,this.no_edit=!1,this.onChange=null,this.editFirst=!1,this.postSubmit=null,this.link_existing_rel_config=null,this.onFormCreation=null,this.kinship_info_config=null,this.init(),this}Fn.prototype.init=function(){this.form_cont=Je.select(this.cont).append("div").classed("f3-form-cont",!0).node(),this.modal=this.setupModal(),this.addRelativeInstance=this.setupAddRelative(),this.removeRelativeInstance=this.setupRemoveRelative(),this.createHistory()};Fn.prototype.open=function(e){e.data.data&&typeof e.data.data=="object"&&(e=e.data);const t=this.store.getTreeDatum(e.id);this.addRelativeInstance.is_active?n.call(this,e):this.removeRelativeInstance.is_active?r.call(this,t):this.cardEditForm(e);function n(){e._new_rel_data?this.cardEditForm(e):(this.addRelativeInstance.onCancel(),this.cardEditForm(e),this.store.updateMainId(e.id),this.store.updateTree({}))}function r(){if(e.id===this.removeRelativeInstance.datum.id)this.removeRelativeInstance.onCancel(),this.cardEditForm(e);else{let s=function(){this.removeRelativeInstance.onCancel(),this.updateHistory(),this.store.updateTree({})};this.removeRelativeInstance.onChange(t,s.bind(this))}}};Fn.prototype.openWithoutRelCancel=function(e){this.cardEditForm(e)};Fn.prototype.cardEditForm=function(e){const t={};(e==null?void 0:e._new_rel_data)?t.onCancel=()=>this.addRelativeInstance.onCancel():(t.addRelative=this.addRelativeInstance,t.removeRelative=this.removeRelativeInstance,t.deletePerson=()=>{ag(e,this.store.getData()),this.openFormWithId(this.store.getLastAvailableMainDatum().id),this.store.updateTree({})});const r=Wr.handlers.createForm({store:this.store,datum:e,postSubmit:i.bind(this),fields:this.fields,addRelative:null,onCancel:()=>{},editFirst:this.editFirst,link_existing_rel_config:this.link_existing_rel_config,getKinshipInfo:this.kinship_info_config?()=>_G(this.kinship_info_config,e.id,this.store.getData()):null,onFormCreation:this.onFormCreation,...t});r.no_edit=this.no_edit,this.no_edit&&(r.editable=!1);const s=Wr.handlers.formInfoSetup(r,this.closeForm.bind(this));this.form_cont.innerHTML="",this.form_cont.appendChild(s),this.openForm();function i(l){if(this.addRelativeInstance.is_active){this.addRelativeInstance.onChange(e,l),this.postSubmit&&this.postSubmit(e,this.store.getData());const o=this.addRelativeInstance.datum;this.store.updateMainId(o.id),this.openWithoutRelCancel(o)}else(e.to_add||e.unknown)&&(l!=null&&l.link_rel_id)?(L8(e,l.link_rel_id,this.store.getData()),this.store.updateMainId(l.link_rel_id),this.openFormWithId(l.link_rel_id)):l!=null&&l.delete||(this.postSubmit&&this.postSubmit(e,this.store.getData()),this.openFormWithId(e.id));this.is_fixed||this.closeForm(),this.store.updateTree({}),this.updateHistory()}};Fn.prototype.openForm=function(){Je.select(this.form_cont).classed("opened",!0)};Fn.prototype.closeForm=function(){Je.select(this.form_cont).classed("opened",!1).html(""),this.store.updateTree({})};Fn.prototype.fixed=function(){return this.is_fixed=!0,Je.select(this.form_cont).style("position","relative"),this};Fn.prototype.absolute=function(){return this.is_fixed=!1,Je.select(this.form_cont).style("position","absolute"),this};Fn.prototype.setCardClickOpen=function(e){return e.setOnCardClick((t,n)=>{this.isAddingRelative()?this.open(n.data):this.isRemovingRelative()?this.open(n.data):(this.open(n.data),e.onCardClickDefault(t,n))}),this};Fn.prototype.openFormWithId=function(e){if(e){const t=this.store.getDatum(e);this.openWithoutRelCancel(t)}else{const t=this.store.getMainDatum();this.openWithoutRelCancel(t)}};Fn.prototype.createHistory=function(){return this.history=Wr.handlers.createHistory(this.store,this.getStoreDataCopy.bind(this),e.bind(this)),this.history.controls=Wr.handlers.createHistoryControls(this.cont.querySelector(".f3-nav-cont"),this.history),this.history.changed(),this.history.controls.updateButtons(),this;function e(){var t;this.addRelativeInstance.is_active&&this.addRelativeInstance.onCancel(),this.removeRelativeInstance.is_active&&this.removeRelativeInstance.onCancel(),this.store.updateTree({initial:!1}),this.history.controls.updateButtons(),this.openFormWithId((t=this.store.getMainDatum())==null?void 0:t.id),this.onChange&&this.onChange()}};Fn.prototype.setNoEdit=function(){return this.no_edit=!0,this};Fn.prototype.setEdit=function(){return this.no_edit=!1,this};Fn.prototype.setFields=function(e){const t=[];if(!Array.isArray(e))return console.error("fields must be an array"),this;for(const n of e)typeof n=="string"?t.push({type:"text",label:n,id:n}):typeof n=="object"?n.id?t.push(n):console.error("fields must be an array of objects with id property"):console.error("fields must be an array of strings or objects");return this.fields=t,this};Fn.prototype.setOnChange=function(e){return this.onChange=e,this};Fn.prototype.addRelative=function(e){return e||(e=this.store.getMainDatum()),this.addRelativeInstance.activate(e),this};Fn.prototype.setupAddRelative=function(){return wG(this.store,e.bind(this),t.bind(this));function e(){this.removeRelativeInstance.is_active&&this.removeRelativeInstance.onCancel()}function t(n){this.store.updateMainId(n.id),this.store.updateTree({}),this.openFormWithId(n.id)}};Fn.prototype.setupRemoveRelative=function(){return jG(this.store,e.bind(this),t.bind(this),this.modal);function e(){this.addRelativeInstance.is_active&&this.addRelativeInstance.onCancel(),n(this.cont,!0)}function t(r){n(this.cont,!1),this.store.updateMainId(r.id),this.store.updateTree({}),this.openFormWithId(r.id)}function n(r,s){Je.select(r).select("#f3Canvas").classed("f3-remove-relative-active",s)}};Fn.prototype.setupModal=function(){return SG(this.cont)};Fn.prototype.setEditFirst=function(e){return this.editFirst=e,this};Fn.prototype.isAddingRelative=function(){return this.addRelativeInstance.is_active};Fn.prototype.isRemovingRelative=function(){return this.removeRelativeInstance.is_active};Fn.prototype.setAddRelLabels=function(e){return this.addRelativeInstance.setAddRelLabels(e),this};Fn.prototype.setLinkExistingRelConfig=function(e){return this.link_existing_rel_config=e,this};Fn.prototype.setOnFormCreation=function(e){return this.onFormCreation=e,this};Fn.prototype.setKinshipInfo=function(e){return this.kinship_info_config=e,this};Fn.prototype.getStoreDataCopy=function(){let e=JSON.parse(JSON.stringify(this.store.getData()));return this.addRelativeInstance.is_active&&(e=this.addRelativeInstance.cleanUp(e)),e=Wr.handlers.cleanupDataJson(e),e};Fn.prototype.getDataJson=function(){return JSON.stringify(this.getStoreDataCopy(),null,2)};Fn.prototype.updateHistory=function(){this.history&&(this.history.changed(),this.history.controls.updateButtons()),this.onChange&&this.onChange()};Fn.prototype.setPostSubmit=function(e){return this.postSubmit=e,this};Fn.prototype.destroy=function(){return this.history.controls.destroy(),this.history=null,Je.select(this.cont).select(".f3-form-cont").remove(),this.addRelativeInstance.onCancel&&this.addRelativeInstance.onCancel(),this.store.updateTree({}),this};function EG(e,t,n={}){const r=[];t.data.forEach(m=>{m._spouse&&m.data.data.gender==="F"&&r.push({nodes:[m,m._spouse],id:`${m.data.id}--${m._spouse.data.id}`}),m.spouses&&m.spouses.forEach(h=>r.push({nodes:[h,m],id:`${h.data.id}--${m.data.id}`}))});const s=Je.select(e).select(".links_view").selectAll("g.link-text").data(r,m=>m.id),i=s.exit(),l=s.enter().append("g").attr("class","link-text"),o=l.merge(s),c=(m,h)=>m.spouse&&m.data.data.gender==="F"?m.x-n.node_separation/2:h.spouse&&h.data.data.gender==="M"?h.x+n.node_separation/2:Math.min(m.x,h.x)+n.node_separation/2;i.each(f),l.each(u),o.each(d);function u(m){const[h,x]=m.nodes,y=Je.select(this);y.attr("transform",`translate(${c(h,x)}, ${h.y-3})`).style("opacity",0),y.append("text").style("font-size","12px").style("fill","#fff").style("text-anchor","middle")}function d(m){const[h,x]=m.nodes,y=Je.select(this),p=n.initial?jh(t,h,n.transition_time):0;y.select("text").text(n.linkSpouseText(h,x)),y.transition("text").duration(n.transition_time).delay(p).attr("transform",`translate(${c(h,x)}, ${h.y-3})`),y.transition("text-op").duration(100).delay(p+n.transition_time).style("opacity",1)}function f(m){const h=Je.select(this);h.transition("text").duration(100).style("opacity",0).on("end",()=>h.remove())}}function CG(...e){return new sd(...e)}function sd(e,t){this.cont=e,this.autocomplete_cont=null,this.options=[],this.onSelect=t,this.init()}sd.prototype.init=function(){this.autocomplete_cont=Je.select(this.cont).append("div").attr("class","f3-autocomplete-cont").node(),Je.select(this.autocomplete_cont),this.create()};sd.prototype.create=function(){const e=this;Je.select(this.autocomplete_cont).html(`
    <div class="f3-autocomplete">
      <div class="f3-autocomplete-input-cont">
        <input type="text" placeholder="Search">
        <span class="f3-autocomplete-toggle">${wA()}</span>
      </div>
      <div class="f3-autocomplete-items" tabindex="0"></div>
    </div>
  `);const t=Je.select(this.autocomplete_cont).select(".f3-autocomplete"),n=t.select("input"),r=t.select(".f3-autocomplete-items");t.on("focusout",()=>{setTimeout(()=>{t.node().contains(document.activeElement)||i()},200)}),n.on("focus",()=>{o(),s()}).on("input",s).on("keydown",c),r.on("wheel",u=>u.stopPropagation()),t.select(".f3-autocomplete-toggle").on("click",u=>{u.stopPropagation();const d=t.classed("active");t.classed("active",!d),d?i():(n.node().focus(),s())});function s(){t.classed("active",!0);const u=n.property("value"),d=e.options.filter(h=>h.label.toLowerCase().includes(u.toLowerCase()));d.forEach(f),d.sort(m),l(d);function f(h){const x=h.label.toLowerCase().indexOf(u.toLowerCase());x!==-1?h.label_html=y():h.label_html=h.label;function y(){return h.label.substring(0,x)+"<strong>"+h.label.substring(x,x+u.length)+"</strong>"+h.label.substring(x+u.length)}}function m(h,x){return h.label<x.label?-1:h.label>x.label?1:0}}function i(){t.classed("active",!1),l([])}function l(u){r.selectAll("div.f3-autocomplete-item").data(u,f=>f==null?void 0:f.value).join("div").attr("class","f3-autocomplete-item").on("click",(f,m)=>{e.onSelect(m.value)}).html(f=>f.optionHtml?f.optionHtml(f):d(f));function d(f){return`<div class="${f.class?f.class:""}">${f.label_html}</div>`}}function o(){e.options=e.getOptions()}function c(u){const d=r.selectAll("div.f3-autocomplete-item").nodes(),f=d.findIndex(h=>Je.select(h).classed("f3-selected"));if(u.key==="ArrowDown"){u.preventDefault();const h=f<d.length-1?f+1:0;m(d,h)}else if(u.key==="ArrowUp"){u.preventDefault();const h=f>0?f-1:d.length-1;m(d,h)}else if(u.key==="Enter"&&f!==-1){u.preventDefault();const h=Je.select(d[f]).datum();h&&e.onSelect(h.value)}function m(h,x){h.forEach(y=>Je.select(y).classed("f3-selected",!1)),h[x]&&(Je.select(h[x]).classed("f3-selected",!0),h[x].scrollIntoView({block:"nearest"}))}}};sd.prototype.setOptionsGetter=function(e){return this.getOptions=e,this};sd.prototype.setOptionsGetterPerson=function(e,t){return this.getOptions=()=>{const s=[];return e().forEach(l=>{l.to_add||l.unknown||l._new_rel_data||s.find(o=>o.value===l.id)||s.push({label:t(l),value:l.id,optionHtml:n(l)})}),s},this;function n(s){const i=!vb(s,e());return l=>`
      <div>
        <span style="float: left; width: 10px; height: 10px; margin-right: 10px;" class="f3-${r(s)}-color">${Ab()}</span>
        <span>${l.label_html}</span>
        ${i?`<span style="float: right; width: 10px; height: 10px; margin-left: 5px;" title="This profile is not connected to the main profile">${NA()}</span>`:""}
      </div>
    `}function r(s){return s.data.gender==="M"?"male":s.data.gender==="F"?"female":"genderless"}};sd.prototype.destroy=function(){this.autocomplete_cont.remove()};function PG(...e){return new On(...e)}function On(e,t){return this.cont=null,this.store=null,this.svg=null,this.getCard=null,this.node_separation=250,this.level_separation=150,this.is_horizontal=!1,this.single_parent_empty_card=!0,this.transition_time=2e3,this.linkSpouseText=!1,this.personSearch=null,this.is_card_html=!1,this.beforeUpdate=null,this.afterUpdate=null,this.init(e,t),this}On.prototype.init=function(e,t){this.cont=e=IG(e);const n=()=>e.querySelector("svg .view"),r=()=>e.querySelector("#htmlSvg"),s=()=>e.querySelector("#htmlSvg .cards_view");this.svg=Wr.createSvg(e,{onZoom:Wr.htmlHandlers.onZoomSetup(n,s)}),Wr.htmlHandlers.createHtmlSvg(e),TG(this.cont),this.store=Wr.createStore({data:t,node_separation:this.node_separation,level_separation:this.level_separation,single_parent_empty_card:this.single_parent_empty_card,is_horizontal:this.is_horizontal}),this.store.setOnUpdate(i=>{this.beforeUpdate&&this.beforeUpdate(i),i=Object.assign({transition_time:this.transition_time},i||{}),this.is_card_html&&(i=Object.assign({},i||{},{cardHtml:r()})),Wr.view(this.store.getTree(),this.svg,this.getCard(),i||{}),this.linkSpouseText&&EG(this.svg,this.store.getTree(),Object.assign({},i||{},{linkSpouseText:this.linkSpouseText,node_separation:this.node_separation})),this.afterUpdate&&this.afterUpdate(i)})};On.prototype.updateTree=function(e={initial:!1}){return this.store.updateTree(e),this};On.prototype.updateData=function(e){return this.store.updateData(e),this};On.prototype.setCardYSpacing=function(e){return typeof e!="number"?(console.error("card_y_spacing must be a number"),this):(this.level_separation=e,this.store.state.level_separation=e,this)};On.prototype.setCardXSpacing=function(e){return typeof e!="number"?(console.error("card_x_spacing must be a number"),this):(this.node_separation=e,this.store.state.node_separation=e,this)};On.prototype.setOrientationVertical=function(){return this.is_horizontal=!1,this.store.state.is_horizontal=!1,this};On.prototype.setOrientationHorizontal=function(){return this.is_horizontal=!0,this.store.state.is_horizontal=!0,this};On.prototype.setShowSiblingsOfMain=function(e){return this.store.state.show_siblings_of_main=e,this};On.prototype.setModifyTreeHierarchy=function(e){return this.store.state.modifyTreeHierarchy=e,this};On.prototype.setPrivateCardsConfig=function(e){return this.store.state.private_cards_config=e,this};On.prototype.setLinkSpouseText=function(e){return this.linkSpouseText=e,this};On.prototype.setSingleParentEmptyCard=function(e,{label:t="Unknown"}={}){return this.single_parent_empty_card=e,this.store.state.single_parent_empty_card=e,this.store.state.single_parent_empty_card_label=t,this.editTreeInstance&&this.editTreeInstance.addRelativeInstance.is_active&&this.editTreeInstance.addRelativeInstance.onCancel(),Wr.handlers.removeToAddFromData(this.store.getData()||[]),this};On.prototype.setCard=function(e){this.is_card_html=e.is_html,this.is_card_html?(this.svg.querySelector(".cards_view").innerHTML="",this.cont.querySelector("#htmlSvg").style.display="block"):(this.cont.querySelector("#htmlSvg .cards_view").innerHTML="",this.cont.querySelector("#htmlSvg").style.display="none");const t=e(this.cont,this.store);return this.getCard=()=>t.getCard(),t};On.prototype.setTransitionTime=function(e){return this.transition_time=e,this};On.prototype.setSortChildrenFunction=function(e){return this.store.state.sortChildrenFunction=e,this};On.prototype.setSortSpousesFunction=function(e){return this.store.state.sortSpousesFunction=e,this};On.prototype.setAncestryDepth=function(e){return this.store.state.ancestry_depth=e,this};On.prototype.setProgenyDepth=function(e){return this.store.state.progeny_depth=e,this};On.prototype.getMaxDepth=function(e){return gV(e,this.store.getData())};On.prototype.calculateKinships=function(e,t){return AA(e,this.store.getData(),t)};On.prototype.getKinshipsDataStash=function(e,t){return EA(e,t,this.store.getData(),this.calculateKinships(e))};On.prototype.setDuplicateBranchToggle=function(e){return this.store.state.duplicate_branch_toggle=e,this};On.prototype.editTree=function(){return this.editTreeInstance=kG(this.cont,this.store)};On.prototype.updateMain=function(e){return this.store.updateMainId(e.data.id),this.store.updateTree({}),this};On.prototype.updateMainId=function(e){return this.store.updateMainId(e),this};On.prototype.getMainDatum=function(){return this.store.getMainDatum()};On.prototype.updateData=function(e){this.store.updateData(e)};On.prototype.setBeforeUpdate=function(e){return this.beforeUpdate=e,this};On.prototype.setAfterUpdate=function(e){return this.afterUpdate=e,this};On.prototype.setPersonDropdown=function(e,t=this.cont.querySelector(".f3-nav-cont")){this.personSearch=CG(t,n.bind(this)),this.personSearch.setOptionsGetterPerson(this.store.getData,e);function n(r){this.editTreeInstance&&this.editTreeInstance.open(this.store.getDatum(r)),this.updateMainId(r),this.updateTree({initial:!1})}return this};On.prototype.unSetPersonSearch=function(){return this.personSearch.destroy(),this.personSearch=null,this};function IG(e){return typeof e=="string"&&(e=document.querySelector(e)),e}function TG(e){Je.select(e).append("div").attr("class","f3-nav-cont")}function IA(e){const t=[];return Array.isArray(e)?e.forEach(n=>{typeof n=="function"?t.push(n):typeof n=="string"?t.push(r=>r.data[n]):Array.isArray(n)&&t.push(r=>n.map(s=>r.data[s]).join(" "))}):typeof e=="function"?t.push(e):typeof e=="string"&&t.push(n=>n.data[e]),t}TA.is_html=!1;function TA(...e){return new bo(...e)}function bo(e,t){return this.cont=e,this.store=t,this.svg=null,this.getCard=null,this.card_dim={w:220,h:70,text_x:75,text_y:15,img_w:60,img_h:60,img_x:5,img_y:5},this.card_display=[n=>`${n.data["first name"]} ${n.data["last name"]}`],this.mini_tree=!0,this.link_break=!1,this.onCardClick=this.onCardClickDefault.bind(this),this.onCardUpdate=null,this.init(),this}bo.prototype.init=function(){this.svg=this.cont.querySelector("svg.main_svg"),this.getCard=()=>Wr.elements.CardSvg({store:this.store,svg:this.svg,card_dim:this.card_dim,card_display:this.card_display,mini_tree:this.mini_tree,link_break:this.link_break,onCardClick:this.onCardClick,onCardUpdate:this.onCardUpdate})};bo.prototype.setCardDisplay=function(e){return this.card_display=IA(e),this};bo.prototype.setCardDim=function(e){if(typeof e!="object")return console.error("card_dim must be an object"),this;for(let t in e){const n=e[t];if(typeof n!="number"&&typeof n!="boolean")return console.error(`card_dim.${t} must be a number or boolean`),this;t==="width"&&(t="w"),t==="height"&&(t="h"),t==="img_width"&&(t="img_w"),t==="img_height"&&(t="img_h"),t==="img_x"&&(t="img_x"),t==="img_y"&&(t="img_y"),this.card_dim[t]=n}return mG(this.svg,this.card_dim),this};bo.prototype.setOnCardUpdate=function(e){return this.onCardUpdate=e,this};bo.prototype.setMiniTree=function(e){return this.mini_tree=e,this};bo.prototype.setLinkBreak=function(e){return this.link_break=e,this};bo.prototype.onCardClickDefault=function(e,t){this.store.updateMainId(t.data.id),this.store.updateTree({})};bo.prototype.setOnCardClick=function(e){return this.onCardClick=e,this};LA.is_html=!0;function LA(...e){return new ds(...e)}ds.prototype.is_html=!0;function ds(e,t){return this.cont=e,this.store=t,this.getCard=null,this.card_display=[n=>`${n.data["first name"]} ${n.data["last name"]}`],this.cardImageField="avatar",this.onCardClick=this.onCardClickDefault,this.style="default",this.mini_tree=!1,this.onCardUpdate=null,this.card_dim={},this.cardInnerHtmlCreator=null,this.init(),this}ds.prototype.init=function(){this.svg=this.cont.querySelector("svg.main_svg"),this.getCard=()=>Wr.elements.CardHtml({store:this.store,card_display:this.card_display,cardImageField:this.cardImageField,defaultPersonIcon:this.defaultPersonIcon,onCardClick:this.onCardClick,style:this.style,mini_tree:this.mini_tree,onCardUpdate:this.onCardUpdate,card_dim:this.card_dim,empty_card_label:this.store.state.single_parent_empty_card_label,cardInnerHtmlCreator:this.cardInnerHtmlCreator,duplicate_branch_toggle:this.store.state.duplicate_branch_toggle,onCardMouseenter:this.onCardMouseenter?this.onCardMouseenter.bind(this):null,onCardMouseleave:this.onCardMouseleave?this.onCardMouseleave.bind(this):null})};ds.prototype.setCardDisplay=function(e){return this.card_display=IA(e),this};ds.prototype.setCardImageField=function(e){return this.cardImageField=e,this};ds.prototype.setDefaultPersonIcon=function(e){return this.defaultPersonIcon=e,this};ds.prototype.setOnCardClick=function(e){return this.onCardClick=e,this};ds.prototype.onCardClickDefault=function(e,t){this.store.updateMainId(t.data.id),this.store.updateTree({})};ds.prototype.setStyle=function(e){return this.style=e,this};ds.prototype.setMiniTree=function(e){return this.mini_tree=e,this};ds.prototype.setOnCardUpdate=function(e){return this.onCardUpdate=e,this};ds.prototype.setCardDim=function(e){if(typeof e!="object")return console.error("card_dim must be an object"),this;for(let t in e){const n=e[t];if(typeof n!="number"&&typeof n!="boolean")return console.error(`card_dim.${t} must be a number or boolean`),this;t==="width"&&(t="w"),t==="height"&&(t="h"),t==="img_width"&&(t="img_w"),t==="img_height"&&(t="img_h"),t==="img_x"&&(t="img_x"),t==="img_y"&&(t="img_y"),this.card_dim[t]=n}return this};ds.prototype.resetCardDim=function(){return this.card_dim={},this};ds.prototype.setCardInnerHtmlCreator=function(e){return this.cardInnerHtmlCreator=e,this};ds.prototype.setOnHoverPathToMain=function(){return this.onCardMouseenter=this.onEnterPathToMain.bind(this),this.onCardMouseleave=this.onLeavePathToMain.bind(this),this};ds.prototype.unsetOnHoverPathToMain=function(){return this.onCardMouseenter=null,this.onCardMouseleave=null,this};ds.prototype.onEnterPathToMain=function(e,t){this.to_transition=t.data.id;const n=this.store.getTreeMainDatum(),r=Je.select(this.cont).select("div.cards_view").selectAll(".card_cont"),s=Je.select(this.cont).select("svg.main_svg .links_view").selectAll(".link"),[i,l]=PV(r,s,t,n);return i.forEach(o=>{const c=Math.abs(t.depth-o.card.depth)*200;Je.select(o.node.querySelector("div.card-inner")).transition().duration(0).delay(c).on("end",()=>this.to_transition===t.data.id&&Je.select(o.node.querySelector("div.card-inner")).classed("f3-path-to-main",!0))}),l.forEach(o=>{const c=Math.abs(t.depth-o.link.depth)*200;Je.select(o.node).transition().duration(0).delay(c).on("end",()=>this.to_transition===t.data.id&&Je.select(o.node).classed("f3-path-to-main",!0))}),this};ds.prototype.onLeavePathToMain=function(e,t){return this.to_transition=!1,Je.select(this.cont).select("div.cards_view").selectAll("div.card-inner").classed("f3-path-to-main",!1),Je.select(this.cont).select("svg.main_svg .links_view").selectAll(".link").classed("f3-path-to-main",!1),this};var Wr={CalculateTree:U8,createStore:EV,view:zV,createSvg:UV,handlers:QV,elements:vG,htmlHandlers:DV,icons:YV,createChart:PG,CardSvg:TA,CardHtml:LA};const LG={w:220,h:70,text_x:75,text_y:15,img_w:60,img_h:60,img_x:5,img_y:5},MG=({isRTL:e=!1})=>{const t=we.useRef(null);return we.useEffect(()=>{if(!t.current)return;const n=Wr.createChart(t.current,r()).setTransitionTime(500).setCardXSpacing(250).setCardYSpacing(150);return n.setCard(Wr.CardSvg).setCardDim(LG).setCardDisplay([s=>`${s.data["first name"]||""}`,s=>`${s.data["last name"]||""}`,s=>`${s.data.birthday||""}`]).setMiniTree(!0),n.updateTree({initial:!0}),()=>{};function r(){return[{id:"0",rels:{spouses:["ninapopova"],father:"0c09cfa0-5e7c-4073-8beb-94f6c69ada19",mother:"0fa5c6bc-5b58-40f5-a07e-d787e26d8b56",children:["popovKonstantinViktorovich","f626d086-e2d6-4722-b4f3-ca4f15b109ab"]},data:{"first name":" ","last name":"",birthday:"1939",avatar:"https://static8.depositphotos.com/1009634/988/v/950/depositphotos_9883921-stock-illustration-no-user-profile-picture.jpg",gender:"M"}},{id:"ninapopova",data:{gender:"F","first name":"","last name":"()",birthday:"",avatar:""},rels:{spouses:["0"],children:["popovKonstantinViktorovich","f626d086-e2d6-4722-b4f3-ca4f15b109ab"]}},{id:"0c09cfa0-5e7c-4073-8beb-94f6c69ada19",data:{gender:"M","first name":" ","last name":"",birthday:"",avatar:""},rels:{children:["0"],spouses:["0fa5c6bc-5b58-40f5-a07e-d787e26d8b56"]}},{id:"0fa5c6bc-5b58-40f5-a07e-d787e26d8b56",data:{gender:"F","first name":"?","last name":"",birthday:"",avatar:""},rels:{spouses:["0c09cfa0-5e7c-4073-8beb-94f6c69ada19"],children:["0"],father:"12a9bddf-855a-4583-a695-c73fa8c0e9b2",mother:"bd56a527-b613-474d-9f38-fcac0aae218b"}},{id:"popovKonstantinViktorovich",data:{gender:"M","first name":" ","last name":"",birthday:"",avatar:""},rels:{mother:"ninapopova",father:"0",spouses:["popovaVera"],children:["vityapopov98","nadiapopova","lilinpo"]}},{id:"f626d086-e2d6-4722-b4f3-ca4f15b109ab",data:{gender:"M","first name":"","last name":"",birthday:"",avatar:""},rels:{mother:"ninapopova",father:"0"}},{id:"vityapopov98",data:{gender:"M","first name":"","last name":"",birthday:"",avatar:""},rels:{mother:"popovaVera",father:"popovKonstantinViktorovich"}},{id:"popovaVera",data:{gender:"F","first name":"","last name":"",birthday:"",avatar:""},rels:{spouses:["popovKonstantinViktorovich"],children:["vityapopov98","nadiapopova"]}},{id:"nadiapopova",data:{gender:"F","first name":"","last name":"",birthday:"",avatar:""},rels:{mother:"popovaVera",father:"popovKonstantinViktorovich"}},{id:"lilinpo",data:{gender:"F","first name":"","last name":"",birthday:"",avatar:""},rels:{mother:"popovaVera",father:"popovKonstantinViktorovich"}},{id:"12a9bddf-855a-4583-a695-c73fa8c0e9b2",data:{gender:"M","first name":"Yvo","last name":"",birthday:"",avatar:""},rels:{children:["0fa5c6bc-5b58-40f5-a07e-d787e26d8b56"],spouses:["bd56a527-b613-474d-9f38-fcac0aae218b"]}},{id:"bd56a527-b613-474d-9f38-fcac0aae218b",data:{gender:"F","first name":"Yva","last name":"",birthday:"",avatar:""},rels:{spouses:["12a9bddf-855a-4583-a695-c73fa8c0e9b2"],children:["0fa5c6bc-5b58-40f5-a07e-d787e26d8b56"]}}]}},[]),a.jsx("div",{className:"f3",ref:t,style:{direction:e?"rtl":"ltr"}})},RG=e=>{var t,n,r;if(!navigator.onLine)return"   .       .";if(e.response){const s=e.response.status,i=(t=e.response.data)==null?void 0:t.message;switch(s){case 400:return i||"   .       .";case 401:return"   .     .";case 403:return"      .";case 404:return"    .";case 429:return"     .   .";case 500:return"  .        .";default:return i||`    (${s}).    .`}}return e.code==="NETWORK_ERROR"||(n=e.message)!=null&&n.includes("Network Error")?"   .       .":e.code==="ECONNABORTED"||(r=e.message)!=null&&r.includes("timeout")?"   .    .":e.message||"   .    ."},$G="https://qabael.premiumasp.net/api/Payments",Dl=gr.create({baseURL:$G,headers:{"Content-Type":"application/json"}});Dl.interceptors.request.use(e=>{const t=localStorage.getItem("authToken");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e));Dl.interceptors.response.use(e=>e,e=>(console.error("Payment API Error:",e),e.userMessage=RG(e),Promise.reject(e)));class Hu{static async createOneTimePayment(t){try{return(await Dl.post("/OneTimePaid",t)).data}catch(n){throw console.error("One-time payment error:",n),n}}static async createSubscription(t){var n,r,s;try{console.log("Sending subscription request:",t);const i=await Dl.post("/CreateSubscription",t);return console.log("Subscription response:",i.data),i.data}catch(i){throw console.error("Subscription creation error:",i),console.error("Error details:",{status:(n=i.response)==null?void 0:n.status,statusText:(r=i.response)==null?void 0:r.statusText,data:(s=i.response)==null?void 0:s.data,message:i.message}),i}}static async getAllPlans(){try{return(await Dl.get("/GetAllPlans")).data}catch(t){throw console.error("Get plans error:",t),t}}static async unsubscribe(t){try{return(await Dl.post(`/UnSubscripe?email=${t}`)).data}catch(n){throw console.error("Unsubscribe error:",n),n}}static async getUserSubscriptionStatus(t){var n;if(!t)throw new Error("      ");try{return(await Dl.get(`/UserSubscriptionStatus?email=${encodeURIComponent(t)}`)).data}catch(r){throw console.error("Get subscription status error:",r),((n=r.response)==null?void 0:n.status)===404?new Error("     "):new Error(r.userMessage||"     ")}}}const FG=()=>{const{language:e}=Xt(),{publicTrees:t,fetchPublicTrees:n}=xs(),[r,s]=Y.useState(1),[i,l]=Y.useState(!0),o=Y.useRef(null);Y.useRef(null);const c=10,[u,d]=Y.useState([]),[f,m]=Y.useState(!0),[h,x]=Y.useState(null);Y.useEffect(()=>{(async()=>{try{m(!0);const S=await Hu.getAllPlans();d(S)}catch{x("Failed to load plans")}finally{m(!1)}})()},[e]);const y=M=>new Intl.NumberFormat(p?"ar-EG":"en-US",{style:"currency",currency:"USD"}).format(M),p=e==="ar",g=M=>{if(!M)return[];const S=Array.from(M.matchAll(/<li[^>]*>(.*?)<\/li>/gi)).map(B=>B[1].replace(/<[^>]+>/g,"").trim()).filter(Boolean);if(S.length)return S;let C=M;C=C.replace(/\\n/g,`
`).replace(/\\\s*-\s*/g,`
- `).replace(/([.!?])\s*-\s+/g,`$1
- `).replace(/\s*/g,`
 `).replace(/\s+-\s+/g,`
- `);const _=Array.from(C.matchAll(/(?:^|\n)\s*[-*]\s+(.+?)(?=\n|$)/g)).map(B=>B[1].trim()).filter(Boolean);if(_.length)return _;const T=C.split(/[-*]\s+/).map(B=>B.trim()).filter(Boolean);return T.length>1?T.slice(1):T};Y.useEffect(()=>{(async()=>{try{l(!0),await n()}catch{}finally{l(!1)}})()},[n]);const w=r*c,v=w-c,N=t.slice(v,w),A=Math.ceil(t.length/c),P=M=>{s(M),window.scrollTo({top:0,behavior:"smooth"})},U=[{icon:In,title:"Build Your Family Tree",titleAr:"  ",description:"Create detailed family trees with photos, documents, and life stories.",descriptionAr:"        ."},{icon:Qi,title:"Smart Search & Suggestions",titleAr:"  ",description:"Find relatives and get intelligent suggestions to complete your tree.",descriptionAr:"        ."},{icon:fh,title:"Collaborate with Family",titleAr:"  ",description:"Share your trees and work together with family members.",descriptionAr:"     ."},{icon:v0,title:"Privacy & Security",titleAr:" ",description:"Your family data is secure with advanced privacy controls.",descriptionAr:"      ."},{icon:mo,title:"Bilingual Support",titleAr:"  ",description:"Full support for Arabic and English languages.",descriptionAr:"    ."},{icon:tT,title:"Modern Interface",titleAr:" ",description:"Beautiful, intuitive interface that works on all devices.",descriptionAr:"      ."}];return a.jsxs("div",{className:"min-h-screen",children:[a.jsxs("section",{className:"relative min-h-[80vh] sm:min-h-screen flex items-center justify-center bg-gradient-to-br from-primary/10 via-primary/5 to-background overflow-hidden",children:[a.jsxs("div",{className:"absolute inset-0 z-0",children:[a.jsx("div",{className:"w-full h-full bg-cover bg-center animate-zoomEffect",style:{backgroundImage:`url(${cT})`}}),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-r from-background/80 to-background/40"})]}),a.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 relative z-10",children:a.jsxs("div",{className:"text-center max-w-4xl mx-auto",children:[a.jsxs("h1",{className:"text-4xl md:text-5xl lg:text-6xl font-bold text-foreground mb-6",children:[p?"  ":"Discover Your",a.jsx("span",{className:"text-primary",children:p?"":" Heritage"})]}),a.jsx("p",{className:"text-lg sm:text-xl text-muted-foreground mb-8 max-w-2xl mx-auto",children:p?"         .       .":"Build, explore, and share your family tree with our comprehensive genealogy platform. Connect with your roots and preserve your family's story for future generations."}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[a.jsx(ge,{asChild:!0,size:"lg",className:"text-base sm:text-lg px-6 sm:px-8",children:a.jsxs(It,{to:"/register",className:"flex items-center",children:[p?" ":"Get Started Free",a.jsx(Zi,{className:`ml-2 h-5 w-5 ${p?"rotate-180":""}`})]})}),a.jsx(ge,{asChild:!0,variant:"outline",size:"lg",className:"text-base sm:text-lg px-6 sm:px-8",children:a.jsx(It,{to:"/pricing",children:p?" ":"View Plans"})})]})]})})]}),a.jsx("section",{className:"py-20 bg-background",children:a.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs("div",{className:"text-center mb-12",children:[a.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-foreground mb-4",children:p?"  ":"Interactive Family Tree"}),a.jsx("p",{className:"text-xl text-muted-foreground max-w-2xl mx-auto",children:p?"             .":"Explore our interactive family tree that allows you to easily add and modify family members."})]}),a.jsx("div",{className:"bg-muted p-6 rounded-lg shadow-lg",children:a.jsx(MG,{isRTL:p})}),a.jsx("div",{className:"text-center mt-12",children:a.jsx(ge,{asChild:!0,size:"lg",children:a.jsxs(It,{to:"/tree",className:"flex items-center justify-center",children:[p?"   ":"Start Building Your Tree",a.jsx(Zi,{className:`ml-2 h-4 w-4 ${p?"rotate-180":""}`})]})})})]})}),a.jsx("section",{className:"py-16 bg-muted/30",children:a.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs("div",{className:"text-center mb-12",children:[a.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-foreground mb-4",children:p?"  ":"Family Tree Archive"}),a.jsx("p",{className:"text-xl text-muted-foreground max-w-2xl mx-auto",children:p?"        .        .":"Explore public family trees created by thousands of users. Discover new families and join our genealogy community."})]}),i?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})}):a.jsx(a.Fragment,{children:N.length>0?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"relative overflow-hidden py-4",children:a.jsxs("div",{ref:o,className:"infinite-carousel",children:[N.map(M=>{var S;return a.jsx("div",{className:"flex-shrink-0 w-72 sm:w-80 mx-2",children:a.jsxs(Qe,{className:"hover:shadow-lg transition-shadow h-full flex flex-col",children:[a.jsxs(xt,{className:"pb-3 flex-grow",children:[a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsx(yt,{className:"text-base sm:text-lg line-clamp-2",children:M.name}),a.jsx(Qn,{className:"h-4 w-4 sm:h-5 w-5 text-primary flex-shrink-0 ml-2 mt-1"})]}),a.jsx(bs,{className:"text-xs sm:text-sm mt-2 line-clamp-2",children:p?M.description||"  ":M.description||"No description"})]}),a.jsxs(tt,{className:"mt-auto",children:[a.jsx("div",{className:"space-y-2 text-xs sm:text-sm",children:a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-muted-foreground",children:p?"":"Members"}),a.jsx("span",{className:"font-medium",children:((S=M.stats)==null?void 0:S.totalPeople)||0})]})}),a.jsx(ge,{asChild:!0,variant:"outline",size:"sm",className:"w-full mt-4 text-xs sm:text-sm",children:a.jsx(It,{to:`/shared/${M.id}`,children:p?" ":"View Tree"})})]})]})},`tree-${M.id}`)}),N.map(M=>{var S;return a.jsx("div",{className:"flex-shrink-0 w-72 sm:w-80 mx-2",children:a.jsxs(Qe,{className:"hover:shadow-lg transition-shadow h-full flex flex-col",children:[a.jsxs(xt,{className:"pb-3 flex-grow",children:[a.jsxs("div",{className:"flex items-start justify-between",children:[a.jsx(yt,{className:"text-base sm:text-lg line-clamp-2",children:M.name}),a.jsx(Qn,{className:"h-4 w-4 sm:h-5 w-5 text-primary flex-shrink-0 ml-2 mt-1"})]}),a.jsx(bs,{className:"text-xs sm:text-sm mt-2 line-clamp-2",children:p?M.description||"  ":M.description||"No description"})]}),a.jsxs(tt,{className:"mt-auto",children:[a.jsx("div",{className:"space-y-2 text-xs sm:text-sm",children:a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-muted-foreground",children:p?"":"Members"}),a.jsx("span",{className:"font-medium",children:((S=M.stats)==null?void 0:S.totalPeople)||0})]})}),a.jsx(ge,{asChild:!0,variant:"outline",size:"sm",className:"w-full mt-4 text-xs sm:text-sm",children:a.jsx(It,{to:`/shared/${M.id}`,children:p?" ":"View Tree"})})]})]})},`tree-duplicate-${M.id}`)})]})}),A>1&&a.jsx("div",{className:"flex justify-center mt-12",children:a.jsxs("nav",{className:"flex items-center gap-2",children:[a.jsx(ge,{variant:"outline",size:"sm",onClick:()=>P(Math.max(1,r-1)),disabled:r===1,className:p?"rotate-180":"",children:a.jsx(Zi,{className:"h-4 w-4"})}),Array.from({length:Math.min(5,A)},(M,S)=>{let C;return A<=5||r<=3?C=S+1:r>=A-2?C=A-4+S:C=r-2+S,a.jsx(ge,{variant:r===C?"default":"outline",size:"sm",onClick:()=>P(C),children:C},C)}),a.jsx(ge,{variant:"outline",size:"sm",onClick:()=>P(Math.min(A,r+1)),disabled:r===A,className:p?"rotate-180":"",children:a.jsx(Zi,{className:"h-4 w-4"})})]})})]}):a.jsxs("div",{className:"text-center py-12",children:[a.jsx(Qn,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),a.jsx("h3",{className:"text-xl font-medium text-foreground mb-2",children:p?"    ":"No Public Family Trees"}),a.jsx("p",{className:"text-muted-foreground mb-6",children:p?"      !":"Be the first to publish a public family tree!"}),a.jsx(ge,{asChild:!0,children:a.jsx(It,{to:"/register",children:p?" ":"Get Started"})})]})})]})}),a.jsx("section",{className:"py-20 bg-background",children:a.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs("div",{className:"text-center mb-16",children:[a.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-foreground mb-4",children:p?"     ":"Everything You Need to Build Your Family Tree"}),a.jsx("p",{className:"text-xl text-muted-foreground max-w-2xl mx-auto",children:p?"         .":"Powerful features designed to help you discover, document, and share your family history."})]}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 sm:gap-8",children:U.map((M,S)=>a.jsxs(Qe,{className:"text-center hover:shadow-lg transition-shadow h-full flex flex-col",children:[a.jsxs(xt,{children:[a.jsx("div",{className:"mx-auto w-10 h-10 sm:w-12 sm:h-12 bg-primary/10 rounded-lg flex items-center justify-center mb-3 sm:mb-4",children:a.jsx(M.icon,{className:"h-5 w-5 sm:h-6 sm:w-6 text-primary"})}),a.jsx(yt,{className:"text-lg sm:text-xl",children:p?M.titleAr:M.title})]}),a.jsx(tt,{className:"flex-grow",children:a.jsx(bs,{className:"text-sm sm:text-base",children:p?M.descriptionAr:M.description})})]},S))}),a.jsx("div",{className:"text-center mt-12",children:a.jsx(ge,{asChild:!0,variant:"outline",size:"lg",children:a.jsxs(It,{to:"/features",className:"flex items-center justify-center",children:[p?"  ":"View All Features",a.jsx(Zi,{className:`ml-2 h-4 w-4 ${p?"rotate-180":""}`})]})})})]})}),a.jsx("section",{className:"py-20 bg-muted/30",children:a.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs("div",{className:"text-center mb-16",children:[a.jsx("h2",{className:"text-3xl sm:text-4xl font-bold text-foreground mb-4",children:p?" ":"Choose Your Plan"}),a.jsx("p",{className:"text-xl text-muted-foreground max-w-2xl mx-auto",children:p?"     .     .":"Choose the plan that fits your family needs. All plans include our core features."})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 sm:gap-8 max-w-5xl mx-auto",children:u.map((M,S)=>a.jsxs(Qe,{className:"relative h-full flex flex-col",children:[a.jsxs(xt,{className:"text-center pt-8",children:[a.jsx(yt,{className:"text-xl sm:text-2xl",children:M.name}),a.jsxs("div",{className:"mt-3 sm:mt-4",children:[a.jsx("span",{className:"text-3xl sm:text-4xl font-bold text-foreground",children:y(M.price)}),a.jsx("span",{className:"text-muted-foreground text-sm sm:text-base",children:p?M.billingCycle==="year"?"/":"/":M.billingCycle==="year"?"/year":"/month"})]})]}),a.jsxs(tt,{className:"flex-grow flex flex-col",children:[(()=>{const C=g(M.description);return C.length>0?a.jsx("ul",{className:"space-y-2 sm:space-3 mb-4",children:C.map((_,T)=>a.jsxs("li",{className:"flex items-start",children:[a.jsx(Bs,{className:`h-4 w-4 sm:h-5 w-5 text-primary flex-shrink-0 ${p?"ml-2 sm:ml-3":"mr-2 sm:mr-3"} mt-0.5`}),a.jsx("span",{className:"text-xs sm:text-sm",children:_})]},T))}):null})(),a.jsx("ul",{className:"space-y-2 sm:space-3 mb-6 flex-grow",children:(Array.isArray(M.features)?M.features:[]).map((C,_)=>a.jsxs("li",{className:"flex items-start",children:[a.jsx(Bs,{className:`h-4 w-4 sm:h-5 w-5 text-primary flex-shrink-0 ${p?"ml-2 sm:ml-3":"mr-2 sm:mr-3"} mt-0.5`}),a.jsx("span",{className:"text-xs sm:text-sm",children:C})]},_))}),a.jsx(ge,{asChild:!0,className:"w-full text-sm sm:text-base",variant:"outline",children:a.jsx(It,{to:"/register",children:p?" ":"Choose Plan"})})]})]},S))})]})}),a.jsx("section",{className:"py-20 bg-muted/50",children:a.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 md:gap-12 items-center",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl sm:text-3xl md:text-4xl font-bold text-foreground mb-4 sm:mb-6",children:p?"  Nasabna":"Why Choose Nasabna?"}),a.jsx("p",{className:"text-base sm:text-lg text-muted-foreground mb-4 sm:mb-6",children:p?"         .             .":"We're passionate about helping families preserve their heritage and connect across generations. Our platform combines cutting-edge technology with intuitive design to make genealogy accessible to everyone."}),a.jsxs("ul",{className:"space-y-3 mb-6",children:[a.jsxs("li",{className:"flex items-start",children:[a.jsx(Si,{className:`h-5 w-5 text-primary flex-shrink-0 ${p?"ml-3":"mr-3"} mt-0.5`}),a.jsx("span",{className:"text-sm sm:text-base",children:p?"      ":"Trusted by thousands of families worldwide"})]}),a.jsxs("li",{className:"flex items-start",children:[a.jsx(Si,{className:`h-5 w-5 text-primary flex-shrink-0 ${p?"ml-3":"mr-3"} mt-0.5`}),a.jsx("span",{className:"text-sm sm:text-base",children:p?"     ":"Bank-level security for your family data"})]}),a.jsxs("li",{className:"flex items-start",children:[a.jsx(Si,{className:`h-5 w-5 text-primary flex-shrink-0 ${p?"ml-3":"mr-3"} mt-0.5`}),a.jsx("span",{className:"text-sm sm:text-base",children:p?"   ":"Continuous updates and new features"})]}),a.jsxs("li",{className:"flex items-start",children:[a.jsx(Si,{className:`h-5 w-5 text-primary flex-shrink-0 ${p?"ml-3":"mr-3"} mt-0.5`}),a.jsx("span",{className:"text-sm sm:text-base",children:p?"   ":"Dedicated customer support team"})]})]}),a.jsx(ge,{asChild:!0,variant:"outline",size:"lg",className:"px-6",children:a.jsxs(It,{to:"/about",className:"flex items-center justify-center",children:[p?"  ":"Learn More About Us",a.jsx(Zi,{className:`ml-2 h-4 w-4 ${p?"rotate-180":""}`})]})})]}),a.jsx("div",{className:"relative flex items-center justify-center",children:a.jsx("img",{src:pj,alt:p?" ":"Happy family",className:"rounded-2xl shadow-lg w-full max-w-[280px] sm:max-w-xs md:max-w-sm lg:max-w-md h-auto object-cover"})})]})})}),a.jsx("section",{className:"py-20 bg-muted/50",children:a.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 text-center",children:[a.jsx("h2",{className:"text-3xl sm:text-4xl font-bold mb-4 text-foreground",children:p?"     ":"Start Building Your Family Tree Today"}),a.jsx("p",{className:"text-xl mb-8 max-w-2xl mx-auto text-muted-foreground",children:p?"         Nasabna.     .":"Join thousands of families who are preserving their heritage with Nasabna. Choose the plan that fits your needs."}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[a.jsx(ge,{asChild:!0,size:"lg",className:"text-base sm:text-lg px-6 sm:px-8",children:a.jsxs(It,{to:"/register",className:"flex items-center",children:[p?"  ":"Create Your Free Account",a.jsx(Zi,{className:`ml-2 h-5 w-5 ${p?"rotate-180":""}`})]})}),a.jsx(ge,{asChild:!0,size:"lg",variant:"outline",className:"text-base sm:text-lg px-6 sm:px-8",children:a.jsx(It,{to:"/features",children:p?" ":"Explore Features"})})]})]})})]})};var OG=function(e,t){for(var n={};e.length;){var r=e[0],s=r.code,i=r.message,l=r.path.join(".");if(!n[l])if("unionErrors"in r){var o=r.unionErrors[0].errors[0];n[l]={message:o.message,type:o.code}}else n[l]={message:i,type:s};if("unionErrors"in r&&r.unionErrors.forEach(function(d){return d.errors.forEach(function(f){return e.push(f)})}),t){var c=n[l].types,u=c&&c[r.code];n[l]=HE(l,t,n,s,u?[].concat(u,r.message):r.message)}e.shift()}return n},og=function(e,t,n){return n===void 0&&(n={}),function(r,s,i){try{return Promise.resolve(function(l,o){try{var c=Promise.resolve(e[n.mode==="sync"?"parse":"parseAsync"](r,t)).then(function(u){return i.shouldUseNativeValidation&&UE({},i),{errors:{},values:n.raw?r:u}})}catch(u){return o(u)}return c&&c.then?c.then(void 0,o):c}(0,function(l){if(function(o){return Array.isArray(o==null?void 0:o.errors)}(l))return{values:{},errors:qE(OG(l.errors,!i.shouldUseNativeValidation&&i.criteriaMode==="all"),i)};throw l}))}catch(l){return Promise.reject(l)}}};const DG=(e,t)=>{if(!(e!=null&&e.message))return{en:"Registration failed. Please try again.",ar:"  .    ."};const n=e.message.toLowerCase();return n.includes("email")&&(n.includes("exists")||n.includes("taken")||n.includes("duplicate"))?{en:"This email address is already registered. Please use a different email or try logging in.",ar:"    .         ."}:n.includes("username")&&(n.includes("exists")||n.includes("taken")||n.includes("duplicate"))?{en:"This username is already taken. Please choose a different username.",ar:"   .     ."}:n.includes("invalid email")||n.includes("email format")?{en:"Please enter a valid email address (example@domain.com).",ar:"      (@.com)."}:n.includes("password")&&(n.includes("requirements")||n.includes("weak")||n.includes("short"))?{en:"Password must be at least 8 characters long and contain uppercase letters, lowercase letters, and numbers.",ar:"       8         ."}:n.includes("network")||n.includes("connection")||n.includes("timeout")?{en:"Network connection error. Please check your internet connection and try again.",ar:"   .        ."}:n.includes("server")||n.includes("500")||n.includes("internal")?{en:"Server is temporarily unavailable. Please try again in a few minutes.",ar:"   .       ."}:n.includes("validation")||n.includes("invalid data")||n.includes("bad request")?{en:"Please check all fields and make sure they are filled correctly.",ar:"         ."}:n.includes("terms")||n.includes("conditions")?{en:"You must accept the terms and conditions to create an account.",ar:"       ."}:{en:e.message||"Registration failed. Please try again.",ar:e.message||"  .    ."}},BG=(e,t)=>{if(!(e!=null&&e.message))return{en:"Login failed. Please try again.",ar:"  .    ."};const n=e.message.toLowerCase();return n.includes("invalid")&&(n.includes("email")||n.includes("password")||n.includes("credentials"))?{en:"Invalid email or password. Please check your credentials and try again.",ar:"      .       ."}:n.includes("disabled")||n.includes("suspended")||n.includes("blocked")?{en:"Your account has been disabled. Please contact support for assistance.",ar:"  .      ."}:n.includes("too many")||n.includes("attempts")||n.includes("rate limit")?{en:"Too many failed login attempts. Please wait a few minutes before trying again.",ar:"    .        ."}:n.includes("network")||n.includes("connection")||n.includes("timeout")?{en:"Network connection error. Please check your internet connection and try again.",ar:"   .        ."}:n.includes("server")||n.includes("500")||n.includes("internal")?{en:"Server is temporarily unavailable. Please try again in a few minutes.",ar:"   .       ."}:{en:e.message||"Login failed. Please try again.",ar:e.message||"  .    ."}},Kt=we.forwardRef(({className:e,type:t="text",leftIcon:n,rightIcon:r,showPasswordToggle:s,error:i,...l},o)=>{const[c,u]=we.useState(!1),[d,f]=we.useState(t);we.useEffect(()=>{f(s&&t==="password"?c?"text":"password":t)},[c,t,s]);const m=()=>{u(!c)};return a.jsxs("div",{className:"relative",children:[n&&a.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground",children:n}),a.jsx("input",{type:d,className:Ai("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",n&&"pl-10",(r||s)&&"pr-10",i&&"border-red-500 focus-visible:ring-red-500",e),ref:o,...l}),s&&t==="password"&&a.jsx("button",{type:"button",onClick:m,className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground hover:text-foreground",children:c?a.jsx(oj,{className:"h-4 w-4"}):a.jsx(ra,{className:"h-4 w-4"})}),r&&!s&&a.jsx("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-muted-foreground",children:r}),i&&a.jsx("p",{className:"mt-1 text-sm text-red-600",children:i})]})});Kt.displayName="Input";const dn={success:(e,t)=>{const{showSuccess:n}=Xt.getState();return n(e,""),{dismiss:()=>{}}},error:(e,t)=>{const{showError:n,showErrorWithAction:r}=Xt.getState();return t!=null&&t.action?r(e,"",t.action):n(e,""),{dismiss:()=>{}}},warning:(e,t)=>{const{showWarning:n}=Xt.getState();return n(e,""),{dismiss:()=>{}}},info:(e,t)=>{const{showInfo:n}=Xt.getState();return n(e,""),{dismiss:()=>{}}},custom:(e,t)=>{const{showInfo:n}=Xt.getState();return n(typeof e=="string"?e:"Custom notification",""),{dismiss:()=>{}}},dismiss:()=>{},promise:async(e,t,n)=>{const r=dn.loading(t.loading);try{const s=await e;return r.dismiss(),dn.success(t.success),s}catch(s){throw dn.error(t.error),s}},loading:(e,t)=>{const{showInfo:n}=Xt.getState();return n(e,""),{dismiss:()=>{}}}};function Tr(){const[e,t]=Y.useState(!1);return Y.useEffect(()=>{const n=()=>{t(window.innerWidth<768)};return n(),window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n)}},[]),{isMobile:e}}const zG=c0({email:io().email("Please enter a valid email address"),password:io().min(6,"Password must be at least 6 characters")}),UG=()=>{var y,p;const e=Ir(),{setAuthData:t,clearAuth:n}=Pr(),{language:r}=Xt(),[s,i]=we.useState(!1),[l,o]=we.useState(!1),[c,u]=we.useState(""),{isMobile:d}=Tr(),{register:f,handleSubmit:m,formState:{errors:h}}=ih({resolver:og(zG)}),x=async g=>{if(!l){o(!0),u("");try{const w=await Xn.login(g);if(!w||!w.token||!w.user)throw new Error(r==="ar"?"    ":"Invalid login response");t(w.user,w.token),dn.success({en:"Welcome back! Login successful",ar:" !    "});const v=localStorage.getItem("attemptedPlan"),N=localStorage.getItem("attemptedBillingCycle");if(v&&N)localStorage.removeItem("attemptedPlan"),localStorage.removeItem("attemptedBillingCycle"),e(`/subscription/checkout?plan=${v}&billing=${N}`);else{const A=localStorage.getItem("attemptedUrl");A?(localStorage.removeItem("attemptedUrl"),e(A)):e("/dashboard")}}catch(w){n();const v=BG(w);dn.error(v),u(r==="ar"?v.ar:v.en)}finally{o(!1)}}};return a.jsxs(Qe,{className:`w-full ${d?"max-w-md mx-4":"max-w-md"}`,children:[a.jsxs(xt,{className:"space-y-1",children:[a.jsx(yt,{className:`text-2xl font-bold text-center ${d?"text-xl":""}`,children:r==="ar"?" ":"Sign In"}),a.jsx(bs,{className:"text-center",children:r==="ar"?"    ":"Enter your credentials to access your account"})]}),a.jsxs(tt,{children:[a.jsxs("form",{onSubmit:m(x),className:"space-y-4",children:[c&&a.jsx("div",{className:"p-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded-md",children:c}),a.jsx("div",{className:"space-y-2",children:a.jsx(Kt,{...f("email"),type:"email",placeholder:r==="ar"?" ":"Email address",leftIcon:a.jsx(Pa,{className:"h-4 w-4"}),error:(y=h.email)==null?void 0:y.message,disabled:l,className:d?"text-sm":""})}),a.jsx("div",{className:"space-y-2",children:a.jsx(Kt,{...f("password"),type:"password",placeholder:r==="ar"?" ":"Password",leftIcon:a.jsx(zi,{className:"h-4 w-4"}),showPasswordToggle:!0,error:(p=h.password)==null?void 0:p.message,disabled:l,className:d?"text-sm":""})}),a.jsx("div",{className:`flex justify-end ${d?"text-sm":""}`,children:a.jsx(It,{to:"/forgot-password",className:"text-sm text-primary hover:text-primary/80 underline",children:r==="ar"?"  ":"Forgot password?"})}),a.jsx(ge,{type:"submit",className:`w-full ${d?"h-10 text-sm":""}`,loading:l,disabled:l,loadingText:r==="ar"?"  ...":"Signing in...",children:r==="ar"?" ":"Sign In"})]}),a.jsxs("div",{className:"relative my-6",children:[a.jsx("div",{className:"absolute inset-0 flex items-center",children:a.jsx("span",{className:"w-full border-t border-border"})}),a.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:a.jsx("span",{className:"bg-background px-2 text-muted-foreground",children:r==="ar"?"":"or"})})]}),a.jsx("div",{className:`text-center ${d?"text-sm":""}`,children:a.jsxs("p",{className:"text-sm text-muted-foreground",children:[r==="ar"?"   ":"Don't have an account? ",a.jsx(It,{to:"/register",className:"text-primary hover:text-primary/80 underline font-medium",children:r==="ar"?"  ":"Sign up"})]})})]})]})},qG=e=>c0({name:io().min(2,e==="ar"?"        ":"Name must be at least 2 characters"),email:io().email(e==="ar"?"     ":"Please enter a valid email address"),password:io().min(8,e==="ar"?"       8   ":"Password must be at least 8 characters").regex(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/,e==="ar"?"             ":"Password must contain at least one uppercase letter, one lowercase letter, and one number"),confirmPassword:io(),acceptTerms:WE({required_error:e==="ar"?"     ":"You must accept the terms and conditions"}).refine(t=>t===!0,{message:e==="ar"?"     ":"You must accept the terms and conditions"})}).refine(t=>t.password===t.confirmPassword,{message:e==="ar"?"   ":"Passwords don't match",path:["confirmPassword"]}),HG=()=>{var A,P,U,M;const e=Ir(),[t]=Y2(),{setAuthData:n,clearAuth:r}=Pr(),{language:s}=Xt(),{isMobile:i}=Tr(),[l,o]=we.useState(!1),[c,u]=we.useState(""),d=t.get("plan"),f=qG(s),{register:m,handleSubmit:h,formState:{errors:x},watch:y}=ih({resolver:og(f),defaultValues:{acceptTerms:!1}}),p=y("password"),g=y("acceptTerms"),w=async S=>{if(!l){o(!0),u("");try{const C=await Xn.register({name:S.name,firstName:S.name,lastName:"",email:S.email,password:S.password,confirmPassword:S.confirmPassword,language:s,acceptTerms:S.acceptTerms});if(!C||!C.token||!C.user)throw new Error(s==="ar"?"   ":"Invalid registration response");n(C.user,C.token),dn.success({en:"Welcome! Your account has been created successfully",ar:"!    "}),e(d?`/subscription?plan=${d}`:"/dashboard")}catch(C){r();const _=DG(C);dn.error(_),u(s==="ar"?_.ar:_.en)}finally{o(!1)}}},N=(S=>{if(!S)return{strength:0,label:""};let C=0;return C=[S.length>=8,/[a-z]/.test(S),/[A-Z]/.test(S),/\d/.test(S),/[!@#$%^&*(),.?":{}|<>]/.test(S)].filter(Boolean).length,{strength:C,label:{en:["Very Weak","Weak","Fair","Good","Strong"],ar:[" ","","","",""]}[s][Math.max(0,C-1)]||""}})(p||"");return a.jsxs(Qe,{className:`w-full ${i?"max-w-md mx-4":"max-w-md"}`,children:[a.jsxs(xt,{className:"space-y-1",children:[a.jsx(yt,{className:`text-2xl font-bold text-center ${i?"text-xl":""}`,children:s==="ar"?"  ":"Create Account"}),a.jsx(bs,{className:"text-center",children:s==="ar"?"    ":"Enter your information to create a new account"})]}),a.jsxs(tt,{children:[a.jsxs("form",{onSubmit:h(w),className:"space-y-4",children:[c&&a.jsx("div",{className:"p-3 text-sm text-red-600 bg-red-50 border border-red-200 rounded-md",children:c}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Kt,{...m("name"),placeholder:s==="ar"?" ":"Full name",leftIcon:a.jsx(sn,{className:"h-4 w-4"}),error:(A=x.name)==null?void 0:A.message,disabled:l,className:i?"text-sm":""}),a.jsxs("div",{className:"flex items-start space-x-2",children:[a.jsx(ii,{className:"h-4 w-4 text-muted-foreground flex-shrink-0 mt-0.5"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:s==="ar"?"    ":"Name should be unique"})]})]}),a.jsx(Kt,{...m("email"),type:"email",placeholder:s==="ar"?" ":"Email address",leftIcon:a.jsx(Pa,{className:"h-4 w-4"}),error:(P=x.email)==null?void 0:P.message,disabled:l,className:i?"text-sm":""}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Kt,{...m("password"),type:"password",placeholder:s==="ar"?" ":"Password",leftIcon:a.jsx(zi,{className:"h-4 w-4"}),showPasswordToggle:!0,error:(U=x.password)==null?void 0:U.message,disabled:l,className:i?"text-sm":""}),p&&a.jsx("div",{className:"space-y-2",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"flex-1 bg-muted rounded-full h-2",children:a.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${N.strength<=2?"bg-destructive":N.strength<=3?"bg-yellow-500":"bg-green-500"}`,style:{width:`${N.strength/5*100}%`}})}),a.jsx("span",{className:`text-xs text-muted-foreground min-w-0 ${i?"text-xs":""}`,children:N.label})]})})]}),a.jsx(Kt,{...m("confirmPassword"),type:"password",placeholder:s==="ar"?"  ":"Confirm password",leftIcon:a.jsx(zi,{className:"h-4 w-4"}),showPasswordToggle:!0,error:(M=x.confirmPassword)==null?void 0:M.message,disabled:l,className:i?"text-sm":""}),a.jsxs("div",{className:`flex items-start space-x-2 ${i?"text-sm":""}`,children:[a.jsx("div",{className:"flex items-center h-5",children:a.jsx("input",{...m("acceptTerms"),type:"checkbox",className:"h-4 w-4 rounded border-border text-primary focus:ring-primary focus:ring-offset-0",disabled:l})}),a.jsxs("div",{className:"text-sm",children:[a.jsxs("label",{className:"text-muted-foreground",children:[s==="ar"?"  ":"I agree to the ",a.jsx(It,{to:"/terms",className:"text-primary hover:text-primary/80 underline",children:s==="ar"?" ":"Terms and Conditions"}),s==="ar"?" ":" and ",a.jsx(It,{to:"/privacy",className:"text-primary hover:text-primary/80 underline",children:s==="ar"?" ":"Privacy Policy"})]}),x.acceptTerms&&a.jsx("p",{className:"text-sm text-destructive mt-1",children:x.acceptTerms.message})]})]}),a.jsx(ge,{type:"submit",className:`w-full ${i?"h-10 text-sm":""}`,loading:l,disabled:l||!g,loadingText:s==="ar"?"  ...":"Creating account...",children:s==="ar"?" ":"Create Account"})]}),a.jsxs("div",{className:"relative my-6",children:[a.jsx("div",{className:"absolute inset-0 flex items-center",children:a.jsx("span",{className:"w-full border-t border-border"})}),a.jsx("div",{className:"relative flex justify-center text-xs uppercase",children:a.jsx("span",{className:"bg-background px-2 text-muted-foreground",children:s==="ar"?"":"or"})})]}),a.jsx("div",{className:`text-center ${i?"text-sm":""}`,children:a.jsxs("p",{className:"text-sm text-muted-foreground",children:[s==="ar"?"   ":"Already have an account? ",a.jsx(It,{to:"/login",className:"text-primary hover:text-primary/80 underline font-medium",children:s==="ar"?" ":"Sign in"})]})})]})]})},WG=c0({email:io().email("Please enter a valid email address")}),VG=()=>{var f;const{language:e}=Xt(),[t,n]=we.useState(!1),[r,s]=we.useState(!1),{isMobile:i}=Tr(),{register:l,handleSubmit:o,formState:{errors:c},getValues:u}=ih({resolver:og(WG)}),d=async m=>{n(!0);try{await Xn.forgotPassword(m.email),s(!0),dn.success({en:"Password reset link sent to your email",ar:"         "})}catch{s(!0)}finally{n(!1)}};return r?a.jsxs(Qe,{className:`w-full ${i?"max-w-md mx-4":"max-w-md"}`,children:[a.jsxs(xt,{className:"space-y-1 text-center",children:[a.jsx("div",{className:"mx-auto w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mb-4",children:a.jsx(Si,{className:"h-6 w-6 text-green-600"})}),a.jsx(yt,{className:`text-2xl font-bold ${i?"text-xl":""}`,children:e==="ar"?"   ":"Email Sent"}),a.jsx(bs,{children:e==="ar"?"          ":"Check your email for a password reset link"})]}),a.jsxs(tt,{className:"space-y-4",children:[a.jsxs("div",{className:`text-center space-y-4 ${i?"text-sm":""}`,children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:e==="ar"?"       :":"We sent a password reset link to:"}),a.jsx("p",{className:"font-medium text-foreground",children:u("email")}),a.jsx("p",{className:"text-sm text-muted-foreground",children:e==="ar"?"           .":"If you don't see the email, check your spam folder."})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx(ge,{onClick:()=>s(!1),variant:"outline",className:`w-full ${i?"h-10 text-sm":""}`,children:e==="ar"?"  ":"Send Again"}),a.jsx(ge,{asChild:!0,variant:"ghost",className:`w-full ${i?"h-10 text-sm":""}`,children:a.jsxs(It,{to:"/login",className:"flex items-center justify-center",children:[a.jsx(ho,{className:`w-4 h-4 ${i?"mr-1":"mr-2"}`}),e==="ar"?"  ":"Back to Sign In"]})})]})]})]}):a.jsxs(Qe,{className:`w-full ${i?"max-w-md mx-4":"max-w-md"}`,children:[a.jsxs(xt,{className:"space-y-1",children:[a.jsx(yt,{className:`text-2xl font-bold text-center ${i?"text-xl":""}`,children:e==="ar"?"  ":"Forgot Password?"}),a.jsx(bs,{className:"text-center",children:e==="ar"?"         ":"Enter your email address and we'll send you a password reset link"})]}),a.jsxs(tt,{children:[a.jsxs("form",{onSubmit:o(d),className:"space-y-4",children:[a.jsx(Kt,{...l("email"),type:"email",placeholder:e==="ar"?" ":"Email address",leftIcon:a.jsx(Pa,{className:"h-4 w-4"}),error:(f=c.email)==null?void 0:f.message,disabled:t,className:i?"text-sm":""}),a.jsx(ge,{type:"submit",className:`w-full ${i?"h-10 text-sm":""}`,loading:t,loadingText:e==="ar"?" ...":"Sending...",children:e==="ar"?"   ":"Send Reset Link"})]}),a.jsx("div",{className:"mt-6 text-center",children:a.jsx(ge,{asChild:!0,variant:"ghost",className:`w-full ${i?"h-10 text-sm":""}`,children:a.jsxs(It,{to:"/login",className:"flex items-center justify-center",children:[a.jsx(ho,{className:`w-4 h-4 ${i?"mr-1":"mr-2"}`}),e==="ar"?"  ":"Back to Sign In"]})})}),a.jsx("div",{className:`mt-6 text-center ${i?"text-sm":""}`,children:a.jsxs("p",{className:"text-sm text-muted-foreground",children:[e==="ar"?"   ":"Remember your password? ",a.jsx(It,{to:"/login",className:"text-primary hover:text-primary/80 underline font-medium",children:e==="ar"?" ":"Sign in"})]})})]})]})},GG=c0({password:io().min(8,"Password must be at least 8 characters").regex(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/,"Password must contain at least one uppercase letter, one lowercase letter, and one number"),confirmPassword:io()}).refine(e=>e.password===e.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]}),YG=()=>{var v,N;const e=Ir(),[t]=Y2(),{language:n}=Xt(),[r,s]=we.useState(!1),[i,l]=we.useState(!1),[o,c]=we.useState(!0),{isMobile:u}=Tr(),d=t.get("token"),{register:f,handleSubmit:m,formState:{errors:h},watch:x}=ih({resolver:og(GG)}),y=x("password");we.useEffect(()=>{d||c(!1)},[d]);const p=async A=>{var P,U;if(d){s(!0);try{await Xn.resetPassword("",d,A.password,A.confirmPassword),l(!0),dn.success({en:"Password reset successfully",ar:"     "})}catch(M){const S=(M==null?void 0:M.message)||(n==="ar"?"      ":"Failed to reset password");dn.error({en:S,ar:S}),((P=M==null?void 0:M.message)!=null&&P.includes("invalid")||(U=M==null?void 0:M.message)!=null&&U.includes("expired"))&&c(!1)}finally{s(!1)}}},w=(A=>{if(!A)return{strength:0,label:""};let P=0;return P=[A.length>=8,/[a-z]/.test(A),/[A-Z]/.test(A),/\d/.test(A),/[!@#$%^&*(),.?":{}|<>]/.test(A)].filter(Boolean).length,{strength:P,label:{en:["Very Weak","Weak","Fair","Good","Strong"],ar:[" ","","","",""]}[n][Math.max(0,P-1)]||""}})(y||"");return o?i?a.jsxs(Qe,{className:`w-full ${u?"max-w-md mx-4":"max-w-md"}`,children:[a.jsxs(xt,{className:"space-y-1 text-center",children:[a.jsx("div",{className:"mx-auto w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mb-4",children:a.jsx(Si,{className:"h-6 w-6 text-green-600"})}),a.jsx(yt,{className:`text-2xl font-bold ${u?"text-xl":""}`,children:n==="ar"?"    ":"Password Reset Complete"}),a.jsx(bs,{children:n==="ar"?"     .       .":"Your password has been successfully reset. You can now sign in with your new password."})]}),a.jsx(tt,{children:a.jsx(ge,{asChild:!0,className:`w-full ${u?"h-10 text-sm":""}`,onClick:()=>e("/login"),children:a.jsx(It,{to:"/login",children:n==="ar"?" ":"Sign In"})})})]}):a.jsxs(Qe,{className:`w-full ${u?"max-w-md mx-4":"max-w-md"}`,children:[a.jsxs(xt,{className:"space-y-1",children:[a.jsx(yt,{className:`text-2xl font-bold text-center ${u?"text-xl":""}`,children:n==="ar"?"   ":"Reset Password"}),a.jsx(bs,{className:"text-center",children:n==="ar"?"   ":"Enter your new password"})]}),a.jsxs(tt,{children:[a.jsxs("form",{onSubmit:m(p),className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Kt,{...f("password"),type:"password",placeholder:n==="ar"?"  ":"New password",leftIcon:a.jsx(zi,{className:"h-4 w-4"}),showPasswordToggle:!0,error:(v=h.password)==null?void 0:v.message,disabled:r,className:u?"text-sm":""}),y&&a.jsx("div",{className:"space-y-2",children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"flex-1 bg-muted rounded-full h-2",children:a.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${w.strength<=2?"bg-destructive":w.strength<=3?"bg-yellow-500":"bg-green-500"}`,style:{width:`${w.strength/5*100}%`}})}),a.jsx("span",{className:`text-xs text-muted-foreground min-w-0 ${u?"text-xs":""}`,children:w.label})]})})]}),a.jsx(Kt,{...f("confirmPassword"),type:"password",placeholder:n==="ar"?"  ":"Confirm new password",leftIcon:a.jsx(zi,{className:"h-4 w-4"}),showPasswordToggle:!0,error:(N=h.confirmPassword)==null?void 0:N.message,disabled:r,className:u?"text-sm":""}),a.jsx(ge,{type:"submit",className:`w-full ${u?"h-10 text-sm":""}`,loading:r,loadingText:n==="ar"?"  ...":"Resetting...",children:n==="ar"?"   ":"Reset Password"})]}),a.jsx("div",{className:"mt-6 text-center",children:a.jsx(ge,{asChild:!0,variant:"ghost",className:`w-full ${u?"h-10 text-sm":""}`,children:a.jsx(It,{to:"/login",children:n==="ar"?"  ":"Back to Sign In"})})})]})]}):a.jsxs(Qe,{className:`w-full ${u?"max-w-md mx-4":"max-w-md"}`,children:[a.jsxs(xt,{className:"space-y-1 text-center",children:[a.jsx("div",{className:"mx-auto w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mb-4",children:a.jsx(ii,{className:"h-6 w-6 text-red-600"})}),a.jsx(yt,{className:`text-2xl font-bold ${u?"text-xl":""}`,children:n==="ar"?"  ":"Invalid Link"}),a.jsx(bs,{children:n==="ar"?"         ":"The password reset link is invalid or has expired"})]}),a.jsxs(tt,{className:"space-y-4",children:[a.jsx("div",{className:`text-center space-y-4 ${u?"text-sm":""}`,children:a.jsx("p",{className:"text-sm text-muted-foreground",children:n==="ar"?"       .":"Please request a new password reset link."})}),a.jsxs("div",{className:"space-y-3",children:[a.jsx(ge,{asChild:!0,className:`w-full ${u?"h-10 text-sm":""}`,children:a.jsx(It,{to:"/forgot-password",children:n==="ar"?"  ":"Request New Link"})}),a.jsx(ge,{asChild:!0,variant:"outline",className:`w-full ${u?"h-10 text-sm":""}`,children:a.jsx(It,{to:"/login",children:n==="ar"?"  ":"Back to Sign In"})})]})]})]})},JG=()=>{const[e]=Y2(),{language:t}=Xt(),[n,r]=we.useState(!0),[s,i]=we.useState(!1),[l,o]=we.useState(!1),[c,u]=we.useState(""),[d,f]=we.useState(!1),{isMobile:m}=Tr(),h=e.get("token");we.useEffect(()=>{h?x(h):(r(!1),o(!0),u(t==="ar"?"  ":"Verification token is missing"))},[h,t]);const x=async p=>{try{await Xn.verifyEmail(p),i(!0),dn.success({en:"Email verified successfully",ar:"    "})}catch(g){o(!0);const w=(g==null?void 0:g.message)||(t==="ar"?"    ":"Email verification failed");u(w),dn.error({en:w,ar:w})}finally{r(!1)}},y=async()=>{f(!0);try{await Xn.resendVerificationEmail(),dn.success({en:"Verification email sent again",ar:"     "})}catch(p){const g=(p==null?void 0:p.message)||(t==="ar"?"    ":"Failed to send verification email");dn.error({en:g,ar:g})}finally{f(!1)}};return n?a.jsx(Qe,{className:`w-full ${m?"max-w-md mx-4":"max-w-md"}`,children:a.jsxs(xt,{className:"space-y-1 text-center",children:[a.jsx("div",{className:"mx-auto w-12 h-12 bg-primary/10 rounded-full flex items-center justify-center mb-4",children:a.jsx(wr,{className:"h-6 w-6 text-primary animate-spin"})}),a.jsx(yt,{className:`text-2xl font-bold ${m?"text-xl":""}`,children:t==="ar"?" ...":"Verifying..."}),a.jsx(bs,{children:t==="ar"?"      ":"Please wait while we verify your email address"})]})}):s?a.jsxs(Qe,{className:`w-full ${m?"max-w-md mx-4":"max-w-md"}`,children:[a.jsxs(xt,{className:"space-y-1 text-center",children:[a.jsx("div",{className:"mx-auto w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mb-4",children:a.jsx(Si,{className:"h-6 w-6 text-green-600"})}),a.jsx(yt,{className:`text-2xl font-bold ${m?"text-xl":""}`,children:t==="ar"?"  !":"Email Verified!"}),a.jsx(bs,{children:t==="ar"?"    .       .":"Your email has been successfully verified. You can now access all features."})]}),a.jsxs(tt,{className:"space-y-4",children:[a.jsx("div",{className:`text-center space-y-4 ${m?"text-sm":""}`,children:a.jsx("p",{className:"text-sm text-muted-foreground",children:t==="ar"?"   Nasabna!      .":"Welcome to Nasabna! Start building your family tree now."})}),a.jsxs("div",{className:"space-y-3",children:[a.jsx(ge,{asChild:!0,className:`w-full ${m?"h-10 text-sm":""}`,children:a.jsx(It,{to:"/dashboard",children:t==="ar"?"   ":"Go to Dashboard"})}),a.jsx(ge,{asChild:!0,variant:"outline",className:`w-full ${m?"h-10 text-sm":""}`,children:a.jsx(It,{to:"/login",children:t==="ar"?" ":"Sign In"})})]})]})]}):l?a.jsxs(Qe,{className:`w-full ${m?"max-w-md mx-4":"max-w-md"}`,children:[a.jsxs(xt,{className:"space-y-1 text-center",children:[a.jsx("div",{className:"mx-auto w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mb-4",children:a.jsx(ii,{className:"h-6 w-6 text-red-600"})}),a.jsx(yt,{className:`text-2xl font-bold ${m?"text-xl":""}`,children:t==="ar"?" ":"Verification Failed"}),a.jsx(bs,{children:c})]}),a.jsxs(tt,{className:"space-y-4",children:[a.jsx("div",{className:`text-center space-y-4 ${m?"text-sm":""}`,children:a.jsx("p",{className:"text-sm text-muted-foreground",children:t==="ar"?"         .":"The verification link may have expired or already been used."})}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs(ge,{onClick:y,className:`w-full ${m?"h-10 text-sm":""}`,loading:d,loadingText:t==="ar"?" ...":"Sending...",children:[a.jsx(Pa,{className:`w-4 h-4 ${m?"mr-1":"mr-2"}`}),t==="ar"?"   ":"Send New Verification Email"]}),a.jsx(ge,{asChild:!0,variant:"outline",className:`w-full ${m?"h-10 text-sm":""}`,children:a.jsx(It,{to:"/login",children:t==="ar"?"  ":"Back to Sign In"})})]}),a.jsx("div",{className:`mt-6 text-center ${m?"text-sm":""}`,children:a.jsxs("p",{className:"text-sm text-muted-foreground",children:[t==="ar"?"  ":"Need help? ",a.jsx(It,{to:"/contact",className:"text-primary hover:text-primary/80 underline",children:t==="ar"?" ":"Contact support"})]})})]})]}):null},ZG=()=>{const[e,t]=Y.useState({}),[n,r]=Y.useState(!1);return Y.useEffect(()=>{const s="deviceMemory"in navigator||"memory"in performance&&performance.memory;if(r(!!s),!s)return;const i=()=>{const o={};if("deviceMemory"in navigator&&(o.deviceMemory=navigator.deviceMemory),"memory"in performance&&performance.memory){const c=performance.memory;o.totalJSHeapSize=c.totalJSHeapSize,o.usedJSHeapSize=c.usedJSHeapSize,o.jsHeapSizeLimit=c.jsHeapSizeLimit,o.isLowMemory=c.usedJSHeapSize>c.jsHeapSizeLimit*.8}t(o)};i();const l=setInterval(i,5e3);return()=>clearInterval(l)},[]),{memoryInfo:e,isSupported:n}},id=we.forwardRef(({className:e,...t},n)=>a.jsx("textarea",{className:Ai("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:n,...t}));id.displayName="Textarea";const Sh=({isOpen:e,onClose:t,title:n,children:r,size:s="md"})=>{if(!e)return null;const i={sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl"};return a.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:t}),a.jsx("div",{className:"flex min-h-screen items-center justify-center p-4",children:a.jsxs("div",{className:`relative bg-background rounded-lg shadow-xl w-full ${i[s]} max-h-[90vh] overflow-y-auto`,onClick:l=>l.stopPropagation(),children:[a.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[n&&a.jsx("h3",{className:"text-lg font-semibold text-foreground",children:n}),a.jsx(ge,{variant:"ghost",size:"icon",onClick:t,className:"text-muted-foreground hover:text-foreground",children:a.jsx(ia,{className:"h-5 w-5"})})]}),a.jsx("div",{className:"p-4",children:r})]})})]})},Cb=({isOpen:e,onClose:t,onSubmit:n,initialData:r,mode:s})=>{const{language:i}=Xt(),{trees:l}=xs(),{isMobile:o}=Tr(),c=i==="ar",[u,d]=Y.useState(!1),[f,m]=Y.useState(null),[h,x]=Y.useState({name:(r==null?void 0:r.name)||"",description:(r==null?void 0:r.description)||"",descriptionEn:(r==null?void 0:r.descriptionEn)||"",isPublic:(r==null?void 0:r.isPublic)!==void 0?r.isPublic:!0}),y=async p=>{var g,w;p.preventDefault(),d(!0),m(null);try{if(!h.name.trim())throw new Error(c?"  ":"Tree name is required");let v;if(s==="create")v=await Pt.createTree(h.name,!h.isPublic,h.description);else{if(!(r!=null&&r.id))throw new Error(c?"  ":"Tree ID is missing");v=await Pt.updateTree(parseInt(r.id),h.name,!h.isPublic,h.description)}n({...v,description:h.description,descriptionEn:h.descriptionEn}),t()}catch(v){let N=c?"   ":"Failed to save tree";if(v.response)if(v.response.status===400)if((g=v.response.data)!=null&&g.message){const A=v.response.data.message.toLowerCase();A.includes("duplicate")||A.includes("already exists")||A.includes("in use")||A.includes("unique")?N=c?"   .    .":"Tree name is already in use. Please choose a different name.":N+=`: ${v.response.data.message}`}else N=c?"   .    .":"Tree name is already in use. Please choose a different name.";else(w=v.response.data)!=null&&w.message&&(N+=`: ${v.response.data.message}`);else v.message&&(N+=`: ${v.message}`);m(N)}finally{d(!1)}};return a.jsx(Sh,{isOpen:e,onClose:t,title:s==="create"?o?c?" ":"New Tree":c?"  ":"Create New Tree":c?" ":"Edit Tree",size:o?"xl":"md",children:a.jsxs("form",{onSubmit:y,className:"space-y-4",children:[f&&a.jsx("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-3",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(fo,{className:"h-5 w-5 text-destructive flex-shrink-0 mt-0.5"}),a.jsx("p",{className:"text-destructive text-sm",children:f})]})}),a.jsx("div",{className:`grid grid-cols-1 ${o?"gap-3":"md:grid-cols-2 gap-4"}`,children:a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:o?c?"":"Name":c?"  *":"Tree Name *"}),a.jsx(Kt,{value:h.name,onChange:p=>x(g=>({...g,name:p.target.value})),placeholder:c?" ":"Tree Name",required:!0,disabled:u,className:o?"text-sm py-2":""})]})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:o?c?"":"Description":c?" ":"Tree Description"}),a.jsx(id,{value:h.description,onChange:p=>x(g=>({...g,description:p.target.value,descriptionEn:p.target.value})),placeholder:c?" ":"Tree Description",rows:3,disabled:u,className:o?"text-sm py-2":""})]}),a.jsxs("div",{className:`flex ${o?"flex-col gap-2":"gap-3 pt-4"}`,children:[a.jsxs(ge,{type:"submit",className:`flex items-center gap-2 ${o?"w-full":""}`,disabled:u,size:o?"sm":"default",children:[u?a.jsx(wr,{className:`animate-spin ${o?"h-3 w-3":"h-4 w-4"}`}):null,s==="create"?o?c?"":"Create":c?" ":"Create Tree":o?c?"":"Save":c?" ":"Save Changes"]}),a.jsx(ge,{variant:"outline",onClick:t,disabled:u,type:"button",className:o?"w-full":"",size:o?"sm":"default",children:c?"":"Cancel"})]})]})})},Nm={getUserTreeLimit:async e=>{try{const n=await fetch(`https://qabael.premiumasp.net/api/FamilyTree/UserTreeLimit/${e}`);if(!n.ok)throw new Error(`Failed to fetch user limits: ${n.status} ${n.statusText}`);return await n.json()}catch(t){throw console.error("Error fetching user limits:",t),t}},getDefaultLimits:()=>({trees:1,people:10,photos:0,documents:0,storage:1073741824,collaborators:1})},xc=()=>{const{user:e,isAuthenticated:t}=Pr(),[n,r]=Y.useState(null),[s,i]=Y.useState(null),[l,o]=Y.useState(!0),[c,u]=Y.useState(null),d=(e==null?void 0:e.role)==="admin",f=Y.useCallback(async()=>{try{if(!t||!e){r(Nm.getDefaultLimits()),i({trees:0,people:0,photos:0,documents:0,storage:0,collaborators:0}),o(!1);return}if(d){r({trees:0,people:0,photos:0,documents:0,storage:0,collaborators:0}),i({trees:0,people:0,photos:0,documents:0,storage:0,collaborators:0}),o(!1);return}const p=e.id;if(!p)throw new Error("User ID not found");const g=await Nm.getUserTreeLimit(p);g.plan&&g.limits?r(g.limits):r(Nm.getDefaultLimits());try{const w=await jx.getUsage();i({trees:w.trees,people:w.members,photos:w.photos,documents:w.documents,storage:w.storage,collaborators:0})}catch{i({trees:0,people:0,photos:0,documents:0,storage:0,collaborators:0})}}catch(p){r(Nm.getDefaultLimits());try{const g=await jx.getUsage();i({trees:g.trees,people:g.members,photos:g.photos,documents:g.documents,storage:g.storage,collaborators:0})}catch{i({trees:0,people:0,photos:0,documents:0,storage:0,collaborators:0})}u(p.message||"Failed to fetch subscription limits")}finally{o(!1)}},[t,e,d]),m=Y.useCallback(()=>{f()},[f]);return Y.useEffect(()=>{f()},[f]),{limits:n,usage:s,isLoading:l,error:c,isLimitReached:(p,g)=>{if(d||!n)return!1;const w=n[p];return w===0?!1:g>=w},getRemainingCount:(p,g)=>{if(d)return 999999;if(!n)return 0;const w=n[p];return w===0?999999:Math.max(0,w-g)},canPerformAction:p=>!0,refreshLimits:m}},MA=({trees:e=[],onCancel:t,onSuccess:n})=>{const[r,s]=Y.useState([]),[i,l]=Y.useState(!1),[o,c]=Y.useState(!1),[u,d]=Y.useState(null),{isMobile:f}=Tr(),{limits:m,isLimitReached:h}=xc(),{register:x,handleSubmit:y,watch:p,setValue:g,formState:{errors:w}}=ih({defaultValues:{treeId:"",relatedPersonId:"",relationship:"son",fullName:"",gender:"male",birthDate:"",birthPlace:"",occupation:"",isDeceased:!1,deathDate:""}}),v=p("treeId"),N=p("gender"),A=p("isDeceased");Y.useEffect(()=>{(async()=>{if(!v){s([]);return}try{c(!0);const S=await Pt.getPersonsInTree(Number(v));let C=[];if(Array.isArray(S))C=S;else if(S&&typeof S=="object"){const T=S;T.data&&Array.isArray(T.data)&&(C=T.data)}const _=C.map(T=>{var V,R,q,F;const B=((V=T.id)==null?void 0:V.toString())||((R=T.ID)==null?void 0:R.toString())||((q=T.Id)==null?void 0:q.toString())||((F=T.personId)==null?void 0:F.toString())||"",$=T.firstName||T.FirstName||T.firstname||T.firstNameEn||T.firstName_en||"",D=T.lastName||T.LastName||T.lastname||T.lastNameEn||T.lastName_en||"",L=T.fullName||T.FullName||T.fullname||T.name||"",O=T.displayName||T.DisplayName||T.displayname||"",W=T.fullArabicName||T.FullArabicName||T.fullarabicname||"",E=T.arabicName||T.ArabicName||T.arabicname||null;return{id:B,firstName:$||void 0,lastName:D||void 0,fullName:L||void 0,displayName:O||void 0,fullArabicName:W||void 0,arabicName:E||void 0}});s(_)}catch(S){console.error("Error loading persons:",S),d("Failed to load persons in selected tree")}finally{c(!1)}})()},[v]);const P=()=>N==="male"?[{value:"son",label:"Son"},{value:"husband",label:"Husband"}]:N==="female"?[{value:"daughter",label:"Daughter"},{value:"wife",label:"Wife"}]:[{value:"son",label:"Son"},{value:"daughter",label:"Daughter"},{value:"husband",label:"Husband"},{value:"wife",label:"Wife"}],U=async M=>{try{l(!0),d(null);let S=0;if(v)try{const _=await Pt.getPersonsInTree(Number(v));S=Array.isArray(_)?_.length:0}catch{console.warn("Could not fetch current person count, using usage data as fallback")}if(m&&h("people",S))throw new Error(`You've reached your person limit of ${m.people}. Please upgrade your subscription to add more people.`);const C=await Pt.addPersonToTree(M.fullName,M.birthDate,M.birthPlace,M.occupation,M.gender,M.deathDate,M.isDeceased,Number(M.treeId));if(M.relatedPersonId&&M.relationship)try{let _="";switch(M.relationship){case"son":_="Child";break;case"daughter":_="Child";break;case"husband":_="Spouse";break;case"wife":_="Spouse";break;default:_=M.relationship}await Pt.addRelationship(Number(M.relatedPersonId),Number(C.id),_)}catch{}n==null||n(C.id)}catch(S){d(S.message||"Failed to create person")}finally{l(!1)}};return a.jsxs("form",{onSubmit:y(U),className:"space-y-6",children:[a.jsxs("div",{className:`grid grid-cols-1 ${f?"gap-4":"md:grid-cols-2 gap-6"}`,children:[a.jsxs("div",{className:f?"":"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Select Tree"}),a.jsxs("select",{...x("treeId",{required:"Tree is required"}),className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",disabled:i,children:[a.jsx("option",{value:"",children:"Select a tree"}),e.map(M=>a.jsx("option",{value:M.id,children:M.name},M.id))]}),w.treeId&&a.jsx("p",{className:"mt-1 text-sm text-red-500",children:w.treeId.message})]}),a.jsxs("div",{className:f?"":"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:f?"Related Person":"Related Person (Optional)"}),a.jsxs("select",{...x("relatedPersonId"),className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",disabled:i||o||!v,children:[a.jsx("option",{value:"",children:"Select a person"}),r.map(M=>{let S=`Person ${M.id||"Unknown"}`;const C=M.firstName||M.FirstName||M.firstname||"",_=M.lastName||M.LastName||M.lastname||"",T=M.fullName||M.FullName||M.fullname||M.name||"",B=M.displayName||M.DisplayName||M.displayname||"",$=M.fullArabicName||M.FullArabicName||M.fullarabicname||"",D=M.arabicName||M.ArabicName||M.arabicname||null;if(T&&typeof T=="string"&&T.trim()!=="")S=T;else if(B&&typeof B=="string"&&B.trim()!=="")S=B;else if(C&&typeof C=="string"&&C.trim()!==""||_&&typeof _=="string"&&_.trim()!=="")S=`${C||""} ${_||""}`.trim();else if($&&typeof $=="string"&&$.trim()!=="")S=$;else if(D&&typeof D=="object"){const L=D.firstName||D.FirstName||D.firstname||"",O=D.lastName||D.LastName||D.lastname||"",W=`${L||""} ${O||""}`.trim();W&&(S=W)}return a.jsx("option",{value:M.id,children:S},M.id)})]}),o&&a.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Loading persons..."})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Gender *"}),a.jsxs("select",{...x("gender",{required:"Gender is required"}),className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",disabled:i,children:[a.jsx("option",{value:"male",children:"Male"}),a.jsx("option",{value:"female",children:"Female"}),a.jsx("option",{value:"unknown",children:"Unknown"})]}),w.gender&&a.jsx("p",{className:"mt-1 text-sm text-red-500",children:w.gender.message})]}),a.jsxs("div",{className:f?"":"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:f?"Relationship":"Relationship (Optional)"}),a.jsx("select",{...x("relationship"),className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",disabled:i,children:P().map(M=>a.jsx("option",{value:M.value,children:M.label},M.value))})]}),a.jsxs("div",{className:f?"":"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Full Name *"}),a.jsx(Kt,{...x("fullName",{required:"Full name is required"}),placeholder:"Enter full name",disabled:i}),w.fullName&&a.jsx("p",{className:"mt-1 text-sm text-red-500",children:w.fullName.message})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Birth Date"}),a.jsx(Kt,{type:"date",...x("birthDate"),disabled:i})]}),a.jsxs("div",{className:f?"":"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Birth Place"}),a.jsx(Kt,{...x("birthPlace"),placeholder:"Enter birth place",disabled:i})]}),a.jsxs("div",{className:f?"":"md:col-span-2",children:[a.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Occupation"}),a.jsx(Kt,{...x("occupation"),placeholder:"Enter occupation",disabled:i})]}),a.jsxs("div",{className:`flex items-center ${f?"":"md:col-span-2"}`,children:[a.jsx("input",{type:"checkbox",...x("isDeceased"),id:"isDeceased",className:"h-4 w-4 rounded border-input text-primary focus:ring-primary",disabled:i}),a.jsx("label",{htmlFor:"isDeceased",className:"ml-2 block text-sm text-foreground",children:"Is Deceased"})]}),A&&a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-foreground mb-2",children:"Death Date"}),a.jsx(Kt,{type:"date",...x("deathDate"),disabled:i})]})]}),u&&a.jsx("div",{className:"rounded-md bg-red-50 p-4",children:a.jsxs("div",{className:"flex",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("h3",{className:"text-sm font-medium text-red-800",children:"Error"}),a.jsx("div",{className:"mt-2 text-sm text-red-700",children:a.jsx("p",{children:u})})]})]})}),a.jsxs("div",{className:`flex ${f?"flex-col gap-2":"justify-end space-x-3"}`,children:[a.jsx(ge,{type:"button",variant:"outline",onClick:t,disabled:i,className:f?"w-full":"",children:"Cancel"}),a.jsx(ge,{type:"submit",loading:i,className:f?"w-full":"",children:"Create Person"})]})]})},XG=({isOpen:e,onClose:t,trees:n,onSuccess:r})=>a.jsx(Sh,{isOpen:e,onClose:t,title:"Add New Person",size:"lg",children:a.jsx("div",{className:"p-4",children:a.jsx(MA,{trees:n,onCancel:t,onSuccess:s=>{r==null||r(s),t()}})})}),L1=({current:e,limit:t,label:n,showPercentage:r=!0})=>{const s=t>0?Math.min(100,e/t*100):0,i=e>t&&t>0,l=s>=80&&s<100;return a.jsxs("div",{className:"mb-3",children:[a.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[a.jsx("span",{className:"text-muted-foreground",children:n}),a.jsxs("span",{className:"font-medium",children:[e," ",t>0?`/ ${t}`:"/ ",r&&t>0&&a.jsxs("span",{className:"ml-2 text-xs",children:["(",Math.round(s),"%)"]})]})]}),a.jsx("div",{className:"w-full bg-muted rounded-full h-2",children:a.jsx("div",{className:`h-2 rounded-full ${i?"bg-destructive":l?"bg-yellow-500 dark:bg-yellow-600":"bg-primary"}`,style:{width:`${Math.min(100,s)}%`}})})]})},KG=()=>{const{limits:e,usage:t,isLoading:n,error:r}=xc(),{language:s}=Xt();if(n)return a.jsx(Qe,{children:a.jsx(tt,{className:"p-4",children:a.jsxs("div",{className:"space-y-3",children:[a.jsx("div",{className:"h-4 bg-muted rounded animate-pulse"}),a.jsx("div",{className:"h-4 bg-muted rounded animate-pulse w-3/4"}),a.jsx("div",{className:"h-4 bg-muted rounded animate-pulse w-1/2"})]})})});if(r)return a.jsx(Qe,{className:"border-destructive",children:a.jsx(tt,{className:"p-4",children:a.jsxs("div",{className:"flex items-center text-destructive",children:[a.jsx(ii,{className:"h-5 w-5 mr-2"}),a.jsx("span",{children:s==="ar"?"    ":"Failed to load subscription status"})]})})});if(!e||!t)return null;const i=e.trees>0?Math.min(100,t.trees/e.trees*100):0,l=e.people>0?Math.min(100,t.people/e.people*100):0,o=e.storage>0?Math.min(100,t.storage/e.storage*100):0,c=i>100||l>100||o>100,u=!c&&(i>=80||l>=80||o>=80);return a.jsx(Qe,{children:a.jsxs(tt,{className:"p-4",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h3",{className:"font-medium",children:s==="ar"?" ":"Subscription Usage"}),c?a.jsxs("div",{className:"flex items-center text-destructive text-sm",children:[a.jsx(ii,{className:"h-4 w-4 mr-1"}),s==="ar"?" ":"Over limit"]}):u?a.jsxs("div",{className:"flex items-center text-yellow-600 dark:text-yellow-500 text-sm",children:[a.jsx(ju,{className:"h-4 w-4 mr-1"}),s==="ar"?" ":"Near limit"]}):a.jsxs("div",{className:"flex items-center text-green-600 dark:text-green-500 text-sm",children:[a.jsx(Si,{className:"h-4 w-4 mr-1"}),s==="ar"?"":"Good"]})]}),a.jsx(L1,{current:t.trees,limit:e.trees,label:s==="ar"?"":"Trees"}),a.jsx(L1,{current:t.people,limit:e.people,label:s==="ar"?" ":"Family Members"}),a.jsx(L1,{current:Math.round(t.storage/(1024*1024)),limit:Math.round(e.storage/(1024*1024)),label:s==="ar"?" ()":"Storage (MB)"}),(c||u)&&a.jsx("div",{className:`mt-3 p-3 rounded-md text-sm ${c?"bg-destructive/10 text-destructive":"bg-yellow-500/10 text-yellow-700 dark:text-yellow-500"}`,children:c?s==="ar"?"   .      .":"You have exceeded your subscription limits. Please upgrade your subscription plan.":s==="ar"?"    .        .":"You are approaching your subscription limits. Please consider upgrading your subscription plan."})]})})},QG=()=>{const{user:e,getCurrentUser:t}=Pr(),{language:n,showError:r}=Xt(),{trees:s,fetchTrees:i}=xs(),{limits:l,usage:o}=xc();Ir();const{memoryInfo:c,isSupported:u}=ZG(),[d,f]=Y.useState({trees:0,people:0,photos:0,documents:0}),[m,h]=Y.useState([]),[x,y]=Y.useState([]),[p,g]=Y.useState(!0),[w,v]=Y.useState(null),[N,A]=Y.useState(!0),[P,U]=Y.useState(!1),[M,S]=Y.useState(!1),C=Y.useCallback(async()=>{try{await t()}catch{r({en:"Failed to update user data",ar:"    "},{en:"An error occurred while updating your user information",ar:"       "})}},[t,r]);Y.useEffect(()=>{e!=null&&e.firstName||C()},[C,e==null?void 0:e.firstName]);const _=Y.useCallback(async(D=0)=>{var L,O,W;try{v(null),navigator.deviceMemory&&navigator.deviceMemory<2,N&&g(!0),await Promise.race([i(),new Promise((G,ee)=>setTimeout(()=>ee(new Error("Request timeout")),35e3))]);const E=s.length;let H=0,V=0,R=0;s.forEach(G=>{var ee,ae,re;H+=((ee=G.stats)==null?void 0:ee.totalPeople)||0,V+=((ae=G.stats)==null?void 0:ae.totalPhotos)||0,R+=((re=G.stats)==null?void 0:re.totalDocuments)||0}),f({trees:E,people:H,photos:V,documents:R}),h([{id:1,type:"person_added",message:n==="ar"?"      ":"Added Ahmed Mohamed to Family Tree",time:"2 hours ago",icon:In},{id:2,type:"photo_uploaded",message:n==="ar"?"     ":"Uploaded new photo for Fatima Ali",time:"1 day ago",icon:dh},{id:3,type:"tree_created",message:n==="ar"?"    ":"Created new family tree",time:"3 days ago",icon:_u}]),y([{id:1,type:"missing_parent",title:n==="ar"?"  ":"Add Parent Information",description:n==="ar"?"    ":"Add parent information for Ahmed Mohamed",priority:"high"},{id:2,type:"missing_photo",title:n==="ar"?"  ":"Add Profile Photo",description:n==="ar"?"   ":"Add a photo for Fatima Ali",priority:"medium"},{id:3,type:"missing_birth_date",title:n==="ar"?"  ":"Add Birth Date",description:n==="ar"?"    ":"Add birth date for Mohamed Ahmed",priority:"low"}])}catch(E){E.code==="ECONNABORTED"||E.message.includes("timeout")?(v(n==="ar"?"  .         .":"Connection timeout. Please check your internet connection and try again."),r({en:"Connection Timeout",ar:"  "},{en:"Connection timeout. Please check your internet connection and try again.",ar:"  .         ."})):E.code==="ERR_NETWORK"||E.message.includes("ERR_INSUFFICIENT_RESOURCES")?(v(n==="ar"?"  .       .":"Your system is low on resources. Please close other tabs and try again."),r({en:"Low System Resources",ar:"  "},{en:"Your system is low on resources. Please close other tabs and try again.",ar:"  .       ."})):((L=E.response)==null?void 0:L.status)===401?(v(n==="ar"?"   .     .":"Unauthorized access. Please log in again."),r({en:"Unauthorized Access",ar:"  "},{en:"Unauthorized access. Please log in again.",ar:"   .     ."})):((O=E.response)==null?void 0:O.status)>=500?(v(n==="ar"?"  .     .":"Server error. Please try again later."),r({en:"Server Error",ar:"  "},{en:"Server error. Please try again later.",ar:"  .     ."})):((W=E.response)==null?void 0:W.status)>=400?(v(n==="ar"?"  .    .":"Invalid request. Please try again."),r({en:"Invalid Request",ar:"  "},{en:"Invalid request. Please try again.",ar:"  .    ."})):navigator.onLine?(v(n==="ar"?"   .    .":"Failed to load data. Please try again."),r({en:"Failed to Load Data",ar:"   "},{en:"Failed to load data. Please try again.",ar:"   .    ."})):(v(n==="ar"?"   .    .":"You are offline. Please check your internet connection."),r({en:"Offline",ar:"  "},{en:"You are offline. Please check your internet connection.",ar:"   .    ."}))}finally{g(!1),A(!1)}},[n,i,s.length,r]);Y.useEffect(()=>{_()},[_]);const T=()=>a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:[...Array(4)].map((D,L)=>a.jsxs(Qe,{children:[a.jsxs(xt,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx("div",{className:"h-4 w-24 bg-muted rounded animate-pulse"}),a.jsx("div",{className:"h-4 w-4 bg-muted rounded-full animate-pulse"})]}),a.jsxs(tt,{children:[a.jsx("div",{className:"h-6 w-8 bg-muted rounded animate-pulse mb-1"}),a.jsx("div",{className:"h-3 w-16 bg-muted rounded animate-pulse"})]})]},L))}),B=()=>a.jsxs("div",{children:[a.jsx("div",{className:"h-6 w-32 bg-muted rounded animate-pulse mb-4"}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[...Array(4)].map((D,L)=>a.jsx(Qe,{className:"h-24",children:a.jsxs("div",{className:"p-4 space-y-3",children:[a.jsx("div",{className:"h-6 w-6 bg-muted rounded animate-pulse"}),a.jsx("div",{className:"h-4 w-20 bg-muted rounded animate-pulse"}),a.jsx("div",{className:"h-3 w-16 bg-muted rounded animate-pulse"})]})},L))})]}),$=()=>a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsx("div",{className:"h-5 w-32 bg-muted rounded animate-pulse"})}),a.jsx(tt,{children:a.jsx("div",{className:"space-y-4",children:[...Array(3)].map((D,L)=>a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("div",{className:"w-8 h-8 bg-muted rounded-full animate-pulse"})}),a.jsxs("div",{className:"flex-1 min-w-0 space-y-2",children:[a.jsx("div",{className:"h-4 w-48 bg-muted rounded animate-pulse"}),a.jsx("div",{className:"h-3 w-20 bg-muted rounded animate-pulse"})]})]},L))})})]}),a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsx("div",{className:"h-5 w-32 bg-muted rounded animate-pulse"})}),a.jsx(tt,{children:a.jsx("div",{className:"space-y-4",children:[...Array(3)].map((D,L)=>a.jsxs("div",{className:"flex items-start justify-between p-3 bg-muted/30 rounded-lg",children:[a.jsxs("div",{className:"flex-1 space-y-2",children:[a.jsx("div",{className:"h-4 w-32 bg-muted rounded animate-pulse"}),a.jsx("div",{className:"h-3 w-40 bg-muted rounded animate-pulse"})]}),a.jsx("div",{className:"h-6 w-6 bg-muted rounded animate-pulse"})]},L))})})]})]});return p&&N?a.jsxs("div",{className:"space-y-8",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{children:[a.jsx("div",{className:"h-8 w-48 bg-muted rounded animate-pulse mb-2"}),a.jsx("div",{className:"h-4 w-64 bg-muted rounded animate-pulse"})]}),a.jsx("div",{className:"mt-4 sm:mt-0",children:a.jsx("div",{className:"h-10 w-32 bg-muted rounded animate-pulse"})})]}),a.jsx(T,{}),a.jsx(B,{}),a.jsx($,{})]}):w?a.jsxs("div",{className:"flex flex-col items-center justify-center h-64 space-y-4",children:[a.jsx(ii,{className:"h-12 w-12 text-red-500"}),a.jsx("h3",{className:"text-xl font-medium text-foreground",children:n==="ar"?" ":"An error occurred"}),a.jsx("p",{className:"text-muted-foreground text-center max-w-md",children:w}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(ge,{onClick:()=>_(),className:"btn-gradient rounded-xl text-sm sm:text-base px-3 sm:px-4 py-2 sm:py-2.5 leading-tight",children:[a.jsx(po,{className:"mr-2 h-4 w-4 flex-shrink-0"}),a.jsx("span",{className:"truncate",children:n==="ar"?" ":"Try Again"})]}),a.jsx(ge,{variant:"outline",asChild:!0,className:"rounded-xl text-sm sm:text-base px-3 sm:px-4 py-2 sm:py-2.5 leading-tight",children:a.jsx(It,{to:"/trees",className:"flex items-center gap-2 min-w-0",children:a.jsx("span",{className:"truncate",children:n==="ar"?" ":"View Trees"})})})]})]}):a.jsxs("div",{className:"space-y-8",children:[u&&c.isLowMemory&&a.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4",children:a.jsxs("div",{className:"flex",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx(ii,{className:"h-5 w-5 text-yellow-400"})}),a.jsx("div",{className:"ml-3",children:a.jsx("p",{className:"text-sm text-yellow-700",children:n==="ar"?"  .       .":"Your system is low on resources. Please close other tabs to improve performance."})})]})}),l&&a.jsx("div",{className:"rounded-xl shadow-md overflow-hidden",children:a.jsx("div",{className:"bg-gradient-to-r from-green-600 via-emerald-600 to-green-700 text-white p-4 sm:p-6",children:a.jsxs("div",{className:"flex items-center justify-between gap-4",children:[a.jsx(ge,{asChild:!0,variant:"secondary",className:"rounded-xl bg-white text-green-700 hover:bg-white/90 font-semibold shadow-sm text-sm sm:text-base px-3 sm:px-4 py-2 sm:py-2.5 leading-tight",children:a.jsx(It,{to:"/subscription",className:"flex items-center gap-2 min-w-0",children:a.jsx("span",{className:"truncate",children:n==="ar"?" ":"Upgrade Now"})})}),a.jsxs("div",{className:"flex-1 flex items-center justify-end gap-3",children:[a.jsxs("div",{className:"text-right",children:[a.jsx("div",{className:"text-sm opacity-90",children:n==="ar"?" ":"Members Usage"}),a.jsxs("div",{className:"text-lg font-bold",children:[d.people," ",a.jsxs("span",{className:"opacity-90 font-medium",children:["/ ",l.people===0?"":l.people||0," ",n==="ar"?"":"members"]})]}),l.people>0&&a.jsx("div",{className:"mt-2 w-56 sm:w-64 h-2 bg-white/30 rounded-full overflow-hidden",children:a.jsx("div",{className:"h-2 bg-white rounded-full",style:{width:`${Math.min(100,d.people/(l.people||1)*100)}%`}})})]}),a.jsx("div",{className:"w-9 h-9 sm:w-10 sm:h-10 rounded-full bg-white/20 flex items-center justify-center",children:a.jsx(In,{className:"w-5 h-5 text-white"})})]})]})})}),a.jsxs("div",{className:"relative overflow-hidden rounded-2xl bg-gradient-to-br from-emerald-600 via-green-600 to-teal-700 p-6 sm:p-8 text-white",children:[a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-6",children:[a.jsxs("div",{className:"max-w-2xl",children:[a.jsx("h1",{className:"text-3xl md:text-4xl font-extrabold tracking-tight",children:n==="ar"?` ${(e==null?void 0:e.firstName)||(e==null?void 0:e.email)||""}`:`Welcome back, ${(e==null?void 0:e.firstName)||(e==null?void 0:e.email)||"User"}`}),a.jsx("p",{className:"mt-3 text-sm sm:text-base text-white/90",children:n==="ar"?"         .":"Manage your family trees, track activity, and complete member profiles effortlessly."}),a.jsxs("div",{className:"mt-5 flex flex-wrap gap-2",children:[(e==null?void 0:e.role)==="admin"&&a.jsx(ge,{asChild:!0,variant:"outline",className:"rounded-xl bg-white/15 hover:bg-white/20 border-white/30 text-white text-sm sm:text-base px-3 sm:px-4 py-2 sm:py-2.5 leading-tight",children:a.jsxs(It,{to:"/admin/dashboard",className:"flex items-center gap-2 min-w-0",children:[a.jsx(Mf,{className:"h-4 w-4 flex-shrink-0"}),a.jsx("span",{className:"truncate",children:n==="ar"?" ":"Admin Dashboard"})]})}),a.jsx(ge,{asChild:!0,className:"rounded-xl bg-white text-emerald-700 hover:bg-white/90 text-sm sm:text-base px-3 sm:px-4 py-2 sm:py-2.5 leading-tight",children:a.jsxs(It,{to:"/trees",className:"flex items-center gap-2 min-w-0",children:[a.jsx("span",{className:"truncate",children:n==="ar"?"  ":"View All Trees"}),a.jsx(Zi,{className:"h-4 w-4 flex-shrink-0"})]})})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3 w-full md:w-auto",children:[a.jsxs("div",{className:"rounded-xl bg-white/15 backdrop-blur-sm p-4",children:[a.jsx("p",{className:"text-xs opacity-90",children:n==="ar"?" ":"Total Trees"}),a.jsx("p",{className:"text-2xl font-bold",children:d.trees})]}),a.jsxs("div",{className:"rounded-xl bg-white/15 backdrop-blur-sm p-4",children:[a.jsx("p",{className:"text-xs opacity-90",children:n==="ar"?" ":"Total People"}),a.jsx("p",{className:"text-2xl font-bold",children:d.people})]})]})]}),a.jsx("div",{className:"pointer-events-none absolute -top-10 -right-10 w-64 h-64 rounded-full bg-white/10 blur-3xl"})]}),a.jsx(Cb,{isOpen:P,onClose:()=>U(!1),mode:"create",onSubmit:()=>{U(!1),_()}}),a.jsx(XG,{isOpen:M,onClose:()=>S(!1),trees:s,onSuccess:()=>{_()}}),(e==null?void 0:e.subscription)&&a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsxs(yt,{className:"flex items-center justify-between",children:[a.jsxs("span",{className:"flex items-center",children:[a.jsx(hp,{className:"h-5 w-5 mr-2"}),n==="ar"?" ":"Subscription Status"]}),a.jsx("span",{className:`px-3 py-1 text-xs rounded-full ${e.subscription.status==="active"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-100":"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-100"}`,children:e.subscription.status==="active"?n==="ar"?"":"Active":n==="ar"?"":"Expired"})]})}),a.jsxs(tt,{children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{children:[a.jsxs("p",{className:"text-sm text-foreground",children:[n==="ar"?" :":"Current Plan:",a.jsx("span",{className:"font-medium ml-1 capitalize",children:e.subscription.plan})]}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:[n==="ar"?" :":"Expires on:",new Date(e.subscription.currentPeriodEnd).toLocaleDateString()]})]}),a.jsx(ge,{asChild:!0,variant:"outline",className:"rounded-xl mt-4 sm:mt-0 text-sm sm:text-base px-3 sm:px-4 py-2 sm:py-2.5 leading-tight",children:a.jsx(It,{to:"/subscription",className:"flex items-center gap-2 min-w-0",children:a.jsx("span",{className:"truncate",children:n==="ar"?" ":"Manage Subscription"})})})]}),a.jsxs("div",{className:"mt-4 pt-4 border-t grid grid-cols-2 sm:grid-cols-4 gap-4",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-sm font-medium",children:n==="ar"?"":"Trees"}),a.jsxs("p",{className:"text-lg font-bold",children:[d.trees," ",a.jsxs("span",{className:"text-sm font-normal text-muted-foreground",children:["/ ",(l==null?void 0:l.trees)===0?"":(l==null?void 0:l.trees)||1]})]}),l&&l.trees>0&&a.jsx("div",{className:"w-full bg-muted rounded-full h-1.5 mt-1",children:a.jsx("div",{className:"bg-primary h-1.5 rounded-full",style:{width:`${Math.min(100,d.trees/l.trees*100)}%`}})})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-sm font-medium",children:n==="ar"?"":"People"}),a.jsxs("p",{className:"text-lg font-bold",children:[(o==null?void 0:o.people)||0," ",a.jsxs("span",{className:"text-sm font-normal text-muted-foreground",children:["/ ",(l==null?void 0:l.people)===0?"":(l==null?void 0:l.people)||10]})]}),o&&l&&l.people>0&&a.jsx("div",{className:"w-full bg-muted rounded-full h-1.5 mt-1",children:a.jsx("div",{className:"bg-primary h-1.5 rounded-full",style:{width:`${Math.min(100,o.people/l.people*100)}%`}})})]})]}),a.jsx("div",{className:"mt-4 pt-4 border-t",children:a.jsx(KG,{})})]})]})]})},er=({variant:e="default",className:t,children:n,...r})=>{const s={default:"bg-primary text-primary-foreground hover:bg-primary/80",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground border border-input bg-background hover:bg-accent hover:text-accent-foreground"};return a.jsx("div",{className:Ai("inline-flex items-center rounded-full px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",s[e],t),...r,children:n})},Pb=({isOpen:e,onClose:t,onConfirm:n,title:r,message:s,confirmText:i,cancelText:l,variant:o="default"})=>{const{language:c}=Xt(),u=f=>f?typeof f=="string"?f:f[c]:"",d=()=>{n(),t()};return a.jsx(Sh,{isOpen:e,onClose:t,title:u(r),size:"sm",children:a.jsxs("div",{className:"space-y-6",children:[a.jsx("p",{className:"text-foreground",children:u(s)}),a.jsxs("div",{className:"flex justify-end space-x-3",children:[a.jsx(ge,{variant:"outline",onClick:t,children:u(l)||(c==="ar"?"":"Cancel")}),a.jsx(ge,{variant:o,onClick:d,children:u(i)||(c==="ar"?"":"Confirm")})]})]})})},eY=()=>{const{language:e}=Xt(),{trees:t,publicTrees:n,fetchTrees:r,fetchPublicTrees:s,deleteTree:i,isLoading:l,error:o}=xs(),{limits:c,isLimitReached:u}=xc(),{isMobile:d}=Tr(),f=Ir(),[m,h]=Y.useState(""),[x,y]=Y.useState(null),[p,g]=Y.useState(null),[w,v]=Y.useState("myTrees"),[N,A]=Y.useState(!1),[P,U]=Y.useState(!1),[M,S]=Y.useState(null),C=e==="ar",_=u("trees",t.length);Y.useEffect(()=>{r(),s()},[r,s]);const T=async F=>{S(F),U(!0)},B=async()=>{if(M)try{g(M),await i(M)}catch{y(e==="ar"?"   ":"Failed to delete tree"),setTimeout(()=>y(null),3e3)}finally{g(null),S(null)}},$=t.filter(F=>{var G,ee;return((G=F.name)==null?void 0:G.toLowerCase().includes(m.toLowerCase()))||((ee=F.description)==null?void 0:ee.toLowerCase().includes(m.toLowerCase()))}),D=n.filter(F=>{var G,ee;return((G=F.name)==null?void 0:G.toLowerCase().includes(m.toLowerCase()))||((ee=F.description)==null?void 0:ee.toLowerCase().includes(m.toLowerCase()))}),L=F=>({family:e==="ar"?"":"Family",research:e==="ar"?"":"Research",historical:e==="ar"?"":"Historical",other:e==="ar"?"":"Other"})[F]||F,O=F=>{const G={family:"bg-blue-100 text-blue-800",research:"bg-purple-100 text-purple-800",historical:"bg-green-100 text-green-800",other:"bg-gray-100 text-gray-800"};return G[F]||G.other},W=o||x,E=w==="myTrees"?$:D,H=l&&w==="myTrees",V=l&&w==="publicTrees",R=F=>{r()},q=()=>{if(_){const F=(c==null?void 0:c.trees)||1,G=C?`       (${F} ).     .`:`You've reached the maximum number of trees (${F} trees). Please upgrade your subscription to create more.`;dn.error({en:G,ar:G},{action:{label:C?" ":"Upgrade Subscription",onClick:()=>window.location.assign("/subscription/plans")}});return}A(!0)};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:`flex ${d?"flex-col gap-4":"flex-col sm:flex-row sm:items-center sm:justify-between"}`,children:[a.jsxs("div",{children:[a.jsx("h1",{className:`font-bold text-foreground ${d?"text-2xl":"text-3xl"}`,children:e==="ar"?" ":"Family Trees"}),a.jsx("p",{className:`mt-2 text-muted-foreground ${d?"text-sm":""}`,children:e==="ar"?"        ":"Manage and view all your family trees and public trees"})]}),a.jsxs("div",{className:d?"w-full":"mt-4 sm:mt-0",children:[_&&a.jsxs("div",{className:"mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg flex items-start gap-2",children:[a.jsx(fo,{className:"h-5 w-5 text-yellow-600 flex-shrink-0 mt-0.5"}),a.jsx("p",{className:"text-sm text-yellow-800",children:C?"      .     .":"You've reached the maximum number of trees. Please upgrade your subscription to create more."})]}),a.jsxs(ge,{onClick:q,className:"w-full",size:d?"sm":"default",disabled:_,children:[a.jsx(_u,{className:`mr-2 h-4 w-4 ${d?"h-3 w-3":""}`}),d?e==="ar"?"":"Create":e==="ar"?"  ":"Create New Tree"]})]})]}),a.jsx("div",{className:`border-b border-border ${d?"overflow-x-auto":""}`,children:a.jsxs("nav",{className:`flex ${d?"space-x-4 min-w-max":"space-x-8"}`,children:[a.jsxs("button",{onClick:()=>v("myTrees"),className:`py-3 px-1 border-b-2 font-medium text-sm ${w==="myTrees"?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground hover:border-muted"} ${d?"text-xs py-2":""}`,children:[e==="ar"?"":"My Trees",a.jsx("span",{className:`ml-2 text-xs rounded-full px-2 py-0.5 ${d?"text-xs px-1.5 py-0.5":""} bg-muted text-muted-foreground`,children:t.length})]}),a.jsxs("button",{onClick:()=>v("publicTrees"),className:`py-3 px-1 border-b-2 font-medium text-sm ${w==="publicTrees"?"border-primary text-primary":"border-transparent text-muted-foreground hover:text-foreground hover:border-muted"} ${d?"text-xs py-2":""}`,children:[e==="ar"?" ":"Public Trees",a.jsx("span",{className:`ml-2 text-xs rounded-full px-2 py-0.5 ${d?"text-xs px-1.5 py-0.5":""} bg-muted text-muted-foreground`,children:n.length})]})]})}),a.jsxs("div",{className:"relative",children:[a.jsx(Qi,{className:`absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground ${d?"left-2 h-3 w-3":""}`}),a.jsx(Kt,{placeholder:e==="ar"?"  ...":"Search trees...",value:m,onChange:F=>h(F.target.value),className:`pl-10 ${d?"pl-8 text-sm":""}`})]}),W&&a.jsx("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-3",children:a.jsx("p",{className:"text-destructive text-sm",children:W})}),(H||V)&&w==="myTrees"&&a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx(wr,{className:"h-8 w-8 animate-spin text-primary"})}),!l&&a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:E.length===0?a.jsxs("div",{className:"col-span-full text-center py-12",children:[a.jsx(Qn,{className:"mx-auto h-12 w-12 text-muted-foreground"}),a.jsx("h3",{className:"mt-4 font-medium",children:w==="myTrees"?e==="ar"?"   ":"No trees yet":e==="ar"?"   ":"No public trees"}),a.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:w==="myTrees"?e==="ar"?"    ":"Get started by creating a new family tree":e==="ar"?"     ":"No public trees available at the moment"})]}):E.map(F=>{var G,ee;return a.jsxs(Qe,{className:"overflow-hidden",children:[a.jsxs("div",{className:"relative",children:[F.photoUrl?a.jsx("img",{src:F.photoUrl,alt:e==="ar"?" ":"Tree photo",className:"w-full h-48 object-cover"}):a.jsx("div",{className:"w-full h-48 bg-gradient-to-br from-primary/20 to-primary/40 flex items-center justify-center",children:a.jsx(Qn,{className:"h-16 w-16 text-primary/30"})}),a.jsx("div",{className:"absolute top-3 right-3",children:a.jsx(er,{className:O(F.category||"other"),children:L(F.category||"other")})}),F.isPrivate&&a.jsx("div",{className:"absolute top-3 left-3",children:a.jsx(zi,{className:"h-5 w-5 text-white drop-shadow"})})]}),a.jsxs(xt,{className:"pb-2",children:[a.jsxs(yt,{className:"flex items-center justify-between",children:[a.jsx("span",{className:"truncate",children:F.name}),((G=F.owner)==null?void 0:G.id)&&a.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[a.jsx(sn,{className:"h-3 w-3"}),a.jsxs("span",{children:[F.owner.firstName," ",F.owner.lastName]})]})]}),a.jsx(bs,{className:"line-clamp-2 text-sm",children:F.description||(e==="ar"?"  ":"No description")})]}),a.jsxs(tt,{children:[a.jsxs("div",{className:"flex items-center justify-between text-sm text-muted-foreground mb-4",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(In,{className:"h-4 w-4"}),a.jsxs("span",{children:[((ee=F.stats)==null?void 0:ee.totalPeople)||0," ",e==="ar"?"":"people"]})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Ur,{className:"h-4 w-4"}),a.jsx("span",{children:new Date(F.createdAt||"").toLocaleDateString()})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(ge,{size:"sm",variant:"outline",className:"flex-1",onClick:()=>f(`/trees/${F.id}`),children:[a.jsx(ra,{className:"h-4 w-4 mr-2"}),e==="ar"?"":"View"]}),w==="myTrees"&&a.jsxs(a.Fragment,{children:[a.jsx(ge,{size:"sm",variant:"outline",onClick:()=>f(`/trees/${F.id}/edit`),children:a.jsx(sa,{className:"h-4 w-4"})}),a.jsx(ge,{size:"sm",variant:"outline",onClick:()=>T(F.id),disabled:p===F.id,children:p===F.id?a.jsx(wr,{className:"h-4 w-4 animate-spin"}):a.jsx(Ia,{className:"h-4 w-4"})})]})]})]})]},F.id)})}),a.jsx(Pb,{isOpen:P,onClose:()=>U(!1),onConfirm:B,title:e==="ar"?" ":"Confirm Deletion",message:e==="ar"?"              .":"Are you sure you want to delete this tree?you will lose all data associated with this tree.",confirmText:e==="ar"?"":"Delete",cancelText:e==="ar"?"":"Cancel",variant:"destructive"}),a.jsx(Cb,{isOpen:N,onClose:()=>A(!1),mode:"create",onSubmit:R})]})},tY="modulepreload",nY=function(e){return"/"+e},hN={},np=function(t,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),o=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));s=Promise.allSettled(n.map(c=>{if(c=nY(c),c in hN)return;hN[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const f=document.createElement("link");if(f.rel=u?"stylesheet":tY,u||(f.as="script"),f.crossOrigin="",f.href=c,o&&f.setAttribute("nonce",o),document.head.appendChild(f),u)return new Promise((m,h)=>{f.addEventListener("load",m),f.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(l){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=l,window.dispatchEvent(o),!o.defaultPrevented)throw l}return s.then(l=>{for(const o of l||[])o.status==="rejected"&&i(o.reason);return t().catch(i)})},Qf=({isOpen:e,onClose:t,onSubmit:n,familyTreeId:r,familyMembers:s,relationships:i=[],initialData:l,initialRelationshipData:o,mode:c})=>{const{language:u,theme:d}=Xt(),{limits:f,isLimitReached:m}=xc(),{isMobile:h}=Tr(),x=u==="ar",[y,p]=Y.useState(!1),[g,w]=Y.useState(null),[v,N]=Y.useState({name:(l==null?void 0:l.name)||"",gender:(l==null?void 0:l.gender)||"male",birthDate:(l==null?void 0:l.birthDate)||"",deathDate:(l==null?void 0:l.deathDate)||"",birthPlace:(l==null?void 0:l.birthPlace)||"",birthPlaceEn:(l==null?void 0:l.birthPlaceEn)||"",occupation:(l==null?void 0:l.occupation)||"",occupationEn:(l==null?void 0:l.occupationEn)||"",isAlive:(l==null?void 0:l.isAlive)!==void 0?l.isAlive:!0,parentId:(o==null?void 0:o.parentId)||"",relationshipType:(o==null?void 0:o.relationshipType)||"",motherId:"",fatherId:"",motherSelection:""}),[A,P]=Y.useState([]),[U,M]=Y.useState(!1),[S,C]=Y.useState(""),_=O=>{const W=[];return i&&Array.isArray(i)&&i.filter(H=>{var ee,ae;const V=["Spouse","spouse","Husband","husband","Wife","wife"].includes(H.relationshipType),R=O.toString(),q=(ee=H.personId)==null?void 0:ee.toString(),F=(ae=H.relatedPersonId)==null?void 0:ae.toString();return V&&(q===R||F===R)}).forEach(H=>{var ee,ae;const V=(ee=H.personId)==null?void 0:ee.toString(),R=(ae=H.relatedPersonId)==null?void 0:ae.toString(),q=O.toString(),F=V===q?R:V,G=s.find(re=>re.id.toString()===F);G&&W.push(G)}),W.length===0&&s.forEach(E=>{var V,R;let H=!1;if((V=E.relationships)!=null&&V.spouses&&(H=E.relationships.spouses.some(q=>typeof q=="string"?q===O:typeof q=="object"&&q.id?q.id===O:!1)),!H&&((R=E.relationships)!=null&&R.spouse)){const q=E.relationships.spouse;typeof q=="string"?H=q===O:typeof q=="object"&&q.id&&(H=q.id===O)}!H&&E.relationships&&Array.isArray(E.relationships)&&(H=E.relationships.some(q=>(q.type==="spouse"||q.relationshipType==="spouse")&&(q.personId===O||q.id===O))),!H&&E.spouseIds&&Array.isArray(E.spouseIds)&&(H=E.spouseIds.includes(O)),H&&W.push(E)}),W},T=O=>{let W=null,E=null,H=null,V=null;return i&&Array.isArray(i)&&i.filter(q=>{var ae;const F=q.relationshipType==="Child",G=O.toString(),ee=(ae=q.relatedPersonId)==null?void 0:ae.toString();return F&&ee===G}).forEach(q=>{var ee;const F=(ee=q.personId)==null?void 0:ee.toString(),G=s.find(ae=>ae.id.toString()===F);G&&(G.gender==="male"?(W=G,H=q.id):G.gender==="female"&&(E=G,V=q.id))}),{father:W,mother:E,fatherRelationshipId:H,motherRelationshipId:V}};Y.useEffect(()=>{if(v.parentId&&(v.relationshipType==="son"||v.relationshipType==="daughter")){const O=_(v.parentId);P(O),M(O.length>0),C("")}else P([]),M(!1),C("")},[v.parentId,v.relationshipType,s]),Y.useEffect(()=>{if(l&&N(O=>({...O,name:l.name||"",gender:l.gender||"male",birthDate:l.birthDate||"",deathDate:l.deathDate||"",birthPlace:l.birthPlace||"",birthPlaceEn:l.birthPlaceEn||"",occupation:l.occupation||"",occupationEn:l.occupationEn||"",isAlive:l.isAlive!==void 0?l.isAlive:!0})),o&&N(O=>({...O,parentId:o.parentId||"",relationshipType:o.relationshipType||""})),c==="edit"&&(l!=null&&l.id)){const{father:O,mother:W}=T(l.id);O&&N(E=>({...E,fatherId:O.id})),W&&(N(E=>({...E,motherId:W.id})),C(W.id))}},[l,o,c]);const B=O=>{C(""),N(W=>({...W,parentId:O}))},$=()=>v.gender==="male"?[{value:"son",label:x?"":"Son"},{value:"husband",label:x?"":"Husband"}]:v.gender==="female"?[{value:"daughter",label:x?"":"Daughter"},{value:"wife",label:x?"":"Wife"}]:[{value:"son",label:x?"":"Son"},{value:"daughter",label:x?"":"Daughter"},{value:"husband",label:x?"":"Husband"},{value:"wife",label:x?"":"Wife"}],D=async O=>{var W,E,H,V,R;O.preventDefault(),p(!0),w(null);try{if(!v.name.trim())throw new Error(x?"   ":"Please enter a member name");if(c==="create"&&f&&m("people",s.length)){const F=f.people;throw new Error(x?`          (${F} ).     .`:`You've reached the maximum number of people in this tree (${F} people). Please upgrade your subscription to add more.`)}if(c==="create"&&v.parentId&&(v.relationshipType==="father"||v.relationshipType==="mother")){const F=s.find(G=>G.id===v.parentId);if(F&&F.relationships){if(v.relationshipType==="father"&&F.relationships.father)throw new Error(x?"     .":" This person already has a father.");if(v.relationshipType==="mother"&&F.relationships.mother)throw new Error(x?"     .":" This person already has a mother.")}}let q;if(c==="create"){if(q=await Pt.addPersonToTree(v.name,v.birthDate||"",x?v.birthPlace||"":v.birthPlaceEn||"",x?v.occupation||"":v.occupationEn||"",v.gender||"unknown",v.deathDate||"",!v.isAlive,parseInt(r)),v.parentId&&v.relationshipType)try{let F="";switch(v.relationshipType){case"son":F="Child";break;case"daughter":F="Child";break;case"husband":F="Spouse";break;case"wife":F="Spouse";break;default:F=v.relationshipType}v.relationshipType==="son"||v.relationshipType==="daughter"?(await Pt.addRelationship(parseInt(v.parentId),parseInt(q.id),F),S&&await Pt.addRelationship(parseInt(S),parseInt(q.id),F)):v.relationshipType==="father"||v.relationshipType==="mother"?await Pt.addRelationship(parseInt(q.id),parseInt(v.parentId),F):await Pt.addRelationship(parseInt(v.parentId),parseInt(q.id),F)}catch(F){console.error("Error adding relationship:",F)}}else{if(!(l!=null&&l.id))throw new Error(x?"     .    ":"Error updating member data. Please try again");if(q=await Pt.updatePerson(parseInt(l.id),v.name,v.birthDate||"",x?v.birthPlace||"":v.birthPlaceEn||"",x?v.occupation||"":v.occupationEn||"",v.gender||"unknown",parseInt(r)),l.id)try{const{father:F,mother:G,fatherRelationshipId:ee,motherRelationshipId:ae}=T(l.id);if(v.fatherId!==((F==null?void 0:F.id)||"")){if(ee)try{await Pt.deleteRelationship(ee)}catch(re){console.error("Error deleting father relationship:",re)}v.fatherId&&await Pt.addRelationship(parseInt(v.fatherId),parseInt(l.id),"Child")}if(v.motherId!==((G==null?void 0:G.id)||"")){if(ae)try{await Pt.deleteRelationship(ae)}catch(re){console.error("Error deleting mother relationship:",re)}v.motherId&&await Pt.addRelationship(parseInt(v.motherId),parseInt(l.id),"Child")}}catch(F){console.error("Error updating parent relationships:",F)}}n(q),t()}catch(q){let F=x?"     .    ":"Error saving member data. Please try again";((W=q.response)==null?void 0:W.status)===400?F=x?"    ":"Please check the entered data":((E=q.response)==null?void 0:E.status)===401?F=x?"     ":"You must be logged in to perform this action":((H=q.response)==null?void 0:H.status)===403?F=x?"     ":"You do not have permission to perform this action":((V=q.response)==null?void 0:V.status)===404?F=x?"     ":"The requested member was not found":((R=q.response)==null?void 0:R.status)===500?F=x?"   .     ":"Server error. Please try again later":q.message&&(q.message.includes("Network Error")?F=x?"  .     ":"Network error. Please check your internet connection":q.message.includes("timeout")?F=x?"  .    ":"Request timeout. Please try again":F=q.message),w(F)}finally{p(!1)}};if(!e)return null;const L=h?"95vw":"600px";return a.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:O=>{O.target===O.currentTarget&&t()},children:a.jsxs("div",{className:"relative rounded-3xl shadow-2xl max-h-[95vh] overflow-hidden animate-in fade-in-0 zoom-in-95 duration-300",style:{width:L,background:d==="dark"?"linear-gradient(135deg, #1f2937 0%, #111827 100%)":"linear-gradient(135deg, #ffffff 0%, #f8fafc 100%)",border:`2px solid ${d==="dark"?"#374151":"#e2e8f0"}`},onClick:O=>O.stopPropagation(),children:[a.jsxs("div",{className:"relative px-6 py-4 overflow-hidden",style:{background:v.gender==="male"?"linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)":v.gender==="female"?"linear-gradient(135deg, #ec4899 0%, #be185d 100%)":"linear-gradient(135deg, #6366f1 0%, #4f46e5 100%)"},children:[a.jsx("button",{onClick:O=>{O.preventDefault(),O.stopPropagation(),t()},className:"absolute top-4 right-4 w-10 h-10 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center hover:bg-white/30 transition-all duration-200 group z-10",type:"button",children:a.jsx(ia,{size:20,className:"text-white group-hover:scale-110 transition-transform"})}),a.jsxs("div",{className:"flex items-center space-x-3 text-white",children:[a.jsx("div",{className:"w-12 h-12 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center",children:c==="create"?a.jsx(In,{size:24,className:"text-white"}):a.jsx(sn,{size:24,className:"text-white"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold",children:c==="create"?x?"  ":"Add New Member":x?" ":"Edit Member"}),a.jsx("p",{className:"text-white/80 text-sm",children:c==="create"?x?"     ":"Add a new member to the family tree":x?"  ":"Edit member information"})]})]}),a.jsx("div",{className:"absolute -top-10 -right-10 w-32 h-32 rounded-full bg-white/5"}),a.jsx("div",{className:"absolute -bottom-5 -left-5 w-20 h-20 rounded-full bg-white/10"})]}),a.jsx("div",{className:"px-6 py-6 max-h-[calc(95vh-120px)] overflow-y-auto",children:a.jsxs("form",{onSubmit:D,className:"space-y-6",children:[g&&a.jsx("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-xl p-4",children:a.jsxs("div",{className:"flex items-start",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("svg",{className:"h-5 w-5 text-red-500",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),a.jsx("div",{className:"ml-3 flex-1",children:g.includes("maximum number of people")||g.includes("   ")?a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:g}),a.jsxs("button",{type:"button",onClick:()=>window.location.assign("/subscription"),className:"inline-flex items-center px-3 py-1.5 border border-transparent text-xs font-medium rounded-lg text-white bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 focus:outline-none transition-all duration-200",children:[a.jsx("svg",{className:"-ml-0.5 mr-1 h-4 w-4",viewBox:"0 0 20 20",fill:"currentColor",children:a.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),x?" ":"Upgrade Subscription"]})]}):a.jsx("h3",{className:"text-sm font-medium text-red-800 dark:text-red-200",children:g})})]})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center space-x-2 pb-2 border-b border-gray-200 dark:border-gray-700",children:[a.jsx(sn,{size:18,className:"text-blue-500"}),a.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100",children:x?" ":"Personal Information"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"md:col-span-2 space-y-2",children:[a.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300",children:[a.jsx(sn,{size:14,className:"mr-2 text-gray-500"}),x?"  *":"Member Name *"]}),a.jsxs("div",{className:"relative",children:[a.jsx(Kt,{value:v.name,onChange:O=>N(W=>({...W,name:O.target.value})),placeholder:x?"  ":"Enter member name",required:!0,disabled:y,className:"pl-10 h-12 rounded-xl border-2 focus:border-blue-500 transition-all duration-200"}),a.jsx(sn,{size:16,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300",children:[a.jsx(In,{size:14,className:"mr-2 text-gray-500"}),x?"":"Gender"]}),a.jsxs("div",{className:"relative",children:[a.jsxs("select",{value:v.gender,onChange:O=>N(W=>({...W,gender:O.target.value})),className:`w-full h-12 px-4 pl-10 border-2 rounded-xl bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none transition-all duration-200 ${v.gender==="female"?"focus:border-pink-500 border-pink-300":v.gender==="male"?"focus:border-blue-500 border-blue-300":"focus:border-purple-500 border-gray-300"}`,disabled:y,children:[a.jsx("option",{value:"male",children:x?"":"Male"}),a.jsx("option",{value:"female",children:x?"":"Female"})]}),a.jsx(In,{size:16,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300",children:[a.jsx(Ur,{size:14,className:"mr-2 text-gray-500"}),x?" ":"Birth Date"]}),a.jsxs("div",{className:"relative",children:[a.jsx(Kt,{type:"date",value:v.birthDate,onChange:O=>N(W=>({...W,birthDate:O.target.value})),disabled:y,className:"pl-10 h-12 rounded-xl border-2 focus:border-blue-500 transition-all duration-200"}),a.jsx(Ur,{size:16,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]})]}),!v.isAlive&&a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300",children:[a.jsx(Ur,{size:14,className:"mr-2 text-gray-500"}),x?" ":"Death Date"]}),a.jsxs("div",{className:"relative",children:[a.jsx(Kt,{type:"date",value:v.deathDate,onChange:O=>N(W=>({...W,deathDate:O.target.value})),disabled:y,className:"pl-10 h-12 rounded-xl border-2 focus:border-red-500 transition-all duration-200"}),a.jsx(Ur,{size:16,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300",children:[a.jsx(ai,{size:14,className:"mr-2 text-gray-500"}),x?" ":"Birth Place"]}),a.jsxs("div",{className:"relative",children:[a.jsx(Kt,{value:x?v.birthPlace:v.birthPlaceEn,onChange:O=>N(W=>({...W,[x?"birthPlace":"birthPlaceEn"]:O.target.value})),placeholder:x?"  ":"Enter birth place",disabled:y,className:"pl-10 h-12 rounded-xl border-2 focus:border-green-500 transition-all duration-200"}),a.jsx(ai,{size:16,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300",children:[a.jsx(Qo,{size:14,className:"mr-2 text-gray-500"}),x?"":"Occupation"]}),a.jsxs("div",{className:"relative",children:[a.jsx(Kt,{value:x?v.occupation:v.occupationEn,onChange:O=>N(W=>({...W,[x?"occupation":"occupationEn"]:O.target.value})),placeholder:x?" ":"Enter occupation",disabled:y,className:"pl-10 h-12 rounded-xl border-2 focus:border-purple-500 transition-all duration-200"}),a.jsx(Qo,{size:16,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300",children:[a.jsx(Or,{size:14,className:"mr-2 text-gray-500"}),x?"":"Status"]}),a.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 dark:bg-gray-800 rounded-xl",children:[a.jsx("input",{type:"checkbox",checked:v.isAlive,onChange:O=>N(W=>({...W,isAlive:O.target.checked})),disabled:y,className:"h-5 w-5 text-green-600 focus:ring-green-500 border-gray-300 rounded"}),a.jsx("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:x?"  ":"Living"})]})]})]})]}),c==="create"&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center space-x-2 pb-2 border-b border-gray-200 dark:border-gray-700",children:[a.jsx(Or,{size:18,className:"text-pink-500"}),a.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100",children:v.relationshipType==="father"?x?" ":"Add Father":v.relationshipType==="mother"?x?" ":"Add Mother":x?" ":"Family Relationships"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300",children:[a.jsx(In,{size:14,className:"mr-2 text-gray-500"}),v.relationshipType==="father"||v.relationshipType==="mother"?x?"":"Child":x?"":"Parent"]}),a.jsxs("select",{value:v.parentId,onChange:O=>B(O.target.value),className:"w-full h-12 px-4 border-2 rounded-xl bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:border-blue-500 transition-all duration-200",disabled:y,children:[a.jsx("option",{value:"",children:x?" ":"Select Person"}),s.map(O=>a.jsx("option",{value:O.id,children:x?`${O.firstName} ${O.lastName}`:`${O.firstNameEn} ${O.lastNameEn}`},O.id))]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300",children:[a.jsx(Or,{size:14,className:"mr-2 text-gray-500"}),x?" ":"Relationship Type"]}),a.jsxs("select",{value:v.relationshipType,onChange:O=>{const W=O.target.value;N(E=>({...E,relationshipType:W}))},className:"w-full h-12 px-4 border-2 rounded-xl bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:border-pink-500 transition-all duration-200",disabled:y||!v.parentId,children:[a.jsx("option",{value:"",children:x?"  ":"Select Relationship Type"}),$().map(O=>a.jsx("option",{value:O.value,children:O.label},O.value))]})]}),(v.relationshipType==="son"||v.relationshipType==="daughter")&&v.parentId&&a.jsx(a.Fragment,{children:A.length>0?a.jsxs("div",{className:"md:col-span-2 space-y-2",children:[a.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300",children:[a.jsx(Or,{size:14,className:"mr-2 text-pink-500"}),x?" ":"Select Mother"]}),a.jsxs("select",{value:S,onChange:O=>{C(O.target.value),N(W=>({...W,motherId:O.target.value}))},className:"w-full h-12 px-4 border-2 rounded-xl bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:border-pink-500 transition-all duration-200",disabled:y,children:[a.jsx("option",{value:"",children:x?"     ":"Select mother from father's wives"}),A.filter(O=>O.gender==="female").map(O=>a.jsx("option",{value:O.id,children:x?`${O.firstName} ${O.lastName}`:`${O.firstNameEn} ${O.lastNameEn}`},O.id))]}),a.jsxs("p",{className:"text-sm text-gray-500 bg-pink-50 dark:bg-pink-900/20 p-3 rounded-lg border border-pink-200 dark:border-pink-800",children:[a.jsx(Or,{size:16,className:"inline mr-2 text-pink-500"}),x?"           ":"The selected father has multiple wives, please choose the mother to connect the child to both parents"]})]}):a.jsx("div",{className:"md:col-span-2 space-y-2",children:a.jsxs("p",{className:"text-sm text-amber-600 bg-amber-50 dark:bg-amber-900/20 p-3 rounded-lg border border-amber-200 dark:border-amber-800",children:[a.jsx(Or,{size:16,className:"inline mr-2 text-amber-500"}),x?"     .           .":"The selected father has no registered wives. You can add the child without specifying the mother, or add a wife to the father first."]})})})]})]}),c==="edit"&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center space-x-2 pb-2 border-b border-gray-200 dark:border-gray-700",children:[a.jsx(In,{size:18,className:"text-blue-500"}),a.jsx("h3",{className:"font-semibold text-gray-900 dark:text-gray-100",children:x?" ":"Change Parents"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300",children:[a.jsx(sn,{size:14,className:"mr-2 text-blue-500"}),x?"":"Father"]}),a.jsxs("select",{value:v.fatherId,onChange:O=>N(W=>({...W,fatherId:O.target.value})),className:"w-full h-12 px-4 border-2 rounded-xl bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:border-blue-500 transition-all duration-200",disabled:y,children:[a.jsx("option",{value:"",children:x?" ":"Select Father"}),s.filter(O=>O.gender==="male").map(O=>a.jsx("option",{value:O.id,children:x?`${O.firstName} ${O.lastName}`:`${O.firstNameEn} ${O.lastNameEn}`},O.id))]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("label",{className:"flex items-center text-sm font-medium text-gray-700 dark:text-gray-300",children:[a.jsx(sn,{size:14,className:"mr-2 text-pink-500"}),x?"":"Mother"]}),a.jsxs("select",{value:v.motherId,onChange:O=>{N(W=>({...W,motherId:O.target.value})),C(O.target.value)},className:"w-full h-12 px-4 border-2 rounded-xl bg-white dark:bg-gray-800 text-gray-900 dark:text-gray-100 focus:outline-none focus:border-pink-500 transition-all duration-200",disabled:y,children:[a.jsx("option",{value:"",children:x?" ":"Select Mother"}),s.filter(O=>O.gender==="female").map(O=>a.jsx("option",{value:O.id,children:x?`${O.firstName} ${O.lastName}`:`${O.firstNameEn} ${O.lastNameEn}`},O.id))]})]})]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 pt-6 border-t border-gray-200 dark:border-gray-700",children:[a.jsxs(ge,{type:"submit",className:"flex-1 h-12 rounded-xl bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white font-medium transition-all duration-200 transform hover:scale-105",disabled:y,children:[y?a.jsx(wr,{className:"animate-spin h-5 w-5 mr-2"}):c==="create"?a.jsx(In,{className:"h-5 w-5 mr-2"}):a.jsx(sn,{className:"h-5 w-5 mr-2"}),c==="create"?x?" ":"Add Member":x?" ":"Save Changes"]}),a.jsx(ge,{variant:"outline",onClick:t,disabled:y,type:"button",className:"flex-1 sm:flex-none h-12 rounded-xl border-2 hover:bg-gray-50 dark:hover:bg-gray-800 transition-all duration-200",children:x?"":"Cancel"})]})]})})]})})};function ws(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=ws(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}const{useDebugValue:rY}=we,{useSyncExternalStoreWithSelector:sY}=S4,iY=e=>e;function RA(e,t=iY,n){const r=sY(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return rY(r),r}const mN=(e,t)=>{const n=b4(e),r=(s,i=t)=>RA(n,s,i);return Object.assign(r,n),r},aY=(e,t)=>e?mN(e,t):mN;function ls(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,s]of e)if(!Object.is(s,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}const lg=Y.createContext(null),oY=lg.Provider,xo={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},$A=xo.error001();function cr(e,t){const n=Y.useContext(lg);if(n===null)throw new Error($A);return RA(n,e,t)}const ss=()=>{const e=Y.useContext(lg);if(e===null)throw new Error($A);return Y.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},lY=e=>e.userSelectionActive?"none":"all";function Ib({position:e,children:t,className:n,style:r,...s}){const i=cr(lY),l=`${e}`.split("-");return we.createElement("div",{className:ws(["react-flow__panel",n,...l]),style:{...r,pointerEvents:i},...s},t)}function cY({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:we.createElement(Ib,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},we.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const uY=({x:e,y:t,label:n,labelStyle:r={},labelShowBg:s=!0,labelBgStyle:i={},labelBgPadding:l=[2,4],labelBgBorderRadius:o=2,children:c,className:u,...d})=>{const f=Y.useRef(null),[m,h]=Y.useState({x:0,y:0,width:0,height:0}),x=ws(["react-flow__edge-textwrapper",u]);return Y.useEffect(()=>{if(f.current){const y=f.current.getBBox();h({x:y.x,y:y.y,width:y.width,height:y.height})}},[n]),typeof n>"u"||!n?null:we.createElement("g",{transform:`translate(${e-m.width/2} ${t-m.height/2})`,className:x,visibility:m.width?"visible":"hidden",...d},s&&we.createElement("rect",{width:m.width+2*l[0],x:-l[0],y:-l[1],height:m.height+2*l[1],className:"react-flow__edge-textbg",style:i,rx:o,ry:o}),we.createElement("text",{className:"react-flow__edge-text",y:m.height/2,dy:"0.3em",ref:f,style:r},n),c)};var dY=Y.memo(uY);const Tb=e=>({width:e.offsetWidth,height:e.offsetHeight}),Wu=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),Lb=(e={x:0,y:0},t)=>({x:Wu(e.x,t[0][0],t[1][0]),y:Wu(e.y,t[0][1],t[1][1])}),pN=(e,t,n)=>e<t?Wu(Math.abs(e-t),1,50)/50:e>n?-Wu(Math.abs(e-n),1,50)/50:0,FA=(e,t)=>{const n=pN(e.x,35,t.width-35)*20,r=pN(e.y,35,t.height-35)*20;return[n,r]},OA=e=>{var t;return((t=e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},DA=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),eh=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),BA=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),gN=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),fY=(e,t)=>BA(DA(eh(e),eh(t))),S2=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},hY=e=>Oi(e.width)&&Oi(e.height)&&Oi(e.x)&&Oi(e.y),Oi=e=>!isNaN(e)&&isFinite(e),Cr=Symbol.for("internals"),zA=["Enter"," ","Escape"],mY=(e,t)=>{},pY=e=>"nativeEvent"in e;function _2(e){var s,i;const t=pY(e)?e.nativeEvent:e,n=((i=(s=t.composedPath)==null?void 0:s.call(t))==null?void 0:i[0])||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n==null?void 0:n.nodeName)||(n==null?void 0:n.hasAttribute("contenteditable"))||!!(n!=null&&n.closest(".nokey"))}const UA=e=>"clientX"in e,Xo=(e,t)=>{var i,l;const n=UA(e),r=n?e.clientX:(i=e.touches)==null?void 0:i[0].clientX,s=n?e.clientY:(l=e.touches)==null?void 0:l[0].clientY;return{x:r-((t==null?void 0:t.left)??0),y:s-((t==null?void 0:t.top)??0)}},t0=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0},_h=({id:e,path:t,labelX:n,labelY:r,label:s,labelStyle:i,labelShowBg:l,labelBgStyle:o,labelBgPadding:c,labelBgBorderRadius:u,style:d,markerEnd:f,markerStart:m,interactionWidth:h=20})=>we.createElement(we.Fragment,null,we.createElement("path",{id:e,style:d,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:f,markerStart:m}),h&&we.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:h,className:"react-flow__edge-interaction"}),s&&Oi(n)&&Oi(r)?we.createElement(dY,{x:n,y:r,label:s,labelStyle:i,labelShowBg:l,labelBgStyle:o,labelBgPadding:c,labelBgBorderRadius:u}):null);_h.displayName="BaseEdge";function Jd(e,t,n){return n===void 0?n:r=>{const s=t().edges.find(i=>i.id===e);s&&n(r,{...s})}}function qA({sourceX:e,sourceY:t,targetX:n,targetY:r}){const s=Math.abs(n-e)/2,i=n<e?n+s:n-s,l=Math.abs(r-t)/2,o=r<t?r+l:r-l;return[i,o,s,l]}function HA({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:s,sourceControlY:i,targetControlX:l,targetControlY:o}){const c=e*.125+s*.375+l*.375+n*.125,u=t*.125+i*.375+o*.375+r*.125,d=Math.abs(c-e),f=Math.abs(u-t);return[c,u,d,f]}var ac;(function(e){e.Strict="strict",e.Loose="loose"})(ac||(ac={}));var Hl;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Hl||(Hl={}));var th;(function(e){e.Partial="partial",e.Full="full"})(th||(th={}));var Go;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(Go||(Go={}));var vi;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(vi||(vi={}));var zt;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(zt||(zt={}));function xN({pos:e,x1:t,y1:n,x2:r,y2:s}){return e===zt.Left||e===zt.Right?[.5*(t+r),n]:[t,.5*(n+s)]}function WA({sourceX:e,sourceY:t,sourcePosition:n=zt.Bottom,targetX:r,targetY:s,targetPosition:i=zt.Top}){const[l,o]=xN({pos:n,x1:e,y1:t,x2:r,y2:s}),[c,u]=xN({pos:i,x1:r,y1:s,x2:e,y2:t}),[d,f,m,h]=HA({sourceX:e,sourceY:t,targetX:r,targetY:s,sourceControlX:l,sourceControlY:o,targetControlX:c,targetControlY:u});return[`M${e},${t} C${l},${o} ${c},${u} ${r},${s}`,d,f,m,h]}const Mb=Y.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:s=zt.Bottom,targetPosition:i=zt.Top,label:l,labelStyle:o,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:m,markerEnd:h,markerStart:x,interactionWidth:y})=>{const[p,g,w]=WA({sourceX:e,sourceY:t,sourcePosition:s,targetX:n,targetY:r,targetPosition:i});return we.createElement(_h,{path:p,labelX:g,labelY:w,label:l,labelStyle:o,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:m,markerEnd:h,markerStart:x,interactionWidth:y})});Mb.displayName="SimpleBezierEdge";const yN={[zt.Left]:{x:-1,y:0},[zt.Right]:{x:1,y:0},[zt.Top]:{x:0,y:-1},[zt.Bottom]:{x:0,y:1}},gY=({source:e,sourcePosition:t=zt.Bottom,target:n})=>t===zt.Left||t===zt.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},bN=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function xY({source:e,sourcePosition:t=zt.Bottom,target:n,targetPosition:r=zt.Top,center:s,offset:i}){const l=yN[t],o=yN[r],c={x:e.x+l.x*i,y:e.y+l.y*i},u={x:n.x+o.x*i,y:n.y+o.y*i},d=gY({source:c,sourcePosition:t,target:u}),f=d.x!==0?"x":"y",m=d[f];let h=[],x,y;const p={x:0,y:0},g={x:0,y:0},[w,v,N,A]=qA({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(l[f]*o[f]===-1){x=s.x??w,y=s.y??v;const U=[{x,y:c.y},{x,y:u.y}],M=[{x:c.x,y},{x:u.x,y}];l[f]===m?h=f==="x"?U:M:h=f==="x"?M:U}else{const U=[{x:c.x,y:u.y}],M=[{x:u.x,y:c.y}];if(f==="x"?h=l.x===m?M:U:h=l.y===m?U:M,t===r){const B=Math.abs(e[f]-n[f]);if(B<=i){const $=Math.min(i-1,i-B);l[f]===m?p[f]=(c[f]>e[f]?-1:1)*$:g[f]=(u[f]>n[f]?-1:1)*$}}if(t!==r){const B=f==="x"?"y":"x",$=l[f]===o[B],D=c[B]>u[B],L=c[B]<u[B];(l[f]===1&&(!$&&D||$&&L)||l[f]!==1&&(!$&&L||$&&D))&&(h=f==="x"?U:M)}const S={x:c.x+p.x,y:c.y+p.y},C={x:u.x+g.x,y:u.y+g.y},_=Math.max(Math.abs(S.x-h[0].x),Math.abs(C.x-h[0].x)),T=Math.max(Math.abs(S.y-h[0].y),Math.abs(C.y-h[0].y));_>=T?(x=(S.x+C.x)/2,y=h[0].y):(x=h[0].x,y=(S.y+C.y)/2)}return[[e,{x:c.x+p.x,y:c.y+p.y},...h,{x:u.x+g.x,y:u.y+g.y},n],x,y,N,A]}function yY(e,t,n,r){const s=Math.min(bN(e,t)/2,bN(t,n)/2,r),{x:i,y:l}=t;if(e.x===i&&i===n.x||e.y===l&&l===n.y)return`L${i} ${l}`;if(e.y===l){const u=e.x<n.x?-1:1,d=e.y<n.y?1:-1;return`L ${i+s*u},${l}Q ${i},${l} ${i},${l+s*d}`}const o=e.x<n.x?1:-1,c=e.y<n.y?-1:1;return`L ${i},${l+s*c}Q ${i},${l} ${i+s*o},${l}`}function A2({sourceX:e,sourceY:t,sourcePosition:n=zt.Bottom,targetX:r,targetY:s,targetPosition:i=zt.Top,borderRadius:l=5,centerX:o,centerY:c,offset:u=20}){const[d,f,m,h,x]=xY({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:s},targetPosition:i,center:{x:o,y:c},offset:u});return[d.reduce((p,g,w)=>{let v="";return w>0&&w<d.length-1?v=yY(d[w-1],g,d[w+1],l):v=`${w===0?"M":"L"}${g.x} ${g.y}`,p+=v,p},""),f,m,h,x]}const cg=Y.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,label:s,labelStyle:i,labelShowBg:l,labelBgStyle:o,labelBgPadding:c,labelBgBorderRadius:u,style:d,sourcePosition:f=zt.Bottom,targetPosition:m=zt.Top,markerEnd:h,markerStart:x,pathOptions:y,interactionWidth:p})=>{const[g,w,v]=A2({sourceX:e,sourceY:t,sourcePosition:f,targetX:n,targetY:r,targetPosition:m,borderRadius:y==null?void 0:y.borderRadius,offset:y==null?void 0:y.offset});return we.createElement(_h,{path:g,labelX:w,labelY:v,label:s,labelStyle:i,labelShowBg:l,labelBgStyle:o,labelBgPadding:c,labelBgBorderRadius:u,style:d,markerEnd:h,markerStart:x,interactionWidth:p})});cg.displayName="SmoothStepEdge";const Rb=Y.memo(e=>{var t;return we.createElement(cg,{...e,pathOptions:Y.useMemo(()=>{var n;return{borderRadius:0,offset:(n=e.pathOptions)==null?void 0:n.offset}},[(t=e.pathOptions)==null?void 0:t.offset])})});Rb.displayName="StepEdge";function bY({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[s,i,l,o]=qA({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,s,i,l,o]}const $b=Y.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,label:s,labelStyle:i,labelShowBg:l,labelBgStyle:o,labelBgPadding:c,labelBgBorderRadius:u,style:d,markerEnd:f,markerStart:m,interactionWidth:h})=>{const[x,y,p]=bY({sourceX:e,sourceY:t,targetX:n,targetY:r});return we.createElement(_h,{path:x,labelX:y,labelY:p,label:s,labelStyle:i,labelShowBg:l,labelBgStyle:o,labelBgPadding:c,labelBgBorderRadius:u,style:d,markerEnd:f,markerStart:m,interactionWidth:h})});$b.displayName="StraightEdge";function jm(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function vN({pos:e,x1:t,y1:n,x2:r,y2:s,c:i}){switch(e){case zt.Left:return[t-jm(t-r,i),n];case zt.Right:return[t+jm(r-t,i),n];case zt.Top:return[t,n-jm(n-s,i)];case zt.Bottom:return[t,n+jm(s-n,i)]}}function Fb({sourceX:e,sourceY:t,sourcePosition:n=zt.Bottom,targetX:r,targetY:s,targetPosition:i=zt.Top,curvature:l=.25}){const[o,c]=vN({pos:n,x1:e,y1:t,x2:r,y2:s,c:l}),[u,d]=vN({pos:i,x1:r,y1:s,x2:e,y2:t,c:l}),[f,m,h,x]=HA({sourceX:e,sourceY:t,targetX:r,targetY:s,sourceControlX:o,sourceControlY:c,targetControlX:u,targetControlY:d});return[`M${e},${t} C${o},${c} ${u},${d} ${r},${s}`,f,m,h,x]}const n0=Y.memo(({sourceX:e,sourceY:t,targetX:n,targetY:r,sourcePosition:s=zt.Bottom,targetPosition:i=zt.Top,label:l,labelStyle:o,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:m,markerEnd:h,markerStart:x,pathOptions:y,interactionWidth:p})=>{const[g,w,v]=Fb({sourceX:e,sourceY:t,sourcePosition:s,targetX:n,targetY:r,targetPosition:i,curvature:y==null?void 0:y.curvature});return we.createElement(_h,{path:g,labelX:w,labelY:v,label:l,labelStyle:o,labelShowBg:c,labelBgStyle:u,labelBgPadding:d,labelBgBorderRadius:f,style:m,markerEnd:h,markerStart:x,interactionWidth:p})});n0.displayName="BezierEdge";const Ob=Y.createContext(null),vY=Ob.Provider;Ob.Consumer;const wY=()=>Y.useContext(Ob),NY=e=>"id"in e&&"source"in e&&"target"in e,jY=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`reactflow__edge-${e}${t||""}-${n}${r||""}`,k2=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(r=>`${r}=${e[r]}`).join("&")}`,SY=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),VA=(e,t)=>{if(!e.source||!e.target)return t;let n;return NY(e)?n={...e}:n={...e,id:jY(e)},SY(n,t)?t:t.concat(n)},E2=({x:e,y:t},[n,r,s],i,[l,o])=>{const c={x:(e-n)/s,y:(t-r)/s};return i?{x:l*Math.round(c.x/l),y:o*Math.round(c.y/o)}:c},GA=({x:e,y:t},[n,r,s])=>({x:e*s+n,y:t*s+r}),Jl=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const n=(e.width??0)*t[0],r=(e.height??0)*t[1],s={x:e.position.x-n,y:e.position.y-r};return{...s,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-n,y:e.positionAbsolute.y-r}:s}},ug=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,s)=>{const{x:i,y:l}=Jl(s,t).positionAbsolute;return DA(r,eh({x:i,y:l,width:s.width||0,height:s.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return BA(n)},YA=(e,t,[n,r,s]=[0,0,1],i=!1,l=!1,o=[0,0])=>{const c={x:(t.x-n)/s,y:(t.y-r)/s,width:t.width/s,height:t.height/s},u=[];return e.forEach(d=>{const{width:f,height:m,selectable:h=!0,hidden:x=!1}=d;if(l&&!h||x)return!1;const{positionAbsolute:y}=Jl(d,o),p={x:y.x,y:y.y,width:f||0,height:m||0},g=S2(c,p),w=typeof f>"u"||typeof m>"u"||f===null||m===null,v=i&&g>0,N=(f||0)*(m||0);(w||v||g>=N||d.dragging)&&u.push(d)}),u},JA=(e,t)=>{const n=e.map(r=>r.id);return t.filter(r=>n.includes(r.source)||n.includes(r.target))},ZA=(e,t,n,r,s,i=.1)=>{const l=t/(e.width*(1+i)),o=n/(e.height*(1+i)),c=Math.min(l,o),u=Wu(c,r,s),d=e.x+e.width/2,f=e.y+e.height/2,m=t/2-d*u,h=n/2-f*u;return{x:m,y:h,zoom:u}},$l=(e,t=0)=>e.transition().duration(t);function wN(e,t,n,r){return(t[n]||[]).reduce((s,i)=>{var l,o;return`${e.id}-${i.id}-${n}`!==r&&s.push({id:i.id||null,type:n,nodeId:e.id,x:(((l=e.positionAbsolute)==null?void 0:l.x)??0)+i.x+i.width/2,y:(((o=e.positionAbsolute)==null?void 0:o.y)??0)+i.y+i.height/2}),s},[])}function _Y(e,t,n,r,s,i){const{x:l,y:o}=Xo(e),u=t.elementsFromPoint(l,o).find(x=>x.classList.contains("react-flow__handle"));if(u){const x=u.getAttribute("data-nodeid");if(x){const y=Db(void 0,u),p=u.getAttribute("data-handleid"),g=i({nodeId:x,id:p,type:y});if(g){const w=s.find(v=>v.nodeId===x&&v.type===y&&v.id===p);return{handle:{id:p,type:y,nodeId:x,x:(w==null?void 0:w.x)||n.x,y:(w==null?void 0:w.y)||n.y},validHandleResult:g}}}}let d=[],f=1/0;if(s.forEach(x=>{const y=Math.sqrt((x.x-n.x)**2+(x.y-n.y)**2);if(y<=r){const p=i(x);y<=f&&(y<f?d=[{handle:x,validHandleResult:p}]:y===f&&d.push({handle:x,validHandleResult:p}),f=y)}}),!d.length)return{handle:null,validHandleResult:XA()};if(d.length===1)return d[0];const m=d.some(({validHandleResult:x})=>x.isValid),h=d.some(({handle:x})=>x.type==="target");return d.find(({handle:x,validHandleResult:y})=>h?x.type==="target":m?y.isValid:!0)||d[0]}const AY={source:null,target:null,sourceHandle:null,targetHandle:null},XA=()=>({handleDomNode:null,isValid:!1,connection:AY,endHandle:null});function KA(e,t,n,r,s,i,l){const o=s==="target",c=l.querySelector(`.react-flow__handle[data-id="${e==null?void 0:e.nodeId}-${e==null?void 0:e.id}-${e==null?void 0:e.type}"]`),u={...XA(),handleDomNode:c};if(c){const d=Db(void 0,c),f=c.getAttribute("data-nodeid"),m=c.getAttribute("data-handleid"),h=c.classList.contains("connectable"),x=c.classList.contains("connectableend"),y={source:o?f:n,sourceHandle:o?m:r,target:o?n:f,targetHandle:o?r:m};u.connection=y,h&&x&&(t===ac.Strict?o&&d==="source"||!o&&d==="target":f!==n||m!==r)&&(u.endHandle={nodeId:f,handleId:m,type:d},u.isValid=i(y))}return u}function kY({nodes:e,nodeId:t,handleId:n,handleType:r}){return e.reduce((s,i)=>{if(i[Cr]){const{handleBounds:l}=i[Cr];let o=[],c=[];l&&(o=wN(i,l,"source",`${t}-${n}-${r}`),c=wN(i,l,"target",`${t}-${n}-${r}`)),s.push(...o,...c)}return s},[])}function Db(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function M1(e){e==null||e.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function EY(e,t){let n=null;return t?n="valid":e&&!t&&(n="invalid"),n}function QA({event:e,handleId:t,nodeId:n,onConnect:r,isTarget:s,getState:i,setState:l,isValidConnection:o,edgeUpdaterType:c,onReconnectEnd:u}){const d=OA(e.target),{connectionMode:f,domNode:m,autoPanOnConnect:h,connectionRadius:x,onConnectStart:y,panBy:p,getNodes:g,cancelConnection:w}=i();let v=0,N;const{x:A,y:P}=Xo(e),U=d==null?void 0:d.elementFromPoint(A,P),M=Db(c,U),S=m==null?void 0:m.getBoundingClientRect();if(!S||!M)return;let C,_=Xo(e,S),T=!1,B=null,$=!1,D=null;const L=kY({nodes:g(),nodeId:n,handleId:t,handleType:M}),O=()=>{if(!h)return;const[H,V]=FA(_,S);p({x:H,y:V}),v=requestAnimationFrame(O)};l({connectionPosition:_,connectionStatus:null,connectionNodeId:n,connectionHandleId:t,connectionHandleType:M,connectionStartHandle:{nodeId:n,handleId:t,type:M},connectionEndHandle:null}),y==null||y(e,{nodeId:n,handleId:t,handleType:M});function W(H){const{transform:V}=i();_=Xo(H,S);const{handle:R,validHandleResult:q}=_Y(H,d,E2(_,V,!1,[1,1]),x,L,F=>KA(F,f,n,t,s?"target":"source",o,d));if(N=R,T||(O(),T=!0),D=q.handleDomNode,B=q.connection,$=q.isValid,l({connectionPosition:N&&$?GA({x:N.x,y:N.y},V):_,connectionStatus:EY(!!N,$),connectionEndHandle:q.endHandle}),!N&&!$&&!D)return M1(C);B.source!==B.target&&D&&(M1(C),C=D,D.classList.add("connecting","react-flow__handle-connecting"),D.classList.toggle("valid",$),D.classList.toggle("react-flow__handle-valid",$))}function E(H){var V,R;(N||D)&&B&&$&&(r==null||r(B)),(R=(V=i()).onConnectEnd)==null||R.call(V,H),c&&(u==null||u(H)),M1(C),w(),cancelAnimationFrame(v),T=!1,$=!1,B=null,D=null,d.removeEventListener("mousemove",W),d.removeEventListener("mouseup",E),d.removeEventListener("touchmove",W),d.removeEventListener("touchend",E)}d.addEventListener("mousemove",W),d.addEventListener("mouseup",E),d.addEventListener("touchmove",W),d.addEventListener("touchend",E)}const NN=()=>!0,CY=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),PY=(e,t,n)=>r=>{const{connectionStartHandle:s,connectionEndHandle:i,connectionClickStartHandle:l}=r;return{connecting:(s==null?void 0:s.nodeId)===e&&(s==null?void 0:s.handleId)===t&&(s==null?void 0:s.type)===n||(i==null?void 0:i.nodeId)===e&&(i==null?void 0:i.handleId)===t&&(i==null?void 0:i.type)===n,clickConnecting:(l==null?void 0:l.nodeId)===e&&(l==null?void 0:l.handleId)===t&&(l==null?void 0:l.type)===n}},ek=Y.forwardRef(({type:e="source",position:t=zt.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:s=!0,isConnectableEnd:i=!0,id:l,onConnect:o,children:c,className:u,onMouseDown:d,onTouchStart:f,...m},h)=>{var S,C;const x=l||null,y=e==="target",p=ss(),g=wY(),{connectOnClick:w,noPanClassName:v}=cr(CY,ls),{connecting:N,clickConnecting:A}=cr(PY(g,x,e),ls);g||(C=(S=p.getState()).onError)==null||C.call(S,"010",xo.error010());const P=_=>{const{defaultEdgeOptions:T,onConnect:B,hasDefaultEdges:$}=p.getState(),D={...T,..._};if($){const{edges:L,setEdges:O}=p.getState();O(VA(D,L))}B==null||B(D),o==null||o(D)},U=_=>{if(!g)return;const T=UA(_);s&&(T&&_.button===0||!T)&&QA({event:_,handleId:x,nodeId:g,onConnect:P,isTarget:y,getState:p.getState,setState:p.setState,isValidConnection:n||p.getState().isValidConnection||NN}),T?d==null||d(_):f==null||f(_)},M=_=>{const{onClickConnectStart:T,onClickConnectEnd:B,connectionClickStartHandle:$,connectionMode:D,isValidConnection:L}=p.getState();if(!g||!$&&!s)return;if(!$){T==null||T(_,{nodeId:g,handleId:x,handleType:e}),p.setState({connectionClickStartHandle:{nodeId:g,type:e,handleId:x}});return}const O=OA(_.target),W=n||L||NN,{connection:E,isValid:H}=KA({nodeId:g,id:x,type:e},D,$.nodeId,$.handleId||null,$.type,W,O);H&&P(E),B==null||B(_),p.setState({connectionClickStartHandle:null})};return we.createElement("div",{"data-handleid":x,"data-nodeid":g,"data-handlepos":t,"data-id":`${g}-${x}-${e}`,className:ws(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",v,u,{source:!y,target:y,connectable:r,connectablestart:s,connectableend:i,connecting:A,connectionindicator:r&&(s&&!N||i&&N)}]),onMouseDown:U,onTouchStart:U,onClick:w?M:void 0,ref:h,...m},c)});ek.displayName="Handle";var Di=Y.memo(ek);const tk=({data:e,isConnectable:t,targetPosition:n=zt.Top,sourcePosition:r=zt.Bottom})=>we.createElement(we.Fragment,null,we.createElement(Di,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,we.createElement(Di,{type:"source",position:r,isConnectable:t}));tk.displayName="DefaultNode";var C2=Y.memo(tk);const nk=({data:e,isConnectable:t,sourcePosition:n=zt.Bottom})=>we.createElement(we.Fragment,null,e==null?void 0:e.label,we.createElement(Di,{type:"source",position:n,isConnectable:t}));nk.displayName="InputNode";var rk=Y.memo(nk);const sk=({data:e,isConnectable:t,targetPosition:n=zt.Top})=>we.createElement(we.Fragment,null,we.createElement(Di,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label);sk.displayName="OutputNode";var ik=Y.memo(sk);const Bb=()=>null;Bb.displayName="GroupNode";const IY=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),Sm=e=>e.id;function TY(e,t){return ls(e.selectedNodes.map(Sm),t.selectedNodes.map(Sm))&&ls(e.selectedEdges.map(Sm),t.selectedEdges.map(Sm))}const ak=Y.memo(({onSelectionChange:e})=>{const t=ss(),{selectedNodes:n,selectedEdges:r}=cr(IY,TY);return Y.useEffect(()=>{const s={nodes:n,edges:r};e==null||e(s),t.getState().onSelectionChange.forEach(i=>i(s))},[n,r,e]),null});ak.displayName="SelectionListener";const LY=e=>!!e.onSelectionChange;function MY({onSelectionChange:e}){const t=cr(LY);return e||t?we.createElement(ak,{onSelectionChange:e}):null}const RY=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function Vc(e,t){Y.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function kn(e,t,n){Y.useEffect(()=>{typeof t<"u"&&n({[e]:t})},[t])}const $Y=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:s,onConnectStart:i,onConnectEnd:l,onClickConnectStart:o,onClickConnectEnd:c,nodesDraggable:u,nodesConnectable:d,nodesFocusable:f,edgesFocusable:m,edgesUpdatable:h,elevateNodesOnSelect:x,minZoom:y,maxZoom:p,nodeExtent:g,onNodesChange:w,onEdgesChange:v,elementsSelectable:N,connectionMode:A,snapGrid:P,snapToGrid:U,translateExtent:M,connectOnClick:S,defaultEdgeOptions:C,fitView:_,fitViewOptions:T,onNodesDelete:B,onEdgesDelete:$,onNodeDrag:D,onNodeDragStart:L,onNodeDragStop:O,onSelectionDrag:W,onSelectionDragStart:E,onSelectionDragStop:H,noPanClassName:V,nodeOrigin:R,rfId:q,autoPanOnConnect:F,autoPanOnNodeDrag:G,onError:ee,connectionRadius:ae,isValidConnection:re,nodeDragThreshold:Q})=>{const{setNodes:fe,setEdges:Se,setDefaultNodesAndEdges:oe,setMinZoom:pe,setMaxZoom:me,setTranslateExtent:ne,setNodeExtent:it,reset:$e}=cr(RY,ls),Oe=ss();return Y.useEffect(()=>{const qe=r==null?void 0:r.map(gt=>({...gt,...C}));return oe(n,qe),()=>{$e()}},[]),kn("defaultEdgeOptions",C,Oe.setState),kn("connectionMode",A,Oe.setState),kn("onConnect",s,Oe.setState),kn("onConnectStart",i,Oe.setState),kn("onConnectEnd",l,Oe.setState),kn("onClickConnectStart",o,Oe.setState),kn("onClickConnectEnd",c,Oe.setState),kn("nodesDraggable",u,Oe.setState),kn("nodesConnectable",d,Oe.setState),kn("nodesFocusable",f,Oe.setState),kn("edgesFocusable",m,Oe.setState),kn("edgesUpdatable",h,Oe.setState),kn("elementsSelectable",N,Oe.setState),kn("elevateNodesOnSelect",x,Oe.setState),kn("snapToGrid",U,Oe.setState),kn("snapGrid",P,Oe.setState),kn("onNodesChange",w,Oe.setState),kn("onEdgesChange",v,Oe.setState),kn("connectOnClick",S,Oe.setState),kn("fitViewOnInit",_,Oe.setState),kn("fitViewOnInitOptions",T,Oe.setState),kn("onNodesDelete",B,Oe.setState),kn("onEdgesDelete",$,Oe.setState),kn("onNodeDrag",D,Oe.setState),kn("onNodeDragStart",L,Oe.setState),kn("onNodeDragStop",O,Oe.setState),kn("onSelectionDrag",W,Oe.setState),kn("onSelectionDragStart",E,Oe.setState),kn("onSelectionDragStop",H,Oe.setState),kn("noPanClassName",V,Oe.setState),kn("nodeOrigin",R,Oe.setState),kn("rfId",q,Oe.setState),kn("autoPanOnConnect",F,Oe.setState),kn("autoPanOnNodeDrag",G,Oe.setState),kn("onError",ee,Oe.setState),kn("connectionRadius",ae,Oe.setState),kn("isValidConnection",re,Oe.setState),kn("nodeDragThreshold",Q,Oe.setState),Vc(e,fe),Vc(t,Se),Vc(y,pe),Vc(p,me),Vc(M,ne),Vc(g,it),null},jN={display:"none"},FY={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},ok="react-flow__node-desc",lk="react-flow__edge-desc",OY="react-flow__aria-live",DY=e=>e.ariaLiveMessage;function BY({rfId:e}){const t=cr(DY);return we.createElement("div",{id:`${OY}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:FY},t)}function zY({rfId:e,disableKeyboardA11y:t}){return we.createElement(we.Fragment,null,we.createElement("div",{id:`${ok}-${e}`,style:jN},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),we.createElement("div",{id:`${lk}-${e}`,style:jN},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&we.createElement(BY,{rfId:e}))}var nh=(e=null,t={actInsideInputWithModifier:!0})=>{const[n,r]=Y.useState(!1),s=Y.useRef(!1),i=Y.useRef(new Set([])),[l,o]=Y.useMemo(()=>{if(e!==null){const u=(Array.isArray(e)?e:[e]).filter(f=>typeof f=="string").map(f=>f.split("+")),d=u.reduce((f,m)=>f.concat(...m),[]);return[u,d]}return[[],[]]},[e]);return Y.useEffect(()=>{const c=typeof document<"u"?document:null,u=(t==null?void 0:t.target)||c;if(e!==null){const d=h=>{if(s.current=h.ctrlKey||h.metaKey||h.shiftKey,(!s.current||s.current&&!t.actInsideInputWithModifier)&&_2(h))return!1;const y=_N(h.code,o);i.current.add(h[y]),SN(l,i.current,!1)&&(h.preventDefault(),r(!0))},f=h=>{if((!s.current||s.current&&!t.actInsideInputWithModifier)&&_2(h))return!1;const y=_N(h.code,o);SN(l,i.current,!0)?(r(!1),i.current.clear()):i.current.delete(h[y]),h.key==="Meta"&&i.current.clear(),s.current=!1},m=()=>{i.current.clear(),r(!1)};return u==null||u.addEventListener("keydown",d),u==null||u.addEventListener("keyup",f),window.addEventListener("blur",m),()=>{u==null||u.removeEventListener("keydown",d),u==null||u.removeEventListener("keyup",f),window.removeEventListener("blur",m)}}},[e,r]),n};function SN(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(s=>t.has(s)))}function _N(e,t){return t.includes(e)?"code":"key"}function ck(e,t,n,r){var o,c;const s=e.parentNode||e.parentId;if(!s)return n;const i=t.get(s),l=Jl(i,r);return ck(i,t,{x:(n.x??0)+l.x,y:(n.y??0)+l.y,z:(((o=i[Cr])==null?void 0:o.z)??0)>(n.z??0)?((c=i[Cr])==null?void 0:c.z)??0:n.z??0},r)}function uk(e,t,n){e.forEach(r=>{var i;const s=r.parentNode||r.parentId;if(s&&!e.has(s))throw new Error(`Parent node ${s} not found`);if(s||n!=null&&n[r.id]){const{x:l,y:o,z:c}=ck(r,e,{...r.position,z:((i=r[Cr])==null?void 0:i.z)??0},t);r.positionAbsolute={x:l,y:o},r[Cr].z=c,n!=null&&n[r.id]&&(r[Cr].isParent=!0)}})}function R1(e,t,n,r){const s=new Map,i={},l=r?1e3:0;return e.forEach(o=>{var h;const c=(Oi(o.zIndex)?o.zIndex:0)+(o.selected?l:0),u=t.get(o.id),d={...o,positionAbsolute:{x:o.position.x,y:o.position.y}},f=o.parentNode||o.parentId;f&&(i[f]=!0);const m=(u==null?void 0:u.type)&&(u==null?void 0:u.type)!==o.type;Object.defineProperty(d,Cr,{enumerable:!1,value:{handleBounds:m||(h=u==null?void 0:u[Cr])==null?void 0:h.handleBounds,z:c}}),s.set(o.id,d)}),uk(s,n,i),s}function dk(e,t={}){const{getNodes:n,width:r,height:s,minZoom:i,maxZoom:l,d3Zoom:o,d3Selection:c,fitViewOnInitDone:u,fitViewOnInit:d,nodeOrigin:f}=e(),m=t.initial&&!u&&d;if(o&&c&&(m||!t.initial)){const x=n().filter(p=>{var w;const g=t.includeHiddenNodes?p.width&&p.height:!p.hidden;return(w=t.nodes)!=null&&w.length?g&&t.nodes.some(v=>v.id===p.id):g}),y=x.every(p=>p.width&&p.height);if(x.length>0&&y){const p=ug(x,f),{x:g,y:w,zoom:v}=ZA(p,r,s,t.minZoom??i,t.maxZoom??l,t.padding??.1),N=Wl.translate(g,w).scale(v);return typeof t.duration=="number"&&t.duration>0?o.transform($l(c,t.duration),N):o.transform(c,N),!0}}return!1}function UY(e,t){return e.forEach(n=>{const r=t.get(n.id);r&&t.set(r.id,{...r,[Cr]:r[Cr],selected:n.selected})}),new Map(t)}function qY(e,t){return t.map(n=>{const r=e.find(s=>s.id===n.id);return r&&(n.selected=r.selected),n})}function _m({changedNodes:e,changedEdges:t,get:n,set:r}){const{nodeInternals:s,edges:i,onNodesChange:l,onEdgesChange:o,hasDefaultNodes:c,hasDefaultEdges:u}=n();e!=null&&e.length&&(c&&r({nodeInternals:UY(e,s)}),l==null||l(e)),t!=null&&t.length&&(u&&r({edges:qY(t,i)}),o==null||o(t))}const Gc=()=>{},HY={zoomIn:Gc,zoomOut:Gc,zoomTo:Gc,getZoom:()=>1,setViewport:Gc,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:Gc,fitBounds:Gc,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},WY=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),VY=()=>{const e=ss(),{d3Zoom:t,d3Selection:n}=cr(WY,ls);return Y.useMemo(()=>n&&t?{zoomIn:s=>t.scaleBy($l(n,s==null?void 0:s.duration),1.2),zoomOut:s=>t.scaleBy($l(n,s==null?void 0:s.duration),1/1.2),zoomTo:(s,i)=>t.scaleTo($l(n,i==null?void 0:i.duration),s),getZoom:()=>e.getState().transform[2],setViewport:(s,i)=>{const[l,o,c]=e.getState().transform,u=Wl.translate(s.x??l,s.y??o).scale(s.zoom??c);t.transform($l(n,i==null?void 0:i.duration),u)},getViewport:()=>{const[s,i,l]=e.getState().transform;return{x:s,y:i,zoom:l}},fitView:s=>dk(e.getState,s),setCenter:(s,i,l)=>{const{width:o,height:c,maxZoom:u}=e.getState(),d=typeof(l==null?void 0:l.zoom)<"u"?l.zoom:u,f=o/2-s*d,m=c/2-i*d,h=Wl.translate(f,m).scale(d);t.transform($l(n,l==null?void 0:l.duration),h)},fitBounds:(s,i)=>{const{width:l,height:o,minZoom:c,maxZoom:u}=e.getState(),{x:d,y:f,zoom:m}=ZA(s,l,o,c,u,(i==null?void 0:i.padding)??.1),h=Wl.translate(d,f).scale(m);t.transform($l(n,i==null?void 0:i.duration),h)},project:s=>{const{transform:i,snapToGrid:l,snapGrid:o}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),E2(s,i,l,o)},screenToFlowPosition:s=>{const{transform:i,snapToGrid:l,snapGrid:o,domNode:c}=e.getState();if(!c)return s;const{x:u,y:d}=c.getBoundingClientRect(),f={x:s.x-u,y:s.y-d};return E2(f,i,l,o)},flowToScreenPosition:s=>{const{transform:i,domNode:l}=e.getState();if(!l)return s;const{x:o,y:c}=l.getBoundingClientRect(),u=GA(s,i);return{x:u.x+o,y:u.y+c}},viewportInitialized:!0}:HY,[t,n])};function zb(){const e=VY(),t=ss(),n=Y.useCallback(()=>t.getState().getNodes().map(y=>({...y})),[]),r=Y.useCallback(y=>t.getState().nodeInternals.get(y),[]),s=Y.useCallback(()=>{const{edges:y=[]}=t.getState();return y.map(p=>({...p}))},[]),i=Y.useCallback(y=>{const{edges:p=[]}=t.getState();return p.find(g=>g.id===y)},[]),l=Y.useCallback(y=>{const{getNodes:p,setNodes:g,hasDefaultNodes:w,onNodesChange:v}=t.getState(),N=p(),A=typeof y=="function"?y(N):y;if(w)g(A);else if(v){const P=A.length===0?N.map(U=>({type:"remove",id:U.id})):A.map(U=>({item:U,type:"reset"}));v(P)}},[]),o=Y.useCallback(y=>{const{edges:p=[],setEdges:g,hasDefaultEdges:w,onEdgesChange:v}=t.getState(),N=typeof y=="function"?y(p):y;if(w)g(N);else if(v){const A=N.length===0?p.map(P=>({type:"remove",id:P.id})):N.map(P=>({item:P,type:"reset"}));v(A)}},[]),c=Y.useCallback(y=>{const p=Array.isArray(y)?y:[y],{getNodes:g,setNodes:w,hasDefaultNodes:v,onNodesChange:N}=t.getState();if(v){const P=[...g(),...p];w(P)}else if(N){const A=p.map(P=>({item:P,type:"add"}));N(A)}},[]),u=Y.useCallback(y=>{const p=Array.isArray(y)?y:[y],{edges:g=[],setEdges:w,hasDefaultEdges:v,onEdgesChange:N}=t.getState();if(v)w([...g,...p]);else if(N){const A=p.map(P=>({item:P,type:"add"}));N(A)}},[]),d=Y.useCallback(()=>{const{getNodes:y,edges:p=[],transform:g}=t.getState(),[w,v,N]=g;return{nodes:y().map(A=>({...A})),edges:p.map(A=>({...A})),viewport:{x:w,y:v,zoom:N}}},[]),f=Y.useCallback(({nodes:y,edges:p})=>{const{nodeInternals:g,getNodes:w,edges:v,hasDefaultNodes:N,hasDefaultEdges:A,onNodesDelete:P,onEdgesDelete:U,onNodesChange:M,onEdgesChange:S}=t.getState(),C=(y||[]).map(D=>D.id),_=(p||[]).map(D=>D.id),T=w().reduce((D,L)=>{const O=L.parentNode||L.parentId,W=!C.includes(L.id)&&O&&D.find(H=>H.id===O);return(typeof L.deletable=="boolean"?L.deletable:!0)&&(C.includes(L.id)||W)&&D.push(L),D},[]),B=v.filter(D=>typeof D.deletable=="boolean"?D.deletable:!0),$=B.filter(D=>_.includes(D.id));if(T||$){const D=JA(T,B),L=[...$,...D],O=L.reduce((W,E)=>(W.includes(E.id)||W.push(E.id),W),[]);if((A||N)&&(A&&t.setState({edges:v.filter(W=>!O.includes(W.id))}),N&&(T.forEach(W=>{g.delete(W.id)}),t.setState({nodeInternals:new Map(g)}))),O.length>0&&(U==null||U(L),S&&S(O.map(W=>({id:W,type:"remove"})))),T.length>0&&(P==null||P(T),M)){const W=T.map(E=>({id:E.id,type:"remove"}));M(W)}}},[]),m=Y.useCallback(y=>{const p=hY(y),g=p?null:t.getState().nodeInternals.get(y.id);return!p&&!g?[null,null,p]:[p?y:gN(g),g,p]},[]),h=Y.useCallback((y,p=!0,g)=>{const[w,v,N]=m(y);return w?(g||t.getState().getNodes()).filter(A=>{if(!N&&(A.id===v.id||!A.positionAbsolute))return!1;const P=gN(A),U=S2(P,w);return p&&U>0||U>=w.width*w.height}):[]},[]),x=Y.useCallback((y,p,g=!0)=>{const[w]=m(y);if(!w)return!1;const v=S2(w,p);return g&&v>0||v>=w.width*w.height},[]);return Y.useMemo(()=>({...e,getNodes:n,getNode:r,getEdges:s,getEdge:i,setNodes:l,setEdges:o,addNodes:c,addEdges:u,toObject:d,deleteElements:f,getIntersectingNodes:h,isNodeIntersecting:x}),[e,n,r,s,i,l,o,c,u,d,f,h,x])}const GY={actInsideInputWithModifier:!1};var YY=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const n=ss(),{deleteElements:r}=zb(),s=nh(e,GY),i=nh(t);Y.useEffect(()=>{if(s){const{edges:l,getNodes:o}=n.getState(),c=o().filter(d=>d.selected),u=l.filter(d=>d.selected);r({nodes:c,edges:u}),n.setState({nodesSelectionActive:!1})}},[s]),Y.useEffect(()=>{n.setState({multiSelectionActive:i})},[i])};function JY(e){const t=ss();Y.useEffect(()=>{let n;const r=()=>{var i,l;if(!e.current)return;const s=Tb(e.current);(s.height===0||s.width===0)&&((l=(i=t.getState()).onError)==null||l.call(i,"004",xo.error004())),t.setState({width:s.width||500,height:s.height||500})};return r(),window.addEventListener("resize",r),e.current&&(n=new ResizeObserver(()=>r()),n.observe(e.current)),()=>{window.removeEventListener("resize",r),n&&e.current&&n.unobserve(e.current)}},[])}const Ub={position:"absolute",width:"100%",height:"100%",top:0,left:0},ZY=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,Am=e=>({x:e.x,y:e.y,zoom:e.k}),Yc=(e,t)=>e.target.closest(`.${t}`),AN=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),kN=e=>{const t=e.ctrlKey&&t0()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},XY=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),KY=({onMove:e,onMoveStart:t,onMoveEnd:n,onPaneContextMenu:r,zoomOnScroll:s=!0,zoomOnPinch:i=!0,panOnScroll:l=!1,panOnScrollSpeed:o=.5,panOnScrollMode:c=Hl.Free,zoomOnDoubleClick:u=!0,elementsSelectable:d,panOnDrag:f=!0,defaultViewport:m,translateExtent:h,minZoom:x,maxZoom:y,zoomActivationKeyCode:p,preventScrolling:g=!0,children:w,noWheelClassName:v,noPanClassName:N})=>{const A=Y.useRef(),P=ss(),U=Y.useRef(!1),M=Y.useRef(!1),S=Y.useRef(null),C=Y.useRef({x:0,y:0,zoom:0}),{d3Zoom:_,d3Selection:T,d3ZoomHandler:B,userSelectionActive:$}=cr(XY,ls),D=nh(p),L=Y.useRef(0),O=Y.useRef(!1),W=Y.useRef();return JY(S),Y.useEffect(()=>{if(S.current){const E=S.current.getBoundingClientRect(),H=h4().scaleExtent([x,y]).translateExtent(h),V=J2(S.current).call(H),R=Wl.translate(m.x,m.y).scale(Wu(m.zoom,x,y)),q=[[0,0],[E.width,E.height]],F=H.constrain()(R,q,h);H.transform(V,F),H.wheelDelta(kN),P.setState({d3Zoom:H,d3Selection:V,d3ZoomHandler:V.on("wheel.zoom"),transform:[F.x,F.y,F.k],domNode:S.current.closest(".react-flow")})}},[]),Y.useEffect(()=>{T&&_&&(l&&!D&&!$?T.on("wheel.zoom",E=>{if(Yc(E,v))return!1;E.preventDefault(),E.stopImmediatePropagation();const H=T.property("__zoom").k||1;if(E.ctrlKey&&i){const re=m4(E),Q=kN(E),fe=H*Math.pow(2,Q);_.scaleTo(T,fe,re,E);return}const V=E.deltaMode===1?20:1;let R=c===Hl.Vertical?0:E.deltaX*V,q=c===Hl.Horizontal?0:E.deltaY*V;!t0()&&E.shiftKey&&c!==Hl.Vertical&&(R=E.deltaY*V,q=0),_.translateBy(T,-(R/H)*o,-(q/H)*o,{internal:!0});const F=Am(T.property("__zoom")),{onViewportChangeStart:G,onViewportChange:ee,onViewportChangeEnd:ae}=P.getState();clearTimeout(W.current),O.current||(O.current=!0,t==null||t(E,F),G==null||G(F)),O.current&&(e==null||e(E,F),ee==null||ee(F),W.current=setTimeout(()=>{n==null||n(E,F),ae==null||ae(F),O.current=!1},150))},{passive:!1}):typeof B<"u"&&T.on("wheel.zoom",function(E,H){if(!g&&E.type==="wheel"&&!E.ctrlKey||Yc(E,v))return null;E.preventDefault(),B.call(this,E,H)},{passive:!1}))},[$,l,c,T,_,B,D,i,g,v,t,e,n]),Y.useEffect(()=>{_&&_.on("start",E=>{var R,q;if(!E.sourceEvent||E.sourceEvent.internal)return null;L.current=(R=E.sourceEvent)==null?void 0:R.button;const{onViewportChangeStart:H}=P.getState(),V=Am(E.transform);U.current=!0,C.current=V,((q=E.sourceEvent)==null?void 0:q.type)==="mousedown"&&P.setState({paneDragging:!0}),H==null||H(V),t==null||t(E.sourceEvent,V)})},[_,t]),Y.useEffect(()=>{_&&($&&!U.current?_.on("zoom",null):$||_.on("zoom",E=>{var V;const{onViewportChange:H}=P.getState();if(P.setState({transform:[E.transform.x,E.transform.y,E.transform.k]}),M.current=!!(r&&AN(f,L.current??0)),(e||H)&&!((V=E.sourceEvent)!=null&&V.internal)){const R=Am(E.transform);H==null||H(R),e==null||e(E.sourceEvent,R)}}))},[$,_,e,f,r]),Y.useEffect(()=>{_&&_.on("end",E=>{if(!E.sourceEvent||E.sourceEvent.internal)return null;const{onViewportChangeEnd:H}=P.getState();if(U.current=!1,P.setState({paneDragging:!1}),r&&AN(f,L.current??0)&&!M.current&&r(E.sourceEvent),M.current=!1,(n||H)&&ZY(C.current,E.transform)){const V=Am(E.transform);C.current=V,clearTimeout(A.current),A.current=setTimeout(()=>{H==null||H(V),n==null||n(E.sourceEvent,V)},l?150:0)}})},[_,l,f,n,r]),Y.useEffect(()=>{_&&_.filter(E=>{const H=D||s,V=i&&E.ctrlKey;if((f===!0||Array.isArray(f)&&f.includes(1))&&E.button===1&&E.type==="mousedown"&&(Yc(E,"react-flow__node")||Yc(E,"react-flow__edge")))return!0;if(!f&&!H&&!l&&!u&&!i||$||!u&&E.type==="dblclick"||Yc(E,v)&&E.type==="wheel"||Yc(E,N)&&(E.type!=="wheel"||l&&E.type==="wheel"&&!D)||!i&&E.ctrlKey&&E.type==="wheel"||!H&&!l&&!V&&E.type==="wheel"||!f&&(E.type==="mousedown"||E.type==="touchstart")||Array.isArray(f)&&!f.includes(E.button)&&E.type==="mousedown")return!1;const R=Array.isArray(f)&&f.includes(E.button)||!E.button||E.button<=1;return(!E.ctrlKey||E.type==="wheel")&&R})},[$,_,s,i,l,u,f,d,D]),we.createElement("div",{className:"react-flow__renderer",ref:S,style:Ub},w)},QY=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function eJ(){const{userSelectionActive:e,userSelectionRect:t}=cr(QY,ls);return e&&t?we.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function EN(e,t){const n=t.parentNode||t.parentId,r=e.find(s=>s.id===n);if(r){const s=t.position.x+t.width-r.width,i=t.position.y+t.height-r.height;if(s>0||i>0||t.position.x<0||t.position.y<0){if(r.style={...r.style},r.style.width=r.style.width??r.width,r.style.height=r.style.height??r.height,s>0&&(r.style.width+=s),i>0&&(r.style.height+=i),t.position.x<0){const l=Math.abs(t.position.x);r.position.x=r.position.x-l,r.style.width+=l,t.position.x=0}if(t.position.y<0){const l=Math.abs(t.position.y);r.position.y=r.position.y-l,r.style.height+=l,t.position.y=0}r.width=r.style.width,r.height=r.style.height}}}function fk(e,t){if(e.some(r=>r.type==="reset"))return e.filter(r=>r.type==="reset").map(r=>r.item);const n=e.filter(r=>r.type==="add").map(r=>r.item);return t.reduce((r,s)=>{const i=e.filter(o=>o.id===s.id);if(i.length===0)return r.push(s),r;const l={...s};for(const o of i)if(o)switch(o.type){case"select":{l.selected=o.selected;break}case"position":{typeof o.position<"u"&&(l.position=o.position),typeof o.positionAbsolute<"u"&&(l.positionAbsolute=o.positionAbsolute),typeof o.dragging<"u"&&(l.dragging=o.dragging),l.expandParent&&EN(r,l);break}case"dimensions":{typeof o.dimensions<"u"&&(l.width=o.dimensions.width,l.height=o.dimensions.height),typeof o.updateStyle<"u"&&(l.style={...l.style||{},...o.dimensions}),typeof o.resizing=="boolean"&&(l.resizing=o.resizing),l.expandParent&&EN(r,l);break}case"remove":return r}return r.push(l),r},n)}function hk(e,t){return fk(e,t)}function tJ(e,t){return fk(e,t)}const Wo=(e,t)=>({id:e,type:"select",selected:t});function lu(e,t){return e.reduce((n,r)=>{const s=t.includes(r.id);return!r.selected&&s?(r.selected=!0,n.push(Wo(r.id,!0))):r.selected&&!s&&(r.selected=!1,n.push(Wo(r.id,!1))),n},[])}const $1=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},nJ=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),mk=Y.memo(({isSelecting:e,selectionMode:t=th.Full,panOnDrag:n,onSelectionStart:r,onSelectionEnd:s,onPaneClick:i,onPaneContextMenu:l,onPaneScroll:o,onPaneMouseEnter:c,onPaneMouseMove:u,onPaneMouseLeave:d,children:f})=>{const m=Y.useRef(null),h=ss(),x=Y.useRef(0),y=Y.useRef(0),p=Y.useRef(),{userSelectionActive:g,elementsSelectable:w,dragging:v}=cr(nJ,ls),N=()=>{h.setState({userSelectionActive:!1,userSelectionRect:null}),x.current=0,y.current=0},A=B=>{i==null||i(B),h.getState().resetSelectedElements(),h.setState({nodesSelectionActive:!1})},P=B=>{if(Array.isArray(n)&&(n!=null&&n.includes(2))){B.preventDefault();return}l==null||l(B)},U=o?B=>o(B):void 0,M=B=>{const{resetSelectedElements:$,domNode:D}=h.getState();if(p.current=D==null?void 0:D.getBoundingClientRect(),!w||!e||B.button!==0||B.target!==m.current||!p.current)return;const{x:L,y:O}=Xo(B,p.current);$(),h.setState({userSelectionRect:{width:0,height:0,startX:L,startY:O,x:L,y:O}}),r==null||r(B)},S=B=>{const{userSelectionRect:$,nodeInternals:D,edges:L,transform:O,onNodesChange:W,onEdgesChange:E,nodeOrigin:H,getNodes:V}=h.getState();if(!e||!p.current||!$)return;h.setState({userSelectionActive:!0,nodesSelectionActive:!1});const R=Xo(B,p.current),q=$.startX??0,F=$.startY??0,G={...$,x:R.x<q?R.x:q,y:R.y<F?R.y:F,width:Math.abs(R.x-q),height:Math.abs(R.y-F)},ee=V(),ae=YA(D,G,O,t===th.Partial,!0,H),re=JA(ae,L).map(fe=>fe.id),Q=ae.map(fe=>fe.id);if(x.current!==Q.length){x.current=Q.length;const fe=lu(ee,Q);fe.length&&(W==null||W(fe))}if(y.current!==re.length){y.current=re.length;const fe=lu(L,re);fe.length&&(E==null||E(fe))}h.setState({userSelectionRect:G})},C=B=>{if(B.button!==0)return;const{userSelectionRect:$}=h.getState();!g&&$&&B.target===m.current&&(A==null||A(B)),h.setState({nodesSelectionActive:x.current>0}),N(),s==null||s(B)},_=B=>{g&&(h.setState({nodesSelectionActive:x.current>0}),s==null||s(B)),N()},T=w&&(e||g);return we.createElement("div",{className:ws(["react-flow__pane",{dragging:v,selection:e}]),onClick:T?void 0:$1(A,m),onContextMenu:$1(P,m),onWheel:$1(U,m),onMouseEnter:T?void 0:c,onMouseDown:T?M:void 0,onMouseMove:T?S:u,onMouseUp:T?C:void 0,onMouseLeave:T?_:d,ref:m,style:Ub},f,we.createElement(eJ,null))});mk.displayName="Pane";function pk(e,t){const n=e.parentNode||e.parentId;if(!n)return!1;const r=t.get(n);return r?r.selected?!0:pk(r,t):!1}function CN(e,t,n){let r=e;do{if(r!=null&&r.matches(t))return!0;if(r===n.current)return!1;r=r.parentElement}while(r);return!1}function rJ(e,t,n,r){return Array.from(e.values()).filter(s=>(s.selected||s.id===r)&&(!s.parentNode||s.parentId||!pk(s,e))&&(s.draggable||t&&typeof s.draggable>"u")).map(s=>{var i,l;return{id:s.id,position:s.position||{x:0,y:0},positionAbsolute:s.positionAbsolute||{x:0,y:0},distance:{x:n.x-(((i=s.positionAbsolute)==null?void 0:i.x)??0),y:n.y-(((l=s.positionAbsolute)==null?void 0:l.y)??0)},delta:{x:0,y:0},extent:s.extent,parentNode:s.parentNode||s.parentId,parentId:s.parentNode||s.parentId,width:s.width,height:s.height,expandParent:s.expandParent}})}function sJ(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function gk(e,t,n,r,s=[0,0],i){const l=sJ(e,e.extent||r);let o=l;const c=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(c&&e.width&&e.height){const f=n.get(c),{x:m,y:h}=Jl(f,s).positionAbsolute;o=f&&Oi(m)&&Oi(h)&&Oi(f.width)&&Oi(f.height)?[[m+e.width*s[0],h+e.height*s[1]],[m+f.width-e.width+e.width*s[0],h+f.height-e.height+e.height*s[1]]]:o}else i==null||i("005",xo.error005()),o=l;else if(e.extent&&c&&e.extent!=="parent"){const f=n.get(c),{x:m,y:h}=Jl(f,s).positionAbsolute;o=[[e.extent[0][0]+m,e.extent[0][1]+h],[e.extent[1][0]+m,e.extent[1][1]+h]]}let u={x:0,y:0};if(c){const f=n.get(c);u=Jl(f,s).positionAbsolute}const d=o&&o!=="parent"?Lb(t,o):t;return{position:{x:d.x-u.x,y:d.y-u.y},positionAbsolute:d}}function F1({nodeId:e,dragItems:t,nodeInternals:n}){const r=t.map(s=>({...n.get(s.id),position:s.position,positionAbsolute:s.positionAbsolute}));return[e?r.find(s=>s.id===e):r[0],r]}const PN=(e,t,n,r)=>{const s=t.querySelectorAll(e);if(!s||!s.length)return null;const i=Array.from(s),l=t.getBoundingClientRect(),o={x:l.width*r[0],y:l.height*r[1]};return i.map(c=>{const u=c.getBoundingClientRect();return{id:c.getAttribute("data-handleid"),position:c.getAttribute("data-handlepos"),x:(u.left-l.left-o.x)/n,y:(u.top-l.top-o.y)/n,...Tb(c)}})};function Zd(e,t,n){return n===void 0?n:r=>{const s=t().nodeInternals.get(e);s&&n(r,{...s})}}function P2({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:s,unselectNodesAndEdges:i,multiSelectionActive:l,nodeInternals:o,onError:c}=t.getState(),u=o.get(e);if(!u){c==null||c("012",xo.error012(e));return}t.setState({nodesSelectionActive:!1}),u.selected?(n||u.selected&&l)&&(i({nodes:[u],edges:[]}),requestAnimationFrame(()=>{var d;return(d=r==null?void 0:r.current)==null?void 0:d.blur()})):s([e])}function iJ(){const e=ss();return Y.useCallback(({sourceEvent:n})=>{const{transform:r,snapGrid:s,snapToGrid:i}=e.getState(),l=n.touches?n.touches[0].clientX:n.clientX,o=n.touches?n.touches[0].clientY:n.clientY,c={x:(l-r[0])/r[2],y:(o-r[1])/r[2]};return{xSnapped:i?s[0]*Math.round(c.x/s[0]):c.x,ySnapped:i?s[1]*Math.round(c.y/s[1]):c.y,...c}},[])}function O1(e){return(t,n,r)=>e==null?void 0:e(t,r)}function xk({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:s,isSelectable:i,selectNodesOnDrag:l}){const o=ss(),[c,u]=Y.useState(!1),d=Y.useRef([]),f=Y.useRef({x:null,y:null}),m=Y.useRef(0),h=Y.useRef(null),x=Y.useRef({x:0,y:0}),y=Y.useRef(null),p=Y.useRef(!1),g=Y.useRef(!1),w=Y.useRef(!1),v=iJ();return Y.useEffect(()=>{if(e!=null&&e.current){const N=J2(e.current),A=({x:M,y:S})=>{const{nodeInternals:C,onNodeDrag:_,onSelectionDrag:T,updateNodePositions:B,nodeExtent:$,snapGrid:D,snapToGrid:L,nodeOrigin:O,onError:W}=o.getState();f.current={x:M,y:S};let E=!1,H={x:0,y:0,x2:0,y2:0};if(d.current.length>1&&$){const R=ug(d.current,O);H=eh(R)}if(d.current=d.current.map(R=>{const q={x:M-R.distance.x,y:S-R.distance.y};L&&(q.x=D[0]*Math.round(q.x/D[0]),q.y=D[1]*Math.round(q.y/D[1]));const F=[[$[0][0],$[0][1]],[$[1][0],$[1][1]]];d.current.length>1&&$&&!R.extent&&(F[0][0]=R.positionAbsolute.x-H.x+$[0][0],F[1][0]=R.positionAbsolute.x+(R.width??0)-H.x2+$[1][0],F[0][1]=R.positionAbsolute.y-H.y+$[0][1],F[1][1]=R.positionAbsolute.y+(R.height??0)-H.y2+$[1][1]);const G=gk(R,q,C,F,O,W);return E=E||R.position.x!==G.position.x||R.position.y!==G.position.y,R.position=G.position,R.positionAbsolute=G.positionAbsolute,R}),!E)return;B(d.current,!0,!0),u(!0);const V=s?_:O1(T);if(V&&y.current){const[R,q]=F1({nodeId:s,dragItems:d.current,nodeInternals:C});V(y.current,R,q)}},P=()=>{if(!h.current)return;const[M,S]=FA(x.current,h.current);if(M!==0||S!==0){const{transform:C,panBy:_}=o.getState();f.current.x=(f.current.x??0)-M/C[2],f.current.y=(f.current.y??0)-S/C[2],_({x:M,y:S})&&A(f.current)}m.current=requestAnimationFrame(P)},U=M=>{var O;const{nodeInternals:S,multiSelectionActive:C,nodesDraggable:_,unselectNodesAndEdges:T,onNodeDragStart:B,onSelectionDragStart:$}=o.getState();g.current=!0;const D=s?B:O1($);(!l||!i)&&!C&&s&&((O=S.get(s))!=null&&O.selected||T()),s&&i&&l&&P2({id:s,store:o,nodeRef:e});const L=v(M);if(f.current=L,d.current=rJ(S,_,L,s),D&&d.current){const[W,E]=F1({nodeId:s,dragItems:d.current,nodeInternals:S});D(M.sourceEvent,W,E)}};if(t)N.on(".drag",null);else{const M=VE().on("start",S=>{const{domNode:C,nodeDragThreshold:_}=o.getState();_===0&&U(S),w.current=!1;const T=v(S);f.current=T,h.current=(C==null?void 0:C.getBoundingClientRect())||null,x.current=Xo(S.sourceEvent,h.current)}).on("drag",S=>{var B,$;const C=v(S),{autoPanOnNodeDrag:_,nodeDragThreshold:T}=o.getState();if(S.sourceEvent.type==="touchmove"&&S.sourceEvent.touches.length>1&&(w.current=!0),!w.current){if(!p.current&&g.current&&_&&(p.current=!0,P()),!g.current){const D=C.xSnapped-(((B=f==null?void 0:f.current)==null?void 0:B.x)??0),L=C.ySnapped-((($=f==null?void 0:f.current)==null?void 0:$.y)??0);Math.sqrt(D*D+L*L)>T&&U(S)}(f.current.x!==C.xSnapped||f.current.y!==C.ySnapped)&&d.current&&g.current&&(y.current=S.sourceEvent,x.current=Xo(S.sourceEvent,h.current),A(C))}}).on("end",S=>{if(!(!g.current||w.current)&&(u(!1),p.current=!1,g.current=!1,cancelAnimationFrame(m.current),d.current)){const{updateNodePositions:C,nodeInternals:_,onNodeDragStop:T,onSelectionDragStop:B}=o.getState(),$=s?T:O1(B);if(C(d.current,!1,!1),$){const[D,L]=F1({nodeId:s,dragItems:d.current,nodeInternals:_});$(S.sourceEvent,D,L)}}}).filter(S=>{const C=S.target;return!S.button&&(!n||!CN(C,`.${n}`,e))&&(!r||CN(C,r,e))});return N.call(M),()=>{N.on(".drag",null)}}}},[e,t,n,r,i,o,s,l,v]),c}function yk(){const e=ss();return Y.useCallback(n=>{const{nodeInternals:r,nodeExtent:s,updateNodePositions:i,getNodes:l,snapToGrid:o,snapGrid:c,onError:u,nodesDraggable:d}=e.getState(),f=l().filter(w=>w.selected&&(w.draggable||d&&typeof w.draggable>"u")),m=o?c[0]:5,h=o?c[1]:5,x=n.isShiftPressed?4:1,y=n.x*m*x,p=n.y*h*x,g=f.map(w=>{if(w.positionAbsolute){const v={x:w.positionAbsolute.x+y,y:w.positionAbsolute.y+p};o&&(v.x=c[0]*Math.round(v.x/c[0]),v.y=c[1]*Math.round(v.y/c[1]));const{positionAbsolute:N,position:A}=gk(w,v,r,s,void 0,u);w.position=A,w.positionAbsolute=N}return w});i(g,!0,!1)},[])}const gu={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var Xd=e=>{const t=({id:n,type:r,data:s,xPos:i,yPos:l,xPosOrigin:o,yPosOrigin:c,selected:u,onClick:d,onMouseEnter:f,onMouseMove:m,onMouseLeave:h,onContextMenu:x,onDoubleClick:y,style:p,className:g,isDraggable:w,isSelectable:v,isConnectable:N,isFocusable:A,selectNodesOnDrag:P,sourcePosition:U,targetPosition:M,hidden:S,resizeObserver:C,dragHandle:_,zIndex:T,isParent:B,noDragClassName:$,noPanClassName:D,initialized:L,disableKeyboardA11y:O,ariaLabel:W,rfId:E,hasHandleBounds:H})=>{const V=ss(),R=Y.useRef(null),q=Y.useRef(null),F=Y.useRef(U),G=Y.useRef(M),ee=Y.useRef(r),ae=v||w||d||f||m||h,re=yk(),Q=Zd(n,V.getState,f),fe=Zd(n,V.getState,m),Se=Zd(n,V.getState,h),oe=Zd(n,V.getState,x),pe=Zd(n,V.getState,y),me=$e=>{const{nodeDragThreshold:Oe}=V.getState();if(v&&(!P||!w||Oe>0)&&P2({id:n,store:V,nodeRef:R}),d){const qe=V.getState().nodeInternals.get(n);qe&&d($e,{...qe})}},ne=$e=>{if(!_2($e)&&!O)if(zA.includes($e.key)&&v){const Oe=$e.key==="Escape";P2({id:n,store:V,unselect:Oe,nodeRef:R})}else w&&u&&Object.prototype.hasOwnProperty.call(gu,$e.key)&&(V.setState({ariaLiveMessage:`Moved selected node ${$e.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~i}, y: ${~~l}`}),re({x:gu[$e.key].x,y:gu[$e.key].y,isShiftPressed:$e.shiftKey}))};Y.useEffect(()=>()=>{q.current&&(C==null||C.unobserve(q.current),q.current=null)},[]),Y.useEffect(()=>{if(R.current&&!S){const $e=R.current;(!L||!H||q.current!==$e)&&(q.current&&(C==null||C.unobserve(q.current)),C==null||C.observe($e),q.current=$e)}},[S,L,H]),Y.useEffect(()=>{const $e=ee.current!==r,Oe=F.current!==U,qe=G.current!==M;R.current&&($e||Oe||qe)&&($e&&(ee.current=r),Oe&&(F.current=U),qe&&(G.current=M),V.getState().updateNodeDimensions([{id:n,nodeElement:R.current,forceUpdate:!0}]))},[n,r,U,M]);const it=xk({nodeRef:R,disabled:S||!w,noDragClassName:$,handleSelector:_,nodeId:n,isSelectable:v,selectNodesOnDrag:P});return S?null:we.createElement("div",{className:ws(["react-flow__node",`react-flow__node-${r}`,{[D]:w},g,{selected:u,selectable:v,parent:B,dragging:it}]),ref:R,style:{zIndex:T,transform:`translate(${o}px,${c}px)`,pointerEvents:ae?"all":"none",visibility:L?"visible":"hidden",...p},"data-id":n,"data-testid":`rf__node-${n}`,onMouseEnter:Q,onMouseMove:fe,onMouseLeave:Se,onContextMenu:oe,onClick:me,onDoubleClick:pe,onKeyDown:A?ne:void 0,tabIndex:A?0:void 0,role:A?"button":void 0,"aria-describedby":O?void 0:`${ok}-${E}`,"aria-label":W},we.createElement(vY,{value:n},we.createElement(e,{id:n,data:s,type:r,xPos:i,yPos:l,selected:u,isConnectable:N,sourcePosition:U,targetPosition:M,dragging:it,dragHandle:_,zIndex:T})))};return t.displayName="NodeWrapper",Y.memo(t)};const aJ=e=>{const t=e.getNodes().filter(n=>n.selected);return{...ug(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function oJ({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=ss(),{width:s,height:i,x:l,y:o,transformString:c,userSelectionActive:u}=cr(aJ,ls),d=yk(),f=Y.useRef(null);if(Y.useEffect(()=>{var x;n||(x=f.current)==null||x.focus({preventScroll:!0})},[n]),xk({nodeRef:f}),u||!s||!i)return null;const m=e?x=>{const y=r.getState().getNodes().filter(p=>p.selected);e(x,y)}:void 0,h=x=>{Object.prototype.hasOwnProperty.call(gu,x.key)&&d({x:gu[x.key].x,y:gu[x.key].y,isShiftPressed:x.shiftKey})};return we.createElement("div",{className:ws(["react-flow__nodesselection","react-flow__container",t]),style:{transform:c}},we.createElement("div",{ref:f,className:"react-flow__nodesselection-rect",onContextMenu:m,tabIndex:n?void 0:-1,onKeyDown:n?void 0:h,style:{width:s,height:i,top:o,left:l}}))}var lJ=Y.memo(oJ);const cJ=e=>e.nodesSelectionActive,bk=({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:s,onPaneContextMenu:i,onPaneScroll:l,deleteKeyCode:o,onMove:c,onMoveStart:u,onMoveEnd:d,selectionKeyCode:f,selectionOnDrag:m,selectionMode:h,onSelectionStart:x,onSelectionEnd:y,multiSelectionKeyCode:p,panActivationKeyCode:g,zoomActivationKeyCode:w,elementsSelectable:v,zoomOnScroll:N,zoomOnPinch:A,panOnScroll:P,panOnScrollSpeed:U,panOnScrollMode:M,zoomOnDoubleClick:S,panOnDrag:C,defaultViewport:_,translateExtent:T,minZoom:B,maxZoom:$,preventScrolling:D,onSelectionContextMenu:L,noWheelClassName:O,noPanClassName:W,disableKeyboardA11y:E})=>{const H=cr(cJ),V=nh(f),R=nh(g),q=R||C,F=R||P,G=V||m&&q!==!0;return YY({deleteKeyCode:o,multiSelectionKeyCode:p}),we.createElement(KY,{onMove:c,onMoveStart:u,onMoveEnd:d,onPaneContextMenu:i,elementsSelectable:v,zoomOnScroll:N,zoomOnPinch:A,panOnScroll:F,panOnScrollSpeed:U,panOnScrollMode:M,zoomOnDoubleClick:S,panOnDrag:!V&&q,defaultViewport:_,translateExtent:T,minZoom:B,maxZoom:$,zoomActivationKeyCode:w,preventScrolling:D,noWheelClassName:O,noPanClassName:W},we.createElement(mk,{onSelectionStart:x,onSelectionEnd:y,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:s,onPaneContextMenu:i,onPaneScroll:l,panOnDrag:q,isSelecting:!!G,selectionMode:h},e,H&&we.createElement(lJ,{onSelectionContextMenu:L,noPanClassName:W,disableKeyboardA11y:E})))};bk.displayName="FlowRenderer";var uJ=Y.memo(bk);function dJ(e){return cr(Y.useCallback(n=>e?YA(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):n.getNodes(),[e]))}function fJ(e){const t={input:Xd(e.input||rk),default:Xd(e.default||C2),output:Xd(e.output||ik),group:Xd(e.group||Bb)},n={},r=Object.keys(e).filter(s=>!["input","default","output","group"].includes(s)).reduce((s,i)=>(s[i]=Xd(e[i]||C2),s),n);return{...t,...r}}const hJ=({x:e,y:t,width:n,height:r,origin:s})=>!n||!r?{x:e,y:t}:s[0]<0||s[1]<0||s[0]>1||s[1]>1?{x:e,y:t}:{x:e-n*s[0],y:t-r*s[1]},mJ=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),vk=e=>{const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:s,updateNodeDimensions:i,onError:l}=cr(mJ,ls),o=dJ(e.onlyRenderVisibleElements),c=Y.useRef(),u=Y.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const d=new ResizeObserver(f=>{const m=f.map(h=>({id:h.target.getAttribute("data-id"),nodeElement:h.target,forceUpdate:!0}));i(m)});return c.current=d,d},[]);return Y.useEffect(()=>()=>{var d;(d=c==null?void 0:c.current)==null||d.disconnect()},[]),we.createElement("div",{className:"react-flow__nodes",style:Ub},o.map(d=>{var A,P,U;let f=d.type||"default";e.nodeTypes[f]||(l==null||l("003",xo.error003(f)),f="default");const m=e.nodeTypes[f]||e.nodeTypes.default,h=!!(d.draggable||t&&typeof d.draggable>"u"),x=!!(d.selectable||s&&typeof d.selectable>"u"),y=!!(d.connectable||n&&typeof d.connectable>"u"),p=!!(d.focusable||r&&typeof d.focusable>"u"),g=e.nodeExtent?Lb(d.positionAbsolute,e.nodeExtent):d.positionAbsolute,w=(g==null?void 0:g.x)??0,v=(g==null?void 0:g.y)??0,N=hJ({x:w,y:v,width:d.width??0,height:d.height??0,origin:e.nodeOrigin});return we.createElement(m,{key:d.id,id:d.id,className:d.className,style:d.style,type:f,data:d.data,sourcePosition:d.sourcePosition||zt.Bottom,targetPosition:d.targetPosition||zt.Top,hidden:d.hidden,xPos:w,yPos:v,xPosOrigin:N.x,yPosOrigin:N.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!d.selected,isDraggable:h,isSelectable:x,isConnectable:y,isFocusable:p,resizeObserver:u,dragHandle:d.dragHandle,zIndex:((A=d[Cr])==null?void 0:A.z)??0,isParent:!!((P=d[Cr])!=null&&P.isParent),noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!d.width&&!!d.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:d.ariaLabel,hasHandleBounds:!!((U=d[Cr])!=null&&U.handleBounds)})}))};vk.displayName="NodeRenderer";var pJ=Y.memo(vk);const gJ=(e,t,n)=>n===zt.Left?e-t:n===zt.Right?e+t:e,xJ=(e,t,n)=>n===zt.Top?e-t:n===zt.Bottom?e+t:e,IN="react-flow__edgeupdater",TN=({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:s,onMouseEnter:i,onMouseOut:l,type:o})=>we.createElement("circle",{onMouseDown:s,onMouseEnter:i,onMouseOut:l,className:ws([IN,`${IN}-${o}`]),cx:gJ(t,r,e),cy:xJ(n,r,e),r,stroke:"transparent",fill:"transparent"}),yJ=()=>!0;var Jc=e=>{const t=({id:n,className:r,type:s,data:i,onClick:l,onEdgeDoubleClick:o,selected:c,animated:u,label:d,labelStyle:f,labelShowBg:m,labelBgStyle:h,labelBgPadding:x,labelBgBorderRadius:y,style:p,source:g,target:w,sourceX:v,sourceY:N,targetX:A,targetY:P,sourcePosition:U,targetPosition:M,elementsSelectable:S,hidden:C,sourceHandleId:_,targetHandleId:T,onContextMenu:B,onMouseEnter:$,onMouseMove:D,onMouseLeave:L,reconnectRadius:O,onReconnect:W,onReconnectStart:E,onReconnectEnd:H,markerEnd:V,markerStart:R,rfId:q,ariaLabel:F,isFocusable:G,isReconnectable:ee,pathOptions:ae,interactionWidth:re,disableKeyboardA11y:Q})=>{const fe=Y.useRef(null),[Se,oe]=Y.useState(!1),[pe,me]=Y.useState(!1),ne=ss(),it=Y.useMemo(()=>`url('#${k2(R,q)}')`,[R,q]),$e=Y.useMemo(()=>`url('#${k2(V,q)}')`,[V,q]);if(C)return null;const Oe=se=>{var Ue;const{edges:he,addSelectedEdges:ke,unselectNodesAndEdges:be,multiSelectionActive:Le}=ne.getState(),He=he.find(De=>De.id===n);He&&(S&&(ne.setState({nodesSelectionActive:!1}),He.selected&&Le?(be({nodes:[],edges:[He]}),(Ue=fe.current)==null||Ue.blur()):ke([n])),l&&l(se,He))},qe=Jd(n,ne.getState,o),gt=Jd(n,ne.getState,B),ut=Jd(n,ne.getState,$),Rt=Jd(n,ne.getState,D),Nt=Jd(n,ne.getState,L),ye=(se,he)=>{if(se.button!==0)return;const{edges:ke,isValidConnection:be}=ne.getState(),Le=he?w:g,He=(he?T:_)||null,Ue=he?"target":"source",De=be||yJ,_e=he,Ie=ke.find(St=>St.id===n);me(!0),E==null||E(se,Ie,Ue);const ht=St=>{me(!1),H==null||H(St,Ie,Ue)};QA({event:se,handleId:He,nodeId:Le,onConnect:St=>W==null?void 0:W(Ie,St),isTarget:_e,getState:ne.getState,setState:ne.setState,isValidConnection:De,edgeUpdaterType:Ue,onReconnectEnd:ht})},ze=se=>ye(se,!0),Ze=se=>ye(se,!1),xe=()=>oe(!0),pt=()=>oe(!1),Ne=!S&&!l,de=se=>{var he;if(!Q&&zA.includes(se.key)&&S){const{unselectNodesAndEdges:ke,addSelectedEdges:be,edges:Le}=ne.getState();se.key==="Escape"?((he=fe.current)==null||he.blur(),ke({edges:[Le.find(Ue=>Ue.id===n)]})):be([n])}};return we.createElement("g",{className:ws(["react-flow__edge",`react-flow__edge-${s}`,r,{selected:c,animated:u,inactive:Ne,updating:Se}]),onClick:Oe,onDoubleClick:qe,onContextMenu:gt,onMouseEnter:ut,onMouseMove:Rt,onMouseLeave:Nt,onKeyDown:G?de:void 0,tabIndex:G?0:void 0,role:G?"button":"img","data-testid":`rf__edge-${n}`,"aria-label":F===null?void 0:F||`Edge from ${g} to ${w}`,"aria-describedby":G?`${lk}-${q}`:void 0,ref:fe},!pe&&we.createElement(e,{id:n,source:g,target:w,selected:c,animated:u,label:d,labelStyle:f,labelShowBg:m,labelBgStyle:h,labelBgPadding:x,labelBgBorderRadius:y,data:i,style:p,sourceX:v,sourceY:N,targetX:A,targetY:P,sourcePosition:U,targetPosition:M,sourceHandleId:_,targetHandleId:T,markerStart:it,markerEnd:$e,pathOptions:ae,interactionWidth:re}),ee&&we.createElement(we.Fragment,null,(ee==="source"||ee===!0)&&we.createElement(TN,{position:U,centerX:v,centerY:N,radius:O,onMouseDown:ze,onMouseEnter:xe,onMouseOut:pt,type:"source"}),(ee==="target"||ee===!0)&&we.createElement(TN,{position:M,centerX:A,centerY:P,radius:O,onMouseDown:Ze,onMouseEnter:xe,onMouseOut:pt,type:"target"})))};return t.displayName="EdgeWrapper",Y.memo(t)};function bJ(e){const t={default:Jc(e.default||n0),straight:Jc(e.bezier||$b),step:Jc(e.step||Rb),smoothstep:Jc(e.step||cg),simplebezier:Jc(e.simplebezier||Mb)},n={},r=Object.keys(e).filter(s=>!["default","bezier"].includes(s)).reduce((s,i)=>(s[i]=Jc(e[i]||n0),s),n);return{...t,...r}}function LN(e,t,n=null){const r=((n==null?void 0:n.x)||0)+t.x,s=((n==null?void 0:n.y)||0)+t.y,i=(n==null?void 0:n.width)||t.width,l=(n==null?void 0:n.height)||t.height;switch(e){case zt.Top:return{x:r+i/2,y:s};case zt.Right:return{x:r+i,y:s+l/2};case zt.Bottom:return{x:r+i/2,y:s+l};case zt.Left:return{x:r,y:s+l/2}}}function MN(e,t){return e?e.length===1||!t?e[0]:t&&e.find(n=>n.id===t)||null:null}const vJ=(e,t,n,r,s,i)=>{const l=LN(n,e,t),o=LN(i,r,s);return{sourceX:l.x,sourceY:l.y,targetX:o.x,targetY:o.y}};function wJ({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:r,targetWidth:s,targetHeight:i,width:l,height:o,transform:c}){const u={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+s),y2:Math.max(e.y+r,t.y+i)};u.x===u.x2&&(u.x2+=1),u.y===u.y2&&(u.y2+=1);const d=eh({x:(0-c[0])/c[2],y:(0-c[1])/c[2],width:l/c[2],height:o/c[2]}),f=Math.max(0,Math.min(d.x2,u.x2)-Math.max(d.x,u.x)),m=Math.max(0,Math.min(d.y2,u.y2)-Math.max(d.y,u.y));return Math.ceil(f*m)>0}function RN(e){var r,s,i,l,o;const t=((r=e==null?void 0:e[Cr])==null?void 0:r.handleBounds)||null,n=t&&(e==null?void 0:e.width)&&(e==null?void 0:e.height)&&typeof((s=e==null?void 0:e.positionAbsolute)==null?void 0:s.x)<"u"&&typeof((i=e==null?void 0:e.positionAbsolute)==null?void 0:i.y)<"u";return[{x:((l=e==null?void 0:e.positionAbsolute)==null?void 0:l.x)||0,y:((o=e==null?void 0:e.positionAbsolute)==null?void 0:o.y)||0,width:(e==null?void 0:e.width)||0,height:(e==null?void 0:e.height)||0},t,!!n]}const NJ=[{level:0,isMaxLevel:!0,edges:[]}];function jJ(e,t,n=!1){let r=-1;const s=e.reduce((l,o)=>{var d,f;const c=Oi(o.zIndex);let u=c?o.zIndex:0;if(n){const m=t.get(o.target),h=t.get(o.source),x=o.selected||(m==null?void 0:m.selected)||(h==null?void 0:h.selected),y=Math.max(((d=h==null?void 0:h[Cr])==null?void 0:d.z)||0,((f=m==null?void 0:m[Cr])==null?void 0:f.z)||0,1e3);u=(c?o.zIndex:0)+(x?y:0)}return l[u]?l[u].push(o):l[u]=[o],r=u>r?u:r,l},{}),i=Object.entries(s).map(([l,o])=>{const c=+l;return{edges:o,level:c,isMaxLevel:c===r}});return i.length===0?NJ:i}function SJ(e,t,n){const r=cr(Y.useCallback(s=>e?s.edges.filter(i=>{const l=t.get(i.source),o=t.get(i.target);return(l==null?void 0:l.width)&&(l==null?void 0:l.height)&&(o==null?void 0:o.width)&&(o==null?void 0:o.height)&&wJ({sourcePos:l.positionAbsolute||{x:0,y:0},targetPos:o.positionAbsolute||{x:0,y:0},sourceWidth:l.width,sourceHeight:l.height,targetWidth:o.width,targetHeight:o.height,width:s.width,height:s.height,transform:s.transform})}):s.edges,[e,t]));return jJ(r,t,n)}const _J=({color:e="none",strokeWidth:t=1})=>we.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),AJ=({color:e="none",strokeWidth:t=1})=>we.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),$N={[vi.Arrow]:_J,[vi.ArrowClosed]:AJ};function kJ(e){const t=ss();return Y.useMemo(()=>{var s,i;return Object.prototype.hasOwnProperty.call($N,e)?$N[e]:((i=(s=t.getState()).onError)==null||i.call(s,"009",xo.error009(e)),null)},[e])}const EJ=({id:e,type:t,color:n,width:r=12.5,height:s=12.5,markerUnits:i="strokeWidth",strokeWidth:l,orient:o="auto-start-reverse"})=>{const c=kJ(t);return c?we.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${s}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:o,refX:"0",refY:"0"},we.createElement(c,{color:n,strokeWidth:l})):null},CJ=({defaultColor:e,rfId:t})=>n=>{const r=[];return n.edges.reduce((s,i)=>([i.markerStart,i.markerEnd].forEach(l=>{if(l&&typeof l=="object"){const o=k2(l,t);r.includes(o)||(s.push({id:o,color:l.color||e,...l}),r.push(o))}}),s),[]).sort((s,i)=>s.id.localeCompare(i.id))},wk=({defaultColor:e,rfId:t})=>{const n=cr(Y.useCallback(CJ({defaultColor:e,rfId:t}),[e,t]),(r,s)=>!(r.length!==s.length||r.some((i,l)=>i.id!==s[l].id)));return we.createElement("defs",null,n.map(r=>we.createElement(EJ,{id:r.id,key:r.id,type:r.type,color:r.color,width:r.width,height:r.height,markerUnits:r.markerUnits,strokeWidth:r.strokeWidth,orient:r.orient})))};wk.displayName="MarkerDefinitions";var PJ=Y.memo(wk);const IJ=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),Nk=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:n,rfId:r,edgeTypes:s,noPanClassName:i,onEdgeContextMenu:l,onEdgeMouseEnter:o,onEdgeMouseMove:c,onEdgeMouseLeave:u,onEdgeClick:d,onEdgeDoubleClick:f,onReconnect:m,onReconnectStart:h,onReconnectEnd:x,reconnectRadius:y,children:p,disableKeyboardA11y:g})=>{const{edgesFocusable:w,edgesUpdatable:v,elementsSelectable:N,width:A,height:P,connectionMode:U,nodeInternals:M,onError:S}=cr(IJ,ls),C=SJ(t,M,n);return A?we.createElement(we.Fragment,null,C.map(({level:_,edges:T,isMaxLevel:B})=>we.createElement("svg",{key:_,style:{zIndex:_},width:A,height:P,className:"react-flow__edges react-flow__container"},B&&we.createElement(PJ,{defaultColor:e,rfId:r}),we.createElement("g",null,T.map($=>{const[D,L,O]=RN(M.get($.source)),[W,E,H]=RN(M.get($.target));if(!O||!H)return null;let V=$.type||"default";s[V]||(S==null||S("011",xo.error011(V)),V="default");const R=s[V]||s.default,q=U===ac.Strict?E.target:(E.target??[]).concat(E.source??[]),F=MN(L.source,$.sourceHandle),G=MN(q,$.targetHandle),ee=(F==null?void 0:F.position)||zt.Bottom,ae=(G==null?void 0:G.position)||zt.Top,re=!!($.focusable||w&&typeof $.focusable>"u"),Q=$.reconnectable||$.updatable,fe=typeof m<"u"&&(Q||v&&typeof Q>"u");if(!F||!G)return S==null||S("008",xo.error008(F,$)),null;const{sourceX:Se,sourceY:oe,targetX:pe,targetY:me}=vJ(D,F,ee,W,G,ae);return we.createElement(R,{key:$.id,id:$.id,className:ws([$.className,i]),type:V,data:$.data,selected:!!$.selected,animated:!!$.animated,hidden:!!$.hidden,label:$.label,labelStyle:$.labelStyle,labelShowBg:$.labelShowBg,labelBgStyle:$.labelBgStyle,labelBgPadding:$.labelBgPadding,labelBgBorderRadius:$.labelBgBorderRadius,style:$.style,source:$.source,target:$.target,sourceHandleId:$.sourceHandle,targetHandleId:$.targetHandle,markerEnd:$.markerEnd,markerStart:$.markerStart,sourceX:Se,sourceY:oe,targetX:pe,targetY:me,sourcePosition:ee,targetPosition:ae,elementsSelectable:N,onContextMenu:l,onMouseEnter:o,onMouseMove:c,onMouseLeave:u,onClick:d,onEdgeDoubleClick:f,onReconnect:m,onReconnectStart:h,onReconnectEnd:x,reconnectRadius:y,rfId:r,ariaLabel:$.ariaLabel,isFocusable:re,isReconnectable:fe,pathOptions:"pathOptions"in $?$.pathOptions:void 0,interactionWidth:$.interactionWidth,disableKeyboardA11y:g})})))),p):null};Nk.displayName="EdgeRenderer";var TJ=Y.memo(Nk);const LJ=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function MJ({children:e}){const t=cr(LJ);return we.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function RJ(e){const t=zb(),n=Y.useRef(!1);Y.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const $J={[zt.Left]:zt.Right,[zt.Right]:zt.Left,[zt.Top]:zt.Bottom,[zt.Bottom]:zt.Top},jk=({nodeId:e,handleType:t,style:n,type:r=Go.Bezier,CustomComponent:s,connectionStatus:i})=>{var P,U,M;const{fromNode:l,handleId:o,toX:c,toY:u,connectionMode:d}=cr(Y.useCallback(S=>({fromNode:S.nodeInternals.get(e),handleId:S.connectionHandleId,toX:(S.connectionPosition.x-S.transform[0])/S.transform[2],toY:(S.connectionPosition.y-S.transform[1])/S.transform[2],connectionMode:S.connectionMode}),[e]),ls),f=(P=l==null?void 0:l[Cr])==null?void 0:P.handleBounds;let m=f==null?void 0:f[t];if(d===ac.Loose&&(m=m||(f==null?void 0:f[t==="source"?"target":"source"])),!l||!m)return null;const h=o?m.find(S=>S.id===o):m[0],x=h?h.x+h.width/2:(l.width??0)/2,y=h?h.y+h.height/2:l.height??0,p=(((U=l.positionAbsolute)==null?void 0:U.x)??0)+x,g=(((M=l.positionAbsolute)==null?void 0:M.y)??0)+y,w=h==null?void 0:h.position,v=w?$J[w]:null;if(!w||!v)return null;if(s)return we.createElement(s,{connectionLineType:r,connectionLineStyle:n,fromNode:l,fromHandle:h,fromX:p,fromY:g,toX:c,toY:u,fromPosition:w,toPosition:v,connectionStatus:i});let N="";const A={sourceX:p,sourceY:g,sourcePosition:w,targetX:c,targetY:u,targetPosition:v};return r===Go.Bezier?[N]=Fb(A):r===Go.Step?[N]=A2({...A,borderRadius:0}):r===Go.SmoothStep?[N]=A2(A):r===Go.SimpleBezier?[N]=WA(A):N=`M${p},${g} ${c},${u}`,we.createElement("path",{d:N,fill:"none",className:"react-flow__connection-path",style:n})};jk.displayName="ConnectionLine";const FJ=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function OJ({containerStyle:e,style:t,type:n,component:r}){const{nodeId:s,handleType:i,nodesConnectable:l,width:o,height:c,connectionStatus:u}=cr(FJ,ls);return!(s&&i&&o&&l)?null:we.createElement("svg",{style:e,width:o,height:c,className:"react-flow__edges react-flow__connectionline react-flow__container"},we.createElement("g",{className:ws(["react-flow__connection",u])},we.createElement(jk,{nodeId:s,handleType:i,style:t,type:n,CustomComponent:r,connectionStatus:u})))}function FN(e,t){return Y.useRef(null),ss(),Y.useMemo(()=>t(e),[e])}const Sk=({nodeTypes:e,edgeTypes:t,onMove:n,onMoveStart:r,onMoveEnd:s,onInit:i,onNodeClick:l,onEdgeClick:o,onNodeDoubleClick:c,onEdgeDoubleClick:u,onNodeMouseEnter:d,onNodeMouseMove:f,onNodeMouseLeave:m,onNodeContextMenu:h,onSelectionContextMenu:x,onSelectionStart:y,onSelectionEnd:p,connectionLineType:g,connectionLineStyle:w,connectionLineComponent:v,connectionLineContainerStyle:N,selectionKeyCode:A,selectionOnDrag:P,selectionMode:U,multiSelectionKeyCode:M,panActivationKeyCode:S,zoomActivationKeyCode:C,deleteKeyCode:_,onlyRenderVisibleElements:T,elementsSelectable:B,selectNodesOnDrag:$,defaultViewport:D,translateExtent:L,minZoom:O,maxZoom:W,preventScrolling:E,defaultMarkerColor:H,zoomOnScroll:V,zoomOnPinch:R,panOnScroll:q,panOnScrollSpeed:F,panOnScrollMode:G,zoomOnDoubleClick:ee,panOnDrag:ae,onPaneClick:re,onPaneMouseEnter:Q,onPaneMouseMove:fe,onPaneMouseLeave:Se,onPaneScroll:oe,onPaneContextMenu:pe,onEdgeContextMenu:me,onEdgeMouseEnter:ne,onEdgeMouseMove:it,onEdgeMouseLeave:$e,onReconnect:Oe,onReconnectStart:qe,onReconnectEnd:gt,reconnectRadius:ut,noDragClassName:Rt,noWheelClassName:Nt,noPanClassName:ye,elevateEdgesOnSelect:ze,disableKeyboardA11y:Ze,nodeOrigin:xe,nodeExtent:pt,rfId:Ne})=>{const de=FN(e,fJ),se=FN(t,bJ);return RJ(i),we.createElement(uJ,{onPaneClick:re,onPaneMouseEnter:Q,onPaneMouseMove:fe,onPaneMouseLeave:Se,onPaneContextMenu:pe,onPaneScroll:oe,deleteKeyCode:_,selectionKeyCode:A,selectionOnDrag:P,selectionMode:U,onSelectionStart:y,onSelectionEnd:p,multiSelectionKeyCode:M,panActivationKeyCode:S,zoomActivationKeyCode:C,elementsSelectable:B,onMove:n,onMoveStart:r,onMoveEnd:s,zoomOnScroll:V,zoomOnPinch:R,zoomOnDoubleClick:ee,panOnScroll:q,panOnScrollSpeed:F,panOnScrollMode:G,panOnDrag:ae,defaultViewport:D,translateExtent:L,minZoom:O,maxZoom:W,onSelectionContextMenu:x,preventScrolling:E,noDragClassName:Rt,noWheelClassName:Nt,noPanClassName:ye,disableKeyboardA11y:Ze},we.createElement(MJ,null,we.createElement(TJ,{edgeTypes:se,onEdgeClick:o,onEdgeDoubleClick:u,onlyRenderVisibleElements:T,onEdgeContextMenu:me,onEdgeMouseEnter:ne,onEdgeMouseMove:it,onEdgeMouseLeave:$e,onReconnect:Oe,onReconnectStart:qe,onReconnectEnd:gt,reconnectRadius:ut,defaultMarkerColor:H,noPanClassName:ye,elevateEdgesOnSelect:!!ze,disableKeyboardA11y:Ze,rfId:Ne},we.createElement(OJ,{style:w,type:g,component:v,containerStyle:N})),we.createElement("div",{className:"react-flow__edgelabel-renderer"}),we.createElement(pJ,{nodeTypes:de,onNodeClick:l,onNodeDoubleClick:c,onNodeMouseEnter:d,onNodeMouseMove:f,onNodeMouseLeave:m,onNodeContextMenu:h,selectNodesOnDrag:$,onlyRenderVisibleElements:T,noPanClassName:ye,noDragClassName:Rt,disableKeyboardA11y:Ze,nodeOrigin:xe,nodeExtent:pt,rfId:Ne})))};Sk.displayName="GraphView";var DJ=Y.memo(Sk);const I2=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Bo={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:I2,nodeExtent:I2,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:ac.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:mY,isValidConnection:void 0},BJ=()=>aY((e,t)=>({...Bo,setNodes:n=>{const{nodeInternals:r,nodeOrigin:s,elevateNodesOnSelect:i}=t();e({nodeInternals:R1(n,r,s,i)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:r={}}=t();e({edges:n.map(s=>({...r,...s}))})},setDefaultNodesAndEdges:(n,r)=>{const s=typeof n<"u",i=typeof r<"u",l=s?R1(n,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:l,edges:i?r:[],hasDefaultNodes:s,hasDefaultEdges:i})},updateNodeDimensions:n=>{const{onNodesChange:r,nodeInternals:s,fitViewOnInit:i,fitViewOnInitDone:l,fitViewOnInitOptions:o,domNode:c,nodeOrigin:u}=t(),d=c==null?void 0:c.querySelector(".react-flow__viewport");if(!d)return;const f=window.getComputedStyle(d),{m22:m}=new window.DOMMatrixReadOnly(f.transform),h=n.reduce((y,p)=>{const g=s.get(p.id);if(g!=null&&g.hidden)s.set(g.id,{...g,[Cr]:{...g[Cr],handleBounds:void 0}});else if(g){const w=Tb(p.nodeElement);!!(w.width&&w.height&&(g.width!==w.width||g.height!==w.height||p.forceUpdate))&&(s.set(g.id,{...g,[Cr]:{...g[Cr],handleBounds:{source:PN(".source",p.nodeElement,m,u),target:PN(".target",p.nodeElement,m,u)}},...w}),y.push({id:g.id,type:"dimensions",dimensions:w}))}return y},[]);uk(s,u);const x=l||i&&!l&&dk(t,{initial:!0,...o});e({nodeInternals:new Map(s),fitViewOnInitDone:x}),(h==null?void 0:h.length)>0&&(r==null||r(h))},updateNodePositions:(n,r=!0,s=!1)=>{const{triggerNodeChanges:i}=t(),l=n.map(o=>{const c={id:o.id,type:"position",dragging:s};return r&&(c.positionAbsolute=o.positionAbsolute,c.position=o.position),c});i(l)},triggerNodeChanges:n=>{const{onNodesChange:r,nodeInternals:s,hasDefaultNodes:i,nodeOrigin:l,getNodes:o,elevateNodesOnSelect:c}=t();if(n!=null&&n.length){if(i){const u=hk(n,o()),d=R1(u,s,l,c);e({nodeInternals:d})}r==null||r(n)}},addSelectedNodes:n=>{const{multiSelectionActive:r,edges:s,getNodes:i}=t();let l,o=null;r?l=n.map(c=>Wo(c,!0)):(l=lu(i(),n),o=lu(s,[])),_m({changedNodes:l,changedEdges:o,get:t,set:e})},addSelectedEdges:n=>{const{multiSelectionActive:r,edges:s,getNodes:i}=t();let l,o=null;r?l=n.map(c=>Wo(c,!0)):(l=lu(s,n),o=lu(i(),[])),_m({changedNodes:o,changedEdges:l,get:t,set:e})},unselectNodesAndEdges:({nodes:n,edges:r}={})=>{const{edges:s,getNodes:i}=t(),l=n||i(),o=r||s,c=l.map(d=>(d.selected=!1,Wo(d.id,!1))),u=o.map(d=>Wo(d.id,!1));_m({changedNodes:c,changedEdges:u,get:t,set:e})},setMinZoom:n=>{const{d3Zoom:r,maxZoom:s}=t();r==null||r.scaleExtent([n,s]),e({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:r,minZoom:s}=t();r==null||r.scaleExtent([s,n]),e({maxZoom:n})},setTranslateExtent:n=>{var r;(r=t().d3Zoom)==null||r.translateExtent(n),e({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:r}=t(),i=r().filter(o=>o.selected).map(o=>Wo(o.id,!1)),l=n.filter(o=>o.selected).map(o=>Wo(o.id,!1));_m({changedNodes:i,changedEdges:l,get:t,set:e})},setNodeExtent:n=>{const{nodeInternals:r}=t();r.forEach(s=>{s.positionAbsolute=Lb(s.position,n)}),e({nodeExtent:n,nodeInternals:new Map(r)})},panBy:n=>{const{transform:r,width:s,height:i,d3Zoom:l,d3Selection:o,translateExtent:c}=t();if(!l||!o||!n.x&&!n.y)return!1;const u=Wl.translate(r[0]+n.x,r[1]+n.y).scale(r[2]),d=[[0,0],[s,i]],f=l==null?void 0:l.constrain()(u,d,c);return l.transform(o,f),r[0]!==f.x||r[1]!==f.y||r[2]!==f.k},cancelConnection:()=>e({connectionNodeId:Bo.connectionNodeId,connectionHandleId:Bo.connectionHandleId,connectionHandleType:Bo.connectionHandleType,connectionStatus:Bo.connectionStatus,connectionStartHandle:Bo.connectionStartHandle,connectionEndHandle:Bo.connectionEndHandle}),reset:()=>e({...Bo})}),Object.is),qb=({children:e})=>{const t=Y.useRef(null);return t.current||(t.current=BJ()),we.createElement(oY,{value:t.current},e)};qb.displayName="ReactFlowProvider";const _k=({children:e})=>Y.useContext(lg)?we.createElement(we.Fragment,null,e):we.createElement(qb,null,e);_k.displayName="ReactFlowWrapper";const zJ={input:rk,default:C2,output:ik,group:Bb},UJ={default:n0,straight:$b,step:Rb,smoothstep:cg,simplebezier:Mb},qJ=[0,0],HJ=[15,15],WJ={x:0,y:0,zoom:1},VJ={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},Ak=Y.forwardRef(({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:s,nodeTypes:i=zJ,edgeTypes:l=UJ,onNodeClick:o,onEdgeClick:c,onInit:u,onMove:d,onMoveStart:f,onMoveEnd:m,onConnect:h,onConnectStart:x,onConnectEnd:y,onClickConnectStart:p,onClickConnectEnd:g,onNodeMouseEnter:w,onNodeMouseMove:v,onNodeMouseLeave:N,onNodeContextMenu:A,onNodeDoubleClick:P,onNodeDragStart:U,onNodeDrag:M,onNodeDragStop:S,onNodesDelete:C,onEdgesDelete:_,onSelectionChange:T,onSelectionDragStart:B,onSelectionDrag:$,onSelectionDragStop:D,onSelectionContextMenu:L,onSelectionStart:O,onSelectionEnd:W,connectionMode:E=ac.Strict,connectionLineType:H=Go.Bezier,connectionLineStyle:V,connectionLineComponent:R,connectionLineContainerStyle:q,deleteKeyCode:F="Backspace",selectionKeyCode:G="Shift",selectionOnDrag:ee=!1,selectionMode:ae=th.Full,panActivationKeyCode:re="Space",multiSelectionKeyCode:Q=t0()?"Meta":"Control",zoomActivationKeyCode:fe=t0()?"Meta":"Control",snapToGrid:Se=!1,snapGrid:oe=HJ,onlyRenderVisibleElements:pe=!1,selectNodesOnDrag:me=!0,nodesDraggable:ne,nodesConnectable:it,nodesFocusable:$e,nodeOrigin:Oe=qJ,edgesFocusable:qe,edgesUpdatable:gt,elementsSelectable:ut,defaultViewport:Rt=WJ,minZoom:Nt=.5,maxZoom:ye=2,translateExtent:ze=I2,preventScrolling:Ze=!0,nodeExtent:xe,defaultMarkerColor:pt="#b1b1b7",zoomOnScroll:Ne=!0,zoomOnPinch:de=!0,panOnScroll:se=!1,panOnScrollSpeed:he=.5,panOnScrollMode:ke=Hl.Free,zoomOnDoubleClick:be=!0,panOnDrag:Le=!0,onPaneClick:He,onPaneMouseEnter:Ue,onPaneMouseMove:De,onPaneMouseLeave:_e,onPaneScroll:Ie,onPaneContextMenu:ht,children:wt,onEdgeContextMenu:St,onEdgeDoubleClick:Vt,onEdgeMouseEnter:qn,onEdgeMouseMove:En,onEdgeMouseLeave:Dn,onEdgeUpdate:lt,onEdgeUpdateStart:Fe,onEdgeUpdateEnd:Dt,onReconnect:Gt,onReconnectStart:Ht,onReconnectEnd:ot,reconnectRadius:_t=10,edgeUpdaterRadius:Et=10,onNodesChange:ft,onEdgesChange:at,noDragClassName:Te="nodrag",noWheelClassName:Ee="nowheel",noPanClassName:et="nopan",fitView:kt=!1,fitViewOptions:vt,connectOnClick:At=!0,attributionPosition:Ct,proOptions:Lt,defaultEdgeOptions:Gn,elevateNodesOnSelect:Lr=!0,elevateEdgesOnSelect:nt=!1,disableKeyboardA11y:Qt=!1,autoPanOnConnect:ct=!0,autoPanOnNodeDrag:Bt=!0,connectionRadius:an=20,isValidConnection:en,onError:mt,style:Ft,id:on,nodeDragThreshold:rn,...Cn},bn)=>{const _n=on||"1";return we.createElement("div",{...Cn,style:{...Ft,...VJ},ref:bn,className:ws(["react-flow",s]),"data-testid":"rf__wrapper",id:on},we.createElement(_k,null,we.createElement(DJ,{onInit:u,onMove:d,onMoveStart:f,onMoveEnd:m,onNodeClick:o,onEdgeClick:c,onNodeMouseEnter:w,onNodeMouseMove:v,onNodeMouseLeave:N,onNodeContextMenu:A,onNodeDoubleClick:P,nodeTypes:i,edgeTypes:l,connectionLineType:H,connectionLineStyle:V,connectionLineComponent:R,connectionLineContainerStyle:q,selectionKeyCode:G,selectionOnDrag:ee,selectionMode:ae,deleteKeyCode:F,multiSelectionKeyCode:Q,panActivationKeyCode:re,zoomActivationKeyCode:fe,onlyRenderVisibleElements:pe,selectNodesOnDrag:me,defaultViewport:Rt,translateExtent:ze,minZoom:Nt,maxZoom:ye,preventScrolling:Ze,zoomOnScroll:Ne,zoomOnPinch:de,zoomOnDoubleClick:be,panOnScroll:se,panOnScrollSpeed:he,panOnScrollMode:ke,panOnDrag:Le,onPaneClick:He,onPaneMouseEnter:Ue,onPaneMouseMove:De,onPaneMouseLeave:_e,onPaneScroll:Ie,onPaneContextMenu:ht,onSelectionContextMenu:L,onSelectionStart:O,onSelectionEnd:W,onEdgeContextMenu:St,onEdgeDoubleClick:Vt,onEdgeMouseEnter:qn,onEdgeMouseMove:En,onEdgeMouseLeave:Dn,onReconnect:Gt??lt,onReconnectStart:Ht??Fe,onReconnectEnd:ot??Dt,reconnectRadius:_t??Et,defaultMarkerColor:pt,noDragClassName:Te,noWheelClassName:Ee,noPanClassName:et,elevateEdgesOnSelect:nt,rfId:_n,disableKeyboardA11y:Qt,nodeOrigin:Oe,nodeExtent:xe}),we.createElement($Y,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:h,onConnectStart:x,onConnectEnd:y,onClickConnectStart:p,onClickConnectEnd:g,nodesDraggable:ne,nodesConnectable:it,nodesFocusable:$e,edgesFocusable:qe,edgesUpdatable:gt,elementsSelectable:ut,elevateNodesOnSelect:Lr,minZoom:Nt,maxZoom:ye,nodeExtent:xe,onNodesChange:ft,onEdgesChange:at,snapToGrid:Se,snapGrid:oe,connectionMode:E,translateExtent:ze,connectOnClick:At,defaultEdgeOptions:Gn,fitView:kt,fitViewOptions:vt,onNodesDelete:C,onEdgesDelete:_,onNodeDragStart:U,onNodeDrag:M,onNodeDragStop:S,onSelectionDrag:$,onSelectionDragStart:B,onSelectionDragStop:D,noPanClassName:et,nodeOrigin:Oe,rfId:_n,autoPanOnConnect:ct,autoPanOnNodeDrag:Bt,onError:mt,connectionRadius:an,isValidConnection:en,nodeDragThreshold:rn}),we.createElement(MY,{onSelectionChange:T}),wt,we.createElement(cY,{proOptions:Lt,position:Ct}),we.createElement(zY,{rfId:_n,disableKeyboardA11y:Qt})))});Ak.displayName="ReactFlow";function kk(e){return t=>{const[n,r]=Y.useState(t),s=Y.useCallback(i=>r(l=>e(i,l)),[]);return[n,r,s]}}const GJ=kk(hk),YJ=kk(tJ),Ek=({id:e,x:t,y:n,width:r,height:s,style:i,color:l,strokeColor:o,strokeWidth:c,className:u,borderRadius:d,shapeRendering:f,onClick:m,selected:h})=>{const{background:x,backgroundColor:y}=i||{},p=l||x||y;return we.createElement("rect",{className:ws(["react-flow__minimap-node",{selected:h},u]),x:t,y:n,rx:d,ry:d,width:r,height:s,fill:p,stroke:o,strokeWidth:c,shapeRendering:f,onClick:m?g=>m(g,e):void 0})};Ek.displayName="MiniMapNode";var JJ=Y.memo(Ek);const ZJ=e=>e.nodeOrigin,XJ=e=>e.getNodes().filter(t=>!t.hidden&&t.width&&t.height),D1=e=>e instanceof Function?e:()=>e;function KJ({nodeStrokeColor:e="transparent",nodeColor:t="#e2e2e2",nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:s=2,nodeComponent:i=JJ,onClick:l}){const o=cr(XJ,ls),c=cr(ZJ),u=D1(t),d=D1(e),f=D1(n),m=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return we.createElement(we.Fragment,null,o.map(h=>{const{x,y}=Jl(h,c).positionAbsolute;return we.createElement(i,{key:h.id,x,y,width:h.width,height:h.height,style:h.style,selected:h.selected,className:f(h),color:u(h),borderRadius:r,strokeColor:d(h),strokeWidth:s,shapeRendering:m,onClick:l,id:h.id})}))}var QJ=Y.memo(KJ);const eZ=200,tZ=150,nZ=e=>{const t=e.getNodes(),n={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:n,boundingRect:t.length>0?fY(ug(t,e.nodeOrigin),n):n,rfId:e.rfId}},rZ="react-flow__minimap-desc";function Ck({style:e,className:t,nodeStrokeColor:n="transparent",nodeColor:r="#e2e2e2",nodeClassName:s="",nodeBorderRadius:i=5,nodeStrokeWidth:l=2,nodeComponent:o,maskColor:c="rgb(240, 240, 240, 0.6)",maskStrokeColor:u="none",maskStrokeWidth:d=1,position:f="bottom-right",onClick:m,onNodeClick:h,pannable:x=!1,zoomable:y=!1,ariaLabel:p="React Flow mini map",inversePan:g=!1,zoomStep:w=10,offsetScale:v=5}){const N=ss(),A=Y.useRef(null),{boundingRect:P,viewBB:U,rfId:M}=cr(nZ,ls),S=(e==null?void 0:e.width)??eZ,C=(e==null?void 0:e.height)??tZ,_=P.width/S,T=P.height/C,B=Math.max(_,T),$=B*S,D=B*C,L=v*B,O=P.x-($-P.width)/2-L,W=P.y-(D-P.height)/2-L,E=$+L*2,H=D+L*2,V=`${rZ}-${M}`,R=Y.useRef(0);R.current=B,Y.useEffect(()=>{if(A.current){const G=J2(A.current),ee=Q=>{const{transform:fe,d3Selection:Se,d3Zoom:oe}=N.getState();if(Q.sourceEvent.type!=="wheel"||!Se||!oe)return;const pe=-Q.sourceEvent.deltaY*(Q.sourceEvent.deltaMode===1?.05:Q.sourceEvent.deltaMode?1:.002)*w,me=fe[2]*Math.pow(2,pe);oe.scaleTo(Se,me)},ae=Q=>{const{transform:fe,d3Selection:Se,d3Zoom:oe,translateExtent:pe,width:me,height:ne}=N.getState();if(Q.sourceEvent.type!=="mousemove"||!Se||!oe)return;const it=R.current*Math.max(1,fe[2])*(g?-1:1),$e={x:fe[0]-Q.sourceEvent.movementX*it,y:fe[1]-Q.sourceEvent.movementY*it},Oe=[[0,0],[me,ne]],qe=Wl.translate($e.x,$e.y).scale(fe[2]),gt=oe.constrain()(qe,Oe,pe);oe.transform(Se,gt)},re=h4().on("zoom",x?ae:null).on("zoom.wheel",y?ee:null);return G.call(re),()=>{G.on("zoom",null)}}},[x,y,g,w]);const q=m?G=>{const ee=m4(G);m(G,{x:ee[0],y:ee[1]})}:void 0,F=h?(G,ee)=>{const ae=N.getState().nodeInternals.get(ee);h(G,ae)}:void 0;return we.createElement(Ib,{position:f,style:e,className:ws(["react-flow__minimap",t]),"data-testid":"rf__minimap"},we.createElement("svg",{width:S,height:C,viewBox:`${O} ${W} ${E} ${H}`,role:"img","aria-labelledby":V,ref:A,onClick:q},p&&we.createElement("title",{id:V},p),we.createElement(QJ,{onClick:F,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:i,nodeClassName:s,nodeStrokeWidth:l,nodeComponent:o}),we.createElement("path",{className:"react-flow__minimap-mask",d:`M${O-L},${W-L}h${E+L*2}v${H+L*2}h${-E-L*2}z
        M${U.x},${U.y}h${U.width}v${U.height}h${-U.width}z`,fill:c,fillRule:"evenodd",stroke:u,strokeWidth:d,pointerEvents:"none"})))}Ck.displayName="MiniMap";var sZ=Y.memo(Ck);function iZ(){return we.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},we.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function aZ(){return we.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},we.createElement("path",{d:"M0 0h32v4.2H0z"}))}function oZ(){return we.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},we.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function lZ(){return we.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},we.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function cZ(){return we.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},we.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}const yf=({children:e,className:t,...n})=>we.createElement("button",{type:"button",className:ws(["react-flow__controls-button",t]),...n},e);yf.displayName="ControlButton";const uZ=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom}),Pk=({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:s,onZoomIn:i,onZoomOut:l,onFitView:o,onInteractiveChange:c,className:u,children:d,position:f="bottom-left"})=>{const m=ss(),[h,x]=Y.useState(!1),{isInteractive:y,minZoomReached:p,maxZoomReached:g}=cr(uZ,ls),{zoomIn:w,zoomOut:v,fitView:N}=zb();if(Y.useEffect(()=>{x(!0)},[]),!h)return null;const A=()=>{w(),i==null||i()},P=()=>{v(),l==null||l()},U=()=>{N(s),o==null||o()},M=()=>{m.setState({nodesDraggable:!y,nodesConnectable:!y,elementsSelectable:!y}),c==null||c(!y)};return we.createElement(Ib,{className:ws(["react-flow__controls",u]),position:f,style:e,"data-testid":"rf__controls"},t&&we.createElement(we.Fragment,null,we.createElement(yf,{onClick:A,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:g},we.createElement(iZ,null)),we.createElement(yf,{onClick:P,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:p},we.createElement(aZ,null))),n&&we.createElement(yf,{className:"react-flow__controls-fitview",onClick:U,title:"fit view","aria-label":"fit view"},we.createElement(oZ,null)),r&&we.createElement(yf,{className:"react-flow__controls-interactive",onClick:M,title:"toggle interactivity","aria-label":"toggle interactivity"},y?we.createElement(cZ,null):we.createElement(lZ,null)),d)};Pk.displayName="Controls";var dZ=Y.memo(Pk),Bi;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(Bi||(Bi={}));function fZ({color:e,dimensions:t,lineWidth:n}){return we.createElement("path",{stroke:e,strokeWidth:n,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`})}function hZ({color:e,radius:t}){return we.createElement("circle",{cx:t,cy:t,r:t,fill:e})}const mZ={[Bi.Dots]:"#91919a",[Bi.Lines]:"#eee",[Bi.Cross]:"#e2e2e2"},pZ={[Bi.Dots]:1,[Bi.Lines]:1,[Bi.Cross]:6},gZ=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function Ik({id:e,variant:t=Bi.Dots,gap:n=20,size:r,lineWidth:s=1,offset:i=2,color:l,style:o,className:c}){const u=Y.useRef(null),{transform:d,patternId:f}=cr(gZ,ls),m=l||mZ[t],h=r||pZ[t],x=t===Bi.Dots,y=t===Bi.Cross,p=Array.isArray(n)?n:[n,n],g=[p[0]*d[2]||1,p[1]*d[2]||1],w=h*d[2],v=y?[w,w]:g,N=x?[w/i,w/i]:[v[0]/i,v[1]/i];return we.createElement("svg",{className:ws(["react-flow__background",c]),style:{...o,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:u,"data-testid":"rf__background"},we.createElement("pattern",{id:f+e,x:d[0]%g[0],y:d[1]%g[1],width:g[0],height:g[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${N[0]},-${N[1]})`},x?we.createElement(hZ,{color:m,radius:w/i}):we.createElement(fZ,{dimensions:v,color:m,lineWidth:s})),we.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${f+e})`}))}Ik.displayName="Background";var xZ=Y.memo(Ik);const yZ=()=>{const[e,t]=Y.useState({isOpen:!1,options:null,resolve:null}),{language:n}=Xt(),r=c=>new Promise(u=>{t({isOpen:!0,options:c,resolve:u})}),s=()=>{e.resolve&&e.resolve(!0),t({isOpen:!1,options:null,resolve:null})},i=()=>{e.resolve&&e.resolve(!1),t({isOpen:!1,options:null,resolve:null})},l=c=>typeof c=="string"?c:c[n],o=c=>c?typeof c=="string"?c:c[n]:"";return{confirm:r,isOpen:e.isOpen,options:e.options,handleConfirm:s,handleCancel:i,getMessage:l,getTitle:o}};function Kn(e){"@babel/helpers - typeof";return Kn=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kn(e)}var oa=Uint8Array,_i=Uint16Array,Hb=Int32Array,Wb=new oa([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),Vb=new oa([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),ON=new oa([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),Tk=function(e,t){for(var n=new _i(31),r=0;r<31;++r)n[r]=t+=1<<e[r-1];for(var s=new Hb(n[30]),r=1;r<30;++r)for(var i=n[r];i<n[r+1];++i)s[i]=i-n[r]<<5|r;return{b:n,r:s}},Lk=Tk(Wb,2),bZ=Lk.b,T2=Lk.r;bZ[28]=258,T2[258]=28;var vZ=Tk(Vb,0),DN=vZ.r,L2=new _i(32768);for(var fr=0;fr<32768;++fr){var zo=(fr&43690)>>1|(fr&21845)<<1;zo=(zo&52428)>>2|(zo&13107)<<2,zo=(zo&61680)>>4|(zo&3855)<<4,L2[fr]=((zo&65280)>>8|(zo&255)<<8)>>1}var kf=function(e,t,n){for(var r=e.length,s=0,i=new _i(t);s<r;++s)e[s]&&++i[e[s]-1];var l=new _i(t);for(s=1;s<t;++s)l[s]=l[s-1]+i[s-1]<<1;var o;if(n){o=new _i(1<<t);var c=15-t;for(s=0;s<r;++s)if(e[s])for(var u=s<<4|e[s],d=t-e[s],f=l[e[s]-1]++<<d,m=f|(1<<d)-1;f<=m;++f)o[L2[f]>>c]=u}else for(o=new _i(r),s=0;s<r;++s)e[s]&&(o[s]=L2[l[e[s]-1]++]>>15-e[s]);return o},oc=new oa(288);for(var fr=0;fr<144;++fr)oc[fr]=8;for(var fr=144;fr<256;++fr)oc[fr]=9;for(var fr=256;fr<280;++fr)oc[fr]=7;for(var fr=280;fr<288;++fr)oc[fr]=8;var r0=new oa(32);for(var fr=0;fr<32;++fr)r0[fr]=5;var wZ=kf(oc,9,0),NZ=kf(r0,5,0),Mk=function(e){return(e+7)/8|0},jZ=function(e,t,n){return(n==null||n>e.length)&&(n=e.length),new oa(e.subarray(t,n))},Qa=function(e,t,n){n<<=t&7;var r=t/8|0;e[r]|=n,e[r+1]|=n>>8},Kd=function(e,t,n){n<<=t&7;var r=t/8|0;e[r]|=n,e[r+1]|=n>>8,e[r+2]|=n>>16},B1=function(e,t){for(var n=[],r=0;r<e.length;++r)e[r]&&n.push({s:r,f:e[r]});var s=n.length,i=n.slice();if(!s)return{t:$k,l:0};if(s==1){var l=new oa(n[0].s+1);return l[n[0].s]=1,{t:l,l:1}}n.sort(function(A,P){return A.f-P.f}),n.push({s:-1,f:25001});var o=n[0],c=n[1],u=0,d=1,f=2;for(n[0]={s:-1,f:o.f+c.f,l:o,r:c};d!=s-1;)o=n[n[u].f<n[f].f?u++:f++],c=n[u!=d&&n[u].f<n[f].f?u++:f++],n[d++]={s:-1,f:o.f+c.f,l:o,r:c};for(var m=i[0].s,r=1;r<s;++r)i[r].s>m&&(m=i[r].s);var h=new _i(m+1),x=M2(n[d-1],h,0);if(x>t){var r=0,y=0,p=x-t,g=1<<p;for(i.sort(function(P,U){return h[U.s]-h[P.s]||P.f-U.f});r<s;++r){var w=i[r].s;if(h[w]>t)y+=g-(1<<x-h[w]),h[w]=t;else break}for(y>>=p;y>0;){var v=i[r].s;h[v]<t?y-=1<<t-h[v]++-1:++r}for(;r>=0&&y;--r){var N=i[r].s;h[N]==t&&(--h[N],++y)}x=t}return{t:new oa(h),l:x}},M2=function(e,t,n){return e.s==-1?Math.max(M2(e.l,t,n+1),M2(e.r,t,n+1)):t[e.s]=n},BN=function(e){for(var t=e.length;t&&!e[--t];);for(var n=new _i(++t),r=0,s=e[0],i=1,l=function(c){n[r++]=c},o=1;o<=t;++o)if(e[o]==s&&o!=t)++i;else{if(!s&&i>2){for(;i>138;i-=138)l(32754);i>2&&(l(i>10?i-11<<5|28690:i-3<<5|12305),i=0)}else if(i>3){for(l(s),--i;i>6;i-=6)l(8304);i>2&&(l(i-3<<5|8208),i=0)}for(;i--;)l(s);i=1,s=e[o]}return{c:n.subarray(0,r),n:t}},Qd=function(e,t){for(var n=0,r=0;r<t.length;++r)n+=e[r]*t[r];return n},Rk=function(e,t,n){var r=n.length,s=Mk(t+2);e[s]=r&255,e[s+1]=r>>8,e[s+2]=e[s]^255,e[s+3]=e[s+1]^255;for(var i=0;i<r;++i)e[s+i+4]=n[i];return(s+4+r)*8},zN=function(e,t,n,r,s,i,l,o,c,u,d){Qa(t,d++,n),++s[256];for(var f=B1(s,15),m=f.t,h=f.l,x=B1(i,15),y=x.t,p=x.l,g=BN(m),w=g.c,v=g.n,N=BN(y),A=N.c,P=N.n,U=new _i(19),M=0;M<w.length;++M)++U[w[M]&31];for(var M=0;M<A.length;++M)++U[A[M]&31];for(var S=B1(U,7),C=S.t,_=S.l,T=19;T>4&&!C[ON[T-1]];--T);var B=u+5<<3,$=Qd(s,oc)+Qd(i,r0)+l,D=Qd(s,m)+Qd(i,y)+l+14+3*T+Qd(U,C)+2*U[16]+3*U[17]+7*U[18];if(c>=0&&B<=$&&B<=D)return Rk(t,d,e.subarray(c,c+u));var L,O,W,E;if(Qa(t,d,1+(D<$)),d+=2,D<$){L=kf(m,h,0),O=m,W=kf(y,p,0),E=y;var H=kf(C,_,0);Qa(t,d,v-257),Qa(t,d+5,P-1),Qa(t,d+10,T-4),d+=14;for(var M=0;M<T;++M)Qa(t,d+3*M,C[ON[M]]);d+=3*T;for(var V=[w,A],R=0;R<2;++R)for(var q=V[R],M=0;M<q.length;++M){var F=q[M]&31;Qa(t,d,H[F]),d+=C[F],F>15&&(Qa(t,d,q[M]>>5&127),d+=q[M]>>12)}}else L=wZ,O=oc,W=NZ,E=r0;for(var M=0;M<o;++M){var G=r[M];if(G>255){var F=G>>18&31;Kd(t,d,L[F+257]),d+=O[F+257],F>7&&(Qa(t,d,G>>23&31),d+=Wb[F]);var ee=G&31;Kd(t,d,W[ee]),d+=E[ee],ee>3&&(Kd(t,d,G>>5&8191),d+=Vb[ee])}else Kd(t,d,L[G]),d+=O[G]}return Kd(t,d,L[256]),d+O[256]},SZ=new Hb([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),$k=new oa(0),_Z=function(e,t,n,r,s,i){var l=i.z||e.length,o=new oa(r+l+5*(1+Math.ceil(l/7e3))+s),c=o.subarray(r,o.length-s),u=i.l,d=(i.r||0)&7;if(t){d&&(c[0]=i.r>>3);for(var f=SZ[t-1],m=f>>13,h=f&8191,x=(1<<n)-1,y=i.p||new _i(32768),p=i.h||new _i(x+1),g=Math.ceil(n/3),w=2*g,v=function(me){return(e[me]^e[me+1]<<g^e[me+2]<<w)&x},N=new Hb(25e3),A=new _i(288),P=new _i(32),U=0,M=0,S=i.i||0,C=0,_=i.w||0,T=0;S+2<l;++S){var B=v(S),$=S&32767,D=p[B];if(y[$]=D,p[B]=$,_<=S){var L=l-S;if((U>7e3||C>24576)&&(L>423||!u)){d=zN(e,c,0,N,A,P,M,C,T,S-T,d),C=U=M=0,T=S;for(var O=0;O<286;++O)A[O]=0;for(var O=0;O<30;++O)P[O]=0}var W=2,E=0,H=h,V=$-D&32767;if(L>2&&B==v(S-V))for(var R=Math.min(m,L)-1,q=Math.min(32767,S),F=Math.min(258,L);V<=q&&--H&&$!=D;){if(e[S+W]==e[S+W-V]){for(var G=0;G<F&&e[S+G]==e[S+G-V];++G);if(G>W){if(W=G,E=V,G>R)break;for(var ee=Math.min(V,G-2),ae=0,O=0;O<ee;++O){var re=S-V+O&32767,Q=y[re],fe=re-Q&32767;fe>ae&&(ae=fe,D=re)}}}$=D,D=y[$],V+=$-D&32767}if(E){N[C++]=268435456|T2[W]<<18|DN[E];var Se=T2[W]&31,oe=DN[E]&31;M+=Wb[Se]+Vb[oe],++A[257+Se],++P[oe],_=S+W,++U}else N[C++]=e[S],++A[e[S]]}}for(S=Math.max(S,_);S<l;++S)N[C++]=e[S],++A[e[S]];d=zN(e,c,u,N,A,P,M,C,T,S-T,d),u||(i.r=d&7|c[d/8|0]<<3,d-=7,i.h=p,i.p=y,i.i=S,i.w=_)}else{for(var S=i.w||0;S<l+u;S+=65535){var pe=S+65535;pe>=l&&(c[d/8|0]=u,pe=l),d=Rk(c,d+1,e.subarray(S,pe))}i.i=l}return jZ(o,0,r+Mk(d)+s)},Fk=function(){var e=1,t=0;return{p:function(n){for(var r=e,s=t,i=n.length|0,l=0;l!=i;){for(var o=Math.min(l+2655,i);l<o;++l)s+=r+=n[l];r=(r&65535)+15*(r>>16),s=(s&65535)+15*(s>>16)}e=r,t=s},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},AZ=function(e,t,n,r,s){if(!s&&(s={l:1},t.dictionary)){var i=t.dictionary.subarray(-32768),l=new oa(i.length+e.length);l.set(i),l.set(e,i.length),e=l,s.w=i.length}return _Z(e,t.level==null?6:t.level,t.mem==null?s.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,n,r,s)},Ok=function(e,t,n){for(;n;++t)e[t]=n,n>>>=8},kZ=function(e,t){var n=t.level,r=n==0?0:n<6?1:n==9?3:2;if(e[0]=120,e[1]=r<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var s=Fk();s.p(t.dictionary),Ok(e,2,s.d())}};function R2(e,t){t||(t={});var n=Fk();n.p(e);var r=AZ(e,t,t.dictionary?6:2,4);return kZ(r,t),Ok(r,r.length-4,n.d()),r}var EZ=typeof TextDecoder<"u"&&new TextDecoder,CZ=0;try{EZ.decode($k,{stream:!0}),CZ=1}catch{}function PZ(e){if(Array.isArray(e))return e}function IZ(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var r,s,i,l,o=[],c=!0,u=!1;try{if(i=(n=n.call(e)).next,t!==0)for(;!(c=(r=i.call(n)).done)&&(o.push(r.value),o.length!==t);c=!0);}catch(d){u=!0,s=d}finally{try{if(!c&&n.return!=null&&(l=n.return(),Object(l)!==l))return}finally{if(u)throw s}}return o}}function UN(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function TZ(e,t){if(e){if(typeof e=="string")return UN(e,t);var n={}.toString.call(e).slice(8,-1);return n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set"?Array.from(e):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?UN(e,t):void 0}}function LZ(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function qN(e,t){return PZ(e)||IZ(e,t)||TZ(e,t)||LZ()}function HN(e,t="utf8"){return new TextDecoder(t).decode(e)}const MZ=new TextEncoder;function RZ(e){return MZ.encode(e)}const $Z=1024*8,FZ=(()=>{const e=new Uint8Array(4),t=new Uint32Array(e.buffer);return!((t[0]=1)&e[0])})(),z1={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class Gb{constructor(t=$Z,n={}){Zn(this,"buffer");Zn(this,"byteLength");Zn(this,"byteOffset");Zn(this,"length");Zn(this,"offset");Zn(this,"lastWrittenByte");Zn(this,"littleEndian");Zn(this,"_data");Zn(this,"_mark");Zn(this,"_marks");let r=!1;typeof t=="number"?t=new ArrayBuffer(t):(r=!0,this.lastWrittenByte=t.byteLength);const s=n.offset?n.offset>>>0:0,i=t.byteLength-s;let l=s;(ArrayBuffer.isView(t)||t instanceof Gb)&&(t.byteLength!==t.buffer.byteLength&&(l=t.byteOffset+s),t=t.buffer),r?this.lastWrittenByte=i:this.lastWrittenByte=0,this.buffer=t,this.length=i,this.byteLength=i,this.byteOffset=l,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,l,i),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const r=(this.offset+t)*2,s=new Uint8Array(r);s.set(new Uint8Array(this.buffer)),this.buffer=s.buffer,this.length=r,this.byteLength=r,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,n){const r=z1[n].BYTES_PER_ELEMENT*t,s=this.byteOffset+this.offset,i=this.buffer.slice(s,s+r);if(this.littleEndian===FZ&&n!=="uint8"&&n!=="int8"){const o=new Uint8Array(this.buffer.slice(s,s+r));o.reverse();const c=new z1[n](o.buffer);return this.offset+=r,c.reverse(),c}const l=new z1[n](i);return this.offset+=r,l}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let n="";for(let r=0;r<t;r++)n+=this.readChar();return n}readUtf8(t=1){return HN(this.readBytes(t))}decodeText(t=1,n="utf8"){return HN(this.readBytes(t),n)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let n=0;n<t.length;n++)this._data.setUint8(this.offset++,t[n]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let n=0;n<t.length;n++)this.writeUint8(t.charCodeAt(n));return this}writeUtf8(t){return this.writeBytes(RZ(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function ad(e){let t=e.length;for(;--t>=0;)e[t]=0}const OZ=3,DZ=258,Dk=29,BZ=256,zZ=BZ+1+Dk,Bk=30,UZ=512,qZ=new Array((zZ+2)*2);ad(qZ);const HZ=new Array(Bk*2);ad(HZ);const WZ=new Array(UZ);ad(WZ);const VZ=new Array(DZ-OZ+1);ad(VZ);const GZ=new Array(Dk);ad(GZ);const YZ=new Array(Bk);ad(YZ);const JZ=(e,t,n,r)=>{let s=e&65535|0,i=e>>>16&65535|0,l=0;for(;n!==0;){l=n>2e3?2e3:n,n-=l;do s=s+t[r++]|0,i=i+s|0;while(--l);s%=65521,i%=65521}return s|i<<16|0};var $2=JZ;const ZZ=()=>{let e,t=[];for(var n=0;n<256;n++){e=n;for(var r=0;r<8;r++)e=e&1?3988292384^e>>>1:e>>>1;t[n]=e}return t},XZ=new Uint32Array(ZZ()),KZ=(e,t,n,r)=>{const s=XZ,i=r+n;e^=-1;for(let l=r;l<i;l++)e=e>>>8^s[(e^t[l])&255];return e^-1};var ba=KZ,F2={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},zk={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const QZ=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var eX=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const n=t.shift();if(n){if(typeof n!="object")throw new TypeError(n+"must be non-object");for(const r in n)QZ(n,r)&&(e[r]=n[r])}}return e},tX=e=>{let t=0;for(let r=0,s=e.length;r<s;r++)t+=e[r].length;const n=new Uint8Array(t);for(let r=0,s=0,i=e.length;r<i;r++){let l=e[r];n.set(l,s),s+=l.length}return n},Uk={assign:eX,flattenChunks:tX};let qk=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{qk=!1}const rh=new Uint8Array(256);for(let e=0;e<256;e++)rh[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;rh[254]=rh[254]=1;var nX=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,n,r,s,i,l=e.length,o=0;for(s=0;s<l;s++)n=e.charCodeAt(s),(n&64512)===55296&&s+1<l&&(r=e.charCodeAt(s+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),s++)),o+=n<128?1:n<2048?2:n<65536?3:4;for(t=new Uint8Array(o),i=0,s=0;i<o;s++)n=e.charCodeAt(s),(n&64512)===55296&&s+1<l&&(r=e.charCodeAt(s+1),(r&64512)===56320&&(n=65536+(n-55296<<10)+(r-56320),s++)),n<128?t[i++]=n:n<2048?(t[i++]=192|n>>>6,t[i++]=128|n&63):n<65536?(t[i++]=224|n>>>12,t[i++]=128|n>>>6&63,t[i++]=128|n&63):(t[i++]=240|n>>>18,t[i++]=128|n>>>12&63,t[i++]=128|n>>>6&63,t[i++]=128|n&63);return t};const rX=(e,t)=>{if(t<65534&&e.subarray&&qk)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let n="";for(let r=0;r<t;r++)n+=String.fromCharCode(e[r]);return n};var sX=(e,t)=>{const n=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let r,s;const i=new Array(n*2);for(s=0,r=0;r<n;){let l=e[r++];if(l<128){i[s++]=l;continue}let o=rh[l];if(o>4){i[s++]=65533,r+=o-1;continue}for(l&=o===2?31:o===3?15:7;o>1&&r<n;)l=l<<6|e[r++]&63,o--;if(o>1){i[s++]=65533;continue}l<65536?i[s++]=l:(l-=65536,i[s++]=55296|l>>10&1023,i[s++]=56320|l&1023)}return rX(i,s)},iX=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let n=t-1;for(;n>=0&&(e[n]&192)===128;)n--;return n<0||n===0?t:n+rh[e[n]]>t?n:t},O2={string2buf:nX,buf2string:sX,utf8border:iX};function aX(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var oX=aX;const km=16209,lX=16191;var cX=function(t,n){let r,s,i,l,o,c,u,d,f,m,h,x,y,p,g,w,v,N,A,P,U,M,S,C;const _=t.state;r=t.next_in,S=t.input,s=r+(t.avail_in-5),i=t.next_out,C=t.output,l=i-(n-t.avail_out),o=i+(t.avail_out-257),c=_.dmax,u=_.wsize,d=_.whave,f=_.wnext,m=_.window,h=_.hold,x=_.bits,y=_.lencode,p=_.distcode,g=(1<<_.lenbits)-1,w=(1<<_.distbits)-1;e:do{x<15&&(h+=S[r++]<<x,x+=8,h+=S[r++]<<x,x+=8),v=y[h&g];t:for(;;){if(N=v>>>24,h>>>=N,x-=N,N=v>>>16&255,N===0)C[i++]=v&65535;else if(N&16){A=v&65535,N&=15,N&&(x<N&&(h+=S[r++]<<x,x+=8),A+=h&(1<<N)-1,h>>>=N,x-=N),x<15&&(h+=S[r++]<<x,x+=8,h+=S[r++]<<x,x+=8),v=p[h&w];n:for(;;){if(N=v>>>24,h>>>=N,x-=N,N=v>>>16&255,N&16){if(P=v&65535,N&=15,x<N&&(h+=S[r++]<<x,x+=8,x<N&&(h+=S[r++]<<x,x+=8)),P+=h&(1<<N)-1,P>c){t.msg="invalid distance too far back",_.mode=km;break e}if(h>>>=N,x-=N,N=i-l,P>N){if(N=P-N,N>d&&_.sane){t.msg="invalid distance too far back",_.mode=km;break e}if(U=0,M=m,f===0){if(U+=u-N,N<A){A-=N;do C[i++]=m[U++];while(--N);U=i-P,M=C}}else if(f<N){if(U+=u+f-N,N-=f,N<A){A-=N;do C[i++]=m[U++];while(--N);if(U=0,f<A){N=f,A-=N;do C[i++]=m[U++];while(--N);U=i-P,M=C}}}else if(U+=f-N,N<A){A-=N;do C[i++]=m[U++];while(--N);U=i-P,M=C}for(;A>2;)C[i++]=M[U++],C[i++]=M[U++],C[i++]=M[U++],A-=3;A&&(C[i++]=M[U++],A>1&&(C[i++]=M[U++]))}else{U=i-P;do C[i++]=C[U++],C[i++]=C[U++],C[i++]=C[U++],A-=3;while(A>2);A&&(C[i++]=C[U++],A>1&&(C[i++]=C[U++]))}}else if(N&64){t.msg="invalid distance code",_.mode=km;break e}else{v=p[(v&65535)+(h&(1<<N)-1)];continue n}break}}else if(N&64)if(N&32){_.mode=lX;break e}else{t.msg="invalid literal/length code",_.mode=km;break e}else{v=y[(v&65535)+(h&(1<<N)-1)];continue t}break}}while(r<s&&i<o);A=x>>3,r-=A,x-=A<<3,h&=(1<<x)-1,t.next_in=r,t.next_out=i,t.avail_in=r<s?5+(s-r):5-(r-s),t.avail_out=i<o?257+(o-i):257-(i-o),_.hold=h,_.bits=x};const Zc=15,WN=852,VN=592,GN=0,U1=1,YN=2,uX=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),dX=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),fX=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),hX=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),mX=(e,t,n,r,s,i,l,o)=>{const c=o.bits;let u=0,d=0,f=0,m=0,h=0,x=0,y=0,p=0,g=0,w=0,v,N,A,P,U,M=null,S;const C=new Uint16Array(Zc+1),_=new Uint16Array(Zc+1);let T=null,B,$,D;for(u=0;u<=Zc;u++)C[u]=0;for(d=0;d<r;d++)C[t[n+d]]++;for(h=c,m=Zc;m>=1&&C[m]===0;m--);if(h>m&&(h=m),m===0)return s[i++]=1<<24|64<<16|0,s[i++]=1<<24|64<<16|0,o.bits=1,0;for(f=1;f<m&&C[f]===0;f++);for(h<f&&(h=f),p=1,u=1;u<=Zc;u++)if(p<<=1,p-=C[u],p<0)return-1;if(p>0&&(e===GN||m!==1))return-1;for(_[1]=0,u=1;u<Zc;u++)_[u+1]=_[u]+C[u];for(d=0;d<r;d++)t[n+d]!==0&&(l[_[t[n+d]]++]=d);if(e===GN?(M=T=l,S=20):e===U1?(M=uX,T=dX,S=257):(M=fX,T=hX,S=0),w=0,d=0,u=f,U=i,x=h,y=0,A=-1,g=1<<h,P=g-1,e===U1&&g>WN||e===YN&&g>VN)return 1;for(;;){B=u-y,l[d]+1<S?($=0,D=l[d]):l[d]>=S?($=T[l[d]-S],D=M[l[d]-S]):($=96,D=0),v=1<<u-y,N=1<<x,f=N;do N-=v,s[U+(w>>y)+N]=B<<24|$<<16|D|0;while(N!==0);for(v=1<<u-1;w&v;)v>>=1;if(v!==0?(w&=v-1,w+=v):w=0,d++,--C[u]===0){if(u===m)break;u=t[n+l[d]]}if(u>h&&(w&P)!==A){for(y===0&&(y=h),U+=f,x=u-y,p=1<<x;x+y<m&&(p-=C[x+y],!(p<=0));)x++,p<<=1;if(g+=1<<x,e===U1&&g>WN||e===YN&&g>VN)return 1;A=w&P,s[A]=h<<24|x<<16|U-i|0}}return w!==0&&(s[U+w]=u-y<<24|64<<16|0),o.bits=h,0};var Ef=mX;const pX=0,Hk=1,Wk=2,{Z_FINISH:JN,Z_BLOCK:gX,Z_TREES:Em,Z_OK:lc,Z_STREAM_END:xX,Z_NEED_DICT:yX,Z_STREAM_ERROR:Ui,Z_DATA_ERROR:Vk,Z_MEM_ERROR:Gk,Z_BUF_ERROR:bX,Z_DEFLATED:ZN}=zk,dg=16180,XN=16181,KN=16182,QN=16183,e3=16184,t3=16185,n3=16186,r3=16187,s3=16188,i3=16189,s0=16190,eo=16191,q1=16192,a3=16193,H1=16194,o3=16195,l3=16196,c3=16197,u3=16198,Cm=16199,Pm=16200,d3=16201,f3=16202,h3=16203,m3=16204,p3=16205,W1=16206,g3=16207,x3=16208,pr=16209,Yk=16210,Jk=16211,vX=852,wX=592,NX=15,jX=NX,y3=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function SX(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const yc=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<dg||t.mode>Jk?1:0},Zk=e=>{if(yc(e))return Ui;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=dg,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(vX),t.distcode=t.distdyn=new Int32Array(wX),t.sane=1,t.back=-1,lc},Xk=e=>{if(yc(e))return Ui;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,Zk(e)},Kk=(e,t)=>{let n;if(yc(e))return Ui;const r=e.state;return t<0?(n=0,t=-t):(n=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?Ui:(r.window!==null&&r.wbits!==t&&(r.window=null),r.wrap=n,r.wbits=t,Xk(e))},Qk=(e,t)=>{if(!e)return Ui;const n=new SX;e.state=n,n.strm=e,n.window=null,n.mode=dg;const r=Kk(e,t);return r!==lc&&(e.state=null),r},_X=e=>Qk(e,jX);let b3=!0,V1,G1;const AX=e=>{if(b3){V1=new Int32Array(512),G1=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Ef(Hk,e.lens,0,288,V1,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Ef(Wk,e.lens,0,32,G1,0,e.work,{bits:5}),b3=!1}e.lencode=V1,e.lenbits=9,e.distcode=G1,e.distbits=5},e7=(e,t,n,r)=>{let s;const i=e.state;return i.window===null&&(i.wsize=1<<i.wbits,i.wnext=0,i.whave=0,i.window=new Uint8Array(i.wsize)),r>=i.wsize?(i.window.set(t.subarray(n-i.wsize,n),0),i.wnext=0,i.whave=i.wsize):(s=i.wsize-i.wnext,s>r&&(s=r),i.window.set(t.subarray(n-r,n-r+s),i.wnext),r-=s,r?(i.window.set(t.subarray(n-r,n),0),i.wnext=r,i.whave=i.wsize):(i.wnext+=s,i.wnext===i.wsize&&(i.wnext=0),i.whave<i.wsize&&(i.whave+=s))),0},kX=(e,t)=>{let n,r,s,i,l,o,c,u,d,f,m,h,x,y,p=0,g,w,v,N,A,P,U,M;const S=new Uint8Array(4);let C,_;const T=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(yc(e)||!e.output||!e.input&&e.avail_in!==0)return Ui;n=e.state,n.mode===eo&&(n.mode=q1),l=e.next_out,s=e.output,c=e.avail_out,i=e.next_in,r=e.input,o=e.avail_in,u=n.hold,d=n.bits,f=o,m=c,M=lc;e:for(;;)switch(n.mode){case dg:if(n.wrap===0){n.mode=q1;break}for(;d<16;){if(o===0)break e;o--,u+=r[i++]<<d,d+=8}if(n.wrap&2&&u===35615){n.wbits===0&&(n.wbits=15),n.check=0,S[0]=u&255,S[1]=u>>>8&255,n.check=ba(n.check,S,2,0),u=0,d=0,n.mode=XN;break}if(n.head&&(n.head.done=!1),!(n.wrap&1)||(((u&255)<<8)+(u>>8))%31){e.msg="incorrect header check",n.mode=pr;break}if((u&15)!==ZN){e.msg="unknown compression method",n.mode=pr;break}if(u>>>=4,d-=4,U=(u&15)+8,n.wbits===0&&(n.wbits=U),U>15||U>n.wbits){e.msg="invalid window size",n.mode=pr;break}n.dmax=1<<n.wbits,n.flags=0,e.adler=n.check=1,n.mode=u&512?i3:eo,u=0,d=0;break;case XN:for(;d<16;){if(o===0)break e;o--,u+=r[i++]<<d,d+=8}if(n.flags=u,(n.flags&255)!==ZN){e.msg="unknown compression method",n.mode=pr;break}if(n.flags&57344){e.msg="unknown header flags set",n.mode=pr;break}n.head&&(n.head.text=u>>8&1),n.flags&512&&n.wrap&4&&(S[0]=u&255,S[1]=u>>>8&255,n.check=ba(n.check,S,2,0)),u=0,d=0,n.mode=KN;case KN:for(;d<32;){if(o===0)break e;o--,u+=r[i++]<<d,d+=8}n.head&&(n.head.time=u),n.flags&512&&n.wrap&4&&(S[0]=u&255,S[1]=u>>>8&255,S[2]=u>>>16&255,S[3]=u>>>24&255,n.check=ba(n.check,S,4,0)),u=0,d=0,n.mode=QN;case QN:for(;d<16;){if(o===0)break e;o--,u+=r[i++]<<d,d+=8}n.head&&(n.head.xflags=u&255,n.head.os=u>>8),n.flags&512&&n.wrap&4&&(S[0]=u&255,S[1]=u>>>8&255,n.check=ba(n.check,S,2,0)),u=0,d=0,n.mode=e3;case e3:if(n.flags&1024){for(;d<16;){if(o===0)break e;o--,u+=r[i++]<<d,d+=8}n.length=u,n.head&&(n.head.extra_len=u),n.flags&512&&n.wrap&4&&(S[0]=u&255,S[1]=u>>>8&255,n.check=ba(n.check,S,2,0)),u=0,d=0}else n.head&&(n.head.extra=null);n.mode=t3;case t3:if(n.flags&1024&&(h=n.length,h>o&&(h=o),h&&(n.head&&(U=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Uint8Array(n.head.extra_len)),n.head.extra.set(r.subarray(i,i+h),U)),n.flags&512&&n.wrap&4&&(n.check=ba(n.check,r,h,i)),o-=h,i+=h,n.length-=h),n.length))break e;n.length=0,n.mode=n3;case n3:if(n.flags&2048){if(o===0)break e;h=0;do U=r[i+h++],n.head&&U&&n.length<65536&&(n.head.name+=String.fromCharCode(U));while(U&&h<o);if(n.flags&512&&n.wrap&4&&(n.check=ba(n.check,r,h,i)),o-=h,i+=h,U)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=r3;case r3:if(n.flags&4096){if(o===0)break e;h=0;do U=r[i+h++],n.head&&U&&n.length<65536&&(n.head.comment+=String.fromCharCode(U));while(U&&h<o);if(n.flags&512&&n.wrap&4&&(n.check=ba(n.check,r,h,i)),o-=h,i+=h,U)break e}else n.head&&(n.head.comment=null);n.mode=s3;case s3:if(n.flags&512){for(;d<16;){if(o===0)break e;o--,u+=r[i++]<<d,d+=8}if(n.wrap&4&&u!==(n.check&65535)){e.msg="header crc mismatch",n.mode=pr;break}u=0,d=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=eo;break;case i3:for(;d<32;){if(o===0)break e;o--,u+=r[i++]<<d,d+=8}e.adler=n.check=y3(u),u=0,d=0,n.mode=s0;case s0:if(n.havedict===0)return e.next_out=l,e.avail_out=c,e.next_in=i,e.avail_in=o,n.hold=u,n.bits=d,yX;e.adler=n.check=1,n.mode=eo;case eo:if(t===gX||t===Em)break e;case q1:if(n.last){u>>>=d&7,d-=d&7,n.mode=W1;break}for(;d<3;){if(o===0)break e;o--,u+=r[i++]<<d,d+=8}switch(n.last=u&1,u>>>=1,d-=1,u&3){case 0:n.mode=a3;break;case 1:if(AX(n),n.mode=Cm,t===Em){u>>>=2,d-=2;break e}break;case 2:n.mode=l3;break;case 3:e.msg="invalid block type",n.mode=pr}u>>>=2,d-=2;break;case a3:for(u>>>=d&7,d-=d&7;d<32;){if(o===0)break e;o--,u+=r[i++]<<d,d+=8}if((u&65535)!==(u>>>16^65535)){e.msg="invalid stored block lengths",n.mode=pr;break}if(n.length=u&65535,u=0,d=0,n.mode=H1,t===Em)break e;case H1:n.mode=o3;case o3:if(h=n.length,h){if(h>o&&(h=o),h>c&&(h=c),h===0)break e;s.set(r.subarray(i,i+h),l),o-=h,i+=h,c-=h,l+=h,n.length-=h;break}n.mode=eo;break;case l3:for(;d<14;){if(o===0)break e;o--,u+=r[i++]<<d,d+=8}if(n.nlen=(u&31)+257,u>>>=5,d-=5,n.ndist=(u&31)+1,u>>>=5,d-=5,n.ncode=(u&15)+4,u>>>=4,d-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=pr;break}n.have=0,n.mode=c3;case c3:for(;n.have<n.ncode;){for(;d<3;){if(o===0)break e;o--,u+=r[i++]<<d,d+=8}n.lens[T[n.have++]]=u&7,u>>>=3,d-=3}for(;n.have<19;)n.lens[T[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,C={bits:n.lenbits},M=Ef(pX,n.lens,0,19,n.lencode,0,n.work,C),n.lenbits=C.bits,M){e.msg="invalid code lengths set",n.mode=pr;break}n.have=0,n.mode=u3;case u3:for(;n.have<n.nlen+n.ndist;){for(;p=n.lencode[u&(1<<n.lenbits)-1],g=p>>>24,w=p>>>16&255,v=p&65535,!(g<=d);){if(o===0)break e;o--,u+=r[i++]<<d,d+=8}if(v<16)u>>>=g,d-=g,n.lens[n.have++]=v;else{if(v===16){for(_=g+2;d<_;){if(o===0)break e;o--,u+=r[i++]<<d,d+=8}if(u>>>=g,d-=g,n.have===0){e.msg="invalid bit length repeat",n.mode=pr;break}U=n.lens[n.have-1],h=3+(u&3),u>>>=2,d-=2}else if(v===17){for(_=g+3;d<_;){if(o===0)break e;o--,u+=r[i++]<<d,d+=8}u>>>=g,d-=g,U=0,h=3+(u&7),u>>>=3,d-=3}else{for(_=g+7;d<_;){if(o===0)break e;o--,u+=r[i++]<<d,d+=8}u>>>=g,d-=g,U=0,h=11+(u&127),u>>>=7,d-=7}if(n.have+h>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=pr;break}for(;h--;)n.lens[n.have++]=U}}if(n.mode===pr)break;if(n.lens[256]===0){e.msg="invalid code -- missing end-of-block",n.mode=pr;break}if(n.lenbits=9,C={bits:n.lenbits},M=Ef(Hk,n.lens,0,n.nlen,n.lencode,0,n.work,C),n.lenbits=C.bits,M){e.msg="invalid literal/lengths set",n.mode=pr;break}if(n.distbits=6,n.distcode=n.distdyn,C={bits:n.distbits},M=Ef(Wk,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,C),n.distbits=C.bits,M){e.msg="invalid distances set",n.mode=pr;break}if(n.mode=Cm,t===Em)break e;case Cm:n.mode=Pm;case Pm:if(o>=6&&c>=258){e.next_out=l,e.avail_out=c,e.next_in=i,e.avail_in=o,n.hold=u,n.bits=d,cX(e,m),l=e.next_out,s=e.output,c=e.avail_out,i=e.next_in,r=e.input,o=e.avail_in,u=n.hold,d=n.bits,n.mode===eo&&(n.back=-1);break}for(n.back=0;p=n.lencode[u&(1<<n.lenbits)-1],g=p>>>24,w=p>>>16&255,v=p&65535,!(g<=d);){if(o===0)break e;o--,u+=r[i++]<<d,d+=8}if(w&&!(w&240)){for(N=g,A=w,P=v;p=n.lencode[P+((u&(1<<N+A)-1)>>N)],g=p>>>24,w=p>>>16&255,v=p&65535,!(N+g<=d);){if(o===0)break e;o--,u+=r[i++]<<d,d+=8}u>>>=N,d-=N,n.back+=N}if(u>>>=g,d-=g,n.back+=g,n.length=v,w===0){n.mode=p3;break}if(w&32){n.back=-1,n.mode=eo;break}if(w&64){e.msg="invalid literal/length code",n.mode=pr;break}n.extra=w&15,n.mode=d3;case d3:if(n.extra){for(_=n.extra;d<_;){if(o===0)break e;o--,u+=r[i++]<<d,d+=8}n.length+=u&(1<<n.extra)-1,u>>>=n.extra,d-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=f3;case f3:for(;p=n.distcode[u&(1<<n.distbits)-1],g=p>>>24,w=p>>>16&255,v=p&65535,!(g<=d);){if(o===0)break e;o--,u+=r[i++]<<d,d+=8}if(!(w&240)){for(N=g,A=w,P=v;p=n.distcode[P+((u&(1<<N+A)-1)>>N)],g=p>>>24,w=p>>>16&255,v=p&65535,!(N+g<=d);){if(o===0)break e;o--,u+=r[i++]<<d,d+=8}u>>>=N,d-=N,n.back+=N}if(u>>>=g,d-=g,n.back+=g,w&64){e.msg="invalid distance code",n.mode=pr;break}n.offset=v,n.extra=w&15,n.mode=h3;case h3:if(n.extra){for(_=n.extra;d<_;){if(o===0)break e;o--,u+=r[i++]<<d,d+=8}n.offset+=u&(1<<n.extra)-1,u>>>=n.extra,d-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=pr;break}n.mode=m3;case m3:if(c===0)break e;if(h=m-c,n.offset>h){if(h=n.offset-h,h>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=pr;break}h>n.wnext?(h-=n.wnext,x=n.wsize-h):x=n.wnext-h,h>n.length&&(h=n.length),y=n.window}else y=s,x=l-n.offset,h=n.length;h>c&&(h=c),c-=h,n.length-=h;do s[l++]=y[x++];while(--h);n.length===0&&(n.mode=Pm);break;case p3:if(c===0)break e;s[l++]=n.length,c--,n.mode=Pm;break;case W1:if(n.wrap){for(;d<32;){if(o===0)break e;o--,u|=r[i++]<<d,d+=8}if(m-=c,e.total_out+=m,n.total+=m,n.wrap&4&&m&&(e.adler=n.check=n.flags?ba(n.check,s,m,l-m):$2(n.check,s,m,l-m)),m=c,n.wrap&4&&(n.flags?u:y3(u))!==n.check){e.msg="incorrect data check",n.mode=pr;break}u=0,d=0}n.mode=g3;case g3:if(n.wrap&&n.flags){for(;d<32;){if(o===0)break e;o--,u+=r[i++]<<d,d+=8}if(n.wrap&4&&u!==(n.total&4294967295)){e.msg="incorrect length check",n.mode=pr;break}u=0,d=0}n.mode=x3;case x3:M=xX;break e;case pr:M=Vk;break e;case Yk:return Gk;case Jk:default:return Ui}return e.next_out=l,e.avail_out=c,e.next_in=i,e.avail_in=o,n.hold=u,n.bits=d,(n.wsize||m!==e.avail_out&&n.mode<pr&&(n.mode<W1||t!==JN))&&e7(e,e.output,e.next_out,m-e.avail_out),f-=e.avail_in,m-=e.avail_out,e.total_in+=f,e.total_out+=m,n.total+=m,n.wrap&4&&m&&(e.adler=n.check=n.flags?ba(n.check,s,m,e.next_out-m):$2(n.check,s,m,e.next_out-m)),e.data_type=n.bits+(n.last?64:0)+(n.mode===eo?128:0)+(n.mode===Cm||n.mode===H1?256:0),(f===0&&m===0||t===JN)&&M===lc&&(M=bX),M},EX=e=>{if(yc(e))return Ui;let t=e.state;return t.window&&(t.window=null),e.state=null,lc},CX=(e,t)=>{if(yc(e))return Ui;const n=e.state;return n.wrap&2?(n.head=t,t.done=!1,lc):Ui},PX=(e,t)=>{const n=t.length;let r,s,i;return yc(e)||(r=e.state,r.wrap!==0&&r.mode!==s0)?Ui:r.mode===s0&&(s=1,s=$2(s,t,n,0),s!==r.check)?Vk:(i=e7(e,t,n,n),i?(r.mode=Yk,Gk):(r.havedict=1,lc))};var IX=Xk,TX=Kk,LX=Zk,MX=_X,RX=Qk,$X=kX,FX=EX,OX=CX,DX=PX,BX="pako inflate (from Nodeca project)",ro={inflateReset:IX,inflateReset2:TX,inflateResetKeep:LX,inflateInit:MX,inflateInit2:RX,inflate:$X,inflateEnd:FX,inflateGetHeader:OX,inflateSetDictionary:DX,inflateInfo:BX};function zX(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var UX=zX;const t7=Object.prototype.toString,{Z_NO_FLUSH:qX,Z_FINISH:HX,Z_OK:sh,Z_STREAM_END:Y1,Z_NEED_DICT:J1,Z_STREAM_ERROR:WX,Z_DATA_ERROR:v3,Z_MEM_ERROR:VX}=zk;function Ah(e){this.options=Uk.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15||(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new oX,this.strm.avail_out=0;let n=ro.inflateInit2(this.strm,t.windowBits);if(n!==sh)throw new Error(F2[n]);if(this.header=new UX,ro.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=O2.string2buf(t.dictionary):t7.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(n=ro.inflateSetDictionary(this.strm,t.dictionary),n!==sh)))throw new Error(F2[n])}Ah.prototype.push=function(e,t){const n=this.strm,r=this.options.chunkSize,s=this.options.dictionary;let i,l,o;if(this.ended)return!1;for(t===~~t?l=t:l=t===!0?HX:qX,t7.call(e)==="[object ArrayBuffer]"?n.input=new Uint8Array(e):n.input=e,n.next_in=0,n.avail_in=n.input.length;;){for(n.avail_out===0&&(n.output=new Uint8Array(r),n.next_out=0,n.avail_out=r),i=ro.inflate(n,l),i===J1&&s&&(i=ro.inflateSetDictionary(n,s),i===sh?i=ro.inflate(n,l):i===v3&&(i=J1));n.avail_in>0&&i===Y1&&n.state.wrap>0&&e[n.next_in]!==0;)ro.inflateReset(n),i=ro.inflate(n,l);switch(i){case WX:case v3:case J1:case VX:return this.onEnd(i),this.ended=!0,!1}if(o=n.avail_out,n.next_out&&(n.avail_out===0||i===Y1))if(this.options.to==="string"){let c=O2.utf8border(n.output,n.next_out),u=n.next_out-c,d=O2.buf2string(n.output,c);n.next_out=u,n.avail_out=r-u,u&&n.output.set(n.output.subarray(c,c+u),0),this.onData(d)}else this.onData(n.output.length===n.next_out?n.output:n.output.subarray(0,n.next_out));if(!(i===sh&&o===0)){if(i===Y1)return i=ro.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,!0;if(n.avail_in===0)break}}return!0};Ah.prototype.onData=function(e){this.chunks.push(e)};Ah.prototype.onEnd=function(e){e===sh&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Uk.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function GX(e,t){const n=new Ah(t);if(n.push(e),n.err)throw n.msg||F2[n.err];return n.result}var YX=Ah,JX=GX,ZX={Inflate:YX,inflate:JX};const{Inflate:XX,inflate:KX}=ZX;var w3=XX,QX=KX;const n7=[];for(let e=0;e<256;e++){let t=e;for(let n=0;n<8;n++)t&1?t=3988292384^t>>>1:t=t>>>1;n7[e]=t}const N3=4294967295;function eK(e,t,n){let r=e;for(let s=0;s<n;s++)r=n7[(r^t[s])&255]^r>>>8;return r}function tK(e,t){return(eK(N3,e,t)^N3)>>>0}function j3(e,t,n){const r=e.readUint32(),s=tK(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(s!==r)throw new Error(`CRC mismatch for chunk ${n}. Expected ${r}, found ${s}`)}function r7(e,t,n){for(let r=0;r<n;r++)t[r]=e[r]}function s7(e,t,n,r){let s=0;for(;s<r;s++)t[s]=e[s];for(;s<n;s++)t[s]=e[s]+t[s-r]&255}function i7(e,t,n,r){let s=0;if(n.length===0)for(;s<r;s++)t[s]=e[s];else for(;s<r;s++)t[s]=e[s]+n[s]&255}function a7(e,t,n,r,s){let i=0;if(n.length===0){for(;i<s;i++)t[i]=e[i];for(;i<r;i++)t[i]=e[i]+(t[i-s]>>1)&255}else{for(;i<s;i++)t[i]=e[i]+(n[i]>>1)&255;for(;i<r;i++)t[i]=e[i]+(t[i-s]+n[i]>>1)&255}}function o7(e,t,n,r,s){let i=0;if(n.length===0){for(;i<s;i++)t[i]=e[i];for(;i<r;i++)t[i]=e[i]+t[i-s]&255}else{for(;i<s;i++)t[i]=e[i]+n[i]&255;for(;i<r;i++)t[i]=e[i]+nK(t[i-s],n[i],n[i-s])&255}}function nK(e,t,n){const r=e+t-n,s=Math.abs(r-e),i=Math.abs(r-t),l=Math.abs(r-n);return s<=i&&s<=l?e:i<=l?t:n}function rK(e,t,n,r,s,i){switch(e){case 0:r7(t,n,s);break;case 1:s7(t,n,s,i);break;case 2:i7(t,n,r,s);break;case 3:a7(t,n,r,s,i);break;case 4:o7(t,n,r,s,i);break;default:throw new Error(`Unsupported filter: ${e}`)}}const sK=new Uint16Array([255]),iK=new Uint8Array(sK.buffer),aK=iK[0]===255;function oK(e){const{data:t,width:n,height:r,channels:s,depth:i}=e,l=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],o=Math.ceil(i/8)*s,c=new Uint8Array(r*n*o);let u=0;for(let d=0;d<7;d++){const f=l[d],m=Math.ceil((n-f.x)/f.xStep),h=Math.ceil((r-f.y)/f.yStep);if(m<=0||h<=0)continue;const x=m*o,y=new Uint8Array(x);for(let p=0;p<h;p++){const g=t[u++],w=t.subarray(u,u+x);u+=x;const v=new Uint8Array(x);rK(g,w,v,y,x,o),y.set(v);for(let N=0;N<m;N++){const A=f.x+N*f.xStep,P=f.y+p*f.yStep;if(!(A>=n||P>=r))for(let U=0;U<o;U++)c[(P*n+A)*o+U]=v[N*o+U]}}}if(i===16){const d=new Uint16Array(c.buffer);if(aK)for(let f=0;f<d.length;f++)d[f]=lK(d[f]);return d}else return c}function lK(e){return(e&255)<<8|e>>8&255}const cK=new Uint16Array([255]),uK=new Uint8Array(cK.buffer),dK=uK[0]===255,fK=new Uint8Array(0);function S3(e){const{data:t,width:n,height:r,channels:s,depth:i}=e,l=Math.ceil(i/8)*s,o=Math.ceil(i/8*s*n),c=new Uint8Array(r*o);let u=fK,d=0,f,m;for(let h=0;h<r;h++){switch(f=t.subarray(d+1,d+1+o),m=c.subarray(h*o,(h+1)*o),t[d]){case 0:r7(f,m,o);break;case 1:s7(f,m,o,l);break;case 2:i7(f,m,u,o);break;case 3:a7(f,m,u,o,l);break;case 4:o7(f,m,u,o,l);break;default:throw new Error(`Unsupported filter: ${t[d]}`)}u=m,d+=o+1}if(i===16){const h=new Uint16Array(c.buffer);if(dK)for(let x=0;x<h.length;x++)h[x]=hK(h[x]);return h}else return c}function hK(e){return(e&255)<<8|e>>8&255}const rp=Uint8Array.of(137,80,78,71,13,10,26,10);function _3(e){if(!mK(e.readBytes(rp.length)))throw new Error("wrong PNG signature")}function mK(e){if(e.length<rp.length)return!1;for(let t=0;t<rp.length;t++)if(e[t]!==rp[t])return!1;return!0}const pK="tEXt",gK=0,l7=new TextDecoder("latin1");function xK(e){if(bK(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const yK=/^[\u0000-\u00FF]*$/;function bK(e){if(!yK.test(e))throw new Error("invalid latin1 text")}function vK(e,t,n){const r=c7(t);e[r]=wK(t,n-r.length-1)}function c7(e){for(e.mark();e.readByte()!==gK;);const t=e.offset;e.reset();const n=l7.decode(e.readBytes(t-e.offset-1));return e.skip(1),xK(n),n}function wK(e,t){return l7.decode(e.readBytes(t))}const xi={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},Z1={UNKNOWN:-1,DEFLATE:0},A3={UNKNOWN:-1,ADAPTIVE:0},X1={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},Im={NONE:0,BACKGROUND:1,PREVIOUS:2},K1={SOURCE:0,OVER:1};class NK extends Gb{constructor(n,r={}){super(n);Zn(this,"_checkCrc");Zn(this,"_inflator");Zn(this,"_png");Zn(this,"_apng");Zn(this,"_end");Zn(this,"_hasPalette");Zn(this,"_palette");Zn(this,"_hasTransparency");Zn(this,"_transparency");Zn(this,"_compressionMethod");Zn(this,"_filterMethod");Zn(this,"_interlaceMethod");Zn(this,"_colorType");Zn(this,"_isAnimated");Zn(this,"_numberOfFrames");Zn(this,"_numberOfPlays");Zn(this,"_frames");Zn(this,"_writingDataChunks");const{checkCrc:s=!1}=r;this._checkCrc=s,this._inflator=new w3,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=Z1.UNKNOWN,this._filterMethod=A3.UNKNOWN,this._interlaceMethod=X1.UNKNOWN,this._colorType=xi.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(_3(this);!this._end;){const n=this.readUint32(),r=this.readChars(4);this.decodeChunk(n,r)}return this.decodeImage(),this._png}decodeApng(){for(_3(this);!this._end;){const n=this.readUint32(),r=this.readChars(4);this.decodeApngChunk(n,r)}return this.decodeApngImage(),this._apng}decodeChunk(n,r){const s=this.offset;switch(r){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(n);break;case"IDAT":this.decodeIDAT(n);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(n);break;case"iCCP":this.decodeiCCP(n);break;case pK:vK(this._png.text,this,n);break;case"pHYs":this.decodepHYs();break;default:this.skip(n);break}if(this.offset-s!==n)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?j3(this,n+4,r):this.skip(4)}decodeApngChunk(n,r){const s=this.offset;switch(r!=="fdAT"&&r!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),r){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(n);break;default:this.decodeChunk(n,r),this.offset=s+n;break}if(this.offset-s!==n)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?j3(this,n+4,r):this.skip(4)}decodeIHDR(){const n=this._png;n.width=this.readUint32(),n.height=this.readUint32(),n.depth=jK(this.readUint8());const r=this.readUint8();this._colorType=r;let s;switch(r){case xi.GREYSCALE:s=1;break;case xi.TRUECOLOUR:s=3;break;case xi.INDEXED_COLOUR:s=1;break;case xi.GREYSCALE_ALPHA:s=2;break;case xi.TRUECOLOUR_ALPHA:s=4;break;case xi.UNKNOWN:default:throw new Error(`Unknown color type: ${r}`)}if(this._png.channels=s,this._compressionMethod=this.readUint8(),this._compressionMethod!==Z1.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const n={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(n)}decodePLTE(n){if(n%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${n}`);const r=n/3;this._hasPalette=!0;const s=[];this._palette=s;for(let i=0;i<r;i++)s.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(n){this._writingDataChunks=!0;const r=n,s=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,s,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(n)}decodeFDAT(n){this._writingDataChunks=!0;let r=n,s=this.offset+this.byteOffset;if(s+=4,r-=4,this._inflator.push(new Uint8Array(this.buffer,s,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(n)}decodetRNS(n){switch(this._colorType){case xi.GREYSCALE:case xi.TRUECOLOUR:{if(n%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${n}`);if(n/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${n/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(n/2);for(let r=0;r<n/2;r++)this._transparency[r]=this.readUint16();break}case xi.INDEXED_COLOUR:{if(n>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${n} vs ${this._palette.length})`);let r=0;for(;r<n;r++){const s=this.readByte();this._palette[r].push(s)}for(;r<this._palette.length;r++)this._palette[r].push(255);break}case xi.UNKNOWN:case xi.GREYSCALE_ALPHA:case xi.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(n){const r=c7(this),s=this.readUint8();if(s!==Z1.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${s}`);const i=this.readBytes(n-r.length-2);this._png.iccEmbeddedProfile={name:r,profile:QX(i)}}decodepHYs(){const n=this.readUint32(),r=this.readUint32(),s=this.readByte();this._png.resolution={x:n,y:r,unit:s}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let n=0;n<this._numberOfFrames;n++){const r={sequenceNumber:this._frames[n].sequenceNumber,delayNumber:this._frames[n].delayNumber,delayDenominator:this._frames[n].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},s=this._frames.at(n);if(s){if(s.data=S3({data:s.data,width:s.width,height:s.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),n===0||s.xOffset===0&&s.yOffset===0&&s.width===this._png.width&&s.height===this._png.height)r.data=s.data;else{const i=this._apng.frames.at(n-1);this.disposeFrame(s,i,r),this.addFrameDataToCanvas(r,s)}this._apng.frames.push(r)}}return this._apng}disposeFrame(n,r,s){switch(n.disposeOp){case Im.NONE:break;case Im.BACKGROUND:for(let i=0;i<this._png.height;i++)for(let l=0;l<this._png.width;l++){const o=(i*n.width+l)*this._png.channels;for(let c=0;c<this._png.channels;c++)s.data[o+c]=0}break;case Im.PREVIOUS:s.data.set(r.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(n,r){const s=1<<this._png.depth,i=(l,o)=>{const c=((l+r.yOffset)*this._png.width+r.xOffset+o)*this._png.channels,u=(l*r.width+o)*this._png.channels;return{index:c,frameIndex:u}};switch(r.blendOp){case K1.SOURCE:for(let l=0;l<r.height;l++)for(let o=0;o<r.width;o++){const{index:c,frameIndex:u}=i(l,o);for(let d=0;d<this._png.channels;d++)n.data[c+d]=r.data[u+d]}break;case K1.OVER:for(let l=0;l<r.height;l++)for(let o=0;o<r.width;o++){const{index:c,frameIndex:u}=i(l,o);for(let d=0;d<this._png.channels;d++){const f=r.data[u+this._png.channels-1]/s,m=d%(this._png.channels-1)===0?1:r.data[u+d],h=Math.floor(f*m+(1-f)*n.data[c+d]);n.data[c+d]+=h}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){var r;if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const n=this._isAnimated?((r=this._frames)==null?void 0:r.at(0)).data:this._inflator.result;if(this._filterMethod!==A3.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===X1.NO_INTERLACE)this._png.data=S3({data:n,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===X1.ADAM7)this._png.data=oK({data:n,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const n=this._inflator.result,r=this._frames.at(-1);r?r.data=n:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:Im.NONE,blendOp:K1.SOURCE,data:n}),this._inflator=new w3,this._writingDataChunks=!1}}function jK(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}var k3;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(k3||(k3={}));function SK(e,t){return new NK(e,t).decode()}var fn=function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this}();function Q1(){fn.console&&typeof fn.console.log=="function"&&fn.console.log.apply(fn.console,arguments)}var rr={log:Q1,warn:function(e){fn.console&&(typeof fn.console.warn=="function"?fn.console.warn.apply(fn.console,arguments):Q1.call(null,arguments))},error:function(e){fn.console&&(typeof fn.console.error=="function"?fn.console.error.apply(fn.console,arguments):Q1(e))}};function ex(e,t,n){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onload=function(){Fl(r.response,t,n)},r.onerror=function(){rr.error("could not download file")},r.send()}function E3(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function Tm(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var Fl=fn.saveAs||((typeof window>"u"?"undefined":Kn(window))!=="object"||window!==fn?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,n){var r=fn.URL||fn.webkitURL,s=document.createElement("a");t=t||e.name||"download",s.download=t,s.rel="noopener",typeof e=="string"?(s.href=e,s.origin!==location.origin?E3(s.href)?ex(e,t,n):Tm(s,s.target="_blank"):Tm(s)):(s.href=r.createObjectURL(e),setTimeout(function(){r.revokeObjectURL(s.href)},4e4),setTimeout(function(){Tm(s)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,n){if(t=t||e.name||"download",typeof e=="string")if(E3(e))ex(e,t,n);else{var r=document.createElement("a");r.href=e,r.target="_blank",setTimeout(function(){Tm(r)})}else navigator.msSaveOrOpenBlob(function(s,i){return i===void 0?i={autoBom:!1}:Kn(i)!=="object"&&(rr.warn("Deprecated: Expected third argument to be a object"),i={autoBom:!i}),i.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(s.type)?new Blob(["\uFEFF",s],{type:s.type}):s}(e,n),t)}:function(e,t,n,r){if((r=r||open("","_blank"))&&(r.document.title=r.document.body.innerText="downloading..."),typeof e=="string")return ex(e,t,n);var s=e.type==="application/octet-stream",i=/constructor/i.test(fn.HTMLElement)||fn.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||s&&i)&&(typeof FileReader>"u"?"undefined":Kn(FileReader))==="object"){var o=new FileReader;o.onloadend=function(){var d=o.result;d=l?d:d.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=d:location=d,r=null},o.readAsDataURL(e)}else{var c=fn.URL||fn.webkitURL,u=c.createObjectURL(e);r?r.location=u:location.href=u,r=null,setTimeout(function(){c.revokeObjectURL(u)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function u7(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var n=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(o){return[parseInt(o[1]),parseInt(o[2]),parseInt(o[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(o){return[parseInt(o[1],16),parseInt(o[2],16),parseInt(o[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(o){return[parseInt(o[1]+o[1],16),parseInt(o[2]+o[2],16),parseInt(o[3]+o[3],16)]}}],r=0;r<n.length;r++){var s=n[r].re,i=n[r].process,l=s.exec(e);l&&(t=i(l),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var o=this.r.toString(16),c=this.g.toString(16),u=this.b.toString(16);return o.length==1&&(o="0"+o),c.length==1&&(c="0"+c),u.length==1&&(u="0"+u),"#"+o+c+u}}var sp=fn.atob.bind(fn),C3=fn.btoa.bind(fn);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function tx(e,t){var n=e[0],r=e[1],s=e[2],i=e[3];n=ks(n,r,s,i,t[0],7,-680876936),i=ks(i,n,r,s,t[1],12,-389564586),s=ks(s,i,n,r,t[2],17,606105819),r=ks(r,s,i,n,t[3],22,-1044525330),n=ks(n,r,s,i,t[4],7,-176418897),i=ks(i,n,r,s,t[5],12,1200080426),s=ks(s,i,n,r,t[6],17,-1473231341),r=ks(r,s,i,n,t[7],22,-45705983),n=ks(n,r,s,i,t[8],7,1770035416),i=ks(i,n,r,s,t[9],12,-1958414417),s=ks(s,i,n,r,t[10],17,-42063),r=ks(r,s,i,n,t[11],22,-1990404162),n=ks(n,r,s,i,t[12],7,1804603682),i=ks(i,n,r,s,t[13],12,-40341101),s=ks(s,i,n,r,t[14],17,-1502002290),n=Es(n,r=ks(r,s,i,n,t[15],22,1236535329),s,i,t[1],5,-165796510),i=Es(i,n,r,s,t[6],9,-1069501632),s=Es(s,i,n,r,t[11],14,643717713),r=Es(r,s,i,n,t[0],20,-373897302),n=Es(n,r,s,i,t[5],5,-701558691),i=Es(i,n,r,s,t[10],9,38016083),s=Es(s,i,n,r,t[15],14,-660478335),r=Es(r,s,i,n,t[4],20,-405537848),n=Es(n,r,s,i,t[9],5,568446438),i=Es(i,n,r,s,t[14],9,-1019803690),s=Es(s,i,n,r,t[3],14,-187363961),r=Es(r,s,i,n,t[8],20,1163531501),n=Es(n,r,s,i,t[13],5,-1444681467),i=Es(i,n,r,s,t[2],9,-51403784),s=Es(s,i,n,r,t[7],14,1735328473),n=Cs(n,r=Es(r,s,i,n,t[12],20,-1926607734),s,i,t[5],4,-378558),i=Cs(i,n,r,s,t[8],11,-2022574463),s=Cs(s,i,n,r,t[11],16,1839030562),r=Cs(r,s,i,n,t[14],23,-35309556),n=Cs(n,r,s,i,t[1],4,-1530992060),i=Cs(i,n,r,s,t[4],11,1272893353),s=Cs(s,i,n,r,t[7],16,-155497632),r=Cs(r,s,i,n,t[10],23,-1094730640),n=Cs(n,r,s,i,t[13],4,681279174),i=Cs(i,n,r,s,t[0],11,-358537222),s=Cs(s,i,n,r,t[3],16,-722521979),r=Cs(r,s,i,n,t[6],23,76029189),n=Cs(n,r,s,i,t[9],4,-640364487),i=Cs(i,n,r,s,t[12],11,-421815835),s=Cs(s,i,n,r,t[15],16,530742520),n=Ps(n,r=Cs(r,s,i,n,t[2],23,-995338651),s,i,t[0],6,-198630844),i=Ps(i,n,r,s,t[7],10,1126891415),s=Ps(s,i,n,r,t[14],15,-1416354905),r=Ps(r,s,i,n,t[5],21,-57434055),n=Ps(n,r,s,i,t[12],6,1700485571),i=Ps(i,n,r,s,t[3],10,-1894986606),s=Ps(s,i,n,r,t[10],15,-1051523),r=Ps(r,s,i,n,t[1],21,-2054922799),n=Ps(n,r,s,i,t[8],6,1873313359),i=Ps(i,n,r,s,t[15],10,-30611744),s=Ps(s,i,n,r,t[6],15,-1560198380),r=Ps(r,s,i,n,t[13],21,1309151649),n=Ps(n,r,s,i,t[4],6,-145523070),i=Ps(i,n,r,s,t[11],10,-1120210379),s=Ps(s,i,n,r,t[2],15,718787259),r=Ps(r,s,i,n,t[9],21,-343485551),e[0]=Jo(n,e[0]),e[1]=Jo(r,e[1]),e[2]=Jo(s,e[2]),e[3]=Jo(i,e[3])}function fg(e,t,n,r,s,i){return t=Jo(Jo(t,e),Jo(r,i)),Jo(t<<s|t>>>32-s,n)}function ks(e,t,n,r,s,i,l){return fg(t&n|~t&r,e,t,s,i,l)}function Es(e,t,n,r,s,i,l){return fg(t&r|n&~r,e,t,s,i,l)}function Cs(e,t,n,r,s,i,l){return fg(t^n^r,e,t,s,i,l)}function Ps(e,t,n,r,s,i,l){return fg(n^(t|~r),e,t,s,i,l)}function d7(e){var t,n=e.length,r=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)tx(r,_K(e.substring(t-64,t)));e=e.substring(t-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)s[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(s[t>>2]|=128<<(t%4<<3),t>55)for(tx(r,s),t=0;t<16;t++)s[t]=0;return s[14]=8*n,tx(r,s),r}function _K(e){var t,n=[];for(t=0;t<64;t+=4)n[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return n}var P3="0123456789abcdef".split("");function AK(e){for(var t="",n=0;n<4;n++)t+=P3[e>>8*n+4&15]+P3[e>>8*n&15];return t}function kK(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function D2(e){return d7(e).map(kK).join("")}var EK=function(e){for(var t=0;t<e.length;t++)e[t]=AK(e[t]);return e.join("")}(d7("hello"))!="5d41402abc4b2a76b9719d911017c592";function Jo(e,t){if(EK){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function B2(e,t){var n,r,s,i;if(e!==n){for(var l=(s=e,i=1+(256/e.length|0),new Array(i+1).join(s)),o=[],c=0;c<256;c++)o[c]=c;var u=0;for(c=0;c<256;c++){var d=o[c];u=(u+d+l.charCodeAt(c))%256,o[c]=o[u],o[u]=d}n=e,r=o}else o=r;var f=t.length,m=0,h=0,x="";for(c=0;c<f;c++)h=(h+(d=o[m=(m+1)%256]))%256,o[m]=o[h],o[h]=d,l=o[(o[m]+o[h])%256],x+=String.fromCharCode(t.charCodeAt(c)^l);return x}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var I3={print:4,modify:8,copy:16,"annot-forms":32};function nu(e,t,n,r){this.v=1,this.r=2;var s=192;e.forEach(function(o){if(I3.perm!==void 0)throw new Error("Invalid permission: "+o);s+=I3[o]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var i=(t+this.padding).substr(0,32),l=(n+this.padding).substr(0,32);this.O=this.processOwnerPassword(i,l),this.P=-(1+(255^s)),this.encryptionKey=D2(i+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(r)).substr(0,5),this.U=B2(this.encryptionKey,this.padding)}function ru(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",n=e.length,r=0;r<n;r++){var s=e.charCodeAt(r);t+=s<33||s===35||s===37||s===40||s===41||s===47||s===60||s===62||s===91||s===93||s===123||s===125||s>126?"#"+("0"+s.toString(16)).slice(-2):e[r]}return t}function T3(e){if(Kn(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(n,r,s){if(s=s||!1,typeof n!="string"||typeof r!="function"||typeof s!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(n)||(t[n]={});var i=Math.random().toString(35);return t[n][i]=[r,!!s],i},this.unsubscribe=function(n){for(var r in t)if(t[r][n])return delete t[r][n],Object.keys(t[r]).length===0&&delete t[r],!0;return!1},this.publish=function(n){if(t.hasOwnProperty(n)){var r=Array.prototype.slice.call(arguments,1),s=[];for(var i in t[n]){var l=t[n][i];try{l[0].apply(e,r)}catch(o){fn.console&&rr.error("jsPDF PubSub Error",o.message,o)}l[1]&&s.push(i)}s.length&&s.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function i0(e){if(!(this instanceof i0))return new i0(e);var t="opacity,stroke-opacity".split(",");for(var n in e)e.hasOwnProperty(n)&&t.indexOf(n)>=0&&(this[n]=e[n]);this.id="",this.objectNumber=-1}function f7(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function Bl(e,t,n,r,s){if(!(this instanceof Bl))return new Bl(e,t,n,r,s);this.type=e==="axial"?2:3,this.coords=t,this.colors=n,f7.call(this,r,s)}function cu(e,t,n,r,s){if(!(this instanceof cu))return new cu(e,t,n,r,s);this.boundingBox=e,this.xStep=t,this.yStep=n,this.stream="",this.cloneIndex=0,f7.call(this,r,s)}function Zt(e){var t,n=typeof arguments[0]=="string"?arguments[0]:"p",r=arguments[1],s=arguments[2],i=arguments[3],l=[],o=1,c=16,u="S",d=null;Kn(e=e||{})==="object"&&(n=e.orientation,r=e.unit||r,s=e.format||s,i=e.compress||e.compressPdf||i,(d=e.encryption||null)!==null&&(d.userPassword=d.userPassword||"",d.ownerPassword=d.ownerPassword||"",d.userPermissions=d.userPermissions||[]),o=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(c=e.floatPrecision),u=e.defaultPathOperation||"S"),l=e.filters||(i===!0?["FlateEncode"]:l),r=r||"mm",n=(""+(n||"P")).toLowerCase();var f=e.putOnlyUsedFonts||!1,m={},h={internal:{},__private__:{}};h.__private__.PubSub=T3;var x="1.3",y=h.__private__.getPdfVersion=function(){return x};h.__private__.setPdfVersion=function(k){x=k};var p={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};h.__private__.getPageFormats=function(){return p};var g=h.__private__.getPageFormat=function(k){return p[k]};s=s||"a4";var w="compat",v="advanced",N=w;function A(){this.saveGraphicsState(),ne(new Fe(de,0,0,-de,0,yl()*de).toString()+" cm"),this.setFontSize(this.getFontSize()/de),u="n",N=v}function P(){this.restoreGraphicsState(),u="S",N=w}var U=h.__private__.combineFontStyleAndFontWeight=function(k,J){if(k=="bold"&&J=="normal"||k=="bold"&&J==400||k=="normal"&&J=="italic"||k=="bold"&&J=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return J&&(k=J==400||J==="normal"?k==="italic"?"italic":"normal":J!=700&&J!=="bold"||k!=="normal"?(J==700?"bold":J)+""+k:"bold"),k};h.advancedAPI=function(k){var J=N===w;return J&&A.call(this),typeof k!="function"||(k(this),J&&P.call(this)),this},h.compatAPI=function(k){var J=N===v;return J&&P.call(this),typeof k!="function"||(k(this),J&&A.call(this)),this},h.isAdvancedAPI=function(){return N===v};var M,S=function(k){if(N!==v)throw new Error(k+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},C=h.roundToPrecision=h.__private__.roundToPrecision=function(k,J){var ue=t||J;if(isNaN(k)||isNaN(ue))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return k.toFixed(ue).replace(/0+$/,"")};M=h.hpf=h.__private__.hpf=typeof c=="number"?function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.hpf");return C(k,c)}:c==="smart"?function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.hpf");return C(k,k>-1&&k<1?16:5)}:function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.hpf");return C(k,16)};var _=h.f2=h.__private__.f2=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.f2");return C(k,2)},T=h.__private__.f3=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.f3");return C(k,3)},B=h.scale=h.__private__.scale=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.scale");return N===w?k*de:N===v?k:void 0},$=function(k){return B(function(J){return N===w?yl()-J:N===v?J:void 0}(k))};h.__private__.setPrecision=h.setPrecision=function(k){typeof parseInt(k,10)=="number"&&(t=parseInt(k,10))};var D,L="00000000000000000000000000000000",O=h.__private__.getFileId=function(){return L},W=h.__private__.setFileId=function(k){return L=k!==void 0&&/^[a-fA-F0-9]{32}$/.test(k)?k.toUpperCase():L.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),d!==null&&(Wn=new nu(d.userPermissions,d.userPassword,d.ownerPassword,L)),L};h.setFileId=function(k){return W(k),this},h.getFileId=function(){return O()};var E=h.__private__.convertDateToPDFDate=function(k){var J=k.getTimezoneOffset(),ue=J<0?"+":"-",ve=Math.floor(Math.abs(J/60)),Ce=Math.abs(J%60),Ye=[ue,F(ve),"'",F(Ce),"'"].join("");return["D:",k.getFullYear(),F(k.getMonth()+1),F(k.getDate()),F(k.getHours()),F(k.getMinutes()),F(k.getSeconds()),Ye].join("")},H=h.__private__.convertPDFDateToDate=function(k){var J=parseInt(k.substr(2,4),10),ue=parseInt(k.substr(6,2),10)-1,ve=parseInt(k.substr(8,2),10),Ce=parseInt(k.substr(10,2),10),Ye=parseInt(k.substr(12,2),10),st=parseInt(k.substr(14,2),10);return new Date(J,ue,ve,Ce,Ye,st,0)},V=h.__private__.setCreationDate=function(k){var J;if(k===void 0&&(k=new Date),k instanceof Date)J=E(k);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(k))throw new Error("Invalid argument passed to jsPDF.setCreationDate");J=k}return D=J},R=h.__private__.getCreationDate=function(k){var J=D;return k==="jsDate"&&(J=H(D)),J};h.setCreationDate=function(k){return V(k),this},h.getCreationDate=function(k){return R(k)};var q,F=h.__private__.padd2=function(k){return("0"+parseInt(k)).slice(-2)},G=h.__private__.padd2Hex=function(k){return("00"+(k=k.toString())).substr(k.length)},ee=0,ae=[],re=[],Q=0,fe=[],Se=[],oe=!1,pe=re;h.__private__.setCustomOutputDestination=function(k){oe=!0,pe=k};var me=function(k){oe||(pe=k)};h.__private__.resetCustomOutputDestination=function(){oe=!1,pe=re};var ne=h.__private__.out=function(k){return k=k.toString(),Q+=k.length+1,pe.push(k),pe},it=h.__private__.write=function(k){return ne(arguments.length===1?k.toString():Array.prototype.join.call(arguments," "))},$e=h.__private__.getArrayBuffer=function(k){for(var J=k.length,ue=new ArrayBuffer(J),ve=new Uint8Array(ue);J--;)ve[J]=k.charCodeAt(J);return ue},Oe=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];h.__private__.getStandardFonts=function(){return Oe};var qe=e.fontSize||16;h.__private__.setFontSize=h.setFontSize=function(k){return qe=N===v?k/de:k,this};var gt,ut=h.__private__.getFontSize=h.getFontSize=function(){return N===w?qe:qe*de},Rt=e.R2L||!1;h.__private__.setR2L=h.setR2L=function(k){return Rt=k,this},h.__private__.getR2L=h.getR2L=function(){return Rt};var Nt,ye=h.__private__.setZoomMode=function(k){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(k))gt=k;else if(isNaN(k)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(k)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+k+'" is not recognized.');gt=k}else gt=parseInt(k,10)};h.__private__.getZoomMode=function(){return gt};var ze,Ze=h.__private__.setPageMode=function(k){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(k)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+k+'" is not recognized.');Nt=k};h.__private__.getPageMode=function(){return Nt};var xe=h.__private__.setLayoutMode=function(k){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(k)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+k+'" is not recognized.');ze=k};h.__private__.getLayoutMode=function(){return ze},h.__private__.setDisplayMode=h.setDisplayMode=function(k,J,ue){return ye(k),xe(J),Ze(ue),this};var pt={title:"",subject:"",author:"",keywords:"",creator:""};h.__private__.getDocumentProperty=function(k){if(Object.keys(pt).indexOf(k)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return pt[k]},h.__private__.getDocumentProperties=function(){return pt},h.__private__.setDocumentProperties=h.setProperties=h.setDocumentProperties=function(k){for(var J in pt)pt.hasOwnProperty(J)&&k[J]&&(pt[J]=k[J]);return this},h.__private__.setDocumentProperty=function(k,J){if(Object.keys(pt).indexOf(k)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return pt[k]=J};var Ne,de,se,he,ke,be={},Le={},He=[],Ue={},De={},_e={},Ie={},ht=null,wt=0,St=[],Vt=new T3(h),qn=e.hotfixes||[],En={},Dn={},lt=[],Fe=function k(J,ue,ve,Ce,Ye,st){if(!(this instanceof k))return new k(J,ue,ve,Ce,Ye,st);isNaN(J)&&(J=1),isNaN(ue)&&(ue=0),isNaN(ve)&&(ve=0),isNaN(Ce)&&(Ce=1),isNaN(Ye)&&(Ye=0),isNaN(st)&&(st=0),this._matrix=[J,ue,ve,Ce,Ye,st]};Object.defineProperty(Fe.prototype,"sx",{get:function(){return this._matrix[0]},set:function(k){this._matrix[0]=k}}),Object.defineProperty(Fe.prototype,"shy",{get:function(){return this._matrix[1]},set:function(k){this._matrix[1]=k}}),Object.defineProperty(Fe.prototype,"shx",{get:function(){return this._matrix[2]},set:function(k){this._matrix[2]=k}}),Object.defineProperty(Fe.prototype,"sy",{get:function(){return this._matrix[3]},set:function(k){this._matrix[3]=k}}),Object.defineProperty(Fe.prototype,"tx",{get:function(){return this._matrix[4]},set:function(k){this._matrix[4]=k}}),Object.defineProperty(Fe.prototype,"ty",{get:function(){return this._matrix[5]},set:function(k){this._matrix[5]=k}}),Object.defineProperty(Fe.prototype,"a",{get:function(){return this._matrix[0]},set:function(k){this._matrix[0]=k}}),Object.defineProperty(Fe.prototype,"b",{get:function(){return this._matrix[1]},set:function(k){this._matrix[1]=k}}),Object.defineProperty(Fe.prototype,"c",{get:function(){return this._matrix[2]},set:function(k){this._matrix[2]=k}}),Object.defineProperty(Fe.prototype,"d",{get:function(){return this._matrix[3]},set:function(k){this._matrix[3]=k}}),Object.defineProperty(Fe.prototype,"e",{get:function(){return this._matrix[4]},set:function(k){this._matrix[4]=k}}),Object.defineProperty(Fe.prototype,"f",{get:function(){return this._matrix[5]},set:function(k){this._matrix[5]=k}}),Object.defineProperty(Fe.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(Fe.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(Fe.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(Fe.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),Fe.prototype.join=function(k){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(M).join(k)},Fe.prototype.multiply=function(k){var J=k.sx*this.sx+k.shy*this.shx,ue=k.sx*this.shy+k.shy*this.sy,ve=k.shx*this.sx+k.sy*this.shx,Ce=k.shx*this.shy+k.sy*this.sy,Ye=k.tx*this.sx+k.ty*this.shx+this.tx,st=k.tx*this.shy+k.ty*this.sy+this.ty;return new Fe(J,ue,ve,Ce,Ye,st)},Fe.prototype.decompose=function(){var k=this.sx,J=this.shy,ue=this.shx,ve=this.sy,Ce=this.tx,Ye=this.ty,st=Math.sqrt(k*k+J*J),Ot=(k/=st)*ue+(J/=st)*ve;ue-=k*Ot,ve-=J*Ot;var Yt=Math.sqrt(ue*ue+ve*ve);return Ot/=Yt,k*(ve/=Yt)<J*(ue/=Yt)&&(k=-k,J=-J,Ot=-Ot,st=-st),{scale:new Fe(st,0,0,Yt,0,0),translate:new Fe(1,0,0,1,Ce,Ye),rotate:new Fe(k,J,-J,k,0,0),skew:new Fe(1,0,Ot,1,0,0)}},Fe.prototype.toString=function(k){return this.join(" ")},Fe.prototype.inversed=function(){var k=this.sx,J=this.shy,ue=this.shx,ve=this.sy,Ce=this.tx,Ye=this.ty,st=1/(k*ve-J*ue),Ot=ve*st,Yt=-J*st,hn=-ue*st,pn=k*st;return new Fe(Ot,Yt,hn,pn,-Ot*Ce-hn*Ye,-Yt*Ce-pn*Ye)},Fe.prototype.applyToPoint=function(k){var J=k.x*this.sx+k.y*this.shx+this.tx,ue=k.x*this.shy+k.y*this.sy+this.ty;return new gl(J,ue)},Fe.prototype.applyToRectangle=function(k){var J=this.applyToPoint(k),ue=this.applyToPoint(new gl(k.x+k.w,k.y+k.h));return new dd(J.x,J.y,ue.x-J.x,ue.y-J.y)},Fe.prototype.clone=function(){var k=this.sx,J=this.shy,ue=this.shx,ve=this.sy,Ce=this.tx,Ye=this.ty;return new Fe(k,J,ue,ve,Ce,Ye)},h.Matrix=Fe;var Dt=h.matrixMult=function(k,J){return J.multiply(k)},Gt=new Fe(1,0,0,1,0,0);h.unitMatrix=h.identityMatrix=Gt;var Ht=function(k,J){if(!De[k]){var ue=(J instanceof Bl?"Sh":"P")+(Object.keys(Ue).length+1).toString(10);J.id=ue,De[k]=ue,Ue[ue]=J,Vt.publish("addPattern",J)}};h.ShadingPattern=Bl,h.TilingPattern=cu,h.addShadingPattern=function(k,J){return S("addShadingPattern()"),Ht(k,J),this},h.beginTilingPattern=function(k){S("beginTilingPattern()"),fd(k.boundingBox[0],k.boundingBox[1],k.boundingBox[2]-k.boundingBox[0],k.boundingBox[3]-k.boundingBox[1],k.matrix)},h.endTilingPattern=function(k,J){S("endTilingPattern()"),J.stream=Se[q].join(`
`),Ht(k,J),Vt.publish("endTilingPattern",J),lt.pop().restore()};var ot,_t=h.__private__.newObject=function(){var k=Et();return ft(k,!0),k},Et=h.__private__.newObjectDeferred=function(){return ee++,ae[ee]=function(){return Q},ee},ft=function(k,J){return J=typeof J=="boolean"&&J,ae[k]=Q,J&&ne(k+" 0 obj"),k},at=h.__private__.newAdditionalObject=function(){var k={objId:Et(),content:""};return fe.push(k),k},Te=Et(),Ee=Et(),et=h.__private__.decodeColorString=function(k){var J=k.split(" ");if(J.length!==2||J[1]!=="g"&&J[1]!=="G")J.length!==5||J[4]!=="k"&&J[4]!=="K"||(J=[(1-J[0])*(1-J[3]),(1-J[1])*(1-J[3]),(1-J[2])*(1-J[3]),"r"]);else{var ue=parseFloat(J[0]);J=[ue,ue,ue,"r"]}for(var ve="#",Ce=0;Ce<3;Ce++)ve+=("0"+Math.floor(255*parseFloat(J[Ce])).toString(16)).slice(-2);return ve},kt=h.__private__.encodeColorString=function(k){var J;typeof k=="string"&&(k={ch1:k});var ue=k.ch1,ve=k.ch2,Ce=k.ch3,Ye=k.ch4,st=k.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof ue=="string"&&ue.charAt(0)!=="#"){var Ot=new u7(ue);if(Ot.ok)ue=Ot.toHex();else if(!/^\d*\.?\d*$/.test(ue))throw new Error('Invalid color "'+ue+'" passed to jsPDF.encodeColorString.')}if(typeof ue=="string"&&/^#[0-9A-Fa-f]{3}$/.test(ue)&&(ue="#"+ue[1]+ue[1]+ue[2]+ue[2]+ue[3]+ue[3]),typeof ue=="string"&&/^#[0-9A-Fa-f]{6}$/.test(ue)){var Yt=parseInt(ue.substr(1),16);ue=Yt>>16&255,ve=Yt>>8&255,Ce=255&Yt}if(ve===void 0||Ye===void 0&&ue===ve&&ve===Ce)J=typeof ue=="string"?ue+" "+st[0]:k.precision===2?_(ue/255)+" "+st[0]:T(ue/255)+" "+st[0];else if(Ye===void 0||Kn(Ye)==="object"){if(Ye&&!isNaN(Ye.a)&&Ye.a===0)return["1.","1.","1.",st[1]].join(" ");J=typeof ue=="string"?[ue,ve,Ce,st[1]].join(" "):k.precision===2?[_(ue/255),_(ve/255),_(Ce/255),st[1]].join(" "):[T(ue/255),T(ve/255),T(Ce/255),st[1]].join(" ")}else J=typeof ue=="string"?[ue,ve,Ce,Ye,st[2]].join(" "):k.precision===2?[_(ue),_(ve),_(Ce),_(Ye),st[2]].join(" "):[T(ue),T(ve),T(Ce),T(Ye),st[2]].join(" ");return J},vt=h.__private__.getFilters=function(){return l},At=h.__private__.putStream=function(k){var J=(k=k||{}).data||"",ue=k.filters||vt(),ve=k.alreadyAppliedFilters||[],Ce=k.addLength1||!1,Ye=J.length,st=k.objectId,Ot=function(Zr){return Zr};if(d!==null&&st===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");d!==null&&(Ot=Wn.encryptor(st,0));var Yt={};ue===!0&&(ue=["FlateEncode"]);var hn=k.additionalKeyValues||[],pn=(Yt=Zt.API.processDataByFilters!==void 0?Zt.API.processDataByFilters(J,ue):{data:J,reverseChain:[]}).reverseChain+(Array.isArray(ve)?ve.join(" "):ve.toString());if(Yt.data.length!==0&&(hn.push({key:"Length",value:Yt.data.length}),Ce===!0&&hn.push({key:"Length1",value:Ye})),pn.length!=0)if(pn.split("/").length-1==1)hn.push({key:"Filter",value:pn});else{hn.push({key:"Filter",value:"["+pn+"]"});for(var zn=0;zn<hn.length;zn+=1)if(hn[zn].key==="DecodeParms"){for(var xr=[],qr=0;qr<Yt.reverseChain.split("/").length-1;qr+=1)xr.push("null");xr.push(hn[zn].value),hn[zn].value="["+xr.join(" ")+"]"}}ne("<<");for(var or=0;or<hn.length;or++)ne("/"+hn[or].key+" "+hn[or].value);ne(">>"),Yt.data.length!==0&&(ne("stream"),ne(Ot(Yt.data)),ne("endstream"))},Ct=h.__private__.putPage=function(k){var J=k.number,ue=k.data,ve=k.objId,Ce=k.contentsObjId;ft(ve,!0),ne("<</Type /Page"),ne("/Parent "+k.rootDictionaryObjId+" 0 R"),ne("/Resources "+k.resourceDictionaryObjId+" 0 R"),ne("/MediaBox ["+parseFloat(M(k.mediaBox.bottomLeftX))+" "+parseFloat(M(k.mediaBox.bottomLeftY))+" "+M(k.mediaBox.topRightX)+" "+M(k.mediaBox.topRightY)+"]"),k.cropBox!==null&&ne("/CropBox ["+M(k.cropBox.bottomLeftX)+" "+M(k.cropBox.bottomLeftY)+" "+M(k.cropBox.topRightX)+" "+M(k.cropBox.topRightY)+"]"),k.bleedBox!==null&&ne("/BleedBox ["+M(k.bleedBox.bottomLeftX)+" "+M(k.bleedBox.bottomLeftY)+" "+M(k.bleedBox.topRightX)+" "+M(k.bleedBox.topRightY)+"]"),k.trimBox!==null&&ne("/TrimBox ["+M(k.trimBox.bottomLeftX)+" "+M(k.trimBox.bottomLeftY)+" "+M(k.trimBox.topRightX)+" "+M(k.trimBox.topRightY)+"]"),k.artBox!==null&&ne("/ArtBox ["+M(k.artBox.bottomLeftX)+" "+M(k.artBox.bottomLeftY)+" "+M(k.artBox.topRightX)+" "+M(k.artBox.topRightY)+"]"),typeof k.userUnit=="number"&&k.userUnit!==1&&ne("/UserUnit "+k.userUnit),Vt.publish("putPage",{objId:ve,pageContext:St[J],pageNumber:J,page:ue}),ne("/Contents "+Ce+" 0 R"),ne(">>"),ne("endobj");var Ye=ue.join(`
`);return N===v&&(Ye+=`
Q`),ft(Ce,!0),At({data:Ye,filters:vt(),objectId:Ce}),ne("endobj"),ve},Lt=h.__private__.putPages=function(){var k,J,ue=[];for(k=1;k<=wt;k++)St[k].objId=Et(),St[k].contentsObjId=Et();for(k=1;k<=wt;k++)ue.push(Ct({number:k,data:Se[k],objId:St[k].objId,contentsObjId:St[k].contentsObjId,mediaBox:St[k].mediaBox,cropBox:St[k].cropBox,bleedBox:St[k].bleedBox,trimBox:St[k].trimBox,artBox:St[k].artBox,userUnit:St[k].userUnit,rootDictionaryObjId:Te,resourceDictionaryObjId:Ee}));ft(Te,!0),ne("<</Type /Pages");var ve="/Kids [";for(J=0;J<wt;J++)ve+=ue[J]+" 0 R ";ne(ve+"]"),ne("/Count "+wt),ne(">>"),ne("endobj"),Vt.publish("postPutPages")},Gn=function(k){Vt.publish("putFont",{font:k,out:ne,newObject:_t,putStream:At}),k.isAlreadyPutted!==!0&&(k.objectNumber=_t(),ne("<<"),ne("/Type /Font"),ne("/BaseFont /"+ru(k.postScriptName)),ne("/Subtype /Type1"),typeof k.encoding=="string"&&ne("/Encoding /"+k.encoding),ne("/FirstChar 32"),ne("/LastChar 255"),ne(">>"),ne("endobj"))},Lr=function(k){k.objectNumber=_t();var J=[];J.push({key:"Type",value:"/XObject"}),J.push({key:"Subtype",value:"/Form"}),J.push({key:"BBox",value:"["+[M(k.x),M(k.y),M(k.x+k.width),M(k.y+k.height)].join(" ")+"]"}),J.push({key:"Matrix",value:"["+k.matrix.toString()+"]"});var ue=k.pages[1].join(`
`);At({data:ue,additionalKeyValues:J,objectId:k.objectNumber}),ne("endobj")},nt=function(k,J){J||(J=21);var ue=_t(),ve=function(st,Ot){var Yt,hn=[],pn=1/(Ot-1);for(Yt=0;Yt<1;Yt+=pn)hn.push(Yt);if(hn.push(1),st[0].offset!=0){var zn={offset:0,color:st[0].color};st.unshift(zn)}if(st[st.length-1].offset!=1){var xr={offset:1,color:st[st.length-1].color};st.push(xr)}for(var qr="",or=0,Zr=0;Zr<hn.length;Zr++){for(Yt=hn[Zr];Yt>st[or+1].offset;)or++;var Hr=st[or].offset,fs=(Yt-Hr)/(st[or+1].offset-Hr),ki=st[or].color,Zs=st[or+1].color;qr+=G(Math.round((1-fs)*ki[0]+fs*Zs[0]).toString(16))+G(Math.round((1-fs)*ki[1]+fs*Zs[1]).toString(16))+G(Math.round((1-fs)*ki[2]+fs*Zs[2]).toString(16))}return qr.trim()}(k.colors,J),Ce=[];Ce.push({key:"FunctionType",value:"0"}),Ce.push({key:"Domain",value:"[0.0 1.0]"}),Ce.push({key:"Size",value:"["+J+"]"}),Ce.push({key:"BitsPerSample",value:"8"}),Ce.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Ce.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),At({data:ve,additionalKeyValues:Ce,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:ue}),ne("endobj"),k.objectNumber=_t(),ne("<< /ShadingType "+k.type),ne("/ColorSpace /DeviceRGB");var Ye="/Coords ["+M(parseFloat(k.coords[0]))+" "+M(parseFloat(k.coords[1]))+" ";k.type===2?Ye+=M(parseFloat(k.coords[2]))+" "+M(parseFloat(k.coords[3])):Ye+=M(parseFloat(k.coords[2]))+" "+M(parseFloat(k.coords[3]))+" "+M(parseFloat(k.coords[4]))+" "+M(parseFloat(k.coords[5])),ne(Ye+="]"),k.matrix&&ne("/Matrix ["+k.matrix.toString()+"]"),ne("/Function "+ue+" 0 R"),ne("/Extend [true true]"),ne(">>"),ne("endobj")},Qt=function(k,J){var ue=Et(),ve=_t();J.push({resourcesOid:ue,objectOid:ve}),k.objectNumber=ve;var Ce=[];Ce.push({key:"Type",value:"/Pattern"}),Ce.push({key:"PatternType",value:"1"}),Ce.push({key:"PaintType",value:"1"}),Ce.push({key:"TilingType",value:"1"}),Ce.push({key:"BBox",value:"["+k.boundingBox.map(M).join(" ")+"]"}),Ce.push({key:"XStep",value:M(k.xStep)}),Ce.push({key:"YStep",value:M(k.yStep)}),Ce.push({key:"Resources",value:ue+" 0 R"}),k.matrix&&Ce.push({key:"Matrix",value:"["+k.matrix.toString()+"]"}),At({data:k.stream,additionalKeyValues:Ce,objectId:k.objectNumber}),ne("endobj")},ct=function(k){for(var J in k.objectNumber=_t(),ne("<<"),k)switch(J){case"opacity":ne("/ca "+_(k[J]));break;case"stroke-opacity":ne("/CA "+_(k[J]))}ne(">>"),ne("endobj")},Bt=function(k){ft(k.resourcesOid,!0),ne("<<"),ne("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),function(){for(var J in ne("/Font <<"),be)be.hasOwnProperty(J)&&(f===!1||f===!0&&m.hasOwnProperty(J))&&ne("/"+J+" "+be[J].objectNumber+" 0 R");ne(">>")}(),function(){if(Object.keys(Ue).length>0){for(var J in ne("/Shading <<"),Ue)Ue.hasOwnProperty(J)&&Ue[J]instanceof Bl&&Ue[J].objectNumber>=0&&ne("/"+J+" "+Ue[J].objectNumber+" 0 R");Vt.publish("putShadingPatternDict"),ne(">>")}}(),function(J){if(Object.keys(Ue).length>0){for(var ue in ne("/Pattern <<"),Ue)Ue.hasOwnProperty(ue)&&Ue[ue]instanceof h.TilingPattern&&Ue[ue].objectNumber>=0&&Ue[ue].objectNumber<J&&ne("/"+ue+" "+Ue[ue].objectNumber+" 0 R");Vt.publish("putTilingPatternDict"),ne(">>")}}(k.objectOid),function(){if(Object.keys(_e).length>0){var J;for(J in ne("/ExtGState <<"),_e)_e.hasOwnProperty(J)&&_e[J].objectNumber>=0&&ne("/"+J+" "+_e[J].objectNumber+" 0 R");Vt.publish("putGStateDict"),ne(">>")}}(),function(){for(var J in ne("/XObject <<"),En)En.hasOwnProperty(J)&&En[J].objectNumber>=0&&ne("/"+J+" "+En[J].objectNumber+" 0 R");Vt.publish("putXobjectDict"),ne(">>")}(),ne(">>"),ne("endobj")},an=function(k){Le[k.fontName]=Le[k.fontName]||{},Le[k.fontName][k.fontStyle]=k.id},en=function(k,J,ue,ve,Ce){var Ye={id:"F"+(Object.keys(be).length+1).toString(10),postScriptName:k,fontName:J,fontStyle:ue,encoding:ve,isStandardFont:Ce||!1,metadata:{}};return Vt.publish("addFont",{font:Ye,instance:this}),be[Ye.id]=Ye,an(Ye),Ye.id},mt=h.__private__.pdfEscape=h.pdfEscape=function(k,J){return function(ue,ve){var Ce,Ye,st,Ot,Yt,hn,pn,zn,xr;if(st=(ve=ve||{}).sourceEncoding||"Unicode",Yt=ve.outputEncoding,(ve.autoencode||Yt)&&be[Ne].metadata&&be[Ne].metadata[st]&&be[Ne].metadata[st].encoding&&(Ot=be[Ne].metadata[st].encoding,!Yt&&be[Ne].encoding&&(Yt=be[Ne].encoding),!Yt&&Ot.codePages&&(Yt=Ot.codePages[0]),typeof Yt=="string"&&(Yt=Ot[Yt]),Yt)){for(pn=!1,hn=[],Ce=0,Ye=ue.length;Ce<Ye;Ce++)(zn=Yt[ue.charCodeAt(Ce)])?hn.push(String.fromCharCode(zn)):hn.push(ue[Ce]),hn[Ce].charCodeAt(0)>>8&&(pn=!0);ue=hn.join("")}for(Ce=ue.length;pn===void 0&&Ce!==0;)ue.charCodeAt(Ce-1)>>8&&(pn=!0),Ce--;if(!pn)return ue;for(hn=ve.noBOM?[]:[254,255],Ce=0,Ye=ue.length;Ce<Ye;Ce++){if((xr=(zn=ue.charCodeAt(Ce))>>8)>>8)throw new Error("Character at position "+Ce+" of string '"+ue+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");hn.push(xr),hn.push(zn-(xr<<8))}return String.fromCharCode.apply(void 0,hn)}(k,J).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Ft=h.__private__.beginPage=function(k){Se[++wt]=[],St[wt]={objId:0,contentsObjId:0,userUnit:Number(o),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(k[0]),topRightY:Number(k[1])}},Cn(wt),me(Se[q])},on=function(k,J){var ue,ve,Ce;switch(n=J||n,typeof k=="string"&&(ue=g(k.toLowerCase()),Array.isArray(ue)&&(ve=ue[0],Ce=ue[1])),Array.isArray(k)&&(ve=k[0]*de,Ce=k[1]*de),isNaN(ve)&&(ve=s[0],Ce=s[1]),(ve>14400||Ce>14400)&&(rr.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),ve=Math.min(14400,ve),Ce=Math.min(14400,Ce)),s=[ve,Ce],n.substr(0,1)){case"l":Ce>ve&&(s=[Ce,ve]);break;case"p":ve>Ce&&(s=[Ce,ve])}Ft(s),kc(Ke),ne(Cc),cd!==0&&ne(cd+" J"),ud!==0&&ne(ud+" j"),Vt.publish("addPage",{pageNumber:wt})},rn=function(k){k>0&&k<=wt&&(Se.splice(k,1),St.splice(k,1),wt--,q>wt&&(q=wt),this.setPage(q))},Cn=function(k){k>0&&k<=wt&&(q=k)},bn=h.__private__.getNumberOfPages=h.getNumberOfPages=function(){return Se.length-1},_n=function(k,J,ue){var ve,Ce=void 0;return ue=ue||{},k=k!==void 0?k:be[Ne].fontName,J=J!==void 0?J:be[Ne].fontStyle,ve=k.toLowerCase(),Le[ve]!==void 0&&Le[ve][J]!==void 0?Ce=Le[ve][J]:Le[k]!==void 0&&Le[k][J]!==void 0?Ce=Le[k][J]:ue.disableWarning===!1&&rr.warn("Unable to look up font label for font '"+k+"', '"+J+"'. Refer to getFontList() for available fonts."),Ce||ue.noFallback||(Ce=Le.times[J])==null&&(Ce=Le.times.normal),Ce},mn=h.__private__.putInfo=function(){var k=_t(),J=function(ve){return ve};for(var ue in d!==null&&(J=Wn.encryptor(k,0)),ne("<<"),ne("/Producer ("+mt(J("jsPDF "+Zt.version))+")"),pt)pt.hasOwnProperty(ue)&&pt[ue]&&ne("/"+ue.substr(0,1).toUpperCase()+ue.substr(1)+" ("+mt(J(pt[ue]))+")");ne("/CreationDate ("+mt(J(D))+")"),ne(">>"),ne("endobj")},Bn=h.__private__.putCatalog=function(k){var J=(k=k||{}).rootDictionaryObjId||Te;switch(_t(),ne("<<"),ne("/Type /Catalog"),ne("/Pages "+J+" 0 R"),gt||(gt="fullwidth"),gt){case"fullwidth":ne("/OpenAction [3 0 R /FitH null]");break;case"fullheight":ne("/OpenAction [3 0 R /FitV null]");break;case"fullpage":ne("/OpenAction [3 0 R /Fit]");break;case"original":ne("/OpenAction [3 0 R /XYZ null null 1]");break;default:var ue=""+gt;ue.substr(ue.length-1)==="%"&&(gt=parseInt(gt)/100),typeof gt=="number"&&ne("/OpenAction [3 0 R /XYZ null null "+_(gt)+"]")}switch(ze||(ze="continuous"),ze){case"continuous":ne("/PageLayout /OneColumn");break;case"single":ne("/PageLayout /SinglePage");break;case"two":case"twoleft":ne("/PageLayout /TwoColumnLeft");break;case"tworight":ne("/PageLayout /TwoColumnRight")}Nt&&ne("/PageMode /"+Nt),Vt.publish("putCatalog"),ne(">>"),ne("endobj")},Hn=h.__private__.putTrailer=function(){ne("trailer"),ne("<<"),ne("/Size "+(ee+1)),ne("/Root "+ee+" 0 R"),ne("/Info "+(ee-1)+" 0 R"),d!==null&&ne("/Encrypt "+Wn.oid+" 0 R"),ne("/ID [ <"+L+"> <"+L+"> ]"),ne(">>")},hr=h.__private__.putHeader=function(){ne("%PDF-"+x),ne("%")},Jr=h.__private__.putXRef=function(){var k="0000000000";ne("xref"),ne("0 "+(ee+1)),ne("0000000000 65535 f ");for(var J=1;J<=ee;J++)typeof ae[J]=="function"?ne((k+ae[J]()).slice(-10)+" 00000 n "):ae[J]!==void 0?ne((k+ae[J]).slice(-10)+" 00000 n "):ne("0000000000 00000 n ")},ar=h.__private__.buildDocument=function(){var k;ee=0,Q=0,re=[],ae=[],fe=[],Te=Et(),Ee=Et(),me(re),Vt.publish("buildDocument"),hr(),Lt(),function(){Vt.publish("putAdditionalObjects");for(var ue=0;ue<fe.length;ue++){var ve=fe[ue];ft(ve.objId,!0),ne(ve.content),ne("endobj")}Vt.publish("postPutAdditionalObjects")}(),k=[],function(){for(var ue in be)be.hasOwnProperty(ue)&&(f===!1||f===!0&&m.hasOwnProperty(ue))&&Gn(be[ue])}(),function(){var ue;for(ue in _e)_e.hasOwnProperty(ue)&&ct(_e[ue])}(),function(){for(var ue in En)En.hasOwnProperty(ue)&&Lr(En[ue])}(),function(ue){var ve;for(ve in Ue)Ue.hasOwnProperty(ve)&&(Ue[ve]instanceof Bl?nt(Ue[ve]):Ue[ve]instanceof cu&&Qt(Ue[ve],ue))}(k),Vt.publish("putResources"),k.forEach(Bt),Bt({resourcesOid:Ee,objectOid:Number.MAX_SAFE_INTEGER}),Vt.publish("postPutResources"),d!==null&&(Wn.oid=_t(),ne("<<"),ne("/Filter /Standard"),ne("/V "+Wn.v),ne("/R "+Wn.r),ne("/U <"+Wn.toHexString(Wn.U)+">"),ne("/O <"+Wn.toHexString(Wn.O)+">"),ne("/P "+Wn.P),ne(">>"),ne("endobj")),mn(),Bn();var J=Q;return Jr(),Hn(),ne("startxref"),ne(""+J),ne("%%EOF"),me(Se[q]),re.join(`
`)},Rn=h.__private__.getBlob=function(k){return new Blob([$e(k)],{type:"application/pdf"})},mr=h.output=h.__private__.output=(ot=function(k,J){switch(typeof(J=J||{})=="string"?J={filename:J}:J.filename=J.filename||"generated.pdf",k){case void 0:return ar();case"save":h.save(J.filename);break;case"arraybuffer":return $e(ar());case"blob":return Rn(ar());case"bloburi":case"bloburl":if(fn.URL!==void 0&&typeof fn.URL.createObjectURL=="function")return fn.URL&&fn.URL.createObjectURL(Rn(ar()))||void 0;rr.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var ue="",ve=ar();try{ue=C3(ve)}catch{ue=C3(unescape(encodeURIComponent(ve)))}return"data:application/pdf;filename="+J.filename+";base64,"+ue;case"pdfobjectnewwindow":if(Object.prototype.toString.call(fn)==="[object Window]"){var Ce="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Ye=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';J.pdfObjectUrl&&(Ce=J.pdfObjectUrl,Ye="");var st='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+Ce+'"'+Ye+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(J)+");<\/script></body></html>",Ot=fn.open();return Ot!==null&&Ot.document.write(st),Ot}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(fn)==="[object Window]"){var Yt='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(J.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+J.filename+'" width="500px" height="400px" /></body></html>',hn=fn.open();if(hn!==null){hn.document.write(Yt);var pn=this;hn.document.documentElement.querySelector("#pdfViewer").onload=function(){hn.document.title=J.filename,hn.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(pn.output("bloburl"))}}return hn}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(fn)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var zn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",J)+'"></iframe></body></html>',xr=fn.open();if(xr!==null&&(xr.document.write(zn),xr.document.title=J.filename),xr||typeof safari>"u")return xr;break;case"datauri":case"dataurl":return fn.document.location.href=this.output("datauristring",J);default:return null}},ot.foo=function(){try{return ot.apply(this,arguments)}catch(ue){var k=ue.stack||"";~k.indexOf(" at ")&&(k=k.split(" at ")[1]);var J="Error in function "+k.split(`
`)[0].split("<")[0]+": "+ue.message;if(!fn.console)throw new Error(J);fn.console.error(J,ue),fn.alert&&alert(J)}},ot.foo.bar=ot,ot.foo),Nr=function(k){return Array.isArray(qn)===!0&&qn.indexOf(k)>-1};switch(r){case"pt":de=1;break;case"mm":de=72/25.4;break;case"cm":de=72/2.54;break;case"in":de=72;break;case"px":de=Nr("px_scaling")==1?.75:96/72;break;case"pc":case"em":de=12;break;case"ex":de=6;break;default:if(typeof r!="number")throw new Error("Invalid unit: "+r);de=r}var Wn=null;V(),W();var vo=h.__private__.getPageInfo=h.getPageInfo=function(k){if(isNaN(k)||k%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:St[k].objId,pageNumber:k,pageContext:St[k]}},vc=h.__private__.getPageInfoByObjId=function(k){if(isNaN(k)||k%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var J in St)if(St[J].objId===k)break;return vo(J)},wc=h.__private__.getCurrentPageInfo=h.getCurrentPageInfo=function(){return{objId:St[q].objId,pageNumber:q,pageContext:St[q]}};h.addPage=function(){return on.apply(this,arguments),this},h.setPage=function(){return Cn.apply(this,arguments),me.call(this,Se[q]),this},h.insertPage=function(k){return this.addPage(),this.movePage(q,k),this},h.movePage=function(k,J){var ue,ve;if(k>J){ue=Se[k],ve=St[k];for(var Ce=k;Ce>J;Ce--)Se[Ce]=Se[Ce-1],St[Ce]=St[Ce-1];Se[J]=ue,St[J]=ve,this.setPage(J)}else if(k<J){ue=Se[k],ve=St[k];for(var Ye=k;Ye<J;Ye++)Se[Ye]=Se[Ye+1],St[Ye]=St[Ye+1];Se[J]=ue,St[J]=ve,this.setPage(J)}return this},h.deletePage=function(){return rn.apply(this,arguments),this},h.__private__.text=h.text=function(k,J,ue,ve,Ce){var Ye,st,Ot,Yt,hn,pn,zn,xr,qr,or=(ve=ve||{}).scope||this;if(typeof k=="number"&&typeof J=="number"&&(typeof ue=="string"||Array.isArray(ue))){var Zr=ue;ue=J,J=k,k=Zr}if(arguments[3]instanceof Fe==0?(Ot=arguments[4],Yt=arguments[5],Kn(zn=arguments[3])==="object"&&zn!==null||(typeof Ot=="string"&&(Yt=Ot,Ot=null),typeof zn=="string"&&(Yt=zn,zn=null),typeof zn=="number"&&(Ot=zn,zn=null),ve={flags:zn,angle:Ot,align:Yt})):(S("The transform parameter of text() with a Matrix value"),qr=Ce),isNaN(J)||isNaN(ue)||k==null)throw new Error("Invalid arguments passed to jsPDF.text");if(k.length===0)return or;var Hr,fs="",ki=typeof ve.lineHeightFactor=="number"?ve.lineHeightFactor:Ge,Zs=or.internal.scaleFactor;function Th(Vn){return Vn=Vn.split("	").join(Array(ve.TabLen||9).join(" ")),mt(Vn,zn)}function Lc(Vn){for(var tr,Rr=Vn.concat(),Xr=[],Wa=Rr.length;Wa--;)typeof(tr=Rr.shift())=="string"?Xr.push(tr):Array.isArray(Vn)&&(tr.length===1||tr[1]===void 0&&tr[2]===void 0)?Xr.push(tr[0]):Xr.push([tr[0],tr[1],tr[2]]);return Xr}function bl(Vn,tr){var Rr;if(typeof Vn=="string")Rr=tr(Vn)[0];else if(Array.isArray(Vn)){for(var Xr,Wa,Nd=Vn.concat(),$c=[],Rh=Nd.length;Rh--;)typeof(Xr=Nd.shift())=="string"?$c.push(tr(Xr)[0]):Array.isArray(Xr)&&typeof Xr[0]=="string"&&(Wa=tr(Xr[0],Xr[1],Xr[2]),$c.push([Wa[0],Wa[1],Wa[2]]));Rr=$c}return Rr}var jo=!1,vl=!0;if(typeof k=="string")jo=!0;else if(Array.isArray(k)){var wl=k.concat();st=[];for(var Nl,Ns=wl.length;Ns--;)(typeof(Nl=wl.shift())!="string"||Array.isArray(Nl)&&typeof Nl[0]!="string")&&(vl=!1);jo=vl}if(jo===!1)throw new Error('Type of text must be string or Array. "'+k+'" is not recognized.');typeof k=="string"&&(k=k.match(/[\r?\n]/)?k.split(/\r\n|\r|\n/g):[k]);var jl=qe/or.internal.scaleFactor,Sl=jl*(ki-1);switch(ve.baseline){case"bottom":ue-=Sl;break;case"top":ue+=jl-Sl;break;case"hanging":ue+=jl-2*Sl;break;case"middle":ue+=jl/2-Sl}if((pn=ve.maxWidth||0)>0&&(typeof k=="string"?k=or.splitTextToSize(k,pn):Object.prototype.toString.call(k)==="[object Array]"&&(k=k.reduce(function(Vn,tr){return Vn.concat(or.splitTextToSize(tr,pn))},[]))),Ye={text:k,x:J,y:ue,options:ve,mutex:{pdfEscape:mt,activeFontKey:Ne,fonts:be,activeFontSize:qe}},Vt.publish("preProcessText",Ye),k=Ye.text,Ot=(ve=Ye.options).angle,qr instanceof Fe==0&&Ot&&typeof Ot=="number"){Ot*=Math.PI/180,ve.rotationDirection===0&&(Ot=-Ot),N===v&&(Ot=-Ot);var hd=Math.cos(Ot),md=Math.sin(Ot);qr=new Fe(hd,md,-md,hd,0,0)}else Ot&&Ot instanceof Fe&&(qr=Ot);N!==v||qr||(qr=Gt),(hn=ve.charSpace||Ic)!==void 0&&(fs+=M(B(hn))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(xr=ve.horizontalScale)!==void 0&&(fs+=M(100*xr)+` Tz
`),ve.lang;var jr=-1,qa=ve.renderingMode!==void 0?ve.renderingMode:ve.stroke,Mc=or.internal.getCurrentPageInfo().pageContext;switch(qa){case 0:case!1:case"fill":jr=0;break;case 1:case!0:case"stroke":jr=1;break;case 2:case"fillThenStroke":jr=2;break;case 3:case"invisible":jr=3;break;case 4:case"fillAndAddForClipping":jr=4;break;case 5:case"strokeAndAddPathForClipping":jr=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":jr=6;break;case 7:case"addToPathForClipping":jr=7}var Lh=Mc.usedRenderingMode!==void 0?Mc.usedRenderingMode:-1;jr!==-1?fs+=jr+` Tr
`:Lh!==-1&&(fs+=`0 Tr
`),jr!==-1&&(Mc.usedRenderingMode=jr),Yt=ve.align||"left";var Ei,_l=qe*ki,pd=or.internal.pageSize.getWidth(),gd=be[Ne];hn=ve.charSpace||Ic,pn=ve.maxWidth||0,zn=Object.assign({autoencode:!0,noBOM:!0},ve.flags);var So=[],Al=function(Vn){return or.getStringUnitWidth(Vn,{font:gd,charSpace:hn,fontSize:qe,doKerning:!1})*qe/Zs};if(Object.prototype.toString.call(k)==="[object Array]"){var ci;st=Lc(k),Yt!=="left"&&(Ei=st.map(Al));var ui,_o=0;if(Yt==="right"){J-=Ei[0],k=[],Ns=st.length;for(var Ha=0;Ha<Ns;Ha++)Ha===0?(ui=Da(J),ci=Ba(ue)):(ui=B(_o-Ei[Ha]),ci=-_l),k.push([st[Ha],ui,ci]),_o=Ei[Ha]}else if(Yt==="center"){J-=Ei[0]/2,k=[],Ns=st.length;for(var Ao=0;Ao<Ns;Ao++)Ao===0?(ui=Da(J),ci=Ba(ue)):(ui=B((_o-Ei[Ao])/2),ci=-_l),k.push([st[Ao],ui,ci]),_o=Ei[Ao]}else if(Yt==="left"){k=[],Ns=st.length;for(var xd=0;xd<Ns;xd++)k.push(st[xd])}else if(Yt==="justify"&&gd.encoding==="Identity-H"){k=[],Ns=st.length,pn=pn!==0?pn:pd;for(var Rc=0,Mr=0;Mr<Ns;Mr++)if(ci=Mr===0?Ba(ue):-_l,ui=Mr===0?Da(J):Rc,Mr<Ns-1){var Mh=B((pn-Ei[Mr])/(st[Mr].split(" ").length-1)),ha=st[Mr].split(" ");k.push([ha[0]+" ",ui,ci]),Rc=0;for(var ma=1;ma<ha.length;ma++){var yd=(Al(ha[ma-1]+" "+ha[ma])-Al(ha[ma]))*Zs+Mh;ma==ha.length-1?k.push([ha[ma],yd,0]):k.push([ha[ma]+" ",yd,0]),Rc-=yd}}else k.push([st[Mr],ui,ci]);k.push(["",Rc,0])}else{if(Yt!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(k=[],Ns=st.length,pn=pn!==0?pn:pd,Mr=0;Mr<Ns;Mr++){ci=Mr===0?Ba(ue):-_l,ui=Mr===0?Da(J):0;var bd=st[Mr].split(" ").length-1,vd=bd>0?(pn-Ei[Mr])/bd:0;Mr<Ns-1?So.push(M(B(vd))):So.push(0),k.push([st[Mr],ui,ci])}}}(typeof ve.R2L=="boolean"?ve.R2L:Rt)===!0&&(k=bl(k,function(Vn,tr,Rr){return[Vn.split("").reverse().join(""),tr,Rr]})),Ye={text:k,x:J,y:ue,options:ve,mutex:{pdfEscape:mt,activeFontKey:Ne,fonts:be,activeFontSize:qe}},Vt.publish("postProcessText",Ye),k=Ye.text,Hr=Ye.mutex.isHex||!1;var wd=be[Ne].encoding;wd!=="WinAnsiEncoding"&&wd!=="StandardEncoding"||(k=bl(k,function(Vn,tr,Rr){return[Th(Vn),tr,Rr]})),st=Lc(k),k=[];for(var ko,Eo,Co,kl=Array.isArray(st[0])?1:0,Po="",El=function(Vn,tr,Rr){var Xr="";return Rr instanceof Fe?(Rr=typeof ve.angle=="number"?Dt(Rr,new Fe(1,0,0,1,Vn,tr)):Dt(new Fe(1,0,0,1,Vn,tr),Rr),N===v&&(Rr=Dt(new Fe(1,0,0,-1,0,0),Rr)),Xr=Rr.join(" ")+` Tm
`):Xr=M(Vn)+" "+M(tr)+` Td
`,Xr},Ci=0;Ci<st.length;Ci++){switch(Po="",kl){case 1:Co=(Hr?"<":"(")+st[Ci][0]+(Hr?">":")"),ko=parseFloat(st[Ci][1]),Eo=parseFloat(st[Ci][2]);break;case 0:Co=(Hr?"<":"(")+st[Ci]+(Hr?">":")"),ko=Da(J),Eo=Ba(ue)}So!==void 0&&So[Ci]!==void 0&&(Po=So[Ci]+` Tw
`),Ci===0?k.push(Po+El(ko,Eo,qr)+Co):kl===0?k.push(Po+Co):kl===1&&k.push(Po+El(ko,Eo,qr)+Co)}k=kl===0?k.join(` Tj
T* `):k.join(` Tj
`),k+=` Tj
`;var pa=`BT
/`;return pa+=Ne+" "+qe+` Tf
`,pa+=M(qe*ki)+` TL
`,pa+=ml+`
`,pa+=fs,pa+=k,ne(pa+="ET"),m[Ne]=!0,or};var Nc=h.__private__.clip=h.clip=function(k){return ne(k==="evenodd"?"W*":"W"),this};h.clipEvenOdd=function(){return Nc("evenodd")},h.__private__.discardPath=h.discardPath=function(){return ne("n"),this};var li=h.__private__.isValidStyle=function(k){var J=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(k)!==-1&&(J=!0),J};h.__private__.setDefaultPathOperation=h.setDefaultPathOperation=function(k){return li(k)&&(u=k),this};var fl=h.__private__.getStyle=h.getStyle=function(k){var J=u;switch(k){case"D":case"S":J="S";break;case"F":J="f";break;case"FD":case"DF":J="B";break;case"f":case"f*":case"B":case"B*":J=k}return J},hl=h.close=function(){return ne("h"),this};h.stroke=function(){return ne("S"),this},h.fill=function(k){return Hi("f",k),this},h.fillEvenOdd=function(k){return Hi("f*",k),this},h.fillStroke=function(k){return Hi("B",k),this},h.fillStrokeEvenOdd=function(k){return Hi("B*",k),this};var Hi=function(k,J){Kn(J)==="object"?Sc(J,k):ne(k)},wo=function(k){k===null||N===v&&k===void 0||(k=fl(k),ne(k))};function jc(k,J,ue,ve,Ce){var Ye=new cu(J||this.boundingBox,ue||this.xStep,ve||this.yStep,this.gState,Ce||this.matrix);Ye.stream=this.stream;var st=k+"$$"+this.cloneIndex+++"$$";return Ht(st,Ye),Ye}var Sc=function(k,J){var ue=De[k.key],ve=Ue[ue];if(ve instanceof Bl)ne("q"),ne(_c(J)),ve.gState&&h.setGState(ve.gState),ne(k.matrix.toString()+" cm"),ne("/"+ue+" sh"),ne("Q");else if(ve instanceof cu){var Ce=new Fe(1,0,0,-1,0,yl());k.matrix&&(Ce=Ce.multiply(k.matrix||Gt),ue=jc.call(ve,k.key,k.boundingBox,k.xStep,k.yStep,Ce).id),ne("q"),ne("/Pattern cs"),ne("/"+ue+" scn"),ve.gState&&h.setGState(ve.gState),ne(J),ne("Q")}},_c=function(k){switch(k){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},No=h.moveTo=function(k,J){return ne(M(B(k))+" "+M($(J))+" m"),this},fa=h.lineTo=function(k,J){return ne(M(B(k))+" "+M($(J))+" l"),this},Wi=h.curveTo=function(k,J,ue,ve,Ce,Ye){return ne([M(B(k)),M($(J)),M(B(ue)),M($(ve)),M(B(Ce)),M($(Ye)),"c"].join(" ")),this};h.__private__.line=h.line=function(k,J,ue,ve,Ce){if(isNaN(k)||isNaN(J)||isNaN(ue)||isNaN(ve)||!li(Ce))throw new Error("Invalid arguments passed to jsPDF.line");return N===w?this.lines([[ue-k,ve-J]],k,J,[1,1],Ce||"S"):this.lines([[ue-k,ve-J]],k,J,[1,1]).stroke()},h.__private__.lines=h.lines=function(k,J,ue,ve,Ce,Ye){var st,Ot,Yt,hn,pn,zn,xr,qr,or,Zr,Hr,fs;if(typeof k=="number"&&(fs=ue,ue=J,J=k,k=fs),ve=ve||[1,1],Ye=Ye||!1,isNaN(J)||isNaN(ue)||!Array.isArray(k)||!Array.isArray(ve)||!li(Ce)||typeof Ye!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(No(J,ue),st=ve[0],Ot=ve[1],hn=k.length,Zr=J,Hr=ue,Yt=0;Yt<hn;Yt++)(pn=k[Yt]).length===2?(Zr=pn[0]*st+Zr,Hr=pn[1]*Ot+Hr,fa(Zr,Hr)):(zn=pn[0]*st+Zr,xr=pn[1]*Ot+Hr,qr=pn[2]*st+Zr,or=pn[3]*Ot+Hr,Zr=pn[4]*st+Zr,Hr=pn[5]*Ot+Hr,Wi(zn,xr,qr,or,Zr,Hr));return Ye&&hl(),wo(Ce),this},h.path=function(k){for(var J=0;J<k.length;J++){var ue=k[J],ve=ue.c;switch(ue.op){case"m":No(ve[0],ve[1]);break;case"l":fa(ve[0],ve[1]);break;case"c":Wi.apply(this,ve);break;case"h":hl()}}return this},h.__private__.rect=h.rect=function(k,J,ue,ve,Ce){if(isNaN(k)||isNaN(J)||isNaN(ue)||isNaN(ve)||!li(Ce))throw new Error("Invalid arguments passed to jsPDF.rect");return N===w&&(ve=-ve),ne([M(B(k)),M($(J)),M(B(ue)),M(B(ve)),"re"].join(" ")),wo(Ce),this},h.__private__.triangle=h.triangle=function(k,J,ue,ve,Ce,Ye,st){if(isNaN(k)||isNaN(J)||isNaN(ue)||isNaN(ve)||isNaN(Ce)||isNaN(Ye)||!li(st))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[ue-k,ve-J],[Ce-ue,Ye-ve],[k-Ce,J-Ye]],k,J,[1,1],st,!0),this},h.__private__.roundedRect=h.roundedRect=function(k,J,ue,ve,Ce,Ye,st){if(isNaN(k)||isNaN(J)||isNaN(ue)||isNaN(ve)||isNaN(Ce)||isNaN(Ye)||!li(st))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var Ot=4/3*(Math.SQRT2-1);return Ce=Math.min(Ce,.5*ue),Ye=Math.min(Ye,.5*ve),this.lines([[ue-2*Ce,0],[Ce*Ot,0,Ce,Ye-Ye*Ot,Ce,Ye],[0,ve-2*Ye],[0,Ye*Ot,-Ce*Ot,Ye,-Ce,Ye],[2*Ce-ue,0],[-Ce*Ot,0,-Ce,-Ye*Ot,-Ce,-Ye],[0,2*Ye-ve],[0,-Ye*Ot,Ce*Ot,-Ye,Ce,-Ye]],k+Ce,J,[1,1],st,!0),this},h.__private__.ellipse=h.ellipse=function(k,J,ue,ve,Ce){if(isNaN(k)||isNaN(J)||isNaN(ue)||isNaN(ve)||!li(Ce))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Ye=4/3*(Math.SQRT2-1)*ue,st=4/3*(Math.SQRT2-1)*ve;return No(k+ue,J),Wi(k+ue,J-st,k+Ye,J-ve,k,J-ve),Wi(k-Ye,J-ve,k-ue,J-st,k-ue,J),Wi(k-ue,J+st,k-Ye,J+ve,k,J+ve),Wi(k+Ye,J+ve,k+ue,J+st,k+ue,J),wo(Ce),this},h.__private__.circle=h.circle=function(k,J,ue,ve){if(isNaN(k)||isNaN(J)||isNaN(ue)||!li(ve))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(k,J,ue,ue,ve)},h.setFont=function(k,J,ue){return ue&&(J=U(J,ue)),Ne=_n(k,J,{disableWarning:!1}),this};var Ac=h.__private__.getFont=h.getFont=function(){return be[_n.apply(h,arguments)]};h.__private__.getFontList=h.getFontList=function(){var k,J,ue={};for(k in Le)if(Le.hasOwnProperty(k))for(J in ue[k]=[],Le[k])Le[k].hasOwnProperty(J)&&ue[k].push(J);return ue},h.addFont=function(k,J,ue,ve,Ce){var Ye=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Ye.indexOf(arguments[3])!==-1?Ce=arguments[3]:arguments[3]&&Ye.indexOf(arguments[3])==-1&&(ue=U(ue,ve)),en.call(this,k,J,ue,Ce=Ce||"Identity-H")};var Ge,Ke=e.lineWidth||.200025,tn=h.__private__.getLineWidth=h.getLineWidth=function(){return Ke},kc=h.__private__.setLineWidth=h.setLineWidth=function(k){return Ke=k,ne(M(B(k))+" w"),this};h.__private__.setLineDash=Zt.API.setLineDash=Zt.API.setLineDashPattern=function(k,J){if(k=k||[],J=J||0,isNaN(J)||!Array.isArray(k))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return k=k.map(function(ue){return M(B(ue))}).join(" "),J=M(B(J)),ne("["+k+"] "+J+" d"),this};var od=h.__private__.getLineHeight=h.getLineHeight=function(){return qe*Ge};h.__private__.getLineHeight=h.getLineHeight=function(){return qe*Ge};var Ec=h.__private__.setLineHeightFactor=h.setLineHeightFactor=function(k){return typeof(k=k||1.15)=="number"&&(Ge=k),this},pg=h.__private__.getLineHeightFactor=h.getLineHeightFactor=function(){return Ge};Ec(e.lineHeight);var Da=h.__private__.getHorizontalCoordinate=function(k){return B(k)},Ba=h.__private__.getVerticalCoordinate=function(k){return N===v?k:St[q].mediaBox.topRightY-St[q].mediaBox.bottomLeftY-B(k)},gg=h.__private__.getHorizontalCoordinateString=h.getHorizontalCoordinateString=function(k){return M(Da(k))},xg=h.__private__.getVerticalCoordinateString=h.getVerticalCoordinateString=function(k){return M(Ba(k))},Cc=e.strokeColor||"0 G";h.__private__.getStrokeColor=h.getDrawColor=function(){return et(Cc)},h.__private__.setStrokeColor=h.setDrawColor=function(k,J,ue,ve){return Cc=kt({ch1:k,ch2:J,ch3:ue,ch4:ve,pdfColorType:"draw",precision:2}),ne(Cc),this};var ld=e.fillColor||"0 g";h.__private__.getFillColor=h.getFillColor=function(){return et(ld)},h.__private__.setFillColor=h.setFillColor=function(k,J,ue,ve){return ld=kt({ch1:k,ch2:J,ch3:ue,ch4:ve,pdfColorType:"fill",precision:2}),ne(ld),this};var ml=e.textColor||"0 g",Pc=h.__private__.getTextColor=h.getTextColor=function(){return et(ml)};h.__private__.setTextColor=h.setTextColor=function(k,J,ue,ve){return ml=kt({ch1:k,ch2:J,ch3:ue,ch4:ve,pdfColorType:"text",precision:3}),this};var Ic=e.charSpace,yg=h.__private__.getCharSpace=h.getCharSpace=function(){return parseFloat(Ic||0)};h.__private__.setCharSpace=h.setCharSpace=function(k){if(isNaN(k))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Ic=k,this};var cd=0;h.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},h.__private__.setLineCap=h.setLineCap=function(k){var J=h.CapJoinStyles[k];if(J===void 0)throw new Error("Line cap style of '"+k+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return cd=J,ne(J+" J"),this};var ud=0;h.__private__.setLineJoin=h.setLineJoin=function(k){var J=h.CapJoinStyles[k];if(J===void 0)throw new Error("Line join style of '"+k+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return ud=J,ne(J+" j"),this},h.__private__.setLineMiterLimit=h.__private__.setMiterLimit=h.setLineMiterLimit=h.setMiterLimit=function(k){if(k=k||0,isNaN(k))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return ne(M(B(k))+" M"),this},h.GState=i0,h.setGState=function(k){(k=typeof k=="string"?_e[Ie[k]]:pl(null,k)).equals(ht)||(ne("/"+k.id+" gs"),ht=k)};var pl=function(k,J){if(!k||!Ie[k]){var ue=!1;for(var ve in _e)if(_e.hasOwnProperty(ve)&&_e[ve].equals(J)){ue=!0;break}if(ue)J=_e[ve];else{var Ce="GS"+(Object.keys(_e).length+1).toString(10);_e[Ce]=J,J.id=Ce}return k&&(Ie[k]=J.id),Vt.publish("addGState",J),J}};h.addGState=function(k,J){return pl(k,J),this},h.saveGraphicsState=function(){return ne("q"),He.push({key:Ne,size:qe,color:ml}),this},h.restoreGraphicsState=function(){ne("Q");var k=He.pop();return Ne=k.key,qe=k.size,ml=k.color,ht=null,this},h.setCurrentTransformationMatrix=function(k){return ne(k.toString()+" cm"),this},h.comment=function(k){return ne("#"+k),this};var gl=function(k,J){var ue=k||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return ue},set:function(Ye){isNaN(Ye)||(ue=parseFloat(Ye))}});var ve=J||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return ve},set:function(Ye){isNaN(Ye)||(ve=parseFloat(Ye))}});var Ce="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return Ce},set:function(Ye){Ce=Ye.toString()}}),this},dd=function(k,J,ue,ve){gl.call(this,k,J),this.type="rect";var Ce=ue||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return Ce},set:function(st){isNaN(st)||(Ce=parseFloat(st))}});var Ye=ve||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Ye},set:function(st){isNaN(st)||(Ye=parseFloat(st))}}),this},Tc=function(){this.page=wt,this.currentPage=q,this.pages=Se.slice(0),this.pagesContext=St.slice(0),this.x=se,this.y=he,this.matrix=ke,this.width=kh(q),this.height=za(q),this.outputDestination=pe,this.id="",this.objectNumber=-1};Tc.prototype.restore=function(){wt=this.page,q=this.currentPage,St=this.pagesContext,Se=this.pages,se=this.x,he=this.y,ke=this.matrix,Eh(q,this.width),Ua(q,this.height),pe=this.outputDestination};var fd=function(k,J,ue,ve,Ce){lt.push(new Tc),wt=q=0,Se=[],se=k,he=J,ke=Ce,Ft([ue,ve])};for(var xl in h.beginFormObject=function(k,J,ue,ve,Ce){return fd(k,J,ue,ve,Ce),this},h.endFormObject=function(k){return function(J){if(Dn[J])lt.pop().restore();else{var ue=new Tc,ve="Xo"+(Object.keys(En).length+1).toString(10);ue.id=ve,Dn[J]=ve,En[ve]=ue,Vt.publish("addFormObject",ue),lt.pop().restore()}}(k),this},h.doFormObject=function(k,J){var ue=En[Dn[k]];return ne("q"),ne(J.toString()+" cm"),ne("/"+ue.id+" Do"),ne("Q"),this},h.getFormObject=function(k){var J=En[Dn[k]];return{x:J.x,y:J.y,width:J.width,height:J.height,matrix:J.matrix}},h.save=function(k,J){return k=k||"generated.pdf",(J=J||{}).returnPromise=J.returnPromise||!1,J.returnPromise===!1?(Fl(Rn(ar()),k),typeof Fl.unload=="function"&&fn.setTimeout&&setTimeout(Fl.unload,911),this):new Promise(function(ue,ve){try{var Ce=Fl(Rn(ar()),k);typeof Fl.unload=="function"&&fn.setTimeout&&setTimeout(Fl.unload,911),ue(Ce)}catch(Ye){ve(Ye.message)}})},Zt.API)Zt.API.hasOwnProperty(xl)&&(xl==="events"&&Zt.API.events.length?function(k,J){var ue,ve,Ce;for(Ce=J.length-1;Ce!==-1;Ce--)ue=J[Ce][0],ve=J[Ce][1],k.subscribe.apply(k,[ue].concat(typeof ve=="function"?[ve]:ve))}(Vt,Zt.API.events):h[xl]=Zt.API[xl]);function kh(k){return St[k].mediaBox.topRightX-St[k].mediaBox.bottomLeftX}function Eh(k,J){St[k].mediaBox.topRightX=J+St[k].mediaBox.bottomLeftX}function za(k){return St[k].mediaBox.topRightY-St[k].mediaBox.bottomLeftY}function Ua(k,J){St[k].mediaBox.topRightY=J+St[k].mediaBox.bottomLeftY}var Ch=h.getPageWidth=function(k){return kh(k=k||q)/de},Ph=h.setPageWidth=function(k,J){Eh(k,J*de)},yl=h.getPageHeight=function(k){return za(k=k||q)/de},Ih=h.setPageHeight=function(k,J){Ua(k,J*de)};return h.internal={pdfEscape:mt,getStyle:fl,getFont:Ac,getFontSize:ut,getCharSpace:yg,getTextColor:Pc,getLineHeight:od,getLineHeightFactor:pg,getLineWidth:tn,write:it,getHorizontalCoordinate:Da,getVerticalCoordinate:Ba,getCoordinateString:gg,getVerticalCoordinateString:xg,collections:{},newObject:_t,newAdditionalObject:at,newObjectDeferred:Et,newObjectDeferredBegin:ft,getFilters:vt,putStream:At,events:Vt,scaleFactor:de,pageSize:{getWidth:function(){return Ch(q)},setWidth:function(k){Ph(q,k)},getHeight:function(){return yl(q)},setHeight:function(k){Ih(q,k)}},encryptionOptions:d,encryption:Wn,getEncryptor:function(k){return d!==null?Wn.encryptor(k,0):function(J){return J}},output:mr,getNumberOfPages:bn,pages:Se,out:ne,f2:_,f3:T,getPageInfo:vo,getPageInfoByObjId:vc,getCurrentPageInfo:wc,getPDFVersion:y,Point:gl,Rectangle:dd,Matrix:Fe,hasHotfix:Nr},Object.defineProperty(h.internal.pageSize,"width",{get:function(){return Ch(q)},set:function(k){Ph(q,k)},enumerable:!0,configurable:!0}),Object.defineProperty(h.internal.pageSize,"height",{get:function(){return yl(q)},set:function(k){Ih(q,k)},enumerable:!0,configurable:!0}),(function(k){for(var J=0,ue=Oe.length;J<ue;J++){var ve=en.call(this,k[J][0],k[J][1],k[J][2],Oe[J][3],!0);f===!1&&(m[ve]=!0);var Ce=k[J][0].split("-");an({id:ve,fontName:Ce[0],fontStyle:Ce[1]||""})}Vt.publish("addFonts",{fonts:be,dictionary:Le})}).call(h,Oe),Ne="F1",on(s,n),Vt.publish("initialized"),h}nu.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},nu.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},nu.prototype.hexToBytes=function(e){for(var t=[],n=0;n<e.length;n+=2)t.push(String.fromCharCode(parseInt(e.substr(n,2),16)));return t.join("")},nu.prototype.processOwnerPassword=function(e,t){return B2(D2(t).substr(0,5),e)},nu.prototype.encryptor=function(e,t){var n=D2(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(r){return B2(n,r)}},i0.prototype.equals=function(e){var t,n="id,objectNumber,equals";if(!e||Kn(e)!==Kn(this))return!1;var r=0;for(t in this)if(!(n.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;r++}for(t in e)e.hasOwnProperty(t)&&n.indexOf(t)<0&&r--;return r===0},Zt.API={events:[]},Zt.version="3.0.3";var kr=Zt.API,Yb=1,bc=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},Xc=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},gn=function(e){return e.toFixed(2)},Uo=function(e){return e.toFixed(5)};kr.__acroform__={};var oi=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},L3=function(e){return e*Yb},va=function(e){var t=new m7,n=$t.internal.getHeight(e)||0,r=$t.internal.getWidth(e)||0;return t.BBox=[0,0,Number(gn(r)),Number(gn(n))],t},CK=kr.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},PK=kr.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},IK=kr.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},Dr=kr.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return IK(e,t-1)},Br=kr.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return CK(e,t-1)},zr=kr.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return PK(e,t-1)},TK=kr.__acroform__.calculateCoordinates=function(e,t){var n=t.internal.getHorizontalCoordinate,r=t.internal.getVerticalCoordinate,s=e[0],i=e[1],l=e[2],o=e[3],c={};return c.lowerLeft_X=n(s)||0,c.lowerLeft_Y=r(i+o)||0,c.upperRight_X=n(s+l)||0,c.upperRight_Y=r(i)||0,[Number(gn(c.lowerLeft_X)),Number(gn(c.lowerLeft_Y)),Number(gn(c.upperRight_X)),Number(gn(c.upperRight_Y))]},LK=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],n=e._V||e.DV,r=z2(e,n),s=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+s+" "+gn(r.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(r.text),t.push("ET"),t.push("Q"),t.push("EMC");var i=va(e);return i.scope=e.scope,i.stream=t.join(`
`),i}},z2=function(e,t){var n=e.fontSize===0?e.maxFontSize:e.fontSize,r={text:"",fontSize:""},s=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");s=e.multiline?s.map(function(_){return _.split(`
`)}):s.map(function(_){return[_]});var i=n,l=$t.internal.getHeight(e)||0;l=l<0?-l:l;var o=$t.internal.getWidth(e)||0;o=o<0?-o:o;var c=function(_,T,B){if(_+1<s.length){var $=T+" "+s[_+1][0];return Lm($,e,B).width<=o-4}return!1};i++;e:for(;i>0;){t="",i--;var u,d,f=Lm("3",e,i).height,m=e.multiline?l-i:(l-f)/2,h=m+=2,x=0,y=0,p=0;if(i<=0){t=`(...) Tj
`,t+="% Width of Text: "+Lm(t,e,i=12).width+", FieldWidth:"+o+`
`;break}for(var g="",w=0,v=0;v<s.length;v++)if(s.hasOwnProperty(v)){var N=!1;if(s[v].length!==1&&p!==s[v].length-1){if((f+2)*(w+2)+2>l)continue e;g+=s[v][p],N=!0,y=v,v--}else{g=(g+=s[v][p]+" ").substr(g.length-1)==" "?g.substr(0,g.length-1):g;var A=parseInt(v),P=c(A,g,i),U=v>=s.length-1;if(P&&!U){g+=" ",p=0;continue}if(P||U){if(U)y=A;else if(e.multiline&&(f+2)*(w+2)+2>l)continue e}else{if(!e.multiline||(f+2)*(w+2)+2>l)continue e;y=A}}for(var M="",S=x;S<=y;S++){var C=s[S];if(e.multiline){if(S===y){M+=C[p]+" ",p=(p+1)%C.length;continue}if(S===x){M+=C[C.length-1]+" ";continue}}M+=C[0]+" "}switch(M=M.substr(M.length-1)==" "?M.substr(0,M.length-1):M,d=Lm(M,e,i).width,e.textAlign){case"right":u=o-d-2;break;case"center":u=(o-d)/2;break;default:u=2}t+=gn(u)+" "+gn(h)+` Td
`,t+="("+bc(M)+`) Tj
`,t+=-gn(u)+` 0 Td
`,h=-(i+2),d=0,x=N?y:y+1,w++,g=""}break}return r.text=t,r.fontSize=i,r},Lm=function(e,t,n){var r=t.scope.internal.getFont(t.fontName,t.fontStyle),s=t.scope.getStringUnitWidth(e,{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n);return{height:t.scope.getStringUnitWidth("3",{font:r,fontSize:parseFloat(n),charSpace:0})*parseFloat(n)*1.5,width:s}},MK={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},RK=function(e,t){var n={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(r){return r.type===n.type&&r.object===n.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(n)},$K=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(ua.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(MK)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");Yb=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new p7,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(n){n.internal.events.unsubscribe(n.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete n.internal.acroformPlugin.acroFormDictionaryRoot._eventID,n.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(n){n.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var r=n.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var s in r)if(r.hasOwnProperty(s)){var i=r[s];i.objId=void 0,i.hasAnnotation&&RK(i,n)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(n){if(n.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");n.internal.write("/AcroForm "+n.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(n){(function(r,s){var i=!r;for(var l in r||(s.internal.newObjectDeferredBegin(s.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),s.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),r=r||s.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(r.hasOwnProperty(l)){var o=r[l],c=[],u=o.Rect;if(o.Rect&&(o.Rect=TK(o.Rect,s)),s.internal.newObjectDeferredBegin(o.objId,!0),o.DA=$t.createDefaultAppearanceStream(o),Kn(o)==="object"&&typeof o.getKeyValueListForStream=="function"&&(c=o.getKeyValueListForStream()),o.Rect=u,o.hasAppearanceStream&&!o.appearanceStreamContent){var d=LK(o);c.push({key:"AP",value:"<</N "+d+">>"}),s.internal.acroformPlugin.xForms.push(d)}if(o.appearanceStreamContent){var f="";for(var m in o.appearanceStreamContent)if(o.appearanceStreamContent.hasOwnProperty(m)){var h=o.appearanceStreamContent[m];if(f+="/"+m+" ",f+="<<",Object.keys(h).length>=1||Array.isArray(h)){for(var l in h)if(h.hasOwnProperty(l)){var x=h[l];typeof x=="function"&&(x=x.call(s,o)),f+="/"+l+" "+x+" ",s.internal.acroformPlugin.xForms.indexOf(x)>=0||s.internal.acroformPlugin.xForms.push(x)}}else typeof(x=h)=="function"&&(x=x.call(s,o)),f+="/"+l+" "+x,s.internal.acroformPlugin.xForms.indexOf(x)>=0||s.internal.acroformPlugin.xForms.push(x);f+=">>"}c.push({key:"AP",value:`<<
`+f+">>"})}s.internal.putStream({additionalKeyValues:c,objectId:o.objId}),s.internal.out("endobj")}i&&function(y,p){for(var g in y)if(y.hasOwnProperty(g)){var w=g,v=y[g];p.internal.newObjectDeferredBegin(v.objId,!0),Kn(v)==="object"&&typeof v.putStream=="function"&&v.putStream(),delete y[w]}}(s.internal.acroformPlugin.xForms,s)})(n,e)}),e.internal.acroformPlugin.isInitialized=!0}},h7=kr.__acroform__.arrayToPdfArray=function(e,t,n){var r=function(l){return l};if(Array.isArray(e)){for(var s="[",i=0;i<e.length;i++)switch(i!==0&&(s+=" "),Kn(e[i])){case"boolean":case"number":case"object":s+=e[i].toString();break;case"string":e[i].substr(0,1)!=="/"?(t!==void 0&&n&&(r=n.internal.getEncryptor(t)),s+="("+bc(r(e[i].toString()))+")"):s+=e[i].toString()}return s+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},nx=function(e,t,n){var r=function(s){return s};return t!==void 0&&n&&(r=n.internal.getEncryptor(t)),(e=e||"").toString(),"("+bc(r(e))+")"},Ea=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};Ea.prototype.toString=function(){return this.objId+" 0 R"},Ea.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},Ea.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(i){return i!="content"&&i!="appearanceStreamContent"&&i!="scope"&&i!="objId"&&i.substring(0,1)!="_"});for(var n in t)if(Object.getOwnPropertyDescriptor(this,t[n]).configurable===!1){var r=t[n],s=this[r];s&&(Array.isArray(s)?e.push({key:r,value:h7(s,this.objId,this.scope)}):s instanceof Ea?(s.scope=this.scope,e.push({key:r,value:s.objId+" 0 R"})):typeof s!="function"&&e.push({key:r,value:s}))}return e};var m7=function(){Ea.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(n){t=n}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(n){e=n.trim()},get:function(){return e||null}})};oi(m7,Ea);var p7=function(){Ea.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var n=function(r){return r};return this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),"("+bc(n(e))+")"}},set:function(n){e=n}})};oi(p7,Ea);var ua=function e(){Ea.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(g){if(isNaN(g))throw new Error('Invalid value "'+g+'" for attribute F supplied.');t=g}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!Dr(t,3)},set:function(g){g?this.F=Br(t,3):this.F=zr(t,3)}});var n=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return n},set:function(g){if(isNaN(g))throw new Error('Invalid value "'+g+'" for attribute Ff supplied.');n=g}});var r=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(r.length!==0)return r},set:function(g){r=g!==void 0?g:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[0])?0:r[0]},set:function(g){r[0]=g}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[1])?0:r[1]},set:function(g){r[1]=g}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[2])?0:r[2]},set:function(g){r[2]=g}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!r||isNaN(r[3])?0:r[3]},set:function(g){r[3]=g}});var s="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return s},set:function(g){switch(g){case"/Btn":case"/Tx":case"/Ch":case"/Sig":s=g;break;default:throw new Error('Invalid value "'+g+'" for attribute FT supplied.')}}});var i=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!i||i.length<1){if(this instanceof a0)return;i="FieldObject"+e.FieldNum++}var g=function(w){return w};return this.scope&&(g=this.scope.internal.getEncryptor(this.objId)),"("+bc(g(i))+")"},set:function(g){i=g.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return i},set:function(g){i=g}});var l="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return l},set:function(g){l=g}});var o="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return o},set:function(g){o=g}});var c=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return c},set:function(g){c=g}});var u=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return u===void 0?50/Yb:u},set:function(g){u=g}});var d="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return d},set:function(g){d=g}});var f="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!f||this instanceof a0||this instanceof Zl))return nx(f,this.objId,this.scope)},set:function(g){g=g.toString(),f=g}});var m=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(m)return this instanceof is==0?nx(m,this.objId,this.scope):m},set:function(g){g=g.toString(),m=this instanceof is==0?g.substr(0,1)==="("?Xc(g.substr(1,g.length-2)):Xc(g):g}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof is==1?Xc(m.substr(1,m.length-1)):m},set:function(g){g=g.toString(),m=this instanceof is==1?"/"+g:g}});var h=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(h)return h},set:function(g){this.V=g}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(h)return this instanceof is==0?nx(h,this.objId,this.scope):h},set:function(g){g=g.toString(),h=this instanceof is==0?g.substr(0,1)==="("?Xc(g.substr(1,g.length-2)):Xc(g):g}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof is==1?Xc(h.substr(1,h.length-1)):h},set:function(g){g=g.toString(),h=this instanceof is==1?"/"+g:g}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var x,y=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return y},set:function(g){g=!!g,y=g}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(x)return x},set:function(g){x=g}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,1)},set:function(g){g?this.Ff=Br(this.Ff,1):this.Ff=zr(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,2)},set:function(g){g?this.Ff=Br(this.Ff,2):this.Ff=zr(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,3)},set:function(g){g?this.Ff=Br(this.Ff,3):this.Ff=zr(this.Ff,3)}});var p=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if(p!==null)return p},set:function(g){if([0,1,2].indexOf(g)===-1)throw new Error('Invalid value "'+g+'" for attribute Q supplied.');p=g}}),Object.defineProperty(this,"textAlign",{get:function(){var g;switch(p){case 0:default:g="left";break;case 1:g="center";break;case 2:g="right"}return g},configurable:!0,enumerable:!0,set:function(g){switch(g){case"right":case 2:p=2;break;case"center":case 1:p=1;break;default:p=0}}})};oi(ua,Ea);var xu=function(){ua.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(n){e=n}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return h7(t,this.objId,this.scope)},set:function(n){var r,s;s=[],typeof(r=n)=="string"&&(s=function(i,l,o){o||(o=1);for(var c,u=[];c=l.exec(i);)u.push(c[o]);return u}(r,/\((.*?)\)/g)),t=s}}),this.getOptions=function(){return t},this.setOptions=function(n){t=n,this.sort&&t.sort()},this.addOption=function(n){n=(n=n||"").toString(),t.push(n),this.sort&&t.sort()},this.removeOption=function(n,r){for(r=r||!1,n=(n=n||"").toString();t.indexOf(n)!==-1&&(t.splice(t.indexOf(n),1),r!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,18)},set:function(n){n?this.Ff=Br(this.Ff,18):this.Ff=zr(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,19)},set:function(n){this.combo===!0&&(n?this.Ff=Br(this.Ff,19):this.Ff=zr(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,20)},set:function(n){n?(this.Ff=Br(this.Ff,20),t.sort()):this.Ff=zr(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,22)},set:function(n){n?this.Ff=Br(this.Ff,22):this.Ff=zr(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,23)},set:function(n){n?this.Ff=Br(this.Ff,23):this.Ff=zr(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,27)},set:function(n){n?this.Ff=Br(this.Ff,27):this.Ff=zr(this.Ff,27)}}),this.hasAppearanceStream=!1};oi(xu,ua);var yu=function(){xu.call(this),this.fontName="helvetica",this.combo=!1};oi(yu,xu);var bu=function(){yu.call(this),this.combo=!0};oi(bu,yu);var ip=function(){bu.call(this),this.edit=!0};oi(ip,bu);var is=function(){ua.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,15)},set:function(n){n?this.Ff=Br(this.Ff,15):this.Ff=zr(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,16)},set:function(n){n?this.Ff=Br(this.Ff,16):this.Ff=zr(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,17)},set:function(n){n?this.Ff=Br(this.Ff,17):this.Ff=zr(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,26)},set:function(n){n?this.Ff=Br(this.Ff,26):this.Ff=zr(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var n=function(i){return i};if(this.scope&&(n=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var r,s=[];for(r in s.push("<<"),t)s.push("/"+r+" ("+bc(n(t[r]))+")");return s.push(">>"),s.join(`
`)}},set:function(n){Kn(n)==="object"&&(t=n)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(n){typeof n=="string"&&(t.CA=n)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(n){e=n}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(n){e="/"+n}})};oi(is,ua);var ap=function(){is.call(this),this.pushButton=!0};oi(ap,is);var vu=function(){is.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};oi(vu,is);var a0=function(){var e,t;ua.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(s){e=s}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(s){t=s}});var n,r={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var s=function(o){return o};this.scope&&(s=this.scope.internal.getEncryptor(this.objId));var i,l=[];for(i in l.push("<<"),r)l.push("/"+i+" ("+bc(s(r[i]))+")");return l.push(">>"),l.join(`
`)},set:function(s){Kn(s)==="object"&&(r=s)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return r.CA||""},set:function(s){typeof s=="string"&&(r.CA=s)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return n},set:function(s){n=s}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return n.substr(1,n.length-1)},set:function(s){n="/"+s}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=$t.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};oi(a0,ua),vu.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var n=this.Kids[t];n.appearanceStreamContent=e.createAppearanceStream(n.optionName),n.caption=e.getCA()}},vu.prototype.createOption=function(e){var t=new a0;return t.Parent=this,t.optionName=e,this.Kids.push(t),FK.call(this.scope,t),t};var op=function(){is.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=$t.CheckBox.createAppearanceStream()};oi(op,is);var Zl=function(){ua.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,13)},set:function(t){t?this.Ff=Br(this.Ff,13):this.Ff=zr(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,21)},set:function(t){t?this.Ff=Br(this.Ff,21):this.Ff=zr(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,23)},set:function(t){t?this.Ff=Br(this.Ff,23):this.Ff=zr(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,24)},set:function(t){t?this.Ff=Br(this.Ff,24):this.Ff=zr(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,25)},set:function(t){t?this.Ff=Br(this.Ff,25):this.Ff=zr(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,26)},set:function(t){t?this.Ff=Br(this.Ff,26):this.Ff=zr(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};oi(Zl,ua);var lp=function(){Zl.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!Dr(this.Ff,14)},set:function(e){e?this.Ff=Br(this.Ff,14):this.Ff=zr(this.Ff,14)}}),this.password=!0};oi(lp,Zl);var $t={CheckBox:{createAppearanceStream:function(){return{N:{On:$t.CheckBox.YesNormal},D:{On:$t.CheckBox.YesPushDown,Off:$t.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=va(e);t.scope=e.scope;var n=[],r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,s=e.scope.__private__.encodeColorString(e.color),i=z2(e,e.caption);return n.push("0.749023 g"),n.push("0 0 "+gn($t.internal.getWidth(e))+" "+gn($t.internal.getHeight(e))+" re"),n.push("f"),n.push("BMC"),n.push("q"),n.push("0 0 1 rg"),n.push("/"+r+" "+gn(i.fontSize)+" Tf "+s),n.push("BT"),n.push(i.text),n.push("ET"),n.push("Q"),n.push("EMC"),t.stream=n.join(`
`),t},YesNormal:function(e){var t=va(e);t.scope=e.scope;var n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color),s=[],i=$t.internal.getHeight(e),l=$t.internal.getWidth(e),o=z2(e,e.caption);return s.push("1 g"),s.push("0 0 "+gn(l)+" "+gn(i)+" re"),s.push("f"),s.push("q"),s.push("0 0 1 rg"),s.push("0 0 "+gn(l-1)+" "+gn(i-1)+" re"),s.push("W"),s.push("n"),s.push("0 g"),s.push("BT"),s.push("/"+n+" "+gn(o.fontSize)+" Tf "+r),s.push(o.text),s.push("ET"),s.push("Q"),t.stream=s.join(`
`),t},OffPushDown:function(e){var t=va(e);t.scope=e.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+gn($t.internal.getWidth(e))+" "+gn($t.internal.getHeight(e))+" re"),n.push("f"),t.stream=n.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:$t.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=$t.RadioButton.Circle.YesNormal,t.D[e]=$t.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=va(e);t.scope=e.scope;var n=[],r=$t.internal.getWidth(e)<=$t.internal.getHeight(e)?$t.internal.getWidth(e)/4:$t.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var s=$t.internal.Bezier_C,i=Number((r*s).toFixed(5));return n.push("q"),n.push("1 0 0 1 "+Uo($t.internal.getWidth(e)/2)+" "+Uo($t.internal.getHeight(e)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+i+" "+i+" "+r+" 0 "+r+" c"),n.push("-"+i+" "+r+" -"+r+" "+i+" -"+r+" 0 c"),n.push("-"+r+" -"+i+" -"+i+" -"+r+" 0 -"+r+" c"),n.push(i+" -"+r+" "+r+" -"+i+" "+r+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join(`
`),t},YesPushDown:function(e){var t=va(e);t.scope=e.scope;var n=[],r=$t.internal.getWidth(e)<=$t.internal.getHeight(e)?$t.internal.getWidth(e)/4:$t.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var s=Number((2*r).toFixed(5)),i=Number((s*$t.internal.Bezier_C).toFixed(5)),l=Number((r*$t.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+Uo($t.internal.getWidth(e)/2)+" "+Uo($t.internal.getHeight(e)/2)+" cm"),n.push(s+" 0 m"),n.push(s+" "+i+" "+i+" "+s+" 0 "+s+" c"),n.push("-"+i+" "+s+" -"+s+" "+i+" -"+s+" 0 c"),n.push("-"+s+" -"+i+" -"+i+" -"+s+" 0 -"+s+" c"),n.push(i+" -"+s+" "+s+" -"+i+" "+s+" 0 c"),n.push("f"),n.push("Q"),n.push("0 g"),n.push("q"),n.push("1 0 0 1 "+Uo($t.internal.getWidth(e)/2)+" "+Uo($t.internal.getHeight(e)/2)+" cm"),n.push(r+" 0 m"),n.push(r+" "+l+" "+l+" "+r+" 0 "+r+" c"),n.push("-"+l+" "+r+" -"+r+" "+l+" -"+r+" 0 c"),n.push("-"+r+" -"+l+" -"+l+" -"+r+" 0 -"+r+" c"),n.push(l+" -"+r+" "+r+" -"+l+" "+r+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=va(e);t.scope=e.scope;var n=[],r=$t.internal.getWidth(e)<=$t.internal.getHeight(e)?$t.internal.getWidth(e)/4:$t.internal.getHeight(e)/4;r=Number((.9*r).toFixed(5));var s=Number((2*r).toFixed(5)),i=Number((s*$t.internal.Bezier_C).toFixed(5));return n.push("0.749023 g"),n.push("q"),n.push("1 0 0 1 "+Uo($t.internal.getWidth(e)/2)+" "+Uo($t.internal.getHeight(e)/2)+" cm"),n.push(s+" 0 m"),n.push(s+" "+i+" "+i+" "+s+" 0 "+s+" c"),n.push("-"+i+" "+s+" -"+s+" "+i+" -"+s+" 0 c"),n.push("-"+s+" -"+i+" -"+i+" -"+s+" 0 -"+s+" c"),n.push(i+" -"+s+" "+s+" -"+i+" "+s+" 0 c"),n.push("f"),n.push("Q"),t.stream=n.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:$t.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=$t.RadioButton.Cross.YesNormal,t.D[e]=$t.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=va(e);t.scope=e.scope;var n=[],r=$t.internal.calculateCross(e);return n.push("q"),n.push("1 1 "+gn($t.internal.getWidth(e)-2)+" "+gn($t.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(gn(r.x1.x)+" "+gn(r.x1.y)+" m"),n.push(gn(r.x2.x)+" "+gn(r.x2.y)+" l"),n.push(gn(r.x4.x)+" "+gn(r.x4.y)+" m"),n.push(gn(r.x3.x)+" "+gn(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},YesPushDown:function(e){var t=va(e);t.scope=e.scope;var n=$t.internal.calculateCross(e),r=[];return r.push("0.749023 g"),r.push("0 0 "+gn($t.internal.getWidth(e))+" "+gn($t.internal.getHeight(e))+" re"),r.push("f"),r.push("q"),r.push("1 1 "+gn($t.internal.getWidth(e)-2)+" "+gn($t.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(gn(n.x1.x)+" "+gn(n.x1.y)+" m"),r.push(gn(n.x2.x)+" "+gn(n.x2.y)+" l"),r.push(gn(n.x4.x)+" "+gn(n.x4.y)+" m"),r.push(gn(n.x3.x)+" "+gn(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=va(e);t.scope=e.scope;var n=[];return n.push("0.749023 g"),n.push("0 0 "+gn($t.internal.getWidth(e))+" "+gn($t.internal.getHeight(e))+" re"),n.push("f"),t.stream=n.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+n}};$t.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=$t.internal.getWidth(e),n=$t.internal.getHeight(e),r=Math.min(t,n);return{x1:{x:(t-r)/2,y:(n-r)/2+r},x2:{x:(t-r)/2+r,y:(n-r)/2},x3:{x:(t-r)/2,y:(n-r)/2},x4:{x:(t-r)/2+r,y:(n-r)/2+r}}}},$t.internal.getWidth=function(e){var t=0;return Kn(e)==="object"&&(t=L3(e.Rect[2])),t},$t.internal.getHeight=function(e){var t=0;return Kn(e)==="object"&&(t=L3(e.Rect[3])),t};var FK=kr.addField=function(e){if($K(this,e),!(e instanceof ua))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};kr.AcroFormChoiceField=xu,kr.AcroFormListBox=yu,kr.AcroFormComboBox=bu,kr.AcroFormEditBox=ip,kr.AcroFormButton=is,kr.AcroFormPushButton=ap,kr.AcroFormRadioButton=vu,kr.AcroFormCheckBox=op,kr.AcroFormTextField=Zl,kr.AcroFormPasswordField=lp,kr.AcroFormAppearance=$t,kr.AcroForm={ChoiceField:xu,ListBox:yu,ComboBox:bu,EditBox:ip,Button:is,PushButton:ap,RadioButton:vu,CheckBox:op,TextField:Zl,PasswordField:lp,Appearance:$t},Zt.AcroForm={ChoiceField:xu,ListBox:yu,ComboBox:bu,EditBox:ip,Button:is,PushButton:ap,RadioButton:vu,CheckBox:op,TextField:Zl,PasswordField:lp,Appearance:$t};Zt.AcroForm;function g7(e){return e.reduce(function(t,n,r){return t[n]=r,t},{})}(function(e){var t="addImage_";e.__addimage__={};var n="UNKNOWN",r={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},s=e.__addimage__.getImageFileTypeByImageData=function(_,T){var B,$,D,L,O,W=n;if((T=T||n)==="RGBA"||_.data!==void 0&&_.data instanceof Uint8ClampedArray&&"height"in _&&"width"in _)return"RGBA";if(P(_))for(O in r)for(D=r[O],B=0;B<D.length;B+=1){for(L=!0,$=0;$<D[B].length;$+=1)if(D[B][$]!==void 0&&D[B][$]!==_[$]){L=!1;break}if(L===!0){W=O;break}}else for(O in r)for(D=r[O],B=0;B<D.length;B+=1){for(L=!0,$=0;$<D[B].length;$+=1)if(D[B][$]!==void 0&&D[B][$]!==_.charCodeAt($)){L=!1;break}if(L===!0){W=O;break}}return W===n&&T!==n&&(W=T),W},i=function _(T){for(var B=this.internal.write,$=this.internal.putStream,D=(0,this.internal.getFilters)();D.indexOf("FlateEncode")!==-1;)D.splice(D.indexOf("FlateEncode"),1);T.objectId=this.internal.newObject();var L=[];if(L.push({key:"Type",value:"/XObject"}),L.push({key:"Subtype",value:"/Image"}),L.push({key:"Width",value:T.width}),L.push({key:"Height",value:T.height}),T.colorSpace===g.INDEXED?L.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(T.palette.length/3-1)+" "+("sMask"in T&&T.sMask!==void 0?T.objectId+2:T.objectId+1)+" 0 R]"}):(L.push({key:"ColorSpace",value:"/"+T.colorSpace}),T.colorSpace===g.DEVICE_CMYK&&L.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),L.push({key:"BitsPerComponent",value:T.bitsPerComponent}),"decodeParameters"in T&&T.decodeParameters!==void 0&&L.push({key:"DecodeParms",value:"<<"+T.decodeParameters+">>"}),"transparency"in T&&Array.isArray(T.transparency)&&T.transparency.length>0){for(var O="",W=0,E=T.transparency.length;W<E;W++)O+=T.transparency[W]+" "+T.transparency[W]+" ";L.push({key:"Mask",value:"["+O+"]"})}T.sMask!==void 0&&L.push({key:"SMask",value:T.objectId+1+" 0 R"});var H=T.filter!==void 0?["/"+T.filter]:void 0;if($({data:T.data,additionalKeyValues:L,alreadyAppliedFilters:H,objectId:T.objectId}),B("endobj"),"sMask"in T&&T.sMask!==void 0){var V,R=(V=T.sMaskBitsPerComponent)!==null&&V!==void 0?V:T.bitsPerComponent,q={width:T.width,height:T.height,colorSpace:"DeviceGray",bitsPerComponent:R,data:T.sMask};"filter"in T&&(q.decodeParameters="/Predictor ".concat(T.predictor," /Colors 1 /BitsPerComponent ").concat(R," /Columns ").concat(T.width),q.filter=T.filter),_.call(this,q)}if(T.colorSpace===g.INDEXED){var F=this.internal.newObject();$({data:M(new Uint8Array(T.palette)),objectId:F}),B("endobj")}},l=function(){var _=this.internal.collections[t+"images"];for(var T in _)i.call(this,_[T])},o=function(){var _,T=this.internal.collections[t+"images"],B=this.internal.write;for(var $ in T)B("/I"+(_=T[$]).index,_.objectId,"0","R")},c=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",l),this.internal.events.subscribe("putXobjectDict",o))},u=function(){var _=this.internal.collections[t+"images"];return c.call(this),_},d=function(){return Object.keys(this.internal.collections[t+"images"]).length},f=function(_){return typeof e["process"+_.toUpperCase()]=="function"},m=function(_){return Kn(_)==="object"&&_.nodeType===1},h=function(_,T){if(_.nodeName==="IMG"&&_.hasAttribute("src")){var B=""+_.getAttribute("src");if(B.indexOf("data:image/")===0)return sp(unescape(B).split("base64,").pop());var $=e.loadFile(B,!0);if($!==void 0)return $}if(_.nodeName==="CANVAS"){if(_.width===0||_.height===0)throw new Error("Given canvas must have data. Canvas width: "+_.width+", height: "+_.height);var D;switch(T){case"PNG":D="image/png";break;case"WEBP":D="image/webp";break;default:D="image/jpeg"}return sp(_.toDataURL(D,1).split("base64,").pop())}},x=function(_){var T=this.internal.collections[t+"images"];if(T){for(var B in T)if(_===T[B].alias)return T[B]}},y=function(_,T,B){return _||T||(_=-96,T=-96),_<0&&(_=-1*B.width*72/_/this.internal.scaleFactor),T<0&&(T=-1*B.height*72/T/this.internal.scaleFactor),_===0&&(_=T*B.width/B.height),T===0&&(T=_*B.height/B.width),[_,T]},p=function(_,T,B,$,D,L){var O=y.call(this,B,$,D),W=this.internal.getCoordinateString,E=this.internal.getVerticalCoordinateString,H=u.call(this);if(B=O[0],$=O[1],H[D.index]=D,L){L*=Math.PI/180;var V=Math.cos(L),R=Math.sin(L),q=function(G){return G.toFixed(4)},F=[q(V),q(R),q(-1*R),q(V),0,0,"cm"]}this.internal.write("q"),L?(this.internal.write([1,"0","0",1,W(_),E(T+$),"cm"].join(" ")),this.internal.write(F.join(" ")),this.internal.write([W(B),"0","0",W($),"0","0","cm"].join(" "))):this.internal.write([W(B),"0","0",W($),W(_),E(T+$),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+D.index+" Do"),this.internal.write("Q")},g=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var w=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},v=e.__addimage__.sHashCode=function(_){var T,B,$=0;if(typeof _=="string")for(B=_.length,T=0;T<B;T++)$=($<<5)-$+_.charCodeAt(T),$|=0;else if(P(_))for(B=_.byteLength/2,T=0;T<B;T++)$=($<<5)-$+_[T],$|=0;return $},N=e.__addimage__.validateStringAsBase64=function(_){(_=_||"").toString().trim();var T=!0;return _.length===0&&(T=!1),_.length%4!=0&&(T=!1),/^[A-Za-z0-9+/]+$/.test(_.substr(0,_.length-2))===!1&&(T=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(_.substr(-2))===!1&&(T=!1),T},A=e.__addimage__.extractImageFromDataUrl=function(_){if(_==null||!(_=_.trim()).startsWith("data:"))return null;var T=_.indexOf(",");return T<0?null:_.substring(0,T).trim().endsWith("base64")?_.substring(T+1):null};e.__addimage__.isArrayBuffer=function(_){return _ instanceof ArrayBuffer};var P=e.__addimage__.isArrayBufferView=function(_){return _ instanceof Int8Array||_ instanceof Uint8Array||_ instanceof Uint8ClampedArray||_ instanceof Int16Array||_ instanceof Uint16Array||_ instanceof Int32Array||_ instanceof Uint32Array||_ instanceof Float32Array||_ instanceof Float64Array},U=e.__addimage__.binaryStringToUint8Array=function(_){for(var T=_.length,B=new Uint8Array(T),$=0;$<T;$++)B[$]=_.charCodeAt($);return B},M=e.__addimage__.arrayBufferToBinaryString=function(_){for(var T="",B=P(_)?_:new Uint8Array(_),$=0;$<B.length;$+=8192)T+=String.fromCharCode.apply(null,B.subarray($,$+8192));return T};e.addImage=function(){var _,T,B,$,D,L,O,W,E;if(typeof arguments[1]=="number"?(T=n,B=arguments[1],$=arguments[2],D=arguments[3],L=arguments[4],O=arguments[5],W=arguments[6],E=arguments[7]):(T=arguments[1],B=arguments[2],$=arguments[3],D=arguments[4],L=arguments[5],O=arguments[6],W=arguments[7],E=arguments[8]),Kn(_=arguments[0])==="object"&&!m(_)&&"imageData"in _){var H=_;_=H.imageData,T=H.format||T||n,B=H.x||B||0,$=H.y||$||0,D=H.w||H.width||D,L=H.h||H.height||L,O=H.alias||O,W=H.compression||W,E=H.rotation||H.angle||E}var V=this.internal.getFilters();if(W===void 0&&V.indexOf("FlateEncode")!==-1&&(W="SLOW"),isNaN(B)||isNaN($))throw new Error("Invalid coordinates passed to jsPDF.addImage");c.call(this);var R=S.call(this,_,T,O,W);return p.call(this,B,$,D,L,R,E),this};var S=function(_,T,B,$){var D,L,O;if(typeof _=="string"&&s(_)===n){_=unescape(_);var W=C(_,!1);(W!==""||(W=e.loadFile(_,!0))!==void 0)&&(_=W)}if(m(_)&&(_=h(_,T)),T=s(_,T),!f(T))throw new Error("addImage does not support files of type '"+T+"', please ensure that a plugin for '"+T+"' support is added.");if(((O=B)==null||O.length===0)&&(B=function(E){return typeof E=="string"||P(E)?v(E):P(E.data)?v(E.data):null}(_)),(D=x.call(this,B))||(_ instanceof Uint8Array||T==="RGBA"||(L=_,_=U(_)),D=this["process"+T.toUpperCase()](_,d.call(this),B,function(E){return E&&typeof E=="string"&&(E=E.toUpperCase()),E in e.image_compression?E:w.NONE}($),L)),!D)throw new Error("An unknown error occurred whilst processing the image.");return D},C=e.__addimage__.convertBase64ToBinaryString=function(_,T){T=typeof T!="boolean"||T;var B,$="";if(typeof _=="string"){var D;B=(D=A(_))!==null&&D!==void 0?D:_;try{$=sp(B)}catch(L){if(T)throw N(B)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+L.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return $};e.getImageProperties=function(_){var T,B,$="";if(m(_)&&(_=h(_)),typeof _=="string"&&s(_)===n&&(($=C(_,!1))===""&&($=e.loadFile(_)||""),_=$),B=s(_),!f(B))throw new Error("addImage does not support files of type '"+B+"', please ensure that a plugin for '"+B+"' support is added.");if(_ instanceof Uint8Array||(_=U(_)),!(T=this["process"+B.toUpperCase()](_)))throw new Error("An unknown error occurred whilst processing the image");return T.fileType=B,T}})(Zt.API),function(e){var t=function(n){if(n!==void 0&&n!="")return!0};Zt.API.events.push(["addPage",function(n){this.internal.getPageInfo(n.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(n){for(var r,s,i,l=this.internal.getCoordinateString,o=this.internal.getVerticalCoordinateString,c=this.internal.getPageInfoByObjId(n.objId),u=n.pageContext.annotations,d=!1,f=0;f<u.length&&!d;f++)switch((r=u[f]).type){case"link":(t(r.options.url)||t(r.options.pageNumber))&&(d=!0);break;case"reference":case"text":case"freetext":d=!0}if(d!=0){this.internal.write("/Annots [");for(var m=0;m<u.length;m++){r=u[m];var h=this.internal.pdfEscape,x=this.internal.getEncryptor(n.objId);switch(r.type){case"reference":this.internal.write(" "+r.object.objId+" 0 R ");break;case"text":var y=this.internal.newAdditionalObject(),p=this.internal.newAdditionalObject(),g=this.internal.getEncryptor(y.objId),w=r.title||"Note";i="<</Type /Annot /Subtype /Text "+(s="/Rect ["+l(r.bounds.x)+" "+o(r.bounds.y+r.bounds.h)+" "+l(r.bounds.x+r.bounds.w)+" "+o(r.bounds.y)+"] ")+"/Contents ("+h(g(r.contents))+")",i+=" /Popup "+p.objId+" 0 R",i+=" /P "+c.objId+" 0 R",i+=" /T ("+h(g(w))+") >>",y.content=i;var v=y.objId+" 0 R";i="<</Type /Annot /Subtype /Popup "+(s="/Rect ["+l(r.bounds.x+30)+" "+o(r.bounds.y+r.bounds.h)+" "+l(r.bounds.x+r.bounds.w+30)+" "+o(r.bounds.y)+"] ")+" /Parent "+v,r.open&&(i+=" /Open true"),i+=" >>",p.content=i,this.internal.write(y.objId,"0 R",p.objId,"0 R");break;case"freetext":s="/Rect ["+l(r.bounds.x)+" "+o(r.bounds.y)+" "+l(r.bounds.x+r.bounds.w)+" "+o(r.bounds.y+r.bounds.h)+"] ";var N=r.color||"#000000";i="<</Type /Annot /Subtype /FreeText "+s+"/Contents ("+h(x(r.contents))+")",i+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+N+")",i+=" /Border [0 0 0]",i+=" >>",this.internal.write(i);break;case"link":if(r.options.name){var A=this.annotations._nameMap[r.options.name];r.options.pageNumber=A.page,r.options.top=A.y}else r.options.top||(r.options.top=0);if(s="/Rect ["+r.finalBounds.x+" "+r.finalBounds.y+" "+r.finalBounds.w+" "+r.finalBounds.h+"] ",i="",r.options.url)i="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /A <</S /URI /URI ("+h(x(r.options.url))+") >>";else if(r.options.pageNumber)switch(i="<</Type /Annot /Subtype /Link "+s+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(r.options.pageNumber).objId+" 0 R",r.options.magFactor=r.options.magFactor||"XYZ",r.options.magFactor){case"Fit":i+=" /Fit]";break;case"FitH":i+=" /FitH "+r.options.top+"]";break;case"FitV":r.options.left=r.options.left||0,i+=" /FitV "+r.options.left+"]";break;default:var P=o(r.options.top);r.options.left=r.options.left||0,r.options.zoom===void 0&&(r.options.zoom=0),i+=" /XYZ "+r.options.left+" "+P+" "+r.options.zoom+"]"}i!=""&&(i+=" >>",this.internal.write(i))}}this.internal.write("]")}}]),e.createAnnotation=function(n){var r=this.internal.getCurrentPageInfo();switch(n.type){case"link":this.link(n.bounds.x,n.bounds.y,n.bounds.w,n.bounds.h,n);break;case"text":case"freetext":r.pageContext.annotations.push(n)}},e.link=function(n,r,s,i,l){var o=this.internal.getCurrentPageInfo(),c=this.internal.getCoordinateString,u=this.internal.getVerticalCoordinateString;o.pageContext.annotations.push({finalBounds:{x:c(n),y:u(r),w:c(n+s),h:u(r+i)},options:l,type:"link"})},e.textWithLink=function(n,r,s,i){var l,o,c=this.getTextWidth(n),u=this.internal.getLineHeight()/this.internal.scaleFactor;if(i.maxWidth!==void 0){o=i.maxWidth;var d=this.splitTextToSize(n,o).length;l=Math.ceil(u*d)}else o=c,l=u;return this.text(n,r,s,i),s+=.2*u,i.align==="center"&&(r-=c/2),i.align==="right"&&(r-=c),this.link(r,s-u,o,l,i),c},e.getTextWidth=function(n){var r=this.internal.getFontSize();return this.getStringUnitWidth(n)*r/this.internal.scaleFactor}}(Zt.API),function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},n={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},r={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},s=[1570,1571,1573,1575];e.__arabicParser__={};var i=e.__arabicParser__.isInArabicSubstitutionA=function(y){return t[y.charCodeAt(0)]!==void 0},l=e.__arabicParser__.isArabicLetter=function(y){return typeof y=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(y)},o=e.__arabicParser__.isArabicEndLetter=function(y){return l(y)&&i(y)&&t[y.charCodeAt(0)].length<=2},c=e.__arabicParser__.isArabicAlfLetter=function(y){return l(y)&&s.indexOf(y.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(y){return l(y)&&i(y)&&t[y.charCodeAt(0)].length>=1};var u=e.__arabicParser__.arabicLetterHasFinalForm=function(y){return l(y)&&i(y)&&t[y.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(y){return l(y)&&i(y)&&t[y.charCodeAt(0)].length>=3};var d=e.__arabicParser__.arabicLetterHasMedialForm=function(y){return l(y)&&i(y)&&t[y.charCodeAt(0)].length==4},f=e.__arabicParser__.resolveLigatures=function(y){var p=0,g=n,w="",v=0;for(p=0;p<y.length;p+=1)g[y.charCodeAt(p)]!==void 0?(v++,typeof(g=g[y.charCodeAt(p)])=="number"&&(w+=String.fromCharCode(g),g=n,v=0),p===y.length-1&&(g=n,w+=y.charAt(p-(v-1)),p-=v-1,v=0)):(g=n,w+=y.charAt(p-v),p-=v,v=0);return w};e.__arabicParser__.isArabicDiacritic=function(y){return y!==void 0&&r[y.charCodeAt(0)]!==void 0};var m=e.__arabicParser__.getCorrectForm=function(y,p,g){return l(y)?i(y)===!1?-1:!u(y)||!l(p)&&!l(g)||!l(g)&&o(p)||o(y)&&!l(p)||o(y)&&c(p)||o(y)&&o(p)?0:d(y)&&l(p)&&!o(p)&&l(g)&&u(g)?3:o(y)||!l(g)?1:2:-1},h=function(y){var p=0,g=0,w=0,v="",N="",A="",P=(y=y||"").split("\\s+"),U=[];for(p=0;p<P.length;p+=1){for(U.push(""),g=0;g<P[p].length;g+=1)v=P[p][g],N=P[p][g-1],A=P[p][g+1],l(v)?(w=m(v,N,A),U[p]+=w!==-1?String.fromCharCode(t[v.charCodeAt(0)][w]):v):U[p]+=v;U[p]=f(U[p])}return U.join(" ")},x=e.__arabicParser__.processArabic=e.processArabic=function(){var y,p=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,g=[];if(Array.isArray(p)){var w=0;for(g=[],w=0;w<p.length;w+=1)Array.isArray(p[w])?g.push([h(p[w][0]),p[w][1],p[w][2]]):g.push([h(p[w])]);y=g}else y=h(p);return typeof arguments[0]=="string"?y:(arguments[0].text=y,arguments[0])};e.events.push(["preProcessText",x])}(Zt.API),Zt.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform",e.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},function(e){var t=function(){var n=void 0;Object.defineProperty(this,"pdf",{get:function(){return n},set:function(o){n=o}});var r=150;Object.defineProperty(this,"width",{get:function(){return r},set:function(o){r=isNaN(o)||Number.isInteger(o)===!1||o<0?150:o,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=r+1)}});var s=300;Object.defineProperty(this,"height",{get:function(){return s},set:function(o){s=isNaN(o)||Number.isInteger(o)===!1||o<0?300:o,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=s+1)}});var i=[];Object.defineProperty(this,"childNodes",{get:function(){return i},set:function(o){i=o}});var l={};Object.defineProperty(this,"style",{get:function(){return l},set:function(o){l=o}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(n,r){var s;if((n=n||"2d")!=="2d")return null;for(s in r)this.pdf.context2d.hasOwnProperty(s)&&(this.pdf.context2d[s]=r[s]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])}(Zt.API),function(e){var t={left:0,top:0,bottom:0,right:0},n=!1,r=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),s.call(this))},s=function(){this.internal.__cell__.lastCell=new i,this.internal.__cell__.pages=1},i=function(){var c=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return c},set:function(y){c=y}});var u=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return u},set:function(y){u=y}});var d=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return d},set:function(y){d=y}});var f=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return f},set:function(y){f=y}});var m=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return m},set:function(y){m=y}});var h=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return h},set:function(y){h=y}});var x=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return x},set:function(y){x=y}}),this};i.prototype.clone=function(){return new i(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},i.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(c){return r.call(this),this.internal.__cell__.headerFunction=typeof c=="function"?c:void 0,this},e.getTextDimensions=function(c,u){r.call(this);var d=(u=u||{}).fontSize||this.getFontSize(),f=u.font||this.getFont(),m=u.scaleFactor||this.internal.scaleFactor,h=0,x=0,y=0,p=this;if(!Array.isArray(c)&&typeof c!="string"){if(typeof c!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");c=String(c)}var g=u.maxWidth;g>0?typeof c=="string"?c=this.splitTextToSize(c,g):Object.prototype.toString.call(c)==="[object Array]"&&(c=c.reduce(function(v,N){return v.concat(p.splitTextToSize(N,g))},[])):c=Array.isArray(c)?c:[c];for(var w=0;w<c.length;w++)h<(y=this.getStringUnitWidth(c[w],{font:f})*d)&&(h=y);return h!==0&&(x=c.length),{w:h/=m,h:Math.max((x*d*this.getLineHeightFactor()-d*(this.getLineHeightFactor()-1))/m,0)}},e.cellAddPage=function(){r.call(this),this.addPage();var c=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new i(c.left,c.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var l=e.cell=function(){var c;c=arguments[0]instanceof i?arguments[0]:new i(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5]),r.call(this);var u=this.internal.__cell__.lastCell,d=this.internal.__cell__.padding,f=this.internal.__cell__.margins||t,m=this.internal.__cell__.tableHeaderRow,h=this.internal.__cell__.printHeaders;return u.lineNumber!==void 0&&(u.lineNumber===c.lineNumber?(c.x=(u.x||0)+(u.width||0),c.y=u.y||0):u.y+u.height+c.height+f.bottom>this.getPageHeight()?(this.cellAddPage(),c.y=f.top,h&&m&&(this.printHeaderRow(c.lineNumber,!0),c.y+=m[0].height)):c.y=u.y+u.height||c.y),c.text[0]!==void 0&&(this.rect(c.x,c.y,c.width,c.height,n===!0?"FD":void 0),c.align==="right"?this.text(c.text,c.x+c.width-d,c.y+d,{align:"right",baseline:"top"}):c.align==="center"?this.text(c.text,c.x+c.width/2,c.y+d,{align:"center",baseline:"top",maxWidth:c.width-d-d}):this.text(c.text,c.x+d,c.y+d,{align:"left",baseline:"top",maxWidth:c.width-d-d})),this.internal.__cell__.lastCell=c,this};e.table=function(c,u,d,f,m){if(r.call(this),!d)throw new Error("No data for PDF table.");var h,x,y,p,g=[],w=[],v=[],N={},A={},P=[],U=[],M=(m=m||{}).autoSize||!1,S=m.printHeaders!==!1,C=m.css&&m.css["font-size"]!==void 0?16*m.css["font-size"]:m.fontSize||12,_=m.margins||Object.assign({width:this.getPageWidth()},t),T=typeof m.padding=="number"?m.padding:3,B=m.headerBackgroundColor||"#c8c8c8",$=m.headerTextColor||"#000";if(s.call(this),this.internal.__cell__.printHeaders=S,this.internal.__cell__.margins=_,this.internal.__cell__.table_font_size=C,this.internal.__cell__.padding=T,this.internal.__cell__.headerBackgroundColor=B,this.internal.__cell__.headerTextColor=$,this.setFontSize(C),f==null)w=g=Object.keys(d[0]),v=g.map(function(){return"left"});else if(Array.isArray(f)&&Kn(f[0])==="object")for(g=f.map(function(H){return H.name}),w=f.map(function(H){return H.prompt||H.name||""}),v=f.map(function(H){return H.align||"left"}),h=0;h<f.length;h+=1)A[f[h].name]=.7499990551181103*f[h].width;else Array.isArray(f)&&typeof f[0]=="string"&&(w=g=f,v=g.map(function(){return"left"}));if(M||Array.isArray(f)&&typeof f[0]=="string")for(h=0;h<g.length;h+=1){for(N[p=g[h]]=d.map(function(H){return H[p]}),this.setFont(void 0,"bold"),P.push(this.getTextDimensions(w[h],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),x=N[p],this.setFont(void 0,"normal"),y=0;y<x.length;y+=1)P.push(this.getTextDimensions(x[y],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);A[p]=Math.max.apply(null,P)+T+T,P=[]}if(S){var D={};for(h=0;h<g.length;h+=1)D[g[h]]={},D[g[h]].text=w[h],D[g[h]].align=v[h];var L=o.call(this,D,A);U=g.map(function(H){return new i(c,u,A[H],L,D[H].text,void 0,D[H].align)}),this.setTableHeaderRow(U),this.printHeaderRow(1,!1)}var O=f.reduce(function(H,V){return H[V.name]=V.align,H},{});for(h=0;h<d.length;h+=1){"rowStart"in m&&m.rowStart instanceof Function&&m.rowStart({row:h,data:d[h]},this);var W=o.call(this,d[h],A);for(y=0;y<g.length;y+=1){var E=d[h][g[y]];"cellStart"in m&&m.cellStart instanceof Function&&m.cellStart({row:h,col:y,data:E},this),l.call(this,new i(c,u,A[g[y]],W,E,h+2,O[g[y]]))}}return this.internal.__cell__.table_x=c,this.internal.__cell__.table_y=u,this};var o=function(c,u){var d=this.internal.__cell__.padding,f=this.internal.__cell__.table_font_size,m=this.internal.scaleFactor;return Object.keys(c).map(function(h){var x=c[h];return this.splitTextToSize(x.hasOwnProperty("text")?x.text:x,u[h]-d-d)},this).map(function(h){return this.getLineHeightFactor()*h.length*f/m+d+d},this).reduce(function(h,x){return Math.max(h,x)},0)};e.setTableHeaderRow=function(c){r.call(this),this.internal.__cell__.tableHeaderRow=c},e.printHeaderRow=function(c,u){if(r.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var d;if(n=!0,typeof this.internal.__cell__.headerFunction=="function"){var f=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new i(f[0],f[1],f[2],f[3],void 0,-1)}this.setFont(void 0,"bold");for(var m=[],h=0;h<this.internal.__cell__.tableHeaderRow.length;h+=1){d=this.internal.__cell__.tableHeaderRow[h].clone(),u&&(d.y=this.internal.__cell__.margins.top||0,m.push(d)),d.lineNumber=c;var x=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),l.call(this,d),this.setTextColor(x)}m.length>0&&this.setTableHeaderRow(m),this.setFont(void 0,"normal"),n=!1}}(Zt.API);var x7={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},y7=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],U2=g7(y7),b7=[100,200,300,400,500,600,700,800,900],OK=g7(b7);function rx(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),n=function(i){return x7[i=i||"normal"]?i:"normal"}(e.style),r=function(i){return i?typeof i=="number"?i>=100&&i<=900&&i%100==0?i:400:/^\d00$/.test(i)?parseInt(i):i==="bold"?700:400:400}(e.weight),s=function(i){return typeof U2[i=i||"normal"]=="number"?i:"normal"}(e.stretch);return{family:t,style:n,weight:r,stretch:s,src:e.src||[],ref:e.ref||{name:t,style:[s,n,r].join(" ")}}}function M3(e,t,n,r){var s;for(s=n;s>=0&&s<t.length;s+=r)if(e[t[s]])return e[t[s]];for(s=n;s>=0&&s<t.length;s-=r)if(e[t[s]])return e[t[s]]}var DK={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},R3={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function $3(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function F3(e){return e.trimLeft()}function BK(e,t){for(var n=0;n<e.length;){if(e.charAt(n)===t)return[e.substring(0,n),e.substring(n+1)];n+=1}return null}function zK(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var Mm,O3,D3,Kc,Rm,B3,z3,U3,sx=["times"];function q3(e,t,n,r,s){var i=4,l=W3;switch(s){case Zt.API.image_compression.FAST:i=1,l=H3;break;case Zt.API.image_compression.MEDIUM:i=6,l=V3;break;case Zt.API.image_compression.SLOW:i=9,l=G3}e=function(c,u,d,f){for(var m,h=c.length/u,x=new Uint8Array(c.length+h),y=[UK,H3,W3,V3,G3],p=0;p<h;p+=1){var g=p*u,w=c.subarray(g,g+u);if(f)x.set(f(w,d,m),g+p);else{for(var v=y.length,N=[],A=0;A<v;A+=1)N[A]=y[A](w,d,m);var P=HK(N.concat());x.set(N[P],g+p)}m=w}return x}(e,t,Math.ceil(n*r/8),l);var o=R2(e,{level:i});return Zt.API.__addimage__.arrayBufferToBinaryString(o)}function UK(e){var t=Array.apply([],e);return t.unshift(0),t}function H3(e,t){var n=e.length,r=[];r[0]=1;for(var s=0;s<n;s+=1){var i=e[s-t]||0;r[s+1]=e[s]-i+256&255}return r}function W3(e,t,n){var r=e.length,s=[];s[0]=2;for(var i=0;i<r;i+=1){var l=n&&n[i]||0;s[i+1]=e[i]-l+256&255}return s}function V3(e,t,n){var r=e.length,s=[];s[0]=3;for(var i=0;i<r;i+=1){var l=e[i-t]||0,o=n&&n[i]||0;s[i+1]=e[i]+256-(l+o>>>1)&255}return s}function G3(e,t,n){var r=e.length,s=[];s[0]=4;for(var i=0;i<r;i+=1){var l=qK(e[i-t]||0,n&&n[i]||0,n&&n[i-t]||0);s[i+1]=e[i]-l+256&255}return s}function qK(e,t,n){if(e===t&&t===n)return e;var r=Math.abs(t-n),s=Math.abs(e-n),i=Math.abs(e+t-n-n);return r<=s&&r<=i?e:s<=i?t:n}function HK(e){var t=e.map(function(n){return n.reduce(function(r,s){return r+Math.abs(s)},0)});return t.indexOf(Math.min.apply(null,t))}function ix(e,t,n){var r=t*n,s=Math.floor(r/8),i=16-(r-8*s+n),l=(1<<n)-1;return v7(e,s)>>i&l}function Y3(e,t,n,r){var s=n*r,i=Math.floor(s/8),l=16-(s-8*i+r),o=(1<<r)-1,c=(t&o)<<l;(function(u,d,f){if(d+1<u.byteLength)u.setUint16(d,f,!1);else{var m=f>>8&255;u.setUint8(d,m)}})(e,i,v7(e,i)&~(o<<l)&65535|c)}function v7(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function WK(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var n=e[t++]|e[t++]<<8,r=e[t++]|e[t++]<<8,s=e[t++],i=s>>7,l=1<<1+(7&s);e[t++],e[t++];var o=null,c=null;i&&(o=t,c=l,t+=3*l);var u=!0,d=[],f=0,m=null,h=0,x=null;for(this.width=n,this.height=r;u&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,x=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((_=e[t++])>=0))throw Error("Invalid block size");if(_===0)break;t+=_}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var y=e[t++];f=e[t++]|e[t++]<<8,m=e[t++],1&y||(m=null),h=y>>2&7,t++;break;case 254:for(;;){if(!((_=e[t++])>=0))throw Error("Invalid block size");if(_===0)break;t+=_}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var p=e[t++]|e[t++]<<8,g=e[t++]|e[t++]<<8,w=e[t++]|e[t++]<<8,v=e[t++]|e[t++]<<8,N=e[t++],A=N>>6&1,P=1<<1+(7&N),U=o,M=c,S=!1;N>>7&&(S=!0,U=t,M=P,t+=3*P);var C=t;for(t++;;){var _;if(!((_=e[t++])>=0))throw Error("Invalid block size");if(_===0)break;t+=_}d.push({x:p,y:g,width:w,height:v,has_local_palette:S,palette_offset:U,palette_size:M,data_offset:C,data_length:t-C,transparent_index:m,interlaced:!!A,delay:f,disposal:h});break;case 59:u=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return d.length},this.loopCount=function(){return x},this.frameInfo=function(T){if(T<0||T>=d.length)throw new Error("Frame index out of range.");return d[T]},this.decodeAndBlitFrameBGRA=function(T,B){var $=this.frameInfo(T),D=$.width*$.height,L=new Uint8Array(D);J3(e,$.data_offset,L,D);var O=$.palette_offset,W=$.transparent_index;W===null&&(W=256);var E=$.width,H=n-E,V=E,R=4*($.y*n+$.x),q=4*(($.y+$.height)*n+$.x),F=R,G=4*H;$.interlaced===!0&&(G+=4*n*7);for(var ee=8,ae=0,re=L.length;ae<re;++ae){var Q=L[ae];if(V===0&&(V=E,(F+=G)>=q&&(G=4*H+4*n*(ee-1),F=R+(E+H)*(ee<<1),ee>>=1)),Q===W)F+=4;else{var fe=e[O+3*Q],Se=e[O+3*Q+1],oe=e[O+3*Q+2];B[F++]=oe,B[F++]=Se,B[F++]=fe,B[F++]=255}--V}},this.decodeAndBlitFrameRGBA=function(T,B){var $=this.frameInfo(T),D=$.width*$.height,L=new Uint8Array(D);J3(e,$.data_offset,L,D);var O=$.palette_offset,W=$.transparent_index;W===null&&(W=256);var E=$.width,H=n-E,V=E,R=4*($.y*n+$.x),q=4*(($.y+$.height)*n+$.x),F=R,G=4*H;$.interlaced===!0&&(G+=4*n*7);for(var ee=8,ae=0,re=L.length;ae<re;++ae){var Q=L[ae];if(V===0&&(V=E,(F+=G)>=q&&(G=4*H+4*n*(ee-1),F=R+(E+H)*(ee<<1),ee>>=1)),Q===W)F+=4;else{var fe=e[O+3*Q],Se=e[O+3*Q+1],oe=e[O+3*Q+2];B[F++]=fe,B[F++]=Se,B[F++]=oe,B[F++]=255}--V}}}function J3(e,t,n,r){for(var s=e[t++],i=1<<s,l=i+1,o=l+1,c=s+1,u=(1<<c)-1,d=0,f=0,m=0,h=e[t++],x=new Int32Array(4096),y=null;;){for(;d<16&&h!==0;)f|=e[t++]<<d,d+=8,h===1?h=e[t++]:--h;if(d<c)break;var p=f&u;if(f>>=c,d-=c,p!==i){if(p===l)break;for(var g=p<o?p:y,w=0,v=g;v>i;)v=x[v]>>8,++w;var N=v;if(m+w+(g!==p?1:0)>r)return void rr.log("Warning, gif stream longer than expected.");n[m++]=N;var A=m+=w;for(g!==p&&(n[m++]=N),v=g;w--;)v=x[v],n[--A]=255&v,v>>=8;y!==null&&o<4096&&(x[o++]=y<<8|N,o>=u+1&&c<12&&(++c,u=u<<1|1)),y=p}else o=l+1,u=(1<<(c=s+1))-1,y=null}return m!==r&&rr.log("Warning, gif stream shorter than expected."),n}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function ax(e){var t,n,r,s,i,l=Math.floor,o=new Array(64),c=new Array(64),u=new Array(64),d=new Array(64),f=new Array(65535),m=new Array(65535),h=new Array(64),x=new Array(64),y=[],p=0,g=7,w=new Array(64),v=new Array(64),N=new Array(64),A=new Array(256),P=new Array(2048),U=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],M=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],S=[0,1,2,3,4,5,6,7,8,9,10,11],C=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],_=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],T=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],B=[0,1,2,3,4,5,6,7,8,9,10,11],$=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],D=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function L(R,q){for(var F=0,G=0,ee=new Array,ae=1;ae<=16;ae++){for(var re=1;re<=R[ae];re++)ee[q[G]]=[],ee[q[G]][0]=F,ee[q[G]][1]=ae,G++,F++;F*=2}return ee}function O(R){for(var q=R[0],F=R[1]-1;F>=0;)q&1<<F&&(p|=1<<g),F--,--g<0&&(p==255?(W(255),W(0)):W(p),g=7,p=0)}function W(R){y.push(R)}function E(R){W(R>>8&255),W(255&R)}function H(R,q,F,G,ee){for(var ae,re=ee[0],Q=ee[240],fe=function(qe,gt){var ut,Rt,Nt,ye,ze,Ze,xe,pt,Ne,de,se=0;for(Ne=0;Ne<8;++Ne){ut=qe[se],Rt=qe[se+1],Nt=qe[se+2],ye=qe[se+3],ze=qe[se+4],Ze=qe[se+5],xe=qe[se+6];var he=ut+(pt=qe[se+7]),ke=ut-pt,be=Rt+xe,Le=Rt-xe,He=Nt+Ze,Ue=Nt-Ze,De=ye+ze,_e=ye-ze,Ie=he+De,ht=he-De,wt=be+He,St=be-He;qe[se]=Ie+wt,qe[se+4]=Ie-wt;var Vt=.707106781*(St+ht);qe[se+2]=ht+Vt,qe[se+6]=ht-Vt;var qn=.382683433*((Ie=_e+Ue)-(St=Le+ke)),En=.5411961*Ie+qn,Dn=1.306562965*St+qn,lt=.707106781*(wt=Ue+Le),Fe=ke+lt,Dt=ke-lt;qe[se+5]=Dt+En,qe[se+3]=Dt-En,qe[se+1]=Fe+Dn,qe[se+7]=Fe-Dn,se+=8}for(se=0,Ne=0;Ne<8;++Ne){ut=qe[se],Rt=qe[se+8],Nt=qe[se+16],ye=qe[se+24],ze=qe[se+32],Ze=qe[se+40],xe=qe[se+48];var Gt=ut+(pt=qe[se+56]),Ht=ut-pt,ot=Rt+xe,_t=Rt-xe,Et=Nt+Ze,ft=Nt-Ze,at=ye+ze,Te=ye-ze,Ee=Gt+at,et=Gt-at,kt=ot+Et,vt=ot-Et;qe[se]=Ee+kt,qe[se+32]=Ee-kt;var At=.707106781*(vt+et);qe[se+16]=et+At,qe[se+48]=et-At;var Ct=.382683433*((Ee=Te+ft)-(vt=_t+Ht)),Lt=.5411961*Ee+Ct,Gn=1.306562965*vt+Ct,Lr=.707106781*(kt=ft+_t),nt=Ht+Lr,Qt=Ht-Lr;qe[se+40]=Qt+Lt,qe[se+24]=Qt-Lt,qe[se+8]=nt+Gn,qe[se+56]=nt-Gn,se++}for(Ne=0;Ne<64;++Ne)de=qe[Ne]*gt[Ne],h[Ne]=de>0?de+.5|0:de-.5|0;return h}(R,q),Se=0;Se<64;++Se)x[U[Se]]=fe[Se];var oe=x[0]-F;F=x[0],oe==0?O(G[0]):(O(G[m[ae=32767+oe]]),O(f[ae]));for(var pe=63;pe>0&&x[pe]==0;)pe--;if(pe==0)return O(re),F;for(var me,ne=1;ne<=pe;){for(var it=ne;x[ne]==0&&ne<=pe;)++ne;var $e=ne-it;if($e>=16){me=$e>>4;for(var Oe=1;Oe<=me;++Oe)O(Q);$e&=15}ae=32767+x[ne],O(ee[($e<<4)+m[ae]]),O(f[ae]),ne++}return pe!=63&&O(re),F}function V(R){R=Math.min(Math.max(R,1),100),i!=R&&(function(q){for(var F=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],G=0;G<64;G++){var ee=l((F[G]*q+50)/100);ee=Math.min(Math.max(ee,1),255),o[U[G]]=ee}for(var ae=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],re=0;re<64;re++){var Q=l((ae[re]*q+50)/100);Q=Math.min(Math.max(Q,1),255),c[U[re]]=Q}for(var fe=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Se=0,oe=0;oe<8;oe++)for(var pe=0;pe<8;pe++)u[Se]=1/(o[U[Se]]*fe[oe]*fe[pe]*8),d[Se]=1/(c[U[Se]]*fe[oe]*fe[pe]*8),Se++}(R<50?Math.floor(5e3/R):Math.floor(200-2*R)),i=R)}this.encode=function(R,q){q&&V(q),y=new Array,p=0,g=7,E(65496),E(65504),E(16),W(74),W(70),W(73),W(70),W(0),W(1),W(1),W(0),E(1),E(1),W(0),W(0),function(){E(65499),E(132),W(0);for(var Rt=0;Rt<64;Rt++)W(o[Rt]);W(1);for(var Nt=0;Nt<64;Nt++)W(c[Nt])}(),function(Rt,Nt){E(65472),E(17),W(8),E(Nt),E(Rt),W(3),W(1),W(17),W(0),W(2),W(17),W(1),W(3),W(17),W(1)}(R.width,R.height),function(){E(65476),E(418),W(0);for(var Rt=0;Rt<16;Rt++)W(M[Rt+1]);for(var Nt=0;Nt<=11;Nt++)W(S[Nt]);W(16);for(var ye=0;ye<16;ye++)W(C[ye+1]);for(var ze=0;ze<=161;ze++)W(_[ze]);W(1);for(var Ze=0;Ze<16;Ze++)W(T[Ze+1]);for(var xe=0;xe<=11;xe++)W(B[xe]);W(17);for(var pt=0;pt<16;pt++)W($[pt+1]);for(var Ne=0;Ne<=161;Ne++)W(D[Ne])}(),E(65498),E(12),W(3),W(1),W(0),W(2),W(17),W(3),W(17),W(0),W(63),W(0);var F=0,G=0,ee=0;p=0,g=7,this.encode.displayName="_encode_";for(var ae,re,Q,fe,Se,oe,pe,me,ne,it=R.data,$e=R.width,Oe=R.height,qe=4*$e,gt=0;gt<Oe;){for(ae=0;ae<qe;){for(Se=qe*gt+ae,pe=-1,me=0,ne=0;ne<64;ne++)oe=Se+(me=ne>>3)*qe+(pe=4*(7&ne)),gt+me>=Oe&&(oe-=qe*(gt+1+me-Oe)),ae+pe>=qe&&(oe-=ae+pe-qe+4),re=it[oe++],Q=it[oe++],fe=it[oe++],w[ne]=(P[re]+P[Q+256|0]+P[fe+512|0]>>16)-128,v[ne]=(P[re+768|0]+P[Q+1024|0]+P[fe+1280|0]>>16)-128,N[ne]=(P[re+1280|0]+P[Q+1536|0]+P[fe+1792|0]>>16)-128;F=H(w,u,F,t,r),G=H(v,d,G,n,s),ee=H(N,d,ee,n,s),ae+=32}gt+=8}if(g>=0){var ut=[];ut[1]=g+1,ut[0]=(1<<g+1)-1,O(ut)}return E(65497),new Uint8Array(y)},e=e||50,function(){for(var R=String.fromCharCode,q=0;q<256;q++)A[q]=R(q)}(),t=L(M,S),n=L(T,B),r=L(C,_),s=L($,D),function(){for(var R=1,q=2,F=1;F<=15;F++){for(var G=R;G<q;G++)m[32767+G]=F,f[32767+G]=[],f[32767+G][1]=F,f[32767+G][0]=G;for(var ee=-(q-1);ee<=-R;ee++)m[32767+ee]=F,f[32767+ee]=[],f[32767+ee][1]=F,f[32767+ee][0]=q-1+ee;R<<=1,q<<=1}}(),function(){for(var R=0;R<256;R++)P[R]=19595*R,P[R+256|0]=38470*R,P[R+512|0]=7471*R+32768,P[R+768|0]=-11059*R,P[R+1024|0]=-21709*R,P[R+1280|0]=32768*R+8421375,P[R+1536|0]=-27439*R,P[R+1792|0]=-5329*R}(),V(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function Ji(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function Z3(e){function t(S){if(!S)throw Error("assert :P")}function n(S,C,_){for(var T=0;4>T;T++)if(S[C+T]!=_.charCodeAt(T))return!0;return!1}function r(S,C,_,T,B){for(var $=0;$<B;$++)S[C+$]=_[T+$]}function s(S,C,_,T){for(var B=0;B<T;B++)S[C+B]=_}function i(S){return new Int32Array(S)}function l(S,C){for(var _=[],T=0;T<S;T++)_.push(new C);return _}function o(S,C){var _=[];return function T(B,$,D){for(var L=D[$],O=0;O<L&&(B.push(D.length>$+1?[]:new C),!(D.length<$+1));O++)T(B[O],$+1,D)}(_,0,S),_}var c=function(){var S=this;function C(b,j){for(var I=1<<j-1>>>0;b&I;)I>>>=1;return I?(b&I-1)+I:b}function _(b,j,I,z,Z){t(!(z%I));do b[j+(z-=I)]=Z;while(0<z)}function T(b,j,I,z,Z){if(t(2328>=Z),512>=Z)var X=i(512);else if((X=i(Z))==null)return 0;return function(K,te,ie,le,je,Re){var ce,Ae,Pe=te,We=1<<ie,Me=i(16),Ve=i(16);for(t(je!=0),t(le!=null),t(K!=null),t(0<ie),Ae=0;Ae<je;++Ae){if(15<le[Ae])return 0;++Me[le[Ae]]}if(Me[0]==je)return 0;for(Ve[1]=0,ce=1;15>ce;++ce){if(Me[ce]>1<<ce)return 0;Ve[ce+1]=Ve[ce]+Me[ce]}for(Ae=0;Ae<je;++Ae)ce=le[Ae],0<le[Ae]&&(Re[Ve[ce]++]=Ae);if(Ve[15]==1)return(le=new B).g=0,le.value=Re[0],_(K,Pe,1,We,le),We;var Xe,dt=-1,rt=We-1,Jt=0,Mt=1,wn=1,Ut=1<<ie;for(Ae=0,ce=1,je=2;ce<=ie;++ce,je<<=1){if(Mt+=wn<<=1,0>(wn-=Me[ce]))return 0;for(;0<Me[ce];--Me[ce])(le=new B).g=ce,le.value=Re[Ae++],_(K,Pe+Jt,je,Ut,le),Jt=C(Jt,ce)}for(ce=ie+1,je=2;15>=ce;++ce,je<<=1){if(Mt+=wn<<=1,0>(wn-=Me[ce]))return 0;for(;0<Me[ce];--Me[ce]){if(le=new B,(Jt&rt)!=dt){for(Pe+=Ut,Xe=1<<(dt=ce)-ie;15>dt&&!(0>=(Xe-=Me[dt]));)++dt,Xe<<=1;We+=Ut=1<<(Xe=dt-ie),K[te+(dt=Jt&rt)].g=Xe+ie,K[te+dt].value=Pe-te-dt}le.g=ce-ie,le.value=Re[Ae++],_(K,Pe+(Jt>>ie),je,Ut,le),Jt=C(Jt,ce)}}return Mt!=2*Ve[15]-1?0:We}(b,j,I,z,Z,X)}function B(){this.value=this.g=0}function $(){this.value=this.g=0}function D(){this.G=l(5,B),this.H=i(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=l(Al,$)}function L(b,j,I,z){t(b!=null),t(j!=null),t(2147483648>z),b.Ca=254,b.I=0,b.b=-8,b.Ka=0,b.oa=j,b.pa=I,b.Jd=j,b.Yc=I+z,b.Zc=4<=z?I+z-4+1:I,re(b)}function O(b,j){for(var I=0;0<j--;)I|=fe(b,128)<<j;return I}function W(b,j){var I=O(b,j);return Q(b)?-I:I}function E(b,j,I,z){var Z,X=0;for(t(b!=null),t(j!=null),t(4294967288>z),b.Sb=z,b.Ra=0,b.u=0,b.h=0,4<z&&(z=4),Z=0;Z<z;++Z)X+=j[I+Z]<<8*Z;b.Ra=X,b.bb=z,b.oa=j,b.pa=I}function H(b){for(;8<=b.u&&b.bb<b.Sb;)b.Ra>>>=8,b.Ra+=b.oa[b.pa+b.bb]<<_o-8>>>0,++b.bb,b.u-=8;G(b)&&(b.h=1,b.u=0)}function V(b,j){if(t(0<=j),!b.h&&j<=ui){var I=F(b)&ci[j];return b.u+=j,H(b),I}return b.h=1,b.u=0}function R(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function q(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function F(b){return b.Ra>>>(b.u&_o-1)>>>0}function G(b){return t(b.bb<=b.Sb),b.h||b.bb==b.Sb&&b.u>_o}function ee(b,j){b.u=j,b.h=G(b)}function ae(b){b.u>=Ha&&(t(b.u>=Ha),H(b))}function re(b){t(b!=null&&b.oa!=null),b.pa<b.Zc?(b.I=(b.oa[b.pa++]|b.I<<8)>>>0,b.b+=8):(t(b!=null&&b.oa!=null),b.pa<b.Yc?(b.b+=8,b.I=b.oa[b.pa++]|b.I<<8):b.Ka?b.b=0:(b.I<<=8,b.b+=8,b.Ka=1))}function Q(b){return O(b,1)}function fe(b,j){var I=b.Ca;0>b.b&&re(b);var z=b.b,Z=I*j>>>8,X=(b.I>>>z>Z)+0;for(X?(I-=Z,b.I-=Z+1<<z>>>0):I=Z+1,z=I,Z=0;256<=z;)Z+=8,z>>=8;return z=7^Z+Ao[z],b.b-=z,b.Ca=(I<<z)-1,X}function Se(b,j,I){b[j+0]=I>>24&255,b[j+1]=I>>16&255,b[j+2]=I>>8&255,b[j+3]=255&I}function oe(b,j){return b[j+0]|b[j+1]<<8}function pe(b,j){return oe(b,j)|b[j+2]<<16}function me(b,j){return oe(b,j)|oe(b,j+2)<<16}function ne(b,j){var I=1<<j;return t(b!=null),t(0<j),b.X=i(I),b.X==null?0:(b.Mb=32-j,b.Xa=j,1)}function it(b,j){t(b!=null),t(j!=null),t(b.Xa==j.Xa),r(j.X,0,b.X,0,1<<j.Xa)}function $e(){this.X=[],this.Xa=this.Mb=0}function Oe(b,j,I,z){t(I!=null),t(z!=null);var Z=I[0],X=z[0];return Z==0&&(Z=(b*X+j/2)/j),X==0&&(X=(j*Z+b/2)/b),0>=Z||0>=X?0:(I[0]=Z,z[0]=X,1)}function qe(b,j){return b+(1<<j)-1>>>j}function gt(b,j){return((4278255360&b)+(4278255360&j)>>>0&4278255360)+((16711935&b)+(16711935&j)>>>0&16711935)>>>0}function ut(b,j){S[j]=function(I,z,Z,X,K,te,ie){var le;for(le=0;le<K;++le){var je=S[b](te[ie+le-1],Z,X+le);te[ie+le]=gt(I[z+le],je)}}}function Rt(){this.ud=this.hd=this.jd=0}function Nt(b,j){return((4278124286&(b^j))>>>1)+(b&j)>>>0}function ye(b){return 0<=b&&256>b?b:0>b?0:255<b?255:void 0}function ze(b,j){return ye(b+(b-j+.5>>1))}function Ze(b,j,I){return Math.abs(j-I)-Math.abs(b-I)}function xe(b,j,I,z,Z,X,K){for(z=X[K-1],I=0;I<Z;++I)X[K+I]=z=gt(b[j+I],z)}function pt(b,j,I,z,Z){var X;for(X=0;X<I;++X){var K=b[j+X],te=K>>8&255,ie=16711935&(ie=(ie=16711935&K)+((te<<16)+te));z[Z+X]=(4278255360&K)+ie>>>0}}function Ne(b,j){j.jd=255&b,j.hd=b>>8&255,j.ud=b>>16&255}function de(b,j,I,z,Z,X){var K;for(K=0;K<z;++K){var te=j[I+K],ie=te>>>8,le=te,je=255&(je=(je=te>>>16)+((b.jd<<24>>24)*(ie<<24>>24)>>>5));le=255&(le=(le+=(b.hd<<24>>24)*(ie<<24>>24)>>>5)+((b.ud<<24>>24)*(je<<24>>24)>>>5)),Z[X+K]=(4278255360&te)+(je<<16)+le}}function se(b,j,I,z,Z){S[j]=function(X,K,te,ie,le,je,Re,ce,Ae){for(ie=Re;ie<ce;++ie)for(Re=0;Re<Ae;++Re)le[je++]=Z(te[z(X[K++])])},S[b]=function(X,K,te,ie,le,je,Re){var ce=8>>X.b,Ae=X.Ea,Pe=X.K[0],We=X.w;if(8>ce)for(X=(1<<X.b)-1,We=(1<<ce)-1;K<te;++K){var Me,Ve=0;for(Me=0;Me<Ae;++Me)Me&X||(Ve=z(ie[le++])),je[Re++]=Z(Pe[Ve&We]),Ve>>=ce}else S["VP8LMapColor"+I](ie,le,Pe,We,je,Re,K,te,Ae)}}function he(b,j,I,z,Z){for(I=j+I;j<I;){var X=b[j++];z[Z++]=X>>16&255,z[Z++]=X>>8&255,z[Z++]=255&X}}function ke(b,j,I,z,Z){for(I=j+I;j<I;){var X=b[j++];z[Z++]=X>>16&255,z[Z++]=X>>8&255,z[Z++]=255&X,z[Z++]=X>>24&255}}function be(b,j,I,z,Z){for(I=j+I;j<I;){var X=(K=b[j++])>>16&240|K>>12&15,K=240&K|K>>28&15;z[Z++]=X,z[Z++]=K}}function Le(b,j,I,z,Z){for(I=j+I;j<I;){var X=(K=b[j++])>>16&248|K>>13&7,K=K>>5&224|K>>3&31;z[Z++]=X,z[Z++]=K}}function He(b,j,I,z,Z){for(I=j+I;j<I;){var X=b[j++];z[Z++]=255&X,z[Z++]=X>>8&255,z[Z++]=X>>16&255}}function Ue(b,j,I,z,Z,X){if(X==0)for(I=j+I;j<I;)Se(z,((X=b[j++])[0]>>24|X[1]>>8&65280|X[2]<<8&16711680|X[3]<<24)>>>0),Z+=32;else r(z,Z,b,j,I)}function De(b,j){S[j][0]=S[b+"0"],S[j][1]=S[b+"1"],S[j][2]=S[b+"2"],S[j][3]=S[b+"3"],S[j][4]=S[b+"4"],S[j][5]=S[b+"5"],S[j][6]=S[b+"6"],S[j][7]=S[b+"7"],S[j][8]=S[b+"8"],S[j][9]=S[b+"9"],S[j][10]=S[b+"10"],S[j][11]=S[b+"11"],S[j][12]=S[b+"12"],S[j][13]=S[b+"13"],S[j][14]=S[b+"0"],S[j][15]=S[b+"0"]}function _e(b){return b==wg||b==Ng||b==zh||b==jg}function Ie(){this.eb=[],this.size=this.A=this.fb=0}function ht(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function wt(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new Ie,this.f.kb=new ht,this.sd=null}function St(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Vt(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function qn(b){return alert("todo:WebPSamplerProcessPlane"),b.T}function En(b,j){var I=b.T,z=j.ba.f.RGBA,Z=z.eb,X=z.fb+b.ka*z.A,K=Ii[j.ba.S],te=b.y,ie=b.O,le=b.f,je=b.N,Re=b.ea,ce=b.W,Ae=j.cc,Pe=j.dc,We=j.Mc,Me=j.Nc,Ve=b.ka,Xe=b.ka+b.T,dt=b.U,rt=dt+1>>1;for(Ve==0?K(te,ie,null,null,le,je,Re,ce,le,je,Re,ce,Z,X,null,null,dt):(K(j.ec,j.fc,te,ie,Ae,Pe,We,Me,le,je,Re,ce,Z,X-z.A,Z,X,dt),++I);Ve+2<Xe;Ve+=2)Ae=le,Pe=je,We=Re,Me=ce,je+=b.Rc,ce+=b.Rc,X+=2*z.A,K(te,(ie+=2*b.fa)-b.fa,te,ie,Ae,Pe,We,Me,le,je,Re,ce,Z,X-z.A,Z,X,dt);return ie+=b.fa,b.j+Xe<b.o?(r(j.ec,j.fc,te,ie,dt),r(j.cc,j.dc,le,je,rt),r(j.Mc,j.Nc,Re,ce,rt),I--):1&Xe||K(te,ie,null,null,le,je,Re,ce,le,je,Re,ce,Z,X+z.A,null,null,dt),I}function Dn(b,j,I){var z=b.F,Z=[b.J];if(z!=null){var X=b.U,K=j.ba.S,te=K==Bh||K==zh;j=j.ba.f.RGBA;var ie=[0],le=b.ka;ie[0]=b.T,b.Kb&&(le==0?--ie[0]:(--le,Z[0]-=b.width),b.j+b.ka+b.T==b.o&&(ie[0]=b.o-b.j-le));var je=j.eb;le=j.fb+le*j.A,b=av(z,Z[0],b.width,X,ie,je,le+(te?0:3),j.A),t(I==ie),b&&_e(K)&&jd(je,le,te,X,ie,j.A)}return 0}function lt(b){var j=b.ma,I=j.ba.S,z=11>I,Z=I==Oh||I==Dh||I==Bh||I==vg||I==12||_e(I);if(j.memory=null,j.Ib=null,j.Jb=null,j.Nd=null,!pd(j.Oa,b,Z?11:12))return 0;if(Z&&_e(I)&&Th(),b.da)alert("todo:use_scaling");else{if(z){if(j.Ib=qn,b.Kb){if(I=b.U+1>>1,j.memory=i(b.U+2*I),j.memory==null)return 0;j.ec=j.memory,j.fc=0,j.cc=j.ec,j.dc=j.fc+b.U,j.Mc=j.cc,j.Nc=j.dc+I,j.Ib=En,Th()}}else alert("todo:EmitYUV");Z&&(j.Jb=Dn,z&&ki())}if(z&&!Nv){for(b=0;256>b;++b)gE[b]=89858*(b-128)+qh>>Uh,bE[b]=-22014*(b-128)+qh,yE[b]=-45773*(b-128),xE[b]=113618*(b-128)+qh>>Uh;for(b=_d;b<Ag;++b)j=76283*(b-16)+qh>>Uh,vE[b-_d]=jr(j,255),wE[b-_d]=jr(j+8>>4,15);Nv=1}return 1}function Fe(b){var j=b.ma,I=b.U,z=b.T;return t(!(1&b.ka)),0>=I||0>=z?0:(I=j.Ib(b,j),j.Jb!=null&&j.Jb(b,j,I),j.Dc+=I,1)}function Dt(b){b.ma.memory=null}function Gt(b,j,I,z){return V(b,8)!=47?0:(j[0]=V(b,14)+1,I[0]=V(b,14)+1,z[0]=V(b,1),V(b,3)!=0?0:!b.h)}function Ht(b,j){if(4>b)return b+1;var I=b-2>>1;return(2+(1&b)<<I)+V(j,I)+1}function ot(b,j){return 120<j?j-120:1<=(I=((I=nE[j-1])>>4)*b+(8-(15&I)))?I:1;var I}function _t(b,j,I){var z=F(I),Z=b[j+=255&z].g-8;return 0<Z&&(ee(I,I.u+8),z=F(I),j+=b[j].value,j+=z&(1<<Z)-1),ee(I,I.u+b[j].g),b[j].value}function Et(b,j,I){return I.g+=b.g,I.value+=b.value<<j>>>0,t(8>=I.g),b.g}function ft(b,j,I){var z=b.xc;return t((j=z==0?0:b.vc[b.md*(I>>z)+(j>>z)])<b.Wb),b.Ya[j]}function at(b,j,I,z){var Z=b.ab,X=b.c*j,K=b.C;j=K+j;var te=I,ie=z;for(z=b.Ta,I=b.Ua;0<Z--;){var le=b.gc[Z],je=K,Re=j,ce=te,Ae=ie,Pe=(ie=z,te=I,le.Ea);switch(t(je<Re),t(Re<=le.nc),le.hc){case 2:Mr(ce,Ae,(Re-je)*Pe,ie,te);break;case 0:var We=je,Me=Re,Ve=ie,Xe=te,dt=(Ut=le).Ea;We==0&&(xd(ce,Ae,null,null,1,Ve,Xe),xe(ce,Ae+1,0,0,dt-1,Ve,Xe+1),Ae+=dt,Xe+=dt,++We);for(var rt=1<<Ut.b,Jt=rt-1,Mt=qe(dt,Ut.b),wn=Ut.K,Ut=Ut.w+(We>>Ut.b)*Mt;We<Me;){var Pn=wn,Kr=Ut,Nn=1;for(Rc(ce,Ae,Ve,Xe-dt,1,Ve,Xe);Nn<dt;){var qt=(Nn&~Jt)+rt;qt>dt&&(qt=dt),(0,bd[Pn[Kr++]>>8&15])(ce,Ae+ +Nn,Ve,Xe+Nn-dt,qt-Nn,Ve,Xe+Nn),Nn=qt}Ae+=dt,Xe+=dt,++We&Jt||(Ut+=Mt)}Re!=le.nc&&r(ie,te-Pe,ie,te+(Re-je-1)*Pe,Pe);break;case 1:for(Pe=ce,Me=Ae,dt=(ce=le.Ea)-(Xe=ce&~(Ve=(Ae=1<<le.b)-1)),We=qe(ce,le.b),rt=le.K,le=le.w+(je>>le.b)*We;je<Re;){for(Jt=rt,Mt=le,wn=new Rt,Ut=Me+Xe,Pn=Me+ce;Me<Ut;)Ne(Jt[Mt++],wn),vd(wn,Pe,Me,Ae,ie,te),Me+=Ae,te+=Ae;Me<Pn&&(Ne(Jt[Mt++],wn),vd(wn,Pe,Me,dt,ie,te),Me+=dt,te+=dt),++je&Ve||(le+=We)}break;case 3:if(ce==ie&&Ae==te&&0<le.b){for(Me=ie,ce=Pe=te+(Re-je)*Pe-(Xe=(Re-je)*qe(le.Ea,le.b)),Ae=ie,Ve=te,We=[],Xe=(dt=Xe)-1;0<=Xe;--Xe)We[Xe]=Ae[Ve+Xe];for(Xe=dt-1;0<=Xe;--Xe)Me[ce+Xe]=We[Xe];Mh(le,je,Re,ie,Pe,ie,te)}else Mh(le,je,Re,ce,Ae,ie,te)}te=z,ie=I}ie!=I&&r(z,I,te,ie,X)}function Te(b,j){var I=b.V,z=b.Ba+b.c*b.C,Z=j-b.C;if(t(j<=b.l.o),t(16>=Z),0<Z){var X=b.l,K=b.Ta,te=b.Ua,ie=X.width;if(at(b,Z,I,z),Z=te=[te],t((I=b.C)<(z=j)),t(X.v<X.va),z>X.o&&(z=X.o),I<X.j){var le=X.j-I;I=X.j,Z[0]+=le*ie}if(I>=z?I=0:(Z[0]+=4*X.v,X.ka=I-X.j,X.U=X.va-X.v,X.T=z-I,I=1),I){if(te=te[0],11>(I=b.ca).S){var je=I.f.RGBA,Re=(z=I.S,Z=X.U,X=X.T,le=je.eb,je.A),ce=X;for(je=je.fb+b.Ma*je.A;0<ce--;){var Ae=K,Pe=te,We=Z,Me=le,Ve=je;switch(z){case Fh:wd(Ae,Pe,We,Me,Ve);break;case Oh:ko(Ae,Pe,We,Me,Ve);break;case wg:ko(Ae,Pe,We,Me,Ve),jd(Me,Ve,0,We,1,0);break;case hv:kl(Ae,Pe,We,Me,Ve);break;case Dh:Ue(Ae,Pe,We,Me,Ve,1);break;case Ng:Ue(Ae,Pe,We,Me,Ve,1),jd(Me,Ve,0,We,1,0);break;case Bh:Ue(Ae,Pe,We,Me,Ve,0);break;case zh:Ue(Ae,Pe,We,Me,Ve,0),jd(Me,Ve,1,We,1,0);break;case vg:Eo(Ae,Pe,We,Me,Ve);break;case jg:Eo(Ae,Pe,We,Me,Ve),iv(Me,Ve,We,1,0);break;case mv:Co(Ae,Pe,We,Me,Ve);break;default:t(0)}te+=ie,je+=Re}b.Ma+=X}else alert("todo:EmitRescaledRowsYUVA");t(b.Ma<=I.height)}}b.C=j,t(b.C<=b.i)}function Ee(b){var j;if(0<b.ua)return 0;for(j=0;j<b.Wb;++j){var I=b.Ya[j].G,z=b.Ya[j].H;if(0<I[1][z[1]+0].g||0<I[2][z[2]+0].g||0<I[3][z[3]+0].g)return 0}return 1}function et(b,j,I,z,Z,X){if(b.Z!=0){var K=b.qd,te=b.rd;for(t(To[b.Z]!=null);j<I;++j)To[b.Z](K,te,z,Z,z,Z,X),K=z,te=Z,Z+=X;b.qd=K,b.rd=te}}function kt(b,j){var I=b.l.ma,z=I.Z==0||I.Z==1?b.l.j:b.C;if(z=b.C<z?z:b.C,t(j<=b.l.o),j>z){var Z=b.l.width,X=I.ca,K=I.tb+Z*z,te=b.V,ie=b.Ba+b.c*z,le=b.gc;t(b.ab==1),t(le[0].hc==3),ma(le[0],z,j,te,ie,X,K),et(I,z,j,X,K,Z)}b.C=b.Ma=j}function vt(b,j,I,z,Z,X,K){var te=b.$/z,ie=b.$%z,le=b.m,je=b.s,Re=I+b.$,ce=Re;Z=I+z*Z;var Ae=I+z*X,Pe=280+je.ua,We=b.Pb?te:16777216,Me=0<je.ua?je.Wa:null,Ve=je.wc,Xe=Re<Ae?ft(je,ie,te):null;t(b.C<X),t(Ae<=Z);var dt=!1;e:for(;;){for(;dt||Re<Ae;){var rt=0;if(te>=We){var Jt=Re-I;t((We=b).Pb),We.wd=We.m,We.xd=Jt,0<We.s.ua&&it(We.s.Wa,We.s.vb),We=te+sE}if(ie&Ve||(Xe=ft(je,ie,te)),t(Xe!=null),Xe.Qb&&(j[Re]=Xe.qb,dt=!0),!dt)if(ae(le),Xe.jc){rt=le,Jt=j;var Mt=Re,wn=Xe.pd[F(rt)&Al-1];t(Xe.jc),256>wn.g?(ee(rt,rt.u+wn.g),Jt[Mt]=wn.value,rt=0):(ee(rt,rt.u+wn.g-256),t(256<=wn.value),rt=wn.value),rt==0&&(dt=!0)}else rt=_t(Xe.G[0],Xe.H[0],le);if(le.h)break;if(dt||256>rt){if(!dt)if(Xe.nd)j[Re]=(Xe.qb|rt<<8)>>>0;else{if(ae(le),dt=_t(Xe.G[1],Xe.H[1],le),ae(le),Jt=_t(Xe.G[2],Xe.H[2],le),Mt=_t(Xe.G[3],Xe.H[3],le),le.h)break;j[Re]=(Mt<<24|dt<<16|rt<<8|Jt)>>>0}if(dt=!1,++Re,++ie>=z&&(ie=0,++te,K!=null&&te<=X&&!(te%16)&&K(b,te),Me!=null))for(;ce<Re;)rt=j[ce++],Me.X[(506832829*rt&4294967295)>>>Me.Mb]=rt}else if(280>rt){if(rt=Ht(rt-256,le),Jt=_t(Xe.G[4],Xe.H[4],le),ae(le),Jt=ot(z,Jt=Ht(Jt,le)),le.h)break;if(Re-I<Jt||Z-Re<rt)break e;for(Mt=0;Mt<rt;++Mt)j[Re+Mt]=j[Re+Mt-Jt];for(Re+=rt,ie+=rt;ie>=z;)ie-=z,++te,K!=null&&te<=X&&!(te%16)&&K(b,te);if(t(Re<=Z),ie&Ve&&(Xe=ft(je,ie,te)),Me!=null)for(;ce<Re;)rt=j[ce++],Me.X[(506832829*rt&4294967295)>>>Me.Mb]=rt}else{if(!(rt<Pe))break e;for(dt=rt-280,t(Me!=null);ce<Re;)rt=j[ce++],Me.X[(506832829*rt&4294967295)>>>Me.Mb]=rt;rt=Re,t(!(dt>>>(Jt=Me).Xa)),j[rt]=Jt.X[dt],dt=!0}dt||t(le.h==G(le))}if(b.Pb&&le.h&&Re<Z)t(b.m.h),b.a=5,b.m=b.wd,b.$=b.xd,0<b.s.ua&&it(b.s.vb,b.s.Wa);else{if(le.h)break e;K!=null&&K(b,te>X?X:te),b.a=0,b.$=Re-I}return 1}return b.a=3,0}function At(b){t(b!=null),b.vc=null,b.yc=null,b.Ya=null;var j=b.Wa;j!=null&&(j.X=null),b.vb=null,t(b!=null)}function Ct(){var b=new Yt;return b==null?null:(b.a=0,b.xb=xv,De("Predictor","VP8LPredictors"),De("Predictor","VP8LPredictors_C"),De("PredictorAdd","VP8LPredictorsAdd"),De("PredictorAdd","VP8LPredictorsAdd_C"),Mr=pt,vd=de,wd=he,ko=ke,Eo=be,Co=Le,kl=He,S.VP8LMapColor32b=ha,S.VP8LMapColor8b=yd,b)}function Lt(b,j,I,z,Z){var X=1,K=[b],te=[j],ie=z.m,le=z.s,je=null,Re=0;e:for(;;){if(I)for(;X&&V(ie,1);){var ce=K,Ae=te,Pe=z,We=1,Me=Pe.m,Ve=Pe.gc[Pe.ab],Xe=V(Me,2);if(Pe.Oc&1<<Xe)X=0;else{switch(Pe.Oc|=1<<Xe,Ve.hc=Xe,Ve.Ea=ce[0],Ve.nc=Ae[0],Ve.K=[null],++Pe.ab,t(4>=Pe.ab),Xe){case 0:case 1:Ve.b=V(Me,3)+2,We=Lt(qe(Ve.Ea,Ve.b),qe(Ve.nc,Ve.b),0,Pe,Ve.K),Ve.K=Ve.K[0];break;case 3:var dt,rt=V(Me,8)+1,Jt=16<rt?0:4<rt?1:2<rt?2:3;if(ce[0]=qe(Ve.Ea,Jt),Ve.b=Jt,dt=We=Lt(rt,1,0,Pe,Ve.K)){var Mt,wn=rt,Ut=Ve,Pn=1<<(8>>Ut.b),Kr=i(Pn);if(Kr==null)dt=0;else{var Nn=Ut.K[0],qt=Ut.w;for(Kr[0]=Ut.K[0][0],Mt=1;Mt<1*wn;++Mt)Kr[Mt]=gt(Nn[qt+Mt],Kr[Mt-1]);for(;Mt<4*Pn;++Mt)Kr[Mt]=0;Ut.K[0]=null,Ut.K[0]=Kr,dt=1}}We=dt;break;case 2:break;default:t(0)}X=We}}if(K=K[0],te=te[0],X&&V(ie,1)&&!(X=1<=(Re=V(ie,4))&&11>=Re)){z.a=3;break e}var jt;if(jt=X)t:{var $r,xn,Ln,ur=z,hs=K,$s=te,Sr=Re,js=I,Fs=ur.m,Qr=ur.s,Mn=[null],Yn=1,_r=0,Jn=rE[Sr];n:for(;;){if(js&&V(Fs,1)){var ms=V(Fs,3)+2,Gi=qe(hs,ms),Fr=qe($s,ms),Xs=Gi*Fr;if(!Lt(Gi,Fr,0,ur,Mn))break n;for(Mn=Mn[0],Qr.xc=ms,$r=0;$r<Xs;++$r){var nr=Mn[$r]>>8&65535;Mn[$r]=nr,nr>=Yn&&(Yn=nr+1)}}if(Fs.h)break n;for(xn=0;5>xn;++xn){var es=pv[xn];!xn&&0<Sr&&(es+=1<<Sr),_r<es&&(_r=es)}var fi=l(Yn*Jn,B),Os=Yn,hi=l(Os,D);if(hi==null)var mi=null;else t(65536>=Os),mi=hi;var Ks=i(_r);if(mi==null||Ks==null||fi==null){ur.a=1;break n}var pi=fi;for($r=Ln=0;$r<Yn;++$r){var lr=mi[$r],gi=lr.G,Yi=lr.H,Cl=0,Ga=1,ps=0;for(xn=0;5>xn;++xn){es=pv[xn],gi[xn]=pi,Yi[xn]=Ln,!xn&&0<Sr&&(es+=1<<Sr);s:{var Wh,kg=es,Vh=ur,Ad=Ks,SE=pi,_E=Ln,Eg=0,Lo=Vh.m,AE=V(Lo,1);if(s(Ad,0,0,kg),AE){var kE=V(Lo,1)+1,EE=V(Lo,1),_v=V(Lo,EE==0?1:8);Ad[_v]=1,kE==2&&(Ad[_v=V(Lo,8)]=1);var Gh=1}else{var Av=i(19),kv=V(Lo,4)+4;if(19<kv){Vh.a=3;var Yh=0;break s}for(Wh=0;Wh<kv;++Wh)Av[tE[Wh]]=V(Lo,3);var Cg=void 0,kd=void 0,Ev=Vh,CE=Av,Jh=kg,Cv=Ad,Pg=0,Mo=Ev.m,Pv=8,Iv=l(128,B);r:for(;T(Iv,0,7,CE,19);){if(V(Mo,1)){var PE=2+2*V(Mo,3);if((Cg=2+V(Mo,PE))>Jh)break r}else Cg=Jh;for(kd=0;kd<Jh&&Cg--;){ae(Mo);var Tv=Iv[0+(127&F(Mo))];ee(Mo,Mo.u+Tv.g);var Fc=Tv.value;if(16>Fc)Cv[kd++]=Fc,Fc!=0&&(Pv=Fc);else{var IE=Fc==16,Lv=Fc-16,TE=Q7[Lv],Mv=V(Mo,K7[Lv])+TE;if(kd+Mv>Jh)break r;for(var LE=IE?Pv:0;0<Mv--;)Cv[kd++]=LE}}Pg=1;break r}Pg||(Ev.a=3),Gh=Pg}(Gh=Gh&&!Lo.h)&&(Eg=T(SE,_E,8,Ad,kg)),Gh&&Eg!=0?Yh=Eg:(Vh.a=3,Yh=0)}if(Yh==0)break n;if(Ga&&eE[xn]==1&&(Ga=pi[Ln].g==0),Cl+=pi[Ln].g,Ln+=Yh,3>=xn){var Ed,Ig=Ks[0];for(Ed=1;Ed<es;++Ed)Ks[Ed]>Ig&&(Ig=Ks[Ed]);ps+=Ig}}if(lr.nd=Ga,lr.Qb=0,Ga&&(lr.qb=(gi[3][Yi[3]+0].value<<24|gi[1][Yi[1]+0].value<<16|gi[2][Yi[2]+0].value)>>>0,Cl==0&&256>gi[0][Yi[0]+0].value&&(lr.Qb=1,lr.qb+=gi[0][Yi[0]+0].value<<8)),lr.jc=!lr.Qb&&6>ps,lr.jc){var Zh,Ya=lr;for(Zh=0;Zh<Al;++Zh){var Ro=Zh,$o=Ya.pd[Ro],Xh=Ya.G[0][Ya.H[0]+Ro];256<=Xh.value?($o.g=Xh.g+256,$o.value=Xh.value):($o.g=0,$o.value=0,Ro>>=Et(Xh,8,$o),Ro>>=Et(Ya.G[1][Ya.H[1]+Ro],16,$o),Ro>>=Et(Ya.G[2][Ya.H[2]+Ro],0,$o),Et(Ya.G[3][Ya.H[3]+Ro],24,$o))}}}Qr.vc=Mn,Qr.Wb=Yn,Qr.Ya=mi,Qr.yc=fi,jt=1;break t}jt=0}if(!(X=jt)){z.a=3;break e}if(0<Re){if(le.ua=1<<Re,!ne(le.Wa,Re)){z.a=1,X=0;break e}}else le.ua=0;var Tg=z,Rv=K,ME=te,Lg=Tg.s,Mg=Lg.xc;if(Tg.c=Rv,Tg.i=ME,Lg.md=qe(Rv,Mg),Lg.wc=Mg==0?-1:(1<<Mg)-1,I){z.xb=dE;break e}if((je=i(K*te))==null){z.a=1,X=0;break e}X=(X=vt(z,je,0,K,te,te,null))&&!ie.h;break e}return X?(Z!=null?Z[0]=je:(t(je==null),t(I)),z.$=0,I||At(le)):At(le),X}function Gn(b,j){var I=b.c*b.i,z=I+j+16*j;return t(b.c<=j),b.V=i(z),b.V==null?(b.Ta=null,b.Ua=0,b.a=1,0):(b.Ta=b.V,b.Ua=b.Ba+I+j,1)}function Lr(b,j){var I=b.C,z=j-I,Z=b.V,X=b.Ba+b.c*I;for(t(j<=b.l.o);0<z;){var K=16<z?16:z,te=b.l.ma,ie=b.l.width,le=ie*K,je=te.ca,Re=te.tb+ie*I,ce=b.Ta,Ae=b.Ua;at(b,K,Z,X),ov(ce,Ae,je,Re,le),et(te,I,I+K,je,Re,ie),z-=K,Z+=K*b.c,I+=K}t(I==j),b.C=b.Ma=j}function nt(){this.ub=this.yd=this.td=this.Rb=0}function Qt(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function ct(){this.Fb=this.Bb=this.Cb=0,this.Zb=i(4),this.Lb=i(4)}function Bt(){this.Yb=function(){var b=[];return function j(I,z,Z){for(var X=Z[z],K=0;K<X&&(I.push(Z.length>z+1?[]:0),!(Z.length<z+1));K++)j(I[K],z+1,Z)}(b,0,[3,11]),b}()}function an(){this.jb=i(3),this.Wc=o([4,8],Bt),this.Xc=o([4,17],Bt)}function en(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new i(4),this.od=new i(4)}function mt(){this.ld=this.La=this.dd=this.tc=0}function Ft(){this.Na=this.la=0}function on(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function rn(){this.ad=i(384),this.Za=0,this.Ob=i(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function Cn(){this.uc=this.M=this.Nb=0,this.wa=Array(new mt),this.Y=0,this.ya=Array(new rn),this.aa=0,this.l=new mn}function bn(){this.y=i(16),this.f=i(8),this.ea=i(8)}function _n(){this.cb=this.a=0,this.sc="",this.m=new R,this.Od=new nt,this.Kc=new Qt,this.ed=new en,this.Qa=new ct,this.Ic=this.$c=this.Aa=0,this.D=new Cn,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=l(8,R),this.ia=0,this.pb=l(4,on),this.Pa=new an,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new bn),this.Hd=0,this.rb=Array(new Ft),this.sb=0,this.wa=Array(new mt),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new rn),this.L=this.aa=0,this.gd=o([4,2],mt),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function mn(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function Bn(){var b=new _n;return b!=null&&(b.a=0,b.sc="OK",b.cb=0,b.Xb=0,Sd||(Sd=ar)),b}function Hn(b,j,I){return b.a==0&&(b.a=j,b.sc=I,b.cb=0),0}function hr(b,j,I){return 3<=I&&b[j+0]==157&&b[j+1]==1&&b[j+2]==42}function Jr(b,j){if(b==null)return 0;if(b.a=0,b.sc="OK",j==null)return Hn(b,2,"null VP8Io passed to VP8GetHeaders()");var I=j.data,z=j.w,Z=j.ha;if(4>Z)return Hn(b,7,"Truncated header.");var X=I[z+0]|I[z+1]<<8|I[z+2]<<16,K=b.Od;if(K.Rb=!(1&X),K.td=X>>1&7,K.yd=X>>4&1,K.ub=X>>5,3<K.td)return Hn(b,3,"Incorrect keyframe parameters.");if(!K.yd)return Hn(b,4,"Frame not displayable.");z+=3,Z-=3;var te=b.Kc;if(K.Rb){if(7>Z)return Hn(b,7,"cannot parse picture header");if(!hr(I,z,Z))return Hn(b,3,"Bad code word");te.c=16383&(I[z+4]<<8|I[z+3]),te.Td=I[z+4]>>6,te.i=16383&(I[z+6]<<8|I[z+5]),te.Ud=I[z+6]>>6,z+=7,Z-=7,b.za=te.c+15>>4,b.Ub=te.i+15>>4,j.width=te.c,j.height=te.i,j.Da=0,j.j=0,j.v=0,j.va=j.width,j.o=j.height,j.da=0,j.ib=j.width,j.hb=j.height,j.U=j.width,j.T=j.height,s((X=b.Pa).jb,0,255,X.jb.length),t((X=b.Qa)!=null),X.Cb=0,X.Bb=0,X.Fb=1,s(X.Zb,0,0,X.Zb.length),s(X.Lb,0,0,X.Lb)}if(K.ub>Z)return Hn(b,7,"bad partition length");L(X=b.m,I,z,K.ub),z+=K.ub,Z-=K.ub,K.Rb&&(te.Ld=Q(X),te.Kd=Q(X)),te=b.Qa;var ie,le=b.Pa;if(t(X!=null),t(te!=null),te.Cb=Q(X),te.Cb){if(te.Bb=Q(X),Q(X)){for(te.Fb=Q(X),ie=0;4>ie;++ie)te.Zb[ie]=Q(X)?W(X,7):0;for(ie=0;4>ie;++ie)te.Lb[ie]=Q(X)?W(X,6):0}if(te.Bb)for(ie=0;3>ie;++ie)le.jb[ie]=Q(X)?O(X,8):255}else te.Bb=0;if(X.Ka)return Hn(b,3,"cannot parse segment header");if((te=b.ed).zd=Q(X),te.Tb=O(X,6),te.wb=O(X,3),te.Pc=Q(X),te.Pc&&Q(X)){for(le=0;4>le;++le)Q(X)&&(te.vd[le]=W(X,6));for(le=0;4>le;++le)Q(X)&&(te.od[le]=W(X,6))}if(b.L=te.Tb==0?0:te.zd?1:2,X.Ka)return Hn(b,3,"cannot parse filter header");var je=Z;if(Z=ie=z,z=ie+je,te=je,b.Xb=(1<<O(b.m,2))-1,je<3*(le=b.Xb))I=7;else{for(ie+=3*le,te-=3*le,je=0;je<le;++je){var Re=I[Z+0]|I[Z+1]<<8|I[Z+2]<<16;Re>te&&(Re=te),L(b.Jc[+je],I,ie,Re),ie+=Re,te-=Re,Z+=3}L(b.Jc[+le],I,ie,te),I=ie<z?0:5}if(I!=0)return Hn(b,I,"cannot parse partitions");for(I=O(ie=b.m,7),Z=Q(ie)?W(ie,4):0,z=Q(ie)?W(ie,4):0,te=Q(ie)?W(ie,4):0,le=Q(ie)?W(ie,4):0,ie=Q(ie)?W(ie,4):0,je=b.Qa,Re=0;4>Re;++Re){if(je.Cb){var ce=je.Zb[Re];je.Fb||(ce+=I)}else{if(0<Re){b.pb[Re]=b.pb[0];continue}ce=I}var Ae=b.pb[Re];Ae.Sc[0]=Sg[jr(ce+Z,127)],Ae.Sc[1]=_g[jr(ce+0,127)],Ae.Eb[0]=2*Sg[jr(ce+z,127)],Ae.Eb[1]=101581*_g[jr(ce+te,127)]>>16,8>Ae.Eb[1]&&(Ae.Eb[1]=8),Ae.Qc[0]=Sg[jr(ce+le,117)],Ae.Qc[1]=_g[jr(ce+ie,127)],Ae.lc=ce+ie}if(!K.Rb)return Hn(b,4,"Not a key frame.");for(Q(X),K=b.Pa,I=0;4>I;++I){for(Z=0;8>Z;++Z)for(z=0;3>z;++z)for(te=0;11>te;++te)le=fe(X,cE[I][Z][z][te])?O(X,8):oE[I][Z][z][te],K.Wc[I][Z].Yb[z][te]=le;for(Z=0;17>Z;++Z)K.Xc[I][Z]=K.Wc[I][uE[Z]]}return b.kc=Q(X),b.kc&&(b.Bd=O(X,8)),b.cb=1}function ar(b,j,I,z,Z,X,K){var te=j[Z].Yb[I];for(I=0;16>Z;++Z){if(!fe(b,te[I+0]))return Z;for(;!fe(b,te[I+1]);)if(te=j[++Z].Yb[0],I=0,Z==16)return 16;var ie=j[Z+1].Yb;if(fe(b,te[I+2])){var le=b,je=0;if(fe(le,(ce=te)[(Re=I)+3]))if(fe(le,ce[Re+6])){for(te=0,Re=2*(je=fe(le,ce[Re+8]))+(ce=fe(le,ce[Re+9+je])),je=0,ce=iE[Re];ce[te];++te)je+=je+fe(le,ce[te]);je+=3+(8<<Re)}else fe(le,ce[Re+7])?(je=7+2*fe(le,165),je+=fe(le,145)):je=5+fe(le,159);else je=fe(le,ce[Re+4])?3+fe(le,ce[Re+5]):2;te=ie[2]}else je=1,te=ie[1];ie=K+aE[Z],0>(le=b).b&&re(le);var Re,ce=le.b,Ae=(Re=le.Ca>>1)-(le.I>>ce)>>31;--le.b,le.Ca+=Ae,le.Ca|=1,le.I-=(Re+1&Ae)<<ce,X[ie]=((je^Ae)-Ae)*z[(0<Z)+0]}return 16}function Rn(b){var j=b.rb[b.sb-1];j.la=0,j.Na=0,s(b.zc,0,0,b.zc.length),b.ja=0}function mr(b,j,I,z,Z){Z=b[j+I+32*z]+(Z>>3),b[j+I+32*z]=-256&Z?0>Z?0:255:Z}function Nr(b,j,I,z,Z,X){mr(b,j,0,I,z+Z),mr(b,j,1,I,z+X),mr(b,j,2,I,z-X),mr(b,j,3,I,z-Z)}function Wn(b){return(20091*b>>16)+b}function vo(b,j,I,z){var Z,X=0,K=i(16);for(Z=0;4>Z;++Z){var te=b[j+0]+b[j+8],ie=b[j+0]-b[j+8],le=(35468*b[j+4]>>16)-Wn(b[j+12]),je=Wn(b[j+4])+(35468*b[j+12]>>16);K[X+0]=te+je,K[X+1]=ie+le,K[X+2]=ie-le,K[X+3]=te-je,X+=4,j++}for(Z=X=0;4>Z;++Z)te=(b=K[X+0]+4)+K[X+8],ie=b-K[X+8],le=(35468*K[X+4]>>16)-Wn(K[X+12]),mr(I,z,0,0,te+(je=Wn(K[X+4])+(35468*K[X+12]>>16))),mr(I,z,1,0,ie+le),mr(I,z,2,0,ie-le),mr(I,z,3,0,te-je),X++,z+=32}function vc(b,j,I,z){var Z=b[j+0]+4,X=35468*b[j+4]>>16,K=Wn(b[j+4]),te=35468*b[j+1]>>16;Nr(I,z,0,Z+K,b=Wn(b[j+1]),te),Nr(I,z,1,Z+X,b,te),Nr(I,z,2,Z-X,b,te),Nr(I,z,3,Z-K,b,te)}function wc(b,j,I,z,Z){vo(b,j,I,z),Z&&vo(b,j+16,I,z+4)}function Nc(b,j,I,z){El(b,j+0,I,z,1),El(b,j+32,I,z+128,1)}function li(b,j,I,z){var Z;for(b=b[j+0]+4,Z=0;4>Z;++Z)for(j=0;4>j;++j)mr(I,z,j,Z,b)}function fl(b,j,I,z){b[j+0]&&Vn(b,j+0,I,z),b[j+16]&&Vn(b,j+16,I,z+4),b[j+32]&&Vn(b,j+32,I,z+128),b[j+48]&&Vn(b,j+48,I,z+128+4)}function hl(b,j,I,z){var Z,X=i(16);for(Z=0;4>Z;++Z){var K=b[j+0+Z]+b[j+12+Z],te=b[j+4+Z]+b[j+8+Z],ie=b[j+4+Z]-b[j+8+Z],le=b[j+0+Z]-b[j+12+Z];X[0+Z]=K+te,X[8+Z]=K-te,X[4+Z]=le+ie,X[12+Z]=le-ie}for(Z=0;4>Z;++Z)K=(b=X[0+4*Z]+3)+X[3+4*Z],te=X[1+4*Z]+X[2+4*Z],ie=X[1+4*Z]-X[2+4*Z],le=b-X[3+4*Z],I[z+0]=K+te>>3,I[z+16]=le+ie>>3,I[z+32]=K-te>>3,I[z+48]=le-ie>>3,z+=64}function Hi(b,j,I){var z,Z=j-32,X=di,K=255-b[Z-1];for(z=0;z<I;++z){var te,ie=X,le=K+b[j-1];for(te=0;te<I;++te)b[j+te]=ie[le+b[Z+te]];j+=32}}function wo(b,j){Hi(b,j,4)}function jc(b,j){Hi(b,j,8)}function Sc(b,j){Hi(b,j,16)}function _c(b,j){var I;for(I=0;16>I;++I)r(b,j+32*I,b,j-32,16)}function No(b,j){var I;for(I=16;0<I;--I)s(b,j,b[j-1],16),j+=32}function fa(b,j,I){var z;for(z=0;16>z;++z)s(j,I+32*z,b,16)}function Wi(b,j){var I,z=16;for(I=0;16>I;++I)z+=b[j-1+32*I]+b[j+I-32];fa(z>>5,b,j)}function Ac(b,j){var I,z=8;for(I=0;16>I;++I)z+=b[j-1+32*I];fa(z>>4,b,j)}function Ge(b,j){var I,z=8;for(I=0;16>I;++I)z+=b[j+I-32];fa(z>>4,b,j)}function Ke(b,j){fa(128,b,j)}function tn(b,j,I){return b+2*j+I+2>>2}function kc(b,j){var I,z=j-32;for(z=new Uint8Array([tn(b[z-1],b[z+0],b[z+1]),tn(b[z+0],b[z+1],b[z+2]),tn(b[z+1],b[z+2],b[z+3]),tn(b[z+2],b[z+3],b[z+4])]),I=0;4>I;++I)r(b,j+32*I,z,0,z.length)}function od(b,j){var I=b[j-1],z=b[j-1+32],Z=b[j-1+64],X=b[j-1+96];Se(b,j+0,16843009*tn(b[j-1-32],I,z)),Se(b,j+32,16843009*tn(I,z,Z)),Se(b,j+64,16843009*tn(z,Z,X)),Se(b,j+96,16843009*tn(Z,X,X))}function Ec(b,j){var I,z=4;for(I=0;4>I;++I)z+=b[j+I-32]+b[j-1+32*I];for(z>>=3,I=0;4>I;++I)s(b,j+32*I,z,4)}function pg(b,j){var I=b[j-1+0],z=b[j-1+32],Z=b[j-1+64],X=b[j-1-32],K=b[j+0-32],te=b[j+1-32],ie=b[j+2-32],le=b[j+3-32];b[j+0+96]=tn(z,Z,b[j-1+96]),b[j+1+96]=b[j+0+64]=tn(I,z,Z),b[j+2+96]=b[j+1+64]=b[j+0+32]=tn(X,I,z),b[j+3+96]=b[j+2+64]=b[j+1+32]=b[j+0+0]=tn(K,X,I),b[j+3+64]=b[j+2+32]=b[j+1+0]=tn(te,K,X),b[j+3+32]=b[j+2+0]=tn(ie,te,K),b[j+3+0]=tn(le,ie,te)}function Da(b,j){var I=b[j+1-32],z=b[j+2-32],Z=b[j+3-32],X=b[j+4-32],K=b[j+5-32],te=b[j+6-32],ie=b[j+7-32];b[j+0+0]=tn(b[j+0-32],I,z),b[j+1+0]=b[j+0+32]=tn(I,z,Z),b[j+2+0]=b[j+1+32]=b[j+0+64]=tn(z,Z,X),b[j+3+0]=b[j+2+32]=b[j+1+64]=b[j+0+96]=tn(Z,X,K),b[j+3+32]=b[j+2+64]=b[j+1+96]=tn(X,K,te),b[j+3+64]=b[j+2+96]=tn(K,te,ie),b[j+3+96]=tn(te,ie,ie)}function Ba(b,j){var I=b[j-1+0],z=b[j-1+32],Z=b[j-1+64],X=b[j-1-32],K=b[j+0-32],te=b[j+1-32],ie=b[j+2-32],le=b[j+3-32];b[j+0+0]=b[j+1+64]=X+K+1>>1,b[j+1+0]=b[j+2+64]=K+te+1>>1,b[j+2+0]=b[j+3+64]=te+ie+1>>1,b[j+3+0]=ie+le+1>>1,b[j+0+96]=tn(Z,z,I),b[j+0+64]=tn(z,I,X),b[j+0+32]=b[j+1+96]=tn(I,X,K),b[j+1+32]=b[j+2+96]=tn(X,K,te),b[j+2+32]=b[j+3+96]=tn(K,te,ie),b[j+3+32]=tn(te,ie,le)}function gg(b,j){var I=b[j+0-32],z=b[j+1-32],Z=b[j+2-32],X=b[j+3-32],K=b[j+4-32],te=b[j+5-32],ie=b[j+6-32],le=b[j+7-32];b[j+0+0]=I+z+1>>1,b[j+1+0]=b[j+0+64]=z+Z+1>>1,b[j+2+0]=b[j+1+64]=Z+X+1>>1,b[j+3+0]=b[j+2+64]=X+K+1>>1,b[j+0+32]=tn(I,z,Z),b[j+1+32]=b[j+0+96]=tn(z,Z,X),b[j+2+32]=b[j+1+96]=tn(Z,X,K),b[j+3+32]=b[j+2+96]=tn(X,K,te),b[j+3+64]=tn(K,te,ie),b[j+3+96]=tn(te,ie,le)}function xg(b,j){var I=b[j-1+0],z=b[j-1+32],Z=b[j-1+64],X=b[j-1+96];b[j+0+0]=I+z+1>>1,b[j+2+0]=b[j+0+32]=z+Z+1>>1,b[j+2+32]=b[j+0+64]=Z+X+1>>1,b[j+1+0]=tn(I,z,Z),b[j+3+0]=b[j+1+32]=tn(z,Z,X),b[j+3+32]=b[j+1+64]=tn(Z,X,X),b[j+3+64]=b[j+2+64]=b[j+0+96]=b[j+1+96]=b[j+2+96]=b[j+3+96]=X}function Cc(b,j){var I=b[j-1+0],z=b[j-1+32],Z=b[j-1+64],X=b[j-1+96],K=b[j-1-32],te=b[j+0-32],ie=b[j+1-32],le=b[j+2-32];b[j+0+0]=b[j+2+32]=I+K+1>>1,b[j+0+32]=b[j+2+64]=z+I+1>>1,b[j+0+64]=b[j+2+96]=Z+z+1>>1,b[j+0+96]=X+Z+1>>1,b[j+3+0]=tn(te,ie,le),b[j+2+0]=tn(K,te,ie),b[j+1+0]=b[j+3+32]=tn(I,K,te),b[j+1+32]=b[j+3+64]=tn(z,I,K),b[j+1+64]=b[j+3+96]=tn(Z,z,I),b[j+1+96]=tn(X,Z,z)}function ld(b,j){var I;for(I=0;8>I;++I)r(b,j+32*I,b,j-32,8)}function ml(b,j){var I;for(I=0;8>I;++I)s(b,j,b[j-1],8),j+=32}function Pc(b,j,I){var z;for(z=0;8>z;++z)s(j,I+32*z,b,8)}function Ic(b,j){var I,z=8;for(I=0;8>I;++I)z+=b[j+I-32]+b[j-1+32*I];Pc(z>>4,b,j)}function yg(b,j){var I,z=4;for(I=0;8>I;++I)z+=b[j+I-32];Pc(z>>3,b,j)}function cd(b,j){var I,z=4;for(I=0;8>I;++I)z+=b[j-1+32*I];Pc(z>>3,b,j)}function ud(b,j){Pc(128,b,j)}function pl(b,j,I){var z=b[j-I],Z=b[j+0],X=3*(Z-z)+bg[1020+b[j-2*I]-b[j+I]],K=$h[112+(X+4>>3)];b[j-I]=di[255+z+$h[112+(X+3>>3)]],b[j+0]=di[255+Z-K]}function gl(b,j,I,z){var Z=b[j+0],X=b[j+I];return Pi[255+b[j-2*I]-b[j-I]]>z||Pi[255+X-Z]>z}function dd(b,j,I,z){return 4*Pi[255+b[j-I]-b[j+0]]+Pi[255+b[j-2*I]-b[j+I]]<=z}function Tc(b,j,I,z,Z){var X=b[j-3*I],K=b[j-2*I],te=b[j-I],ie=b[j+0],le=b[j+I],je=b[j+2*I],Re=b[j+3*I];return 4*Pi[255+te-ie]+Pi[255+K-le]>z?0:Pi[255+b[j-4*I]-X]<=Z&&Pi[255+X-K]<=Z&&Pi[255+K-te]<=Z&&Pi[255+Re-je]<=Z&&Pi[255+je-le]<=Z&&Pi[255+le-ie]<=Z}function fd(b,j,I,z){var Z=2*z+1;for(z=0;16>z;++z)dd(b,j+z,I,Z)&&pl(b,j+z,I)}function xl(b,j,I,z){var Z=2*z+1;for(z=0;16>z;++z)dd(b,j+z*I,1,Z)&&pl(b,j+z*I,1)}function kh(b,j,I,z){var Z;for(Z=3;0<Z;--Z)fd(b,j+=4*I,I,z)}function Eh(b,j,I,z){var Z;for(Z=3;0<Z;--Z)xl(b,j+=4,I,z)}function za(b,j,I,z,Z,X,K,te){for(X=2*X+1;0<Z--;){if(Tc(b,j,I,X,K))if(gl(b,j,I,te))pl(b,j,I);else{var ie=b,le=j,je=I,Re=ie[le-2*je],ce=ie[le-je],Ae=ie[le+0],Pe=ie[le+je],We=ie[le+2*je],Me=27*(Xe=bg[1020+3*(Ae-ce)+bg[1020+Re-Pe]])+63>>7,Ve=18*Xe+63>>7,Xe=9*Xe+63>>7;ie[le-3*je]=di[255+ie[le-3*je]+Xe],ie[le-2*je]=di[255+Re+Ve],ie[le-je]=di[255+ce+Me],ie[le+0]=di[255+Ae-Me],ie[le+je]=di[255+Pe-Ve],ie[le+2*je]=di[255+We-Xe]}j+=z}}function Ua(b,j,I,z,Z,X,K,te){for(X=2*X+1;0<Z--;){if(Tc(b,j,I,X,K))if(gl(b,j,I,te))pl(b,j,I);else{var ie=b,le=j,je=I,Re=ie[le-je],ce=ie[le+0],Ae=ie[le+je],Pe=$h[112+(4+(We=3*(ce-Re))>>3)],We=$h[112+(We+3>>3)],Me=Pe+1>>1;ie[le-2*je]=di[255+ie[le-2*je]+Me],ie[le-je]=di[255+Re+We],ie[le+0]=di[255+ce-Pe],ie[le+je]=di[255+Ae-Me]}j+=z}}function Ch(b,j,I,z,Z,X){za(b,j,I,1,16,z,Z,X)}function Ph(b,j,I,z,Z,X){za(b,j,1,I,16,z,Z,X)}function yl(b,j,I,z,Z,X){var K;for(K=3;0<K;--K)Ua(b,j+=4*I,I,1,16,z,Z,X)}function Ih(b,j,I,z,Z,X){var K;for(K=3;0<K;--K)Ua(b,j+=4,1,I,16,z,Z,X)}function k(b,j,I,z,Z,X,K,te){za(b,j,Z,1,8,X,K,te),za(I,z,Z,1,8,X,K,te)}function J(b,j,I,z,Z,X,K,te){za(b,j,1,Z,8,X,K,te),za(I,z,1,Z,8,X,K,te)}function ue(b,j,I,z,Z,X,K,te){Ua(b,j+4*Z,Z,1,8,X,K,te),Ua(I,z+4*Z,Z,1,8,X,K,te)}function ve(b,j,I,z,Z,X,K,te){Ua(b,j+4,1,Z,8,X,K,te),Ua(I,z+4,1,Z,8,X,K,te)}function Ce(){this.ba=new wt,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Vt,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function Ye(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function st(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function Ot(){this.ua=0,this.Wa=new $e,this.vb=new $e,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new D,this.yc=new B}function Yt(){this.xb=this.a=0,this.l=new mn,this.ca=new wt,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new q,this.Pb=0,this.wd=new q,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new Ot,this.ab=0,this.gc=l(4,st),this.Oc=0}function hn(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new mn,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function pn(b,j,I,z,Z,X,K){for(b=b==null?0:b[j+0],j=0;j<K;++j)Z[X+j]=b+I[z+j]&255,b=Z[X+j]}function zn(b,j,I,z,Z,X,K){var te;if(b==null)pn(null,null,I,z,Z,X,K);else for(te=0;te<K;++te)Z[X+te]=b[j+te]+I[z+te]&255}function xr(b,j,I,z,Z,X,K){if(b==null)pn(null,null,I,z,Z,X,K);else{var te,ie=b[j+0],le=ie,je=ie;for(te=0;te<K;++te)le=je+(ie=b[j+te])-le,je=I[z+te]+(-256&le?0>le?0:255:le)&255,le=ie,Z[X+te]=je}}function qr(b,j,I,z){var Z=j.width,X=j.o;if(t(b!=null&&j!=null),0>I||0>=z||I+z>X)return null;if(!b.Cc){if(b.ga==null){var K;if(b.ga=new hn,(K=b.ga==null)||(K=j.width*j.o,t(b.Gb.length==0),b.Gb=i(K),b.Uc=0,b.Gb==null?K=0:(b.mb=b.Gb,b.nb=b.Uc,b.rc=null,K=1),K=!K),!K){K=b.ga;var te=b.Fa,ie=b.P,le=b.qc,je=b.mb,Re=b.nb,ce=ie+1,Ae=le-1,Pe=K.l;if(t(te!=null&&je!=null&&j!=null),To[0]=null,To[1]=pn,To[2]=zn,To[3]=xr,K.ca=je,K.tb=Re,K.c=j.width,K.i=j.height,t(0<K.c&&0<K.i),1>=le)j=0;else if(K.$a=3&te[ie+0],K.Z=te[ie+0]>>2&3,K.Lc=te[ie+0]>>4&3,ie=te[ie+0]>>6&3,0>K.$a||1<K.$a||4<=K.Z||1<K.Lc||ie)j=0;else if(Pe.put=Fe,Pe.ac=lt,Pe.bc=Dt,Pe.ma=K,Pe.width=j.width,Pe.height=j.height,Pe.Da=j.Da,Pe.v=j.v,Pe.va=j.va,Pe.j=j.j,Pe.o=j.o,K.$a)e:{t(K.$a==1),j=Ct();t:for(;;){if(j==null){j=0;break e}if(t(K!=null),K.mc=j,j.c=K.c,j.i=K.i,j.l=K.l,j.l.ma=K,j.l.width=K.c,j.l.height=K.i,j.a=0,E(j.m,te,ce,Ae),!Lt(K.c,K.i,1,j,null)||(j.ab==1&&j.gc[0].hc==3&&Ee(j.s)?(K.ic=1,te=j.c*j.i,j.Ta=null,j.Ua=0,j.V=i(te),j.Ba=0,j.V==null?(j.a=1,j=0):j=1):(K.ic=0,j=Gn(j,K.c)),!j))break t;j=1;break e}K.mc=null,j=0}else j=Ae>=K.c*K.i;K=!j}if(K)return null;b.ga.Lc!=1?b.Ga=0:z=X-I}t(b.ga!=null),t(I+z<=X);e:{if(j=(te=b.ga).c,X=te.l.o,te.$a==0){if(ce=b.rc,Ae=b.Vc,Pe=b.Fa,ie=b.P+1+I*j,le=b.mb,je=b.nb+I*j,t(ie<=b.P+b.qc),te.Z!=0)for(t(To[te.Z]!=null),K=0;K<z;++K)To[te.Z](ce,Ae,Pe,ie,le,je,j),ce=le,Ae=je,je+=j,ie+=j;else for(K=0;K<z;++K)r(le,je,Pe,ie,j),ce=le,Ae=je,je+=j,ie+=j;b.rc=ce,b.Vc=Ae}else{if(t(te.mc!=null),j=I+z,t((K=te.mc)!=null),t(j<=K.i),K.C>=j)j=1;else if(te.ic||ki(),te.ic){te=K.V,ce=K.Ba,Ae=K.c;var We=K.i,Me=(Pe=1,ie=K.$/Ae,le=K.$%Ae,je=K.m,Re=K.s,K.$),Ve=Ae*We,Xe=Ae*j,dt=Re.wc,rt=Me<Xe?ft(Re,le,ie):null;t(Me<=Ve),t(j<=We),t(Ee(Re));t:for(;;){for(;!je.h&&Me<Xe;){if(le&dt||(rt=ft(Re,le,ie)),t(rt!=null),ae(je),256>(We=_t(rt.G[0],rt.H[0],je)))te[ce+Me]=We,++Me,++le>=Ae&&(le=0,++ie<=j&&!(ie%16)&&kt(K,ie));else{if(!(280>We)){Pe=0;break t}We=Ht(We-256,je);var Jt,Mt=_t(rt.G[4],rt.H[4],je);if(ae(je),!(Me>=(Mt=ot(Ae,Mt=Ht(Mt,je)))&&Ve-Me>=We)){Pe=0;break t}for(Jt=0;Jt<We;++Jt)te[ce+Me+Jt]=te[ce+Me+Jt-Mt];for(Me+=We,le+=We;le>=Ae;)le-=Ae,++ie<=j&&!(ie%16)&&kt(K,ie);Me<Xe&&le&dt&&(rt=ft(Re,le,ie))}t(je.h==G(je))}kt(K,ie>j?j:ie);break t}!Pe||je.h&&Me<Ve?(Pe=0,K.a=je.h?5:3):K.$=Me,j=Pe}else j=vt(K,K.V,K.Ba,K.c,K.i,j,Lr);if(!j){z=0;break e}}I+z>=X&&(b.Cc=1),z=1}if(!z)return null;if(b.Cc&&((z=b.ga)!=null&&(z.mc=null),b.ga=null,0<b.Ga))return alert("todo:WebPDequantizeLevels"),null}return b.nb+I*Z}function or(b,j,I,z,Z,X){for(;0<Z--;){var K,te=b,ie=j+(I?1:0),le=b,je=j+(I?0:3);for(K=0;K<z;++K){var Re=le[je+4*K];Re!=255&&(Re*=32897,te[ie+4*K+0]=te[ie+4*K+0]*Re>>23,te[ie+4*K+1]=te[ie+4*K+1]*Re>>23,te[ie+4*K+2]=te[ie+4*K+2]*Re>>23)}j+=X}}function Zr(b,j,I,z,Z){for(;0<z--;){var X;for(X=0;X<I;++X){var K=b[j+2*X+0],te=15&(le=b[j+2*X+1]),ie=4369*te,le=(240&le|le>>4)*ie>>16;b[j+2*X+0]=(240&K|K>>4)*ie>>16&240|(15&K|K<<4)*ie>>16>>4&15,b[j+2*X+1]=240&le|te}j+=Z}}function Hr(b,j,I,z,Z,X,K,te){var ie,le,je=255;for(le=0;le<Z;++le){for(ie=0;ie<z;++ie){var Re=b[j+ie];X[K+4*ie]=Re,je&=Re}j+=I,K+=te}return je!=255}function fs(b,j,I,z,Z){var X;for(X=0;X<Z;++X)I[z+X]=b[j+X]>>8}function ki(){jd=or,iv=Zr,av=Hr,ov=fs}function Zs(b,j,I){S[b]=function(z,Z,X,K,te,ie,le,je,Re,ce,Ae,Pe,We,Me,Ve,Xe,dt){var rt,Jt=dt-1>>1,Mt=te[ie+0]|le[je+0]<<16,wn=Re[ce+0]|Ae[Pe+0]<<16;t(z!=null);var Ut=3*Mt+wn+131074>>2;for(j(z[Z+0],255&Ut,Ut>>16,We,Me),X!=null&&(Ut=3*wn+Mt+131074>>2,j(X[K+0],255&Ut,Ut>>16,Ve,Xe)),rt=1;rt<=Jt;++rt){var Pn=te[ie+rt]|le[je+rt]<<16,Kr=Re[ce+rt]|Ae[Pe+rt]<<16,Nn=Mt+Pn+wn+Kr+524296,qt=Nn+2*(Pn+wn)>>3;Ut=qt+Mt>>1,Mt=(Nn=Nn+2*(Mt+Kr)>>3)+Pn>>1,j(z[Z+2*rt-1],255&Ut,Ut>>16,We,Me+(2*rt-1)*I),j(z[Z+2*rt-0],255&Mt,Mt>>16,We,Me+(2*rt-0)*I),X!=null&&(Ut=Nn+wn>>1,Mt=qt+Kr>>1,j(X[K+2*rt-1],255&Ut,Ut>>16,Ve,Xe+(2*rt-1)*I),j(X[K+2*rt+0],255&Mt,Mt>>16,Ve,Xe+(2*rt+0)*I)),Mt=Pn,wn=Kr}1&dt||(Ut=3*Mt+wn+131074>>2,j(z[Z+dt-1],255&Ut,Ut>>16,We,Me+(dt-1)*I),X!=null&&(Ut=3*wn+Mt+131074>>2,j(X[K+dt-1],255&Ut,Ut>>16,Ve,Xe+(dt-1)*I)))}}function Th(){Ii[Fh]=fE,Ii[Oh]=yv,Ii[hv]=hE,Ii[Dh]=bv,Ii[Bh]=vv,Ii[vg]=wv,Ii[mv]=mE,Ii[wg]=yv,Ii[Ng]=bv,Ii[zh]=vv,Ii[jg]=wv}function Lc(b){return b&-16384?0>b?0:255:b>>pE}function bl(b,j){return Lc((19077*b>>8)+(26149*j>>8)-14234)}function jo(b,j,I){return Lc((19077*b>>8)-(6419*j>>8)-(13320*I>>8)+8708)}function vl(b,j){return Lc((19077*b>>8)+(33050*j>>8)-17685)}function wl(b,j,I,z,Z){z[Z+0]=bl(b,I),z[Z+1]=jo(b,j,I),z[Z+2]=vl(b,j)}function Nl(b,j,I,z,Z){z[Z+0]=vl(b,j),z[Z+1]=jo(b,j,I),z[Z+2]=bl(b,I)}function Ns(b,j,I,z,Z){var X=jo(b,j,I);j=X<<3&224|vl(b,j)>>3,z[Z+0]=248&bl(b,I)|X>>5,z[Z+1]=j}function jl(b,j,I,z,Z){var X=240&vl(b,j)|15;z[Z+0]=240&bl(b,I)|jo(b,j,I)>>4,z[Z+1]=X}function Sl(b,j,I,z,Z){z[Z+0]=255,wl(b,j,I,z,Z+1)}function hd(b,j,I,z,Z){Nl(b,j,I,z,Z),z[Z+3]=255}function md(b,j,I,z,Z){wl(b,j,I,z,Z),z[Z+3]=255}function jr(b,j){return 0>b?0:b>j?j:b}function qa(b,j,I){S[b]=function(z,Z,X,K,te,ie,le,je,Re){for(var ce=je+(-2&Re)*I;je!=ce;)j(z[Z+0],X[K+0],te[ie+0],le,je),j(z[Z+1],X[K+0],te[ie+0],le,je+I),Z+=2,++K,++ie,je+=2*I;1&Re&&j(z[Z+0],X[K+0],te[ie+0],le,je)}}function Mc(b,j,I){return I==0?b==0?j==0?6:5:j==0?4:0:I}function Lh(b,j,I,z,Z){switch(b>>>30){case 3:El(j,I,z,Z,0);break;case 2:Ci(j,I,z,Z);break;case 1:Vn(j,I,z,Z)}}function Ei(b,j){var I,z,Z=j.M,X=j.Nb,K=b.oc,te=b.pc+40,ie=b.oc,le=b.pc+584,je=b.oc,Re=b.pc+600;for(I=0;16>I;++I)K[te+32*I-1]=129;for(I=0;8>I;++I)ie[le+32*I-1]=129,je[Re+32*I-1]=129;for(0<Z?K[te-1-32]=ie[le-1-32]=je[Re-1-32]=129:(s(K,te-32-1,127,21),s(ie,le-32-1,127,9),s(je,Re-32-1,127,9)),z=0;z<b.za;++z){var ce=j.ya[j.aa+z];if(0<z){for(I=-1;16>I;++I)r(K,te+32*I-4,K,te+32*I+12,4);for(I=-1;8>I;++I)r(ie,le+32*I-4,ie,le+32*I+4,4),r(je,Re+32*I-4,je,Re+32*I+4,4)}var Ae=b.Gd,Pe=b.Hd+z,We=ce.ad,Me=ce.Hc;if(0<Z&&(r(K,te-32,Ae[Pe].y,0,16),r(ie,le-32,Ae[Pe].f,0,8),r(je,Re-32,Ae[Pe].ea,0,8)),ce.Za){var Ve=K,Xe=te-32+16;for(0<Z&&(z>=b.za-1?s(Ve,Xe,Ae[Pe].y[15],4):r(Ve,Xe,Ae[Pe+1].y,0,4)),I=0;4>I;I++)Ve[Xe+128+I]=Ve[Xe+256+I]=Ve[Xe+384+I]=Ve[Xe+0+I];for(I=0;16>I;++I,Me<<=2)Ve=K,Xe=te+jv[I],Vi[ce.Ob[I]](Ve,Xe),Lh(Me,We,16*+I,Ve,Xe)}else if(Ve=Mc(z,Z,ce.Ob[0]),Io[Ve](K,te),Me!=0)for(I=0;16>I;++I,Me<<=2)Lh(Me,We,16*+I,K,te+jv[I]);for(I=ce.Gc,Ve=Mc(z,Z,ce.Dd),Va[Ve](ie,le),Va[Ve](je,Re),Me=We,Ve=ie,Xe=le,255&(ce=0|I)&&(170&ce?pa(Me,256,Ve,Xe):tr(Me,256,Ve,Xe)),ce=je,Me=Re,255&(I>>=8)&&(170&I?pa(We,320,ce,Me):tr(We,320,ce,Me)),Z<b.Ub-1&&(r(Ae[Pe].y,0,K,te+480,16),r(Ae[Pe].f,0,ie,le+224,8),r(Ae[Pe].ea,0,je,Re+224,8)),I=8*X*b.B,Ae=b.sa,Pe=b.ta+16*z+16*X*b.R,We=b.qa,ce=b.ra+8*z+I,Me=b.Ha,Ve=b.Ia+8*z+I,I=0;16>I;++I)r(Ae,Pe+I*b.R,K,te+32*I,16);for(I=0;8>I;++I)r(We,ce+I*b.B,ie,le+32*I,8),r(Me,Ve+I*b.B,je,Re+32*I,8)}}function _l(b,j,I,z,Z,X,K,te,ie){var le=[0],je=[0],Re=0,ce=ie!=null?ie.kd:0,Ae=ie??new Ye;if(b==null||12>I)return 7;Ae.data=b,Ae.w=j,Ae.ha=I,j=[j],I=[I],Ae.gb=[Ae.gb];e:{var Pe=j,We=I,Me=Ae.gb;if(t(b!=null),t(We!=null),t(Me!=null),Me[0]=0,12<=We[0]&&!n(b,Pe[0],"RIFF")){if(n(b,Pe[0]+8,"WEBP")){Me=3;break e}var Ve=me(b,Pe[0]+4);if(12>Ve||4294967286<Ve){Me=3;break e}if(ce&&Ve>We[0]-8){Me=7;break e}Me[0]=Ve,Pe[0]+=12,We[0]-=12}Me=0}if(Me!=0)return Me;for(Ve=0<Ae.gb[0],I=I[0];;){e:{var Xe=b;We=j,Me=I;var dt=le,rt=je,Jt=Pe=[0];if((Ut=Re=[Re])[0]=0,8>Me[0])Me=7;else{if(!n(Xe,We[0],"VP8X")){if(me(Xe,We[0]+4)!=10){Me=3;break e}if(18>Me[0]){Me=7;break e}var Mt=me(Xe,We[0]+8),wn=1+pe(Xe,We[0]+12);if(2147483648<=wn*(Xe=1+pe(Xe,We[0]+15))){Me=3;break e}Jt!=null&&(Jt[0]=Mt),dt!=null&&(dt[0]=wn),rt!=null&&(rt[0]=Xe),We[0]+=18,Me[0]-=18,Ut[0]=1}Me=0}}if(Re=Re[0],Pe=Pe[0],Me!=0)return Me;if(We=!!(2&Pe),!Ve&&Re)return 3;if(X!=null&&(X[0]=!!(16&Pe)),K!=null&&(K[0]=We),te!=null&&(te[0]=0),K=le[0],Pe=je[0],Re&&We&&ie==null){Me=0;break}if(4>I){Me=7;break}if(Ve&&Re||!Ve&&!Re&&!n(b,j[0],"ALPH")){I=[I],Ae.na=[Ae.na],Ae.P=[Ae.P],Ae.Sa=[Ae.Sa];e:{Mt=b,Me=j,Ve=I;var Ut=Ae.gb;dt=Ae.na,rt=Ae.P,Jt=Ae.Sa,wn=22,t(Mt!=null),t(Ve!=null),Xe=Me[0];var Pn=Ve[0];for(t(dt!=null),t(Jt!=null),dt[0]=null,rt[0]=null,Jt[0]=0;;){if(Me[0]=Xe,Ve[0]=Pn,8>Pn){Me=7;break e}var Kr=me(Mt,Xe+4);if(4294967286<Kr){Me=3;break e}var Nn=8+Kr+1&-2;if(wn+=Nn,0<Ut&&wn>Ut){Me=3;break e}if(!n(Mt,Xe,"VP8 ")||!n(Mt,Xe,"VP8L")){Me=0;break e}if(Pn[0]<Nn){Me=7;break e}n(Mt,Xe,"ALPH")||(dt[0]=Mt,rt[0]=Xe+8,Jt[0]=Kr),Xe+=Nn,Pn-=Nn}}if(I=I[0],Ae.na=Ae.na[0],Ae.P=Ae.P[0],Ae.Sa=Ae.Sa[0],Me!=0)break}I=[I],Ae.Ja=[Ae.Ja],Ae.xa=[Ae.xa];e:if(Ut=b,Me=j,Ve=I,dt=Ae.gb[0],rt=Ae.Ja,Jt=Ae.xa,Mt=Me[0],Xe=!n(Ut,Mt,"VP8 "),wn=!n(Ut,Mt,"VP8L"),t(Ut!=null),t(Ve!=null),t(rt!=null),t(Jt!=null),8>Ve[0])Me=7;else{if(Xe||wn){if(Ut=me(Ut,Mt+4),12<=dt&&Ut>dt-12){Me=3;break e}if(ce&&Ut>Ve[0]-8){Me=7;break e}rt[0]=Ut,Me[0]+=8,Ve[0]-=8,Jt[0]=wn}else Jt[0]=5<=Ve[0]&&Ut[Mt+0]==47&&!(Ut[Mt+4]>>5),rt[0]=Ve[0];Me=0}if(I=I[0],Ae.Ja=Ae.Ja[0],Ae.xa=Ae.xa[0],j=j[0],Me!=0)break;if(4294967286<Ae.Ja)return 3;if(te==null||We||(te[0]=Ae.xa?2:1),K=[K],Pe=[Pe],Ae.xa){if(5>I){Me=7;break}te=K,ce=Pe,We=X,b==null||5>I?b=0:5<=I&&b[j+0]==47&&!(b[j+4]>>5)?(Ve=[0],Ut=[0],dt=[0],E(rt=new q,b,j,I),Gt(rt,Ve,Ut,dt)?(te!=null&&(te[0]=Ve[0]),ce!=null&&(ce[0]=Ut[0]),We!=null&&(We[0]=dt[0]),b=1):b=0):b=0}else{if(10>I){Me=7;break}te=Pe,b==null||10>I||!hr(b,j+3,I-3)?b=0:(ce=b[j+0]|b[j+1]<<8|b[j+2]<<16,We=16383&(b[j+7]<<8|b[j+6]),b=16383&(b[j+9]<<8|b[j+8]),1&ce||3<(ce>>1&7)||!(ce>>4&1)||ce>>5>=Ae.Ja||!We||!b?b=0:(K&&(K[0]=We),te&&(te[0]=b),b=1))}if(!b||(K=K[0],Pe=Pe[0],Re&&(le[0]!=K||je[0]!=Pe)))return 3;ie!=null&&(ie[0]=Ae,ie.offset=j-ie.w,t(4294967286>j-ie.w),t(ie.offset==ie.ha-I));break}return Me==0||Me==7&&Re&&ie==null?(X!=null&&(X[0]|=Ae.na!=null&&0<Ae.na.length),z!=null&&(z[0]=K),Z!=null&&(Z[0]=Pe),0):Me}function pd(b,j,I){var z=j.width,Z=j.height,X=0,K=0,te=z,ie=Z;if(j.Da=b!=null&&0<b.Da,j.Da&&(te=b.cd,ie=b.bd,X=b.v,K=b.j,11>I||(X&=-2,K&=-2),0>X||0>K||0>=te||0>=ie||X+te>z||K+ie>Z))return 0;if(j.v=X,j.j=K,j.va=X+te,j.o=K+ie,j.U=te,j.T=ie,j.da=b!=null&&0<b.da,j.da){if(!Oe(te,ie,I=[b.ib],X=[b.hb]))return 0;j.ib=I[0],j.hb=X[0]}return j.ob=b!=null&&b.ob,j.Kb=b==null||!b.Sd,j.da&&(j.ob=j.ib<3*z/4&&j.hb<3*Z/4,j.Kb=0),1}function gd(b){if(b==null)return 2;if(11>b.S){var j=b.f.RGBA;j.fb+=(b.height-1)*j.A,j.A=-j.A}else j=b.f.kb,b=b.height,j.O+=(b-1)*j.fa,j.fa=-j.fa,j.N+=(b-1>>1)*j.Ab,j.Ab=-j.Ab,j.W+=(b-1>>1)*j.Db,j.Db=-j.Db,j.F!=null&&(j.J+=(b-1)*j.lb,j.lb=-j.lb);return 0}function So(b,j,I,z){if(z==null||0>=b||0>=j)return 2;if(I!=null){if(I.Da){var Z=I.cd,X=I.bd,K=-2&I.v,te=-2&I.j;if(0>K||0>te||0>=Z||0>=X||K+Z>b||te+X>j)return 2;b=Z,j=X}if(I.da){if(!Oe(b,j,Z=[I.ib],X=[I.hb]))return 2;b=Z[0],j=X[0]}}z.width=b,z.height=j;e:{var ie=z.width,le=z.height;if(b=z.S,0>=ie||0>=le||!(b>=Fh&&13>b))b=2;else{if(0>=z.Rd&&z.sd==null){K=X=Z=j=0;var je=(te=ie*Sv[b])*le;if(11>b||(X=(le+1)/2*(j=(ie+1)/2),b==12&&(K=(Z=ie)*le)),(le=i(je+2*X+K))==null){b=1;break e}z.sd=le,11>b?((ie=z.f.RGBA).eb=le,ie.fb=0,ie.A=te,ie.size=je):((ie=z.f.kb).y=le,ie.O=0,ie.fa=te,ie.Fd=je,ie.f=le,ie.N=0+je,ie.Ab=j,ie.Cd=X,ie.ea=le,ie.W=0+je+X,ie.Db=j,ie.Ed=X,b==12&&(ie.F=le,ie.J=0+je+2*X),ie.Tc=K,ie.lb=Z)}if(j=1,Z=z.S,X=z.width,K=z.height,Z>=Fh&&13>Z)if(11>Z)b=z.f.RGBA,j&=(te=Math.abs(b.A))*(K-1)+X<=b.size,j&=te>=X*Sv[Z],j&=b.eb!=null;else{b=z.f.kb,te=(X+1)/2,je=(K+1)/2,ie=Math.abs(b.fa),le=Math.abs(b.Ab);var Re=Math.abs(b.Db),ce=Math.abs(b.lb),Ae=ce*(K-1)+X;j&=ie*(K-1)+X<=b.Fd,j&=le*(je-1)+te<=b.Cd,j=(j&=Re*(je-1)+te<=b.Ed)&ie>=X&le>=te&Re>=te,j&=b.y!=null,j&=b.f!=null,j&=b.ea!=null,Z==12&&(j&=ce>=X,j&=Ae<=b.Tc,j&=b.F!=null)}else j=0;b=j?0:2}}return b!=0||I!=null&&I.fd&&(b=gd(z)),b}var Al=64,ci=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],ui=24,_o=32,Ha=8,Ao=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];ut("Predictor0","PredictorAdd0"),S.Predictor0=function(){return 4278190080},S.Predictor1=function(b){return b},S.Predictor2=function(b,j,I){return j[I+0]},S.Predictor3=function(b,j,I){return j[I+1]},S.Predictor4=function(b,j,I){return j[I-1]},S.Predictor5=function(b,j,I){return Nt(Nt(b,j[I+1]),j[I+0])},S.Predictor6=function(b,j,I){return Nt(b,j[I-1])},S.Predictor7=function(b,j,I){return Nt(b,j[I+0])},S.Predictor8=function(b,j,I){return Nt(j[I-1],j[I+0])},S.Predictor9=function(b,j,I){return Nt(j[I+0],j[I+1])},S.Predictor10=function(b,j,I){return Nt(Nt(b,j[I-1]),Nt(j[I+0],j[I+1]))},S.Predictor11=function(b,j,I){var z=j[I+0];return 0>=Ze(z>>24&255,b>>24&255,(j=j[I-1])>>24&255)+Ze(z>>16&255,b>>16&255,j>>16&255)+Ze(z>>8&255,b>>8&255,j>>8&255)+Ze(255&z,255&b,255&j)?z:b},S.Predictor12=function(b,j,I){var z=j[I+0];return(ye((b>>24&255)+(z>>24&255)-((j=j[I-1])>>24&255))<<24|ye((b>>16&255)+(z>>16&255)-(j>>16&255))<<16|ye((b>>8&255)+(z>>8&255)-(j>>8&255))<<8|ye((255&b)+(255&z)-(255&j)))>>>0},S.Predictor13=function(b,j,I){var z=j[I-1];return(ze((b=Nt(b,j[I+0]))>>24&255,z>>24&255)<<24|ze(b>>16&255,z>>16&255)<<16|ze(b>>8&255,z>>8&255)<<8|ze(255&b,255&z))>>>0};var xd=S.PredictorAdd0;S.PredictorAdd1=xe,ut("Predictor2","PredictorAdd2"),ut("Predictor3","PredictorAdd3"),ut("Predictor4","PredictorAdd4"),ut("Predictor5","PredictorAdd5"),ut("Predictor6","PredictorAdd6"),ut("Predictor7","PredictorAdd7"),ut("Predictor8","PredictorAdd8"),ut("Predictor9","PredictorAdd9"),ut("Predictor10","PredictorAdd10"),ut("Predictor11","PredictorAdd11"),ut("Predictor12","PredictorAdd12"),ut("Predictor13","PredictorAdd13");var Rc=S.PredictorAdd2;se("ColorIndexInverseTransform","MapARGB","32b",function(b){return b>>8&255},function(b){return b}),se("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(b){return b},function(b){return b>>8&255});var Mr,Mh=S.ColorIndexInverseTransform,ha=S.MapARGB,ma=S.VP8LColorIndexInverseTransformAlpha,yd=S.MapAlpha,bd=S.VP8LPredictorsAdd=[];bd.length=16,(S.VP8LPredictors=[]).length=16,(S.VP8LPredictorsAdd_C=[]).length=16,(S.VP8LPredictors_C=[]).length=16;var vd,wd,ko,Eo,Co,kl,Po,El,Ci,pa,Vn,tr,Rr,Xr,Wa,Nd,$c,Rh,Qb,ev,tv,nv,rv,sv,jd,iv,av,ov,lv=i(511),cv=i(2041),uv=i(225),dv=i(767),fv=0,bg=cv,$h=uv,di=dv,Pi=lv,Fh=0,Oh=1,hv=2,Dh=3,Bh=4,vg=5,mv=6,wg=7,Ng=8,zh=9,jg=10,K7=[2,3,7],Q7=[3,3,11],pv=[280,256,256,256,40],eE=[0,1,1,1,0],tE=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],nE=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],rE=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],sE=8,Sg=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],_g=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Sd=null,iE=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],aE=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],gv=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],oE=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],lE=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],cE=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],uE=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],Io=[],Vi=[],Va=[],dE=1,xv=2,To=[],Ii=[];Zs("UpsampleRgbLinePair",wl,3),Zs("UpsampleBgrLinePair",Nl,3),Zs("UpsampleRgbaLinePair",md,4),Zs("UpsampleBgraLinePair",hd,4),Zs("UpsampleArgbLinePair",Sl,4),Zs("UpsampleRgba4444LinePair",jl,2),Zs("UpsampleRgb565LinePair",Ns,2);var fE=S.UpsampleRgbLinePair,hE=S.UpsampleBgrLinePair,yv=S.UpsampleRgbaLinePair,bv=S.UpsampleBgraLinePair,vv=S.UpsampleArgbLinePair,wv=S.UpsampleRgba4444LinePair,mE=S.UpsampleRgb565LinePair,Uh=16,qh=1<<Uh-1,_d=-227,Ag=482,pE=6,Nv=0,gE=i(256),xE=i(256),yE=i(256),bE=i(256),vE=i(Ag-_d),wE=i(Ag-_d);qa("YuvToRgbRow",wl,3),qa("YuvToBgrRow",Nl,3),qa("YuvToRgbaRow",md,4),qa("YuvToBgraRow",hd,4),qa("YuvToArgbRow",Sl,4),qa("YuvToRgba4444Row",jl,2),qa("YuvToRgb565Row",Ns,2);var jv=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],Hh=[0,2,8],NE=[8,7,6,4,4,2,2,2,1,1,1,1],jE=1;this.WebPDecodeRGBA=function(b,j,I,z,Z){var X=Oh,K=new Ce,te=new wt;K.ba=te,te.S=X,te.width=[te.width],te.height=[te.height];var ie=te.width,le=te.height,je=new St;if(je==null||b==null)var Re=2;else t(je!=null),Re=_l(b,j,I,je.width,je.height,je.Pd,je.Qd,je.format,null);if(Re!=0?ie=0:(ie!=null&&(ie[0]=je.width[0]),le!=null&&(le[0]=je.height[0]),ie=1),ie){te.width=te.width[0],te.height=te.height[0],z!=null&&(z[0]=te.width),Z!=null&&(Z[0]=te.height);e:{if(z=new mn,(Z=new Ye).data=b,Z.w=j,Z.ha=I,Z.kd=1,j=[0],t(Z!=null),((b=_l(Z.data,Z.w,Z.ha,null,null,null,j,null,Z))==0||b==7)&&j[0]&&(b=4),(j=b)==0){if(t(K!=null),z.data=Z.data,z.w=Z.w+Z.offset,z.ha=Z.ha-Z.offset,z.put=Fe,z.ac=lt,z.bc=Dt,z.ma=K,Z.xa){if((b=Ct())==null){K=1;break e}if(function(ce,Ae){var Pe=[0],We=[0],Me=[0];t:for(;;){if(ce==null)return 0;if(Ae==null)return ce.a=2,0;if(ce.l=Ae,ce.a=0,E(ce.m,Ae.data,Ae.w,Ae.ha),!Gt(ce.m,Pe,We,Me)){ce.a=3;break t}if(ce.xb=xv,Ae.width=Pe[0],Ae.height=We[0],!Lt(Pe[0],We[0],1,ce,null))break t;return 1}return t(ce.a!=0),0}(b,z)){if(z=(j=So(z.width,z.height,K.Oa,K.ba))==0){t:{z=b;n:for(;;){if(z==null){z=0;break t}if(t(z.s.yc!=null),t(z.s.Ya!=null),t(0<z.s.Wb),t((I=z.l)!=null),t((Z=I.ma)!=null),z.xb!=0){if(z.ca=Z.ba,z.tb=Z.tb,t(z.ca!=null),!pd(Z.Oa,I,Dh)){z.a=2;break n}if(!Gn(z,I.width)||I.da)break n;if((I.da||_e(z.ca.S))&&ki(),11>z.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),z.ca.f.kb.F!=null&&ki()),z.Pb&&0<z.s.ua&&z.s.vb.X==null&&!ne(z.s.vb,z.s.Wa.Xa)){z.a=1;break n}z.xb=0}if(!vt(z,z.V,z.Ba,z.c,z.i,I.o,Te))break n;Z.Dc=z.Ma,z=1;break t}t(z.a!=0),z=0}z=!z}z&&(j=b.a)}else j=b.a}else{if((b=new Bn)==null){K=1;break e}if(b.Fa=Z.na,b.P=Z.P,b.qc=Z.Sa,Jr(b,z)){if((j=So(z.width,z.height,K.Oa,K.ba))==0){if(b.Aa=0,I=K.Oa,t((Z=b)!=null),I!=null){if(0<(ie=0>(ie=I.Md)?0:100<ie?255:255*ie/100)){for(le=je=0;4>le;++le)12>(Re=Z.pb[le]).lc&&(Re.ia=ie*NE[0>Re.lc?0:Re.lc]>>3),je|=Re.ia;je&&(alert("todo:VP8InitRandom"),Z.ia=1)}Z.Ga=I.Id,100<Z.Ga?Z.Ga=100:0>Z.Ga&&(Z.Ga=0)}(function(ce,Ae){if(ce==null)return 0;if(Ae==null)return Hn(ce,2,"NULL VP8Io parameter in VP8Decode().");if(!ce.cb&&!Jr(ce,Ae))return 0;if(t(ce.cb),Ae.ac==null||Ae.ac(Ae)){Ae.ob&&(ce.L=0);var Pe=Hh[ce.L];if(ce.L==2?(ce.yb=0,ce.zb=0):(ce.yb=Ae.v-Pe>>4,ce.zb=Ae.j-Pe>>4,0>ce.yb&&(ce.yb=0),0>ce.zb&&(ce.zb=0)),ce.Va=Ae.o+15+Pe>>4,ce.Hb=Ae.va+15+Pe>>4,ce.Hb>ce.za&&(ce.Hb=ce.za),ce.Va>ce.Ub&&(ce.Va=ce.Ub),0<ce.L){var We=ce.ed;for(Pe=0;4>Pe;++Pe){var Me;if(ce.Qa.Cb){var Ve=ce.Qa.Lb[Pe];ce.Qa.Fb||(Ve+=We.Tb)}else Ve=We.Tb;for(Me=0;1>=Me;++Me){var Xe=ce.gd[Pe][Me],dt=Ve;if(We.Pc&&(dt+=We.vd[0],Me&&(dt+=We.od[0])),0<(dt=0>dt?0:63<dt?63:dt)){var rt=dt;0<We.wb&&(rt=4<We.wb?rt>>2:rt>>1)>9-We.wb&&(rt=9-We.wb),1>rt&&(rt=1),Xe.dd=rt,Xe.tc=2*dt+rt,Xe.ld=40<=dt?2:15<=dt?1:0}else Xe.tc=0;Xe.La=Me}}}Pe=0}else Hn(ce,6,"Frame setup failed"),Pe=ce.a;if(Pe=Pe==0){if(Pe){ce.$c=0,0<ce.Aa||(ce.Ic=jE);t:{Pe=ce.Ic,We=4*(rt=ce.za);var Jt=32*rt,Mt=rt+1,wn=0<ce.L?rt*(0<ce.Aa?2:1):0,Ut=(ce.Aa==2?2:1)*rt;if((Xe=We+832+(Me=3*(16*Pe+Hh[ce.L])/2*Jt)+(Ve=ce.Fa!=null&&0<ce.Fa.length?ce.Kc.c*ce.Kc.i:0))!=Xe)Pe=0;else{if(Xe>ce.Vb){if(ce.Vb=0,ce.Ec=i(Xe),ce.Fc=0,ce.Ec==null){Pe=Hn(ce,1,"no memory during frame initialization.");break t}ce.Vb=Xe}Xe=ce.Ec,dt=ce.Fc,ce.Ac=Xe,ce.Bc=dt,dt+=We,ce.Gd=l(Jt,bn),ce.Hd=0,ce.rb=l(Mt+1,Ft),ce.sb=1,ce.wa=wn?l(wn,mt):null,ce.Y=0,ce.D.Nb=0,ce.D.wa=ce.wa,ce.D.Y=ce.Y,0<ce.Aa&&(ce.D.Y+=rt),t(!0),ce.oc=Xe,ce.pc=dt,dt+=832,ce.ya=l(Ut,rn),ce.aa=0,ce.D.ya=ce.ya,ce.D.aa=ce.aa,ce.Aa==2&&(ce.D.aa+=rt),ce.R=16*rt,ce.B=8*rt,rt=(Jt=Hh[ce.L])*ce.R,Jt=Jt/2*ce.B,ce.sa=Xe,ce.ta=dt+rt,ce.qa=ce.sa,ce.ra=ce.ta+16*Pe*ce.R+Jt,ce.Ha=ce.qa,ce.Ia=ce.ra+8*Pe*ce.B+Jt,ce.$c=0,dt+=Me,ce.mb=Ve?Xe:null,ce.nb=Ve?dt:null,t(dt+Ve<=ce.Fc+ce.Vb),Rn(ce),s(ce.Ac,ce.Bc,0,We),Pe=1}}if(Pe){if(Ae.ka=0,Ae.y=ce.sa,Ae.O=ce.ta,Ae.f=ce.qa,Ae.N=ce.ra,Ae.ea=ce.Ha,Ae.Vd=ce.Ia,Ae.fa=ce.R,Ae.Rc=ce.B,Ae.F=null,Ae.J=0,!fv){for(Pe=-255;255>=Pe;++Pe)lv[255+Pe]=0>Pe?-Pe:Pe;for(Pe=-1020;1020>=Pe;++Pe)cv[1020+Pe]=-128>Pe?-128:127<Pe?127:Pe;for(Pe=-112;112>=Pe;++Pe)uv[112+Pe]=-16>Pe?-16:15<Pe?15:Pe;for(Pe=-255;510>=Pe;++Pe)dv[255+Pe]=0>Pe?0:255<Pe?255:Pe;fv=1}Po=hl,El=wc,pa=Nc,Vn=li,tr=fl,Ci=vc,Rr=Ch,Xr=Ph,Wa=k,Nd=J,$c=yl,Rh=Ih,Qb=ue,ev=ve,tv=fd,nv=xl,rv=kh,sv=Eh,Vi[0]=Ec,Vi[1]=wo,Vi[2]=kc,Vi[3]=od,Vi[4]=pg,Vi[5]=Ba,Vi[6]=Da,Vi[7]=gg,Vi[8]=Cc,Vi[9]=xg,Io[0]=Wi,Io[1]=Sc,Io[2]=_c,Io[3]=No,Io[4]=Ac,Io[5]=Ge,Io[6]=Ke,Va[0]=Ic,Va[1]=jc,Va[2]=ld,Va[3]=ml,Va[4]=cd,Va[5]=yg,Va[6]=ud,Pe=1}else Pe=0}Pe&&(Pe=function(Pn,Kr){for(Pn.M=0;Pn.M<Pn.Va;++Pn.M){var Nn,qt=Pn.Jc[Pn.M&Pn.Xb],jt=Pn.m,$r=Pn;for(Nn=0;Nn<$r.za;++Nn){var xn=jt,Ln=$r,ur=Ln.Ac,hs=Ln.Bc+4*Nn,$s=Ln.zc,Sr=Ln.ya[Ln.aa+Nn];if(Ln.Qa.Bb?Sr.$b=fe(xn,Ln.Pa.jb[0])?2+fe(xn,Ln.Pa.jb[2]):fe(xn,Ln.Pa.jb[1]):Sr.$b=0,Ln.kc&&(Sr.Ad=fe(xn,Ln.Bd)),Sr.Za=!fe(xn,145)+0,Sr.Za){var js=Sr.Ob,Fs=0;for(Ln=0;4>Ln;++Ln){var Qr,Mn=$s[0+Ln];for(Qr=0;4>Qr;++Qr){Mn=lE[ur[hs+Qr]][Mn];for(var Yn=gv[fe(xn,Mn[0])];0<Yn;)Yn=gv[2*Yn+fe(xn,Mn[Yn])];Mn=-Yn,ur[hs+Qr]=Mn}r(js,Fs,ur,hs,4),Fs+=4,$s[0+Ln]=Mn}}else Mn=fe(xn,156)?fe(xn,128)?1:3:fe(xn,163)?2:0,Sr.Ob[0]=Mn,s(ur,hs,Mn,4),s($s,0,Mn,4);Sr.Dd=fe(xn,142)?fe(xn,114)?fe(xn,183)?1:3:2:0}if($r.m.Ka)return Hn(Pn,7,"Premature end-of-partition0 encountered.");for(;Pn.ja<Pn.za;++Pn.ja){if($r=qt,xn=(jt=Pn).rb[jt.sb-1],ur=jt.rb[jt.sb+jt.ja],Nn=jt.ya[jt.aa+jt.ja],hs=jt.kc?Nn.Ad:0)xn.la=ur.la=0,Nn.Za||(xn.Na=ur.Na=0),Nn.Hc=0,Nn.Gc=0,Nn.ia=0;else{var _r,Jn;if(xn=ur,ur=$r,hs=jt.Pa.Xc,$s=jt.ya[jt.aa+jt.ja],Sr=jt.pb[$s.$b],Ln=$s.ad,js=0,Fs=jt.rb[jt.sb-1],Mn=Qr=0,s(Ln,js,0,384),$s.Za)var ms=0,Gi=hs[3];else{Yn=i(16);var Fr=xn.Na+Fs.Na;if(Fr=Sd(ur,hs[1],Fr,Sr.Eb,0,Yn,0),xn.Na=Fs.Na=(0<Fr)+0,1<Fr)Po(Yn,0,Ln,js);else{var Xs=Yn[0]+3>>3;for(Yn=0;256>Yn;Yn+=16)Ln[js+Yn]=Xs}ms=1,Gi=hs[0]}var nr=15&xn.la,es=15&Fs.la;for(Yn=0;4>Yn;++Yn){var fi=1&es;for(Xs=Jn=0;4>Xs;++Xs)nr=nr>>1|(fi=(Fr=Sd(ur,Gi,Fr=fi+(1&nr),Sr.Sc,ms,Ln,js))>ms)<<7,Jn=Jn<<2|(3<Fr?3:1<Fr?2:Ln[js+0]!=0),js+=16;nr>>=4,es=es>>1|fi<<7,Qr=(Qr<<8|Jn)>>>0}for(Gi=nr,ms=es>>4,_r=0;4>_r;_r+=2){for(Jn=0,nr=xn.la>>4+_r,es=Fs.la>>4+_r,Yn=0;2>Yn;++Yn){for(fi=1&es,Xs=0;2>Xs;++Xs)Fr=fi+(1&nr),nr=nr>>1|(fi=0<(Fr=Sd(ur,hs[2],Fr,Sr.Qc,0,Ln,js)))<<3,Jn=Jn<<2|(3<Fr?3:1<Fr?2:Ln[js+0]!=0),js+=16;nr>>=2,es=es>>1|fi<<5}Mn|=Jn<<4*_r,Gi|=nr<<4<<_r,ms|=(240&es)<<_r}xn.la=Gi,Fs.la=ms,$s.Hc=Qr,$s.Gc=Mn,$s.ia=43690&Mn?0:Sr.ia,hs=!(Qr|Mn)}if(0<jt.L&&(jt.wa[jt.Y+jt.ja]=jt.gd[Nn.$b][Nn.Za],jt.wa[jt.Y+jt.ja].La|=!hs),$r.Ka)return Hn(Pn,7,"Premature end-of-file encountered.")}if(Rn(Pn),jt=Kr,$r=1,Nn=(qt=Pn).D,xn=0<qt.L&&qt.M>=qt.zb&&qt.M<=qt.Va,qt.Aa==0)t:{if(Nn.M=qt.M,Nn.uc=xn,Ei(qt,Nn),$r=1,Nn=(Jn=qt.D).Nb,xn=(Mn=Hh[qt.L])*qt.R,ur=Mn/2*qt.B,Yn=16*Nn*qt.R,Xs=8*Nn*qt.B,hs=qt.sa,$s=qt.ta-xn+Yn,Sr=qt.qa,Ln=qt.ra-ur+Xs,js=qt.Ha,Fs=qt.Ia-ur+Xs,es=(nr=Jn.M)==0,Qr=nr>=qt.Va-1,qt.Aa==2&&Ei(qt,Jn),Jn.uc)for(fi=(Fr=qt).D.M,t(Fr.D.uc),Jn=Fr.yb;Jn<Fr.Hb;++Jn){ms=Jn,Gi=fi;var Os=(hi=(ps=Fr).D).Nb;_r=ps.R;var hi=hi.wa[hi.Y+ms],mi=ps.sa,Ks=ps.ta+16*Os*_r+16*ms,pi=hi.dd,lr=hi.tc;if(lr!=0)if(t(3<=lr),ps.L==1)0<ms&&nv(mi,Ks,_r,lr+4),hi.La&&sv(mi,Ks,_r,lr),0<Gi&&tv(mi,Ks,_r,lr+4),hi.La&&rv(mi,Ks,_r,lr);else{var gi=ps.B,Yi=ps.qa,Cl=ps.ra+8*Os*gi+8*ms,Ga=ps.Ha,ps=ps.Ia+8*Os*gi+8*ms;Os=hi.ld,0<ms&&(Xr(mi,Ks,_r,lr+4,pi,Os),Nd(Yi,Cl,Ga,ps,gi,lr+4,pi,Os)),hi.La&&(Rh(mi,Ks,_r,lr,pi,Os),ev(Yi,Cl,Ga,ps,gi,lr,pi,Os)),0<Gi&&(Rr(mi,Ks,_r,lr+4,pi,Os),Wa(Yi,Cl,Ga,ps,gi,lr+4,pi,Os)),hi.La&&($c(mi,Ks,_r,lr,pi,Os),Qb(Yi,Cl,Ga,ps,gi,lr,pi,Os))}}if(qt.ia&&alert("todo:DitherRow"),jt.put!=null){if(Jn=16*nr,nr=16*(nr+1),es?(jt.y=qt.sa,jt.O=qt.ta+Yn,jt.f=qt.qa,jt.N=qt.ra+Xs,jt.ea=qt.Ha,jt.W=qt.Ia+Xs):(Jn-=Mn,jt.y=hs,jt.O=$s,jt.f=Sr,jt.N=Ln,jt.ea=js,jt.W=Fs),Qr||(nr-=Mn),nr>jt.o&&(nr=jt.o),jt.F=null,jt.J=null,qt.Fa!=null&&0<qt.Fa.length&&Jn<nr&&(jt.J=qr(qt,jt,Jn,nr-Jn),jt.F=qt.mb,jt.F==null&&jt.F.length==0)){$r=Hn(qt,3,"Could not decode alpha data.");break t}Jn<jt.j&&(Mn=jt.j-Jn,Jn=jt.j,t(!(1&Mn)),jt.O+=qt.R*Mn,jt.N+=qt.B*(Mn>>1),jt.W+=qt.B*(Mn>>1),jt.F!=null&&(jt.J+=jt.width*Mn)),Jn<nr&&(jt.O+=jt.v,jt.N+=jt.v>>1,jt.W+=jt.v>>1,jt.F!=null&&(jt.J+=jt.v),jt.ka=Jn-jt.j,jt.U=jt.va-jt.v,jt.T=nr-Jn,$r=jt.put(jt))}Nn+1!=qt.Ic||Qr||(r(qt.sa,qt.ta-xn,hs,$s+16*qt.R,xn),r(qt.qa,qt.ra-ur,Sr,Ln+8*qt.B,ur),r(qt.Ha,qt.Ia-ur,js,Fs+8*qt.B,ur))}if(!$r)return Hn(Pn,6,"Output aborted.")}return 1}(ce,Ae)),Ae.bc!=null&&Ae.bc(Ae),Pe&=1}return Pe?(ce.cb=0,Pe):0})(b,z)||(j=b.a)}}else j=b.a}j==0&&K.Oa!=null&&K.Oa.fd&&(j=gd(K.ba))}K=j}X=K!=0?null:11>X?te.f.RGBA.eb:te.f.kb.y}else X=null;return X};var Sv=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function u(S,C){for(var _="",T=0;T<4;T++)_+=String.fromCharCode(S[C++]);return _}function d(S,C){return S[C+0]|S[C+1]<<8}function f(S,C){return(S[C+0]|S[C+1]<<8|S[C+2]<<16)>>>0}function m(S,C){return(S[C+0]|S[C+1]<<8|S[C+2]<<16|S[C+3]<<24)>>>0}new c;var h=[0],x=[0],y=[],p=new c,g=e,w=function(S,C){var _={},T=0,B=!1,$=0,D=0;if(_.frames=[],!function(R,q){for(var F=0;F<4;F++)if(R[q+F]!="RIFF".charCodeAt(F))return!0;return!1}(S,C)){for(m(S,C+=4),C+=8;C<S.length;){var L=u(S,C),O=m(S,C+=4);C+=4;var W=O+(1&O);switch(L){case"VP8 ":case"VP8L":_.frames[T]===void 0&&(_.frames[T]={}),(V=_.frames[T]).src_off=B?D:C-8,V.src_size=$+O+8,T++,B&&(B=!1,$=0,D=0);break;case"VP8X":(V=_.header={}).feature_flags=S[C];var E=C+4;V.canvas_width=1+f(S,E),E+=3,V.canvas_height=1+f(S,E),E+=3;break;case"ALPH":B=!0,$=W+8,D=C-8;break;case"ANIM":(V=_.header).bgcolor=m(S,C),E=C+4,V.loop_count=d(S,E),E+=2;break;case"ANMF":var H,V;(V=_.frames[T]={}).offset_x=2*f(S,C),C+=3,V.offset_y=2*f(S,C),C+=3,V.width=1+f(S,C),C+=3,V.height=1+f(S,C),C+=3,V.duration=f(S,C),C+=3,H=S[C++],V.dispose=1&H,V.blend=H>>1&1}L!="ANMF"&&(C+=W)}return _}}(g,0);w.response=g,w.rgbaoutput=!0,w.dataurl=!1;var v=w.header?w.header:null,N=w.frames?w.frames:null;if(v){v.loop_counter=v.loop_count,h=[v.canvas_height],x=[v.canvas_width];for(var A=0;A<N.length&&N[A].blend!=0;A++);}var P=N[0],U=p.WebPDecodeRGBA(g,P.src_off,P.src_size,x,h);P.rgba=U,P.imgwidth=x[0],P.imgheight=h[0];for(var M=0;M<x[0]*h[0]*4;M++)y[M]=U[M];return this.width=x,this.height=h,this.data=y,this}(function(e){var t,n,r,s,i,l,o,c,u,d=function(R){return R=R||{},this.isStrokeTransparent=R.isStrokeTransparent||!1,this.strokeOpacity=R.strokeOpacity||1,this.strokeStyle=R.strokeStyle||"#000000",this.fillStyle=R.fillStyle||"#000000",this.isFillTransparent=R.isFillTransparent||!1,this.fillOpacity=R.fillOpacity||1,this.font=R.font||"10px sans-serif",this.textBaseline=R.textBaseline||"alphabetic",this.textAlign=R.textAlign||"left",this.lineWidth=R.lineWidth||1,this.lineJoin=R.lineJoin||"miter",this.lineCap=R.lineCap||"butt",this.path=R.path||[],this.transform=R.transform!==void 0?R.transform.clone():new c,this.globalCompositeOperation=R.globalCompositeOperation||"normal",this.globalAlpha=R.globalAlpha||1,this.clip_path=R.clip_path||[],this.currentPoint=R.currentPoint||new l,this.miterLimit=R.miterLimit||10,this.lastPoint=R.lastPoint||new l,this.lineDashOffset=R.lineDashOffset||0,this.lineDash=R.lineDash||[],this.margin=R.margin||[0,0,0,0],this.prevPageLastElemOffset=R.prevPageLastElemOffset||0,this.ignoreClearRect=typeof R.ignoreClearRect!="boolean"||R.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new f(this),t=this.internal.f2,n=this.internal.getCoordinateString,r=this.internal.getVerticalCoordinateString,s=this.internal.getHorizontalCoordinate,i=this.internal.getVerticalCoordinate,l=this.internal.Point,o=this.internal.Rectangle,c=this.internal.Matrix,u=new d}]);var f=function(R){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var q=R;Object.defineProperty(this,"pdf",{get:function(){return q}});var F=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return F},set:function(me){F=!!me}});var G=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return G},set:function(me){G=!!me}});var ee=0;Object.defineProperty(this,"posX",{get:function(){return ee},set:function(me){isNaN(me)||(ee=me)}});var ae=0;Object.defineProperty(this,"posY",{get:function(){return ae},set:function(me){isNaN(me)||(ae=me)}}),Object.defineProperty(this,"margin",{get:function(){return u.margin},set:function(me){var ne;typeof me=="number"?ne=[me,me,me,me]:((ne=new Array(4))[0]=me[0],ne[1]=me.length>=2?me[1]:ne[0],ne[2]=me.length>=3?me[2]:ne[0],ne[3]=me.length>=4?me[3]:ne[1]),u.margin=ne}});var re=!1;Object.defineProperty(this,"autoPaging",{get:function(){return re},set:function(me){re=me}});var Q=0;Object.defineProperty(this,"lastBreak",{get:function(){return Q},set:function(me){Q=me}});var fe=[];Object.defineProperty(this,"pageBreaks",{get:function(){return fe},set:function(me){fe=me}}),Object.defineProperty(this,"ctx",{get:function(){return u},set:function(me){me instanceof d&&(u=me)}}),Object.defineProperty(this,"path",{get:function(){return u.path},set:function(me){u.path=me}});var Se=[];Object.defineProperty(this,"ctxStack",{get:function(){return Se},set:function(me){Se=me}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(me){var ne;ne=m(me),this.ctx.fillStyle=ne.style,this.ctx.isFillTransparent=ne.a===0,this.ctx.fillOpacity=ne.a,this.pdf.setFillColor(ne.r,ne.g,ne.b,{a:ne.a}),this.pdf.setTextColor(ne.r,ne.g,ne.b,{a:ne.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(me){var ne=m(me);this.ctx.strokeStyle=ne.style,this.ctx.isStrokeTransparent=ne.a===0,this.ctx.strokeOpacity=ne.a,ne.a===0?this.pdf.setDrawColor(255,255,255):(ne.a,this.pdf.setDrawColor(ne.r,ne.g,ne.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(me){["butt","round","square"].indexOf(me)!==-1&&(this.ctx.lineCap=me,this.pdf.setLineCap(me))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(me){isNaN(me)||(this.ctx.lineWidth=me,this.pdf.setLineWidth(me))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(me){["bevel","round","miter"].indexOf(me)!==-1&&(this.ctx.lineJoin=me,this.pdf.setLineJoin(me))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(me){isNaN(me)||(this.ctx.miterLimit=me,this.pdf.setMiterLimit(me))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(me){this.ctx.textBaseline=me}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(me){["right","end","center","left","start"].indexOf(me)!==-1&&(this.ctx.textAlign=me)}});var oe=null,pe=null;Object.defineProperty(this,"fontFaces",{get:function(){return pe},set:function(me){oe=null,pe=me}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(me){var ne;if(this.ctx.font=me,(ne=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z]+?)\s*$/i.exec(me))!==null){var it=ne[1];ne[2];var $e=ne[3],Oe=ne[4];ne[5];var qe=ne[6],gt=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(Oe)[2];Oe=Math.floor(gt==="px"?parseFloat(Oe)*this.pdf.internal.scaleFactor:gt==="em"?parseFloat(Oe)*this.pdf.getFontSize():parseFloat(Oe)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(Oe);var ut=function(de){var se,he,ke=[],be=de.trim();if(be==="")return sx;if(be in R3)return[R3[be]];for(;be!=="";){switch(he=null,se=(be=F3(be)).charAt(0)){case'"':case"'":he=BK(be.substring(1),se);break;default:he=zK(be)}if(he===null||(ke.push(he[0]),(be=F3(he[1]))!==""&&be.charAt(0)!==","))return sx;be=be.replace(/^,/,"")}return ke}(qe);if(this.fontFaces){var Rt=function(de,se){if(oe===null){var he=function(ke){var be=[];return Object.keys(ke).forEach(function(Le){ke[Le].forEach(function(He){var Ue=null;switch(He){case"bold":Ue={family:Le,weight:"bold"};break;case"italic":Ue={family:Le,style:"italic"};break;case"bolditalic":Ue={family:Le,weight:"bold",style:"italic"};break;case"":case"normal":Ue={family:Le}}Ue!==null&&(Ue.ref={name:Le,style:He},be.push(Ue))})}),be}(de.getFontList());oe=function(ke){for(var be={},Le=0;Le<ke.length;++Le){var He=rx(ke[Le]),Ue=He.family,De=He.stretch,_e=He.style,Ie=He.weight;be[Ue]=be[Ue]||{},be[Ue][De]=be[Ue][De]||{},be[Ue][De][_e]=be[Ue][De][_e]||{},be[Ue][De][_e][Ie]=He}return be}(he.concat(se))}return oe}(this.pdf,this.fontFaces),Nt=ut.map(function(de){return{family:de,stretch:"normal",weight:$e,style:it}}),ye=function(de,se,he){for(var ke=(he=he||{}).defaultFontFamily||"times",be=Object.assign({},DK,he.genericFontFamilies||{}),Le=null,He=null,Ue=0;Ue<se.length;++Ue)if(be[(Le=rx(se[Ue])).family]&&(Le.family=be[Le.family]),de.hasOwnProperty(Le.family)){He=de[Le.family];break}if(!(He=He||de[ke]))throw new Error("Could not find a font-family for the rule '"+$3(Le)+"' and default family '"+ke+"'.");if(He=function(De,_e){if(_e[De])return _e[De];var Ie=U2[De],ht=Ie<=U2.normal?-1:1,wt=M3(_e,y7,Ie,ht);if(!wt)throw new Error("Could not find a matching font-stretch value for "+De);return wt}(Le.stretch,He),He=function(De,_e){if(_e[De])return _e[De];for(var Ie=x7[De],ht=0;ht<Ie.length;++ht)if(_e[Ie[ht]])return _e[Ie[ht]];throw new Error("Could not find a matching font-style for "+De)}(Le.style,He),!(He=function(De,_e){if(_e[De])return _e[De];if(De===400&&_e[500])return _e[500];if(De===500&&_e[400])return _e[400];var Ie=OK[De],ht=M3(_e,b7,Ie,De<400?-1:1);if(!ht)throw new Error("Could not find a matching font-weight for value "+De);return ht}(Le.weight,He)))throw new Error("Failed to resolve a font for the rule '"+$3(Le)+"'.");return He}(Rt,Nt);this.pdf.setFont(ye.ref.name,ye.ref.style)}else{var ze="";($e==="bold"||parseInt($e,10)>=700||it==="bold")&&(ze="bold"),it==="italic"&&(ze+="italic"),ze.length===0&&(ze="normal");for(var Ze="",xe={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},pt=0;pt<ut.length;pt++){if(this.pdf.internal.getFont(ut[pt],ze,{noFallback:!0,disableWarning:!0})!==void 0){Ze=ut[pt];break}if(ze==="bolditalic"&&this.pdf.internal.getFont(ut[pt],"bold",{noFallback:!0,disableWarning:!0})!==void 0)Ze=ut[pt],ze="bold";else if(this.pdf.internal.getFont(ut[pt],"normal",{noFallback:!0,disableWarning:!0})!==void 0){Ze=ut[pt],ze="normal";break}}if(Ze===""){for(var Ne=0;Ne<ut.length;Ne++)if(xe[ut[Ne]]){Ze=xe[ut[Ne]];break}}Ze=Ze===""?"Times":Ze,this.pdf.setFont(Ze,ze)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(me){this.ctx.globalCompositeOperation=me}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(me){this.ctx.globalAlpha=me}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(me){this.ctx.lineDashOffset=me,V.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(me){this.ctx.lineDash=me,V.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(me){this.ctx.ignoreClearRect=!!me}})};f.prototype.setLineDash=function(R){this.lineDash=R},f.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},f.prototype.fill=function(){N.call(this,"fill",!1)},f.prototype.stroke=function(){N.call(this,"stroke",!1)},f.prototype.beginPath=function(){this.path=[{type:"begin"}]},f.prototype.moveTo=function(R,q){if(isNaN(R)||isNaN(q))throw rr.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var F=this.ctx.transform.applyToPoint(new l(R,q));this.path.push({type:"mt",x:F.x,y:F.y}),this.ctx.lastPoint=new l(R,q)},f.prototype.closePath=function(){var R=new l(0,0),q=0;for(q=this.path.length-1;q!==-1;q--)if(this.path[q].type==="begin"&&Kn(this.path[q+1])==="object"&&typeof this.path[q+1].x=="number"){R=new l(this.path[q+1].x,this.path[q+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new l(R.x,R.y)},f.prototype.lineTo=function(R,q){if(isNaN(R)||isNaN(q))throw rr.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var F=this.ctx.transform.applyToPoint(new l(R,q));this.path.push({type:"lt",x:F.x,y:F.y}),this.ctx.lastPoint=new l(F.x,F.y)},f.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),N.call(this,null,!0)},f.prototype.quadraticCurveTo=function(R,q,F,G){if(isNaN(F)||isNaN(G)||isNaN(R)||isNaN(q))throw rr.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var ee=this.ctx.transform.applyToPoint(new l(F,G)),ae=this.ctx.transform.applyToPoint(new l(R,q));this.path.push({type:"qct",x1:ae.x,y1:ae.y,x:ee.x,y:ee.y}),this.ctx.lastPoint=new l(ee.x,ee.y)},f.prototype.bezierCurveTo=function(R,q,F,G,ee,ae){if(isNaN(ee)||isNaN(ae)||isNaN(R)||isNaN(q)||isNaN(F)||isNaN(G))throw rr.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var re=this.ctx.transform.applyToPoint(new l(ee,ae)),Q=this.ctx.transform.applyToPoint(new l(R,q)),fe=this.ctx.transform.applyToPoint(new l(F,G));this.path.push({type:"bct",x1:Q.x,y1:Q.y,x2:fe.x,y2:fe.y,x:re.x,y:re.y}),this.ctx.lastPoint=new l(re.x,re.y)},f.prototype.arc=function(R,q,F,G,ee,ae){if(isNaN(R)||isNaN(q)||isNaN(F)||isNaN(G)||isNaN(ee))throw rr.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(ae=!!ae,!this.ctx.transform.isIdentity){var re=this.ctx.transform.applyToPoint(new l(R,q));R=re.x,q=re.y;var Q=this.ctx.transform.applyToPoint(new l(0,F)),fe=this.ctx.transform.applyToPoint(new l(0,0));F=Math.sqrt(Math.pow(Q.x-fe.x,2)+Math.pow(Q.y-fe.y,2))}Math.abs(ee-G)>=2*Math.PI&&(G=0,ee=2*Math.PI),this.path.push({type:"arc",x:R,y:q,radius:F,startAngle:G,endAngle:ee,counterclockwise:ae})},f.prototype.arcTo=function(R,q,F,G,ee){throw new Error("arcTo not implemented.")},f.prototype.rect=function(R,q,F,G){if(isNaN(R)||isNaN(q)||isNaN(F)||isNaN(G))throw rr.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(R,q),this.lineTo(R+F,q),this.lineTo(R+F,q+G),this.lineTo(R,q+G),this.lineTo(R,q),this.lineTo(R+F,q),this.lineTo(R,q)},f.prototype.fillRect=function(R,q,F,G){if(isNaN(R)||isNaN(q)||isNaN(F)||isNaN(G))throw rr.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!h.call(this)){var ee={};this.lineCap!=="butt"&&(ee.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(ee.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(R,q,F,G),this.fill(),ee.hasOwnProperty("lineCap")&&(this.lineCap=ee.lineCap),ee.hasOwnProperty("lineJoin")&&(this.lineJoin=ee.lineJoin)}},f.prototype.strokeRect=function(R,q,F,G){if(isNaN(R)||isNaN(q)||isNaN(F)||isNaN(G))throw rr.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");x.call(this)||(this.beginPath(),this.rect(R,q,F,G),this.stroke())},f.prototype.clearRect=function(R,q,F,G){if(isNaN(R)||isNaN(q)||isNaN(F)||isNaN(G))throw rr.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(R,q,F,G))},f.prototype.save=function(R){R=typeof R!="boolean"||R;for(var q=this.pdf.internal.getCurrentPageInfo().pageNumber,F=0;F<this.pdf.internal.getNumberOfPages();F++)this.pdf.setPage(F+1),this.pdf.internal.out("q");if(this.pdf.setPage(q),R){this.ctx.fontSize=this.pdf.internal.getFontSize();var G=new d(this.ctx);this.ctxStack.push(this.ctx),this.ctx=G}},f.prototype.restore=function(R){R=typeof R!="boolean"||R;for(var q=this.pdf.internal.getCurrentPageInfo().pageNumber,F=0;F<this.pdf.internal.getNumberOfPages();F++)this.pdf.setPage(F+1),this.pdf.internal.out("Q");this.pdf.setPage(q),R&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},f.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var m=function(R){var q,F,G,ee;if(R.isCanvasGradient===!0&&(R=R.getColor()),!R)return{r:0,g:0,b:0,a:0,style:R};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(R))q=0,F=0,G=0,ee=0;else{var ae=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(R);if(ae!==null)q=parseInt(ae[1]),F=parseInt(ae[2]),G=parseInt(ae[3]),ee=1;else if((ae=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(R))!==null)q=parseInt(ae[1]),F=parseInt(ae[2]),G=parseInt(ae[3]),ee=parseFloat(ae[4]);else{if(ee=1,typeof R=="string"&&R.charAt(0)!=="#"){var re=new u7(R);R=re.ok?re.toHex():"#000000"}R.length===4?(q=R.substring(1,2),q+=q,F=R.substring(2,3),F+=F,G=R.substring(3,4),G+=G):(q=R.substring(1,3),F=R.substring(3,5),G=R.substring(5,7)),q=parseInt(q,16),F=parseInt(F,16),G=parseInt(G,16)}}return{r:q,g:F,b:G,a:ee,style:R}},h=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},x=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};f.prototype.fillText=function(R,q,F,G){if(isNaN(q)||isNaN(F)||typeof R!="string")throw rr.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(G=isNaN(G)?void 0:G,!h.call(this)){var ee=W(this.ctx.transform.rotation),ae=this.ctx.transform.scaleX;T.call(this,{text:R,x:q,y:F,scale:ae,angle:ee,align:this.textAlign,maxWidth:G})}},f.prototype.strokeText=function(R,q,F,G){if(isNaN(q)||isNaN(F)||typeof R!="string")throw rr.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!x.call(this)){G=isNaN(G)?void 0:G;var ee=W(this.ctx.transform.rotation),ae=this.ctx.transform.scaleX;T.call(this,{text:R,x:q,y:F,scale:ae,renderingMode:"stroke",angle:ee,align:this.textAlign,maxWidth:G})}},f.prototype.measureText=function(R){if(typeof R!="string")throw rr.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var q=this.pdf,F=this.pdf.internal.scaleFactor,G=q.internal.getFontSize(),ee=q.getStringUnitWidth(R)*G/q.internal.scaleFactor;return new function(ae){var re=(ae=ae||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return re}}),this}({width:ee*=Math.round(96*F/72*1e4)/1e4})},f.prototype.scale=function(R,q){if(isNaN(R)||isNaN(q))throw rr.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var F=new c(R,0,0,q,0,0);this.ctx.transform=this.ctx.transform.multiply(F)},f.prototype.rotate=function(R){if(isNaN(R))throw rr.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var q=new c(Math.cos(R),Math.sin(R),-Math.sin(R),Math.cos(R),0,0);this.ctx.transform=this.ctx.transform.multiply(q)},f.prototype.translate=function(R,q){if(isNaN(R)||isNaN(q))throw rr.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var F=new c(1,0,0,1,R,q);this.ctx.transform=this.ctx.transform.multiply(F)},f.prototype.transform=function(R,q,F,G,ee,ae){if(isNaN(R)||isNaN(q)||isNaN(F)||isNaN(G)||isNaN(ee)||isNaN(ae))throw rr.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var re=new c(R,q,F,G,ee,ae);this.ctx.transform=this.ctx.transform.multiply(re)},f.prototype.setTransform=function(R,q,F,G,ee,ae){R=isNaN(R)?1:R,q=isNaN(q)?0:q,F=isNaN(F)?0:F,G=isNaN(G)?1:G,ee=isNaN(ee)?0:ee,ae=isNaN(ae)?0:ae,this.ctx.transform=new c(R,q,F,G,ee,ae)};var y=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};f.prototype.drawImage=function(R,q,F,G,ee,ae,re,Q,fe){var Se=this.pdf.getImageProperties(R),oe=1,pe=1,me=1,ne=1;G!==void 0&&Q!==void 0&&(me=Q/G,ne=fe/ee,oe=Se.width/G*Q/G,pe=Se.height/ee*fe/ee),ae===void 0&&(ae=q,re=F,q=0,F=0),G!==void 0&&Q===void 0&&(Q=G,fe=ee),G===void 0&&Q===void 0&&(Q=Se.width,fe=Se.height);for(var it,$e=this.ctx.transform.decompose(),Oe=W($e.rotate.shx),qe=new c,gt=(qe=(qe=(qe=qe.multiply($e.translate)).multiply($e.skew)).multiply($e.scale)).applyToRectangle(new o(ae-q*me,re-F*ne,G*oe,ee*pe)),ut=p.call(this,gt),Rt=[],Nt=0;Nt<ut.length;Nt+=1)Rt.indexOf(ut[Nt])===-1&&Rt.push(ut[Nt]);if(v(Rt),this.autoPaging)for(var ye=Rt[0],ze=Rt[Rt.length-1],Ze=ye;Ze<ze+1;Ze++){this.pdf.setPage(Ze);var xe=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],pt=Ze===1?this.posY+this.margin[0]:this.margin[0],Ne=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],de=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],se=Ze===1?0:Ne+(Ze-2)*de;if(this.ctx.clip_path.length!==0){var he=this.path;it=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=w(it,this.posX+this.margin[3],-se+pt+this.ctx.prevPageLastElemOffset),A.call(this,"fill",!0),this.path=he}var ke=JSON.parse(JSON.stringify(gt));ke=w([ke],this.posX+this.margin[3],-se+pt+this.ctx.prevPageLastElemOffset)[0];var be=(Ze>ye||Ze<ze)&&y.call(this);be&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],xe,de,null).clip().discardPath()),this.pdf.addImage(R,"JPEG",ke.x,ke.y,ke.w,ke.h,null,null,Oe),be&&this.pdf.restoreGraphicsState()}else this.pdf.addImage(R,"JPEG",gt.x,gt.y,gt.w,gt.h,null,null,Oe)};var p=function(R,q,F){var G=[];q=q||this.pdf.internal.pageSize.width,F=F||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var ee=this.posY+this.ctx.prevPageLastElemOffset;switch(R.type){default:case"mt":case"lt":G.push(Math.floor((R.y+ee)/F)+1);break;case"arc":G.push(Math.floor((R.y+ee-R.radius)/F)+1),G.push(Math.floor((R.y+ee+R.radius)/F)+1);break;case"qct":var ae=E(this.ctx.lastPoint.x,this.ctx.lastPoint.y,R.x1,R.y1,R.x,R.y);G.push(Math.floor((ae.y+ee)/F)+1),G.push(Math.floor((ae.y+ae.h+ee)/F)+1);break;case"bct":var re=H(this.ctx.lastPoint.x,this.ctx.lastPoint.y,R.x1,R.y1,R.x2,R.y2,R.x,R.y);G.push(Math.floor((re.y+ee)/F)+1),G.push(Math.floor((re.y+re.h+ee)/F)+1);break;case"rect":G.push(Math.floor((R.y+ee)/F)+1),G.push(Math.floor((R.y+R.h+ee)/F)+1)}for(var Q=0;Q<G.length;Q+=1)for(;this.pdf.internal.getNumberOfPages()<G[Q];)g.call(this);return G},g=function(){var R=this.fillStyle,q=this.strokeStyle,F=this.font,G=this.lineCap,ee=this.lineWidth,ae=this.lineJoin;this.pdf.addPage(),this.fillStyle=R,this.strokeStyle=q,this.font=F,this.lineCap=G,this.lineWidth=ee,this.lineJoin=ae},w=function(R,q,F){for(var G=0;G<R.length;G++)switch(R[G].type){case"bct":R[G].x2+=q,R[G].y2+=F;case"qct":R[G].x1+=q,R[G].y1+=F;default:R[G].x+=q,R[G].y+=F}return R},v=function(R){return R.sort(function(q,F){return q-F})},N=function(R,q){for(var F,G,ee=this.fillStyle,ae=this.strokeStyle,re=this.lineCap,Q=this.lineWidth,fe=Math.abs(Q*this.ctx.transform.scaleX),Se=this.lineJoin,oe=JSON.parse(JSON.stringify(this.path)),pe=JSON.parse(JSON.stringify(this.path)),me=[],ne=0;ne<pe.length;ne++)if(pe[ne].x!==void 0)for(var it=p.call(this,pe[ne]),$e=0;$e<it.length;$e+=1)me.indexOf(it[$e])===-1&&me.push(it[$e]);for(var Oe=0;Oe<me.length;Oe++)for(;this.pdf.internal.getNumberOfPages()<me[Oe];)g.call(this);if(v(me),this.autoPaging)for(var qe=me[0],gt=me[me.length-1],ut=qe;ut<gt+1;ut++){this.pdf.setPage(ut),this.fillStyle=ee,this.strokeStyle=ae,this.lineCap=re,this.lineWidth=fe,this.lineJoin=Se;var Rt=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Nt=ut===1?this.posY+this.margin[0]:this.margin[0],ye=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],ze=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],Ze=ut===1?0:ye+(ut-2)*ze;if(this.ctx.clip_path.length!==0){var xe=this.path;F=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=w(F,this.posX+this.margin[3],-Ze+Nt+this.ctx.prevPageLastElemOffset),A.call(this,R,!0),this.path=xe}if(G=JSON.parse(JSON.stringify(oe)),this.path=w(G,this.posX+this.margin[3],-Ze+Nt+this.ctx.prevPageLastElemOffset),q===!1||ut===0){var pt=(ut>qe||ut<gt)&&y.call(this);pt&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Rt,ze,null).clip().discardPath()),A.call(this,R,q),pt&&this.pdf.restoreGraphicsState()}this.lineWidth=Q}else this.lineWidth=fe,A.call(this,R,q),this.lineWidth=Q;this.path=oe},A=function(R,q){if((R!=="stroke"||q||!x.call(this))&&(R==="stroke"||q||!h.call(this))){for(var F,G,ee=[],ae=this.path,re=0;re<ae.length;re++){var Q=ae[re];switch(Q.type){case"begin":ee.push({begin:!0});break;case"close":ee.push({close:!0});break;case"mt":ee.push({start:Q,deltas:[],abs:[]});break;case"lt":var fe=ee.length;if(ae[re-1]&&!isNaN(ae[re-1].x)&&(F=[Q.x-ae[re-1].x,Q.y-ae[re-1].y],fe>0)){for(;fe>=0;fe--)if(ee[fe-1].close!==!0&&ee[fe-1].begin!==!0){ee[fe-1].deltas.push(F),ee[fe-1].abs.push(Q);break}}break;case"bct":F=[Q.x1-ae[re-1].x,Q.y1-ae[re-1].y,Q.x2-ae[re-1].x,Q.y2-ae[re-1].y,Q.x-ae[re-1].x,Q.y-ae[re-1].y],ee[ee.length-1].deltas.push(F);break;case"qct":var Se=ae[re-1].x+2/3*(Q.x1-ae[re-1].x),oe=ae[re-1].y+2/3*(Q.y1-ae[re-1].y),pe=Q.x+2/3*(Q.x1-Q.x),me=Q.y+2/3*(Q.y1-Q.y),ne=Q.x,it=Q.y;F=[Se-ae[re-1].x,oe-ae[re-1].y,pe-ae[re-1].x,me-ae[re-1].y,ne-ae[re-1].x,it-ae[re-1].y],ee[ee.length-1].deltas.push(F);break;case"arc":ee.push({deltas:[],abs:[],arc:!0}),Array.isArray(ee[ee.length-1].abs)&&ee[ee.length-1].abs.push(Q)}}G=q?null:R==="stroke"?"stroke":"fill";for(var $e=!1,Oe=0;Oe<ee.length;Oe++)if(ee[Oe].arc)for(var qe=ee[Oe].abs,gt=0;gt<qe.length;gt++){var ut=qe[gt];ut.type==="arc"?M.call(this,ut.x,ut.y,ut.radius,ut.startAngle,ut.endAngle,ut.counterclockwise,void 0,q,!$e):B.call(this,ut.x,ut.y),$e=!0}else if(ee[Oe].close===!0)this.pdf.internal.out("h"),$e=!1;else if(ee[Oe].begin!==!0){var Rt=ee[Oe].start.x,Nt=ee[Oe].start.y;$.call(this,ee[Oe].deltas,Rt,Nt),$e=!0}G&&S.call(this,G),q&&C.call(this)}},P=function(R){var q=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,F=q*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return R-F;case"top":return R+q-F;case"hanging":return R+q-2*F;case"middle":return R+q/2-F;default:return R}},U=function(R){return R+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};f.prototype.createLinearGradient=function(){var R=function(){};return R.colorStops=[],R.addColorStop=function(q,F){this.colorStops.push([q,F])},R.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},R.isCanvasGradient=!0,R},f.prototype.createPattern=function(){return this.createLinearGradient()},f.prototype.createRadialGradient=function(){return this.createLinearGradient()};var M=function(R,q,F,G,ee,ae,re,Q,fe){for(var Se=L.call(this,F,G,ee,ae),oe=0;oe<Se.length;oe++){var pe=Se[oe];oe===0&&(fe?_.call(this,pe.x1+R,pe.y1+q):B.call(this,pe.x1+R,pe.y1+q)),D.call(this,R,q,pe.x2,pe.y2,pe.x3,pe.y3,pe.x4,pe.y4)}Q?C.call(this):S.call(this,re)},S=function(R){switch(R){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},C=function(){this.pdf.clip(),this.pdf.discardPath()},_=function(R,q){this.pdf.internal.out(n(R)+" "+r(q)+" m")},T=function(R){var q;switch(R.align){case"right":case"end":q="right";break;case"center":q="center";break;default:q="left"}var F=this.pdf.getTextDimensions(R.text),G=P.call(this,R.y),ee=U.call(this,G)-F.h,ae=this.ctx.transform.applyToPoint(new l(R.x,G)),re=this.ctx.transform.decompose(),Q=new c;Q=(Q=(Q=Q.multiply(re.translate)).multiply(re.skew)).multiply(re.scale);for(var fe,Se,oe,pe=this.ctx.transform.applyToRectangle(new o(R.x,G,F.w,F.h)),me=Q.applyToRectangle(new o(R.x,ee,F.w,F.h)),ne=p.call(this,me),it=[],$e=0;$e<ne.length;$e+=1)it.indexOf(ne[$e])===-1&&it.push(ne[$e]);if(v(it),this.autoPaging)for(var Oe=it[0],qe=it[it.length-1],gt=Oe;gt<qe+1;gt++){this.pdf.setPage(gt);var ut=gt===1?this.posY+this.margin[0]:this.margin[0],Rt=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Nt=this.pdf.internal.pageSize.height-this.margin[2],ye=Nt-this.margin[0],ze=this.pdf.internal.pageSize.width-this.margin[1],Ze=ze-this.margin[3],xe=gt===1?0:Rt+(gt-2)*ye;if(this.ctx.clip_path.length!==0){var pt=this.path;fe=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=w(fe,this.posX+this.margin[3],-1*xe+ut),A.call(this,"fill",!0),this.path=pt}var Ne=w([JSON.parse(JSON.stringify(me))],this.posX+this.margin[3],-xe+ut+this.ctx.prevPageLastElemOffset)[0];R.scale>=.01&&(Se=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Se*R.scale),oe=this.lineWidth,this.lineWidth=oe*R.scale);var de=this.autoPaging!=="text";if(de||Ne.y+Ne.h<=Nt){if(de||Ne.y>=ut&&Ne.x<=ze){var se=de?R.text:this.pdf.splitTextToSize(R.text,R.maxWidth||ze-Ne.x)[0],he=w([JSON.parse(JSON.stringify(pe))],this.posX+this.margin[3],-xe+ut+this.ctx.prevPageLastElemOffset)[0],ke=de&&(gt>Oe||gt<qe)&&y.call(this);ke&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],Ze,ye,null).clip().discardPath()),this.pdf.text(se,he.x,he.y,{angle:R.angle,align:q,renderingMode:R.renderingMode}),ke&&this.pdf.restoreGraphicsState()}}else Ne.y<Nt&&(this.ctx.prevPageLastElemOffset+=Nt-Ne.y);R.scale>=.01&&(this.pdf.setFontSize(Se),this.lineWidth=oe)}else R.scale>=.01&&(Se=this.pdf.internal.getFontSize(),this.pdf.setFontSize(Se*R.scale),oe=this.lineWidth,this.lineWidth=oe*R.scale),this.pdf.text(R.text,ae.x+this.posX,ae.y+this.posY,{angle:R.angle,align:q,renderingMode:R.renderingMode,maxWidth:R.maxWidth}),R.scale>=.01&&(this.pdf.setFontSize(Se),this.lineWidth=oe)},B=function(R,q,F,G){F=F||0,G=G||0,this.pdf.internal.out(n(R+F)+" "+r(q+G)+" l")},$=function(R,q,F){return this.pdf.lines(R,q,F,null,null)},D=function(R,q,F,G,ee,ae,re,Q){this.pdf.internal.out([t(s(F+R)),t(i(G+q)),t(s(ee+R)),t(i(ae+q)),t(s(re+R)),t(i(Q+q)),"c"].join(" "))},L=function(R,q,F,G){for(var ee=2*Math.PI,ae=Math.PI/2;q>F;)q-=ee;var re=Math.abs(F-q);re<ee&&G&&(re=ee-re);for(var Q=[],fe=G?-1:1,Se=q;re>1e-5;){var oe=Se+fe*Math.min(re,ae);Q.push(O.call(this,R,Se,oe)),re-=Math.abs(oe-Se),Se=oe}return Q},O=function(R,q,F){var G=(F-q)/2,ee=R*Math.cos(G),ae=R*Math.sin(G),re=ee,Q=-ae,fe=re*re+Q*Q,Se=fe+re*ee+Q*ae,oe=4/3*(Math.sqrt(2*fe*Se)-Se)/(re*ae-Q*ee),pe=re-oe*Q,me=Q+oe*re,ne=pe,it=-me,$e=G+q,Oe=Math.cos($e),qe=Math.sin($e);return{x1:R*Math.cos(q),y1:R*Math.sin(q),x2:pe*Oe-me*qe,y2:pe*qe+me*Oe,x3:ne*Oe-it*qe,y3:ne*qe+it*Oe,x4:R*Math.cos(F),y4:R*Math.sin(F)}},W=function(R){return 180*R/Math.PI},E=function(R,q,F,G,ee,ae){var re=R+.5*(F-R),Q=q+.5*(G-q),fe=ee+.5*(F-ee),Se=ae+.5*(G-ae),oe=Math.min(R,ee,re,fe),pe=Math.max(R,ee,re,fe),me=Math.min(q,ae,Q,Se),ne=Math.max(q,ae,Q,Se);return new o(oe,me,pe-oe,ne-me)},H=function(R,q,F,G,ee,ae,re,Q){var fe,Se,oe,pe,me,ne,it,$e,Oe,qe,gt,ut,Rt,Nt,ye=F-R,ze=G-q,Ze=ee-F,xe=ae-G,pt=re-ee,Ne=Q-ae;for(Se=0;Se<41;Se++)Oe=(it=(oe=R+(fe=Se/40)*ye)+fe*((me=F+fe*Ze)-oe))+fe*(me+fe*(ee+fe*pt-me)-it),qe=($e=(pe=q+fe*ze)+fe*((ne=G+fe*xe)-pe))+fe*(ne+fe*(ae+fe*Ne-ne)-$e),Se==0?(gt=Oe,ut=qe,Rt=Oe,Nt=qe):(gt=Math.min(gt,Oe),ut=Math.min(ut,qe),Rt=Math.max(Rt,Oe),Nt=Math.max(Nt,qe));return new o(Math.round(gt),Math.round(ut),Math.round(Rt-gt),Math.round(Nt-ut))},V=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var R,q,F=(R=this.ctx.lineDash,q=this.ctx.lineDashOffset,JSON.stringify({lineDash:R,lineDashOffset:q}));this.prevLineDash!==F&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=F)}}})(Zt.API),function(e){var t=function(l){var o,c,u,d,f,m,h,x,y,p;for(c=[],u=0,d=(l+=o="\0\0\0\0".slice(l.length%4||4)).length;d>u;u+=4)(f=(l.charCodeAt(u)<<24)+(l.charCodeAt(u+1)<<16)+(l.charCodeAt(u+2)<<8)+l.charCodeAt(u+3))!==0?(m=(f=((f=((f=((f=(f-(p=f%85))/85)-(y=f%85))/85)-(x=f%85))/85)-(h=f%85))/85)%85,c.push(m+33,h+33,x+33,y+33,p+33)):c.push(122);return function(g,w){for(var v=w;v>0;v--)g.pop()}(c,o.length),String.fromCharCode.apply(String,c)+"~>"},n=function(l){var o,c,u,d,f,m=String,h="length",x=255,y="charCodeAt",p="slice",g="replace";for(l[p](-2),l=l[p](0,-2)[g](/\s/g,"")[g]("z","!!!!!"),u=[],d=0,f=(l+=o="uuuuu"[p](l[h]%5||5))[h];f>d;d+=5)c=52200625*(l[y](d)-33)+614125*(l[y](d+1)-33)+7225*(l[y](d+2)-33)+85*(l[y](d+3)-33)+(l[y](d+4)-33),u.push(x&c>>24,x&c>>16,x&c>>8,x&c);return function(w,v){for(var N=v;N>0;N--)w.pop()}(u,o[h]),m.fromCharCode.apply(m,u)},r=function(l){return l.split("").map(function(o){return("0"+o.charCodeAt().toString(16)).slice(-2)}).join("")+">"},s=function(l){var o=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((l=l.replace(/\s/g,"")).indexOf(">")!==-1&&(l=l.substr(0,l.indexOf(">"))),l.length%2&&(l+="0"),o.test(l)===!1)return"";for(var c="",u=0;u<l.length;u+=2)c+=String.fromCharCode("0x"+(l[u]+l[u+1]));return c},i=function(l){for(var o=new Uint8Array(l.length),c=l.length;c--;)o[c]=l.charCodeAt(c);return(o=R2(o)).reduce(function(u,d){return u+String.fromCharCode(d)},"")};e.processDataByFilters=function(l,o){var c=0,u=l||"",d=[];for(typeof(o=o||[])=="string"&&(o=[o]),c=0;c<o.length;c+=1)switch(o[c]){case"ASCII85Decode":case"/ASCII85Decode":u=n(u),d.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":u=t(u),d.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":u=s(u),d.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":u=r(u),d.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":u=i(u),d.push("/FlateDecode");break;default:throw new Error('The filter: "'+o[c]+'" is not implemented')}return{data:u,reverseChain:d.reverse().join(" ")}}}(Zt.API),function(e){e.loadFile=function(t,n,r){return function(s,i,l){i=i!==!1,l=typeof l=="function"?l:function(){};var o=void 0;try{o=function(c,u,d){var f=new XMLHttpRequest,m=0,h=function(x){var y=x.length,p=[],g=String.fromCharCode;for(m=0;m<y;m+=1)p.push(g(255&x.charCodeAt(m)));return p.join("")};if(f.open("GET",c,!u),f.overrideMimeType("text/plain; charset=x-user-defined"),u===!1&&(f.onload=function(){f.status===200?d(h(this.responseText)):d(void 0)}),f.send(null),u&&f.status===200)return h(f.responseText)}(s,i,l)}catch{}return o}(t,n,r)},e.loadImageFile=e.loadFile}(Zt.API),function(e){function t(){return(fn.html2canvas?Promise.resolve(fn.html2canvas):np(()=>import("./html2canvas.esm-CBrSDip1.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load html2canvas: "+o))}).then(function(o){return o.default?o.default:o})}function n(){return(fn.DOMPurify?Promise.resolve(fn.DOMPurify):np(()=>import("./purify.es-aGzT-_H7.js"),[])).catch(function(o){return Promise.reject(new Error("Could not load dompurify: "+o))}).then(function(o){return o.default?o.default:o})}var r=function(o){var c=Kn(o);return c==="undefined"?"undefined":c==="string"||o instanceof String?"string":c==="number"||o instanceof Number?"number":c==="function"||o instanceof Function?"function":o&&o.constructor===Array?"array":o&&o.nodeType===1?"element":c==="object"?"object":"unknown"},s=function(o,c){var u=document.createElement(o);for(var d in c.className&&(u.className=c.className),c.innerHTML&&c.dompurify&&(u.innerHTML=c.dompurify.sanitize(c.innerHTML)),c.style)u.style[d]=c.style[d];return u},i=function o(c,u){for(var d=c.nodeType===3?document.createTextNode(c.nodeValue):c.cloneNode(!1),f=c.firstChild;f;f=f.nextSibling)u!==!0&&f.nodeType===1&&f.nodeName==="SCRIPT"||d.appendChild(o(f,u));return c.nodeType===1&&(c.nodeName==="CANVAS"?(d.width=c.width,d.height=c.height,d.getContext("2d").drawImage(c,0,0)):c.nodeName!=="TEXTAREA"&&c.nodeName!=="SELECT"||(d.value=c.value),d.addEventListener("load",function(){d.scrollTop=c.scrollTop,d.scrollLeft=c.scrollLeft},!0)),d},l=function o(c){var u=Object.assign(o.convert(Promise.resolve()),JSON.parse(JSON.stringify(o.template))),d=o.convert(Promise.resolve(),u);return(d=d.setProgress(1,o,1,[o])).set(c)};(l.prototype=Object.create(Promise.prototype)).constructor=l,l.convert=function(o,c){return o.__proto__=c||l.prototype,o},l.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},l.prototype.from=function(o,c){return this.then(function(){switch(c=c||function(u){switch(r(u)){case"string":return"string";case"element":return u.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}}(o),c){case"string":return this.then(n).then(function(u){return this.set({src:s("div",{innerHTML:o,dompurify:u})})});case"element":return this.set({src:o});case"canvas":return this.set({canvas:o});case"img":return this.set({img:o});default:return this.error("Unknown source type.")}})},l.prototype.to=function(o){switch(o){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},l.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var o={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},c=i(this.prop.src,this.opt.html2canvas.javascriptEnabled);c.tagName==="BODY"&&(o.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=s("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=s("div",{className:"html2pdf__container",style:o}),this.prop.container.appendChild(c),this.prop.container.firstChild.appendChild(s("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},l.prototype.toCanvas=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(c){var u=Object.assign({},this.opt.html2canvas);return delete u.onrendered,c(this.prop.container,u)}).then(function(c){(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},l.prototype.toContext2d=function(){var o=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(o).then(t).then(function(c){var u=this.opt.jsPDF,d=this.opt.fontFaces,f=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,m=Object.assign({async:!0,allowTaint:!0,scale:f,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete m.onrendered,u.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,u.context2d.posX=this.opt.x,u.context2d.posY=this.opt.y,u.context2d.margin=this.opt.margin,u.context2d.fontFaces=d,d)for(var h=0;h<d.length;++h){var x=d[h],y=x.src.find(function(p){return p.format==="truetype"});y&&u.addFont(y.url,x.ref.name,x.ref.style)}return m.windowHeight=m.windowHeight||0,m.windowHeight=m.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):m.windowHeight,u.context2d.save(!0),c(this.prop.container,m)}).then(function(c){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(c),this.prop.canvas=c,document.body.removeChild(this.prop.overlay)})},l.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var o=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=o})},l.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},l.prototype.output=function(o,c,u){return(u=u||"pdf").toLowerCase()==="img"||u.toLowerCase()==="image"?this.outputImg(o,c):this.outputPdf(o,c)},l.prototype.outputPdf=function(o,c){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(o,c)})},l.prototype.outputImg=function(o){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(o){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+o+'" is not supported.'}})},l.prototype.save=function(o){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(o?{filename:o}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},l.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},l.prototype.set=function(o){if(r(o)!=="object")return this;var c=Object.keys(o||{}).map(function(u){if(u in l.template.prop)return function(){this.prop[u]=o[u]};switch(u){case"margin":return this.setMargin.bind(this,o.margin);case"jsPDF":return function(){return this.opt.jsPDF=o.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,o.pageSize);default:return function(){this.opt[u]=o[u]}}},this);return this.then(function(){return this.thenList(c)})},l.prototype.get=function(o,c){return this.then(function(){var u=o in l.template.prop?this.prop[o]:this.opt[o];return c?c(u):u})},l.prototype.setMargin=function(o){return this.then(function(){switch(r(o)){case"number":o=[o,o,o,o];case"array":if(o.length===2&&(o=[o[0],o[1],o[0],o[1]]),o.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=o}).then(this.setPageSize)},l.prototype.setPageSize=function(o){function c(u,d){return Math.floor(u*d/72*96)}return this.then(function(){(o=o||Zt.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(o.inner={width:o.width-this.opt.margin[1]-this.opt.margin[3],height:o.height-this.opt.margin[0]-this.opt.margin[2]},o.inner.px={width:c(o.inner.width,o.k),height:c(o.inner.height,o.k)},o.inner.ratio=o.inner.height/o.inner.width),this.prop.pageSize=o})},l.prototype.setProgress=function(o,c,u,d){return o!=null&&(this.progress.val=o),c!=null&&(this.progress.state=c),u!=null&&(this.progress.n=u),d!=null&&(this.progress.stack=d),this.progress.ratio=this.progress.val/this.progress.state,this},l.prototype.updateProgress=function(o,c,u,d){return this.setProgress(o?this.progress.val+o:null,c||null,u?this.progress.n+u:null,d?this.progress.stack.concat(d):null)},l.prototype.then=function(o,c){var u=this;return this.thenCore(o,c,function(d,f){return u.updateProgress(null,null,1,[d]),Promise.prototype.then.call(this,function(m){return u.updateProgress(null,d),m}).then(d,f).then(function(m){return u.updateProgress(1),m})})},l.prototype.thenCore=function(o,c,u){u=u||Promise.prototype.then;var d=this;o&&(o=o.bind(d)),c&&(c=c.bind(d));var f=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?d:l.convert(Object.assign({},d),Promise.prototype),m=u.call(f,o,c);return l.convert(m,d.__proto__)},l.prototype.thenExternal=function(o,c){return Promise.prototype.then.call(this,o,c)},l.prototype.thenList=function(o){var c=this;return o.forEach(function(u){c=c.thenCore(u)}),c},l.prototype.catch=function(o){o&&(o=o.bind(this));var c=Promise.prototype.catch.call(this,o);return l.convert(c,this)},l.prototype.catchExternal=function(o){return Promise.prototype.catch.call(this,o)},l.prototype.error=function(o){return this.then(function(){throw new Error(o)})},l.prototype.using=l.prototype.set,l.prototype.saveAs=l.prototype.save,l.prototype.export=l.prototype.output,l.prototype.run=l.prototype.then,Zt.getPageSize=function(o,c,u){if(Kn(o)==="object"){var d=o;o=d.orientation,c=d.unit||c,u=d.format||u}c=c||"mm",u=u||"a4",o=(""+(o||"P")).toLowerCase();var f,m=(""+u).toLowerCase(),h={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(c){case"pt":f=1;break;case"mm":f=72/25.4;break;case"cm":f=72/2.54;break;case"in":f=72;break;case"px":f=.75;break;case"pc":case"em":f=12;break;case"ex":f=6;break;default:throw"Invalid unit: "+c}var x,y=0,p=0;if(h.hasOwnProperty(m))y=h[m][1]/f,p=h[m][0]/f;else try{y=u[1],p=u[0]}catch{throw new Error("Invalid format: "+u)}if(o==="p"||o==="portrait")o="p",p>y&&(x=p,p=y,y=x);else{if(o!=="l"&&o!=="landscape")throw"Invalid orientation: "+o;o="l",y>p&&(x=p,p=y,y=x)}return{width:p,height:y,unit:c,k:f,orientation:o}},e.html=function(o,c){(c=c||{}).callback=c.callback||function(){},c.html2canvas=c.html2canvas||{},c.html2canvas.canvas=c.html2canvas.canvas||this.canvas,c.jsPDF=c.jsPDF||this,c.fontFaces=c.fontFaces?c.fontFaces.map(rx):null;var u=new l(c);return c.worker?u:u.from(o).doCallback()}}(Zt.API),Zt.API.addJS=function(e){return D3=e,this.internal.events.subscribe("postPutResources",function(){Mm=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Mm+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),O3=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+D3+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Mm!==void 0&&O3!==void 0&&this.internal.out("/Names <</JavaScript "+Mm+" 0 R>>")}),this},function(e){var t;e.events.push(["postPutResources",function(){var n=this,r=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var s=n.outline.render().split(/\r\n/),i=0;i<s.length;i++){var l=s[i],o=r.exec(l);if(o!=null){var c=o[1];n.internal.newObjectDeferredBegin(c,!1)}n.internal.write(l)}if(this.outline.createNamedDestinations){var u=this.internal.pages.length,d=[];for(i=0;i<u;i++){var f=n.internal.newObject();d.push(f);var m=n.internal.getPageInfo(i+1);n.internal.write("<< /D["+m.objId+" 0 R /XYZ null null null]>> endobj")}var h=n.internal.newObject();for(n.internal.write("<< /Names [ "),i=0;i<d.length;i++)n.internal.write("(page_"+(i+1)+")"+d[i]+" 0 R");n.internal.write(" ] >>","endobj"),t=n.internal.newObject(),n.internal.write("<< /Dests "+h+" 0 R"),n.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var n=this;n.outline.root.children.length>0&&(n.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&n.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var n=this;n.outline={createNamedDestinations:!1,root:{children:[]}},n.outline.add=function(r,s,i){var l={title:s,options:i,children:[]};return r==null&&(r=this.root),r.children.push(l),l},n.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=n,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},n.outline.genIds_r=function(r){r.id=n.internal.newObjectDeferred();for(var s=0;s<r.children.length;s++)this.genIds_r(r.children[s])},n.outline.renderRoot=function(r){this.objStart(r),this.line("/Type /Outlines"),r.children.length>0&&(this.line("/First "+this.makeRef(r.children[0])),this.line("/Last "+this.makeRef(r.children[r.children.length-1]))),this.line("/Count "+this.count_r({count:0},r)),this.objEnd()},n.outline.renderItems=function(r){for(var s=this.ctx.pdf.internal.getVerticalCoordinateString,i=0;i<r.children.length;i++){var l=r.children[i];this.objStart(l),this.line("/Title "+this.makeString(l.title)),this.line("/Parent "+this.makeRef(r)),i>0&&this.line("/Prev "+this.makeRef(r.children[i-1])),i<r.children.length-1&&this.line("/Next "+this.makeRef(r.children[i+1])),l.children.length>0&&(this.line("/First "+this.makeRef(l.children[0])),this.line("/Last "+this.makeRef(l.children[l.children.length-1])));var o=this.count=this.count_r({count:0},l);if(o>0&&this.line("/Count "+o),l.options&&l.options.pageNumber){var c=n.internal.getPageInfo(l.options.pageNumber);this.line("/Dest ["+c.objId+" 0 R /XYZ 0 "+s(0)+" 0]")}this.objEnd()}for(var u=0;u<r.children.length;u++)this.renderItems(r.children[u])},n.outline.line=function(r){this.ctx.val+=r+`\r
`},n.outline.makeRef=function(r){return r.id+" 0 R"},n.outline.makeString=function(r){return"("+n.internal.pdfEscape(r)+")"},n.outline.objStart=function(r){this.ctx.val+=`\r
`+r.id+` 0 obj\r
<<\r
`},n.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},n.outline.count_r=function(r,s){for(var i=0;i<s.children.length;i++)r.count++,this.count_r(r,s.children[i]);return r.count}}])}(Zt.API),function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(n,r,s,i,l,o){var c,u=this.decode.DCT_DECODE,d=null;if(typeof n=="string"||this.__addimage__.isArrayBuffer(n)||this.__addimage__.isArrayBufferView(n)){switch(n=l||n,n=this.__addimage__.isArrayBuffer(n)?new Uint8Array(n):n,c=function(f){for(var m,h=256*f.charCodeAt(4)+f.charCodeAt(5),x=f.length,y={width:0,height:0,numcomponents:1},p=4;p<x;p+=2){if(p+=h,t.indexOf(f.charCodeAt(p+1))!==-1){m=256*f.charCodeAt(p+5)+f.charCodeAt(p+6),y={width:256*f.charCodeAt(p+7)+f.charCodeAt(p+8),height:m,numcomponents:f.charCodeAt(p+9)};break}h=256*f.charCodeAt(p+2)+f.charCodeAt(p+3)}return y}(n=this.__addimage__.isArrayBufferView(n)?this.__addimage__.arrayBufferToBinaryString(n):n),c.numcomponents){case 1:o=this.color_spaces.DEVICE_GRAY;break;case 4:o=this.color_spaces.DEVICE_CMYK;break;case 3:o=this.color_spaces.DEVICE_RGB}d={data:n,width:c.width,height:c.height,colorSpace:o,bitsPerComponent:8,filter:u,index:r,alias:s}}return d}}(Zt.API),Zt.API.processPNG=function(e,t,n,r){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var s,i=SK(e,{checkCrc:!0}),l=i.width,o=i.height,c=i.channels,u=i.palette,d=i.depth;s=u&&c===1?function(M){for(var S=M.width,C=M.height,_=M.data,T=M.palette,B=M.depth,$=!1,D=[],L=[],O=void 0,W=!1,E=0,H=0;H<T.length;H++){var V=qN(T[H],4),R=V[0],q=V[1],F=V[2],G=V[3];D.push(R,q,F),G!=null&&(G===0?(E++,L.length<1&&L.push(H)):G<255&&(W=!0))}if(W||E>1){$=!0,L=void 0;var ee=S*C;O=new Uint8Array(ee);for(var ae=new DataView(_.buffer),re=0;re<ee;re++){var Q=ix(ae,re,B),fe=qN(T[Q],4)[3];O[re]=fe}}else E===0&&(L=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:$?8:void 0,colorBytes:_,alphaBytes:O,needSMask:$,palette:D,mask:L}}(i):c===2||c===4?function(M){for(var S=M.data,C=M.width,_=M.height,T=M.channels,B=M.depth,$=T===2?"DeviceGray":"DeviceRGB",D=T-1,L=C*_,O=D,W=L*O,E=1*L,H=Math.ceil(W*B/8),V=Math.ceil(E*B/8),R=new Uint8Array(H),q=new Uint8Array(V),F=new DataView(S.buffer),G=new DataView(R.buffer),ee=new DataView(q.buffer),ae=!1,re=0;re<L;re++){for(var Q=re*T,fe=0;fe<O;fe++)Y3(G,ix(F,Q+fe,B),re*O+fe,B);var Se=ix(F,Q+O,B);Se<(1<<B)-1&&(ae=!0),Y3(ee,Se,1*re,B)}return{colorSpace:$,colorsPerPixel:D,sMaskBitsPerComponent:ae?B:void 0,colorBytes:R,alphaBytes:q,needSMask:ae}}(i):function(M){var S=M.data,C=M.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:C,colorsPerPixel:C==="DeviceGray"?1:3,colorBytes:S instanceof Uint16Array?function(_){for(var T=_.length,B=new Uint8Array(2*T),$=new DataView(B.buffer,B.byteOffset,B.byteLength),D=0;D<T;D++)$.setUint16(2*D,_[D],!1);return B}(S):S,needSMask:!1}}(i);var f,m,h,x=s,y=x.colorSpace,p=x.colorsPerPixel,g=x.sMaskBitsPerComponent,w=x.colorBytes,v=x.alphaBytes,N=x.needSMask,A=x.palette,P=x.mask,U=null;return r!==Zt.API.image_compression.NONE&&typeof R2=="function"?(U=function(M){var S;switch(M){case Zt.API.image_compression.FAST:S=11;break;case Zt.API.image_compression.MEDIUM:S=13;break;case Zt.API.image_compression.SLOW:S=14;break;default:S=12}return S}(r),f=this.decode.FLATE_DECODE,m="/Predictor ".concat(U," /Colors ").concat(p," /BitsPerComponent ").concat(d," /Columns ").concat(l),e=q3(w,Math.ceil(l*p*d/8),p,d,r),N&&(h=q3(v,Math.ceil(l*g/8),1,g,r))):(f=void 0,m=void 0,e=w,N&&(h=v)),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(h&&this.__addimage__.isArrayBuffer(h)||this.__addimage__.isArrayBufferView(h))&&(h=this.__addimage__.arrayBufferToBinaryString(h)),{alias:n,data:e,index:t,filter:f,decodeParameters:m,transparency:P,palette:A,sMask:h,predictor:U,width:l,height:o,bitsPerComponent:d,sMaskBitsPerComponent:g,colorSpace:y}}},function(e){e.processGIF89A=function(t,n,r,s){var i=new WK(t),l=i.width,o=i.height,c=[];i.decodeAndBlitFrameRGBA(0,c);var u={data:c,width:l,height:o},d=new ax(100).encode(u,100);return e.processJPEG.call(this,d,n,r,s)},e.processGIF87A=e.processGIF89A}(Zt.API),Ji.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var n=this.datav.getUint8(this.pos++,!0),r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:s,green:r,blue:n,quad:i}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},Ji.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(n){rr.log("bit decode error:"+n)}},Ji.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),n=t%4;for(e=this.height-1;e>=0;e--){for(var r=this.bottom_up?e:this.height-1-e,s=0;s<t;s++)for(var i=this.datav.getUint8(this.pos++,!0),l=r*this.width*4+8*s*4,o=0;o<8&&8*s+o<this.width;o++){var c=this.palette[i>>7-o&1];this.data[l+4*o]=c.blue,this.data[l+4*o+1]=c.green,this.data[l+4*o+2]=c.red,this.data[l+4*o+3]=255}n!==0&&(this.pos+=4-n)}},Ji.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,s=0;s<e;s++){var i=this.datav.getUint8(this.pos++,!0),l=r*this.width*4+2*s*4,o=i>>4,c=15&i,u=this.palette[o];if(this.data[l]=u.blue,this.data[l+1]=u.green,this.data[l+2]=u.red,this.data[l+3]=255,2*s+1>=this.width)break;u=this.palette[c],this.data[l+4]=u.blue,this.data[l+4+1]=u.green,this.data[l+4+2]=u.red,this.data[l+4+3]=255}t!==0&&(this.pos+=4-t)}},Ji.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var n=this.bottom_up?t:this.height-1-t,r=0;r<this.width;r++){var s=this.datav.getUint8(this.pos++,!0),i=n*this.width*4+4*r;if(s<this.palette.length){var l=this.palette[s];this.data[i]=l.red,this.data[i+1]=l.green,this.data[i+2]=l.blue,this.data[i+3]=255}else this.data[i]=255,this.data[i+1]=255,this.data[i+2]=255,this.data[i+3]=255}e!==0&&(this.pos+=4-e)}},Ji.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),n=this.height-1;n>=0;n--){for(var r=this.bottom_up?n:this.height-1-n,s=0;s<this.width;s++){var i=this.datav.getUint16(this.pos,!0);this.pos+=2;var l=(i&t)/t*255|0,o=(i>>5&t)/t*255|0,c=(i>>10&t)/t*255|0,u=i>>15?255:0,d=r*this.width*4+4*s;this.data[d]=c,this.data[d+1]=o,this.data[d+2]=l,this.data[d+3]=u}this.pos+=e}},Ji.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),n=parseInt("111111",2),r=this.height-1;r>=0;r--){for(var s=this.bottom_up?r:this.height-1-r,i=0;i<this.width;i++){var l=this.datav.getUint16(this.pos,!0);this.pos+=2;var o=(l&t)/t*255|0,c=(l>>5&n)/n*255|0,u=(l>>11)/t*255|0,d=s*this.width*4+4*i;this.data[d]=u,this.data[d+1]=c,this.data[d+2]=o,this.data[d+3]=255}this.pos+=e}},Ji.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),l=t*this.width*4+4*n;this.data[l]=i,this.data[l+1]=s,this.data[l+2]=r,this.data[l+3]=255}this.pos+=this.width%4}},Ji.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,n=0;n<this.width;n++){var r=this.datav.getUint8(this.pos++,!0),s=this.datav.getUint8(this.pos++,!0),i=this.datav.getUint8(this.pos++,!0),l=this.datav.getUint8(this.pos++,!0),o=t*this.width*4+4*n;this.data[o]=i,this.data[o+1]=s,this.data[o+2]=r,this.data[o+3]=l}},Ji.prototype.getData=function(){return this.data},function(e){e.processBMP=function(t,n,r,s){var i=new Ji(t,!1),l=i.width,o=i.height,c={data:i.getData(),width:l,height:o},u=new ax(100).encode(c,100);return e.processJPEG.call(this,u,n,r,s)}}(Zt.API),Z3.prototype.getData=function(){return this.data},function(e){e.processWEBP=function(t,n,r,s){var i=new Z3(t),l=i.width,o=i.height,c={data:i.getData(),width:l,height:o},u=new ax(100).encode(c,100);return e.processJPEG.call(this,u,n,r,s)}}(Zt.API),Zt.API.processRGBA=function(e,t,n){for(var r=e.data,s=r.length,i=new Uint8Array(s/4*3),l=new Uint8Array(s/4),o=0,c=0,u=0;u<s;u+=4){var d=r[u],f=r[u+1],m=r[u+2],h=r[u+3];i[o++]=d,i[o++]=f,i[o++]=m,l[c++]=h}var x=this.__addimage__.arrayBufferToBinaryString(i);return{alpha:this.__addimage__.arrayBufferToBinaryString(l),data:x,index:t,alias:n,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},Zt.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Kc=Zt.API,Rm=Kc.getCharWidthsArray=function(e,t){var n,r,s=(t=t||{}).font||this.internal.getFont(),i=t.fontSize||this.internal.getFontSize(),l=t.charSpace||this.internal.getCharSpace(),o=t.widths?t.widths:s.metadata.Unicode.widths,c=o.fof?o.fof:1,u=t.kerning?t.kerning:s.metadata.Unicode.kerning,d=u.fof?u.fof:1,f=t.doKerning!==!1,m=0,h=e.length,x=0,y=o[0]||c,p=[];for(n=0;n<h;n++)r=e.charCodeAt(n),typeof s.metadata.widthOfString=="function"?p.push((s.metadata.widthOfGlyph(s.metadata.characterToGlyph(r))+l*(1e3/i)||0)/1e3):(m=f&&Kn(u[r])==="object"&&!isNaN(parseInt(u[r][x],10))?u[r][x]/d:0,p.push((o[r]||y)/c+m)),x=r;return p},B3=Kc.getStringUnitWidth=function(e,t){var n=(t=t||{}).fontSize||this.internal.getFontSize(),r=t.font||this.internal.getFont(),s=t.charSpace||this.internal.getCharSpace();return Kc.processArabic&&(e=Kc.processArabic(e)),typeof r.metadata.widthOfString=="function"?r.metadata.widthOfString(e,n,s)/n:Rm.apply(this,arguments).reduce(function(i,l){return i+l},0)},z3=function(e,t,n,r){for(var s=[],i=0,l=e.length,o=0;i!==l&&o+t[i]<n;)o+=t[i],i++;s.push(e.slice(0,i));var c=i;for(o=0;i!==l;)o+t[i]>r&&(s.push(e.slice(c,i)),o=0,c=i),o+=t[i],i++;return c!==i&&s.push(e.slice(c,i)),s},U3=function(e,t,n){n||(n={});var r,s,i,l,o,c,u,d=[],f=[d],m=n.textIndent||0,h=0,x=0,y=e.split(" "),p=Rm.apply(this,[" ",n])[0];if(c=n.lineIndent===-1?y[0].length+2:n.lineIndent||0){var g=Array(c).join(" "),w=[];y.map(function(N){(N=N.split(/\s*\n/)).length>1?w=w.concat(N.map(function(A,P){return(P&&A.length?`
`:"")+A})):w.push(N[0])}),y=w,c=B3.apply(this,[g,n])}for(i=0,l=y.length;i<l;i++){var v=0;if(r=y[i],c&&r[0]==`
`&&(r=r.substr(1),v=1),m+h+(x=(s=Rm.apply(this,[r,n])).reduce(function(N,A){return N+A},0))>t||v){if(x>t){for(o=z3.apply(this,[r,s,t-(m+h),t]),d.push(o.shift()),d=[o.pop()];o.length;)f.push([o.shift()]);x=s.slice(r.length-(d[0]?d[0].length:0)).reduce(function(N,A){return N+A},0)}else d=[r];f.push(d),m=x+c,h=p}else d.push(r),m+=h+x,h=p}return u=c?function(N,A){return(A?g:"")+N.join(" ")}:function(N){return N.join(" ")},f.map(u)},Kc.splitTextToSize=function(e,t,n){var r,s=(n=n||{}).fontSize||this.internal.getFontSize(),i=(function(d){if(d.widths&&d.kerning)return{widths:d.widths,kerning:d.kerning};var f=this.internal.getFont(d.fontName,d.fontStyle),m="Unicode";return f.metadata[m]?{widths:f.metadata[m].widths||{0:1},kerning:f.metadata[m].kerning||{}}:{font:f.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,n);r=Array.isArray(e)?e:String(e).split(/\r?\n/);var l=1*this.internal.scaleFactor*t/s;i.textIndent=n.textIndent?1*n.textIndent*this.internal.scaleFactor/s:0,i.lineIndent=n.lineIndent;var o,c,u=[];for(o=0,c=r.length;o<c;o++)u=u.concat(U3.apply(this,[r[o],l,i]));return u},function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",n="klmnopqrstuvwxyz",r={},s={},i=0;i<16;i++)r[n[i]]=t[i],s[t[i]]=n[i];var l=function(m){return"0x"+parseInt(m,10).toString(16)},o=e.__fontmetrics__.compress=function(m){var h,x,y,p,g=["{"];for(var w in m){if(h=m[w],isNaN(parseInt(w,10))?x="'"+w+"'":(w=parseInt(w,10),x=(x=l(w).slice(2)).slice(0,-1)+s[x.slice(-1)]),typeof h=="number")h<0?(y=l(h).slice(3),p="-"):(y=l(h).slice(2),p=""),y=p+y.slice(0,-1)+s[y.slice(-1)];else{if(Kn(h)!=="object")throw new Error("Don't know what to do with value type "+Kn(h)+".");y=o(h)}g.push(x+y)}return g.push("}"),g.join("")},c=e.__fontmetrics__.uncompress=function(m){if(typeof m!="string")throw new Error("Invalid argument passed to uncompress.");for(var h,x,y,p,g={},w=1,v=g,N=[],A="",P="",U=m.length-1,M=1;M<U;M+=1)(p=m[M])=="'"?h?(y=h.join(""),h=void 0):h=[]:h?h.push(p):p=="{"?(N.push([v,y]),v={},y=void 0):p=="}"?((x=N.pop())[0][x[1]]=v,y=void 0,v=x[0]):p=="-"?w=-1:y===void 0?r.hasOwnProperty(p)?(A+=r[p],y=parseInt(A,16)*w,w=1,A=""):A+=p:r.hasOwnProperty(p)?(P+=r[p],v[y]=parseInt(P,16)*w,w=1,y=void 0,P=""):P+=p;return g},u={codePages:["WinAnsiEncoding"],WinAnsiEncoding:c("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},d={Unicode:{Courier:u,"Courier-Bold":u,"Courier-BoldOblique":u,"Courier-Oblique":u,Helvetica:u,"Helvetica-Bold":u,"Helvetica-BoldOblique":u,"Helvetica-Oblique":u,"Times-Roman":u,"Times-Bold":u,"Times-BoldItalic":u,"Times-Italic":u}},f={Unicode:{"Courier-Oblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":c("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":c("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:c("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":c("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:c("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":c("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":c("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":c("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":c("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(m){var h=m.font,x=f.Unicode[h.postScriptName];x&&(h.metadata.Unicode={},h.metadata.Unicode.widths=x.widths,h.metadata.Unicode.kerning=x.kerning);var y=d.Unicode[h.postScriptName];y&&(h.metadata.Unicode.encoding=y,h.encoding=y.codePages[0])}])}(Zt.API),function(e){var t=function(n){for(var r=n.length,s=new Uint8Array(r),i=0;i<r;i++)s[i]=n.charCodeAt(i);return s};e.API.events.push(["addFont",function(n){var r=void 0,s=n.font,i=n.instance;if(!s.isStandardFont){if(i===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");if(typeof(r=i.existsFileInVFS(s.postScriptName)===!1?i.loadFile(s.postScriptName):i.getFileFromVFS(s.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+s.postScriptName+"').");(function(l,o){o=/^\x00\x01\x00\x00/.test(o)?t(o):t(sp(o)),l.metadata=e.API.TTFFont.open(o),l.metadata.Unicode=l.metadata.Unicode||{encoding:{},kerning:{},widths:[]},l.metadata.glyIdsUsed=[0]})(s,r)}}])}(Zt),Zt.API.addSvgAsImage=function(e,t,n,r,s,i,l,o){if(isNaN(t)||isNaN(n))throw rr.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(r)||isNaN(s))throw rr.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var c=document.createElement("canvas");c.width=r,c.height=s;var u=c.getContext("2d");u.fillStyle="#fff",u.fillRect(0,0,c.width,c.height);var d={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},f=this;return(fn.canvg?Promise.resolve(fn.canvg):np(()=>import("./index.es-BW6Mx094.js"),__vite__mapDeps([0,1,2,3,4,5]))).catch(function(m){return Promise.reject(new Error("Could not load canvg: "+m))}).then(function(m){return m.default?m.default:m}).then(function(m){return m.fromString(u,e,d)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(m){return m.render(d)}).then(function(){f.addImage(c.toDataURL("image/jpeg",1),t,n,r,s,l,o)})},Zt.API.putTotalPages=function(e){var t,n=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),n=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),n=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var s=0;s<this.internal.pages[r].length;s++)this.internal.pages[r][s]=this.internal.pages[r][s].replace(t,n);return this},Zt.API.viewerPreferences=function(e,t){var n;e=e||{},t=t||!1;var r,s,i,l={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},o=Object.keys(l),c=[],u=0,d=0,f=0;function m(x,y){var p,g=!1;for(p=0;p<x.length;p+=1)x[p]===y&&(g=!0);return g}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(l)),this.internal.viewerpreferences.isSubscribed=!1),n=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var h=o.length;for(f=0;f<h;f+=1)n[o[f]].value=n[o[f]].defaultValue,n[o[f]].explicitSet=!1}if(Kn(e)==="object"){for(s in e)if(i=e[s],m(o,s)&&i!==void 0){if(n[s].type==="boolean"&&typeof i=="boolean")n[s].value=i;else if(n[s].type==="name"&&m(n[s].valueSet,i))n[s].value=i;else if(n[s].type==="integer"&&Number.isInteger(i))n[s].value=i;else if(n[s].type==="array"){for(u=0;u<i.length;u+=1)if(r=!0,i[u].length===1&&typeof i[u][0]=="number")c.push(String(i[u]-1));else if(i[u].length>1){for(d=0;d<i[u].length;d+=1)typeof i[u][d]!="number"&&(r=!1);r===!0&&c.push([i[u][0]-1,i[u][1]-1].join(" "))}n[s].value="["+c.join(" ")+"]"}else n[s].value=n[s].defaultValue;n[s].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var x,y=[];for(x in n)n[x].explicitSet===!0&&(n[x].type==="name"?y.push("/"+x+" /"+n[x].value):y.push("/"+x+" "+n[x].value));y.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+y.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=n,this},function(e){var t=function(){var r='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',s=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),i=unescape(encodeURIComponent(r)),l=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),o=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),c=unescape(encodeURIComponent("</x:xmpmeta>")),u=i.length+l.length+o.length+s.length+c.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+u+" >>"),this.internal.write("stream"),this.internal.write(s+i+l+o+c),this.internal.write("endstream"),this.internal.write("endobj")},n=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(r,s){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:r,namespaceuri:s||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",n),this.internal.events.subscribe("postPutResources",t)),this}}(Zt.API),function(e){var t=e.API,n=t.pdfEscape16=function(i,l){for(var o,c=l.metadata.Unicode.widths,u=["","0","00","000","0000"],d=[""],f=0,m=i.length;f<m;++f){if(o=l.metadata.characterToGlyph(i.charCodeAt(f)),l.metadata.glyIdsUsed.push(o),l.metadata.toUnicode[o]=i.charCodeAt(f),c.indexOf(o)==-1&&(c.push(o),c.push([parseInt(l.metadata.widthOfGlyph(o),10)])),o=="0")return d.join("");o=o.toString(16),d.push(u[4-o.length],o)}return d.join("")},r=function(i){var l,o,c,u,d,f,m;for(d=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,c=[],f=0,m=(o=Object.keys(i).sort(function(h,x){return h-x})).length;f<m;f++)l=o[f],c.length>=100&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar`,c=[]),i[l]!==void 0&&i[l]!==null&&typeof i[l].toString=="function"&&(u=("0000"+i[l].toString(16)).slice(-4),l=("0000"+(+l).toString(16)).slice(-4),c.push("<"+l+"><"+u+">"));return c.length&&(d+=`
`+c.length+` beginbfchar
`+c.join(`
`)+`
endbfchar
`),d+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(i){(function(l){var o=l.font,c=l.out,u=l.newObject,d=l.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="Identity-H"){for(var f=o.metadata.Unicode.widths,m=o.metadata.subset.encode(o.metadata.glyIdsUsed,1),h="",x=0;x<m.length;x++)h+=String.fromCharCode(m[x]);var y=u();d({data:h,addLength1:!0,objectId:y}),c("endobj");var p=u();d({data:r(o.metadata.toUnicode),addLength1:!0,objectId:p}),c("endobj");var g=u();c("<<"),c("/Type /FontDescriptor"),c("/FontName /"+ru(o.fontName)),c("/FontFile2 "+y+" 0 R"),c("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),c("/Flags "+o.metadata.flags),c("/StemV "+o.metadata.stemV),c("/ItalicAngle "+o.metadata.italicAngle),c("/Ascent "+o.metadata.ascender),c("/Descent "+o.metadata.decender),c("/CapHeight "+o.metadata.capHeight),c(">>"),c("endobj");var w=u();c("<<"),c("/Type /Font"),c("/BaseFont /"+ru(o.fontName)),c("/FontDescriptor "+g+" 0 R"),c("/W "+e.API.PDFObject.convert(f)),c("/CIDToGIDMap /Identity"),c("/DW 1000"),c("/Subtype /CIDFontType2"),c("/CIDSystemInfo"),c("<<"),c("/Supplement 0"),c("/Registry (Adobe)"),c("/Ordering ("+o.encoding+")"),c(">>"),c(">>"),c("endobj"),o.objectNumber=u(),c("<<"),c("/Type /Font"),c("/Subtype /Type0"),c("/ToUnicode "+p+" 0 R"),c("/BaseFont /"+ru(o.fontName)),c("/Encoding /"+o.encoding),c("/DescendantFonts ["+w+" 0 R]"),c(">>"),c("endobj"),o.isAlreadyPutted=!0}})(i)}]),t.events.push(["putFont",function(i){(function(l){var o=l.font,c=l.out,u=l.newObject,d=l.putStream;if(o.metadata instanceof e.API.TTFFont&&o.encoding==="WinAnsiEncoding"){for(var f=o.metadata.rawData,m="",h=0;h<f.length;h++)m+=String.fromCharCode(f[h]);var x=u();d({data:m,addLength1:!0,objectId:x}),c("endobj");var y=u();d({data:r(o.metadata.toUnicode),addLength1:!0,objectId:y}),c("endobj");var p=u();c("<<"),c("/Descent "+o.metadata.decender),c("/CapHeight "+o.metadata.capHeight),c("/StemV "+o.metadata.stemV),c("/Type /FontDescriptor"),c("/FontFile2 "+x+" 0 R"),c("/Flags 96"),c("/FontBBox "+e.API.PDFObject.convert(o.metadata.bbox)),c("/FontName /"+ru(o.fontName)),c("/ItalicAngle "+o.metadata.italicAngle),c("/Ascent "+o.metadata.ascender),c(">>"),c("endobj"),o.objectNumber=u();for(var g=0;g<o.metadata.hmtx.widths.length;g++)o.metadata.hmtx.widths[g]=parseInt(o.metadata.hmtx.widths[g]*(1e3/o.metadata.head.unitsPerEm));c("<</Subtype/TrueType/Type/Font/ToUnicode "+y+" 0 R/BaseFont/"+ru(o.fontName)+"/FontDescriptor "+p+" 0 R/Encoding/"+o.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(o.metadata.hmtx.widths)+">>"),c("endobj"),o.isAlreadyPutted=!0}})(i)}]);var s=function(i){var l,o=i.text||"",c=i.x,u=i.y,d=i.options||{},f=i.mutex||{},m=f.pdfEscape,h=f.activeFontKey,x=f.fonts,y=h,p="",g=0,w="",v=x[y].encoding;if(x[y].encoding!=="Identity-H")return{text:o,x:c,y:u,options:d,mutex:f};for(w=o,y=h,Array.isArray(o)&&(w=o[0]),g=0;g<w.length;g+=1)x[y].metadata.hasOwnProperty("cmap")&&(l=x[y].metadata.cmap.unicode.codeMap[w[g].charCodeAt(0)]),l||w[g].charCodeAt(0)<256&&x[y].metadata.hasOwnProperty("Unicode")?p+=w[g]:p+="";var N="";return parseInt(y.slice(1))<14||v==="WinAnsiEncoding"?N=m(p,y).split("").map(function(A){return A.charCodeAt(0).toString(16)}).join(""):v==="Identity-H"&&(N=n(p,x[y])),f.isHex=!0,{text:N,x:c,y:u,options:d,mutex:f}};t.events.push(["postProcessText",function(i){var l=i.text||"",o=[],c={text:l,x:i.x,y:i.y,options:i.options,mutex:i.mutex};if(Array.isArray(l)){var u=0;for(u=0;u<l.length;u+=1)Array.isArray(l[u])&&l[u].length===3?o.push([s(Object.assign({},c,{text:l[u][0]})).text,l[u][1],l[u][2]]):o.push(s(Object.assign({},c,{text:l[u]})).text);i.text=o}else i.text=s(Object.assign({},c,{text:l})).text}])}(Zt),function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(n){return t.call(this),this.internal.vFS[n]!==void 0},e.addFileToVFS=function(n,r){return t.call(this),this.internal.vFS[n]=r,this},e.getFileFromVFS=function(n){return t.call(this),this.internal.vFS[n]!==void 0?this.internal.vFS[n]:null}}(Zt.API),function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(r){var s,i,l,o,c,u,d,f=t,m=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],h=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],x={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},y={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},p=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],g=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),w=!1,v=0;this.__bidiEngine__={};var N=function(_){var T=_.charCodeAt(),B=T>>8,$=y[B];return $!==void 0?f[256*$+(255&T)]:B===252||B===253?"AL":g.test(B)?"L":B===8?"R":"N"},A=function(_){for(var T,B=0;B<_.length;B++){if((T=N(_.charAt(B)))==="L")return!1;if(T==="R")return!0}return!1},P=function(_,T,B,$){var D,L,O,W,E=T[$];switch(E){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":w=!1;break;case"N":case"AN":break;case"EN":w&&(E="AN");break;case"AL":w=!0,E="R";break;case"WS":case"BN":E="N";break;case"CS":$<1||$+1>=T.length||(D=B[$-1])!=="EN"&&D!=="AN"||(L=T[$+1])!=="EN"&&L!=="AN"?E="N":w&&(L="AN"),E=L===D?L:"N";break;case"ES":E=(D=$>0?B[$-1]:"B")==="EN"&&$+1<T.length&&T[$+1]==="EN"?"EN":"N";break;case"ET":if($>0&&B[$-1]==="EN"){E="EN";break}if(w){E="N";break}for(O=$+1,W=T.length;O<W&&T[O]==="ET";)O++;E=O<W&&T[O]==="EN"?"EN":"N";break;case"NSM":if(l&&!o){for(W=T.length,O=$+1;O<W&&T[O]==="NSM";)O++;if(O<W){var H=_[$],V=H>=1425&&H<=2303||H===64286;if(D=T[O],V&&(D==="R"||D==="AL")){E="R";break}}}E=$<1||(D=T[$-1])==="B"?"N":B[$-1];break;case"B":w=!1,s=!0,E=v;break;case"S":i=!0,E="N"}return E},U=function(_,T,B){var $=_.split("");return B&&M($,B,{hiLevel:v}),$.reverse(),T&&T.reverse(),$.join("")},M=function(_,T,B){var $,D,L,O,W,E=-1,H=_.length,V=0,R=[],q=v?h:m,F=[];for(w=!1,s=!1,i=!1,D=0;D<H;D++)F[D]=N(_[D]);for(L=0;L<H;L++){if(W=V,R[L]=P(_,F,R,L),$=240&(V=q[W][x[R[L]]]),V&=15,T[L]=O=q[V][5],$>0)if($===16){for(D=E;D<L;D++)T[D]=1;E=-1}else E=-1;if(q[V][6])E===-1&&(E=L);else if(E>-1){for(D=E;D<L;D++)T[D]=O;E=-1}F[L]==="B"&&(T[L]=0),B.hiLevel|=O}i&&function(G,ee,ae){for(var re=0;re<ae;re++)if(G[re]==="S"){ee[re]=v;for(var Q=re-1;Q>=0&&G[Q]==="WS";Q--)ee[Q]=v}}(F,T,H)},S=function(_,T,B,$,D){if(!(D.hiLevel<_)){if(_===1&&v===1&&!s)return T.reverse(),void(B&&B.reverse());for(var L,O,W,E,H=T.length,V=0;V<H;){if($[V]>=_){for(W=V+1;W<H&&$[W]>=_;)W++;for(E=V,O=W-1;E<O;E++,O--)L=T[E],T[E]=T[O],T[O]=L,B&&(L=B[E],B[E]=B[O],B[O]=L);V=W}V++}}},C=function(_,T,B){var $=_.split(""),D={hiLevel:v};return B||(B=[]),M($,B,D),function(L,O,W){if(W.hiLevel!==0&&d)for(var E,H=0;H<L.length;H++)O[H]===1&&(E=p.indexOf(L[H]))>=0&&(L[H]=p[E+1])}($,B,D),S(2,$,T,B,D),S(1,$,T,B,D),$.join("")};return this.__bidiEngine__.doBidiReorder=function(_,T,B){if(function(D,L){if(L)for(var O=0;O<D.length;O++)L[O]=O;o===void 0&&(o=A(D)),u===void 0&&(u=A(D))}(_,T),l||!c||u)if(l&&c&&o^u)v=o?1:0,_=U(_,T,B);else if(!l&&c&&u)v=o?1:0,_=C(_,T,B),_=U(_,T);else if(!l||o||c||u){if(l&&!c&&o^u)_=U(_,T),o?(v=0,_=C(_,T,B)):(v=1,_=C(_,T,B),_=U(_,T));else if(l&&o&&!c&&u)v=1,_=C(_,T,B),_=U(_,T);else if(!l&&!c&&o^u){var $=d;o?(v=1,_=C(_,T,B),v=0,d=!1,_=C(_,T,B),d=$):(v=0,_=C(_,T,B),_=U(_,T),v=1,d=!1,_=C(_,T,B),d=$,_=U(_,T))}}else v=0,_=C(_,T,B);else v=o?1:0,_=C(_,T,B);return _},this.__bidiEngine__.setOptions=function(_){_&&(l=_.isInputVisual,c=_.isOutputVisual,o=_.isInputRtl,u=_.isOutputRtl,d=_.isSymmetricSwapping)},this.__bidiEngine__.setOptions(r),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],n=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(r){var s=r.text;r.x,r.y;var i=r.options||{};r.mutex,i.lang;var l=[];if(i.isInputVisual=typeof i.isInputVisual!="boolean"||i.isInputVisual,n.setOptions(i),Object.prototype.toString.call(s)==="[object Array]"){var o=0;for(l=[],o=0;o<s.length;o+=1)Object.prototype.toString.call(s[o])==="[object Array]"?l.push([n.doBidiReorder(s[o][0]),s[o][1],s[o][2]]):l.push([n.doBidiReorder(s[o])]);r.text=l}else r.text=n.doBidiReorder(s);n.setOptions({isInputVisual:!0})}])}(Zt),Zt.API.TTFFont=function(){function e(t){var n;if(this.rawData=t,n=this.contents=new il(t),this.contents.pos=4,n.readString(4)==="ttcf")throw new Error("TTCF not supported.");n.pos=0,this.parse(),this.subset=new aQ(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new VK(this.contents),this.head=new YK(this),this.name=new QK(this),this.cmap=new w7(this),this.toUnicode={},this.hhea=new JK(this),this.maxp=new eQ(this),this.hmtx=new tQ(this),this.post=new XK(this),this.os2=new ZK(this),this.loca=new iQ(this),this.glyf=new nQ(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,n,r,s,i;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=(function(){var l,o,c,u;for(u=[],l=0,o=(c=this.bbox).length;l<o;l++)t=c[l],u.push(Math.round(t*this.scaleFactor));return u}).call(this),this.stemV=0,this.post.exists?(r=255&(s=this.post.italic_angle),32768&(n=s>>16)&&(n=-(1+(65535^n))),this.italicAngle=+(n+"."+r)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(i=this.familyClass)===1||i===2||i===3||i===4||i===5||i===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var n;return((n=this.cmap.unicode)!=null?n.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var n;return n=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*n},e.prototype.widthOfString=function(t,n,r){var s,i,l,o;for(l=0,i=0,o=(t=""+t).length;0<=o?i<o:i>o;i=0<=o?++i:--i)s=t.charCodeAt(i),l+=this.widthOfGlyph(this.characterToGlyph(s))+r*(1e3/n)||0;return l*(n/1e3)},e.prototype.lineHeight=function(t,n){var r;return n==null&&(n=!1),r=n?this.lineGap:0,(this.ascender+r-this.decender)/1e3*t},e}();var da,il=function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var n,r;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r[n]=String.fromCharCode(this.readByte());return r.join("")},e.prototype.writeString=function(t){var n,r,s;for(s=[],n=0,r=t.length;0<=r?n<r:n>r;n=0<=r?++n:--n)s.push(this.writeByte(t.charCodeAt(n)));return s},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,n,r,s,i,l,o,c;return t=this.readByte(),n=this.readByte(),r=this.readByte(),s=this.readByte(),i=this.readByte(),l=this.readByte(),o=this.readByte(),c=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^n)+1099511627776*(255^r)+4294967296*(255^s)+16777216*(255^i)+65536*(255^l)+256*(255^o)+(255^c)+1):72057594037927940*t+281474976710656*n+1099511627776*r+4294967296*s+16777216*i+65536*l+256*o+c},e.prototype.writeLongLong=function(t){var n,r;return n=Math.floor(t/4294967296),r=4294967295&t,this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n),this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var n,r;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n.push(this.readByte());return n},e.prototype.write=function(t){var n,r,s,i;for(i=[],r=0,s=t.length;r<s;r++)n=t[r],i.push(this.writeByte(n));return i},e}(),VK=function(){var e;function t(n){var r,s,i;for(this.scalarType=n.readInt(),this.tableCount=n.readShort(),this.searchRange=n.readShort(),this.entrySelector=n.readShort(),this.rangeShift=n.readShort(),this.tables={},s=0,i=this.tableCount;0<=i?s<i:s>i;s=0<=i?++s:--s)r={tag:n.readString(4),checksum:n.readInt(),offset:n.readInt(),length:n.readInt()},this.tables[r.tag]=r}return t.prototype.encode=function(n){var r,s,i,l,o,c,u,d,f,m,h,x,y;for(y in h=Object.keys(n).length,c=Math.log(2),f=16*Math.floor(Math.log(h)/c),l=Math.floor(f/c),d=16*h-f,(s=new il).writeInt(this.scalarType),s.writeShort(h),s.writeShort(f),s.writeShort(l),s.writeShort(d),i=16*h,u=s.pos+i,o=null,x=[],n)for(m=n[y],s.writeString(y),s.writeInt(e(m)),s.writeInt(u),s.writeInt(m.length),x=x.concat(m),y==="head"&&(o=u),u+=m.length;u%4;)x.push(0),u++;return s.write(x),r=2981146554-e(s.data),s.pos=o+8,s.writeUInt32(r),s.data},e=function(n){var r,s,i,l;for(n=N7.call(n);n.length%4;)n.push(0);for(i=new il(n),s=0,r=0,l=n.length;r<l;r=r+=4)s+=i.readUInt32();return 4294967295&s},t}(),GK={}.hasOwnProperty,Oa=function(e,t){for(var n in t)GK.call(t,n)&&(e[n]=t[n]);function r(){this.constructor=e}return r.prototype=t.prototype,e.prototype=new r,e.__super__=t.prototype,e};da=function(){function e(t){var n;this.file=t,n=this.file.directory.tables[this.tag],this.exists=!!n,n&&(this.offset=n.offset,this.length=n.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e}();var YK=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Oa(e,da),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var n;return(n=new il).writeInt(this.version),n.writeInt(this.revision),n.writeInt(this.checkSumAdjustment),n.writeInt(this.magicNumber),n.writeShort(this.flags),n.writeShort(this.unitsPerEm),n.writeLongLong(this.created),n.writeLongLong(this.modified),n.writeShort(this.xMin),n.writeShort(this.yMin),n.writeShort(this.xMax),n.writeShort(this.yMax),n.writeShort(this.macStyle),n.writeShort(this.lowestRecPPEM),n.writeShort(this.fontDirectionHint),n.writeShort(t),n.writeShort(this.glyphDataFormat),n.data},e}(),X3=function(){function e(t,n){var r,s,i,l,o,c,u,d,f,m,h,x,y,p,g,w,v;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=n+t.readInt(),f=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(c=0;c<256;++c)this.codeMap[c]=t.readByte();break;case 4:for(h=t.readUInt16(),m=h/2,t.pos+=6,i=function(){var N,A;for(A=[],c=N=0;0<=m?N<m:N>m;c=0<=m?++N:--N)A.push(t.readUInt16());return A}(),t.pos+=2,y=function(){var N,A;for(A=[],c=N=0;0<=m?N<m:N>m;c=0<=m?++N:--N)A.push(t.readUInt16());return A}(),u=function(){var N,A;for(A=[],c=N=0;0<=m?N<m:N>m;c=0<=m?++N:--N)A.push(t.readUInt16());return A}(),d=function(){var N,A;for(A=[],c=N=0;0<=m?N<m:N>m;c=0<=m?++N:--N)A.push(t.readUInt16());return A}(),s=(this.length-t.pos+this.offset)/2,o=function(){var N,A;for(A=[],c=N=0;0<=s?N<s:N>s;c=0<=s?++N:--N)A.push(t.readUInt16());return A}(),c=g=0,v=i.length;g<v;c=++g)for(p=i[c],r=w=x=y[c];x<=p?w<=p:w>=p;r=x<=p?++w:--w)d[c]===0?l=r+u[c]:(l=o[d[c]/2+(r-x)-(m-c)]||0)!==0&&(l+=u[c]),this.codeMap[r]=65535&l}t.pos=f}return e.encode=function(t,n){var r,s,i,l,o,c,u,d,f,m,h,x,y,p,g,w,v,N,A,P,U,M,S,C,_,T,B,$,D,L,O,W,E,H,V,R,q,F,G,ee,ae,re,Q,fe,Se,oe;switch($=new il,l=Object.keys(t).sort(function(pe,me){return pe-me}),n){case"macroman":for(y=0,p=function(){var pe=[];for(x=0;x<256;++x)pe.push(0);return pe}(),w={0:0},i={},D=0,E=l.length;D<E;D++)w[Q=t[s=l[D]]]==null&&(w[Q]=++y),i[s]={old:t[s],new:w[t[s]]},p[s]=w[t[s]];return $.writeUInt16(1),$.writeUInt16(0),$.writeUInt32(12),$.writeUInt16(0),$.writeUInt16(262),$.writeUInt16(0),$.write(p),{charMap:i,subtable:$.data,maxGlyphID:y+1};case"unicode":for(T=[],f=[],v=0,w={},r={},g=u=null,L=0,H=l.length;L<H;L++)w[A=t[s=l[L]]]==null&&(w[A]=++v),r[s]={old:A,new:w[A]},o=w[A]-s,g!=null&&o===u||(g&&f.push(g),T.push(s),u=o),g=s;for(g&&f.push(g),f.push(65535),T.push(65535),C=2*(S=T.length),M=2*Math.pow(Math.log(S)/Math.LN2,2),m=Math.log(M/2)/Math.LN2,U=2*S-M,c=[],P=[],h=[],x=O=0,V=T.length;O<V;x=++O){if(_=T[x],d=f[x],_===65535){c.push(0),P.push(0);break}if(_-(B=r[_].new)>=32768)for(c.push(0),P.push(2*(h.length+S-x)),s=W=_;_<=d?W<=d:W>=d;s=_<=d?++W:--W)h.push(r[s].new);else c.push(B-_),P.push(0)}for($.writeUInt16(3),$.writeUInt16(1),$.writeUInt32(12),$.writeUInt16(4),$.writeUInt16(16+8*S+2*h.length),$.writeUInt16(0),$.writeUInt16(C),$.writeUInt16(M),$.writeUInt16(m),$.writeUInt16(U),ae=0,R=f.length;ae<R;ae++)s=f[ae],$.writeUInt16(s);for($.writeUInt16(0),re=0,q=T.length;re<q;re++)s=T[re],$.writeUInt16(s);for(fe=0,F=c.length;fe<F;fe++)o=c[fe],$.writeUInt16(o);for(Se=0,G=P.length;Se<G;Se++)N=P[Se],$.writeUInt16(N);for(oe=0,ee=h.length;oe<ee;oe++)y=h[oe],$.writeUInt16(y);return{charMap:r,subtable:$.data,maxGlyphID:v+1}}},e}(),w7=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Oa(e,da),e.prototype.tag="cmap",e.prototype.parse=function(t){var n,r,s;for(t.pos=this.offset,this.version=t.readUInt16(),s=t.readUInt16(),this.tables=[],this.unicode=null,r=0;0<=s?r<s:r>s;r=0<=s?++r:--r)n=new X3(t,this.offset),this.tables.push(n),n.isUnicode&&this.unicode==null&&(this.unicode=n);return!0},e.encode=function(t,n){var r,s;return n==null&&(n="macroman"),r=X3.encode(t,n),(s=new il).writeUInt16(0),s.writeUInt16(1),r.table=s.data.concat(r.subtable),r},e}(),JK=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Oa(e,da),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e}(),ZK=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Oa(e,da),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=function(){var n,r;for(r=[],n=0;n<10;++n)r.push(t.readByte());return r}(),this.charRange=function(){var n,r;for(r=[],n=0;n<4;++n)r.push(t.readInt());return r}(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=function(){var n,r;for(r=[],n=0;n<2;n=++n)r.push(t.readInt());return r}(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e}(),XK=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Oa(e,da),e.prototype.tag="post",e.prototype.parse=function(t){var n,r,s;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var i;for(r=t.readUInt16(),this.glyphNameIndex=[],i=0;0<=r?i<r:i>r;i=0<=r?++i:--i)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],s=[];t.pos<this.offset+this.length;)n=t.readByte(),s.push(this.names.push(t.readString(n)));return s;case 151552:return r=t.readUInt16(),this.offsets=t.read(r);case 262144:return this.map=(function(){var l,o,c;for(c=[],i=l=0,o=this.file.maxp.numGlyphs;0<=o?l<o:l>o;i=0<=o?++l:--l)c.push(t.readUInt32());return c}).call(this)}},e}(),KK=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},QK=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Oa(e,da),e.prototype.tag="name",e.prototype.parse=function(t){var n,r,s,i,l,o,c,u,d,f,m;for(t.pos=this.offset,t.readShort(),n=t.readShort(),o=t.readShort(),r=[],i=0;0<=n?i<n:i>n;i=0<=n?++i:--i)r.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+o+t.readShort()});for(c={},i=d=0,f=r.length;d<f;i=++d)s=r[i],t.pos=s.offset,u=t.readString(s.length),l=new KK(u,s),c[m=s.nameID]==null&&(c[m]=[]),c[s.nameID].push(l);this.strings=c,this.copyright=c[0],this.fontFamily=c[1],this.fontSubfamily=c[2],this.uniqueSubfamily=c[3],this.fontName=c[4],this.version=c[5];try{this.postscriptName=c[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=c[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=c[7],this.manufacturer=c[8],this.designer=c[9],this.description=c[10],this.vendorUrl=c[11],this.designerUrl=c[12],this.license=c[13],this.licenseUrl=c[14],this.preferredFamily=c[15],this.preferredSubfamily=c[17],this.compatibleFull=c[18],this.sampleText=c[19]},e}(),eQ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Oa(e,da),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e}(),tQ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Oa(e,da),e.prototype.tag="hmtx",e.prototype.parse=function(t){var n,r,s,i,l,o,c;for(t.pos=this.offset,this.metrics=[],n=0,o=this.file.hhea.numberOfMetrics;0<=o?n<o:n>o;n=0<=o?++n:--n)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(s=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=function(){var u,d;for(d=[],n=u=0;0<=s?u<s:u>s;n=0<=s?++u:--u)d.push(t.readInt16());return d}(),this.widths=(function(){var u,d,f,m;for(m=[],u=0,d=(f=this.metrics).length;u<d;u++)i=f[u],m.push(i.advance);return m}).call(this),r=this.widths[this.widths.length-1],c=[],n=l=0;0<=s?l<s:l>s;n=0<=s?++l:--l)c.push(this.widths.push(r));return c},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e}(),N7=[].slice,nQ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Oa(e,da),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var n,r,s,i,l,o,c,u,d,f;return t in this.cache?this.cache[t]:(i=this.file.loca,n=this.file.contents,r=i.indexOf(t),(s=i.lengthOf(t))===0?this.cache[t]=null:(n.pos=this.offset+r,l=(o=new il(n.read(s))).readShort(),u=o.readShort(),f=o.readShort(),c=o.readShort(),d=o.readShort(),this.cache[t]=l===-1?new sQ(o,u,f,c,d):new rQ(o,l,u,f,c,d),this.cache[t]))},e.prototype.encode=function(t,n,r){var s,i,l,o,c;for(l=[],i=[],o=0,c=n.length;o<c;o++)s=t[n[o]],i.push(l.length),s&&(l=l.concat(s.encode(r)));return i.push(l.length),{table:l,offsets:i}},e}(),rQ=function(){function e(t,n,r,s,i,l){this.raw=t,this.numberOfContours=n,this.xMin=r,this.yMin=s,this.xMax=i,this.yMax=l,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e}(),sQ=function(){function e(t,n,r,s,i){var l,o;for(this.raw=t,this.xMin=n,this.yMin=r,this.xMax=s,this.yMax=i,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],l=this.raw;o=l.readShort(),this.glyphOffsets.push(l.pos),this.glyphIDs.push(l.readUInt16()),32&o;)l.pos+=1&o?4:2,128&o?l.pos+=8:64&o?l.pos+=4:8&o&&(l.pos+=2)}return e.prototype.encode=function(){var t,n,r;for(n=new il(N7.call(this.raw.data)),t=0,r=this.glyphIDs.length;t<r;++t)n.pos=this.glyphOffsets[t];return n.data},e}(),iQ=function(){function e(){return e.__super__.constructor.apply(this,arguments)}return Oa(e,da),e.prototype.tag="loca",e.prototype.parse=function(t){var n,r;return t.pos=this.offset,n=this.file.head.indexToLocFormat,this.offsets=n===0?(function(){var s,i;for(i=[],r=0,s=this.length;r<s;r+=2)i.push(2*t.readUInt16());return i}).call(this):(function(){var s,i;for(i=[],r=0,s=this.length;r<s;r+=4)i.push(t.readUInt32());return i}).call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,n){for(var r=new Uint32Array(this.offsets.length),s=0,i=0,l=0;l<r.length;++l)if(r[l]=s,i<n.length&&n[i]==l){++i,r[l]=s;var o=this.offsets[l],c=this.offsets[l+1]-o;c>0&&(s+=c)}for(var u=new Array(4*r.length),d=0;d<r.length;++d)u[4*d+3]=255&r[d],u[4*d+2]=(65280&r[d])>>8,u[4*d+1]=(16711680&r[d])>>16,u[4*d]=(4278190080&r[d])>>24;return u},e}(),aQ=function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,n,r,s,i;for(n in s=this.font.cmap.tables[0].codeMap,t={},i=this.subset)r=i[n],t[n]=s[r];return t},e.prototype.glyphsFor=function(t){var n,r,s,i,l,o,c;for(s={},l=0,o=t.length;l<o;l++)s[i=t[l]]=this.font.glyf.glyphFor(i);for(i in n=[],s)(r=s[i])!=null&&r.compound&&n.push.apply(n,r.glyphIDs);if(n.length>0)for(i in c=this.glyphsFor(n))r=c[i],s[i]=r;return s},e.prototype.encode=function(t,n){var r,s,i,l,o,c,u,d,f,m,h,x,y,p,g;for(s in r=w7.encode(this.generateCmap(),"unicode"),l=this.glyphsFor(t),h={0:0},g=r.charMap)h[(c=g[s]).old]=c.new;for(x in m=r.maxGlyphID,l)x in h||(h[x]=m++);return d=function(w){var v,N;for(v in N={},w)N[w[v]]=v;return N}(h),f=Object.keys(d).sort(function(w,v){return w-v}),y=function(){var w,v,N;for(N=[],w=0,v=f.length;w<v;w++)o=f[w],N.push(d[o]);return N}(),i=this.font.glyf.encode(l,y,h),u=this.font.loca.encode(i.offsets,y),p={cmap:this.font.cmap.raw(),glyf:i.table,loca:u,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(n)},this.font.os2.exists&&(p["OS/2"]=this.font.os2.raw()),this.font.directory.encode(p)},e}();Zt.API.PDFObject=function(){var e;function t(){}return e=function(n,r){return(Array(r+1).join("0")+n).slice(-r)},t.convert=function(n){var r,s,i,l;if(Array.isArray(n))return"["+function(){var o,c,u;for(u=[],o=0,c=n.length;o<c;o++)r=n[o],u.push(t.convert(r));return u}().join(" ")+"]";if(typeof n=="string")return"/"+n;if(n!=null&&n.isString)return"("+n+")";if(n instanceof Date)return"(D:"+e(n.getUTCFullYear(),4)+e(n.getUTCMonth(),2)+e(n.getUTCDate(),2)+e(n.getUTCHours(),2)+e(n.getUTCMinutes(),2)+e(n.getUTCSeconds(),2)+"Z)";if({}.toString.call(n)==="[object Object]"){for(s in i=["<<"],n)l=n[s],i.push("/"+s+" "+t.convert(l));return i.push(">>"),i.join(`
`)}return""+n},t}();function oQ(e,t){if(e.match(/^[a-z]+:\/\//i))return e;if(e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i))return e;const n=document.implementation.createHTMLDocument(),r=n.createElement("base"),s=n.createElement("a");return n.head.appendChild(r),n.body.appendChild(s),t&&(r.href=t),s.href=e,s.href}const lQ=(()=>{let e=0;const t=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(e+=1,`u${t()}${e}`)})();function Ko(e){const t=[];for(let n=0,r=e.length;n<r;n++)t.push(e[n]);return t}let Qc=null;function j7(e={}){return Qc||(e.includeStyleProperties?(Qc=e.includeStyleProperties,Qc):(Qc=Ko(window.getComputedStyle(document.documentElement)),Qc))}function o0(e,t){const r=(e.ownerDocument.defaultView||window).getComputedStyle(e).getPropertyValue(t);return r?parseFloat(r.replace("px","")):0}function cQ(e){const t=o0(e,"border-left-width"),n=o0(e,"border-right-width");return e.clientWidth+t+n}function uQ(e){const t=o0(e,"border-top-width"),n=o0(e,"border-bottom-width");return e.clientHeight+t+n}function S7(e,t={}){const n=t.width||cQ(e),r=t.height||uQ(e);return{width:n,height:r}}function dQ(){let e,t;try{t=process}catch{}const n=t&&t.env?t.env.devicePixelRatio:null;return n&&(e=parseInt(n,10),Number.isNaN(e)&&(e=1)),e||window.devicePixelRatio||1}const yi=16384;function fQ(e){(e.width>yi||e.height>yi)&&(e.width>yi&&e.height>yi?e.width>e.height?(e.height*=yi/e.width,e.width=yi):(e.width*=yi/e.height,e.height=yi):e.width>yi?(e.height*=yi/e.width,e.width=yi):(e.width*=yi/e.height,e.height=yi))}function l0(e){return new Promise((t,n)=>{const r=new Image;r.onload=()=>{r.decode().then(()=>{requestAnimationFrame(()=>t(r))})},r.onerror=n,r.crossOrigin="anonymous",r.decoding="async",r.src=e})}async function hQ(e){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(e)).then(encodeURIComponent).then(t=>`data:image/svg+xml;charset=utf-8,${t}`)}async function mQ(e,t,n){const r="http://www.w3.org/2000/svg",s=document.createElementNS(r,"svg"),i=document.createElementNS(r,"foreignObject");return s.setAttribute("width",`${t}`),s.setAttribute("height",`${n}`),s.setAttribute("viewBox",`0 0 ${t} ${n}`),i.setAttribute("width","100%"),i.setAttribute("height","100%"),i.setAttribute("x","0"),i.setAttribute("y","0"),i.setAttribute("externalResourcesRequired","true"),s.appendChild(i),i.appendChild(e),hQ(s)}const si=(e,t)=>{if(e instanceof t)return!0;const n=Object.getPrototypeOf(e);return n===null?!1:n.constructor.name===t.name||si(n,t)};function pQ(e){const t=e.getPropertyValue("content");return`${e.cssText} content: '${t.replace(/'|"/g,"")}';`}function gQ(e,t){return j7(t).map(n=>{const r=e.getPropertyValue(n),s=e.getPropertyPriority(n);return`${n}: ${r}${s?" !important":""};`}).join(" ")}function xQ(e,t,n,r){const s=`.${e}:${t}`,i=n.cssText?pQ(n):gQ(n,r);return document.createTextNode(`${s}{${i}}`)}function K3(e,t,n,r){const s=window.getComputedStyle(e,n),i=s.getPropertyValue("content");if(i===""||i==="none")return;const l=lQ();try{t.className=`${t.className} ${l}`}catch{return}const o=document.createElement("style");o.appendChild(xQ(l,n,s,r)),t.appendChild(o)}function yQ(e,t,n){K3(e,t,":before",n),K3(e,t,":after",n)}const Q3="application/font-woff",e4="image/jpeg",bQ={woff:Q3,woff2:Q3,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:e4,jpeg:e4,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function vQ(e){const t=/\.([^./]*?)$/g.exec(e);return t?t[1]:""}function Jb(e){const t=vQ(e).toLowerCase();return bQ[t]||""}function wQ(e){return e.split(/,/)[1]}function q2(e){return e.search(/^(data:)/)!==-1}function NQ(e,t){return`data:${t};base64,${e}`}async function _7(e,t,n){const r=await fetch(e,t);if(r.status===404)throw new Error(`Resource "${r.url}" not found`);const s=await r.blob();return new Promise((i,l)=>{const o=new FileReader;o.onerror=l,o.onloadend=()=>{try{i(n({res:r,result:o.result}))}catch(c){l(c)}},o.readAsDataURL(s)})}const ox={};function jQ(e,t,n){let r=e.replace(/\?.*/,"");return n&&(r=e),/ttf|otf|eot|woff2?/i.test(r)&&(r=r.replace(/.*\//,"")),t?`[${t}]${r}`:r}async function Zb(e,t,n){const r=jQ(e,t,n.includeQueryParams);if(ox[r]!=null)return ox[r];n.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+new Date().getTime());let s;try{const i=await _7(e,n.fetchRequestInit,({res:l,result:o})=>(t||(t=l.headers.get("Content-Type")||""),wQ(o)));s=NQ(i,t)}catch(i){s=n.imagePlaceholder||"";let l=`Failed to fetch resource: ${e}`;i&&(l=typeof i=="string"?i:i.message),l&&console.warn(l)}return ox[r]=s,s}async function SQ(e){const t=e.toDataURL();return t==="data:,"?e.cloneNode(!1):l0(t)}async function _Q(e,t){if(e.currentSrc){const i=document.createElement("canvas"),l=i.getContext("2d");i.width=e.clientWidth,i.height=e.clientHeight,l==null||l.drawImage(e,0,0,i.width,i.height);const o=i.toDataURL();return l0(o)}const n=e.poster,r=Jb(n),s=await Zb(n,r,t);return l0(s)}async function AQ(e,t){var n;try{if(!((n=e==null?void 0:e.contentDocument)===null||n===void 0)&&n.body)return await hg(e.contentDocument.body,t,!0)}catch{}return e.cloneNode(!1)}async function kQ(e,t){return si(e,HTMLCanvasElement)?SQ(e):si(e,HTMLVideoElement)?_Q(e,t):si(e,HTMLIFrameElement)?AQ(e,t):e.cloneNode(A7(e))}const EQ=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SLOT",A7=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SVG";async function CQ(e,t,n){var r,s;if(A7(t))return t;let i=[];return EQ(e)&&e.assignedNodes?i=Ko(e.assignedNodes()):si(e,HTMLIFrameElement)&&(!((r=e.contentDocument)===null||r===void 0)&&r.body)?i=Ko(e.contentDocument.body.childNodes):i=Ko(((s=e.shadowRoot)!==null&&s!==void 0?s:e).childNodes),i.length===0||si(e,HTMLVideoElement)||await i.reduce((l,o)=>l.then(()=>hg(o,n)).then(c=>{c&&t.appendChild(c)}),Promise.resolve()),t}function PQ(e,t,n){const r=t.style;if(!r)return;const s=window.getComputedStyle(e);s.cssText?(r.cssText=s.cssText,r.transformOrigin=s.transformOrigin):j7(n).forEach(i=>{let l=s.getPropertyValue(i);i==="font-size"&&l.endsWith("px")&&(l=`${Math.floor(parseFloat(l.substring(0,l.length-2)))-.1}px`),si(e,HTMLIFrameElement)&&i==="display"&&l==="inline"&&(l="block"),i==="d"&&t.getAttribute("d")&&(l=`path(${t.getAttribute("d")})`),r.setProperty(i,l,s.getPropertyPriority(i))})}function IQ(e,t){si(e,HTMLTextAreaElement)&&(t.innerHTML=e.value),si(e,HTMLInputElement)&&t.setAttribute("value",e.value)}function TQ(e,t){if(si(e,HTMLSelectElement)){const n=t,r=Array.from(n.children).find(s=>e.value===s.getAttribute("value"));r&&r.setAttribute("selected","")}}function LQ(e,t,n){return si(t,Element)&&(PQ(e,t,n),yQ(e,t,n),IQ(e,t),TQ(e,t)),t}async function MQ(e,t){const n=e.querySelectorAll?e.querySelectorAll("use"):[];if(n.length===0)return e;const r={};for(let i=0;i<n.length;i++){const o=n[i].getAttribute("xlink:href");if(o){const c=e.querySelector(o),u=document.querySelector(o);!c&&u&&!r[o]&&(r[o]=await hg(u,t,!0))}}const s=Object.values(r);if(s.length){const i="http://www.w3.org/1999/xhtml",l=document.createElementNS(i,"svg");l.setAttribute("xmlns",i),l.style.position="absolute",l.style.width="0",l.style.height="0",l.style.overflow="hidden",l.style.display="none";const o=document.createElementNS(i,"defs");l.appendChild(o);for(let c=0;c<s.length;c++)o.appendChild(s[c]);e.appendChild(l)}return e}async function hg(e,t,n){return!n&&t.filter&&!t.filter(e)?null:Promise.resolve(e).then(r=>kQ(r,t)).then(r=>CQ(e,r,t)).then(r=>LQ(e,r,t)).then(r=>MQ(r,t))}const k7=/url\((['"]?)([^'"]+?)\1\)/g,RQ=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,$Q=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function FQ(e){const t=e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${t})(['"]?\\))`,"g")}function OQ(e){const t=[];return e.replace(k7,(n,r,s)=>(t.push(s),n)),t.filter(n=>!q2(n))}async function DQ(e,t,n,r,s){try{const i=n?oQ(t,n):t,l=Jb(t);let o;return s||(o=await Zb(i,l,r)),e.replace(FQ(t),`$1${o}$3`)}catch{}return e}function BQ(e,{preferredFontFormat:t}){return t?e.replace($Q,n=>{for(;;){const[r,,s]=RQ.exec(n)||[];if(!s)return"";if(s===t)return`src: ${r};`}}):e}function E7(e){return e.search(k7)!==-1}async function C7(e,t,n){if(!E7(e))return e;const r=BQ(e,n);return OQ(r).reduce((i,l)=>i.then(o=>DQ(o,l,t,n)),Promise.resolve(r))}async function eu(e,t,n){var r;const s=(r=t.style)===null||r===void 0?void 0:r.getPropertyValue(e);if(s){const i=await C7(s,null,n);return t.style.setProperty(e,i,t.style.getPropertyPriority(e)),!0}return!1}async function zQ(e,t){await eu("background",e,t)||await eu("background-image",e,t),await eu("mask",e,t)||await eu("-webkit-mask",e,t)||await eu("mask-image",e,t)||await eu("-webkit-mask-image",e,t)}async function UQ(e,t){const n=si(e,HTMLImageElement);if(!(n&&!q2(e.src))&&!(si(e,SVGImageElement)&&!q2(e.href.baseVal)))return;const r=n?e.src:e.href.baseVal,s=await Zb(r,Jb(r),t);await new Promise((i,l)=>{e.onload=i,e.onerror=t.onImageErrorHandler?(...c)=>{try{i(t.onImageErrorHandler(...c))}catch(u){l(u)}}:l;const o=e;o.decode&&(o.decode=i),o.loading==="lazy"&&(o.loading="eager"),n?(e.srcset="",e.src=s):e.href.baseVal=s})}async function qQ(e,t){const r=Ko(e.childNodes).map(s=>P7(s,t));await Promise.all(r).then(()=>e)}async function P7(e,t){si(e,Element)&&(await zQ(e,t),await UQ(e,t),await qQ(e,t))}function HQ(e,t){const{style:n}=e;t.backgroundColor&&(n.backgroundColor=t.backgroundColor),t.width&&(n.width=`${t.width}px`),t.height&&(n.height=`${t.height}px`);const r=t.style;return r!=null&&Object.keys(r).forEach(s=>{n[s]=r[s]}),e}const t4={};async function n4(e){let t=t4[e];if(t!=null)return t;const r=await(await fetch(e)).text();return t={url:e,cssText:r},t4[e]=t,t}async function r4(e,t){let n=e.cssText;const r=/url\(["']?([^"')]+)["']?\)/g,i=(n.match(/url\([^)]+\)/g)||[]).map(async l=>{let o=l.replace(r,"$1");return o.startsWith("https://")||(o=new URL(o,e.url).href),_7(o,t.fetchRequestInit,({result:c})=>(n=n.replace(l,`url(${c})`),[l,c]))});return Promise.all(i).then(()=>n)}function s4(e){if(e==null)return[];const t=[],n=/(\/\*[\s\S]*?\*\/)/gi;let r=e.replace(n,"");const s=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const c=s.exec(r);if(c===null)break;t.push(c[0])}r=r.replace(s,"");const i=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,l="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",o=new RegExp(l,"gi");for(;;){let c=i.exec(r);if(c===null){if(c=o.exec(r),c===null)break;i.lastIndex=o.lastIndex}else o.lastIndex=i.lastIndex;t.push(c[0])}return t}async function WQ(e,t){const n=[],r=[];return e.forEach(s=>{if("cssRules"in s)try{Ko(s.cssRules||[]).forEach((i,l)=>{if(i.type===CSSRule.IMPORT_RULE){let o=l+1;const c=i.href,u=n4(c).then(d=>r4(d,t)).then(d=>s4(d).forEach(f=>{try{s.insertRule(f,f.startsWith("@import")?o+=1:s.cssRules.length)}catch(m){console.error("Error inserting rule from remote css",{rule:f,error:m})}})).catch(d=>{console.error("Error loading remote css",d.toString())});r.push(u)}})}catch(i){const l=e.find(o=>o.href==null)||document.styleSheets[0];s.href!=null&&r.push(n4(s.href).then(o=>r4(o,t)).then(o=>s4(o).forEach(c=>{l.insertRule(c,l.cssRules.length)})).catch(o=>{console.error("Error loading remote stylesheet",o)})),console.error("Error inlining remote css file",i)}}),Promise.all(r).then(()=>(e.forEach(s=>{if("cssRules"in s)try{Ko(s.cssRules||[]).forEach(i=>{n.push(i)})}catch(i){console.error(`Error while reading CSS rules from ${s.href}`,i)}}),n))}function VQ(e){return e.filter(t=>t.type===CSSRule.FONT_FACE_RULE).filter(t=>E7(t.style.getPropertyValue("src")))}async function GQ(e,t){if(e.ownerDocument==null)throw new Error("Provided element is not within a Document");const n=Ko(e.ownerDocument.styleSheets),r=await WQ(n,t);return VQ(r)}function I7(e){return e.trim().replace(/["']/g,"")}function YQ(e){const t=new Set;function n(r){(r.style.fontFamily||getComputedStyle(r).fontFamily).split(",").forEach(i=>{t.add(I7(i))}),Array.from(r.children).forEach(i=>{i instanceof HTMLElement&&n(i)})}return n(e),t}async function JQ(e,t){const n=await GQ(e,t),r=YQ(e);return(await Promise.all(n.filter(i=>r.has(I7(i.style.fontFamily))).map(i=>{const l=i.parentStyleSheet?i.parentStyleSheet.href:null;return C7(i.cssText,l,t)}))).join(`
`)}async function ZQ(e,t){const n=t.fontEmbedCSS!=null?t.fontEmbedCSS:t.skipFonts?null:await JQ(e,t);if(n){const r=document.createElement("style"),s=document.createTextNode(n);r.appendChild(s),e.firstChild?e.insertBefore(r,e.firstChild):e.appendChild(r)}}async function XQ(e,t={}){const{width:n,height:r}=S7(e,t),s=await hg(e,t,!0);return await ZQ(s,t),await P7(s,t),HQ(s,t),await mQ(s,n,r)}async function KQ(e,t={}){const{width:n,height:r}=S7(e,t),s=await XQ(e,t),i=await l0(s),l=document.createElement("canvas"),o=l.getContext("2d"),c=t.pixelRatio||dQ(),u=t.canvasWidth||n,d=t.canvasHeight||r;return l.width=u*c,l.height=d*c,t.skipAutoScale||fQ(l),l.style.width=`${u}`,l.style.height=`${d}`,t.backgroundColor&&(o.fillStyle=t.backgroundColor,o.fillRect(0,0,l.width,l.height)),o.drawImage(i,0,0,l.width,l.height),l}async function QQ(e,t={}){return(await KQ(e,t)).toDataURL()}const T7=Y.createContext(void 0),L7=()=>{const e=Y.useContext(T7);if(!e)throw new Error("useSelectedNode must be used within a SelectedNodeProvider");return e},eee=(e,t,n)=>{var s;if(!n||!Array.isArray(n))return null;const r=n.filter(i=>{var u;const l=i.relationshipType==="Child",o=e.toString(),c=(u=i.relatedPersonId)==null?void 0:u.toString();return l&&c===o});for(const i of r){const l=(s=i.personId)==null?void 0:s.toString(),o=t.find(c=>c.id===l);if(o&&o.gender==="male")return o}return null},tee=(e,t,n)=>{var s,i;if(!n||!Array.isArray(n))return null;const r=n.filter(l=>{var d;const o=l.relationshipType==="Child",c=e.toString(),u=(d=l.relatedPersonId)==null?void 0:d.toString();return o&&u===c});for(const l of r){const o=(s=l.personId)==null?void 0:s.toString(),c=t.find(u=>u.id===o);if(c&&c.gender==="female")return c;if(c&&c.gender==="male"){const u=n.find(d=>{var x,y;const f=d.relationshipType==="Child",m=e.toString(),h=(x=d.relatedPersonId)==null?void 0:x.toString();return f&&h===m&&((y=t.find(p=>{var g;return p.id===((g=d.personId)==null?void 0:g.toString())}))==null?void 0:y.gender)==="female"});if(u){const d=(i=u.personId)==null?void 0:i.toString(),f=t.find(m=>m.id===d);if(f)return f}}}return null},nee=({id:e,sourceX:t,sourceY:n,targetX:r,targetY:s,sourcePosition:i,targetPosition:l,style:o={},markerEnd:c})=>{const[u]=Fb({sourceX:t,sourceY:n,sourcePosition:i,targetX:r,targetY:s,targetPosition:l});return a.jsx("path",{id:e,style:o,className:"react-flow__edge-path",d:u,markerEnd:c})},ree=({person:e,isOpen:t,onClose:n,persons:r,relationships:s})=>{var v,N,A,P,U,M,S;const{theme:i,language:l="en"}=Xt(),{isMobile:o}=Tr();yZ();const[c,u]=Y.useState([]),[d,f]=Y.useState([]);if(Y.useEffect(()=>{if(!e||!t)return;const C=new Map;r.forEach(D=>C.set(D.id,D));const _=new Set,T=new Set;s&&Array.isArray(s)&&s.forEach(D=>{if((D.relationshipType==="Spouse"||D.relationshipType==="spouse"||D.relationshipType==="Husband"||D.relationshipType==="husband"||D.relationshipType==="Wife"||D.relationshipType==="wife")&&(D.personId.toString()===e.id||D.relatedPersonId.toString()===e.id)){const L=D.personId.toString()===e.id?D.relatedPersonId.toString():D.personId.toString();_.add(L)}(D.relationshipType==="Child"||D.relationshipType==="child"||D.relationshipType==="Son"||D.relationshipType==="son"||D.relationshipType==="Daughter"||D.relationshipType==="daughter")&&D.personId.toString()===e.id&&T.add(D.relatedPersonId.toString())}),e.relationships&&(e.relationships.spouses&&Array.isArray(e.relationships.spouses)&&e.relationships.spouses.forEach(D=>{typeof D=="object"&&D.person?typeof D.person=="object"&&D.person.id?_.add(D.person.id):typeof D.person=="string"&&_.add(D.person):typeof D=="string"&&_.add(D)}),e.relationships.children&&Array.isArray(e.relationships.children)&&e.relationships.children.forEach(D=>{typeof D=="object"&&D.id?T.add(D.id):typeof D=="string"&&T.add(D)}));const B=Array.from(_).map(D=>C.get(D)).filter(D=>D!==void 0),$=Array.from(T).map(D=>C.get(D)).filter(D=>D!==void 0);u(B),f($)},[e,t,r,s]),!t||!e)return null;const m=o?"95vw":"600px",h=e,y=(()=>{var B,$,D,L;if(!((B=e.birth)!=null&&B.date)&&!h.birthDate)return null;const C=(($=e.birth)==null?void 0:$.date)||h.birthDate,_=new Date(C).getFullYear();return((D=e.death)!=null&&D.date||h.deathDate?new Date(((L=e.death)==null?void 0:L.date)||h.deathDate).getFullYear():new Date().getFullYear())-_})(),p=e.gender||"unknown",g=p==="male",w=p==="female";return a.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:C=>{C.target===C.currentTarget&&n()},children:a.jsxs("div",{className:"relative rounded-3xl shadow-2xl max-h-[90vh] overflow-hidden animate-in fade-in-0 zoom-in-95 duration-300",style:{width:m,background:i==="dark"?"linear-gradient(135deg, #1f2937 0%, #111827 100%)":"linear-gradient(135deg, #ffffff 0%, #f8fafc 100%)",border:`2px solid ${i==="dark"?"#374151":"#e2e8f0"}`},onClick:C=>C.stopPropagation(),children:[a.jsxs("div",{className:"relative h-32 overflow-hidden",style:{background:g?"linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)":w?"linear-gradient(135deg, #ec4899 0%, #be185d 100%)":"linear-gradient(135deg, #6b7280 0%, #374151 100%)"},children:[a.jsx("button",{onClick:C=>{C.preventDefault(),C.stopPropagation(),n()},className:"absolute top-4 right-4 w-10 h-10 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center hover:bg-white/30 transition-all duration-200 group z-10",type:"button",children:a.jsx(ia,{size:20,className:"text-white group-hover:scale-110 transition-transform"})}),a.jsx("div",{className:"absolute -top-10 -right-10 w-32 h-32 rounded-full bg-white/10"}),a.jsx("div",{className:"absolute -bottom-5 -left-5 w-20 h-20 rounded-full bg-white/5"})]}),a.jsxs("div",{className:"relative -mt-16 px-6 pb-6",children:[a.jsx("div",{className:"flex justify-center mb-4",children:a.jsx("div",{className:"w-24 h-24 rounded-full border-4 border-white shadow-xl flex items-center justify-center relative overflow-hidden",style:{background:g?"linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)":w?"linear-gradient(135deg, #ec4899 0%, #be185d 100%)":"linear-gradient(135deg, #6b7280 0%, #374151 100%)"},children:h.photo&&!h.photo.includes("/api/placeholder")?a.jsx("img",{src:h.photo,alt:`${e.firstName} ${e.lastName}`,className:"w-full h-full rounded-full object-cover"}):a.jsx("div",{className:"flex items-center justify-center w-full h-full",children:g?a.jsx(Na,{size:40,color:"white",strokeWidth:1.5}):w?a.jsx(sn,{size:40,color:"white",strokeWidth:1.5,className:"transform scale-x-[-1]"}):a.jsx(sn,{size:40,color:"white",strokeWidth:1.5})})})}),a.jsxs("div",{className:"text-center mb-6",children:[a.jsxs("h2",{className:"text-2xl font-bold mb-2",style:{color:i==="dark"?"#f9fafb":"#111827"},children:[e.firstName," ",e.lastName]}),a.jsxs("div",{className:"flex flex-wrap justify-center gap-2 mb-4",children:[a.jsx("div",{className:"px-3 py-1 rounded-full text-xs font-medium",style:{backgroundColor:g?"#dbeafe":w?"#fce7f3":"#f3f4f6",color:g?"#1d4ed8":w?"#be185d":"#374151"},children:g?l==="ar"?"":"Male":w?l==="ar"?"":"Female":l==="ar"?" ":"Unknown"}),y&&a.jsxs("div",{className:"px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",children:[y," ",l==="ar"?"":"years old"]}),(v=e.death)!=null&&v.date||h.deathDate?a.jsx("div",{className:"px-3 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200",children:l==="ar"?"":"Deceased"}):a.jsx("div",{className:"px-3 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200",children:l==="ar"?"  ":"Living"})]})]}),a.jsxs("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:[a.jsxs("div",{className:"rounded-2xl p-4 border",style:{backgroundColor:i==="dark"?"#374151":"#f8fafc",borderColor:i==="dark"?"#4b5563":"#e2e8f0"},children:[a.jsxs("div",{className:"flex items-center mb-3",children:[a.jsx(sn,{size:18,className:"mr-2",style:{color:i==="dark"?"#9ca3af":"#6b7280"}}),a.jsx("h3",{className:"font-semibold",style:{color:i==="dark"?"#f9fafb":"#111827"},children:l==="ar"?" ":"Personal Information"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[(((N=e.birth)==null?void 0:N.date)||h.birthDate)&&a.jsxs("div",{className:"flex items-center",children:[a.jsx(Ur,{size:14,className:"mr-2 text-blue-500"}),a.jsxs("span",{style:{color:i==="dark"?"#d1d5db":"#6b7280"},children:[a.jsx("strong",{children:l==="ar"?" :":"Birth Date:"})," ",((A=e.birth)==null?void 0:A.date)||h.birthDate]})]}),(((P=e.death)==null?void 0:P.date)||h.deathDate)&&a.jsxs("div",{className:"flex items-center",children:[a.jsx(Ur,{size:14,className:"mr-2 text-gray-500"}),a.jsxs("span",{style:{color:i==="dark"?"#d1d5db":"#6b7280"},children:[a.jsx("strong",{children:l==="ar"?" :":"Death Date:"})," ",((U=e.death)==null?void 0:U.date)||h.deathDate]})]}),(((M=e.birth)==null?void 0:M.place)||h.birthPlace)&&a.jsxs("div",{className:"flex items-center",children:[a.jsx(ai,{size:14,className:"mr-2 text-green-500"}),a.jsxs("span",{style:{color:i==="dark"?"#d1d5db":"#6b7280"},children:[a.jsx("strong",{children:l==="ar"?" :":"Birth Place:"})," ",((S=e.birth)==null?void 0:S.place)||h.birthPlace]})]}),h.occupation&&a.jsxs("div",{className:"flex items-center",children:[a.jsx(sn,{size:14,className:"mr-2 text-purple-500"}),a.jsxs("span",{style:{color:i==="dark"?"#d1d5db":"#6b7280"},children:[a.jsx("strong",{children:l==="ar"?":":"Occupation:"})," ",h.occupation]})]})]})]}),a.jsxs("div",{className:"rounded-2xl p-4 border",style:{backgroundColor:i==="dark"?"#374151":"#f8fafc",borderColor:i==="dark"?"#4b5563":"#e2e8f0"},children:[a.jsxs("div",{className:"flex items-center mb-3",children:[a.jsx(In,{size:18,className:"mr-2 text-blue-500"}),a.jsx("h3",{className:"font-semibold",style:{color:i==="dark"?"#f9fafb":"#111827"},children:l==="ar"?"":"Parents"})]}),a.jsxs("div",{className:"space-y-2",children:[(()=>{var _,T;const C=eee(e.id,r,s);return C?a.jsxs("div",{className:"flex items-center p-3 rounded-xl border hover:shadow-md transition-all duration-200",style:{backgroundColor:i==="dark"?"#1f2937":"#ffffff",borderColor:i==="dark"?"#4b5563":"#e5e7eb"},children:[a.jsx("div",{className:"w-10 h-10 rounded-full mr-3 flex items-center justify-center",style:{backgroundColor:"#dbeafe"},children:a.jsx(Na,{size:16,color:"#3b82f6"})}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("p",{className:"font-medium",style:{color:i==="dark"?"#f9fafb":"#111827"},children:[a.jsx("span",{className:"text-xs text-blue-600 dark:text-blue-400 block",children:l==="ar"?"":"Father"}),C.firstName," ",C.lastName]}),(((_=C.birth)==null?void 0:_.date)||C.birthDate)&&a.jsxs("p",{className:"text-xs",style:{color:i==="dark"?"#9ca3af":"#6b7280"},children:[l==="ar"?" :":"Born:"," ",((T=C.birth)==null?void 0:T.date)||C.birthDate]})]})]}):a.jsxs("div",{className:"flex items-center p-3 rounded-xl border",style:{backgroundColor:i==="dark"?"#1f2937":"#f9fafb",borderColor:i==="dark"?"#4b5563":"#e5e7eb"},children:[a.jsx("div",{className:"w-10 h-10 rounded-full mr-3 flex items-center justify-center",style:{backgroundColor:"#f3f4f6"},children:a.jsx(Na,{size:16,color:"#9ca3af"})}),a.jsx("div",{className:"flex-1",children:a.jsxs("p",{className:"text-sm",style:{color:i==="dark"?"#9ca3af":"#6b7280"},children:[a.jsx("span",{className:"text-xs block",children:l==="ar"?"":"Father"}),l==="ar"?" ":"Not registered"]})})]})})(),(()=>{var _,T;const C=tee(e.id,r,s);return C?a.jsxs("div",{className:"flex items-center p-3 rounded-xl border hover:shadow-md transition-all duration-200",style:{backgroundColor:i==="dark"?"#1f2937":"#ffffff",borderColor:i==="dark"?"#4b5563":"#e5e7eb"},children:[a.jsx("div",{className:"w-10 h-10 rounded-full mr-3 flex items-center justify-center",style:{backgroundColor:"#fce7f3"},children:a.jsx(vf,{size:16,className:"w-4 h-4"})}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("p",{className:"font-medium",style:{color:i==="dark"?"#f9fafb":"#111827"},children:[a.jsx("span",{className:"text-xs text-pink-600 dark:text-pink-400 block",children:l==="ar"?"":"Mother"}),C.firstName," ",C.lastName]}),(((_=C.birth)==null?void 0:_.date)||C.birthDate)&&a.jsxs("p",{className:"text-xs",style:{color:i==="dark"?"#9ca3af":"#6b7280"},children:[l==="ar"?" :":"Born:"," ",((T=C.birth)==null?void 0:T.date)||C.birthDate]})]})]}):a.jsxs("div",{className:"flex items-center p-3 rounded-xl border",style:{backgroundColor:i==="dark"?"#1f2937":"#f9fafb",borderColor:i==="dark"?"#4b5563":"#e5e7eb"},children:[a.jsx("div",{className:"w-10 h-10 rounded-full mr-3 flex items-center justify-center",style:{backgroundColor:"#f3f4f6"},children:a.jsx(sn,{size:16,className:"w-4 h-4 opacity-50"})}),a.jsx("div",{className:"flex-1",children:a.jsxs("p",{className:"text-sm",style:{color:i==="dark"?"#9ca3af":"#6b7280"},children:[a.jsx("span",{className:"text-xs block",children:l==="ar"?"":"Mother"}),l==="ar"?" ":"Not registered"]})})]})})()]})]}),a.jsxs("div",{className:"rounded-2xl p-4 border",style:{backgroundColor:i==="dark"?"#374151":"#f8fafc",borderColor:i==="dark"?"#4b5563":"#e2e8f0"},children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(Or,{size:18,className:"mr-2 text-pink-500"}),a.jsx("h3",{className:"font-semibold",style:{color:i==="dark"?"#f9fafb":"#111827"},children:l==="ar"?"":"Spouses"})]}),c.length>0&&a.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-pink-100 text-pink-800 dark:bg-pink-900 dark:text-pink-200",children:c.length})]}),c.length>0?a.jsx("div",{className:"space-y-2",children:c.map(C=>{var _;return a.jsxs("div",{className:"flex items-center p-3 rounded-xl border hover:shadow-md transition-all duration-200",style:{backgroundColor:i==="dark"?"#1f2937":"#ffffff",borderColor:i==="dark"?"#4b5563":"#e5e7eb"},children:[a.jsx("div",{className:"w-10 h-10 rounded-full mr-3 flex items-center justify-center",style:{backgroundColor:C.gender==="male"?"#dbeafe":"#fce7f3"},children:C.gender==="male"?a.jsx(Na,{size:16,color:"#3b82f6"}):a.jsx(vf,{size:16,className:"w-4 h-4"})}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("p",{className:"font-medium",style:{color:i==="dark"?"#f9fafb":"#111827"},children:[C.firstName," ",C.lastName]}),((_=C.birth)==null?void 0:_.date)&&a.jsxs("p",{className:"text-xs",style:{color:i==="dark"?"#9ca3af":"#6b7280"},children:[l==="ar"?" :":"Born:"," ",C.birth.date]})]})]},C.id)})}):a.jsxs("div",{className:"text-center py-4",children:[a.jsx(Or,{size:24,className:"mx-auto mb-2 text-gray-400"}),a.jsx("p",{className:"text-sm",style:{color:i==="dark"?"#9ca3af":"#6b7280"},children:l==="ar"?"   ":"No spouses listed"})]})]}),a.jsxs("div",{className:"rounded-2xl p-4 border",style:{backgroundColor:i==="dark"?"#374151":"#f8fafc",borderColor:i==="dark"?"#4b5563":"#e2e8f0"},children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx(na,{size:18,className:"mr-2 text-blue-500"}),a.jsx("h3",{className:"font-semibold",style:{color:i==="dark"?"#f9fafb":"#111827"},children:l==="ar"?"":"Children"})]}),d.length>0&&a.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",children:d.length})]}),d.length>0?a.jsx("div",{className:"space-y-2",children:d.map(C=>{var _;return a.jsxs("div",{className:"flex items-center p-3 rounded-xl border hover:shadow-md transition-all duration-200",style:{backgroundColor:i==="dark"?"#1f2937":"#ffffff",borderColor:i==="dark"?"#4b5563":"#e5e7eb"},children:[a.jsx("div",{className:"w-10 h-10 rounded-full mr-3 flex items-center justify-center",style:{backgroundColor:C.gender==="male"?"#dbeafe":"#fce7f3"},children:C.gender==="male"?a.jsx(Na,{size:16,color:"#3b82f6"}):a.jsx(vf,{size:16,className:"w-4 h-4"})}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("p",{className:"font-medium",style:{color:i==="dark"?"#f9fafb":"#111827"},children:[C.firstName," ",C.lastName]}),((_=C.birth)==null?void 0:_.date)&&a.jsxs("p",{className:"text-xs",style:{color:i==="dark"?"#9ca3af":"#6b7280"},children:[l==="ar"?" :":"Born:"," ",C.birth.date]})]})]},C.id)})}):a.jsxs("div",{className:"text-center py-4",children:[a.jsx(na,{size:24,className:"mx-auto mb-2 text-gray-400"}),a.jsx("p",{className:"text-sm",style:{color:i==="dark"?"#9ca3af":"#6b7280"},children:l==="ar"?"   ":"No children listed"})]})]})]})]})]})})},see=({data:e,id:t})=>{const{theme:n,language:r="en"}=Xt(),{isMobile:s}=Tr(),{selectedNodeId:i,setSelectedNodeId:l,toggleNodeCollapse:o,collapsedNodes:c}=L7(),u=i===t,d=e.birthDate||e.occupation||e.birthPlace,f=s?220:280,m=s?d?220:190:d?240:210,h=e.gender||"unknown",x=h==="female",y=h==="male",g=e.familyRole==="patriarch"?{primary:"#1e40af",secondary:"#dbeafe",accent:"#3b82f6"}:e.familyRole==="matriarch"?{primary:"#be185d",secondary:"#fce7f3",accent:"#ec4899"}:y?{primary:"#3b82f6",secondary:"#dbeafe",accent:"#60a5fa"}:x?{primary:"#ec4899",secondary:"#fce7f3",accent:"#f472b6"}:{primary:"#6b7280",secondary:"#f3f4f6",accent:"#9ca3af"},[w,v]=Y.useState(e.colorCode||g.primary),N=U=>{U.stopPropagation(),l(u?null:t)},P=(()=>{if(!e.birthDate)return null;const U=new Date(e.birthDate).getFullYear();return(e.deathDate?new Date(e.deathDate).getFullYear():new Date().getFullYear())-U})();return a.jsxs("div",{className:`relative rounded-2xl cursor-pointer transition-all duration-300 ${u?"ring-4 ring-blue-400 shadow-2xl scale-105":"shadow-lg hover:shadow-xl hover:scale-102"}`,style:{width:f,minHeight:m,backgroundColor:n==="dark"?"#1f2937":"#ffffff",border:`2px solid ${u?g.accent:"transparent"}`,zIndex:u?100:1,background:`linear-gradient(135deg, ${g.secondary} 0%, ${n==="dark"?"#1f2937":"#ffffff"} 100%)`,overflow:u?"visible":"hidden"},onClick:N,children:[a.jsxs("div",{className:"absolute top-0 left-0 right-0 h-8 rounded-t-2xl flex items-center justify-between px-3",style:{background:`linear-gradient(90deg, ${w} 0%, ${g.accent} 100%)`,boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:[a.jsxs("div",{className:"flex items-center space-x-1",children:[e.familyRole==="patriarch"&&a.jsx(Nu,{size:14,color:"white"}),e.familyRole==="matriarch"&&a.jsx(Nu,{size:14,color:"white"}),e.isRoot&&a.jsx(b0,{size:14,color:"white"}),e.generation!==void 0&&e.familyRole!=="spouse"&&!(e.gender==="female"&&e.spouseIds&&e.spouseIds.length>0)&&a.jsxs("span",{className:"text-xs text-white font-medium",children:["G",e.generation]})]}),a.jsxs("div",{className:"flex items-center space-x-1",children:[e.relationshipStatus==="married"&&a.jsx(Or,{size:12,color:"white"}),e.spouses&&e.spouses.length>0&&a.jsx(Or,{size:12,color:"white"}),e.children&&e.children.length>0&&a.jsx(na,{size:12,color:"white"}),e.children&&e.children.length>0&&a.jsx("button",{type:"button",onClick:U=>{U.stopPropagation(),o(e.id)},title:c.has(e.id)?r==="ar"?" ":"Expand children":r==="ar"?" ":"Collapse children",className:"ml-2 flex items-center justify-center w-6 h-6 rounded-md",style:{backgroundColor:"rgba(255,255,255,0.25)",border:"1px solid rgba(255,255,255,0.5)"},children:c.has(e.id)?a.jsx(ny,{size:14,color:"#ffffff"}):a.jsx(aj,{size:14,color:"#ffffff"})})]})]}),a.jsx("div",{className:"absolute top-12 left-1/2 transform -translate-x-1/2",children:a.jsx("div",{className:"w-16 h-16 rounded-full border-4 border-white shadow-md flex items-center justify-center",style:{backgroundColor:g.primary},children:y?a.jsx(Na,{size:24,color:"white"}):x?a.jsx(sn,{size:24,className:"w-6 h-6"}):a.jsx(sn,{size:24,color:"white"})})}),a.jsxs("div",{className:"absolute top-32 left-0 right-0 bottom-10 text-center px-4 overflow-hidden",children:[a.jsx("p",{className:"font-bold text-base truncate mb-1",style:{color:n==="dark"?"#f9fafb":"#111827",lineHeight:"1.2",margin:"0",padding:"0",border:"none",outline:"none",background:"transparent",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.name}),(P||e.birthDate)&&a.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[a.jsx(Ur,{size:12,color:n==="dark"?"#9ca3af":"#6b7280"}),a.jsxs("span",{className:"text-xs",style:{color:n==="dark"?"#9ca3af":"#6b7280",lineHeight:"1.2",margin:"0",padding:"0",border:"none",outline:"none",background:"transparent",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:[P?`${P} `:new Date(e.birthDate).getFullYear(),e.deathDate&&` - ${new Date(e.deathDate).getFullYear()}`]})]}),e.occupation&&a.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[a.jsx(sn,{size:12,color:n==="dark"?"#9ca3af":"#6b7280"}),a.jsx("span",{className:"text-xs truncate",style:{color:n==="dark"?"#9ca3af":"#6b7280",lineHeight:"1.2",margin:"0",padding:"0",border:"none",outline:"none",background:"transparent",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.occupation})]}),e.birthPlace&&a.jsxs("div",{className:"flex items-center justify-center space-x-2 mb-2",children:[a.jsx(ai,{size:12,color:n==="dark"?"#9ca3af":"#6b7280"}),a.jsx("span",{className:"text-xs truncate",style:{color:n==="dark"?"#9ca3af":"#6b7280",lineHeight:"1.2",margin:"0",padding:"0",border:"none",outline:"none",background:"transparent",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:e.birthPlace})]})]}),a.jsxs("div",{className:"absolute top-10 right-2 flex flex-col space-y-1",children:[e.spouses&&e.spouses.length>0&&a.jsxs("div",{className:"flex items-center space-x-1 bg-pink-100 dark:bg-pink-900 px-2 py-1 rounded-full shadow-sm",children:[a.jsx(Or,{size:8,color:"#ec4899"}),a.jsx("span",{className:"text-xs font-medium",style:{color:"#ec4899",lineHeight:"1.2",margin:"0",padding:"0",border:"none",outline:"none",background:"transparent",overflow:"hidden",textOverflow:"ellipsis"},children:e.spouses.length})]}),e.children&&e.children.length>0&&a.jsxs("div",{className:"flex items-center space-x-1 bg-blue-100 dark:bg-blue-900 px-2 py-1 rounded-full shadow-sm",children:[a.jsx(na,{size:8,color:"#3b82f6"}),a.jsx("span",{className:"text-xs font-medium",style:{color:"#3b82f6",lineHeight:"1.2",margin:"0",padding:"0",border:"none",outline:"none",background:"transparent",overflow:"hidden",textOverflow:"ellipsis"},children:e.children.length})]}),e.siblings&&e.siblings.length>0&&a.jsxs("div",{className:"flex items-center space-x-1 bg-green-100 dark:bg-green-900 px-2 py-1 rounded-full shadow-sm",children:[a.jsx(In,{size:8,color:"#10b981"}),a.jsx("span",{className:"text-xs font-medium",style:{color:"#10b981",lineHeight:"1.2",margin:"0",padding:"0",border:"none",outline:"none",background:"transparent",overflow:"hidden",textOverflow:"ellipsis"},children:e.siblings.length})]})]}),e.isOwnedTree&&a.jsxs("div",{className:"absolute bottom-0 left-0 right-0 flex rounded-b-2xl overflow-hidden pointer-events-auto",children:[a.jsxs("div",{className:"flex-1 flex items-center justify-center py-2 cursor-pointer hover:opacity-80 transition-opacity",style:{backgroundColor:g.primary},onClick:U=>{var M;U.stopPropagation(),(M=e.onSelectPerson)==null||M.call(e,e.id)},children:[a.jsx(ra,{size:14,color:"white",className:"mr-1"}),a.jsx("span",{className:"text-white text-xs font-medium",style:{lineHeight:"1.2",margin:"0",padding:"0",border:"none",outline:"none",background:"transparent",overflow:"hidden",textOverflow:"ellipsis"},children:r==="ar"?"":"View"})]}),a.jsxs("div",{className:"flex-1 flex items-center justify-center py-2 cursor-pointer hover:opacity-80 transition-opacity",style:{backgroundColor:"#10b981"},onClick:U=>{var M;U.stopPropagation(),(M=e.onAddChild)==null||M.call(e,e.id)},children:[a.jsx(_u,{size:14,color:"white",className:"mr-1"}),a.jsx("span",{className:"text-white text-xs font-medium",style:{lineHeight:"1.2",margin:"0",padding:"0",border:"none",outline:"none",background:"transparent",overflow:"hidden",textOverflow:"ellipsis"},children:r==="ar"?"":"Add"})]})]}),u&&e.isOwnedTree&&a.jsxs("div",{className:"absolute flex items-center justify-center space-x-2 bg-white dark:bg-gray-800 rounded-xl shadow-2xl p-2 border-2",style:{top:-60,left:"50%",transform:"translateX(-50%)",zIndex:1e3,borderColor:g.accent},children:[e.onAddSibling&&a.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-purple-500 rounded-full cursor-pointer hover:bg-purple-600 transition-colors",onClick:U=>{var M;U.stopPropagation(),(M=e.onAddSibling)==null||M.call(e,e.id)},title:r==="ar"?" /":"Add Sibling",children:a.jsx(In,{size:14,color:"white"})}),a.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-yellow-500 rounded-full cursor-pointer hover:bg-yellow-600 transition-colors",onClick:U=>{var M;U.stopPropagation(),(M=e.onEditPerson)==null||M.call(e,e.id)},title:r==="ar"?"":"Edit",children:a.jsx(sa,{size:14,color:"white"})}),a.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-red-500 rounded-full cursor-pointer hover:bg-red-600 transition-colors",onClick:U=>{var M;U.stopPropagation(),(M=e.onDeletePerson)==null||M.call(e,e.id)},title:r==="ar"?"":"Delete",children:a.jsx(Ia,{size:14,color:"white"})})]}),a.jsx(Di,{type:"target",position:zt.Top,style:{background:g.primary,width:12,height:12,zIndex:10,border:"2px solid transparent",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},isConnectable:!0}),a.jsx(Di,{type:"source",position:zt.Bottom,style:{background:g.primary,width:12,height:12,zIndex:10,border:"2px solid transparent",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},isConnectable:!0}),a.jsx(Di,{type:"source",position:zt.Right,style:{background:"#ec4899",width:12,height:12,zIndex:10,right:-6,top:"50%",transform:"translateY(-50%)",border:"2px solid transparent",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},isConnectable:!0,id:"spouse"}),a.jsx(Di,{type:"target",position:zt.Left,style:{background:"#ec4899",width:12,height:12,zIndex:10,left:-6,top:"50%",transform:"translateY(-50%)",border:"2px solid transparent",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},isConnectable:!0,id:"spouse"})]})},iee=({data:e,id:t})=>{const{theme:n}=Xt(),{isMobile:r}=Tr(),{selectedNodeId:s,setSelectedNodeId:i,toggleNodeCollapse:l,collapsedNodes:o}=L7(),c=s===t,u=e.spouses||[],d=Math.min(u.length,3),f=r?300:400,m=r?200:280,h=x=>{x.stopPropagation(),i(c?null:t)};return a.jsxs("div",{className:`relative rounded-2xl cursor-pointer transition-all duration-300 ${c?"ring-4 ring-pink-400 shadow-2xl scale-105":"shadow-lg hover:shadow-xl hover:scale-102"}`,style:{width:f,height:m,backgroundColor:n==="dark"?"#1f2937":"#ffffff",border:`2px solid ${c?"#ec4899":"transparent"}`,zIndex:c?100:1,background:`linear-gradient(135deg, #fce7f3 0%, ${n==="dark"?"#1f2937":"#ffffff"} 100%)`},onClick:h,children:[a.jsx("div",{className:"absolute top-0 left-0 right-0 h-10 rounded-t-2xl flex items-center justify-center",style:{background:"linear-gradient(90deg, #ec4899 0%, #f472b6 100%)",boxShadow:"0 2px 4px rgba(0,0,0,0.1)"},children:a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Or,{size:16,color:"white"}),a.jsx("span",{className:"text-white font-bold text-sm",style:{lineHeight:"1.2",margin:"0",padding:"0",border:"none",outline:"none",background:"transparent",overflow:"hidden",textOverflow:"ellipsis"},children:" "}),a.jsx(Or,{size:16,color:"white"})]})}),a.jsx("div",{className:"absolute top-12 left-5 right-5 bottom-16 flex space-x-2",children:u.slice(0,d).map((x,y)=>{var N;const p=((N=x.attributes)==null?void 0:N.gender)||x.gender||"unknown",g=p==="male",w=p==="female",v={primary:g?"#3b82f6":w?"#ec4899":"#6b7280",secondary:g?"#dbeafe":w?"#fce7f3":"#f3f4f6"};return a.jsxs("div",{className:"flex-1 relative rounded-xl border-2 overflow-hidden",style:{borderColor:v.primary,background:`linear-gradient(135deg, ${v.secondary} 0%, ${n==="dark"?"#374151":"#ffffff"} 100%)`},children:[a.jsx("div",{className:"h-6 flex items-center justify-center",style:{backgroundColor:v.primary},children:a.jsx("span",{className:"text-white text-xs font-medium",style:{lineHeight:"1.2",margin:"0",padding:"0",border:"none",outline:"none",background:"transparent",overflow:"hidden",textOverflow:"ellipsis"},children:g?"":w?"":""})}),a.jsx("div",{className:"flex justify-center mt-2",children:x.photo?a.jsx("img",{src:x.photo,alt:x.name,className:"w-12 h-12 rounded-full border-2 border-white shadow-md object-cover"}):a.jsx("div",{className:"w-12 h-12 rounded-full border-2 border-white shadow-md flex items-center justify-center",style:{backgroundColor:v.primary},children:g?a.jsx(Na,{size:16,color:"white"}):w?a.jsx(vf,{size:16,className:"w-4 h-4"}):a.jsx(sn,{size:16,color:"white"})})}),a.jsxs("div",{className:"text-center mt-2 px-2",children:[a.jsx("p",{className:"font-bold text-sm truncate",style:{color:n==="dark"?"#f9fafb":"#111827",lineHeight:"1.2",margin:"0",padding:"0",border:"none",outline:"none",background:"transparent",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:x.name}),x.birthDate&&a.jsxs("div",{className:"flex items-center justify-center mt-1",children:[a.jsx(Ur,{size:10,color:n==="dark"?"#9ca3af":"#6b7280"}),a.jsx("span",{className:"text-xs ml-1",style:{color:n==="dark"?"#9ca3af":"#6b7280",lineHeight:"1.2",margin:"0",padding:"0",border:"none",outline:"none",background:"transparent",overflow:"hidden",textOverflow:"ellipsis"},children:new Date(x.birthDate).getFullYear()})]})]}),a.jsxs("div",{className:"absolute bottom-2 left-2 right-2 flex space-x-1",children:[a.jsx("button",{className:"flex-1 py-1 rounded text-xs text-white font-medium hover:opacity-80 transition-opacity",style:{backgroundColor:v.primary},onClick:A=>{var P;A.stopPropagation(),(P=e.onSelectPerson)==null||P.call(e,x.id)},children:a.jsx("span",{style:{lineHeight:"1.2",margin:"0",padding:"0",border:"none",outline:"none",background:"transparent",overflow:"hidden",textOverflow:"ellipsis"},children:""})}),a.jsx("button",{className:"flex-1 py-1 rounded text-xs text-white font-medium bg-green-500 hover:opacity-80 transition-opacity",onClick:A=>{var P;A.stopPropagation(),(P=e.onAddChild)==null||P.call(e,x.id)},children:a.jsx("span",{style:{lineHeight:"1.2",margin:"0",padding:"0",border:"none",outline:"none",background:"transparent",overflow:"hidden",textOverflow:"ellipsis"},children:""})})]})]},x.id)})}),a.jsx("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 flex items-center space-x-2",children:u.length>1&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center space-x-1 bg-pink-100 dark:bg-pink-900 px-3 py-1 rounded-full",children:[a.jsx(Or,{size:12,color:"#ec4899"}),a.jsxs("span",{className:"text-xs font-medium",style:{color:"#ec4899",lineHeight:"1.2",margin:"0",padding:"0",border:"none",outline:"none",background:"transparent",overflow:"hidden",textOverflow:"ellipsis"},children:[u.length," "]})]}),e.children&&e.children.length>0&&a.jsxs("div",{className:"flex items-center space-x-1 bg-blue-100 dark:bg-blue-900 px-3 py-1 rounded-full",children:[a.jsx(na,{size:12,color:"#3b82f6"}),a.jsxs("span",{className:"text-xs font-medium",style:{color:"#3b82f6",lineHeight:"1.2",margin:"0",padding:"0",border:"none",outline:"none",background:"transparent"},children:[e.children.length," "]})]})]})}),c&&e.isOwnedTree&&a.jsxs("div",{className:"absolute flex items-center justify-center space-x-2 bg-white dark:bg-gray-800 rounded-xl shadow-2xl p-2 border-2 border-pink-400",style:{top:-60,left:"50%",transform:"translateX(-50%)",zIndex:1e3},children:[a.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-pink-500 rounded-full cursor-pointer hover:bg-pink-600 transition-colors",onClick:x=>{var y;x.stopPropagation(),u.length>0&&((y=e.onAddSpouse)==null||y.call(e,u[0].id))},title:" / ",children:a.jsx(Or,{size:14,color:"white"})}),a.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-green-500 rounded-full cursor-pointer hover:bg-green-600 transition-colors",onClick:x=>{var y;x.stopPropagation(),u.length>0&&((y=e.onAddChild)==null||y.call(e,u[0].id))},title:"  ",children:a.jsx(na,{size:14,color:"white"})}),a.jsx("div",{className:"flex items-center justify-center w-8 h-8 bg-yellow-500 rounded-full cursor-pointer hover:bg-yellow-600 transition-colors",onClick:x=>{var y;x.stopPropagation(),u.length>0&&((y=e.onEditPerson)==null||y.call(e,u[0].id))},title:" ",children:a.jsx(sa,{size:14,color:"white"})})]}),a.jsx(Di,{type:"target",position:zt.Top,style:{background:"#ec4899",width:14,height:14,zIndex:10,border:"2px solid transparent",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},isConnectable:!0}),a.jsx(Di,{type:"source",position:zt.Bottom,style:{background:"#ec4899",width:14,height:14,zIndex:10,border:"2px solid transparent",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},isConnectable:!0}),a.jsx(Di,{type:"source",position:zt.Right,style:{background:"#ec4899",width:14,height:14,zIndex:10,right:-7,top:"50%",transform:"translateY(-50%)",border:"2px solid transparent",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},isConnectable:!0,id:"spouse"}),a.jsx(Di,{type:"target",position:zt.Left,style:{background:"#ec4899",width:14,height:14,zIndex:10,left:-7,top:"50%",transform:"translateY(-50%)",border:"2px solid transparent",boxShadow:"0 2px 4px rgba(0,0,0,0.2)"},isConnectable:!0,id:"spouse"})]})},aee={person:see,combinedSpouse:iee},oee=({persons:e,rootPersonId:t,onSelectPerson:n,onEditPerson:r,onDeletePerson:s,onAddChild:i,onAddSpouse:l,onAddFather:o,onAddMother:c,onAddSibling:u,relationships:d,dataVersion:f=0,isOwnedTree:m=!1,isInteractivityLocked:h=!1,triggerFitView:x=0})=>{const y=Ir(),[p,g,w]=GJ([]),[v,N,A]=YJ([]),{theme:P,language:U}=Xt(),{isMobile:M}=Tr(),[S,C]=Y.useState(null);Y.useEffect(()=>{S&&x&&setTimeout(()=>{try{S.fitView({duration:300,padding:.2,includeHiddenNodes:!0})}catch{}},50)},[x,S]);const[_,T]=Y.useState(null),[B,$]=Y.useState(null),[D,L]=Y.useState(new Set),[O,W]=Y.useState(!1),[E,H]=Y.useState(()=>{const Ne=localStorage.getItem("familyTreeManualConnections");return Ne?JSON.parse(Ne):[]}),V=Y.useRef({}),[R,q]=Y.useState(()=>{const Ne=localStorage.getItem("familyTreeCustomPositions");return Ne?JSON.parse(Ne):{}}),[F,G]=Y.useState({}),[ee,ae]=Y.useState(null),[re,Q]=Y.useState(!1),fe=Y.useRef(null),Se=(Ne,de)=>{const se=document.createElement("a");se.href=Ne,se.download=de,document.body.appendChild(se),se.click(),document.body.removeChild(se)},oe=async()=>{if(!fe.current||!S)return;const Ne=S.getViewport();let de=null;try{const se=S.getNodes();if(se.length===0)return;const{minX:he,minY:ke,maxX:be,maxY:Le}=me(se),He=80,Ue=Math.max(be-he+He*2,800),De=Math.max(Le-ke+He*2,600);de=ne(Ue,De),await it(de,Ue,De,he,ke,He);const _e=await $e(de,Ue,De);Se(_e,"-.png")}catch(se){console.error("   PNG:",se)}finally{de&&document.body.contains(de)&&document.body.removeChild(de),S.setViewport(Ne)}},pe=async()=>{if(!fe.current||!S)return;const Ne=S.getViewport();let de=null;try{const se=S.getNodes(),he=S.getEdges();if(se.length===0){alert("   ");return}const{minX:ke,minY:be,maxX:Le,maxY:He}=me(se),Ue=80,De=Math.max(Le-ke+Ue*2,800),_e=Math.max(He-be+Ue*2,600);de=ne(De,_e),await it(de,De,_e,ke,be,Ue);const Ie=await $e(de,De,_e);Oe(Ie,De,_e)}catch(se){console.error("   PDF:",se),alert("    ")}finally{de&&document.body.contains(de)&&document.body.removeChild(de),S.setViewport(Ne)}},me=Ne=>{let de=1/0,se=1/0,he=-1/0,ke=-1/0;return Ne.forEach(be=>{const Le=be.width||150,He=be.height||80;de=Math.min(de,be.position.x),se=Math.min(se,be.position.y),he=Math.max(he,be.position.x+Le),ke=Math.max(ke,be.position.y+He)}),{minX:de,minY:se,maxX:he,maxY:ke}},ne=(Ne,de)=>{const se=document.createElement("div");return se.style.position="fixed",se.style.top="0",se.style.left="0",se.style.width=`${Ne}px`,se.style.height=`${de}px`,se.style.backgroundColor="#ffffff",se.style.zIndex="99999",se.style.overflow="hidden",se.style.pointerEvents="none",se},it=async(Ne,de,se,he,ke,be)=>{var Ue;const Le=(Ue=fe.current)==null?void 0:Ue.querySelector(".react-flow");if(!Le)return;const He=Le.cloneNode(!0);He.style.width=`${de}px`,He.style.height=`${se}px`,He.style.position="absolute",He.style.left="0",He.style.top="0",He.style.background="#ffffff";try{const De=He.querySelector(".react-flow__viewport"),_e=He.querySelector(".react-flow__nodes");De&&(De.style.transform=`translate(${be-he}px, ${be-ke}px) scale(1)`),_e&&(_e.style.transform="")}catch{}Ne.appendChild(He),document.body.appendChild(Ne);try{const De="#94a3b8";Ne.querySelectorAll(".react-flow__edge-path, .react-flow__edge-animated").forEach(ht=>{ht.style.stroke=De}),Ne.querySelectorAll("marker path, marker polygon, marker circle").forEach(ht=>{ht.style.stroke=De,ht.style.fill=De})}catch{}await new Promise(De=>setTimeout(De,150))},$e=async(Ne,de,se)=>{const he=Ne;if(!he)throw new Error("Export container not found for export");const ke=de||he.clientWidth||800,be=se||he.clientHeight||600;return await QQ(he,{cacheBust:!0,pixelRatio:2,backgroundColor:"#ffffff",skipFonts:!0,width:ke,height:be,filter:He=>{const Ue=He==null?void 0:He.classList;return!(Ue!=null&&Ue.contains("react-flow__minimap"))&&!(Ue!=null&&Ue.contains("react-flow__controls"))}})},Oe=(Ne,de,se)=>{const he=new Zt({orientation:de>=se?"landscape":"portrait",unit:"px",format:[de,se]});he.addImage(Ne,"PNG",0,0,de,se,"","FAST"),he.save("-.pdf")},qe=Ne=>{if(!Ne.length)return"";const de=Object.keys(Ne[0]),se=ke=>{const be=String(ke??""),Le=/[",\n]/.test(be),He=be.replace(/"/g,'""');return Le?`"${He}"`:He};return[de.join(","),...Ne.map(ke=>de.map(be=>se(ke[be])).join(","))].join(`
`)},gt=()=>{if(!(!e||e.length===0))try{const Ne=["ID","First Name","Last Name","Gender","Birth Date","Birth Place","Is Alive"],de=e.map(be=>{var He,Ue,De;const Le=be;return{ID:be.id,"First Name":be.firstName||"","Last Name":be.lastName||"",Gender:be.gender||"","Birth Date":((He=Le.birth)==null?void 0:He.date)||Le.birthDate||"","Birth Place":((Ue=Le.birth)==null?void 0:Ue.place)||Le.birthPlace||"","Is Alive":(De=Le.death)!=null&&De.date||Le.deathDate?"No":"Yes"}}),se=qe(de),he=new Blob(["\uFEFF"+se],{type:"text/csv;charset=utf-8;"}),ke=URL.createObjectURL(he);Se(ke,`family_tree_export_${new Date().toISOString().slice(0,10)}.csv`),URL.revokeObjectURL(ke),dn.success({en:"Tree exported as CSV successfully",ar:"    CSV "})}catch(Ne){console.error("Export error:",Ne),dn.error({en:"Failed to export tree as CSV",ar:"     CSV"})}},ut=Y.useCallback(Ne=>{const de=e.find(se=>se.id.toString()===Ne);de&&(ae(de),Q(!0))},[e]),Rt=Y.useCallback(()=>{Q(!1),ae(null)},[]),Nt=Y.useCallback((Ne,de,se=new Set)=>{if(se.has(Ne))return[];se.add(Ne);const he=de.get(Ne)||[];let ke=[...he];return he.forEach(be=>{const Le=Nt(be,de,se);ke=[...ke,...Le]}),ke},[]),ye=Y.useCallback(Ne=>{const de=new Map,se=new Map;e.forEach(he=>{var He,Ue,De;const ke=he.id.toString(),be=he,Le=be.parentIds||be.parents||be.parent_ids||((He=be.relationships)==null?void 0:He.parents)||[];if(Le&&Le.length>0)if(Array.isArray(Le))Le.forEach(_e=>{var ht,wt;let Ie="";typeof _e=="object"&&(_e!=null&&_e.id)?Ie=_e.id.toString():(typeof _e=="string"||typeof _e=="number")&&(Ie=_e.toString()),Ie&&(de.has(Ie)||de.set(Ie,[]),(ht=de.get(Ie))!=null&&ht.includes(ke)||(wt=de.get(Ie))==null||wt.push(ke))});else{let _e="";typeof Le=="object"&&(Le!=null&&Le.id)?_e=Le.id.toString():(typeof Le=="string"||typeof Le=="number")&&(_e=Le.toString()),_e&&(de.has(_e)||de.set(_e,[]),(Ue=de.get(_e))!=null&&Ue.includes(ke)||(De=de.get(_e))==null||De.push(ke))}if(be.relationships&&Array.isArray(be.relationships)){const _e=be.relationships.filter(Ie=>(Ie.relationshipType==="Spouse"||Ie.relationshipType==="spouse"||Ie.relationshipType==="Husband"||Ie.relationshipType==="husband"||Ie.relationshipType==="Wife"||Ie.relationshipType==="wife")&&(Ie.personId.toString()===ke||Ie.relatedPersonId.toString()===ke));_e&&_e.length>0&&_e.forEach(Ie=>{var wt,St;let ht="";if(Ie.personId.toString()===ke?ht=Ie.relatedPersonId.toString():Ie.relatedPersonId.toString()===ke&&(ht=Ie.personId.toString()),ht){se.has(ke)||se.set(ke,[]);const Vt=se.get(ke)!==void 0?se.get(ke):[];(!Vt||!Vt.includes(ht))&&((wt=se.get(ke))==null||wt.push(ht)),se.has(ht)||se.set(ht,[]);const qn=se.get(ht)!==void 0?se.get(ht):[];qn&&!qn.includes(ke)&&((St=se.get(ht))==null||St.push(ke))}})}he.relationships&&he.relationships.spouses&&he.relationships.spouses.forEach(_e=>{var ht,wt,St;let Ie="";if(typeof _e=="object"&&(_e!=null&&_e.person)?typeof _e.person=="object"&&((ht=_e.person)!=null&&ht.id)?Ie=_e.person.id.toString():typeof _e.person=="string"&&(Ie=_e.person.toString()):typeof _e=="string"&&(Ie=_e.toString()),Ie&&Ie!==ke&&!(se.get(ke)||[]).includes(Ie)){se.has(ke)||se.set(ke,[]),(wt=se.get(ke))==null||wt.push(Ie),se.has(Ie)||se.set(Ie,[]);const qn=se.get(Ie)!==void 0?se.get(Ie):[];qn&&!qn.includes(ke)&&((St=se.get(Ie))==null||St.push(ke))}}),be.spouseIds&&Array.isArray(be.spouseIds)&&be.spouseIds.forEach(_e=>{var ht,wt;const Ie=_e.toString();if(Ie&&Ie!==ke&&!(se.get(ke)||[]).includes(Ie)){se.has(ke)||se.set(ke,[]),(ht=se.get(ke))==null||ht.push(Ie),se.has(Ie)||se.set(Ie,[]);const Vt=se.get(Ie)!==void 0?se.get(Ie):[];Vt&&!Vt.includes(ke)&&((wt=se.get(Ie))==null||wt.push(ke))}})}),d&&Array.isArray(d)&&d.forEach(he=>{var ke,be,Le,He,Ue,De;if(he.relationshipType==="Spouse"||he.relationshipType==="spouse"||he.relationshipType==="Husband"||he.relationshipType==="husband"||he.relationshipType==="Wife"||he.relationshipType==="wife"){const _e=he.personId.toString(),Ie=he.relatedPersonId.toString();se.has(_e)||se.set(_e,[]);const ht=se.get(_e)!==void 0?se.get(_e):[];(!ht||!ht.includes(Ie))&&((ke=se.get(_e))==null||ke.push(Ie)),se.has(Ie)||se.set(Ie,[]);const wt=se.get(Ie)!==void 0?se.get(Ie):[];wt&&!wt.includes(_e)&&((be=se.get(Ie))==null||be.push(_e))}else if(he.relationshipType==="Father"||he.relationshipType==="father"||he.relationshipType==="Mother"||he.relationshipType==="mother"||he.relationshipType==="Parent"||he.relationshipType==="parent"){const _e=he.personId.toString(),Ie=he.relatedPersonId.toString();de.has(Ie)||de.set(Ie,[]),(Le=de.get(Ie))!=null&&Le.includes(_e)||(He=de.get(Ie))==null||He.push(_e)}else if(he.relationshipType==="Child"||he.relationshipType==="child"||he.relationshipType==="Son"||he.relationshipType==="son"||he.relationshipType==="Daughter"||he.relationshipType==="daughter"){const _e=he.personId.toString(),Ie=he.relatedPersonId.toString();de.has(_e)||de.set(_e,[]),(Ue=de.get(_e))!=null&&Ue.includes(Ie)||(De=de.get(_e))==null||De.push(Ie)}}),L(he=>{const ke=new Set(he);if(ke.has(Ne)){const be=Nt(Ne,de),Le=new Set([Ne,...be]);for(const He of Le)(se.get(He)||[]).forEach(De=>Le.add(De));for(const He of Le)ke.delete(He)}else{g(He=>{const Ue={},De=Nt(Ne,de),_e=new Set([Ne,...De]);for(const Ie of _e)(se.get(Ie)||[]).forEach(wt=>_e.add(wt));He.forEach(Ie=>{_e.has(Ie.id)&&(Ue[Ie.id]={...Ie.position})}),G(Ie=>({...Ie,...Ue})),q(Ie=>({...Ie,...Ue}));try{const Ie=localStorage.getItem("familyTreeCustomPositions"),ht=Ie?JSON.parse(Ie):{};localStorage.setItem("familyTreeCustomPositions",JSON.stringify({...ht,...Ue}))}catch{}return He});const be=Nt(Ne,de),Le=new Set([Ne,...be]);for(const He of Le)(se.get(He)||[]).forEach(De=>Le.add(De));for(const He of Le)ke.add(He)}return ke})},[e,d,Nt]),ze=Y.useMemo(()=>{if(!e||e.length===0)return{flowNodes:[],flowEdges:[]};const Ne=new Map;e.forEach(lt=>{var Dt,Gt,Ht,ot,_t,Et;const Fe=lt;Ne.set(lt.id.toString(),{id:lt.id.toString(),name:`${lt.firstName||""} ${lt.lastName||""}`.trim()||"Unknown",gender:lt.gender||"unknown",birthDate:((Dt=Fe.birth)==null?void 0:Dt.date)||Fe.birthDate||"",deathDate:((Gt=Fe.death)==null?void 0:Gt.date)||Fe.deathDate||"",birthPlace:((Ht=Fe.birth)==null?void 0:Ht.place)||Fe.birthPlace||"",occupation:((_t=(ot=Fe.occupation)==null?void 0:ot[0])==null?void 0:_t.title)||Fe.occupation||"",photo:((Et=Fe.primaryPhoto)==null?void 0:Et.url)||Fe.photo||"",latitude:Fe.latitude??Fe.Latitude??null,longitude:Fe.longitude??Fe.Longitude??null,colorCode:Fe.ColorCode??Fe.colorCode??null,familyTreeId:Fe.FamilyTreeId??Fe.familyTreeId??null,children:[],spouses:[],siblings:[],parents:[],relationshipStatus:"single",marriageDate:"",generation:0,familyRole:"child"})});const de=new Map,se=new Map,he=new Map;e.forEach(lt=>{var Ht,ot,_t,Et;const Fe=lt.id.toString(),Dt=lt,Gt=Dt.parentIds||Dt.parents||Dt.parent_ids||((Ht=Dt.relationships)==null?void 0:Ht.parents)||[];if(Gt&&Gt.length>0)if(Array.isArray(Gt))Gt.forEach(ft=>{var Te,Ee,et,kt;let at="";typeof ft=="object"&&(ft!=null&&ft.id)?at=ft.id.toString():(typeof ft=="string"||typeof ft=="number")&&(at=ft.toString()),at&&(de.has(Fe)||de.set(Fe,[]),(Te=de.get(Fe))!=null&&Te.includes(at)||(Ee=de.get(Fe))==null||Ee.push(at),se.has(at)||se.set(at,[]),(et=se.get(at))!=null&&et.includes(Fe)||(kt=se.get(at))==null||kt.push(Fe))});else{let ft="";typeof Gt=="object"&&(Gt!=null&&Gt.id)?ft=Gt.id.toString():(typeof Gt=="string"||typeof Gt=="number")&&(ft=Gt.toString()),ft&&(de.has(Fe)||de.set(Fe,[]),(ot=de.get(Fe))==null||ot.push(ft),se.has(ft)||se.set(ft,[]),(_t=se.get(ft))!=null&&_t.includes(Fe)||(Et=se.get(ft))==null||Et.push(Fe))}if(Dt.relationships&&Array.isArray(Dt.relationships)){const ft=Dt.relationships.filter(at=>(at.relationshipType==="Spouse"||at.relationshipType==="spouse"||at.relationshipType==="Husband"||at.relationshipType==="husband"||at.relationshipType==="Wife"||at.relationshipType==="wife")&&(at.personId.toString()===Fe||at.relatedPersonId.toString()===Fe));ft&&ft.length>0&&ft.forEach(at=>{var Ee,et;let Te="";if(at.personId.toString()===Fe?Te=at.relatedPersonId.toString():at.relatedPersonId.toString()===Fe&&(Te=at.personId.toString()),Te){he.has(Fe)||he.set(Fe,[]);const kt=he.get(Fe)!==void 0?he.get(Fe):[];(!kt||!kt.includes(Te))&&((Ee=he.get(Fe))==null||Ee.push(Te)),he.has(Te)||he.set(Te,[]);const vt=he.get(Te)!==void 0?he.get(Te):[];vt&&!vt.includes(Fe)&&((et=he.get(Te))==null||et.push(Fe))}})}lt.relationships&&lt.relationships.spouses&&lt.relationships.spouses.forEach(ft=>{var Te,Ee,et;let at="";if(typeof ft=="object"&&(ft!=null&&ft.person)?typeof ft.person=="object"&&((Te=ft.person)!=null&&Te.id)?at=ft.person.id.toString():typeof ft.person=="string"&&(at=ft.person.toString()):typeof ft=="string"&&(at=ft.toString()),at&&at!==Fe&&!(he.get(Fe)||[]).includes(at)){he.has(Fe)||he.set(Fe,[]),(Ee=he.get(Fe))==null||Ee.push(at),he.has(at)||he.set(at,[]);const vt=he.get(at)!==void 0?he.get(at):[];vt&&!vt.includes(Fe)&&((et=he.get(at))==null||et.push(Fe))}}),Dt.spouseIds&&Array.isArray(Dt.spouseIds)&&Dt.spouseIds.forEach(ft=>{var Te,Ee;const at=ft.toString();if(at&&at!==Fe&&!(he.get(Fe)||[]).includes(at)){he.has(Fe)||he.set(Fe,[]),(Te=he.get(Fe))==null||Te.push(at),he.has(at)||he.set(at,[]);const kt=he.get(at)!==void 0?he.get(at):[];kt&&!kt.includes(Fe)&&((Ee=he.get(at))==null||Ee.push(Fe))}})}),d&&Array.isArray(d)&&d.forEach(lt=>{var Fe,Dt,Gt,Ht,ot,_t,Et,ft,at,Te;if(lt.relationshipType==="Spouse"||lt.relationshipType==="spouse"||lt.relationshipType==="Husband"||lt.relationshipType==="husband"||lt.relationshipType==="Wife"||lt.relationshipType==="wife"){const Ee=lt.personId.toString(),et=lt.relatedPersonId.toString();he.has(Ee)||he.set(Ee,[]);const kt=he.get(Ee)!==void 0?he.get(Ee):[];(!kt||!kt.includes(et))&&((Fe=he.get(Ee))==null||Fe.push(et)),he.has(et)||he.set(et,[]);const vt=he.get(et)!==void 0?he.get(et):[];vt&&!vt.includes(Ee)&&((Dt=he.get(et))==null||Dt.push(Ee))}else if(lt.relationshipType==="Father"||lt.relationshipType==="father"||lt.relationshipType==="Mother"||lt.relationshipType==="mother"||lt.relationshipType==="Parent"||lt.relationshipType==="parent"){const Ee=lt.personId.toString(),et=lt.relatedPersonId.toString();de.has(Ee)||de.set(Ee,[]),(Gt=de.get(Ee))!=null&&Gt.includes(et)||(Ht=de.get(Ee))==null||Ht.push(et),se.has(et)||se.set(et,[]),(ot=se.get(et))!=null&&ot.includes(Ee)||(_t=se.get(et))==null||_t.push(Ee)}else if(lt.relationshipType==="Child"||lt.relationshipType==="child"||lt.relationshipType==="Son"||lt.relationshipType==="son"||lt.relationshipType==="Daughter"||lt.relationshipType==="daughter"){const Ee=lt.personId.toString(),et=lt.relatedPersonId.toString();de.has(et)||de.set(et,[]),(Et=de.get(et))!=null&&Et.includes(Ee)||(ft=de.get(et))==null||ft.push(Ee),se.has(Ee)||se.set(Ee,[]),(at=se.get(Ee))!=null&&at.includes(et)||(Te=se.get(Ee))==null||Te.push(et)}});const ke=[],be=new Set;if(de.forEach((lt,Fe)=>{be.add(Fe)}),t){const lt=Ne.get(t);lt&&ke.push(lt);const Fe=new Set,Dt=[t];for(;Dt.length>0;){const Gt=Dt.shift();if(Fe.has(Gt))continue;Fe.add(Gt),(se.get(Gt)||[]).forEach(Et=>{Fe.has(Et)||Dt.push(Et)}),(de.get(Gt)||[]).forEach(Et=>{Fe.has(Et)||Dt.push(Et)}),(he.get(Gt)||[]).forEach(Et=>{Fe.has(Et)||Dt.push(Et)})}e.forEach(Gt=>{const Ht=Gt.id.toString();if(!Fe.has(Ht)&&!be.has(Ht)){const ot=Ne.get(Ht);ot&&ke.push(ot)}})}else e.forEach(lt=>{const Fe=lt.id.toString();if(!be.has(Fe)){const Dt=Ne.get(Fe);Dt&&ke.push(Dt)}});const Le=new Set;e.forEach(lt=>{const Fe=lt.id.toString(),Dt=Ne.get(Fe);(de.get(Fe)||[]).forEach(Ht=>{const ot=`${Ht}-${Fe}`;if(Le.has(ot))return;Le.add(ot);const _t=Ne.get(Ht);_t&&Dt&&(_t.children.some(ft=>ft.id===Dt.id)||_t.children.push(Dt))})});const He=new Set;e.forEach(lt=>{const Fe=lt.id.toString();(se.get(Fe)||[]).forEach(Gt=>{const Ht=de.get(Gt)||[];if(Ht.length>1){const ot=new Set;Ht.forEach(_t=>{Ht.forEach(Et=>{var ft,at;if(_t!==Et){const Te=[_t,Et].sort().join("-");if(!ot.has(Te)){ot.add(Te);const Ee=`${_t}-${Et}`;if(He.has(Ee))return;He.add(Ee);const et=he.get(_t)||[],kt=he.get(Et)||[];et.includes(Et)||(he.has(_t)||he.set(_t,[]),(ft=he.get(_t))==null||ft.push(Et)),kt.includes(_t)||(he.has(Et)||he.set(Et,[]),(at=he.get(Et))==null||at.push(_t))}}})})}})});const De=((lt,Fe,Dt,Gt)=>{const Ht=new Map,ot=new Set;Fe.forEach((Ee,et)=>{ot.add(et)});const _t=lt.filter(Ee=>!ot.has(Ee.id.toString()));_t.forEach(Ee=>{Ht.set(Ee.id.toString(),0)});const Et=_t.map(Ee=>({personId:Ee.id.toString(),generation:0})),ft=new Set;_t.forEach(Ee=>ft.add(Ee.id.toString()));const at=new Map;lt.forEach(Ee=>{const et=Ee.id.toString(),kt=Ee.gender==="male"&&Gt.has(et)&&Gt.get(et).length>0;at.set(et,kt)});const Te=new Map;for(;Et.length>0;){const{personId:Ee,generation:et}=Et.shift();(Gt.get(Ee)||[]).forEach(vt=>{if(ft.has(vt)){const At=at.get(Ee)||!1,Ct=Te.get(vt),Lt=Ct?at.get(Ct):!1;At&&!Lt&&(Ht.set(vt,et+1),Te.set(vt,Ee))}else Ht.set(vt,et+1),ft.add(vt),Te.set(vt,Ee),Et.push({personId:vt,generation:et+1})})}return Dt.forEach((Ee,et)=>{const kt=Ht.get(et);if(kt!==void 0)Ee.forEach(vt=>{Ht.has(vt)||Ht.set(vt,kt)});else for(const vt of Ee){const At=Ht.get(vt);if(At!==void 0){Ht.set(et,At),Ee.forEach(Ct=>{Ht.has(Ct)||Ht.set(Ct,At)});break}}}),Ht})(e,de,he,se);Ne.forEach((lt,Fe)=>{De.has(Fe)&&(lt.generation=De.get(Fe))});const _e=[],Ie=[],ht=new Map,wt=lt=>lt;(()=>{const lt=new Map,Fe=ot=>{var Ee;const _t=Ne.get(ot);if(!_t)return{horizontal:200,vertical:80};const Et=_t.children.length,ft=((Ee=he.get(ot))==null?void 0:Ee.length)||0;let at=200,Te=80;return Et>2&&(at=180+Et*20),ft>1&&(at=Math.max(at,150+ft*80)),{horizontal:at,vertical:Te}},Dt=new Set,Gt=(ot,_t,Et,ft)=>{const at=wt(ot.id);if(Et>50){console.warn("Maximum depth reached for node processing, stopping recursion");return}if(Dt.has(at))return;if(Dt.add(at),ht.has(at)){_t&&(Ie.some(Bt=>Bt.source===_t&&Bt.target===at)||Ie.push({id:`${_t}-${at}`,source:_t,target:at,type:"bezier",markerEnd:{type:vi.Arrow},style:{strokeWidth:2}}));return}ht.set(at,at);const Te=he.get(ot.id)||[],Ee=se.get(ot.id)||[],et=de.get(ot.id)||[];let kt="child";Et===1&&Ee.length>0?kt=ot.gender==="female"?"matriarch":"patriarch":Ee.length>0?kt="parent":Te.length>0&&(kt="spouse");const vt=Te.map(ct=>{const Bt=Ne.get(ct);return Bt?{id:Bt.id,name:Bt.name,gender:Bt.gender,birthDate:Bt.birthDate,photo:Bt.photo}:null}).filter(Boolean),At=Ee.map(ct=>{const Bt=Ne.get(ct);return Bt?{id:Bt.id,name:Bt.name,gender:Bt.gender}:null}).filter(Boolean),Ct=new Set;et.forEach(ct=>{(se.get(ct)||[]).forEach(an=>{an!==ot.id&&Ct.add(an)})});const Lt=Array.from(Ct).map(ct=>{const Bt=Ne.get(ct);return Bt?{id:Bt.id,name:Bt.name,gender:Bt.gender}:null}).filter(Boolean);let Gn={x:ft.x,y:ft.y};if(ot.latitude!=null&&ot.longitude!=null&&ot.latitude!==""&&ot.longitude!==""&&!Number.isNaN(Number(ot.latitude))&&!Number.isNaN(Number(ot.longitude))&&!(Number(ot.latitude)===0&&Number(ot.longitude)===0)){const ct=Number(ot.latitude),Bt=Number(ot.longitude);Gn={x:ct,y:Bt}}else{const ct=R[at];ct?Gn=ct:Gn={x:ft.x,y:ft.y}}let Lr=De.get(ot.id)??1;const nt={id:at,type:"person",position:Gn,data:{id:ot.id,name:ot.name,gender:ot.gender,birthDate:ot.birthDate,deathDate:ot.deathDate,birthPlace:ot.birthPlace,occupation:ot.occupation,photo:ot.photo,isCombinedSpouseNode:!1,spouses:vt,spouseIds:Te,children:At,siblings:Lt,relationshipStatus:Te.length>0?"married":"single",isOwnedTree:m,onEditPerson:r,onDeletePerson:s,onAddChild:i,onAddSpouse:l,onAddFather:o,onAddMother:c,onAddSibling:u,onSelectPerson:ut,navigate:y,isCollapsed:D.has(ot.id),isRoot:Et===0,generation:Lr,familyRole:kt}};lt.set(at,{node:nt,parentId:_t,depth:Et,position:ft,children:[],spouses:[]}),_e.push(nt),_t&&Ie.push({id:`${_t}-${at}`,source:_t,target:at,type:"custom",data:{target:at,hasChildren:ot.children&&ot.children.length>0,isOwnedTree:m},markerEnd:{type:vi.Arrow},style:{strokeWidth:2}});const Qt=he.get(ot.id)||[];if(Qt.length>0){const Bt=(Qt.length-1)*150;let an=ft.x-Bt/2;Qt.forEach((en,mt)=>{const Ft=Ne.get(en);if(Ft){let on;if(Qt.length===1)on=ft.x+150;else if(mt<Math.floor(Qt.length/2))on=an+mt*150;else if(mt===Math.floor(Qt.length/2)&&Qt.length%2===1)on=ft.x+150;else{const mn=mt-Math.floor(Qt.length/2)-Qt.length%2;on=ft.x+150+mn*150}const rn={x:on,y:ft.y};Gt(Ft,null,Et,rn);const Cn=[at,en].sort().join("-");Ie.some(mn=>mn.id===Cn)||Ie.push({id:Cn,source:at,target:en,type:"custom",data:{target:en,isOwnedTree:m},style:{stroke:"#ec4899",strokeWidth:2},markerEnd:{type:vi.Arrow,color:"#ec4899"},sourceHandle:"spouse",targetHandle:"spouse"});const _n=lt.get(at);_n&&_n.spouses.push(en)}})}if(!D.has(ot.id)){Fe(ot.id);const ct=new Map,Bt=[];ot.children.forEach(an=>{let en=null;if(d&&Array.isArray(d)){const mt=d.find(Ft=>Ft.personId.toString()===an.id&&(Ft.relationshipType==="Mother"||Ft.relationshipType==="mother"));mt&&(en=mt.relatedPersonId.toString())}en&&Qt.includes(en)?(ct.has(en)||ct.set(en,[]),ct.get(en).push(an)):Bt.push(an)}),Qt.forEach(an=>{(ct.get(an)||[]).forEach(mt=>{var Hn,hr;const Ft=Ne.get(an),on=wt(an),rn=lt.get(on);ft.x,rn&&rn.position.x;const Cn=((hr=(Hn=lt.get(at))==null?void 0:Hn.node)==null?void 0:hr.height)||0,bn=(Cn>0?Cn:200)+100,_n={x:ft.x,y:ft.y+bn};Gt(mt,at,Et+1,_n);const mn=lt.get(at);if(mn&&mn.children.push(wt(mt.id)),(de.get(mt.id)||[]).forEach(Jr=>{const ar=wt(Jr),Rn=wt(mt.id);if(!Ie.some(Nr=>Nr.source===ar&&Nr.target===Rn)&&ht.has(ar)){const Nr=Ne.get(Jr),Wn=(Nr==null?void 0:Nr.gender)==="female"?"#ec4899":"#3b82f6";Ie.push({id:`${ar}-${Rn}`,source:ar,target:Rn,type:"custom",data:{target:Rn,hasChildren:(Nr==null?void 0:Nr.children)&&Nr.children.length>0,isOwnedTree:m},style:{stroke:Wn,strokeWidth:2},markerEnd:{type:vi.Arrow,color:Wn}})}}),ot.gender==="male"&&Qt.length>0){const Jr=mt.id;let ar=null;if(d&&Array.isArray(d)){const Rn=d.find(mr=>mr.personId.toString()===Jr&&(mr.relationshipType==="Mother"||mr.relationshipType==="mother"));Rn&&(ar=Rn.relatedPersonId.toString())}if(!ar&&Qt.length>0&&(ar=Qt[0]),ar){const Rn=wt(ar),mr=wt(Jr);!Ie.some(Wn=>Wn.source===Rn&&Wn.target===mr)&&ht.has(Rn)&&Ie.push({id:`mother-${Rn}-${mr}`,source:Rn,target:mr,type:"custom",data:{target:mr,hasChildren:(Ft==null?void 0:Ft.children)&&Ft.children.length>0,isOwnedTree:m},style:{stroke:"#ec4899",strokeWidth:2,strokeDasharray:"5,5"},markerEnd:{type:vi.Arrow,color:"#ec4899"}})}}})}),Bt.forEach(an=>{var Cn,bn;const en=((bn=(Cn=lt.get(at))==null?void 0:Cn.node)==null?void 0:bn.height)||0,mt=(en>0?en:200)+100,Ft={x:ft.x,y:ft.y+mt};Gt(an,at,Et+1,Ft);const on=lt.get(at);on&&on.children.push(wt(an.id)),(de.get(an.id)||[]).forEach(_n=>{const mn=wt(_n),Bn=wt(an.id);if(!Ie.some(hr=>hr.source===mn&&hr.target===Bn)&&ht.has(mn)){const hr=Ne.get(_n),Jr=(hr==null?void 0:hr.gender)==="female"?"#ec4899":"#3b82f6";Ie.push({id:`parent-${mn}-${Bn}`,source:mn,target:Bn,type:"custom",data:{target:Bn,hasChildren:(hr==null?void 0:hr.children)&&hr.children.length>0},style:{stroke:Jr,strokeWidth:2},markerEnd:{type:vi.Arrow,color:Jr}})}})})}};let Ht=0;return ke.forEach(ot=>{const _t=De.get(ot.id)||1,Et=Fe(ot.id),ft={x:Ht*Et.horizontal*1.5,y:0};Gt(ot,null,_t,ft),Ht++}),e.forEach(ot=>{var ft;const _t=ot.id.toString(),Et=wt(_t);if(!ht.has(Et)){const at=Ne.get(_t);if(at){const Te=de.get(_t)||[];if(!Te.some(et=>D.has(et))){const et=se.has(_t)&&se.get(_t).length>0,kt=Te.some(vt=>ht.has(wt(vt)));if(!et&&!kt){const vt=Fe(_t),At={x:Ht*vt.horizontal*.8,y:0};Gt(at,null,1,At),Ht++}else if(kt){const vt=Te.find(At=>ht.has(wt(At)));if(vt){const At=lt.get(wt(vt));if(At){const Ct=At.position,Lt=((ft=At.node)==null?void 0:ft.height)||0,Gn=(Lt>0?Lt:200)+100,Lr={x:Ct.x,y:Ct.y+Gn};Gt(at,wt(vt),At.depth+1,Lr)}}}}}}}),{flowNodes:_e,flowEdges:Ie}})();const Vt=_e,qn=R||{},En=new Set,Dn={};return _e.forEach(lt=>{const Fe=!!qn[lt.id],Dt=lt.data,Gt=Dt&&("latitude"in Dt&&Dt.latitude!=null&&Dt.latitude!==""||"longitude"in Dt&&Dt.longitude!=null&&Dt.longitude!=="");if(Fe)Dn[lt.id]={...qn[lt.id]},En.add(lt.id);else if(Gt){const Ht=Number(Dt.latitude),ot=Number(Dt.longitude);!Number.isNaN(Ht)&&!Number.isNaN(ot)&&(Dn[lt.id]={x:Ht,y:ot},En.add(lt.id))}}),Vt.map(lt=>En.has(lt.id)&&Dn[lt.id]?{...lt,position:Dn[lt.id]}:lt),{flowNodes:_e,flowEdges:Ie}},[e,d,m,r,s,i,l,o,c,y,D,ut,R]);Y.useEffect(()=>{if(ze){const{flowNodes:Ne,flowEdges:de}=ze,se=new Map;de.forEach(_e=>{var Ie;if(((Ie=_e.style)==null?void 0:Ie.stroke)==="#ec4899"){const ht=[_e.source,_e.target].sort().join("-");se.has(ht)||se.set(ht,_e)}});const he=Array.from(se.values()),be=[...de.filter(_e=>{var Ie;return((Ie=_e.style)==null?void 0:Ie.stroke)!=="#ec4899"}),...he],Le=E.map((_e,Ie)=>({id:`manual-${_e.source}-${_e.target}-${Ie}`,source:_e.source,target:_e.target,type:"custom",data:{target:_e.target},markerEnd:{type:vi.Arrow},style:{stroke:"#8b5cf6",strokeWidth:2}}));let He=[...be,...Le];_&&(He=He.map(_e=>{var Ie,ht;if(_e.source===_||_e.target===_){const wt=typeof((Ie=_e.style)==null?void 0:Ie.strokeWidth)=="number"?_e.style.strokeWidth:2;return{..._e,animated:!0,style:{..._e.style,stroke:((ht=_e.style)==null?void 0:ht.stroke)==="#ec4899"?"#ff6b9d":"#a78bfa",strokeWidth:wt+1,filter:"drop-shadow(0 0 4px rgba(167, 139, 250, 0.7))"}}}return _e}));const Ue=Ne.map(_e=>{var qn;const Ie=_e.data||{},ht=(qn=Ie.id??Ie.personId??_e.id)==null?void 0:qn.toString();if(Ie&&("latitude"in Ie&&Ie.latitude!=null&&Ie.latitude!==""||"longitude"in Ie&&Ie.longitude!=null&&Ie.longitude!=="")){const En=Number(Ie.latitude),Dn=Number(Ie.longitude),lt=!Number.isNaN(En)&&!Number.isNaN(Dn)&&En===0&&Dn===0;if(!Number.isNaN(En)&&!Number.isNaN(Dn)&&!lt)return{..._e,position:{x:En,y:Dn}}}const St=R[ht],Vt=V.current[ht];return St?{..._e,position:{x:St.x,y:St.y}}:Vt?{..._e,position:{x:Vt.x,y:Vt.y}}:_e});g(Ue),N(He);const De={};Ue.forEach(_e=>{var wt;const Ie=_e.data||{},ht=(wt=Ie.id??Ie.personId??_e.id)==null?void 0:wt.toString();De[ht]={..._e.position}}),V.current=De}},[ze,g,N,D,E,_]),Y.useCallback(()=>{H([]),localStorage.removeItem("familyTreeManualConnections"),N(Ne=>Ne.filter(de=>!de.id.startsWith("manual-")))},[N]);const Ze=Y.useCallback(Ne=>{H(se=>{const he=[...se,Ne];return localStorage.setItem("familyTreeManualConnections",JSON.stringify(he)),he});const de={id:`manual-${Ne.source}-${Ne.target}-${Date.now()}`,source:Ne.source,target:Ne.target,type:"custom",data:{target:Ne.target},markerEnd:{type:vi.Arrow},style:{stroke:"#8b5cf6",strokeWidth:2}};N(se=>VA(de,se))},[N,H]),xe=Y.useCallback((Ne,de,se)=>{g(he=>he.map(ke=>ke.id===de.id?{...ke,position:{x:de.position.x,y:de.position.y}}:ke))},[g]),pt=Y.useCallback(()=>{g(Ne=>{const de={},se={};return Ne.forEach(he=>{var Le;const ke=he.data||{},be=(Le=ke.id??ke.personId??he.id)==null?void 0:Le.toString();de[be]={...he.position},se[be]={...he.position}}),V.current=de,q(se),localStorage.setItem("familyTreeCustomPositions",JSON.stringify(se)),Ne.forEach(he=>{var ht,wt;const ke=he.data||{},be=ke.id??ke.personId??he.id,Le=(ht=ke.id??ke.personId??he.id)==null?void 0:ht.toString(),He=se[Le],Ue=String(be),De=/^\d+$/.test(Ue),_e=(wt=Ue.match(/\d+/))==null?void 0:wt[0],Ie=De?Number(Ue):_e?Number(_e):NaN;if(He&&Number.isFinite(Ie)){const St=ke.familyTreeId??void 0;Pt.safeUpdatePersonPosition(Ie,St,He.x,He.y).catch(Vt=>{console.error("Failed to update position (safe)",Vt)})}else if(He){const St=String(be),Vt=e.find(Dn=>{var lt,Fe;return((lt=Dn.id)==null?void 0:lt.toString())===St||((Fe=Dn.id)==null?void 0:Fe.toString())===String(he.id)}),qn=Vt?Number(Vt.id):NaN,En=ke.familyTreeId??(Vt?Vt.FamilyTreeId??Vt.familyTreeId:void 0);Number.isFinite(qn)?Pt.safeUpdatePersonPosition(qn,En,He.x,He.y).catch(Dn=>{console.error("Failed to update position (safe)",Dn)}):Pt.safeUpdatePersonPosition(qn,En,He.x,He.y).catch(()=>{})}else console.warn("Skipping position update due to non-numeric ID or missing position",{rawId:be,stableKey:Le,pos:He})}),Ne})},[g]);return a.jsx(T7.Provider,{value:{selectedNodeId:_,setSelectedNodeId:T,collapsedNodes:D,toggleNodeCollapse:ye},children:a.jsx(qb,{children:a.jsxs("div",{ref:fe,className:"w-full h-full relative",children:[a.jsx("div",{className:`absolute z-20 flex flex-col gap-3 ${M?"top-2 right-2 gap-2":"top-6 right-6 gap-3"}`,children:a.jsxs("div",{className:"flex flex-col gap-2 mt-2",children:[a.jsx("button",{className:"px-2 py-1 text-xs rounded-md font-medium bg-blue-600 text-white hover:bg-blue-700 transition-all duration-200 shadow-md",onClick:oe,title:U==="ar"?"  PNG":"Export as PNG",children:" PNG"}),a.jsx("button",{className:"px-2 py-1 text-xs rounded-md font-medium bg-indigo-600 text-white hover:bg-indigo-700 transition-all duration-200 shadow-md",onClick:pe,title:U==="ar"?"  PDF":"Export as PDF",children:" PDF"}),a.jsx("button",{className:"px-2 py-1 text-xs rounded-md font-medium bg-green-600 text-white hover:bg-green-700 transition-all duration-200 shadow-md",onClick:gt,title:U==="ar"?"  CSV":"Export as CSV",children:" CSV"})]})}),a.jsxs(Ak,{nodes:p,edges:v,onNodesChange:w,onEdgesChange:A,onConnect:Ze,onNodeDrag:h?void 0:xe,onNodeDragStop:pt,nodeTypes:aee,edgeTypes:{custom:nee},defaultEdgeOptions:{type:"custom",markerEnd:{type:vi.Arrow},style:{strokeWidth:2}},style:{zIndex:1},fitView:!0,fitViewOptions:{padding:.1,includeHiddenNodes:!0},nodesDraggable:!h,nodesConnectable:O&&!h,elementsSelectable:!h,selectNodesOnDrag:!1,connectionLineStyle:{stroke:"#8b5cf6",strokeWidth:3},minZoom:.05,maxZoom:2,defaultViewport:{x:0,y:0,zoom:.3},onNodeClick:(Ne,de)=>{T(de.id)},onInit:C,onPaneClick:()=>{T(null)},children:[a.jsx(xZ,{variant:Bi.Dots,gap:20,size:2,color:P==="dark"?"#374151":"#e5e7eb"}),a.jsx(dZ,{position:"top-left",style:{backgroundColor:P==="dark"?"#1f2937":"#ffffff",border:"none",borderRadius:"6px",padding:"4px",display:"flex",gap:"4px",boxShadow:P==="dark"?"0 1px 3px rgba(0,0,0,0.4)":"0 1px 3px rgba(0,0,0,0.15)"}}),a.jsx(sZ,{nodeColor:Ne=>{if(Ne.type==="person"){const de=Ne.data;return de.gender==="male"?"#3b82f6":de.gender==="female"?"#ec4899":"#6b7280"}return"#6b7280"},maskColor:P==="dark"?"rgba(31, 41, 55, 0.7)":"rgba(248, 250, 252, 0.7)",nodeBorderRadius:2,nodeStrokeWidth:M?1:2,position:"bottom-right",style:{width:M?120:200,height:M?80:140}})]}),a.jsx(ree,{person:ee,isOpen:re,onClose:Rt,persons:e,relationships:d||[]})]})})})},M7=we.forwardRef((e,t)=>{const[n,r]=Y.useState(null);return we.useImperativeHandle(t,()=>({getReactFlowInstance:()=>n,fitView:s=>n==null?void 0:n.fitView(s)})),a.jsx(oee,{...e,onInit:s=>{var i;r(s),(i=e.onInit)==null||i.call(e,s)}})}),R7=({person:e,isOpen:t,onClose:n})=>{const{language:r}=Xt(),{isMobile:s}=Tr(),i=r==="ar",[l,o]=Y.useState("info");if(!t||!e)return null;const u=((N,A)=>{if(!N)return null;let P;try{if(N.includes("T"))P=new Date(N);else if(N.includes("-")){const C=N.split("-");C.length===3?P=new Date(parseInt(C[0]),parseInt(C[1])-1,parseInt(C[2])):P=new Date(N)}else if(N.includes("/")){const C=N.split("/");C.length===3?P=new Date(parseInt(C[2]),parseInt(C[0])-1,parseInt(C[1])):P=new Date(N)}else P=new Date(N)}catch{return null}if(isNaN(P.getTime()))return null;let U;if(A&&A.trim()!=="")try{if(A.includes("T"))U=new Date(A);else if(A.includes("-")){const C=A.split("-");C.length===3?U=new Date(parseInt(C[0]),parseInt(C[1])-1,parseInt(C[2])):U=new Date(A)}else if(A.includes("/")){const C=A.split("/");C.length===3?U=new Date(parseInt(C[2]),parseInt(C[0])-1,parseInt(C[1])):U=new Date(A)}else U=new Date(A);isNaN(U.getTime())&&(U=new Date)}catch{U=new Date}else U=new Date;let M=U.getFullYear()-P.getFullYear();const S=U.getMonth()-P.getMonth();return(S<0||S===0&&U.getDate()<P.getDate())&&M--,M>=0?M:0})(e.birthDate,e.deathDate),d=e.gender||"unknown",f=d==="male",m=d==="female",h=()=>i?`${e.firstName} ${e.lastName}`:`${e.firstNameEn||e.firstName} ${e.lastNameEn||e.lastName}`,x=e.parents&&e.parents.length>0||e.parentIds&&e.parentIds.length>0,y=e.spouses&&e.spouses.length>0||e.spouseIds&&e.spouseIds.length>0,p=e.childrenDetails&&e.childrenDetails.length>0||e.children&&e.children.length>0,g=!!(e.parents&&e.parents.length>0),w=!!(e.spouses&&e.spouses.length>0),v=!!(e.childrenDetails&&e.childrenDetails.length>0);return console.log("Person data for tabs:",{hasParents:x,hasSpouses:y,hasChildren:p,showDetailedSpouses:w,parents:e.parents,parentIds:e.parentIds,spouses:e.spouses,spouseIds:e.spouseIds,childrenDetails:e.childrenDetails,children:e.children}),a.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center z-50 p-4",onClick:N=>{N.target===N.currentTarget&&n()},children:a.jsxs("div",{className:"relative rounded-3xl shadow-2xl max-h-[95vh] overflow-hidden animate-in fade-in-0 zoom-in-95 duration-300",style:{width:s?"95vw":"600px",background:"linear-gradient(135deg, #ffffff 0%, #f8fafc 100%)",border:"2px solid #e2e8f0"},onClick:N=>N.stopPropagation(),children:[a.jsxs("div",{className:"relative h-32 overflow-hidden",style:{background:f?"linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)":m?"linear-gradient(135deg, #ec4899 0%, #be185d 100%)":"linear-gradient(135deg, #6b7280 0%, #374151 100%)"},children:[a.jsx("button",{onClick:N=>{N.preventDefault(),N.stopPropagation(),n()},className:"absolute top-4 right-4 w-10 h-10 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center hover:bg-white/30 transition-all duration-200 group z-10",type:"button",children:a.jsx(ia,{size:20,className:"text-white group-hover:scale-110 transition-transform"})}),a.jsx("div",{className:"absolute -top-10 -right-10 w-32 h-32 rounded-full bg-white/10"}),a.jsx("div",{className:"absolute -bottom-5 -left-5 w-20 h-20 rounded-full bg-white/5"})]}),a.jsxs("div",{className:"relative -mt-16 px-6 pb-6",children:[a.jsx("div",{className:"flex justify-center mb-4",children:a.jsx("div",{className:"w-24 h-24 rounded-full border-4 border-white shadow-xl flex items-center justify-center relative overflow-hidden",style:{background:f?"linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%)":m?"linear-gradient(135deg, #ec4899 0%, #be185d 100%)":"linear-gradient(135deg, #6b7280 0%, #374151 100%)"},children:e.avatar?a.jsx("img",{src:e.avatar,alt:h(),className:"w-full h-full rounded-full object-cover"}):a.jsx("div",{className:"flex items-center justify-center w-full h-full",children:f?a.jsx(Na,{size:40,color:"white",strokeWidth:1.5}):m?a.jsx(vf,{size:40,color:"white",strokeWidth:1.5}):a.jsx(sn,{size:40,color:"white",strokeWidth:1.5})})})}),a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold mb-2",style:{color:"#111827"},children:h()}),a.jsxs("div",{className:"flex flex-wrap justify-center gap-2 mb-4",children:[a.jsx("div",{className:"px-3 py-1 rounded-full text-xs font-medium",style:{backgroundColor:f?"#dbeafe":m?"#fce7f3":"#f3f4f6",color:f?"#1d4ed8":m?"#be185d":"#374151"},children:f?i?"":"Male":m?i?"":"Female":i?" ":"Unknown"}),u!==null&&a.jsxs("div",{className:"px-3 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[u," ",i?"":"years old"]}),e.deathDate?a.jsx("div",{className:"px-3 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:i?"":"Deceased"}):a.jsx("div",{className:"px-3 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:i?"  ":"Living"}),a.jsx("div",{className:"px-3 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-800",children:i?` ${e.generation}`:`Gen ${e.generation}`})]})]}),a.jsxs("div",{className:`flex ${s?"flex-wrap gap-1 p-1 bg-muted rounded-lg mb-4":"border-b mb-4"}`,style:{minHeight:"40px"},children:[a.jsx("button",{onClick:()=>o("info"),className:`px-3 py-2 text-sm font-medium rounded-lg transition-colors ${l==="info"?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground"} ${s?"flex-1 text-xs py-1.5":""}`,style:{minWidth:"80px"},children:i?"":"Info"}),x&&a.jsxs("button",{onClick:()=>o("parents"),className:`px-3 py-2 text-sm font-medium rounded-lg transition-colors ${l==="parents"?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground"} ${s?"flex-1 text-xs py-1.5":""}`,style:{minWidth:"80px"},children:[i?"":"Parents",a.jsx("span",{className:"ml-1 bg-primary-foreground text-primary text-xs px-1.5 py-0.5 rounded-full",children:g&&e.parents?e.parents.filter((N,A,P)=>A===P.findIndex(U=>U.id===N.id)).length:e.parentIds?e.parentIds.filter((N,A,P)=>A===P.indexOf(N)).length:0})]}),y&&a.jsxs("button",{onClick:()=>o("spouses"),className:`px-3 py-2 text-sm font-medium rounded-lg transition-colors ${l==="spouses"?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground"} ${s?"flex-1 text-xs py-1.5":""}`,style:{minWidth:"80px"},children:[i?"/":"Spouses",a.jsx("span",{className:"ml-1 bg-primary-foreground text-primary text-xs px-1.5 py-0.5 rounded-full",children:w&&e.spouses?e.spouses.filter((N,A,P)=>A===P.findIndex(U=>U.id===N.id)).length:e.spouseIds?e.spouseIds.filter((N,A,P)=>A===P.indexOf(N)).length:0})]}),p&&a.jsxs("button",{onClick:()=>o("children"),className:`px-3 py-2 text-sm font-medium rounded-lg transition-colors ${l==="children"?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground"} ${s?"flex-1 text-xs py-1.5":""}`,style:{minWidth:"80px"},children:[i?"":"Children",a.jsx("span",{className:"ml-1 bg-primary-foreground text-primary text-xs px-1.5 py-0.5 rounded-full",children:v&&e.childrenDetails?e.childrenDetails.filter((N,A,P)=>A===P.findIndex(U=>U.id===N.id)).length:e.children?e.children.filter((N,A,P)=>A===P.indexOf(N)).length:0})]})]}),a.jsxs("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:[l==="info"&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"rounded-2xl p-4 border",style:{backgroundColor:"#f8fafc",borderColor:"#e2e8f0"},children:[a.jsxs("div",{className:"flex items-center mb-3",children:[a.jsx(sn,{size:18,className:"mr-2 text-gray-600"}),a.jsx("h3",{className:"font-semibold",style:{color:"#111827"},children:i?" ":"Personal Information"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 text-sm",children:[e.birthDate&&a.jsxs("div",{className:"flex items-center",children:[a.jsx(Ur,{size:14,className:"mr-2 text-blue-500"}),a.jsxs("span",{style:{color:"#6b7280"},children:[a.jsx("strong",{children:i?" :":"Birth Date:"})," ",new Date(e.birthDate).toLocaleDateString(i?"ar-SA":"en-US")]})]}),e.deathDate&&a.jsxs("div",{className:"flex items-center",children:[a.jsx(Ur,{size:14,className:"mr-2 text-gray-500"}),a.jsxs("span",{style:{color:"#6b7280"},children:[a.jsx("strong",{children:i?" :":"Death Date:"})," ",new Date(e.deathDate).toLocaleDateString(i?"ar-SA":"en-US")]})]}),(e.birthPlace||e.birthPlaceEn)&&a.jsxs("div",{className:"flex items-center",children:[a.jsx(ai,{size:14,className:"mr-2 text-green-500"}),a.jsxs("span",{style:{color:"#6b7280"},children:[a.jsx("strong",{children:i?" :":"Birth Place:"})," ",i?e.birthPlace:e.birthPlaceEn]})]}),(e.occupation||e.occupationEn)&&a.jsxs("div",{className:"flex items-center",children:[a.jsx(Qo,{size:14,className:"mr-2 text-purple-500"}),a.jsxs("span",{style:{color:"#6b7280"},children:[a.jsx("strong",{children:i?":":"Occupation:"})," ",i?e.occupation:e.occupationEn]})]})]})]}),e.photos&&e.photos.length>0||e.documents&&e.documents.length>0?a.jsxs("div",{className:"rounded-2xl p-4 border",style:{backgroundColor:"#f8fafc",borderColor:"#e2e8f0"},children:[a.jsxs("div",{className:"flex items-center mb-3",children:[a.jsx(du,{size:18,className:"mr-2 text-gray-600"}),a.jsx("h3",{className:"font-semibold",style:{color:"#111827"},children:i?"":"Attachments"})]}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.photos&&e.photos.length>0&&a.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[a.jsx(dh,{size:14,className:"mr-1 text-purple-500"}),a.jsxs("span",{children:[e.photos.length," ",i?"":"Photos"]})]}),e.documents&&e.documents.length>0&&a.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[a.jsx(du,{size:14,className:"mr-1 text-gray-500"}),a.jsxs("span",{children:[e.documents.length," ",i?"":"Documents"]})]})]})]}):null]}),l==="parents"&&x&&a.jsxs("div",{className:"rounded-2xl p-4 border",style:{backgroundColor:"#f8fafc",borderColor:"#e2e8f0"},children:[a.jsxs("div",{className:"flex items-center mb-3",children:[a.jsx(Nx,{size:18,className:"mr-2 text-blue-500"}),a.jsx("h3",{className:"font-semibold",style:{color:"#111827"},children:i?"":"Parents"}),a.jsx("span",{className:"ml-2 px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:g&&e.parents?e.parents.filter((N,A,P)=>A===P.findIndex(U=>U.id===N.id)).length:e.parentIds?e.parentIds.filter((N,A,P)=>A===P.indexOf(N)).length:0})]}),a.jsx("div",{className:"space-y-2",children:g&&e.parents?e.parents.filter((N,A,P)=>A===P.findIndex(U=>U.id===N.id)).map((N,A)=>a.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[a.jsx(sn,{size:14,className:"mr-2 text-blue-500"}),a.jsxs("span",{children:[N.name," (",N.relationship,")"]})]},`parent-${N.id}-${A}`)):e.parentIds&&e.parentIds.length>0?e.parentIds.filter((N,A,P)=>A===P.indexOf(N)).map((N,A)=>a.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[a.jsx(sn,{size:14,className:"mr-2 text-blue-500"}),a.jsx("span",{children:i?` ${A+1}`:`Parent ${A+1}`})]},`parent-id-${N}-${A}`)):null})]}),l==="spouses"&&y&&a.jsxs("div",{className:"rounded-2xl p-4 border",style:{backgroundColor:"#f8fafc",borderColor:"#e2e8f0"},children:[a.jsxs("div",{className:"flex items-center mb-3",children:[a.jsx(Or,{size:18,className:"mr-2 text-red-500"}),a.jsx("h3",{className:"font-semibold",style:{color:"#111827"},children:i?"/":"Spouses"}),a.jsx("span",{className:"ml-2 px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:w&&e.spouses?e.spouses.filter((N,A,P)=>A===P.findIndex(U=>U.id===N.id)).length:e.spouseIds?e.spouseIds.filter((N,A,P)=>A===P.indexOf(N)).length:0})]}),a.jsx("div",{className:"space-y-2",children:w&&e.spouses?e.spouses.filter((N,A,P)=>A===P.findIndex(U=>U.id===N.id)).map((N,A)=>a.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[a.jsx(sn,{size:14,className:"mr-2 text-red-500"}),a.jsx("span",{children:N.name})]},`spouse-${N.id}-${A}`)):e.spouseIds&&e.spouseIds.length>0?e.spouseIds.filter((N,A,P)=>A===P.indexOf(N)).map((N,A)=>a.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[a.jsx(sn,{size:14,className:"mr-2 text-red-500"}),a.jsx("span",{children:i?`/ ${A+1}`:`Spouse ${A+1}`})]},`spouse-id-${N}-${A}`)):null})]}),l==="children"&&p&&a.jsxs("div",{className:"rounded-2xl p-4 border",style:{backgroundColor:"#f8fafc",borderColor:"#e2e8f0"},children:[a.jsxs("div",{className:"flex items-center mb-3",children:[a.jsx(na,{size:18,className:"mr-2 text-blue-500"}),a.jsx("h3",{className:"font-semibold",style:{color:"#111827"},children:i?"":"Children"}),a.jsx("span",{className:"ml-2 px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:v&&e.childrenDetails?e.childrenDetails.filter((N,A,P)=>A===P.findIndex(U=>U.id===N.id)).length:e.children?e.children.filter((N,A,P)=>A===P.indexOf(N)).length:0})]}),a.jsx("div",{className:"space-y-2",children:v&&e.childrenDetails?e.childrenDetails.filter((N,A,P)=>A===P.findIndex(U=>U.id===N.id)).map((N,A)=>a.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[a.jsx(sn,{size:14,className:"mr-2 text-blue-500"}),a.jsx("span",{children:N.name})]},`child-${N.id}-${A}`)):e.children&&e.children.length>0?e.children.filter((N,A,P)=>A===P.indexOf(N)).map((N,A)=>a.jsxs("div",{className:"flex items-center text-sm text-gray-600",children:[a.jsx(sn,{size:14,className:"mr-2 text-blue-500"}),a.jsx("span",{children:i?` ${A+1}`:`Child ${A+1}`})]},`child-id-${N}-${A}`)):null})]})]})]})]})})},lee=({isOpen:e,onClose:t,treeId:n,treeName:r,treePersons:s})=>{const{language:i}=Xt(),{user:l}=Pr(),o=i==="ar";we.useEffect(()=>{if(e){const p=localStorage.getItem("user");if(localStorage.getItem("authToken"),p)try{const g=JSON.parse(p)}catch{}}},[e,l]),we.useEffect(()=>()=>{},[]),we.useEffect(()=>{},[e]);const[c,u]=Y.useState({name:"",birthDate:"",birthPlace:"",gender:"Male",occupation:"",relatedPersonId:"",relationshipType:""}),[d,f]=Y.useState(!1),m=[{value:"Father",label:o?"":"Father"},{value:"Mother",label:o?"":"Mother"},{value:"Son",label:o?"":"Son"},{value:"Daughter",label:o?"":"Daughter"},{value:"Brother",label:o?"":"Brother"},{value:"Sister",label:o?"":"Sister"},{value:"Grandfather",label:o?"":"Grandfather"},{value:"Grandmother",label:o?"":"Grandmother"},{value:"Grandson",label:o?"":"Grandson"},{value:"Granddaughter",label:o?"":"Granddaughter"},{value:"Uncle",label:o?"/":"Uncle"},{value:"Aunt",label:o?"/":"Aunt"},{value:"Nephew",label:o?" /":"Nephew"},{value:"Niece",label:o?" /":"Niece"},{value:"Cousin",label:o?" /":"Cousin"},{value:"Spouse",label:o?"/":"Spouse"}],h=p=>{const{name:g,value:w}=p.target;u(v=>({...v,[g]:w}))},x=async p=>{p.preventDefault(),f(!0);try{if(!c.name||!c.birthDate||!c.birthPlace||!c.occupation||!c.relatedPersonId||!c.relationshipType){dn.error({en:"All fields are required",ar:"  "}),f(!1);return}const g=parseInt(n);if(isNaN(g)||g<=0){dn.error({en:"Invalid tree ID",ar:"   "}),f(!1);return}const w=parseInt(c.relatedPersonId);if(isNaN(w)||w<=0){dn.error({en:"Invalid related person ID",ar:"    "}),f(!1);return}const N=(()=>{if(l&&typeof l=="object"&&l.id!==void 0){if(typeof l.id=="string"&&l.id.length>0)return l.id;if(typeof l.id=="number"){const A=l.id.toString();if(A.length>0)return A}}try{const A=localStorage.getItem("user");if(A){const P=JSON.parse(A);if(P&&P.id!==void 0){if(typeof P.id=="string"&&P.id.length>0)return P.id;if(typeof P.id=="number"){const U=P.id.toString();if(U.length>0)return U}}}}catch{}try{const A=localStorage.getItem("authToken");if(A){const U=A.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),M=decodeURIComponent(atob(U).split("").map(function(_){return"%"+("00"+_.charCodeAt(0).toString(16)).slice(-2)}).join("")),S=JSON.parse(M),C=["sub","nameid","userId","id","jti"];for(const _ of C)if(S[_]!==void 0){if(typeof S[_]=="string"&&S[_].length>0)return S[_];if(typeof S[_]=="number"){const T=S[_].toString();if(T.length>0)return T}}}}catch{}return null})();if(!N){dn.error({en:"You must be logged in to send a join request",ar:"     "}),f(!1);return}await Pt.createJoinRequest(g,c.name,c.birthDate,c.birthPlace,c.gender,c.occupation,w,"Pending",N,c.relationshipType),dn.success({en:"Join request sent successfully",ar:"    "}),t(),u({name:"",birthDate:"",birthPlace:"",gender:"Male",occupation:"",relatedPersonId:"",relationshipType:""})}catch(g){let w=o?`    : ${g.message}`:`Failed to send join request: ${g.message}`;g.message&&g.message.includes("A pending request already exists for this user and family tree")&&(w=o?"       ":"You already have a pending join request for this family tree"),dn.error({en:w,ar:w})}finally{f(!1)}},y=p=>o?`${p.firstName} ${p.lastName}`:`${p.firstNameEn} ${p.lastNameEn}`;return a.jsx(Sh,{isOpen:e,onClose:t,title:o?`   ${r}`:`Join Request for ${r}`,children:a.jsxs("form",{onSubmit:x,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:o?" ":"Full Name"}),a.jsxs("div",{className:"relative",children:[a.jsx(sn,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),a.jsx(Kt,{name:"name",value:c.name,onChange:h,placeholder:o?"  ":"Enter your full name",className:"pl-10",required:!0})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:o?" ":"Birth Date"}),a.jsxs("div",{className:"relative",children:[a.jsx(Ur,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),a.jsx(Kt,{type:"date",name:"birthDate",value:c.birthDate,onChange:h,className:"pl-10",required:!0})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:o?"":"Gender"}),a.jsxs("select",{name:"gender",value:c.gender,onChange:h,className:"w-full border rounded-md px-3 py-2 text-sm bg-background text-foreground border-input",required:!0,children:[a.jsx("option",{value:"Male",children:o?"":"Male"}),a.jsx("option",{value:"Female",children:o?"":"Female"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:o?" ":"Birth Place"}),a.jsxs("div",{className:"relative",children:[a.jsx(ai,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),a.jsx(Kt,{name:"birthPlace",value:c.birthPlace,onChange:h,placeholder:o?"  ":"Enter birth place",className:"pl-10",required:!0})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:o?"":"Occupation"}),a.jsxs("div",{className:"relative",children:[a.jsx(Qo,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),a.jsx(Kt,{name:"occupation",value:c.occupation,onChange:h,placeholder:o?" ":"Enter your occupation",className:"pl-10",required:!0})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:o?" ":"Related Person"}),a.jsxs("div",{className:"relative",children:[a.jsx(In,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),a.jsxs("select",{name:"relatedPersonId",value:c.relatedPersonId,onChange:h,className:"w-full border rounded-md px-10 py-2 text-sm bg-background text-foreground border-input",required:!0,children:[a.jsx("option",{value:"",children:o?" ":"Select Person"}),s.map(p=>a.jsx("option",{value:p.id,children:y(p)},p.id))]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:o?" ":"Relationship Type"}),a.jsxs("select",{name:"relationshipType",value:c.relationshipType,onChange:h,className:"w-full border rounded-md px-3 py-2 text-sm bg-background text-foreground border-input",required:!0,children:[a.jsx("option",{value:"",children:o?"  ":"Select Relationship"}),m.map(p=>a.jsx("option",{value:p.value,children:p.label},p.value))]})]})]}),a.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[a.jsx(ge,{type:"button",variant:"outline",onClick:t,disabled:d,children:o?"":"Cancel"}),a.jsxs(ge,{type:"submit",disabled:d,className:"flex items-center gap-2",children:[d&&a.jsx(wr,{className:"h-4 w-4 animate-spin"}),o?" ":"Send Request"]})]})]})})},cee=()=>{const{id:e}=Gu(),t=Ir(),{language:n}=Xt(),{currentTree:r,fetchPersonsInTree:s,isLoading:i,error:l,trees:o,publicTrees:c}=xs(),{user:u}=Pr(),[d,f]=Y.useState(null),[m,h]=Y.useState(null),[x,y]=Y.useState("tree"),[p,g]=Y.useState(""),[w,v]=Y.useState(!1),[N,A]=Y.useState(!1),[P,U]=Y.useState(!1),[M,S]=Y.useState(null),[C,_]=Y.useState(null),[T,B]=Y.useState(null),[$,D]=Y.useState(null),[L,O]=Y.useState(null),[W,E]=Y.useState(!0),H=Y.useRef(null),V=Y.useRef(null),[R,q]=Y.useState(!1),[F,G]=Y.useState("tree"),[ee,ae]=Y.useState([]),[re,Q]=Y.useState([]),[fe,Se]=Y.useState(!1),oe=n==="ar",{isMobile:pe}=Tr(),{limits:me,isLimitReached:ne}=xc(),[it,$e]=Y.useState(0),[Oe,qe]=Y.useState(!1),[gt,ut]=Y.useState(null),[Rt,Nt]=Y.useState(!1),[ye,ze]=Y.useState(null),[Ze,xe]=Y.useState(!1);Y.useEffect(()=>{},[]),Y.useEffect(()=>{const Te=localStorage.getItem("user");if(localStorage.getItem("authToken"),Te)try{const Ee=JSON.parse(Te)}catch{}},[u]);const pt=()=>{if(u&&typeof u=="object"&&u.id!==void 0){if(typeof u.id=="string"&&u.id.length>0)return u.id;if(typeof u.id=="number"){const Te=u.id.toString();if(Te.length>0)return Te}}try{const Te=localStorage.getItem("user");if(Te){const Ee=JSON.parse(Te);if(Ee&&Ee.id!==void 0){if(typeof Ee.id=="string"&&Ee.id.length>0)return Ee.id;if(typeof Ee.id=="number"){const et=Ee.id.toString();if(et.length>0)return et}}}}catch{}try{const Te=localStorage.getItem("authToken");if(Te){const et=Te.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),kt=decodeURIComponent(atob(et).split("").map(function(Ct){return"%"+("00"+Ct.charCodeAt(0).toString(16)).slice(-2)}).join("")),vt=JSON.parse(kt),At=["sub","nameid","userId","id","jti"];for(const Ct of At)if(vt[Ct]!==void 0){if(typeof vt[Ct]=="string"&&vt[Ct].length>0)return vt[Ct];if(typeof vt[Ct]=="number"){const Lt=vt[Ct].toString();if(Lt.length>0)return Lt}}}}catch{}return null},Ne=async()=>{if(!(!e||!ot))try{Se(!0);const Te=await Pt.getIncomingJoinRequests(parseInt(e));ae(Te)}catch{dn.error({en:"Failed to load incoming requests",ar:"     "})}finally{Se(!1)}},de=async()=>{const Te=pt();if(Te)try{Se(!0);const Ee=await Pt.getOutgoingJoinRequests(Te);Q(Ee)}catch{dn.error({en:"Failed to load outgoing requests",ar:"     "})}finally{Se(!1)}};Y.useEffect(()=>{if(R&&(!u||!u.id))try{const Te=localStorage.getItem("user");if(Te){const Ee=JSON.parse(Te);Ee&&Ee.id}}catch{}},[R,u]),Y.useEffect(()=>{(async()=>{var Ee;if(e)try{const et=await s(e);let kt=[];try{kt=await Pt.getRelationships()}catch{}let At=o.find(nt=>nt.id===e)||c.find(nt=>nt.id===e)||r;if(!At)try{const nt=await Pt.getTreeById(parseInt(e));nt&&nt.data&&(At={id:nt.data.id.toString(),name:nt.data.name,description:nt.data.description||"",category:nt.data.category||"family",tags:nt.data.tags||[],settings:nt.data.settings||{isPublic:!nt.data.isPrivate,theme:"default",layout:"vertical",showPhotos:!0,showDates:!0,showPlaces:!0,allowComments:!0,allowSuggestions:!0},sharing:nt.data.sharing||{isShared:nt.data.members&&nt.data.members.length>0||!1,allowedUsers:[],shareToken:void 0,publicUrl:void 0},stats:nt.data.stats||{totalPeople:((Ee=nt.data.members)==null?void 0:Ee.length)||0,totalGenerations:0,totalPhotos:0,completionPercentage:nt.data.members&&nt.data.members.length>0?50:0},createdAt:nt.data.createdAt||new Date().toISOString(),updatedAt:nt.data.updatedAt||new Date().toISOString(),ownerId:nt.data.ownerId||(nt.data.owner?nt.data.owner.id:void 0),userRole:nt.data.userRole||"viewer"})}catch{}const Ct=new Map,Lt=new Map;kt&&Array.isArray(kt)&&kt.forEach(nt=>{var Qt,ct,Bt,an;if(nt.relationshipType==="Child"||nt.relationshipType==="child"||nt.relationshipType==="Son"||nt.relationshipType==="son"||nt.relationshipType==="Daughter"||nt.relationshipType==="daughter"){const en=nt.personId.toString(),mt=nt.relatedPersonId.toString(),Ft=et.some(rn=>rn.id.toString()===en),on=et.some(rn=>rn.id.toString()===mt);Ft&&on&&(Ct.has(mt)||Ct.set(mt,[]),(Qt=Ct.get(mt))==null||Qt.push(en),Lt.has(en)||Lt.set(en,[]),(ct=Lt.get(en))==null||ct.push(mt))}else if(nt.relationshipType==="Father"||nt.relationshipType==="father"||nt.relationshipType==="Mother"||nt.relationshipType==="mother"||nt.relationshipType==="Parent"||nt.relationshipType==="parent"){const en=nt.personId.toString(),mt=nt.relatedPersonId.toString(),Ft=et.some(rn=>rn.id.toString()===mt),on=et.some(rn=>rn.id.toString()===en);Ft&&on&&(Ct.has(en)||Ct.set(en,[]),(Bt=Ct.get(en))==null||Bt.push(mt),Lt.has(mt)||Lt.set(mt,[]),(an=Lt.get(mt))==null||an.push(en))}}),et.forEach(nt=>{var ct,Bt,an,en;if(["parentId","parent_id","fatherId","father_id","motherId","mother_id"].forEach(mt=>{var Ft,on;if(nt[mt]&&nt[mt]!=="0"&&nt[mt]!==0){const rn=nt[mt].toString(),Cn=nt.id.toString();et.some(_n=>_n.id.toString()===rn)&&(Ct.has(Cn)||Ct.set(Cn,[]),(Ft=Ct.get(Cn))==null||Ft.push(rn),Lt.has(rn)||Lt.set(rn,[]),(on=Lt.get(rn))==null||on.push(Cn))}}),nt.parentIds&&Array.isArray(nt.parentIds)&&nt.parentIds.forEach(mt=>{var Ft,on;if(mt&&mt!=="0"&&mt!==0){const rn=nt.id.toString();et.some(bn=>bn.id.toString()===mt.toString())&&(Ct.has(rn)||Ct.set(rn,[]),(Ft=Ct.get(rn))==null||Ft.push(mt.toString()),Lt.has(mt.toString())||Lt.set(mt.toString(),[]),(on=Lt.get(mt.toString()))==null||on.push(rn))}}),nt.relationships){if(nt.relationships.father){let mt=null;if(typeof nt.relationships.father=="string"?mt=nt.relationships.father:typeof nt.relationships.father=="object"&&nt.relationships.father.id&&(mt=nt.relationships.father.id.toString()),mt){const Ft=nt.id.toString();et.some(rn=>rn.id.toString()===mt)&&(Ct.has(Ft)||Ct.set(Ft,[]),(ct=Ct.get(Ft))==null||ct.push(mt),Lt.has(mt)||Lt.set(mt,[]),(Bt=Lt.get(mt))==null||Bt.push(Ft))}}if(nt.relationships.mother){let mt=null;if(typeof nt.relationships.mother=="string"?mt=nt.relationships.mother:typeof nt.relationships.mother=="object"&&nt.relationships.mother.id&&(mt=nt.relationships.mother.id.toString()),mt){const Ft=nt.id.toString();et.some(rn=>rn.id.toString()===mt)&&(Ct.has(Ft)||Ct.set(Ft,[]),(an=Ct.get(Ft))==null||an.push(mt),Lt.has(mt)||Lt.set(mt,[]),(en=Lt.get(mt))==null||en.push(Ft))}}}}),kt&&Array.isArray(kt)&&kt.forEach(nt=>{var en,mt,Ft,on,rn,Cn,bn,_n;const Qt=(en=nt.personId)==null?void 0:en.toString(),ct=(mt=nt.relatedPersonId)==null?void 0:mt.toString(),Bt=et.some(mn=>mn.id.toString()===Qt),an=et.some(mn=>mn.id.toString()===ct);if(!(!Bt||!an))if(["Father","father","Mother","mother","Parent","parent"].includes(nt.relationshipType)){const mn=Qt,Bn=ct;Ct.has(mn)||Ct.set(mn,[]),(Ft=Ct.get(mn))==null||Ft.push(Bn),Lt.has(Bn)||Lt.set(Bn,[]),(on=Lt.get(Bn))==null||on.push(mn)}else if(["Child","child","Son","son","Daughter","daughter"].includes(nt.relationshipType)){const mn=Qt,Bn=ct;Ct.has(Bn)||Ct.set(Bn,[]),(rn=Ct.get(Bn))==null||rn.push(mn),Lt.has(mn)||Lt.set(mn,[]),(Cn=Lt.get(mn))==null||Cn.push(Bn)}else if(["Spouse","spouse","Husband","husband","Wife","wife"].includes(nt.relationshipType)){const mn=Qt,Bn=ct}else{const mn=Qt,Bn=ct;Ct.has(mn)||Ct.set(mn,[]),(bn=Ct.get(mn))==null||bn.push(Bn),Lt.has(Bn)||Lt.set(Bn,[]),(_n=Lt.get(Bn))==null||_n.push(mn)}}),et.forEach(nt=>{const Qt=nt.id.toString();et.forEach(ct=>{var Ft,on,rn,Cn;const Bt=ct.id.toString();if(Qt===Bt)return;const an=ct;if((an.parentIds||an.parents||an.parent_ids||[]).some(bn=>(typeof bn=="object"&&bn.id?bn.id.toString():bn.toString())===Qt)){const bn=Bt,_n=Qt;Ct.has(bn)||Ct.set(bn,[]),(Ft=Ct.get(bn))!=null&&Ft.includes(_n)||(on=Ct.get(bn))==null||on.push(_n),Lt.has(_n)||Lt.set(_n,[]),(rn=Lt.get(_n))!=null&&rn.includes(bn)||(Cn=Lt.get(_n))==null||Cn.push(bn)}})});const Gn={id:e,name:(At==null?void 0:At.name)||"Family Tree",nameEn:(At==null?void 0:At.name)||"Family Tree",description:(At==null?void 0:At.description)||"",descriptionEn:(At==null?void 0:At.description)||"",rootPersonId:(()=>{if(d!=null&&d.rootPersonId&&et.some(ct=>ct.id.toString()===d.rootPersonId))return d.rootPersonId;for(const Qt of et)if(Qt.isRoot)return Qt.id.toString();const nt=new Map;kt&&Array.isArray(kt)&&kt.forEach(Qt=>{var ct,Bt,an,en;if(["Spouse","spouse","Husband","husband","Wife","wife"].includes(Qt.relationshipType)){const mt=Qt.personId.toString(),Ft=Qt.relatedPersonId.toString();nt.has(mt)||nt.set(mt,[]),(ct=nt.get(mt))!=null&&ct.includes(Ft)||(Bt=nt.get(mt))==null||Bt.push(Ft),nt.has(Ft)||nt.set(Ft,[]),(an=nt.get(Ft))!=null&&an.includes(mt)||(en=nt.get(Ft))==null||en.push(mt)}});for(const Qt of et){const ct=Qt.id.toString();if(!Ct.has(ct)){let Bt=!1;for(const[an,en]of nt.entries())if(en.includes(ct)){Bt=!0;break}if(!Bt)return ct}}for(const Qt of et){const ct=Qt.id.toString();if(!Ct.has(ct))return ct}return et.length>0?et[0].id.toString():"1"})(),persons:((ct,Bt)=>{const an=new Map;ct.forEach(on=>{an.set(on.id.toString(),{...on,generation:0})});const en=ct.filter(on=>!Bt.has(on.id.toString()));en.forEach(on=>{const rn=an.get(on.id.toString());rn&&(rn.generation=0,an.set(on.id.toString(),rn))});const mt=en.map(on=>({personId:on.id.toString(),generation:0})),Ft=new Set;for(en.forEach(on=>Ft.add(on.id.toString()));mt.length>0;){const{personId:on,generation:rn}=mt.shift();Bt.forEach((Cn,bn)=>{if(Cn.includes(on)&&!Ft.has(bn)){const _n=an.get(bn);_n&&(_n.generation=rn+1,an.set(bn,_n),Ft.add(bn),mt.push({personId:bn,generation:rn+1}))}})}return Array.from(an.values())})(et,Ct).map(ct=>{var rn,Cn,bn,_n,mn,Bn,Hn,hr,Jr,ar;let Bt="",an="";if(ct.name){const Rn=ct.name.split(" ");Bt=Rn[0]||"",an=Rn.slice(1).join(" ")||""}const en=Ct.get(ct.id.toString())||[],mt=ct.spouseIds||ct.spouses||ct.spouse_ids||[],Ft=Lt.get(ct.id.toString())||[];return{id:ct.id.toString(),firstName:ct.firstName||Bt||ct.name||"",firstNameEn:ct.firstName||Bt||ct.name||"",lastName:ct.lastName||an||"",lastNameEn:ct.lastName||an||"",gender:ct.gender==="male"?"male":ct.gender==="female"?"female":"male",birthDate:((rn=ct.birth)==null?void 0:rn.date)||ct.birthDate||"",birthPlace:((bn=(Cn=ct.birth)==null?void 0:Cn.place)==null?void 0:bn.city)||ct.birthPlace||"",birthPlaceEn:((mn=(_n=ct.birth)==null?void 0:_n.place)==null?void 0:mn.city)||ct.birthPlace||"",isAlive:!ct.isDeceased,photo:((Bn=ct.primaryPhoto)==null?void 0:Bn.url)||ct.photo||ct.photoUrl||"/api/placeholder/100/100",generation:ct.generation||0,latitude:ct.Latitude??ct.latitude??((Hn=ct.position)==null?void 0:Hn.x)??void 0,longitude:ct.Longitude??ct.longitude??((hr=ct.position)==null?void 0:hr.y)??void 0,position:{x:ct.Latitude??ct.latitude??((Jr=ct.position)==null?void 0:Jr.x)??0,y:ct.Longitude??ct.longitude??((ar=ct.position)==null?void 0:ar.y)??0},parentIds:en.map(Rn=>Rn.toString()),spouseIds:(mt||[]).map(Rn=>Rn.toString()),childrenIds:Ft.map(Rn=>Rn.toString())}}),createdAt:(At==null?void 0:At.createdAt)||new Date().toISOString(),updatedAt:(At==null?void 0:At.updatedAt)||new Date().toISOString(),ownerId:(At==null?void 0:At.ownerId)||(At!=null&&At.owner?At.owner.id:void 0),userRole:At==null?void 0:At.userRole};if(Gn.relationships=kt,!Gn.persons.find(nt=>nt.id==="31")){const nt=et.find(Qt=>Qt.id.toString()==="31")}f(nt=>JSON.stringify(nt)===JSON.stringify(Gn)?nt:Gn)}catch{f(null)}})()},[e,s,o,c,r,it]);const se=Te=>oe?`${Te.firstName} ${Te.lastName}`:`${Te.firstNameEn} ${Te.lastNameEn}`,he=Te=>{h(m===Te?null:Te)},ke=Te=>{if(!ot){dn.error(oe?"       ":"You do not have permission to add people to this tree");return}if(d&&me&&ne("people",d.persons.length)){const Ee=me.people;dn.error({en:`You've reached the maximum number of people in this tree (${Ee} people). Please upgrade your subscription to add more.`,ar:`          (${Ee} ).     .`},{action:{label:n==="ar"?" ":"Upgrade Subscription",onClick:()=>window.location.assign("/subscription")}});return}_(Te),A(!0)},be=Te=>{if(!ot){dn.error(oe?"       ":"You do not have permission to add people to this tree");return}B(Te),A(!0)},Le=Te=>{if(!ot){dn.error(oe?"       ":"You do not have permission to add people to this tree");return}if(d&&me&&ne("people",d.persons.length)){const Ee=me.people;dn.error({en:`You've reached the maximum number of people in this tree (${Ee} people). Please upgrade your subscription to add more.`,ar:`          (${Ee} ).     .`},{action:{label:n==="ar"?" ":"Upgrade Subscription",onClick:()=>window.location.assign("/subscription")}});return}D(Te),A(!0)},He=Te=>{if(!ot){dn.error(oe?"       ":"You do not have permission to add people to this tree");return}if(d&&me&&ne("people",d.persons.length)){const Ee=me.people;dn.error({en:`You've reached the maximum number of people in this tree (${Ee} people). Please upgrade your subscription to add more.`,ar:`          (${Ee} ).     .`},{action:{label:n==="ar"?" ":"Upgrade Subscription",onClick:()=>window.location.assign("/subscription")}});return}O(Te),A(!0)},Ue=Te=>{ot?(S(Te),U(!0)):dn.error(oe?"     ":"You do not have permission to edit this person")},De=async Te=>{if(!ot){dn.error(oe?"     ":"You do not have permission to delete this person");return}ut(Te),qe(!0)},_e=async()=>{if(gt)try{await Pt.deletePerson(parseInt(gt)),e&&(s(e),$e(Te=>Te+1)),dn.success(oe?"   :      ":"Person deleted successfully: The person has been deleted from the family tree")}catch{dn.error(oe?"   :          ":"Failed to delete person: delete childs first")}finally{qe(!1),ut(null)}},Ie=()=>{qe(!1),ut(null)},ht=Y.useCallback(()=>{H.current&&(w?(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen(),v(!1)):(H.current.requestFullscreen?H.current.requestFullscreen():H.current.webkitRequestFullscreen?H.current.webkitRequestFullscreen():H.current.msRequestFullscreen&&H.current.msRequestFullscreen(),v(!0)))},[w]),wt=async()=>{if(!d)return;const{encryptString:Te}=await np(async()=>{const{encryptString:kt}=await Promise.resolve().then(()=>hee);return{encryptString:kt}},void 0);console.log("Encrypting tree ID for sharing:",d.id);const Ee=await Te(d.id);console.log("Encrypted ID for sharing:",Ee);const et=`${window.location.origin}/shared/${Ee}`;if(console.log("Share URL:",et),navigator.share)try{await navigator.share({title:d.name,text:oe?`    ${d.name}`:`Check out the ${d.name} family tree`,url:et})}catch{St(et)}else St(et)},St=Te=>{navigator.clipboard?navigator.clipboard.writeText(Te).then(()=>{dn.success(oe?"    ":"Link copied to clipboard")}).catch(Ee=>{Vt(Te)}):Vt(Te)},Vt=Te=>{const Ee=document.createElement("textarea");Ee.value=Te,Ee.style.top="0",Ee.style.left="0",Ee.style.position="fixed",Ee.style.opacity="0",document.body.appendChild(Ee),Ee.focus(),Ee.select();try{document.execCommand("copy")?dn.success(oe?"    ":"Link copied to clipboard"):dn.error(oe?"  ":"Failed to copy link")}catch{dn.error(oe?"  ":"Failed to copy link")}document.body.removeChild(Ee)};Y.useEffect(()=>{const Te=()=>{const Ee=document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement;v(!!Ee)};return document.addEventListener("fullscreenchange",Te),document.addEventListener("webkitfullscreenchange",Te),document.addEventListener("msfullscreenchange",Te),()=>{document.removeEventListener("fullscreenchange",Te),document.removeEventListener("webkitfullscreenchange",Te),document.removeEventListener("msfullscreenchange",Te)}},[]);const qn=()=>{q(!0),setTimeout(()=>{},0)},En=Te=>{if(!d)return;const Ee=d.persons.find(vt=>vt.id===Te);if(!Ee)return;let et="",kt="";return d!=null&&d.relationships&&Array.isArray(d.relationships)&&d.relationships.filter(At=>{var Lr;const Ct=At.relationshipType==="Child",Lt=Te.toString(),Gn=(Lr=At.relatedPersonId)==null?void 0:Lr.toString();return Ct&&Gn===Lt}).forEach(At=>{var Gn;const Ct=(Gn=At.personId)==null?void 0:Gn.toString(),Lt=d.persons.find(Lr=>Lr.id.toString()===Ct);Lt&&(Lt.gender==="male"?et=Lt.id:Lt.gender==="female"&&(kt=Lt.id))}),{id:Ee.id,name:`${Ee.firstName} ${Ee.lastName}`,gender:Ee.gender,birthDate:Ee.birthDate||"",deathDate:"",birthPlace:Ee.birthPlace||"",birthPlaceEn:Ee.birthPlaceEn||"",occupation:"",occupationEn:"",isAlive:Ee.isAlive,fatherId:et,motherId:kt}},Dn=()=>ot?a.jsx("div",{className:"space-y-4",children:fe?a.jsx("div",{className:"flex items-center justify-center h-32",children:a.jsx(wr,{className:"h-8 w-8 animate-spin text-primary"})}):ee.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(In,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium mb-1",children:oe?"   ":"No Incoming Requests"}),a.jsx("p",{className:"text-muted-foreground",children:oe?"     ":"No incoming join requests currently"})]}):ee.map(Te=>a.jsx("div",{className:"border rounded-lg p-4",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("h3",{className:"font-medium",children:Te.name}),Fe(Te.status)]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ur,{className:"h-4 w-4 text-muted-foreground"}),a.jsx("span",{children:new Date(Te.birthDate).toLocaleDateString(oe?"ar-SA":"en-US")})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ai,{className:"h-4 w-4 text-muted-foreground"}),a.jsx("span",{children:Te.birthPlace})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qo,{className:"h-4 w-4 text-muted-foreground"}),a.jsx("span",{children:Te.occupation})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(In,{className:"h-4 w-4 text-muted-foreground"}),a.jsx("span",{children:Te.relationshipType})]})]}),a.jsxs("div",{className:"mt-2 text-xs text-muted-foreground",children:[oe?" :":"Requested by:"," ",Te.requesterId]})]}),Te.status.toLowerCase()==="pending"&&a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(ge,{variant:"default",size:"sm",onClick:()=>Dt(Te.id),className:"flex items-center gap-1",children:[a.jsx(Hm,{className:"h-4 w-4"}),oe?"":"Accept"]}),a.jsxs(ge,{variant:"destructive",size:"sm",onClick:()=>Gt(Te.id),className:"flex items-center gap-1",children:[a.jsx(hj,{className:"h-4 w-4"}),oe?"":"Reject"]})]})]})},Te.id))}):null,lt=()=>a.jsx("div",{className:"space-y-4",children:fe?a.jsx("div",{className:"flex items-center justify-center h-32",children:a.jsx(wr,{className:"h-8 w-8 animate-spin text-primary"})}):re.length===0?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(Nx,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium mb-1",children:oe?"   ":"No Outgoing Requests"}),a.jsx("p",{className:"text-muted-foreground",children:oe?"     ":"You have not made any join requests currently"})]}):re.map(Te=>a.jsx("div",{className:"border rounded-lg p-4",children:a.jsx("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("h3",{className:"font-medium",children:Te.name}),Fe(Te.status)]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ur,{className:"h-4 w-4 text-muted-foreground"}),a.jsx("span",{children:new Date(Te.birthDate).toLocaleDateString(oe?"ar-SA":"en-US")})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ai,{className:"h-4 w-4 text-muted-foreground"}),a.jsx("span",{children:Te.birthPlace})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qo,{className:"h-4 w-4 text-muted-foreground"}),a.jsx("span",{children:Te.occupation})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(In,{className:"h-4 w-4 text-muted-foreground"}),a.jsx("span",{children:Te.relationshipType})]})]}),a.jsxs("div",{className:"mt-2 text-xs text-muted-foreground",children:[oe?" :":"Tree ID:"," ",Te.familyTreeId]})]})})},Te.id))}),Fe=Te=>{switch(Te.toLowerCase()){case"pending":return a.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[a.jsx(y0,{className:"h-3 w-3 mr-1"}),oe?" ":"Pending"]});case"accepted":return a.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[a.jsx(Si,{className:"h-3 w-3 mr-1"}),oe?"":"Accepted"]});case"rejected":return a.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[a.jsx(sy,{className:"h-3 w-3 mr-1"}),oe?"":"Rejected"]});default:return a.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:Te})}},Dt=async Te=>{try{await Pt.acceptJoinRequest(Te),dn.success({en:"Request accepted successfully",ar:"   "}),Ne()}catch{dn.error({en:"Failed to accept request",ar:"   "})}},Gt=async Te=>{try{await Pt.rejectJoinRequest(Te),dn.success({en:"Request rejected successfully",ar:"   "}),Ne()}catch{dn.error({en:"Failed to reject request",ar:"   "})}},Ht=()=>{if(!d)return null;const Te=d.persons.filter(Ee=>se(Ee).toLowerCase().includes(p.toLowerCase()));return a.jsx("div",{className:`grid ${pe?"grid-cols-1 gap-3":"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"}`,children:Te.map(Ee=>a.jsx(Qe,{className:"hover:shadow-md transition-shadow",children:a.jsxs(tt,{className:`p-4 ${pe?"p-3":""}`,children:[a.jsxs("div",{className:`flex items-center gap-3 mb-3 ${pe?"gap-2":""}`,children:[a.jsx("div",{className:`rounded-full flex items-center justify-center ${Ee.gender==="male"?"bg-blue-100 text-blue-600":Ee.gender==="female"?"bg-pink-100 text-pink-600":"bg-gray-100 text-gray-600"} ${pe?"w-10 h-10":"w-12 h-12"}`,children:Ee.gender==="male"?a.jsx(sn,{className:`h-6 w-6 ${pe?"h-5 w-5":""}`}):Ee.gender==="female"?a.jsx(sn,{className:`h-6 w-6 ${pe?"h-5 w-5":""}`}):a.jsx(sn,{className:`h-6 w-6 text-gray-500 ${pe?"h-5 w-5":""}`})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:`font-medium ${pe?"text-sm":""}`,children:se(Ee)}),a.jsxs("div",{className:`flex items-center gap-2 ${pe?"text-xs":"text-sm"} text-muted-foreground`,children:[a.jsx(er,{variant:Ee.gender==="male"?"default":"secondary",className:pe?"text-xs px-1.5 py-0.5":"",children:Ee.gender==="male"?oe?"":"Male":oe?"":"Female"}),Ee.birthDate&&a.jsx("span",{children:new Date(Ee.birthDate).getFullYear()})]})]})]}),a.jsxs("div",{className:`flex ${pe?"gap-1":"gap-2"}`,children:[a.jsxs(ge,{size:"sm",variant:"outline",onClick:()=>{const et={...Ee,parents:Ee.parentIds?Ee.parentIds.map(kt=>{const vt=d==null?void 0:d.persons.find(At=>At.id===kt);return{id:kt,name:vt?oe?`${vt.firstName} ${vt.lastName}`:`${vt.firstNameEn||vt.firstName} ${vt.lastNameEn||vt.lastName}`:oe?" ":"Unknown",relationship:oe?"":"Parent"}}):[],spouses:Ee.spouseIds?Ee.spouseIds.map(kt=>{const vt=d==null?void 0:d.persons.find(At=>At.id===kt);return{id:kt,name:vt?oe?`${vt.firstName} ${vt.lastName}`:`${vt.firstNameEn||vt.firstName} ${vt.lastNameEn||vt.lastName}`:oe?" ":"Unknown"}}).filter(kt=>kt.name!==(oe?" ":"Unknown")):[],childrenDetails:Ee.childrenIds?Ee.childrenIds.map(kt=>{const vt=d==null?void 0:d.persons.find(At=>At.id===kt);return{id:kt,name:vt?oe?`${vt.firstName} ${vt.lastName}`:`${vt.firstNameEn||vt.firstName} ${vt.lastNameEn||vt.lastName}`:oe?" ":"Unknown"}}):[],parentIds:void 0,spouseIds:void 0,children:void 0};console.log("Detailed person spouse data:",{originalSpouseIds:Ee.spouseIds,createdSpouses:et.spouses,hasSpouses:et.spouses&&et.spouses.length>0}),ze(et),Nt(!0)},className:pe?"text-xs py-1 px-2":"",children:[a.jsx(ra,{className:`h-4 w-4 ${pe?"h-3 w-3 mr-1":"mr-1"}`}),a.jsx("span",{className:pe?"hidden":"",children:oe?"":"View"})]}),a.jsxs(ge,{size:"sm",variant:"outline",onClick:()=>Ue(Ee.id),className:`flex items-center ${ot?"":"hidden"} ${pe?"text-xs py-1 px-2":""}`,children:[a.jsx(sa,{className:`h-4 w-4 ${pe?"h-3 w-3 mr-1":"mr-1"}`}),a.jsx("span",{className:pe?"hidden":"",children:oe?"":"Edit"})]}),a.jsxs(ge,{size:"sm",variant:"destructive",onClick:()=>De(Ee.id),className:`flex items-center ${ot?"":"hidden"} ${pe?"text-xs py-1 px-2":""}`,children:[a.jsx(Ia,{className:`h-4 w-4 ${pe?"h-3 w-3 mr-1":"mr-1"}`}),a.jsx("span",{className:pe?"hidden":"",children:oe?"":"Delete"})]})]})]})},Ee.id))})},ot=(()=>{if(!u||!d&&!r)return!1;if(r&&r.id===e&&(r.ownerId&&r.ownerId===u.id||r.owner&&r.owner.id===u.id||r.userRole==="owner")||d&&(d.ownerId&&d.ownerId===u.id||d.owner&&d.owner.id===u.id))return!0;const Te=o.find(et=>et.id===e);if(Te&&(Te.ownerId&&Te.ownerId===u.id||Te.owner&&Te.owner.id===u.id||Te.userRole==="owner"))return!0;const Ee=c.find(et=>et.id===e);return!!(Ee&&(Ee.ownerId&&Ee.ownerId===u.id||Ee.owner&&Ee.owner.id===u.id||Ee.userRole==="owner"))})();if(Y.useEffect(()=>{F==="incoming"&&ot?Ne():F==="outgoing"&&de()},[F,ot]),i)return a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsxs("div",{className:"text-center",children:[a.jsx(wr,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4 animate-spin"}),a.jsx("p",{className:"text-muted-foreground",children:oe?"  ...":"Loading tree..."})]})});if(l)return a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"text-destructive mx-auto mb-4",children:a.jsx(Qn,{className:"h-12 w-12 mx-auto"})}),a.jsx("p",{className:"text-destructive",children:oe?"    ":"Error loading tree"}),a.jsx(ge,{variant:"outline",className:"mt-4",onClick:()=>window.location.reload(),children:oe?" ":"Try Again"})]})});if(!d)return a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsxs("div",{className:"text-center",children:[a.jsx(Qn,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:oe?"    ":"Tree not found"})]})});const _t=a.jsx("div",{className:F!=="tree"?"hidden":"",children:a.jsx("div",{ref:H,className:"w-full h-full",children:a.jsx(Qe,{className:`relative tree-visualization-container ${pe?"overflow-auto":"overflow-visible"} ${w?"fixed inset-0 z-50 m-0 rounded-none":""}`,style:{height:w?pe?"100svh":"100vh":pe?"calc(100svh - 200px)":"calc(100vh - 200px)"},children:a.jsx("div",{className:"w-full h-full flex items-center justify-center",style:{width:"100%",height:"100%"},children:a.jsx("div",{className:"w-full h-full",style:{width:"100%",height:"100%"},children:a.jsx(M7,{ref:V,persons:d?d.persons:[],relationships:(d==null?void 0:d.relationships)||[],rootPersonId:d?d.rootPersonId:"",onSelectPerson:he,onEditPerson:Ue,onDeletePerson:De,onAddChild:ke,onAddSpouse:be,onAddFather:Le,onAddMother:He,dataVersion:it,isOwnedTree:ot,isInteractivityLocked:W})})})})})}),Et=a.jsx("div",{className:F!=="list"?"hidden":"",children:Ht()}),ft=a.jsx("div",{className:F!=="incoming"?"hidden":"",children:a.jsx(Qe,{children:a.jsxs(tt,{className:"p-4",children:[a.jsx("h2",{className:"text-xl font-bold mb-4",children:oe?"  ":"Incoming Join Requests"}),Dn()]})})}),at=a.jsx("div",{className:F!=="outgoing"?"hidden":"",children:a.jsx(Qe,{children:a.jsxs(tt,{className:"p-4",children:[a.jsx("h2",{className:"text-xl font-bold mb-4",children:oe?"  ":"Outgoing Join Requests"}),lt()]})})});return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:`flex ${pe?"flex-col gap-3":"items-center justify-between"}`,children:[a.jsxs("div",{className:`flex ${pe?"flex-col gap-3":"items-center gap-4"}`,children:[a.jsxs(ge,{variant:"outline",onClick:()=>t("/trees"),size:pe?"sm":"default",className:pe?"w-full":"",children:[a.jsx(ho,{className:"h-4 w-4 mr-2"}),oe?" ":"Back to Trees"]}),a.jsxs("div",{children:[a.jsx("h1",{className:`font-bold ${pe?"text-xl":"text-2xl"}`,children:oe?d==null?void 0:d.name:d==null?void 0:d.nameEn}),a.jsxs("p",{className:"text-muted-foreground text-sm",children:[(d==null?void 0:d.persons.length)||0," ",oe?"":"members"]})]})]}),a.jsxs("div",{className:`flex ${pe?"gap-2 w-full":"items-center gap-2"}`,children:[a.jsxs(ge,{variant:"outline",onClick:()=>A(!0),className:ot?"":"hidden",size:pe?"sm":"default",children:[a.jsx(_u,{className:"h-4 w-4 mr-2"}),oe?" ":"Add Person"]}),a.jsxs(ge,{variant:"default",onClick:qn,className:`${ot?"hidden":""} ${pe?"flex-1":""}`,size:pe?"sm":"default",children:[a.jsx(Hm,{className:"h-4 w-4 mr-2"}),oe?" ":"Join Request"]}),a.jsxs(ge,{variant:"outline",onClick:wt,className:pe?"flex-1":"",size:pe?"sm":"default",children:[a.jsx(fh,{className:"h-4 w-4 mr-2"}),oe?"":"Share"]})]})]}),a.jsxs("div",{className:`flex flex-col ${pe?"gap-3":"gap-4"}`,children:[a.jsxs("div",{className:`flex ${pe?"flex-wrap gap-1 p-1 bg-muted rounded-lg overflow-x-auto":"items-center gap-2"}`,style:{minHeight:"40px"},children:[a.jsxs(ge,{variant:F==="tree"?"default":"outline",size:"sm",onClick:()=>G("tree"),className:`flex items-center gap-2 whitespace-nowrap ${pe?"text-xs py-2 px-3 flex-1 justify-center":""}`,style:{minWidth:"80px"},children:[a.jsx(Qn,{className:`h-4 w-4 ${pe?"h-3 w-3":"mr-2"}`}),a.jsx("span",{className:pe?"hidden":"",children:oe?"":"Tree"})]}),a.jsxs(ge,{variant:F==="list"?"default":"outline",size:"sm",onClick:()=>G("list"),className:`flex items-center gap-2 whitespace-nowrap ${pe?"text-xs py-2 px-3 flex-1 justify-center":""}`,style:{minWidth:"80px"},children:[a.jsx(UI,{className:`h-4 w-4 ${pe?"h-3 w-3":"mr-2"}`}),a.jsx("span",{className:pe?"hidden":"",children:oe?"":"List"})]}),ot&&a.jsxs(ge,{variant:F==="incoming"?"default":"outline",size:"sm",onClick:()=>G("incoming"),className:`flex items-center gap-2 whitespace-nowrap ${pe?"text-xs py-2 px-3 flex-1 justify-center":""}`,style:{minWidth:"80px"},children:[a.jsx(Hm,{className:`h-4 w-4 ${pe?"h-3 w-3":"mr-2"}`}),a.jsx("span",{className:pe?"hidden":"",children:oe?"":"Incoming"}),ee.filter(Te=>{var Ee;return((Ee=Te.status)==null?void 0:Ee.toLowerCase())==="pending"}).length>0&&a.jsx("span",{className:`ml-2 bg-red-500 text-white text-xs rounded-full flex items-center justify-center ${pe?"h-4 w-4":"h-5 w-5"}`,children:ee.filter(Te=>{var Ee;return((Ee=Te.status)==null?void 0:Ee.toLowerCase())==="pending"}).length})]}),a.jsxs(ge,{variant:F==="outgoing"?"default":"outline",size:"sm",onClick:()=>G("outgoing"),className:`flex items-center gap-2 whitespace-nowrap ${pe?"text-xs py-2 px-3 flex-1 justify-center":""}`,style:{minWidth:"80px"},children:[a.jsx(Nx,{className:`h-4 w-4 ${pe?"h-3 w-3":"mr-2"}`}),a.jsx("span",{className:pe?"hidden":"",children:oe?"":"Outgoing"})]}),F==="tree"&&a.jsx(ge,{variant:"outline",size:"sm",onClick:ht,className:`flex items-center gap-2 whitespace-nowrap ${pe?"text-xs py-2 px-3 flex-1 justify-center":""}`,style:{minWidth:"80px"},children:w?a.jsxs(a.Fragment,{children:[a.jsx(uj,{className:`h-4 w-4 ${pe?"h-3 w-3":""}`}),a.jsx("span",{className:pe?"hidden":"",children:oe?"   ":"Exit Fullscreen"})]}):a.jsxs(a.Fragment,{children:[a.jsx(qI,{className:`h-4 w-4 ${pe?"h-3 w-3":""}`}),a.jsx("span",{className:pe?"hidden":"",children:oe?" ":"Fullscreen"})]})})]}),a.jsx("div",{className:`flex ${pe?"flex-col gap-3":"items-center justify-between"}`,children:a.jsx("div",{className:"w-full",children:(F==="tree"||F==="list")&&a.jsxs("div",{className:"relative",children:[a.jsx(Qi,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 ${pe?"h-3.5 w-3.5":"h-4 w-4"} text-muted-foreground`}),a.jsx("input",{type:"text",placeholder:oe?"  ...":"Search members...",value:p,onChange:Te=>g(Te.target.value),className:`pl-10 pr-4 border rounded-md ${pe?"py-2 text-sm w-full":"py-2 text-sm w-64"}`})]})})})]}),_t,Et,a.jsx("div",{className:F!=="incoming"||!ot?"hidden":"",children:ft}),at,a.jsx(Qf,{isOpen:N,onClose:()=>{A(!1),_(null),B(null),D(null),O(null)},onSubmit:Te=>{e&&(s(e),$e(Ee=>Ee+1)),A(!1),_(null),B(null),D(null),O(null)},familyTreeId:(d==null?void 0:d.id)||"",familyMembers:(d==null?void 0:d.persons)||[],relationships:(d==null?void 0:d.relationships)||[],initialRelationshipData:C?{parentId:C,relationshipType:"father"}:T?{parentId:T,relationshipType:"spouse"}:$?{parentId:$,relationshipType:"father"}:L?{parentId:L,relationshipType:"mother"}:null,mode:"create"}),a.jsx(Qf,{isOpen:P,onClose:()=>{U(!1),S(null)},onSubmit:Te=>{e&&(s(e),$e(Ee=>Ee+1)),U(!1),S(null)},familyTreeId:(d==null?void 0:d.id)||"",familyMembers:(d==null?void 0:d.persons)||[],relationships:(d==null?void 0:d.relationships)||[],initialData:M?En(M):void 0,mode:"edit"}),a.jsx(lee,{isOpen:R,onClose:()=>q(!1),treeId:e||"",treeName:oe?(d==null?void 0:d.name)||"":(d==null?void 0:d.nameEn)||"",treePersons:(d==null?void 0:d.persons)||[]}),a.jsx(Sh,{isOpen:Oe,onClose:Ie,title:oe?" ":"Confirm Deletion",children:a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"flex items-start gap-3",children:a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-foreground",children:oe?"      ":"Are you sure you want to delete this person?"}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:oe?"     .":"This action cannot be undone."})]})}),a.jsxs("div",{className:"flex justify-end gap-3",children:[a.jsx(ge,{variant:"outline",onClick:Ie,children:oe?"":"Cancel"}),a.jsx(ge,{variant:"destructive",onClick:_e,children:oe?"":"Delete"})]})]})}),a.jsx(R7,{person:ye,isOpen:Rt,onClose:()=>{Nt(!1),ze(null)}})]})};function uee(e){return new TextEncoder().encode(e).buffer}function dee(e){const t=new Uint8Array(e);let n="";for(let r=0;r<t.byteLength;r++)n+=String.fromCharCode(t[r]);return btoa(n)}function fee(e){const t=atob(e),n=new Uint8Array(t.length);for(let r=0;r<t.length;r++)n[r]=t.charCodeAt(r);return n.buffer}async function $7(){const e=uee("nasabna-tree-sharing-key-2025");return crypto.subtle.importKey("raw",e,{name:"AES-GCM"},!1,["encrypt","decrypt"])}async function H2(e){try{const t=await $7(),r=new TextEncoder().encode(e),s=crypto.getRandomValues(new Uint8Array(12)),i=await crypto.subtle.encrypt({name:"AES-GCM",iv:s},t,r),l=new Uint8Array(s.length+i.byteLength);return l.set(s,0),l.set(new Uint8Array(i),s.length),dee(l.buffer)}catch{return e}}async function F7(e){try{const t=await $7(),n=fee(e),r=new Uint8Array(n),s=r.slice(0,12),i=r.slice(12),l=await crypto.subtle.decrypt({name:"AES-GCM",iv:s},t,i);return new TextDecoder().decode(l)}catch{return e}}const hee=Object.freeze(Object.defineProperty({__proto__:null,decryptString:F7,encryptString:H2},Symbol.toStringTag,{value:"Module"})),mee=()=>{const{id:e}=Gu(),t=Ir(),{language:n}=Xt(),{user:r}=Pr(),{trees:s,fetchTrees:i,deleteTree:l}=xs(),{isMobile:o}=Tr(),[c,u]=Y.useState("info"),[d,f]=Y.useState(!1),[m,h]=Y.useState(!1),[x,y]=Y.useState(!1),[p,g]=Y.useState(!1),[w,v]=Y.useState(!1),[N,A]=Y.useState(!1),[P,U]=Y.useState(null),[M,S]=Y.useState(null),[C,_]=Y.useState(!0),[T,B]=Y.useState(null),[$,D]=Y.useState(null),[L,O]=Y.useState(!1),[W,E]=Y.useState(null),[H,V]=Y.useState(""),[R,q]=Y.useState(!1);Y.useRef(null),Y.useEffect(()=>{},[H]);const F=n==="ar",[G,ee]=Y.useState({id:"",name:"",description:"",descriptionEn:"",coverImage:void 0,isPublic:!0,allowCollaboration:!1,createdAt:"",updatedAt:"",membersCount:0,generationsCount:0}),[ae,re]=Y.useState(G),[Q,fe]=Y.useState([]),Se=(ye,ze)=>{const Ze=new Map;ye.forEach(se=>{Ze.set(se.id,{...se,generation:0})});const xe=new Map;ze.forEach(se=>{var he,ke,be,Le,He,Ue;((he=se.relationshipType)==null?void 0:he.toLowerCase())==="child"?xe.set(((ke=se.relatedPersonId)==null?void 0:ke.toString())||"",((be=se.personId)==null?void 0:be.toString())||""):((Le=se.relationshipType)==null?void 0:Le.toLowerCase())==="parent"&&xe.set(((He=se.personId)==null?void 0:He.toString())||"",((Ue=se.relatedPersonId)==null?void 0:Ue.toString())||"")}),ye.forEach(se=>{if(se.parentIds&&se.parentIds.length>0){const he=se.parentIds[0];xe.set(se.id,he)}});const pt=ye.filter(se=>!xe.has(se.id));pt.forEach(se=>{const he=Ze.get(se.id);he&&(he.generation=0,Ze.set(se.id,he))});const Ne=pt.map(se=>({memberId:se.id,generation:0})),de=new Set;for(pt.forEach(se=>de.add(se.id));Ne.length>0;){const{memberId:se,generation:he}=Ne.shift();xe.forEach((ke,be)=>{if(ke===se&&!de.has(be)){const Le=Ze.get(be);Le&&(Le.generation=he+1,Ze.set(be,Le),de.add(be),Ne.push({memberId:be,generation:he+1}))}})}return Array.from(Ze.values())},oe=async(ye,ze)=>{try{xs.getState().updateTreeGenerations(ye.toString(),ze),await i()}catch{}};Y.useEffect(()=>{(async()=>{if(G.id&&G.id!=="0"&&G.id!=="")try{q(!0);const ze=await H2(G.id);V(ze)}catch(ze){console.warn("Encryption error:",ze),V(G.id)}finally{q(!1)}else if(G.id===""&&e)try{q(!0);const ze=await H2(e);V(ze)}catch(ze){console.warn("Encryption error for param:",ze),V(e)}finally{q(!1)}else V("")})()},[G.id,e]),Y.useEffect(()=>{(async()=>{var ze,Ze;if(!e){B(F?"     ":"Tree ID not found"),_(!1);return}try{_(!0),B(null);let xe=null;try{xe=await Pt.getTreeById(parseInt(e))}catch{try{await i();const he=xs.getState().trees.find(ke=>{var be;return((be=ke.id)==null?void 0:be.toString())===e.toString()});if(he)xe=he;else{const be=(await Pt.getPublicTrees()).find(Le=>{var He;return((He=Le.id)==null?void 0:He.toString())===e.toString()});be&&(xe=be)}}catch{}}if(!xe){B(F?"    ":"Tree not found"),_(!1);return}const pt={id:((ze=xe.id)==null?void 0:ze.toString())||e,name:xe.name||"",description:xe.description||"",descriptionEn:xe.description||"",coverImage:xe.photoUrl||void 0,isPublic:xe.isPrivate!==void 0?!xe.isPrivate:!0,allowCollaboration:xe.members&&xe.members.length>0,createdAt:xe.createdAt||new Date().toISOString(),updatedAt:xe.updatedAt||new Date().toISOString(),membersCount:((Ze=xe.members)==null?void 0:Ze.length)||0,generationsCount:0};ee(pt),re(pt);let de=(Array.isArray(xe.members)?xe.members:[]).map(se=>({id:se.id&&se.id.toString()!=="undefined"&&se.id.toString()!=="null"&&!isNaN(parseInt(se.id.toString()))&&parseInt(se.id.toString())>0?se.id.toString():Date.now().toString()+Math.random().toString(36).substr(2,9),firstName:se.firstName||se.name||"",firstNameEn:se.firstName||se.name||"",lastName:se.lastName||"",lastNameEn:se.lastName||"",gender:se.gender||"unknown",birthDate:se.birthDate||void 0,deathDate:se.deathDate||void 0,birthPlace:se.birthPlace||void 0,birthPlaceEn:se.birthPlace||void 0,occupation:se.occupation||void 0,occupationEn:se.occupation||void 0,bio:void 0,bioEn:void 0,avatar:se.photoUrl||void 0,isAlive:se.isDeceased!==void 0?!se.isDeceased:!0,generation:0,parentId:void 0,spouseId:void 0,children:[],photos:[],documents:[]}));try{const he=(await Pt.getRelationships()).filter(be=>!0);de=Se(de,he);const ke=Math.max(...de.map(be=>be.generation),0);ee(be=>({...be,generationsCount:ke})),re(be=>({...be,generationsCount:ke})),await oe(e,ke)}catch{}fe(de)}catch{B(F?"    ":"Failed to load tree data")}finally{_(!1)}})()},[e,F]);const pe=async()=>{var ye,ze,Ze,xe,pt,Ne;if(e)try{if(_(!0),!ae.name||ae.name.trim()==="")throw new Error(F?"  ":"Tree name is required");const de=await Pt.updateTree(parseInt(e),ae.name.trim(),!ae.isPublic,((ye=ae.description)==null?void 0:ye.trim())||"");if(!de)throw new Error(F?"   ":"Failed to update tree");const se={...ae,id:((ze=de.id)==null?void 0:ze.toString())||e,name:de.name||ae.name,description:de.description||ae.description,descriptionEn:de.description||ae.descriptionEn,coverImage:de.photoUrl||ae.coverImage,isPublic:de.isPrivate!==void 0?!de.isPrivate:ae.isPublic,allowCollaboration:!!(de.members&&de.members.length>0),createdAt:de.createdAt||ae.createdAt,updatedAt:de.updatedAt||new Date().toISOString(),membersCount:((Ze=de.members)==null?void 0:Ze.length)||ae.membersCount,generationsCount:ae.generationsCount};ee(se),f(!1)}catch(de){let se=F?"    ":"Failed to update tree data";(pt=(xe=de.response)==null?void 0:xe.data)!=null&&pt.message?se+=`: ${de.response.data.message}`:de.message?se+=`: ${de.message}`:((Ne=de.response)==null?void 0:Ne.status)===400&&(se+=": "+(F?"  ":"Invalid data provided")),B(se)}finally{_(!1)}},me=()=>{re(G),f(!1)},ne=async ye=>{try{const ze=await Pt.updateTree(parseInt(ye.id),ye.name,!ye.isPublic,F?ye.description:ye.descriptionEn);ee(Ze=>({...Ze,name:ze.name,description:ze.description||Ze.description,descriptionEn:ze.description||Ze.descriptionEn,isPublic:ze.isPrivate!==void 0?!ze.isPrivate:Ze.isPublic})),re(Ze=>({...Ze,name:ze.name,description:ze.description||Ze.description,descriptionEn:ze.description||Ze.descriptionEn,isPublic:ze.isPrivate!==void 0?!ze.isPrivate:Ze.isPublic})),xs.getState().updateTree(ze.id.toString(),{...ze,isPrivate:ze.isPrivate,description:ze.description||""}),E(F?"   ":"Tree updated successfully"),setTimeout(()=>E(null),3e3),h(!1)}catch{E(F?"   ":"Failed to update tree"),setTimeout(()=>E(null),3e3)}},it=async ye=>{var ze,Ze,xe,pt,Ne;try{const de={id:(ze=ye.id)!=null&&ze.toString()&&ye.id.toString()!=="undefined"&&ye.id.toString()!=="null"&&!isNaN(parseInt(ye.id.toString()))?ye.id.toString():Date.now().toString()+Math.random().toString(36).substr(2,9),firstName:ye.firstName||((Ze=ye.name)==null?void 0:Ze.split(" ")[0])||"",firstNameEn:ye.firstNameEn||((xe=ye.name)==null?void 0:xe.split(" ")[0])||"",lastName:ye.lastName||((pt=ye.name)==null?void 0:pt.split(" ").slice(1).join(" "))||"",lastNameEn:ye.lastNameEn||((Ne=ye.name)==null?void 0:Ne.split(" ").slice(1).join(" "))||"",gender:ye.gender||"unknown",birthDate:ye.birthDate||void 0,deathDate:ye.deathDate||void 0,birthPlace:ye.birthPlace||void 0,birthPlaceEn:ye.birthPlaceEn||void 0,occupation:ye.occupation||void 0,occupationEn:ye.occupationEn||void 0,bio:ye.bio||void 0,bioEn:ye.bioEn||void 0,avatar:ye.avatar||void 0,isAlive:!ye.isDeceased,generation:ye.generation||1,parentId:ye.parentId||void 0,spouseId:ye.spouseId||void 0,children:ye.children||[],photos:ye.photos||[],documents:ye.documents||[]},se=[...Q,de];fe(se);try{const he=await Pt.getRelationships(),ke=Se(se,he);fe(ke);const be=Math.max(...ke.map(Le=>Le.generation),1);ee(Le=>({...Le,membersCount:Le.membersCount+1,generationsCount:be})),re(Le=>({...Le,membersCount:Le.membersCount+1,generationsCount:be})),e&&await oe(e,be)}catch{}E(F?"   ":"Member added successfully"),setTimeout(()=>E(null),3e3)}catch{E(F?"   ":"Failed to add member"),setTimeout(()=>E(null),3e3)}},$e=async ye=>{var ze,Ze,xe;if(confirm(F?"      ":"Are you sure you want to delete this member?"))try{_(!0);const Ne=(await xs.getState().getRelationships()).filter(se=>se.personId===parseInt(ye)||se.relatedPersonId===parseInt(ye));for(const se of Ne)try{await xs.getState().deleteRelationship(se.id.toString())}catch{}await xs.getState().deletePerson(ye);const de=Q.filter(se=>se.id!==ye);fe(de),ee(se=>({...se,membersCount:se.membersCount-1})),re(se=>({...se,membersCount:se.membersCount-1}));try{const se=await Pt.getRelationships(),he=Se(de,se);fe(he);const ke=Math.max(...he.map(be=>be.generation),1);ee(be=>({...be,generationsCount:ke})),re(be=>({...be,generationsCount:ke})),e&&await oe(e,ke)}catch{}}catch(pt){let Ne=F?"   ":"Failed to delete member";(Ze=(ze=pt.response)==null?void 0:ze.data)!=null&&Ze.message?Ne+=`: ${pt.response.data.message}`:(xe=pt.response)!=null&&xe.data?Ne+=`: ${JSON.stringify(pt.response.data)}`:pt.message&&(Ne+=`: ${pt.message}`),B(Ne)}finally{_(!1)}},Oe=async ye=>{var ze,Ze,xe,pt,Ne;try{D(null);const de=await Pt.updatePerson(parseInt(ye.id),ye.name,ye.birthDate||"",F?ye.birthPlace||"":ye.birthPlaceEn||"",F?ye.occupation||"":ye.occupationEn||"",ye.gender||"unknown",parseInt(e||"0")),se=Q.map(he=>{var ke,be,Le,He,Ue,De,_e,Ie,ht,wt,St;return he.id===((ke=ye.id)==null?void 0:ke.toString())?{...he,firstName:((be=ye.name)==null?void 0:be.split(" ")[0])||he.firstName||"",firstNameEn:((Le=ye.name)==null?void 0:Le.split(" ")[0])||he.firstNameEn||"",lastName:((He=ye.name)==null?void 0:He.split(" ").slice(1).join(" "))||he.lastName||"",lastNameEn:((Ue=ye.name)==null?void 0:Ue.split(" ").slice(1).join(" "))||he.lastNameEn||"",gender:de.gender||ye.gender||he.gender,birthDate:((De=de.birth)==null?void 0:De.date)||ye.birthDate||he.birthDate,deathDate:((_e=de.death)==null?void 0:_e.date)||ye.deathDate||he.deathDate,birthPlace:((ht=(Ie=de.birth)==null?void 0:Ie.place)==null?void 0:ht.city)||ye.birthPlace||he.birthPlace,birthPlaceEn:((St=(wt=de.birth)==null?void 0:wt.place)==null?void 0:St.city)||ye.birthPlaceEn||he.birthPlaceEn,occupation:Array.isArray(de.occupation)&&de.occupation.length>0?de.occupation[0].title:ye.occupation||he.occupation,occupationEn:Array.isArray(de.occupation)&&de.occupation.length>0?de.occupation[0].title:ye.occupationEn||he.occupation,isAlive:de.isDeceased!==void 0?!de.isDeceased:ye.isDeceased!==void 0?!ye.isDeceased:he.isAlive}:he});fe(se);try{const he=await Pt.getRelationships(),ke=Se(se,he);fe(ke);const be=Math.max(...ke.map(Le=>Le.generation),1);ee(Le=>({...Le,generationsCount:be})),re(Le=>({...Le,generationsCount:be})),e&&await oe(e,be)}catch{}g(!1),S(null)}catch(de){let se=F?"    ":"Failed to update member";((ze=de.response)==null?void 0:ze.status)===400?se=F?"    ":"Please check the entered data":((Ze=de.response)==null?void 0:Ze.status)===401?se=F?"     ":"You must be logged in to perform this action":((xe=de.response)==null?void 0:xe.status)===403?se=F?"     ":"You do not have permission to perform this action":((pt=de.response)==null?void 0:pt.status)===404?se=F?"     ":"The requested member was not found":((Ne=de.response)==null?void 0:Ne.status)===500?se=F?"   .     ":"Server error. Please try again later":de.message&&(de.message.includes("Network Error")?se=F?"  .     ":"Network error. Please check your internet connection":de.message.includes("timeout")&&(se=F?"  .    ":"Request timeout. Please try again")),D(se)}},qe=ye=>ye==="male"?Na:ye==="female"?fj:sn,gt=ye=>ye===1?Nu:ye===2||ye&&ye>2?sn:na,ut=(ye,ze)=>{if(!ye)return"";let Ze;try{if(ye.includes("T"))Ze=new Date(ye);else if(ye.includes("-")){const de=ye.split("-");de.length===3?Ze=new Date(parseInt(de[0]),parseInt(de[1])-1,parseInt(de[2])):Ze=new Date(ye)}else if(ye.includes("/")){const de=ye.split("/");de.length===3?Ze=new Date(parseInt(de[2]),parseInt(de[0])-1,parseInt(de[1])):Ze=new Date(ye)}else Ze=new Date(ye)}catch{return""}if(isNaN(Ze.getTime()))return"";let xe;if(ze&&ze.trim()!=="")try{if(ze.includes("T"))xe=new Date(ze);else if(ze.includes("-")){const de=ze.split("-");de.length===3?xe=new Date(parseInt(de[0]),parseInt(de[1])-1,parseInt(de[2])):xe=new Date(ze)}else if(ze.includes("/")){const de=ze.split("/");de.length===3?xe=new Date(parseInt(de[2]),parseInt(de[0])-1,parseInt(de[1])):xe=new Date(ze)}else xe=new Date(ze);isNaN(xe.getTime())&&(xe=new Date)}catch{xe=new Date}else xe=new Date;let pt=xe.getFullYear()-Ze.getFullYear();const Ne=xe.getMonth()-Ze.getMonth();return(Ne<0||Ne===0&&xe.getDate()<Ze.getDate())&&pt--,pt>=0?pt.toString():"0"},Rt=ye=>{const ze=ye.target;ze.src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB3aWR0aD0iMTAwIiBoZWlnaHQ9IjEwMCIgZmlsbD0iI2NjYyIvPjx0ZXh0IHg9IjUwIiB5PSI1NSIgZm9udC1mYW1pbHk9IkFyaWFsIiBmb250LXNpemU9IjEwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSIjNjY2Ij5JbWFnZSBOb3QgRm91bmQ8L3RleHQ+PC9zdmc+"};return C?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx(wr,{className:"h-8 w-8 animate-spin text-primary"})}):!(()=>{if(!r||!e)return!1;const ye=s.find(ze=>ze.id===e);return ye?ye.ownerId===r.id||ye.userRole==="owner":!1})()&&!C&&r?a.jsxs("div",{className:"flex flex-col items-center justify-center h-64 space-y-4",children:[a.jsx(fo,{className:"h-12 w-12 text-destructive"}),a.jsx("p",{className:"text-destructive text-center",children:F?"     ":"You do not have permission to edit this tree"}),a.jsx(ge,{onClick:()=>t("/trees"),children:F?" ":"Back to Trees"})]}):T?a.jsxs("div",{className:"flex flex-col items-center justify-center h-64 space-y-4",children:[a.jsx(fo,{className:"h-12 w-12 text-destructive"}),a.jsx("p",{className:"text-destructive text-center",children:T}),a.jsx(ge,{onClick:()=>window.location.reload(),children:F?" ":"Try Again"})]}):a.jsxs("div",{className:"space-y-6",children:[W&&a.jsx("div",{className:"bg-green-100 border border-green-200 rounded-lg p-3",children:a.jsx("p",{className:"text-green-800 text-sm",children:W})}),a.jsxs("div",{className:`flex flex-col ${o?"gap-3":"sm:flex-row sm:items-center"} justify-between`,children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs(ge,{variant:"outline",onClick:()=>t("/trees"),className:"flex items-center gap-2",size:o?"sm":"default",children:[a.jsx(ho,{className:`h-4 w-4 ${o?"h-3 w-33":""}`}),a.jsx("span",{className:o?"hidden":"hidden xs:inline",children:F?" ":"Back to Trees"})]}),a.jsxs("div",{children:[a.jsx("h1",{className:`font-bold text-foreground truncate ${o?"text-lg max-w-[150px]":"text-xl sm:text-2xl max-w-[200px] sm:max-w-none"}`,children:G.name}),a.jsx("p",{className:`text-muted-foreground ${o?"text-xs":"text-xs sm:text-sm"}`,children:F?`${G.membersCount}   ${G.generationsCount} `:`${G.membersCount} members  ${G.generationsCount} generations`})]})]}),a.jsx("div",{className:`flex ${o?"gap-1":"gap-2"}`})]}),a.jsx("div",{className:`flex ${o?"flex-wrap gap-1 p-1 bg-muted rounded-lg":"flex-wrap gap-1 border-b"}`,children:[{id:"info",label:F?" ":"Tree Info",icon:Qn},{id:"members",label:F?" ":"Family Members",icon:In},{id:"settings",label:F?"":"Settings",icon:Mf}].map(ye=>a.jsxs(ge,{variant:c===ye.id?"default":"ghost",onClick:()=>u(ye.id),className:`flex items-center gap-2 ${o?"text-xs py-2 px-3 flex-1 justify-center":"text-xs sm:text-sm"}`,size:o?"sm":"default",children:[we.createElement(ye.icon,{className:`h-4 w-4 ${o?"h-3 w-3":""}`}),a.jsx("span",{className:o?"hidden":"hidden xs:inline",children:ye.label})]},ye.id))}),c==="info"&&a.jsxs(Qe,{children:[a.jsx(xt,{className:`${o?"p-4":""}`,children:a.jsxs(yt,{className:"flex items-center gap-2",children:[a.jsx(Qn,{className:`h-5 w-5 ${o?"h-4 w-4":""}`}),F?" ":"Tree Information"]})}),a.jsxs(tt,{className:`space-y-6 ${o?"p-4":""}`,children:[a.jsx("div",{className:`grid ${o?"grid-cols-1 gap-3":"grid-cols-1 sm:grid-cols-2 gap-4"}`,children:a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:`font-medium ${o?"text-xs":"text-sm"}`,children:F?" ":"Tree Name"}),a.jsx(Kt,{value:d?ae.name:G.name,onChange:ye=>re(ze=>({...ze,name:ye.target.value})),disabled:!d||C,placeholder:F?" ":"Tree Name",className:o?"text-sm py-2":"text-sm"})]})}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:`font-medium ${o?"text-xs":"text-sm"}`,children:F?" ":"Tree Description"}),a.jsx(id,{value:d?F?ae.description||"":ae.descriptionEn||"":F?G.description||"":G.descriptionEn||"",onChange:ye=>re(ze=>({...ze,[F?"description":"descriptionEn"]:ye.target.value})),disabled:!d||C,placeholder:F?"  ...":"Write a description for the tree...",rows:o?2:3,className:o?"text-sm py-2":"text-sm"})]}),a.jsxs("div",{className:`grid ${o?"grid-cols-2 gap-2":"grid-cols-2 sm:grid-cols-4 gap-3"}`,children:[a.jsxs("div",{className:`text-center rounded-lg ${o?"p-2":"p-3"} bg-secondary/50`,children:[a.jsx(In,{className:`text-primary mx-auto ${o?"h-5 w-5 mb-1":"h-6 w-6 mb-1.5"}`}),a.jsx("div",{className:`font-bold text-foreground ${o?"text-lg":"text-xl"}`,children:G.membersCount}),a.jsx("div",{className:"text-muted-foreground text-xs",children:F?"":"Members"})]}),a.jsxs("div",{className:`text-center rounded-lg ${o?"p-2":"p-3"} bg-secondary/50`,children:[a.jsx(Qn,{className:`text-green-600 mx-auto ${o?"h-5 w-5 mb-1":"h-6 w-6 mb-1.5"}`}),a.jsx("div",{className:`font-bold text-foreground ${o?"text-lg":"text-xl"}`,children:G.generationsCount}),a.jsx("div",{className:"text-muted-foreground text-xs",children:F?"":"Generations"})]})]}),d&&a.jsxs("div",{className:`flex ${o?"flex-col gap-2":"gap-3 pt-4"}`,children:[a.jsxs(ge,{onClick:pe,className:"flex items-center gap-2",disabled:C,size:o?"sm":"default",children:[C?a.jsx(wr,{className:`animate-spin ${o?"h-3 w-3":"h-4 w-4"}`}):a.jsx(Au,{className:`h-4 w-4 ${o?"h-3 w-3":""}`}),o?F?"":"Save":F?" ":"Save Changes"]}),a.jsx(ge,{variant:"outline",onClick:me,disabled:C,size:o?"sm":"default",children:F?"":"Cancel"})]})]})]}),c==="members"&&a.jsxs("div",{className:`flex ${o?"flex-col gap-3":"justify-between items-center"} mb-6`,children:[a.jsx("h2",{className:`font-bold text-foreground ${o?"text-lg":"text-xl"}`,children:F?" ":"Family Members"}),a.jsxs(ge,{onClick:()=>y(!0),className:"flex items-center gap-2",size:o?"sm":"default",children:[a.jsx(_u,{className:`h-4 w-4 ${o?"h-3 w-3":""}`}),o?F?"":"Add":F?" ":"Add Member"]})]}),c==="members"&&a.jsxs("div",{className:`grid ${o?"grid-cols-1 gap-3":"grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4"}`,children:[Q.map(ye=>a.jsx(Qe,{className:`overflow-hidden hover:shadow-md transition-shadow ${o?"rounded-lg":""}`,children:a.jsxs(tt,{className:"p-0",children:[a.jsx("div",{className:`relative ${o?"h-24":"h-28"} ${ye.gender==="female"?"bg-gradient-to-r from-pink-500/20 to-pink-500/40":ye.gender==="male"?"bg-gradient-to-r from-blue-500/20 to-blue-500/40":"bg-gradient-to-r from-primary/20 to-primary/40"}`,children:a.jsxs("div",{className:`absolute ${o?"top-1 right-1":"top-2 right-2"} flex gap-1`,children:[a.jsx(ge,{size:o?"icon":"sm",variant:"secondary",className:`bg-background/80 hover:bg-background ${o?"h-6 w-6 p-0":"h-7 w-7 p-0"}`,onClick:()=>{S(ye),g(!0)},children:a.jsx(sa,{className:`h-3 w-3 ${o?"h-2.5 w-2.5":""}`})}),a.jsx(ge,{size:o?"icon":"sm",variant:"secondary",className:`bg-background/80 hover:bg-background text-destructive hover:text-destructive ${o?"h-6 w-6 p-0":"h-7 w-7 p-0"}`,onClick:()=>$e(ye.id),disabled:C,children:a.jsx(Ia,{className:`h-3 w-3 ${o?"h-2.5 w-2.5":""}`})})]})}),a.jsxs("div",{className:`px-3 ${o?"-mt-8":"-mt-10"}`,children:[a.jsx("div",{className:`rounded-full bg-background border-4 border-background mx-auto flex items-center justify-center ${o?"w-12 h-12":"w-14 h-14"}`,children:ye.avatar?a.jsx("img",{src:ye.avatar,alt:"Avatar",className:"w-full h-full rounded-full object-cover",onError:Rt}):a.jsx("div",{className:`w-full h-full rounded-full flex items-center justify-center ${ye.gender==="female"?"bg-gradient-to-br from-pink-500/20 to-pink-500/40":ye.gender==="male"?"bg-gradient-to-br from-blue-500/20 to-blue-500/40":"bg-gradient-to-br from-primary/20 to-primary/40"}`,children:we.createElement(qe(ye.gender),{className:` ${ye.gender==="female"?"text-pink-500":ye.gender==="male"?"text-blue-500":"text-primary"} ${o?"h-5 w-5":"h-6 w-6"}`})})}),a.jsx("div",{className:`text-center ${o?"pt-2 pb-2":"pt-3 pb-3"}`,children:a.jsx("h3",{className:`font-bold text-foreground truncate ${o?"text-xs":"text-sm"}`,children:F?ye.firstName||ye.lastName?`${ye.firstName||""} ${ye.lastName||""}`.trim():" ":ye.firstNameEn||ye.lastNameEn?`${ye.firstNameEn||""} ${ye.lastNameEn||""}`.trim():"Unknown"})})]}),a.jsxs("div",{className:`border-t bg-muted/30 p-3 ${o?"p-2":""}`,children:[a.jsxs("div",{className:"space-y-1.5 text-xs",children:[ye.birthPlace&&a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(ai,{className:`text-muted-foreground flex-shrink-0 ${o?"h-3 w-3":"h-3.5 w-3.5"}`}),a.jsx("span",{className:"truncate",children:F?ye.birthPlace:ye.birthPlaceEn})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[ye.isAlive?a.jsx(Or,{className:`text-green-500 flex-shrink-0 ${o?"h-3 w-3":"h-3.5 w-3.5"}`}):a.jsx(Or,{className:`text-red-500 flex-shrink-0 ${o?"h-3 w-3":"h-3.5 w-3.5"}`}),a.jsx("span",{className:"truncate",children:ye.isAlive?F?"  ":"Alive":F?"":"Deceased"})]}),(ye.birthDate||ye.deathDate)&&a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx(sn,{className:`text-muted-foreground flex-shrink-0 ${o?"h-3 w-3":"h-3.5 w-3.5"}`}),a.jsxs("span",{className:"truncate",children:[ut(ye.birthDate,ye.deathDate)," ",F?"":"years"]})]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[we.createElement(gt(ye.generation),{className:`text-muted-foreground flex-shrink-0 ${o?"h-3 w-3":"h-3.5 w-3.5"}`}),a.jsx("span",{className:"truncate",children:F?` ${ye.generation}`:`Gen ${ye.generation}`})]})]}),a.jsx("div",{className:`mt-3 ${o?"mt-2":""}`,children:a.jsxs(ge,{size:"sm",variant:"outline",className:`w-full ${o?"h-7 text-xs":"h-8 text-xs"}`,onClick:()=>{const ze={...ye,parents:ye.parentIds?ye.parentIds.map(Ze=>{const xe=Q.find(pt=>pt.id===Ze);return{id:Ze,name:xe?F?`${xe.firstName} ${xe.lastName}`:`${xe.firstNameEn||xe.firstName} ${xe.lastNameEn||xe.lastName}`:F?" ":"Unknown",relationship:F?"":"Parent"}}):[],spouses:ye.spouseIds?ye.spouseIds.map(Ze=>{const xe=Q.find(pt=>pt.id===Ze);return{id:Ze,name:xe?F?`${xe.firstName} ${xe.lastName}`:`${xe.firstNameEn||xe.firstName} ${xe.lastNameEn||xe.lastName}`:F?" ":"Unknown"}}):[],childrenDetails:ye.childrenIds?ye.childrenIds.map(Ze=>{const xe=Q.find(pt=>pt.id===Ze);return{id:Ze,name:xe?F?`${xe.firstName} ${xe.lastName}`:`${xe.firstNameEn||xe.firstName} ${xe.lastNameEn||xe.lastName}`:F?" ":"Unknown"}}):[]};U(ze),A(!0)},children:[a.jsx(ra,{className:`mr-1 ${o?"h-3 w-3":"h-3.5 w-3.5"}`}),a.jsx("span",{className:o?"hidden":"hidden xs:inline",children:F?" ":"View Details"})]})})]})]})},ye.id)),Q.length===0&&a.jsxs("div",{className:"col-span-full text-center py-8",children:[a.jsx(In,{className:`text-muted-foreground mx-auto mb-3 ${o?"h-8 w-8":"h-10 w-10"}`}),a.jsx("h3",{className:"font-medium text-foreground mb-1 text-base",children:F?"    ":"No Family Members"}),a.jsx("p",{className:`text-muted-foreground mb-3 ${o?"text-xs":"text-sm"}`,children:F?"    ":"Start by adding your first family members"}),a.jsxs(ge,{onClick:()=>y(!0),size:"sm",children:[a.jsx(_u,{className:`mr-1 ${o?"h-3 w-3":"h-4 w-4"}`}),a.jsx("span",{className:o?"hidden":"hidden xs:inline",children:F?" ":"Add Member"})]})]})]}),a.jsx(Cb,{isOpen:m,onClose:()=>h(!1),onSubmit:ne,initialData:{id:G.id,name:G.name,description:G.description,descriptionEn:G.descriptionEn,isPublic:G.isPublic},mode:"edit"}),a.jsx(Qf,{isOpen:x,onClose:()=>y(!1),onSubmit:it,familyTreeId:e||"",familyMembers:Q,mode:"create"}),a.jsx(Qf,{isOpen:p,onClose:()=>{g(!1),S(null)},onSubmit:Oe,familyTreeId:e||"",familyMembers:Q,initialData:M?{id:M.id,name:M.firstName||M.lastName?`${M.firstName||""} ${M.lastName||""}`.trim():"",gender:M.gender,birthDate:M.birthDate,deathDate:M.deathDate,birthPlace:M.birthPlace,birthPlaceEn:M.birthPlaceEn,occupation:M.occupation,occupationEn:M.occupationEn,isAlive:M.isAlive}:void 0,mode:"edit"}),a.jsx(R7,{person:P,isOpen:N,onClose:()=>{A(!1),U(null)}}),c==="settings"&&a.jsxs(Qe,{children:[a.jsx(xt,{className:o?"p-4":"",children:a.jsxs(yt,{className:"flex items-center gap-2",children:[a.jsx(Mf,{className:`h-5 w-5 ${o?"h-4 w-4":""}`}),F?" ":"Tree Settings"]})}),a.jsx(tt,{className:`space-y-6 ${o?"p-4":""}`,children:a.jsxs("div",{className:`space-y-4 ${o?"space-y-3":""}`,children:[a.jsxs("div",{className:`border-t pt-4 ${o?"pt-3":""}`,children:[a.jsxs("h3",{className:"font-medium mb-4 flex items-center gap-2",children:[a.jsx(zi,{className:`h-4 w-4 ${o?"h-3 w-3":""}`}),F?" ":"Privacy Settings"]}),a.jsxs("div",{className:`flex ${o?"flex-col gap-3":"items-center justify-between"}`,children:[a.jsxs("div",{children:[a.jsx("p",{className:`font-medium ${o?"text-sm":""}`,children:F?" ":"Public Tree"}),a.jsx("p",{className:`text-muted-foreground ${o?"text-xs mt-1":"text-sm text-muted-foreground mt-1 sm:mt-0"}`,children:F?"   ":"Allow others to view the tree"})]}),a.jsx(ge,{variant:G.isPublic?"default":"outline",size:"sm",onClick:async()=>{try{_(!0);const ye=!G.isPublic,ze=await Pt.updateTree(parseInt(G.id),G.name,!ye,F?G.description||"":G.descriptionEn||"");ee(Ze=>({...Ze,isPublic:ye,isPrivate:!ye})),re(Ze=>({...Ze,isPublic:ye,isPrivate:!ye})),xs.getState().updateTree(ze.id.toString(),{...ze,isPrivate:!ye,description:ze.description||G.description||""}),E(F?"    ":"Privacy settings updated successfully"),setTimeout(()=>E(null),3e3)}catch{B(F?"    ":"Failed to update privacy settings")}finally{_(!1)}},disabled:C,className:o?"w-full":"",children:G.isPublic?F?"":"Public":F?"":"Private"})]}),a.jsx("div",{className:`p-3 bg-secondary/50 rounded-lg mt-4 ${o?"p-2 mt-3":""}`,children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(ju,{className:`text-primary mt-0.5 ${o?"h-3.5 w-3.5":"h-4 w-4"}`}),a.jsxs("div",{children:[a.jsx("p",{className:`font-medium ${o?"text-xs":"text-sm"}`,children:F?" ":"Privacy Information"}),a.jsx("p",{className:"text-muted-foreground mt-1 text-xs",children:F?"      .          .":"Public trees can be viewed and searched by everyone. Private trees can only be viewed by the owner and invited collaborators."})]})]})}),G.isPublic&&a.jsxs("div",{className:`space-y-3 mt-4 ${o?"space-y-2 mt-3":""}`,children:[a.jsx("h3",{className:"font-medium text-sm",children:F?"  ":"Public Share Link"}),a.jsxs("div",{className:`flex ${o?"flex-col gap-2":"flex-col sm:flex-row gap-2"}`,children:[a.jsx(Kt,{value:R?"Encrypting...":H?`${window.location.origin}/shared/${H}`:G.id?`${window.location.origin}/shared/${G.id}`:"Loading...",readOnly:!0,className:`flex-1 ${o?"text-xs py-2":"text-xs"}`,disabled:C||R||!H&&!G.id}),a.jsx(ge,{variant:"outline",size:"sm",disabled:C||R||!H&&!G.id,className:o?"w-full":"w-full sm:w-auto",onClick:()=>{const ye=`${window.location.origin}/shared/${H||G.id}`;navigator.clipboard.writeText(ye),O(!0),setTimeout(()=>O(!1),2e3)},children:F?"":"Copy"})]}),L&&a.jsx("p",{className:"text-sm text-green-600 mt-1",children:F?"  ":"Link copied"})]})]}),a.jsx("div",{className:`border-t pt-4 ${o?"pt-3":""}`,children:a.jsxs("div",{className:`flex ${o?"flex-col gap-3":"flex-col sm:flex-row sm:items-center justify-between gap-3"}`,children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-destructive text-sm",children:F?" ":"Delete Tree"}),a.jsx("p",{className:"text-muted-foreground mt-1 sm:mt-0 text-xs",children:F?"    ":"Permanently delete the tree and all its data"})]}),a.jsxs(ge,{variant:"destructive",className:"flex items-center gap-2 w-full sm:w-auto",size:"sm",disabled:C,onClick:()=>v(!0),children:[a.jsx(Ia,{className:`h-4 w-4 ${o?"h-3 w-3":""}`}),F?"":"Delete"]})]})})]})})]}),a.jsx(Pb,{isOpen:w,onClose:()=>v(!1),onConfirm:async()=>{try{_(!0),await l(G.id),t("/trees")}catch{B(F?"   ":"Failed to delete tree")}finally{_(!1),v(!1)}},title:F?" ":"Confirm Deletion",message:F?"            .":"Are you sure you want to delete this tree? This action cannot be undone.",confirmText:F?"":"Delete",cancelText:F?"":"Cancel",variant:"destructive"}),c==="info"&&a.jsx("div",{className:`flex items-center gap-2 mt-4 ${o?"flex-wrap":""}`,children:a.jsxs(ge,{variant:"outline",size:"sm",onClick:()=>h(!0),className:o?"flex-1":"",children:[a.jsx(sa,{className:`mr-1 ${o?"h-3 w-3":"h-4 w-4"}`}),o?F?"":"Edit":F?" ":"Edit Tree"]})})]})},pee=()=>{const{id:e}=Gu(),{language:t}=Xt(),[n,r]=Y.useState(null),[s,i]=Y.useState(!0),[l,o]=Y.useState(null),[c,u]=Y.useState(!1),[d,f]=Y.useState(!0),[m,h]=Y.useState(!1),[x,y]=Y.useState(!0),[p,g]=Y.useState(0),[w,v]=Y.useState([]),N=Y.useRef(null),A=t==="ar",{isMobile:P}=Tr(),U=async()=>{try{document.documentElement.requestFullscreen?await document.documentElement.requestFullscreen():document.documentElement.webkitRequestFullscreen?await document.documentElement.webkitRequestFullscreen():document.documentElement.msRequestFullscreen&&await document.documentElement.msRequestFullscreen(),u(!0),f(!1),setTimeout(()=>{h(!0)},100)}catch{f(!1),setTimeout(()=>{h(!0)},100)}};Y.useEffect(()=>{const S=()=>{const C=document.fullscreenElement||document.webkitFullscreenElement||document.msFullscreenElement;u(!!C),C&&setTimeout(()=>{h(!0)},100)};return document.addEventListener("fullscreenchange",S),document.addEventListener("webkitfullscreenchange",S),document.addEventListener("msfullscreenchange",S),()=>{document.removeEventListener("fullscreenchange",S),document.removeEventListener("webkitfullscreenchange",S),document.removeEventListener("msfullscreenchange",S)}},[]),Y.useEffect(()=>{(async()=>{var _;if(!e){o(A?"  ":"Tree ID is missing"),i(!1);return}let C=e;try{C=await F7(e)}catch{}try{i(!0),o(null),nn.clearPersonsInTreeCache();const T=await Pt.getPersonsInTree(Number(C));console.log("Raw persons data from API:",T),T.forEach((E,H)=>{console.log(`Person ${H} (${E.id}):`,{Latitude:E.Latitude,latitude:E.latitude,position:E.position,hasLatitude:"Latitude"in E,haslatitude:"latitude"in E,hasPosition:"position"in E})});let B=null;try{const E=await Pt.getTreeById(Number(C));E&&E.data&&(B={id:E.data.id.toString(),name:E.data.name||(A?" ":"Family Tree"),nameEn:E.data.name||"Family Tree",description:E.data.description||"",descriptionEn:E.data.description||"",createdAt:E.data.createdAt||new Date().toISOString(),updatedAt:E.data.updatedAt||new Date().toISOString()})}catch{}let $=[];try{$=await Pt.getRelationships(),v($)}catch{}const D=new Map,L=new Map,O=new Map;$&&Array.isArray($)&&$.forEach(E=>{var F,G,ee,ae,re,Q,fe,Se,oe,pe,me,ne;const H=(F=E.personId)==null?void 0:F.toString(),V=(G=E.relatedPersonId)==null?void 0:G.toString(),R=T.some(it=>it.id.toString()===H),q=T.some(it=>it.id.toString()===V);if(!(!R||!q))if(["Father","father","Mother","mother","Parent","parent"].includes(E.relationshipType)){const it=H,$e=V;D.has(it)||D.set(it,[]),(ee=D.get(it))==null||ee.push($e),L.has($e)||L.set($e,[]),(ae=L.get($e))==null||ae.push(it)}else if(["Child","child","Son","son","Daughter","daughter"].includes(E.relationshipType)){const it=H,$e=V;D.has($e)||D.set($e,[]),(re=D.get($e))==null||re.push(it),L.has(it)||L.set(it,[]),(Q=L.get(it))==null||Q.push($e)}else if(["Spouse","spouse","Husband","husband","Wife","wife"].includes(E.relationshipType))O.has(H)||O.set(H,[]),(fe=O.get(H))!=null&&fe.includes(V)||(Se=O.get(H))==null||Se.push(V),O.has(V)||O.set(V,[]),(oe=O.get(V))!=null&&oe.includes(H)||(pe=O.get(V))==null||pe.push(H);else{const it=H,$e=V;D.has(it)||D.set(it,[]),(me=D.get(it))==null||me.push($e),L.has($e)||L.set($e,[]),(ne=L.get($e))==null||ne.push(it)}}),T.forEach(E=>{var V,R,q,F;if(["parentId","parent_id","fatherId","father_id","motherId","mother_id"].forEach(G=>{var ee,ae;if(E[G]&&E[G]!=="0"&&E[G]!==0){const re=E[G].toString(),Q=E.id.toString();T.some(Se=>Se.id.toString()===re)&&(D.has(Q)||D.set(Q,[]),(ee=D.get(Q))==null||ee.push(re),L.has(re)||L.set(re,[]),(ae=L.get(re))==null||ae.push(Q))}}),E.parentIds&&Array.isArray(E.parentIds)&&E.parentIds.forEach(G=>{var ee,ae;if(G&&G!=="0"&&G!==0){const re=E.id.toString();T.some(fe=>fe.id.toString()===G.toString())&&(D.has(re)||D.set(re,[]),(ee=D.get(re))==null||ee.push(G.toString()),L.has(G.toString())||L.set(G.toString(),[]),(ae=L.get(G.toString()))==null||ae.push(re))}}),E.relationships&&E.relationships.spouses&&E.relationships.spouses.forEach(G=>{var ae,re;let ee=null;if(typeof G=="string"?ee=G:typeof G=="object"&&(G!=null&&G.person)?typeof G.person=="string"?ee=G.person:typeof G.person=="object"&&G.person.id&&(ee=G.person.id.toString()):typeof G=="object"&&(G!=null&&G.id)&&(ee=G.id.toString()),ee){const Q=E.id.toString();T.some(Se=>Se.id.toString()===ee)&&ee!==Q&&((O.get(Q)||[]).includes(ee)||(O.has(Q)||O.set(Q,[]),(ae=O.get(Q))==null||ae.push(ee),O.has(ee)||O.set(ee,[]),(re=O.get(ee))==null||re.push(Q)))}}),E.relationships){if(E.relationships.father){let G=null;if(typeof E.relationships.father=="string"?G=E.relationships.father:typeof E.relationships.father=="object"&&E.relationships.father.id&&(G=E.relationships.father.id.toString()),G){const ee=E.id.toString();T.some(re=>re.id.toString()===G)&&(D.has(ee)||D.set(ee,[]),(V=D.get(ee))==null||V.push(G),L.has(G)||L.set(G,[]),(R=L.get(G))==null||R.push(ee))}}if(E.relationships.mother){let G=null;if(typeof E.relationships.mother=="string"?G=E.relationships.mother:typeof E.relationships.mother=="object"&&E.relationships.mother.id&&(G=E.relationships.mother.id.toString()),G){const ee=E.id.toString();T.some(re=>re.id.toString()===G)&&(D.has(ee)||D.set(ee,[]),(q=D.get(ee))==null||q.push(G),L.has(G)||L.set(G,[]),(F=L.get(G))==null||F.push(ee))}}}}),T.forEach(E=>{const H=E.id.toString();T.forEach(V=>{var ee,ae,re,Q;const R=V.id.toString();if(H===R)return;const q=V;if((q.parentIds||q.parents||q.parent_ids||[]).some(fe=>(typeof fe=="object"&&fe.id?fe.id.toString():fe.toString())===H)){const fe=R,Se=H;D.has(fe)||D.set(fe,[]),(ee=D.get(fe))!=null&&ee.includes(Se)||(ae=D.get(fe))==null||ae.push(Se),L.has(Se)||L.set(Se,[]),(re=L.get(Se))!=null&&re.includes(fe)||(Q=L.get(Se))==null||Q.push(fe)}})});const W={id:C,name:(B==null?void 0:B.name)||(A?" ":"Family Tree"),nameEn:(B==null?void 0:B.nameEn)||"Family Tree",description:(B==null?void 0:B.description)||"",descriptionEn:(B==null?void 0:B.descriptionEn)||"",rootPersonId:(()=>{if(n!=null&&n.rootPersonId&&T.some(H=>H.id.toString()===n.rootPersonId))return n.rootPersonId;for(const E of T)if(E.isRoot)return E.id.toString();for(const E of T){const H=E.id.toString();if(!D.has(H))return H}return T.length>0?T[0].id.toString():"1"})(),persons:T.map(E=>{var ee,ae,re,Q,fe,Se,oe,pe,me;let H="",V="";if(E.name){const ne=E.name.split(" ");H=ne[0]||"",V=ne.slice(1).join(" ")||""}const R=D.get(E.id.toString())||[],q=O.get(E.id.toString())||[],F=L.get(E.id.toString())||[];let G="male";return E.gender==="female"&&(G="female"),{id:E.id.toString(),firstName:E.firstName||H||E.name||"",lastName:E.lastName||V||"",gender:G,birthDate:((ee=E.birth)==null?void 0:ee.date)||E.birthDate||"",birthPlace:((re=(ae=E.birth)==null?void 0:ae.place)==null?void 0:re.city)||E.birthPlace||"",isAlive:!E.isDeceased,photo:((Q=E.primaryPhoto)==null?void 0:Q.url)||E.photo||E.photoUrl||"/api/placeholder/100/100",generation:((fe=E.position)==null?void 0:fe.generation)||0,latitude:E.Latitude??E.latitude??((Se=E.position)==null?void 0:Se.x)??0,longitude:E.Longitude??E.longitude??((oe=E.position)==null?void 0:oe.y)??0,position:{x:E.Latitude??E.latitude??((pe=E.position)==null?void 0:pe.x)??0,y:E.Longitude??E.longitude??((me=E.position)==null?void 0:me.y)??0},parentIds:R.map(ne=>ne.toString()),spouseIds:q.map(ne=>ne.toString()),childrenIds:F.map(ne=>ne.toString())}}),createdAt:(B==null?void 0:B.createdAt)||new Date().toISOString(),updatedAt:(B==null?void 0:B.updatedAt)||new Date().toISOString()};r(W)}catch(T){o(((_=T.response)==null?void 0:_.status)===404?A?"  ":"Tree not found":A?"   ":"Failed to load tree")}finally{i(!1)}})()},[e,A]);const M=()=>{document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()};return s?a.jsx("div",{className:"fixed inset-0 bg-background flex items-center justify-center z-50",children:a.jsxs("div",{className:"text-center",children:[a.jsx(wr,{className:`text-muted-foreground mx-auto mb-4 animate-spin ${P?"h-8 w-8":"h-12 w-12"}`}),a.jsx("p",{className:`text-muted-foreground ${P?"text-sm":""}`,children:A?"  ...":"Loading tree..."})]})}):l?a.jsx("div",{className:"fixed inset-0 bg-background flex items-center justify-center z-50",children:a.jsxs("div",{className:`text-center p-4 ${P?"p-2":""}`,children:[a.jsx(ii,{className:`text-destructive mx-auto mb-4 ${P?"h-8 w-8":"h-12 w-12"}`}),a.jsx("h2",{className:`font-semibold mb-2 ${P?"text-lg":"text-xl"}`,children:A?"":"Error"}),a.jsx("p",{className:`text-muted-foreground mb-4 ${P?"text-sm":""}`,children:l}),a.jsx(ge,{onClick:()=>window.history.back(),size:P?"sm":"default",children:A?"":"Go Back"})]})}):n?d?a.jsx("div",{className:"fixed inset-0 bg-background flex items-center justify-center z-50",children:a.jsxs("div",{className:`text-center mx-auto ${P?"p-4 max-w-sm":"p-6 max-w-md"}`,children:[a.jsx(Qn,{className:`text-primary mx-auto mb-6 ${P?"h-12 w-12":"h-16 w-16"}`}),a.jsx("h1",{className:`font-bold mb-4 ${P?"text-xl":"text-2xl"}`,children:A?"  ":"View Family Tree"}),a.jsx("p",{className:`text-muted-foreground mb-6 ${P?"text-sm":""}`,children:A?"          ":"Click the button below to start viewing the family tree in fullscreen mode"}),a.jsxs("div",{className:`space-y-4 ${P?"space-y-3":""}`,children:[a.jsx(ge,{onClick:U,size:P?"default":"lg",className:"w-full",children:A?" ":"Start Viewing"}),a.jsx(ge,{variant:"outline",onClick:()=>window.history.back(),size:P?"default":"lg",className:"w-full",children:A?"":"Go Back"})]})]})}):a.jsxs("div",{ref:N,className:"fixed inset-0 bg-background z-50",children:[a.jsxs("div",{className:"absolute top-4 left-4 right-4 z-10 flex items-center justify-between",children:[a.jsxs("div",{className:`bg-background/80 backdrop-blur-sm rounded-lg px-4 py-2 ${P?"px-3 py-1.5":""}`,children:[a.jsx("h1",{className:`font-semibold ${P?"text-base":"text-lg"}`,children:A?n.name:n.nameEn}),a.jsxs("p",{className:`text-muted-foreground ${P?"text-xs":"text-sm"}`,children:[n.persons.length," ",A?n.persons.length===1?"":"":n.persons.length===1?"member":"members"]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"hidden"}),a.jsx(ge,{variant:"outline",size:"sm",onClick:c?M:U,className:`bg-background/80 backdrop-blur-sm ${P?"h-8 px-2 text-xs":""}`,children:c?a.jsxs(a.Fragment,{children:[a.jsx(uj,{className:`h-4 w-4 ${P?"h-3 w-3 mr-1":"mr-2"}`}),a.jsx("span",{className:P?"hidden":"",children:A?"   ":"Exit Fullscreen"})]}):a.jsxs(a.Fragment,{children:[a.jsx(Qn,{className:`h-4 w-4 ${P?"h-3 w-3 mr-1":"mr-2"}`}),a.jsx("span",{className:P?"hidden":"",children:A?" ":"Fullscreen"})]})})]})]}),a.jsx("div",{className:"w-full h-full pt-20",children:a.jsx(Qe,{className:"w-full h-full border-0 rounded-none",children:a.jsx("div",{className:"w-full h-full shared-tree-container",style:{width:"100%",height:"100%",minHeight:"calc(100vh - 100px)"},children:m&&a.jsx("div",{className:"w-full h-full",style:{width:"100%",height:"100%"},children:a.jsx(M7,{triggerFitView:p,persons:n.persons,relationships:w,rootPersonId:n.rootPersonId,onSelectPerson:()=>{},onEditPerson:()=>{},onDeletePerson:()=>{},onAddChild:()=>{},onAddSpouse:()=>{},onAddFather:()=>{},onAddMother:()=>{},isOwnedTree:!1,isInteractivityLocked:x})})})})})]}):a.jsx("div",{className:"fixed inset-0 bg-background flex items-center justify-center z-50",children:a.jsxs("div",{className:`text-center p-4 ${P?"p-2":""}`,children:[a.jsx(Qn,{className:`text-muted-foreground mx-auto mb-4 ${P?"h-8 w-8":"h-12 w-12"}`}),a.jsx("p",{className:`text-muted-foreground ${P?"text-sm":""}`,children:A?"    ":"Tree not found"})]})})},gee=()=>{var A,P,U,M,S,C,_,T,B,$,D;const{id:e}=Gu(),{language:t}=Xt(),{user:n}=Pr(),{trees:r,currentTree:s}=xs(),{isMobile:i}=Tr(),l=Ir(),[o,c]=Y.useState(null),[u,d]=Y.useState([]),[f,m]=Y.useState(!0),[h,x]=Y.useState(null),[y,p]=Y.useState(!1),g=t==="ar",w=(()=>{if(!n||!o)return!1;const L=o.treeId||o.familyTreeId;if(!L)return!1;const O=r.find(W=>W.id===L)||s;return O?O.ownerId===n.id||O.userRole==="owner":!1})();Y.useEffect(()=>{(async()=>{var W,E,H,V,R,q,F,G,ee,ae,re,Q,fe,Se,oe,pe,me,ne,it,$e,Oe,qe,gt,ut,Rt,Nt,ye,ze,Ze;if(!e){x(t==="ar"?"   ":"Person ID not found"),m(!1);return}const O=parseInt(e);if(isNaN(O)||O<=0){x(t==="ar"?"   : "+e:"Invalid person ID: "+e),m(!1);return}try{m(!0),x(null);let xe;try{const Ne=await Pt.getPersonById(O);if(Ne)Ne.hasOwnProperty("data")?xe=Ne.data:xe=Ne;else throw new Error("Empty response from API")}catch(Ne){throw Ne}if(!xe)throw new Error("No person data received");const pt={id:(xe.id||O).toString(),firstName:((W=xe.arabicName)==null?void 0:W.firstName)||xe.firstName||xe.name||"",firstNameEn:xe.firstName||xe.name||"",lastName:((E=xe.arabicName)==null?void 0:E.lastName)||xe.lastName||"",lastNameEn:xe.lastName||"",gender:(()=>{const Ne=xe.gender;return Ne==="male"||Ne==="Male"||Ne===1||Ne==="1"||Ne==="M"||Ne==="m"?"male":Ne==="female"||Ne==="Female"||Ne===2||Ne==="2"||Ne==="F"||Ne==="f"?"female":"unknown"})(),birthDate:xe.birthDate||((H=xe.birth)==null?void 0:H.date)||void 0,deathDate:xe.deathDate||((V=xe.death)==null?void 0:V.date)||void 0,birthPlace:xe.birthPlace||((q=(R=xe.birth)==null?void 0:R.place)==null?void 0:q.city)||void 0,birthPlaceEn:xe.birthPlace||((G=(F=xe.birth)==null?void 0:F.place)==null?void 0:G.city)||void 0,deathPlace:xe.deathPlace||((ae=(ee=xe.death)==null?void 0:ee.place)==null?void 0:ae.city)||void 0,deathPlaceEn:xe.deathPlace||((Q=(re=xe.death)==null?void 0:re.place)==null?void 0:Q.city)||void 0,isAlive:!xe.isDeceased,generation:(()=>{var Ne,de;return typeof xe.generation=="number"&&xe.generation>=0?xe.generation:((Ne=xe.position)==null?void 0:Ne.generation)!==void 0&&xe.position.generation>=0?xe.position.generation:((de=xe.position)==null?void 0:de.level)!==void 0&&xe.position.level>=0?xe.position.level:xe.level!==void 0&&xe.level>=0?xe.level:1})(),photo:xe.photoUrl||((fe=xe.primaryPhoto)==null?void 0:fe.url)||((oe=(Se=xe.photos)==null?void 0:Se[0])==null?void 0:oe.url)||void 0,email:xe.email||((pe=xe.contact)==null?void 0:pe.email)||"",phone:xe.phone||((me=xe.contact)==null?void 0:me.phone)||"",occupation:Array.isArray(xe.occupation)&&xe.occupation.length>0?xe.occupation[0].title:xe.occupation||"",occupationEn:Array.isArray(xe.occupation)&&xe.occupation.length>0?xe.occupation[0].title:xe.occupation||"",education:xe.education||"",educationEn:xe.education||"",biography:xe.biography||xe.notes||"",biographyEn:xe.biography||xe.notes||"",treeId:((ne=xe.familyTreeId)==null?void 0:ne.toString())||((it=xe.treeId)==null?void 0:it.toString())||xe.tree||"",familyTreeId:(($e=xe.familyTreeId)==null?void 0:$e.toString())||((Oe=xe.treeId)==null?void 0:Oe.toString())||xe.tree||"",createdAt:xe.createdAt||new Date().toISOString(),updatedAt:xe.updatedAt||new Date().toISOString(),relationships:xe.relationships||{},middleName:xe.middleName||"",nickname:xe.nickname||"",fullName:xe.fullName||"",displayName:xe.displayName||"",arabicName:xe.arabicName||{},fullArabicName:xe.fullArabicName||"",age:xe.age||void 0,physical:xe.physical||{},contact:xe.contact||{},photos:xe.photos||[],documents:xe.documents||[],primaryPhoto:xe.primaryPhoto||{},notes:xe.notes||"",military:xe.military||{},religion:xe.religion||"",tags:xe.tags||[],position:xe.position||{},createdBy:xe.createdBy||"",status:xe.status||"active"};c(pt);try{const Ne=xe.familyTreeId||xe.treeId||xe.tree;if(Ne){const de=await Pt.getPersonsInTree(Ne),se=xe.relationships||{},he=[];if(se.father){const ke=typeof se.father=="string"?se.father:se.father.id||se.father._id;if(ke){const be=de.find(Le=>Le.id==ke);be&&he.push({id:((qe=be.id)==null?void 0:qe.toString())||"",firstName:be.firstName||"",firstNameEn:be.firstName||"",lastName:be.lastName||"",lastNameEn:be.lastName||"",relationship:t==="ar"?"":"Father",relationshipEn:"Father",photo:((gt=be.primaryPhoto)==null?void 0:gt.url)||((Rt=(ut=be.photos)==null?void 0:ut[0])==null?void 0:Rt.url)||void 0})}}if(se.mother){const ke=typeof se.mother=="string"?se.mother:se.mother.id||se.mother._id;if(ke){const be=de.find(Le=>Le.id==ke);be&&he.push({id:((Nt=be.id)==null?void 0:Nt.toString())||"",firstName:be.firstName||"",firstNameEn:be.firstName||"",lastName:be.lastName||"",lastNameEn:be.lastName||"",relationship:t==="ar"?"":"Mother",relationshipEn:"Mother",photo:((ye=be.primaryPhoto)==null?void 0:ye.url)||((Ze=(ze=be.photos)==null?void 0:ze[0])==null?void 0:Ze.url)||void 0})}}se.spouses&&Array.isArray(se.spouses)&&se.spouses.forEach(ke=>{var Le,He,Ue,De,_e,Ie;const be=typeof ke=="string"?ke:(typeof ke.person=="string"?ke.person:((Le=ke.person)==null?void 0:Le.id)||((He=ke.person)==null?void 0:He._id))||ke.id||ke._id;if(be){const ht=de.find(wt=>wt.id==be);ht&&he.push({id:((Ue=ht.id)==null?void 0:Ue.toString())||"",firstName:ht.firstName||"",firstNameEn:ht.firstName||"",lastName:ht.lastName||"",lastNameEn:ht.lastName||"",relationship:t==="ar"?"":"Spouse",relationshipEn:"Spouse",photo:((De=ht.primaryPhoto)==null?void 0:De.url)||((Ie=(_e=ht.photos)==null?void 0:_e[0])==null?void 0:Ie.url)||void 0})}}),se.children&&Array.isArray(se.children)&&se.children.forEach(ke=>{var Le,He,Ue,De;const be=typeof ke=="string"?ke:ke.id||ke._id;if(be){const _e=de.find(Ie=>Ie.id==be);_e&&he.push({id:((Le=_e.id)==null?void 0:Le.toString())||"",firstName:_e.firstName||"",firstNameEn:_e.firstName||"",lastName:_e.lastName||"",lastNameEn:_e.lastName||"",relationship:t==="ar"?"":"Child",relationshipEn:"Child",photo:((He=_e.primaryPhoto)==null?void 0:He.url)||((De=(Ue=_e.photos)==null?void 0:Ue[0])==null?void 0:De.url)||void 0})}}),se.siblings&&Array.isArray(se.siblings)&&se.siblings.forEach(ke=>{var Le,He,Ue,De;const be=typeof ke=="string"?ke:ke.id||ke._id;if(be){const _e=de.find(Ie=>Ie.id==be);_e&&he.push({id:((Le=_e.id)==null?void 0:Le.toString())||"",firstName:_e.firstName||"",firstNameEn:_e.firstName||"",lastName:_e.lastName||"",lastNameEn:_e.lastName||"",relationship:t==="ar"?"":"Sibling",relationshipEn:"Sibling",photo:((He=_e.primaryPhoto)==null?void 0:He.url)||((De=(Ue=_e.photos)==null?void 0:Ue[0])==null?void 0:De.url)||void 0})}}),xe.parentIds&&Array.isArray(xe.parentIds)&&xe.parentIds.forEach(ke=>{var be,Le,He,Ue;if(!he.some(De=>De.id===ke)){const De=de.find(_e=>_e.id==ke);if(De){const _e=De.gender==="female"?t==="ar"?"":"Mother":t==="ar"?"":"Father",Ie=De.gender==="female"?"Mother":"Father";he.push({id:((be=De.id)==null?void 0:be.toString())||"",firstName:De.firstName||"",firstNameEn:De.firstName||"",lastName:De.lastName||"",lastNameEn:De.lastName||"",relationship:t==="ar"?_e:Ie,relationshipEn:Ie,photo:((Le=De.primaryPhoto)==null?void 0:Le.url)||((Ue=(He=De.photos)==null?void 0:He[0])==null?void 0:Ue.url)||void 0})}}}),xe.spouseIds&&Array.isArray(xe.spouseIds)&&xe.spouseIds.forEach(ke=>{var be,Le,He,Ue;if(!he.some(De=>De.id===ke)){const De=de.find(_e=>_e.id==ke);De&&he.push({id:((be=De.id)==null?void 0:be.toString())||"",firstName:De.firstName||"",firstNameEn:De.firstName||"",lastName:De.lastName||"",lastNameEn:De.lastName||"",relationship:t==="ar"?"":"Spouse",relationshipEn:"Spouse",photo:((Le=De.primaryPhoto)==null?void 0:Le.url)||((Ue=(He=De.photos)==null?void 0:He[0])==null?void 0:Ue.url)||void 0})}}),xe.childrenIds&&Array.isArray(xe.childrenIds)&&xe.childrenIds.forEach(ke=>{var be,Le,He,Ue;if(!he.some(De=>De.id===ke)){const De=de.find(_e=>_e.id==ke);De&&he.push({id:((be=De.id)==null?void 0:be.toString())||"",firstName:De.firstName||"",firstNameEn:De.firstName||"",lastName:De.lastName||"",lastNameEn:De.lastName||"",relationship:t==="ar"?"":"Child",relationshipEn:"Child",photo:((Le=De.primaryPhoto)==null?void 0:Le.url)||((Ue=(He=De.photos)==null?void 0:He[0])==null?void 0:Ue.url)||void 0})}}),he.length===0&&de.filter(be=>be.id&&parseInt(be.id.toString())!==O).slice(0,5).forEach(be=>{var Le;he.push({id:((Le=be.id)==null?void 0:Le.toString())||"",firstName:be.firstName||"",firstNameEn:be.firstName||"",lastName:be.lastName||"",lastNameEn:be.lastName||"",relationship:t==="ar"?"":"Related",relationshipEn:"Related"})}),d(he)}else d([{id:"2",firstName:"",firstNameEn:"Fatima",lastName:"",lastNameEn:"Ahmed",relationship:"",relationshipEn:"Daughter"},{id:"3",firstName:"",firstNameEn:"Mohammed",lastName:"",lastNameEn:"Ahmed",relationship:"",relationshipEn:"Son"}])}catch{d([{id:"2",firstName:"",firstNameEn:"Fatima",lastName:"",lastNameEn:"Ahmed",relationship:"",relationshipEn:"Daughter"},{id:"3",firstName:"",firstNameEn:"Mohammed",lastName:"",lastNameEn:"Ahmed",relationship:"",relationshipEn:"Son"}])}}catch{x(t==="ar"?"    ":"Failed to load person data")}finally{m(!1)}})()},[e,t]);const v=(L,O)=>{if(!L)return 0;let W;try{if(L.includes("T"))W=new Date(L);else if(L.includes("-")){const R=L.split("-");R.length===3?W=new Date(parseInt(R[0]),parseInt(R[1])-1,parseInt(R[2])):W=new Date(L)}else if(L.includes("/")){const R=L.split("/");R.length===3?W=new Date(parseInt(R[2]),parseInt(R[0])-1,parseInt(R[1])):W=new Date(L)}else W=new Date(L)}catch{return 0}if(isNaN(W.getTime()))return 0;let E;if(O&&O.trim()!=="")try{if(O.includes("T"))E=new Date(O);else if(O.includes("-")){const R=O.split("-");R.length===3?E=new Date(parseInt(R[0]),parseInt(R[1])-1,parseInt(R[2])):E=new Date(O)}else if(O.includes("/")){const R=O.split("/");R.length===3?E=new Date(parseInt(R[2]),parseInt(R[0])-1,parseInt(R[1])):E=new Date(O)}else E=new Date(O);isNaN(E.getTime())&&(E=new Date)}catch{E=new Date}else E=new Date;let H=E.getFullYear()-W.getFullYear();const V=E.getMonth()-W.getMonth();return(V<0||V===0&&E.getDate()<W.getDate())&&H--,H>=0?H:0},N=L=>L===1?Nu:L===2?sn:na;return f?a.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:a.jsxs("div",{className:"text-center",children:[a.jsx(wr,{className:"h-12 w-12 animate-spin text-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:g?"   ...":"Loading person profile..."})]})}):h?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"mx-auto w-16 h-16 bg-destructive/10 rounded-full flex items-center justify-center mb-4",children:a.jsx(ii,{className:"h-8 w-8 text-destructive"})}),a.jsx("h2",{className:"text-2xl font-bold text-destructive mb-4",children:h}),a.jsxs("p",{className:"text-muted-foreground mb-4",children:[t==="ar"?"  : ":"Requested Person ID: ",a.jsx("code",{className:"bg-muted px-2 py-1 rounded",children:e})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 justify-center",children:[a.jsx(ge,{onClick:()=>l(-1),children:t==="ar"?"":"Go Back"}),a.jsx(ge,{variant:"outline",onClick:()=>window.location.reload(),children:t==="ar"?" ":"Try Again"})]})]}):o?(N(o.generation),a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{children:a.jsx(ge,{asChild:!0,variant:"ghost",size:i?"sm":"default",children:a.jsxs(It,{to:`/trees/${o==null?void 0:o.treeId}`,className:"flex items-center",children:[a.jsx(ho,{className:`h-4 w-4 ${i?"h-3 w-3":"mr-2"}`}),a.jsx("span",{className:i?"hidden":"",children:g?" ":"Back to Tree"})]})})}),a.jsx(Qe,{children:a.jsx(xt,{className:i?"p-4":"",children:a.jsxs("div",{className:`flex ${i?"flex-col gap-4":"flex-col sm:flex-row sm:items-start gap-6"}`,children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("div",{className:`rounded-full flex items-center justify-center ${(o==null?void 0:o.gender)==="male"?"bg-blue-100 text-blue-600":(o==null?void 0:o.gender)==="female"?"bg-pink-100 text-pink-600":"bg-muted text-muted-foreground"} ${i?"w-24 h-24":"w-32 h-32"}`,children:o!=null&&o.photo?a.jsx("img",{src:o.photo,alt:g?o.firstName:o.firstNameEn,className:"w-full h-full rounded-full object-cover"}):a.jsx(sn,{className:`text-muted-foreground ${i?"h-12 w-12":"h-16 w-16"}`})})}),a.jsx("div",{className:"flex-1",children:a.jsxs("div",{className:`flex ${i?"flex-col gap-3":"flex-col sm:flex-row sm:items-start sm:justify-between gap-4"}`,children:[a.jsxs("div",{children:[a.jsx("h1",{className:`font-bold text-foreground ${i?"text-xl mb-1":"text-3xl mb-2"}`,children:g?`${o==null?void 0:o.firstName} ${o==null?void 0:o.lastName}`:`${o==null?void 0:o.firstNameEn} ${o==null?void 0:o.lastNameEn}`}),a.jsxs("div",{className:`flex flex-wrap items-center gap-2 ${i?"text-xs":"text-sm"} text-muted-foreground mb-3`,children:[(o==null?void 0:o.birthDate)&&a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Ur,{className:`h-3 w-3 ${i?"h-2.5 w-2.5":"h-4 w-4"}`}),a.jsxs("span",{children:[v(o.birthDate,o.deathDate)," ",g?"":"years old",!o.isAlive&&` (${g?"":"Deceased"})`]})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Qn,{className:`h-3 w-3 ${i?"h-2.5 w-2.5":"h-4 w-4"}`}),a.jsx("span",{children:g?` ${(o==null?void 0:o.generation)||1}`:`Generation ${(o==null?void 0:o.generation)||1}`})]}),(o==null?void 0:o.gender)!=="unknown"&&a.jsx(er,{variant:(o==null?void 0:o.gender)==="male"?"secondary":"outline",className:i?"text-xs px-1.5 py-0.5":"",children:(o==null?void 0:o.gender)==="male"?g?"":"Male":g?"":"Female"}),!(o!=null&&o.isAlive)&&a.jsx(er,{variant:"outline",className:i?"text-xs px-1.5 py-0.5":"",children:g?"":"Deceased"})]}),a.jsxs("div",{className:`space-y-1 ${i?"text-xs":"text-sm"}`,children:[(o==null?void 0:o.birthDate)&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ur,{className:`h-3 w-3 ${i?"h-2.5 w-2.5":"h-4 w-4"} text-green-600`}),a.jsx("span",{className:"font-medium",children:g?" :":"Born:"}),a.jsx("span",{children:new Date(o.birthDate).toLocaleDateString(g?"ar-SA":"en-US")}),o.birthPlace&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"text-muted-foreground",children:g?"":"in"}),a.jsx("span",{children:g?o.birthPlace:o.birthPlaceEn})]})]}),(o==null?void 0:o.deathDate)&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ur,{className:`h-3 w-3 ${i?"h-2.5 w-2.5":"h-4 w-4"} text-red-600`}),a.jsx("span",{className:"font-medium",children:g?" :":"Died:"}),a.jsx("span",{children:new Date(o.deathDate).toLocaleDateString(g?"ar-SA":"en-US")}),o.deathPlace&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"text-muted-foreground",children:g?"":"in"}),a.jsx("span",{children:g?o.deathPlace:o.deathPlaceEn})]})]})]})]}),a.jsx("div",{className:`flex ${i?"gap-1":"gap-2"}`,children:w&&a.jsxs(ge,{size:"sm",variant:"outline",onClick:()=>p(!0),children:[a.jsx(sa,{className:`h-4 w-4 ${i?"h-33 w-3":"mr-2"}`}),a.jsx("span",{className:i?"hidden":"",children:g?"":"Edit"})]})})]})})]})})}),a.jsxs("div",{className:`grid ${i?"grid-cols-1 gap-4":"grid-cols-1 lg:grid-cols-3 gap-6"}`,children:[a.jsxs("div",{className:`space-y-4 ${i?"lg:col-span-1":"lg:col-span-2"} space-y-4`,children:[a.jsxs(Qe,{children:[a.jsx(xt,{className:i?"p-4":"",children:a.jsxs(yt,{className:"flex items-center gap-2",children:[a.jsx(sn,{className:`h-4 w-4 ${i?"h-3.5 w-3.5":"h-5 w-5"}`}),g?" ":"Person Summary"]})}),a.jsx(tt,{className:`space-y-3 ${i?"p-4":""}`,children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[a.jsxs("div",{className:`flex justify-between items-center p-2 rounded-lg ${i?"p-2":"p-3"} bg-muted/50`,children:[a.jsx("span",{className:`font-medium ${i?"text-xs":"text-sm"}`,children:g?":":"Name:"}),a.jsx("span",{className:`text-foreground truncate max-w-[60%] text-right ${i?"text-xs":"text-sm"}`,children:g?`${o==null?void 0:o.firstName} ${o==null?void 0:o.lastName}`:`${o==null?void 0:o.firstNameEn} ${o==null?void 0:o.lastNameEn}`})]}),(o==null?void 0:o.birthDate)&&a.jsxs("div",{className:`flex justify-between items-center p-2 rounded-lg ${i?"p-2":"p-3"} bg-muted/50`,children:[a.jsx("span",{className:`font-medium ${i?"text-xs":"text-sm"}`,children:g?" :":"Date of Birth:"}),a.jsx("span",{className:`text-foreground ${i?"text-xs":"text-sm"}`,children:new Date(o.birthDate).toLocaleDateString(g?"ar-SA":"en-US")})]}),a.jsxs("div",{className:`flex justify-between items-center p-2 rounded-lg ${i?"p-2":"p-3"} bg-muted/50`,children:[a.jsx("span",{className:`font-medium ${i?"text-xs":"text-sm"}`,children:g?":":"Status:"}),a.jsx(er,{variant:o!=null&&o.isAlive?"default":"destructive",className:`font-normal ${i?"text-xs px-1.5 py-0.5":"text-xs"}`,children:o!=null&&o.isAlive?g?"  ":"Alive":g?"":"Deceased"})]}),(o==null?void 0:o.occupation)&&a.jsxs("div",{className:`flex justify-between items-center p-2 rounded-lg ${i?"p-2":"p-3"} bg-muted/50`,children:[a.jsx("span",{className:`font-medium ${i?"text-xs":"text-sm"}`,children:g?":":"Occupation:"}),a.jsx("span",{className:`text-foreground truncate max-w-[60%] text-right ${i?"text-xs":"text-sm"}`,children:g?o.occupation:o.occupationEn})]}),(o==null?void 0:o.birthPlace)&&a.jsxs("div",{className:`flex justify-between items-center p-2 rounded-lg ${i?"p-2":"p-3"} bg-muted/50`,children:[a.jsx("span",{className:`font-medium ${i?"text-xs":"text-sm"}`,children:g?" :":"Place of Birth:"}),a.jsx("span",{className:`text-foreground truncate max-w-[60%] text-right ${i?"text-xs":"text-sm"}`,children:g?o.birthPlace:o.birthPlaceEn})]}),a.jsxs("div",{className:`flex justify-between items-center p-2 rounded-lg ${i?"p-2":"p-3"} bg-muted/50`,children:[a.jsx("span",{className:`font-medium ${i?"text-xs":"text-sm"}`,children:g?":":"Generation:"}),a.jsx("span",{className:`text-foreground ${i?"text-xs":"text-sm"}`,children:g?` ${(o==null?void 0:o.generation)||1}`:`Generation ${(o==null?void 0:o.generation)||1}`})]}),(o==null?void 0:o.gender)!=="unknown"&&a.jsxs("div",{className:`flex justify-between items-center p-2 rounded-lg ${i?"p-2":"p-3"} bg-muted/50`,children:[a.jsx("span",{className:`font-medium ${i?"text-xs":"text-sm"}`,children:g?":":"Gender:"}),a.jsx(er,{variant:(o==null?void 0:o.gender)==="male"?"secondary":"outline",className:i?"text-xs px-1.5 py-0.5":"",children:(o==null?void 0:o.gender)==="male"?g?"":"Male":g?"":"Female"})]}),(o==null?void 0:o.birthDate)&&a.jsxs("div",{className:`flex justify-between items-center p-2 rounded-lg ${i?"p-2":"p-3"} bg-muted/50`,children:[a.jsx("span",{className:`font-medium ${i?"text-xs":"text-sm"}`,children:g?":":"Age:"}),a.jsxs("span",{className:`text-foreground ${i?"text-xs":"text-sm"}`,children:[v(o.birthDate,o.deathDate)," ",g?"":"years"]})]}),(o==null?void 0:o.status)&&a.jsxs("div",{className:`flex justify-between items-center p-2 rounded-lg ${i?"p-2":"p-3"} bg-muted/50`,children:[a.jsx("span",{className:`font-medium ${i?"text-xs":"text-sm"}`,children:g?":":"Status:"}),a.jsx("span",{className:`text-foreground ${i?"text-xs":"text-sm"}`,children:o.status})]})]})})]}),((o==null?void 0:o.email)||(o==null?void 0:o.phone)||((A=o==null?void 0:o.contact)==null?void 0:A.email)||((P=o==null?void 0:o.contact)==null?void 0:P.phone)||((U=o==null?void 0:o.contact)==null?void 0:U.address))&&a.jsxs(Qe,{children:[a.jsx(xt,{className:i?"p-4":"",children:a.jsxs(yt,{className:"flex items-center gap-2",children:[a.jsx(Su,{className:`h-4 w-4 ${i?"h-3.5 w-3.5":"h-5 w-5"}`}),g?" ":"Contact Information"]})}),a.jsxs(tt,{className:`space-y-2 ${i?"p-4":"space-y-3"}`,children:[((o==null?void 0:o.email)||((M=o==null?void 0:o.contact)==null?void 0:M.email))&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Pa,{className:`h-3.5 w-3.5 ${i?"h-3 w-3":"h-4 w-4"} text-muted-foreground`}),a.jsx("span",{className:`font-medium ${i?"text-xs":"text-sm"}`,children:g?" :":"Email:"}),a.jsx("a",{href:`mailto:${o.email||((S=o.contact)==null?void 0:S.email)}`,className:`text-primary hover:underline ${i?"text-xs":"text-sm"}`,children:o.email||((C=o.contact)==null?void 0:C.email)})]}),((o==null?void 0:o.phone)||((_=o==null?void 0:o.contact)==null?void 0:_.phone))&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Su,{className:`h-3.5 w-3.5 ${i?"h-3 w-3":"h-4 w-4"} text-muted-foreground`}),a.jsx("span",{className:`font-medium ${i?"text-xs":"text-sm"}`,children:g?":":"Phone:"}),a.jsx("a",{href:`tel:${o.phone||((T=o.contact)==null?void 0:T.phone)}`,className:`text-primary hover:underline ${i?"text-xs":"text-sm"}`,children:o.phone||((B=o.contact)==null?void 0:B.phone)})]}),(($=o==null?void 0:o.contact)==null?void 0:$.address)&&a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(b0,{className:`h-3.5 w-3.5 ${i?"h-3 w-3":"h-4 w-4"} text-muted-foreground mt-0.5`}),a.jsxs("div",{children:[a.jsx("span",{className:`font-medium ${i?"text-xs":"text-sm"}`,children:g?":":"Address:"}),a.jsxs("div",{className:`text-muted-foreground ${i?"text-xs":"text-sm"}`,children:[o.contact.address.street&&a.jsx("div",{children:o.contact.address.street}),(o.contact.address.city||o.contact.address.state||o.contact.address.country)&&a.jsx("div",{children:[o.contact.address.city,o.contact.address.state,o.contact.address.country].filter(Boolean).join(", ")}),o.contact.address.postalCode&&a.jsx("div",{children:o.contact.address.postalCode})]})]})]}),((D=o==null?void 0:o.contact)==null?void 0:D.socialMedia)&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(mo,{className:`h-3.5 w-3.5 ${i?"h-3 w-3":"h-4 w-4"} text-muted-foreground`}),a.jsx("span",{className:`font-medium ${i?"text-xs":"text-sm"}`,children:g?"  :":"Social Media:"}),a.jsxs("div",{className:"flex gap-2",children:[o.contact.socialMedia.facebook&&a.jsx("a",{href:o.contact.socialMedia.facebook,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline text-xs",children:"Facebook"}),o.contact.socialMedia.twitter&&a.jsx("a",{href:o.contact.socialMedia.twitter,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline text-xs",children:"Twitter"}),o.contact.socialMedia.linkedin&&a.jsx("a",{href:o.contact.socialMedia.linkedin,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline text-xs",children:"LinkedIn"}),o.contact.socialMedia.instagram&&a.jsx("a",{href:o.contact.socialMedia.instagram,target:"_blank",rel:"noopener noreferrer",className:"text-primary hover:underline text-xs",children:"Instagram"})]})]})]})]}),(o==null?void 0:o.physical)&&(o.physical.height||o.physical.weight||o.physical.eyeColor||o.physical.hairColor)&&a.jsxs(Qe,{children:[a.jsx(xt,{className:i?"p-4":"",children:a.jsxs(yt,{className:"flex items-center gap-2",children:[a.jsx(sn,{className:`h-4 w-4 ${i?"h-3.5 w-3.5":"h-5 w-5"}`}),g?" ":"Physical Information"]})}),a.jsxs(tt,{className:`space-y-2 ${i?"p-4":"space-y-3"}`,children:[o.physical.height&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:`font-medium ${i?"text-xs":"text-sm"}`,children:g?":":"Height:"}),a.jsx("span",{className:i?"text-xs":"text-sm",children:o.physical.height})]}),o.physical.weight&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:`font-medium ${i?"text-xs":"text-sm"}`,children:g?":":"Weight:"}),a.jsx("span",{className:i?"text-xs":"text-sm",children:o.physical.weight})]}),o.physical.eyeColor&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:`font-medium ${i?"text-xs":"text-sm"}`,children:g?" :":"Eye Color:"}),a.jsx("span",{className:i?"text-xs":"text-sm",children:o.physical.eyeColor})]}),o.physical.hairColor&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:`font-medium ${i?"text-xs":"text-sm"}`,children:g?" :":"Hair Color:"}),a.jsx("span",{className:i?"text-xs":"text-sm",children:o.physical.hairColor})]})]})]}),((o==null?void 0:o.biography)||(o==null?void 0:o.notes))&&a.jsxs(Qe,{children:[a.jsx(xt,{className:i?"p-4":"",children:a.jsxs(yt,{className:"flex items-center gap-2",children:[a.jsx(du,{className:`h-4 w-4 ${i?"h-3.5 w-3.5":"h-5 w-5"}`}),g?" ":"Biography"]})}),a.jsx(tt,{className:i?"p-4":"",children:a.jsx("p",{className:`text-foreground leading-relaxed whitespace-pre-wrap ${i?"text-sm":""}`,children:g?o.biography||o.notes:o.biographyEn||o.notes})})]}),(o==null?void 0:o.religion)&&a.jsxs(Qe,{children:[a.jsx(xt,{className:i?"p-4":"",children:a.jsxs(yt,{className:"flex items-center gap-2",children:[a.jsx(Or,{className:`h-4 w-4 ${i?"h-3.5 w-3.5":"h-5 w-5"}`}),g?"":"Religion"]})}),a.jsx(tt,{className:i?"p-4":"",children:a.jsx("p",{className:`text-foreground ${i?"text-sm":""}`,children:o.religion})})]}),(o==null?void 0:o.photos)&&o.photos.length>0&&a.jsxs(Qe,{children:[a.jsx(xt,{className:i?"p-4":"",children:a.jsxs(yt,{className:"flex items-center gap-2",children:[a.jsx(dh,{className:`h-4 w-4 ${i?"h-3.5 w-3.5":"h-5 w-5"}`}),g?"":"Photos",a.jsx(er,{variant:"secondary",className:i?"text-xs px-1.5 py-0.5":"",children:o.photos.length})]})}),a.jsx(tt,{className:i?"p-4":"",children:a.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[o.photos.slice(0,6).map(L=>a.jsx("div",{className:"aspect-square rounded-lg overflow-hidden",children:a.jsx("img",{src:L.url||L.thumbnailUrl,alt:L.caption||g?"":"Photo",className:"w-full h-full object-cover"})},L.id)),o.photos.length>6&&a.jsx("div",{className:"aspect-square rounded-lg bg-muted flex items-center justify-center",children:a.jsxs("span",{className:"text-xs text-muted-foreground",children:["+",o.photos.length-6]})})]})})]}),(o==null?void 0:o.documents)&&o.documents.length>0&&a.jsxs(Qe,{children:[a.jsx(xt,{className:i?"p-4":"",children:a.jsxs(yt,{className:"flex items-center gap-2",children:[a.jsx(du,{className:`h-4 w-4 ${i?"h-3.5 w-3.5":"h-5 w-5"}`}),g?"":"Documents",a.jsx(er,{variant:"secondary",className:i?"text-xs px-1.5 py-0.5":"",children:o.documents.length})]})}),a.jsx(tt,{className:i?"p-4":"",children:a.jsxs("div",{className:`space-y-2 ${i?"space-y-2":"space-y-3"}`,children:[o.documents.slice(0,5).map(L=>a.jsxs("div",{className:`flex items-center gap-2 p-2 rounded-lg hover:bg-muted/50 transition-colors ${i?"p-2":"p-3"}`,children:[a.jsx(du,{className:`h-4 w-4 ${i?"h-3.5 w-3.5":"h-5 w-5"} text-muted-foreground`}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:`font-medium text-foreground truncate ${i?"text-sm":""}`,children:L.name||L.caption}),a.jsx("p",{className:"text-muted-foreground text-xs",children:L.type||L.mimeType})]}),a.jsx(ge,{size:"sm",variant:"ghost",className:i?"h-6 w-6 p-0":"h-8 w-8 p-0",children:a.jsx("span",{className:`text-xs ${i?"text-xs":"text-sm"}`,children:g?"":"Download"})})]},L.id)),o.documents.length>5&&a.jsx("div",{className:`text-center text-muted-foreground ${i?"text-xs":"text-sm"}`,children:g?`${o.documents.length-5}  `:`And ${o.documents.length-5} more documents`})]})})]})]}),a.jsxs("div",{className:`space-y-4 ${i?"lg:col-span-1":""} space-y-4`,children:[a.jsxs(Qe,{children:[a.jsx(xt,{className:i?"p-4":"",children:a.jsxs(yt,{className:"flex items-center gap-2",children:[a.jsx(In,{className:`h-4 w-4 ${i?"h-3.5 w-3.5":"h-5 w-5"}`}),g?" ":"Family Members",a.jsx(er,{variant:"secondary",className:i?"text-xs px-1.5 py-0.5":"",children:u.length})]})}),a.jsx(tt,{className:i?"p-4":"",children:u.length>0?a.jsx("div",{className:`space-y-2 ${i?"space-y-2":"space-y-3"}`,children:u.map(L=>{var O,W,E,H;return a.jsxs("div",{className:`flex items-center gap-2 p-2 rounded-lg hover:bg-muted/50 transition-colors cursor-pointer ${i?"p-2":"p-3"}`,onClick:()=>l(`/persons/${L.id}`),children:[a.jsx("div",{className:`rounded-full flex items-center justify-center ${L.id===((W=(O=o==null?void 0:o.relationships)==null?void 0:O.father)==null?void 0:W.id)?"bg-blue-100 text-blue-600":L.id===((H=(E=o==null?void 0:o.relationships)==null?void 0:E.mother)==null?void 0:H.id)?"bg-pink-100 text-pink-600":"bg-muted text-muted-foreground"} ${i?"w-8 h-8":"w-10 h-10"}`,children:L.photo?a.jsx("img",{src:L.photo,alt:g?L.firstName:L.firstNameEn,className:"w-full h-full rounded-full object-cover"}):a.jsx(sn,{className:`h-4 w-4 ${i?"h-3 w-3":"h-5 w-5"}`})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:`font-medium text-foreground truncate ${i?"text-sm":""}`,children:g?`${L.firstName} ${L.lastName}`:`${L.firstNameEn} ${L.lastNameEn}`}),a.jsx("p",{className:"text-muted-foreground text-xs",children:g?L.relationship:L.relationshipEn})]}),a.jsx(ge,{size:"sm",variant:"ghost",className:i?"h-6 w-6 p-0":"h-8 w-8 p-0",onClick:V=>{V.stopPropagation(),l(`/persons/${L.id}`)},children:a.jsx(ho,{className:`h-3 w-3 ${i?"h-2.5 w-2.5":"h-4 w-4"}`})})]},L.id)})}):a.jsx("p",{className:`text-muted-foreground text-center py-4 ${i?"text-xs":"text-sm"}`,children:g?"   ":"No family relationships found"})})]}),a.jsxs(Qe,{children:[a.jsx(xt,{className:i?"p-4":"",children:a.jsxs(yt,{className:"flex items-center gap-2",children:[a.jsx(y0,{className:`h-4 w-4 ${i?"h-3.5 w-3.5":"h-5 w-5"}`}),g?" ":"Quick Info"]})}),a.jsx(tt,{className:i?"p-4":"",children:a.jsxs("div",{className:`space-y-2 ${i?"space-y-2":"space-y-3"}`,children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:`text-muted-foreground ${i?"text-xs":"text-sm"}`,children:g?" :":"Person ID:"}),a.jsx("span",{className:`font-mono ${i?"text-xs":"text-sm"}`,children:o==null?void 0:o.id})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:`text-muted-foreground ${i?"text-xs":"text-sm"}`,children:g?" :":"Created:"}),a.jsx("span",{className:`${i?"text-xs":"text-sm"}`,children:o!=null&&o.createdAt?new Date(o.createdAt).toLocaleDateString(g?"ar-SA":"en-US"):"-"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:`text-muted-foreground ${i?"text-xs":"text-sm"}`,children:g?" :":"Last Updated:"}),a.jsx("span",{className:`${i?"text-xs":"text-sm"}`,children:o!=null&&o.updatedAt?new Date(o.updatedAt).toLocaleDateString(g?"ar-SA":"en-US"):"-"})]}),(o==null?void 0:o.createdBy)&&a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:`text-muted-foreground ${i?"text-xs":"text-sm"}`,children:g?"  :":"Created By:"}),a.jsx("span",{className:`${i?"text-xs":"text-sm"}`,children:o.createdBy})]}),(o==null?void 0:o.status)&&a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:`text-muted-foreground ${i?"text-xs":"text-sm"}`,children:g?":":"Status:"}),a.jsx(er,{variant:o.status==="active"?"default":o.status==="archived"?"secondary":"destructive",className:i?"text-xs px-1.5 py-0.5":"text-xs",children:g?o.status==="active"?"":o.status==="archived"?"":"":o.status==="active"?"Active":o.status==="archived"?"Archived":"Deleted"})]})]})})]})]})]}),y&&o&&a.jsx(Qf,{isOpen:y,onClose:()=>p(!1),onSubmit:L=>{o&&c({...o,firstName:L.name.split(" ")[0]||L.name||o.firstName,lastName:L.name.split(" ").slice(1).join(" ")||o.lastName,firstNameEn:L.name.split(" ")[0]||L.name||o.firstNameEn,lastNameEn:L.name.split(" ").slice(1).join(" ")||o.lastNameEn,gender:L.gender||o.gender,birthDate:L.birthDate||o.birthDate,deathDate:L.deathDate||o.deathDate,birthPlace:L.birthPlace||o.birthPlace,birthPlaceEn:L.birthPlaceEn||o.birthPlaceEn,deathPlace:L.deathPlace||o.deathPlace,deathPlaceEn:L.deathPlaceEn||o.deathPlaceEn,isAlive:L.isAlive!==void 0?L.isAlive:o.isAlive,occupation:L.occupation||o.occupation,occupationEn:L.occupationEn||o.occupationEn}),p(!1),dn.success({en:"Person updated successfully",ar:"    "})},familyTreeId:o.treeId||o.familyTreeId||"",familyMembers:[],initialData:{id:o.id,name:`${o.firstName} ${o.lastName}`,gender:o.gender,birthDate:o.birthDate,deathDate:o.deathDate,birthPlace:o.birthPlace,birthPlaceEn:o.birthPlaceEn,occupation:o.occupation,occupationEn:o.occupationEn,isAlive:o.isAlive},mode:"edit"})]})):a.jsxs("div",{className:"text-center py-12",children:[a.jsx("h2",{className:"text-2xl font-bold text-muted-foreground mb-4",children:g?"  ":"Person not found"}),a.jsx(ge,{asChild:!0,children:a.jsx(It,{to:"/trees",className:"flex items-center",children:g?" ":"Back to Trees"})})]})},xee=()=>{var H,V,R,q,F,G,ee,ae;const{id:e}=Gu(),t=Ir(),{language:n}=Xt(),{user:r}=Pr(),{trees:s,currentTree:i,fetchTrees:l}=xs(),{isMobile:o}=Tr(),[c,u]=Y.useState("basic"),[d,f]=Y.useState(!1),[m,h]=Y.useState(!1);Y.useRef(null),Y.useRef(null),Y.useRef(null);const[x,y]=Y.useState(!0),[p,g]=Y.useState(null),w=n==="ar";Y.useEffect(()=>{const re=async()=>{try{await l()}catch{}};s.length===0&&re()},[l,s.length]);const[v,N]=Y.useState({id:"",firstName:"",middleName:"",lastName:"",nickname:"",fullName:"",displayName:"",gender:"unknown",birth:{date:"",place:{city:"",state:"",country:""}},death:{date:"",place:{city:"",state:"",country:""}},isDeceased:!1,physical:{height:"",weight:"",eyeColor:"",hairColor:"",complexion:"",distinguishingMarks:""},occupation:[],education:[],contact:{email:"",phone:"",address:{street:"",city:"",state:"",country:"",postalCode:""},socialMedia:{facebook:"",twitter:"",linkedin:"",instagram:""}},relationships:{father:"",mother:"",spouses:[],children:[],siblings:[]},photos:[],documents:[],notes:"",tags:[],tree:"",position:{generation:1,x:0,y:0},createdBy:"",createdAt:"",updatedAt:"",status:"active"}),[A,P]=Y.useState(v),[U,M]=Y.useState(null),[S,C]=Y.useState(""),[_,T]=Y.useState(""),[B,$]=Y.useState([]);Y.useEffect(()=>{(async()=>{var fe,Se,oe,pe,me,ne,it,$e,Oe,qe,gt,ut,Rt,Nt,ye,ze,Ze,xe,pt,Ne,de,se,he,ke,be,Le,He,Ue,De,_e,Ie,ht,wt,St,Vt,qn,En,Dn,lt,Fe,Dt,Gt,Ht,ot,_t,Et,ft,at,Te,Ee,et,kt,vt,At,Ct,Lt,Gn,Lr,nt,Qt,ct,Bt,an,en,mt,Ft,on,rn,Cn,bn,_n,mn,Bn,Hn,hr,Jr,ar,Rn,mr,Nr,Wn,vo,vc,wc,Nc,li,fl,hl,Hi,wo,jc,Sc,_c,No,fa,Wi,Ac;if(!e){g(n==="ar"?"  ":"Person ID is missing"),y(!1);return}const Q=parseInt(e);if(isNaN(Q)){g(n==="ar"?"   ":"Invalid person ID"),y(!1);return}try{y(!0),g(null);const Ge=await Pt.getPersonById(Q);if(!Ge)throw new Error("Received empty response from API");const Ke=(kc,...od)=>{for(const Ec of od)if(kc.hasOwnProperty(Ec))return kc[Ec]},tn={id:((fe=Ke(Ge,"id","Id"))==null?void 0:fe.toString())||"",firstName:Ke(Ge,"firstName","FirstName","name")||"",middleName:Ke(Ge,"middleName","MiddleName")||"",lastName:Ke(Ge,"lastName","LastName")||"",nickname:Ke(Ge,"nickname","Nickname")||"",fullName:Ke(Ge,"fullName","FullName")||`${Ke(Ge,"firstName","FirstName")||""} ${Ke(Ge,"lastName","LastName")||""}`,displayName:Ke(Ge,"displayName","DisplayName")||`${Ke(Ge,"firstName","FirstName")||""} ${Ke(Ge,"lastName","LastName")||""}`,gender:["male","female","unknown"].includes(Ke(Ge,"gender","Gender"))?Ke(Ge,"gender","Gender"):"unknown",birth:{date:((Se=Ke(Ge,"birth","Birth"))==null?void 0:Se.date)||((oe=Ke(Ge,"birth","Birth"))==null?void 0:oe.Date)||Ke(Ge,"birthDate")||"",place:{city:((me=(pe=Ke(Ge,"birth","Birth"))==null?void 0:pe.place)==null?void 0:me.city)||((it=(ne=Ke(Ge,"birth","Birth"))==null?void 0:ne.Place)==null?void 0:it.City)||Ke(Ge,"birthPlace")||"",state:((Oe=($e=Ke(Ge,"birth","Birth"))==null?void 0:$e.place)==null?void 0:Oe.state)||((gt=(qe=Ke(Ge,"birth","Birth"))==null?void 0:qe.Place)==null?void 0:gt.State)||"",country:((Rt=(ut=Ke(Ge,"birth","Birth"))==null?void 0:ut.place)==null?void 0:Rt.country)||((ye=(Nt=Ke(Ge,"birth","Birth"))==null?void 0:Nt.Place)==null?void 0:ye.Country)||""},description:((ze=Ke(Ge,"birth","Birth"))==null?void 0:ze.description)||((Ze=Ke(Ge,"birth","Birth"))==null?void 0:Ze.Description)||"",isEstimated:((xe=Ke(Ge,"birth","Birth"))==null?void 0:xe.isEstimated)||((pt=Ke(Ge,"birth","Birth"))==null?void 0:pt.IsEstimated)||!1},death:Ke(Ge,"death","Death")?{date:((Ne=Ke(Ge,"death","Death"))==null?void 0:Ne.date)||((de=Ke(Ge,"death","Death"))==null?void 0:de.Date)||Ke(Ge,"deathDate")||"",place:{city:((he=(se=Ke(Ge,"death","Death"))==null?void 0:se.place)==null?void 0:he.city)||((be=(ke=Ke(Ge,"death","Death"))==null?void 0:ke.Place)==null?void 0:be.City)||"",state:((He=(Le=Ke(Ge,"death","Death"))==null?void 0:Le.place)==null?void 0:He.state)||((De=(Ue=Ke(Ge,"death","Death"))==null?void 0:Ue.Place)==null?void 0:De.State)||"",country:((Ie=(_e=Ke(Ge,"death","Death"))==null?void 0:_e.place)==null?void 0:Ie.country)||((wt=(ht=Ke(Ge,"death","Death"))==null?void 0:ht.Place)==null?void 0:wt.Country)||""},description:((St=Ke(Ge,"death","Death"))==null?void 0:St.description)||((Vt=Ke(Ge,"death","Death"))==null?void 0:Vt.Description)||"",isEstimated:((qn=Ke(Ge,"death","Death"))==null?void 0:qn.isEstimated)||((En=Ke(Ge,"death","Death"))==null?void 0:En.IsEstimated)||!1}:void 0,isDeceased:!!Ke(Ge,"isDeceased","IsDeceased","isDead"),physical:{height:((Dn=Ke(Ge,"physical","Physical"))==null?void 0:Dn.height)||((lt=Ke(Ge,"physical","Physical"))==null?void 0:lt.Height)||"",weight:((Fe=Ke(Ge,"physical","Physical"))==null?void 0:Fe.weight)||((Dt=Ke(Ge,"physical","Physical"))==null?void 0:Dt.Weight)||"",eyeColor:((Gt=Ke(Ge,"physical","Physical"))==null?void 0:Gt.eyeColor)||((Ht=Ke(Ge,"physical","Physical"))==null?void 0:Ht.EyeColor)||"",hairColor:((ot=Ke(Ge,"physical","Physical"))==null?void 0:ot.hairColor)||((_t=Ke(Ge,"physical","Physical"))==null?void 0:_t.HairColor)||"",complexion:((Et=Ke(Ge,"physical","Physical"))==null?void 0:Et.complexion)||((ft=Ke(Ge,"physical","Physical"))==null?void 0:ft.Complexion)||"",distinguishingMarks:((at=Ke(Ge,"physical","Physical"))==null?void 0:at.distinguishingMarks)||((Te=Ke(Ge,"physical","Physical"))==null?void 0:Te.DistinguishingMarks)||""},occupation:Array.isArray(Ke(Ge,"occupation"))?Ke(Ge,"occupation"):Array.isArray(Ke(Ge,"Occupation"))?Ke(Ge,"Occupation"):Ke(Ge,"occupation")?[Ke(Ge,"occupation")]:Ke(Ge,"Occupation")?[Ke(Ge,"Occupation")]:[],education:Array.isArray(Ke(Ge,"education"))?Ke(Ge,"education"):Array.isArray(Ke(Ge,"Education"))?Ke(Ge,"Education"):Ke(Ge,"education")?[Ke(Ge,"education")]:Ke(Ge,"Education")?[Ke(Ge,"Education")]:[],contact:{email:((Ee=Ke(Ge,"contact","Contact"))==null?void 0:Ee.email)||((et=Ke(Ge,"contact","Contact"))==null?void 0:et.Email)||Ke(Ge,"email")||"",phone:((kt=Ke(Ge,"contact","Contact"))==null?void 0:kt.phone)||((vt=Ke(Ge,"contact","Contact"))==null?void 0:vt.Phone)||"",address:{street:((Ct=(At=Ke(Ge,"contact","Contact"))==null?void 0:At.address)==null?void 0:Ct.street)||((Gn=(Lt=Ke(Ge,"contact","Contact"))==null?void 0:Lt.Address)==null?void 0:Gn.Street)||"",city:((nt=(Lr=Ke(Ge,"contact","Contact"))==null?void 0:Lr.address)==null?void 0:nt.city)||((ct=(Qt=Ke(Ge,"contact","Contact"))==null?void 0:Qt.Address)==null?void 0:ct.City)||"",state:((an=(Bt=Ke(Ge,"contact","Contact"))==null?void 0:Bt.address)==null?void 0:an.state)||((mt=(en=Ke(Ge,"contact","Contact"))==null?void 0:en.Address)==null?void 0:mt.State)||"",country:((on=(Ft=Ke(Ge,"contact","Contact"))==null?void 0:Ft.address)==null?void 0:on.country)||((Cn=(rn=Ke(Ge,"contact","Contact"))==null?void 0:rn.Address)==null?void 0:Cn.Country)||"",postalCode:((_n=(bn=Ke(Ge,"contact","Contact"))==null?void 0:bn.address)==null?void 0:_n.postalCode)||((Bn=(mn=Ke(Ge,"contact","Contact"))==null?void 0:mn.Address)==null?void 0:Bn.PostalCode)||""},socialMedia:{facebook:((hr=(Hn=Ke(Ge,"contact","Contact"))==null?void 0:Hn.socialMedia)==null?void 0:hr.facebook)||((ar=(Jr=Ke(Ge,"contact","Contact"))==null?void 0:Jr.SocialMedia)==null?void 0:ar.Facebook)||"",twitter:((mr=(Rn=Ke(Ge,"contact","Contact"))==null?void 0:Rn.socialMedia)==null?void 0:mr.twitter)||((Wn=(Nr=Ke(Ge,"contact","Contact"))==null?void 0:Nr.SocialMedia)==null?void 0:Wn.Twitter)||"",linkedin:((vc=(vo=Ke(Ge,"contact","Contact"))==null?void 0:vo.socialMedia)==null?void 0:vc.linkedin)||((Nc=(wc=Ke(Ge,"contact","Contact"))==null?void 0:wc.SocialMedia)==null?void 0:Nc.Linkedin)||"",instagram:((fl=(li=Ke(Ge,"contact","Contact"))==null?void 0:li.socialMedia)==null?void 0:fl.instagram)||((Hi=(hl=Ke(Ge,"contact","Contact"))==null?void 0:hl.SocialMedia)==null?void 0:Hi.Instagram)||""}},relationships:Ke(Ge,"relationships","Relationships")||{father:"",mother:"",spouses:[],children:[],siblings:[]},photos:Ke(Ge,"photos","Photos")||[],documents:Ke(Ge,"documents","Documents")||[],notes:Ke(Ge,"notes","Notes")||"",tags:Ke(Ge,"tags","Tags")||[],tree:Ke(Ge,"tree","Tree","familyTreeId")||"",position:{generation:((wo=Ke(Ge,"position","Position"))==null?void 0:wo.generation)||((jc=Ke(Ge,"position","Position"))==null?void 0:jc.Generation)||1,x:((Sc=Ke(Ge,"position","Position"))==null?void 0:Sc.x)||((_c=Ke(Ge,"position","Position"))==null?void 0:_c.X)||0,y:((No=Ke(Ge,"position","Position"))==null?void 0:No.y)||((fa=Ke(Ge,"position","Position"))==null?void 0:fa.Y)||0,level:((Wi=Ke(Ge,"position","Position"))==null?void 0:Wi.level)||((Ac=Ke(Ge,"position","Position"))==null?void 0:Ac.Level)||0},createdBy:Ke(Ge,"createdBy","CreatedBy")||"",createdAt:Ke(Ge,"createdAt","CreatedAt")||new Date().toISOString(),updatedAt:Ke(Ge,"updatedAt","UpdatedAt")||new Date().toISOString(),status:Ke(Ge,"status","Status")||"active"};tn.relationships.father&&C(typeof tn.relationships.father=="string"?tn.relationships.father:tn.relationships.father.id),tn.relationships.mother&&T(typeof tn.relationships.mother=="string"?tn.relationships.mother:tn.relationships.mother.id),N(tn),P(tn)}catch(Ge){g(n==="ar"?"    ":"Failed to load person data: "+(Ge.message||"Unknown error"))}finally{y(!1)}})()},[e,n]),Y.useEffect(()=>{(async()=>{if(A.tree)try{const fe=(await Pt.getPersonsInTree(Number(A.tree))).filter(Se=>Se.id!==A.id);$(fe)}catch(Q){console.error("Failed to fetch persons for parent selection",Q)}})()},[A.tree,A.id]);const D=re=>{if(re)return s.find(Q=>Q.id===re)||s.find(Q=>Q.id.toString()===re)||s.find(Q=>parseInt(Q.id)===parseInt(re))||((i==null?void 0:i.id)===re?i:void 0)||((i==null?void 0:i.id.toString())===re?i:void 0)||(parseInt((i==null?void 0:i.id)||"0")===parseInt(re)?i:void 0)};(()=>{if(x||!r||!e||!v.tree||s.length===0)return!0;const re=v.tree.toString(),Q=D(re);return Q?Q.ownerId===r.id||Q.userRole==="owner":!0})();const L=(()=>{if(x||!r||!e||!v.tree||s.length===0)return!0;const re=v.tree.toString(),Q=D(re);return Q?Q.ownerId===r.id||Q.userRole==="owner"||Q.userRole==="editor":!0})(),O=async()=>{var re;if(e){if(!L){g(w?"     ":"You do not have permission to edit this person");return}try{y(!0);const Q=await Pt.updatePerson(parseInt(e),A.firstName||"",A.birth.date||"",((re=A.birth.place)==null?void 0:re.city)||"",A.occupation.length>0?A.occupation[0].title:"",A.gender||"unknown",parseInt(A.tree)||0);if(S!==(v.relationships.father?typeof v.relationships.father=="string"?v.relationships.father:v.relationships.father.id:"")&&(v.relationships.father,S))try{await Pt.addRelationship(parseInt(S),parseInt(e),"Parent")}catch(fe){console.error("Failed to add father relationship",fe)}if(_!==(v.relationships.mother?typeof v.relationships.mother=="string"?v.relationships.mother:v.relationships.mother.id:"")&&(v.relationships.mother,_))try{await Pt.addRelationship(parseInt(_),parseInt(e),"Parent")}catch(fe){console.error("Failed to add mother relationship",fe)}N(A),f(!1)}catch{g(n==="ar"?"   ":"Failed to save changes")}finally{y(!1)}}},W=()=>{P(v),f(!1)},E=async()=>{if(e){if(!L){g(w?"     ":"You do not have permission to delete this person");return}if(confirm(w?"            .":"Are you sure you want to delete this person? This action cannot be undone."))try{y(!0),await Pt.deletePerson(parseInt(e)),t("/trees")}catch(re){const Q=re.message||(n==="ar"?"   ":"Failed to delete person");g(Q),y(!1)}}};return x?a.jsx("div",{className:"flex items-center justify-center min-h-[400px]",children:a.jsxs("div",{className:"text-center",children:[a.jsx(wr,{className:"h-12 w-12 animate-spin text-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:w?"   ...":"Loading person profile..."})]})}):p?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"mx-auto w-16 h-16 bg-destructive/10 rounded-full flex items-center justify-center mb-4",children:a.jsx(ii,{className:"h-8 w-8 text-destructive"})}),a.jsx("h2",{className:"text-2xl font-bold text-destructive mb-4",children:p}),a.jsx(ge,{onClick:()=>window.location.reload(),children:w?" ":"Try Again"})]}):!L&&!x&&r&&v.tree?a.jsxs("div",{className:"flex flex-col items-center justify-center h-64 space-y-4",children:[a.jsx(fo,{className:"h-12 w-12 text-destructive"}),a.jsx("p",{className:"text-destructive text-center",children:w?"     ":"You do not have permission to edit this person"}),a.jsx(ge,{onClick:()=>t(-1),children:w?"":"Go Back"})]}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:`flex ${o?"flex-col gap-3":"flex-col sm:flex-row sm:items-center"} justify-between`,children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs(ge,{variant:"outline",onClick:()=>t(-1),className:"flex items-center gap-2",size:o?"sm":"default",children:[a.jsx(ho,{className:`h-4 w-4 ${o?"h-3 w-3":""}`}),a.jsx("span",{className:o?"hidden":"hidden xs:inline",children:w?"":"Back"})]}),a.jsxs("div",{children:[a.jsx("h1",{className:`font-bold text-foreground ${o?"text-lg":"text-xl sm:text-2xl"}`,children:d?w?" ":"Edit Person":w?" ":"View Person"}),a.jsx("p",{className:`text-muted-foreground ${o?"text-xs":"text-xs sm:text-sm"}`,children:w?"   ":"Manage person information and data"})]})]}),a.jsxs("div",{className:`flex ${o?"gap-1":"gap-2"}`,children:[a.jsxs(ge,{variant:"outline",className:"flex items-center gap-2",size:o?"sm":"default",onClick:()=>{const re=`${window.location.origin}/persons/${e}`;navigator.clipboard.writeText(re).then(()=>{M(w?"    ":"Link copied to clipboard"),setTimeout(()=>M(null),3e3)}).catch(()=>{const Q=document.createElement("textarea");Q.value=re,document.body.appendChild(Q),Q.select(),document.execCommand("copy"),document.body.removeChild(Q),M(w?"    ":"Link copied to clipboard"),setTimeout(()=>M(null),3e3)})},children:[a.jsx(fh,{className:`h-4 w-4 ${o?"h-3 w-3":""}`}),a.jsx("span",{className:o?"hidden":"hidden xs:inline",children:w?"":"Share"})]}),a.jsx(ge,{variant:d?"outline":"default",onClick:()=>d?W():f(!0),className:"flex items-center gap-2",disabled:!L,size:o?"sm":"default",children:d?a.jsxs(a.Fragment,{children:[a.jsx(ia,{className:`h-4 w-4 ${o?"h-3 w-3":""}`}),a.jsx("span",{className:o?"hidden":"hidden xs:inline",children:w?"":"Cancel"})]}):a.jsxs(a.Fragment,{children:[a.jsx(sa,{className:`h-4 w-4 ${o?"h-3 w-3":""}`}),a.jsx("span",{className:o?"hidden":"hidden xs:inline",children:w?"":"Edit"})]})})]})]}),a.jsx("div",{className:`flex ${o?"flex-wrap gap-1 p-1 bg-muted rounded-lg overflow-x-auto":"gap-1 border-b overflow-x-auto"}`,children:[{id:"basic",label:w?" ":"Basic Info",icon:sn},{id:"family",label:w?"":"Family",icon:In},{id:"contact",label:w?" ":"Contact",icon:Su},{id:"education",label:w?"":"Education",icon:RI},{id:"work",label:w?"":"Work",icon:Qo},{id:"media",label:w?" ":"Media & Docs",icon:OI},{id:"notes",label:w?"":"Notes",icon:du}].map(re=>a.jsxs(ge,{variant:c===re.id?"default":"ghost",onClick:()=>u(re.id),className:`flex items-center gap-2 whitespace-nowrap ${o?"text-xs py-2 px-3 flex-1 justify-center":""}`,size:o?"sm":"default",children:[we.createElement(re.icon,{className:`h-4 w-4 ${o?"h-3 w-3":""}`}),a.jsx("span",{className:o?"hidden":"hidden xs:inline",children:re.label})]},re.id))}),U&&a.jsx("div",{className:"bg-green-100 border border-green-200 rounded-lg p-3 mb-4",children:a.jsx("p",{className:"text-green-800 text-sm",children:U})}),c==="basic"&&a.jsxs(Qe,{children:[a.jsx(xt,{className:o?"p-4":"",children:a.jsxs(yt,{className:"flex items-center gap-2",children:[a.jsx(sn,{className:`h-5 w-5 ${o?"h-4 w-4":""}`}),w?" ":"Basic Information"]})}),a.jsxs(tt,{className:`space-y-6 ${o?"p-4":""}`,children:[a.jsxs("div",{className:`grid ${o?"grid-cols-1 gap-3":"grid-cols-1 md:grid-cols-2 gap-6"}`,children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:`font-medium ${o?"text-xs":"text-sm"}`,children:w?" ":"First Name"}),a.jsx(Kt,{value:d?A.firstName:v.firstName,onChange:re=>P(Q=>({...Q,firstName:re.target.value})),disabled:!d,placeholder:w?" ":"First Name",className:o?"text-sm py-2":""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:`font-medium ${o?"text-xs":"text-sm"}`,children:w?" ":"Middle Name"}),a.jsx(Kt,{value:d?A.middleName||"":v.middleName||"",onChange:re=>P(Q=>({...Q,middleName:re.target.value})),disabled:!d,placeholder:w?" ":"Middle Name",className:o?"text-sm py-2":""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:`font-medium ${o?"text-xs":"text-sm"}`,children:w?" ":"Last Name"}),a.jsx(Kt,{value:d?A.lastName:v.lastName,onChange:re=>P(Q=>({...Q,lastName:re.target.value})),disabled:!d,placeholder:w?" ":"Last Name",className:o?"text-sm py-2":""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:`font-medium ${o?"text-xs":"text-sm"}`,children:w?"":"Nickname"}),a.jsx(Kt,{value:d?A.nickname||"":v.nickname||"",onChange:re=>P(Q=>({...Q,nickname:re.target.value})),disabled:!d,placeholder:w?"":"Nickname",className:o?"text-sm py-2":""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:`font-medium ${o?"text-xs":"text-sm"}`,children:w?"":"Gender"}),a.jsxs("select",{value:d?A.gender:v.gender,onChange:re=>P(Q=>({...Q,gender:re.target.value})),disabled:!d,className:`w-full px-3 border border-input rounded-md bg-background disabled:opacity-50 ${o?"text-sm py-2":"py-2"}`,children:[a.jsx("option",{value:"male",children:w?"":"Male"}),a.jsx("option",{value:"female",children:w?"":"Female"}),a.jsx("option",{value:"unknown",children:w?" ":"Not specified"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:`font-medium ${o?"text-xs":"text-sm"}`,children:w?"":"Status"}),a.jsxs("select",{value:d?A.isDeceased.toString():v.isDeceased.toString(),onChange:re=>P(Q=>({...Q,isDeceased:re.target.value==="true"})),disabled:!d,className:`w-full px-3 border border-input rounded-md bg-background disabled:opacity-50 ${o?"text-sm py-2":"py-2"}`,children:[a.jsx("option",{value:"false",children:w?"  ":"Alive"}),a.jsx("option",{value:"true",children:w?"":"Deceased"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:`font-medium ${o?"text-xs":"text-sm"}`,children:w?" ":"Birth Date"}),a.jsx(Kt,{type:"date",value:d?A.birth.date||"":v.birth.date||"",onChange:re=>P(Q=>({...Q,birth:{...Q.birth,date:re.target.value}})),disabled:!d,className:o?"text-sm py-2":""})]}),(d?A.isDeceased:v.isDeceased)&&a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:`font-medium ${o?"text-xs":"text-sm"}`,children:w?" ":"Death Date"}),a.jsx(Kt,{type:"date",value:d?((H=A.death)==null?void 0:H.date)||"":((V=v.death)==null?void 0:V.date)||"",onChange:re=>P(Q=>({...Q,death:{...Q.death||{},date:re.target.value}})),disabled:!d,className:o?"text-sm py-2":""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:`font-medium ${o?"text-xs":"text-sm"}`,children:w?" ":"Birth Place"}),a.jsx(Kt,{value:d?((R=A.birth.place)==null?void 0:R.city)||"":((q=v.birth.place)==null?void 0:q.city)||"",onChange:re=>P(Q=>({...Q,birth:{...Q.birth,place:{...Q.birth.place,city:re.target.value}}})),disabled:!d,placeholder:w?" ":"Birth City",className:o?"text-sm py-2":""})]}),(d?A.isDeceased:v.isDeceased)&&a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:`font-medium ${o?"text-xs":"text-sm"}`,children:w?" ":"Death Place"}),a.jsx(Kt,{value:d?((G=(F=A.death)==null?void 0:F.place)==null?void 0:G.city)||"":((ae=(ee=v.death)==null?void 0:ee.place)==null?void 0:ae.city)||"",onChange:re=>P(Q=>{var fe;return{...Q,death:{...Q.death||{},place:{...(fe=Q.death)==null?void 0:fe.place,city:re.target.value}}}}),disabled:!d,placeholder:w?" ":"Death City",className:o?"text-sm py-2":""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:`font-medium ${o?"text-xs":"text-sm"}`,children:w?"":"Father"}),a.jsxs("select",{value:S,onChange:re=>C(re.target.value),disabled:!d,className:`w-full px-3 border border-input rounded-md bg-background disabled:opacity-50 ${o?"text-sm py-2":"py-2"}`,children:[a.jsx("option",{value:"",children:w?" ":"Select Father"}),B.filter(re=>re.gender==="male").map(re=>a.jsx("option",{value:re.id,children:re.fullName||`${re.firstName} ${re.lastName}`},re.id))]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:`font-medium ${o?"text-xs":"text-sm"}`,children:w?"":"Mother"}),a.jsxs("select",{value:_,onChange:re=>T(re.target.value),disabled:!d,className:`w-full px-3 border border-input rounded-md bg-background disabled:opacity-50 ${o?"text-sm py-2":"py-2"}`,children:[a.jsx("option",{value:"",children:w?" ":"Select Mother"}),B.filter(re=>re.gender==="female").map(re=>a.jsx("option",{value:re.id,children:re.fullName||`${re.firstName} ${re.lastName}`},re.id))]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:`font-medium ${o?"text-xs":"text-sm"}`,children:w?"":"Notes"}),a.jsx(id,{value:d?A.notes||"":v.notes||"",onChange:re=>P(Q=>({...Q,notes:re.target.value})),disabled:!d,placeholder:w?"  ...":"Write additional notes...",rows:o?3:4,className:o?"text-sm py-2":""})]}),d&&a.jsxs("div",{className:`flex ${o?"flex-col gap-2":"gap-3 pt-4"}`,children:[a.jsx(ge,{onClick:O,className:"flex items-center gap-2",disabled:x,size:o?"sm":"default",children:x?a.jsxs(a.Fragment,{children:[a.jsx(wr,{className:`animate-spin ${o?"h-3 w-3 mr-1":"h-4 w-4 mr-2"}`}),w?" ...":"Saving..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Au,{className:`h-4 w-4 ${o?"h-3 w-3":""}`}),o?w?"":"Save":w?" ":"Save Changes"]})}),a.jsx(ge,{variant:"outline",onClick:W,disabled:x,size:o?"sm":"default",children:w?"":"Cancel"})]})]})]}),d&&a.jsxs(Qe,{className:"border-destructive/20",children:[a.jsx(xt,{className:o?"p-4":"",children:a.jsxs(yt,{className:"flex items-center gap-2 text-destructive",children:[a.jsx(fo,{className:`h-5 w-5 ${o?"h-4 w-4":""}`}),w?" ":"Danger Zone"]})}),a.jsx(tt,{className:o?"p-4":"",children:a.jsxs("div",{className:`flex ${o?"flex-col gap-3":"items-center justify-between"}`,children:[a.jsxs("div",{children:[a.jsx("p",{className:`font-medium text-destructive ${o?"text-sm":""}`,children:w?" ":"Delete Person"}),a.jsx("p",{className:`text-muted-foreground ${o?"text-xs":"text-sm"}`,children:w?"       ":"Permanently delete this person and all their data from the tree"})]}),a.jsxs(ge,{variant:"destructive",onClick:E,className:"flex items-center gap-2",disabled:x,size:o?"sm":"default",children:[x?a.jsx(wr,{className:`animate-spin ${o?"h-3 w-3":"h-4 w-4"}`}):a.jsx(Ia,{className:`h-4 w-4 ${o?"h-3 w-3":""}`}),w?"":"Delete"]})]})})]})]})},yee=()=>{const{language:e}=Xt(),{trees:t}=xs(),[n,r]=Y.useState(""),[s,i]=Y.useState("all"),[l,o]=Y.useState("relevance"),[c,u]=Y.useState(null),[d,f]=Y.useState(null),[m,h]=Y.useState(null),[x,y]=Y.useState(!1),[p,g]=Y.useState(!1),[w,v]=Y.useState([]),[N,A]=Y.useState([]),[P,U]=Y.useState(null),M=Y.useRef(null),{isMobile:S}=Tr(),C=e==="ar";Y.useEffect(()=>()=>{M.current&&clearTimeout(M.current)},[]),Y.useEffect(()=>(M.current&&clearTimeout(M.current),()=>{M.current&&clearTimeout(M.current)}),[n]);const _=Y.useMemo(()=>{let L=w,O=N;if(n){const W=n.toLowerCase();L=w.filter(E=>E.firstName&&E.firstName.toLowerCase().includes(W)||E.firstNameEn&&E.firstNameEn.toLowerCase().includes(W)||E.lastName&&E.lastName.toLowerCase().includes(W)||E.lastNameEn&&E.lastNameEn.toLowerCase().includes(W)||E.treeName&&E.treeName.toLowerCase().includes(W)||E.treeNameEn&&E.treeNameEn.toLowerCase().includes(W)||E.occupation&&E.occupation.toLowerCase().includes(W)||E.occupationEn&&E.occupationEn.toLowerCase().includes(W)||E.birthPlace&&E.birthPlace.toLowerCase().includes(W)||E.birthPlaceEn&&E.birthPlaceEn.toLowerCase().includes(W)),O=N.filter(E=>E.name&&E.name.toLowerCase().includes(W)||E.nameEn&&E.nameEn.toLowerCase().includes(W)||E.description&&E.description.toLowerCase().includes(W)||E.descriptionEn&&E.descriptionEn.toLowerCase().includes(W))}return c!==null&&(L=L.filter(W=>W.generation===c)),d!==null&&(L=L.filter(W=>W.gender===d)),m!==null&&(L=L.filter(W=>W.isAlive===m)),l==="name"?(L.sort((W,E)=>{const H=C?W.firstName:W.firstNameEn||W.firstName,V=C?E.firstName:E.firstNameEn||E.firstName;return H.localeCompare(V)}),O.sort((W,E)=>{const H=C?W.name:W.nameEn||W.name,V=C?E.name:E.nameEn||E.name;return H.localeCompare(V)})):l==="date"?(L.sort((W,E)=>{const H=W.birthDate?new Date(W.birthDate).getTime():0;return(E.birthDate?new Date(E.birthDate).getTime():0)-H}),O.sort((W,E)=>new Date(E.createdAt).getTime()-new Date(W.createdAt).getTime())):l==="generation"&&L.some(W=>W.generation!==void 0)&&L.sort((W,E)=>(W.generation||0)-(E.generation||0)),{people:L,trees:O}},[w,N,n,c,d,m,l,C]),T=L=>{if(!L)return null;let O;try{if(L.includes("T"))O=new Date(L);else if(L.includes("-")){const V=L.split("-");V.length===3?O=new Date(parseInt(V[0]),parseInt(V[1])-1,parseInt(V[2])):O=new Date(L)}else if(L.includes("/")){const V=L.split("/");V.length===3?O=new Date(parseInt(V[2]),parseInt(V[0])-1,parseInt(V[1])):O=new Date(L)}else O=new Date(L)}catch{return null}if(isNaN(O.getTime()))return null;const W=new Date;let E=W.getFullYear()-O.getFullYear();const H=W.getMonth()-O.getMonth();return(H<0||H===0&&W.getDate()<O.getDate())&&E--,E},B=L=>L===1?Nu:L===2||L&&L>2?sn:na,$=()=>{u(null),f(null),h(null)},D=c!==null||d!==null||m!==null;return a.jsxs("div",{className:`space-y-6 ${S?"p-4":""}`,children:[a.jsxs(Qe,{className:S?"rounded-lg":"",children:[a.jsx(xt,{className:S?"p-4":"",children:a.jsxs(yt,{className:`flex items-center gap-2 ${S?"text-lg":""}`,children:[a.jsx(Qi,{className:`h-5 w-5 text-primary ${S?"h-4 w-4":""}`}),C?" ":"Advanced Search"]})}),a.jsxs(tt,{className:`space-y-4 ${S?"p-4":""}`,children:[a.jsxs("div",{className:"relative",children:[a.jsx(Qi,{className:`absolute left-3 top-1/2 transform -translate-y-1/2 ${S?"h-3.5 w-3.5":"h-4 w-4"} text-muted-foreground`}),a.jsx(Kt,{placeholder:C?"   ...":"Search people and trees...",value:n,onChange:L=>r(L.target.value),className:`pl-10 ${S?"py-2 text-sm":""}`})]}),a.jsxs("div",{className:`flex ${S?"flex-col gap-3":"flex-wrap gap-4"} items-center`,children:[a.jsxs("div",{className:`flex ${S?"flex-wrap gap-1 p-1 bg-muted rounded-lg w-full":"gap-1 border rounded-md p-1"}`,children:[a.jsx(ge,{variant:s==="all"?"default":"ghost",size:"sm",onClick:()=>i("all"),className:`flex items-center gap-2 whitespace-nowrap ${S?"text-xs py-2 px-3 flex-1 justify-center h-8":"h-8 px-3"}`,children:a.jsx("span",{className:S?"hidden":"",children:C?"":"All"})}),a.jsxs(ge,{variant:s==="people"?"default":"ghost",size:"sm",onClick:()=>i("people"),className:`flex items-center gap-2 whitespace-nowrap ${S?"text-xs py-2 px-3 flex-1 justify-center h-8":"h-8 px-3"}`,children:[a.jsx(sn,{className:`h-4 w-4 ${S?"h-3 w-3":"mr-1"}`}),a.jsx("span",{className:S?"hidden":"",children:C?"":"People"})]}),a.jsxs(ge,{variant:s==="trees"?"default":"ghost",size:"sm",onClick:()=>i("trees"),className:`flex items-center gap-2 whitespace-nowrap ${S?"text-xs py-2 px-3 flex-1 justify-center h-8":"h-8 px-3"}`,children:[a.jsx(Qn,{className:`h-4 w-4 ${S?"h-3 w-3":"mr-1"}`}),a.jsx("span",{className:S?"hidden":"",children:C?"":"Trees"})]})]}),a.jsxs("div",{className:`flex ${S?"flex-col gap-2 w-full":"items-center gap-2"}`,children:[a.jsx("span",{className:`text-muted-foreground ${S?"text-xs":"text-sm"}`,children:C?":":"Sort:"}),a.jsxs("div",{className:`flex ${S?"flex-wrap gap-1 p-1 bg-muted rounded-lg w-full":"gap-1 border rounded-md p-1"}`,children:[a.jsx(ge,{variant:l==="relevance"?"default":"ghost",size:"sm",onClick:()=>o("relevance"),className:`flex items-center gap-2 whitespace-nowrap ${S?"text-xs py-2 px-3 flex-1 justify-center h-8":"h-8 px-3 text-xs"}`,children:C?"":"Relevance"}),a.jsx(ge,{variant:l==="name"?"default":"ghost",size:"sm",onClick:()=>o("name"),className:`flex items-center gap-2 whitespace-nowrap ${S?"text-xs py-2 px-3 flex-1 justify-center h-8":"h-8 px-3 text-xs"}`,children:C?"":"Name"}),a.jsx(ge,{variant:l==="date"?"default":"ghost",size:"sm",onClick:()=>o("date"),className:`flex items-center gap-2 whitespace-nowrap ${S?"text-xs py-2 px-3 flex-1 justify-center h-8":"h-8 px-3 text-xs"}`,children:C?"":"Date"}),a.jsx(ge,{variant:l==="generation"?"default":"ghost",size:"sm",onClick:()=>o("generation"),className:`flex items-center gap-2 whitespace-nowrap ${S?"text-xs py-2 px-3 flex-1 justify-center h-8":"h-8 px-3 text-xs"}`,children:C?"":"Generation"})]})]}),a.jsxs(ge,{variant:"outline",size:"sm",onClick:()=>y(!x),className:`h-8 px-3 ${S?"w-full":""}`,children:[a.jsx(GI,{className:`h-4 w-4 ${S?"h-3 w-3 mr-1":"mr-1"}`}),C?"":"Filters",x?a.jsx(aj,{className:`h-4 w-4 ${S?"h-3 w-3 ml-1":"ml-1"}`}):a.jsx(ny,{className:`h-4 w-4 ${S?"h-3 w-3 ml-1":"ml-1"}`}),D&&a.jsx("div",{className:"w-2 h-2 bg-primary rounded-full ml-1"})]})]}),x&&a.jsxs("div",{className:`border-t ${S?"pt-3":"pt-4"} space-y-4`,children:[a.jsxs("div",{className:`flex ${S?"flex-col gap-3":"flex-wrap gap-4"}`,children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:`font-medium ${S?"text-xs":"text-sm"}`,children:C?":":"Generation:"}),a.jsx("div",{className:`flex ${S?"flex-wrap gap-1":"gap-1"}`,children:[0,1,2,3,4,5].map(L=>a.jsxs(ge,{variant:c===L?"default":"outline",size:"sm",onClick:()=>u(c===L?null:L),className:`flex items-center gap-2 whitespace-nowrap ${S?"text-xs py-2 px-3 h-8 flex-1 justify-center":"h-8 px-3"}`,children:[L===0&&a.jsx(na,{className:`h-3 w-3 ${S?"h-2.5 w-2.5":"mr-1"}`}),L===1&&a.jsx(Nu,{className:`h-3 w-3 ${S?"h-2.5 w-2.5":"mr-1"}`}),L>=2&&a.jsx(sn,{className:`h-3 w-3 ${S?"h-2.5 w-2.5":"mr-1"}`}),C?` ${L}`:`Gen ${L}`]},L))})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:`font-medium ${S?"text-xs":"text-sm"}`,children:C?":":"Gender:"}),a.jsxs("div",{className:`flex ${S?"flex-wrap gap-1":"gap-1"}`,children:[a.jsx(ge,{variant:d==="male"?"default":"outline",size:"sm",onClick:()=>f(d==="male"?null:"male"),className:`flex items-center gap-2 whitespace-nowrap ${S?"text-xs py-2 px-3 h-8 flex-1 justify-center":"h-8 px-3"}`,children:C?"":"Male"}),a.jsx(ge,{variant:d==="female"?"default":"outline",size:"sm",onClick:()=>f(d==="female"?null:"female"),className:`flex items-center gap-2 whitespace-nowrap ${S?"text-xs py-2 px-3 h-8 flex-1 justify-center":"h-8 px-3"}`,children:C?"":"Female"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:`font-medium ${S?"text-xs":"text-sm"}`,children:C?":":"Status:"}),a.jsxs("div",{className:`flex ${S?"flex-wrap gap-1":"gap-1"}`,children:[a.jsxs(ge,{variant:m===!0?"default":"outline",size:"sm",onClick:()=>h(m===!0?null:!0),className:`flex items-center gap-2 whitespace-nowrap ${S?"text-xs py-2 px-3 h-8 flex-1 justify-center":"h-8 px-3"}`,children:[a.jsx(Or,{className:`h-3 w-3 ${S?"h-2.5 w-2.5 mr-1":"mr-1"} text-green-600`}),C?"  ":"Alive"]}),a.jsx(ge,{variant:m===!1?"default":"outline",size:"sm",onClick:()=>h(m===!1?null:!1),className:`flex items-center gap-2 whitespace-nowrap ${S?"text-xs py-2 px-3 h-8 flex-1 justify-center":"h-8 px-3"}`,children:C?"":"Deceased"})]})]})]}),D&&a.jsxs(ge,{variant:"ghost",size:"sm",onClick:$,className:`text-muted-foreground ${S?"h-8 px-3 text-xs":"h-8 px-3"}`,children:[a.jsx(ia,{className:`h-4 w-4 ${S?"h-3 w-3 mr-1":"mr-1"}`}),C?" ":"Clear Filters"]})]})]})]}),p&&a.jsx("div",{className:"flex justify-center items-center py-12",children:a.jsx(wr,{className:"h-8 w-8 animate-spin text-primary"})}),P&&!p&&a.jsx(Qe,{className:S?"rounded-lg":"",children:a.jsxs(tt,{className:"text-center py-12",children:[a.jsx("div",{className:"text-destructive mb-4",children:a.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-12 w-12 mx-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),a.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:C?"   ":"Error Loading Data"}),a.jsx("p",{className:"text-muted-foreground mb-4",children:P}),a.jsx(ge,{onClick:()=>window.location.reload(),children:C?" ":"Try Again"})]})}),!p&&!P&&a.jsxs("div",{className:"space-y-6",children:[(s==="all"||s==="people")&&_.people.length>0&&a.jsxs(Qe,{className:S?"rounded-lg":"",children:[a.jsx(xt,{className:S?"p-4":"",children:a.jsxs(yt,{className:`flex items-center gap-2 ${S?"text-lg":""}`,children:[a.jsx(sn,{className:`h-5 w-5 text-blue-600 ${S?"h-4 w-4":""}`}),C?"":"People",a.jsx(er,{variant:"secondary",className:S?"text-xs px-1.5 py-0.5":"",children:_.people.length})]})}),a.jsx(tt,{className:S?"p-4":"",children:a.jsx("div",{className:`grid ${S?"grid-cols-1 gap-3":"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"}`,children:_.people.map(L=>{var E;const O=B(L.generation),W=T(L.birthDate);return a.jsx("div",{className:"group",children:a.jsxs("div",{className:`
                          relative bg-card border rounded-lg shadow-sm hover:shadow-md transition-all duration-200
                          ${L.gender==="male"?"border-blue-200 hover:border-blue-300 dark:border-blue-900 dark:hover:border-blue-700":"border-pink-200 hover:border-pink-300 dark:border-pink-900 dark:hover:border-pink-700"} ${S?"p-3":"p-4"}`,children:[a.jsxs("div",{className:`flex items-start gap-3 ${S?"gap-2":""}`,children:[a.jsx("div",{className:`
                              rounded-full flex items-center justify-center flex-shrink-0
                              ${L.gender==="male"?"bg-blue-100 text-blue-600":"bg-pink-100 text-pink-600"} ${S?"w-10 h-10":"w-12 h-12"}`,children:L.photo?a.jsx("img",{src:L.photo,alt:C?L.firstName:L.firstNameEn||L.firstName,className:"w-full h-full rounded-full object-cover"}):a.jsx(O,{className:`h-6 w-6 ${S?"h-5 w-5":""}`})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("h4",{className:`font-semibold text-foreground truncate ${S?"text-sm":""}`,children:[C?L.firstName:L.firstNameEn||L.firstName,L.lastName&&` ${C?L.lastName:L.lastNameEn||L.lastName}`]}),L.treeName&&a.jsx("p",{className:`text-muted-foreground truncate ${S?"text-xs":"text-sm"}`,children:C?L.treeName:L.treeNameEn||L.treeName}),a.jsxs("div",{className:`flex items-center gap-2 mt-1 ${S?"text-xs":"text-sm"} text-muted-foreground`,children:[W!==null&&a.jsxs(a.Fragment,{children:[a.jsx(Ur,{className:`h-3 w-3 ${S?"h-2.5 w-2.5":""}`}),a.jsxs("span",{children:[W," ",C?"":"yrs"]})]}),L.generation&&a.jsx(er,{variant:"outline",className:`text-xs ${S?"px-1.5 py-0.5":""}`,children:C?` ${L.generation}`:`Gen ${L.generation}`}),!L.isAlive&&a.jsx(er,{variant:"outline",className:`text-xs ${S?"px-1.5 py-0.5":""}`,children:C?"":"Deceased"})]}),L.occupation&&a.jsx("div",{className:"flex items-center gap-1 mt-1 text-xs text-muted-foreground",children:a.jsx("span",{children:C?L.occupation:L.occupationEn||L.occupation})}),L.birthPlace&&a.jsxs("div",{className:"flex items-center gap-1 mt-1 text-xs text-muted-foreground",children:[a.jsx(ai,{className:`h-3 w-3 ${S?"h-2.5 w-2.5":""}`}),a.jsx("span",{className:"truncate",children:C?L.birthPlace.split("")[0]:((E=L.birthPlaceEn)==null?void 0:E.split(",")[0])||L.birthPlace.split(",")[0]})]})]}),a.jsx("div",{className:`
                              rounded-full flex-shrink-0
                              ${L.isAlive?"bg-green-500":"bg-gray-400"}
                              ${S?"w-2.5 h-2.5":"w-3 h-3"}`})]}),a.jsxs("div",{className:`flex ${S?"gap-1 mt-2":"gap-2 mt-3"} opacity-0 group-hover:opacity-100 transition-opacity`,children:[a.jsx(ge,{asChild:!0,size:"sm",variant:"outline",className:"flex-1 h-7 px-2 text-xs",children:a.jsxs(It,{to:`/persons/${L.id}`,className:"flex items-center justify-center",children:[a.jsx(ra,{className:`h-3 w-3 ${S?"h-2.5 w-2.5 mr-1":"mr-1"}`}),a.jsx("span",{className:S?"hidden":"",children:C?"":"View"})]})}),a.jsx(ge,{asChild:!0,size:"sm",variant:"outline",className:"flex-1 h-7 px-2 text-xs",children:a.jsxs(It,{to:`/trees/${L.treeId}`,className:"flex items-center justify-center",children:[a.jsx(Qn,{className:`h-3 w-3 ${S?"h-2.5 w-2.5 mr-1":"mr-1"}`}),a.jsx("span",{className:S?"hidden":"",children:C?"":"Tree"})]})})]}),a.jsx("div",{className:`
                            absolute top-2 right-2 rounded-full
                            ${L.gender==="male"?"bg-blue-500":"bg-pink-500"}
                            ${S?"w-2.5 h-2.5":"w-3 h-3"}`})]})},L.id)})})})]}),(s==="all"||s==="trees")&&_.trees.length>0&&a.jsxs(Qe,{className:S?"rounded-lg":"",children:[a.jsx(xt,{className:S?"p-4":"",children:a.jsxs(yt,{className:`flex items-center gap-2 ${S?"text-lg":""}`,children:[a.jsx(Qn,{className:`h-5 w-5 text-green-600 ${S?"h-4 w-4":""}`}),C?" ":"Family Trees",a.jsx(er,{variant:"secondary",className:S?"text-xs px-1.5 py-0.5":"",children:_.trees.length})]})}),a.jsx(tt,{className:S?"p-4":"",children:a.jsx("div",{className:`grid ${S?"grid-cols-1 gap-3":"grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"}`,children:_.trees.map(L=>a.jsx("div",{className:"group",children:a.jsxs("div",{className:`relative bg-card border border-green-200 rounded-lg shadow-sm hover:shadow-md hover:border-green-300 transition-all duration-200 dark:border-green-900 dark:hover:border-green-700 ${S?"p-3":"p-4"}`,children:[a.jsxs("div",{className:`flex items-start gap-3 ${S?"gap-2":""}`,children:[a.jsx("div",{className:`rounded-full bg-green-100 text-green-600 flex items-center justify-center flex-shrink-0 ${S?"w-10 h-10":"w-12 h-12"}`,children:a.jsx(Qn,{className:`h-6 w-6 ${S?"h-5 w-5":""}`})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:`font-semibold text-foreground truncate ${S?"text-sm":""}`,children:C?L.name:L.nameEn||L.name}),L.description&&a.jsx("p",{className:`text-muted-foreground mt-1 line-clamp-2 ${S?"text-xs":"text-sm"}`,children:C?L.description:L.descriptionEn||L.description}),a.jsxs("div",{className:`flex items-center gap-2 mt-2 ${S?"text-xs":"text-sm"} text-muted-foreground`,children:[L.memberCount!==void 0&&a.jsxs(a.Fragment,{children:[a.jsx(In,{className:`h-3 w-3 ${S?"h-2.5 w-2.5":""}`}),a.jsxs("span",{children:[L.memberCount," ",C?"":"members"]})]}),L.isPublic!==void 0&&a.jsx(er,{variant:L.isPublic?"default":"secondary",className:`text-xs ${S?"px-1.5 py-0.5":""}`,children:L.isPublic?C?"":"Public":C?"":"Private"})]}),a.jsxs("div",{className:"flex items-center gap-1 mt-1 text-xs text-muted-foreground",children:[a.jsx(Ur,{className:`h-3 w-3 ${S?"h-2.5 w-2.5":""}`}),a.jsxs("span",{children:[C?" : ":"Created: ",new Date(L.createdAt).toLocaleDateString(C?"ar-SA":"en-US")]})]}),L.owner&&a.jsxs("div",{className:"flex items-center gap-1 mt-1 text-xs text-muted-foreground",children:[a.jsx(sn,{className:`h-3 w-3 ${S?"h-2.5 w-2.5":""}`}),a.jsx("span",{children:C?`${L.owner.firstName} ${L.owner.lastName}`:`${L.owner.firstName} ${L.owner.lastName}`})]})]})]}),a.jsxs("div",{className:`flex ${S?"gap-1 mt-2":"gap-2 mt-3"} opacity-0 group-hover:opacity-100 transition-opacity`,children:[a.jsx(ge,{asChild:!0,size:"sm",variant:"outline",className:"flex-1 h-7 px-2 text-xs",children:a.jsxs(It,{to:`/trees/${L.id}`,className:"flex items-center justify-center",children:[a.jsx(ra,{className:`h-3 w-3 ${S?"h-2.5 w-2.5 mr-1":"mr-1"}`}),a.jsx("span",{className:S?"hidden":"",children:C?"":"View"})]})}),a.jsx(ge,{asChild:!0,size:"sm",variant:"outline",className:"flex-1 h-7 px-2 text-xs",children:a.jsxs(It,{to:`/trees/${L.id}/edit`,className:"flex items-center justify-center",children:[a.jsx(sa,{className:`h-3 w-3 ${S?"h-2.5 w-2.5 mr-1":"mr-1"}`}),a.jsx("span",{className:S?"hidden":"",children:C?"":"Edit"})]})})]})]})},L.id))})})]}),_.people.length===0&&_.trees.length===0&&n&&a.jsx(Qe,{className:S?"rounded-lg":"",children:a.jsxs(tt,{className:`text-center ${S?"py-8":"py-12"}`,children:[a.jsx(Qi,{className:`text-muted-foreground mx-auto mb-4 ${S?"h-8 w-8":"h-12 w-12"}`}),a.jsx("h3",{className:`font-semibold text-foreground mb-2 ${S?"text-base":"text-lg"}`,children:C?"  ":"No Results Found"}),a.jsx("p",{className:`text-muted-foreground mb-4 ${S?"text-sm":""}`,children:C?`     "${n}"`:`We couldn't find any results for "${n}"`}),a.jsxs("div",{className:`text-muted-foreground ${S?"text-xs":"text-sm"}`,children:[a.jsx("p",{children:C?":":"Try:"}),a.jsxs("ul",{className:`mt-2 ${S?"space-y-0.5":"space-y-1"}`,children:[a.jsxs("li",{children:[" ",C?"  ":"Check your spelling"]}),a.jsxs("li",{children:[" ",C?"    ":"Use fewer or different keywords"]}),a.jsxs("li",{children:[" ",C?" ":"Clear filters"]}),a.jsxs("li",{children:[" ",C?"  ":"Search using English names"]})]})]})]})}),!n&&!p&&a.jsx(Qe,{className:S?"rounded-lg":"",children:a.jsxs(tt,{className:`text-center ${S?"py-8":"py-12"}`,children:[a.jsx(Qi,{className:`text-muted-foreground mx-auto mb-4 ${S?"h-8 w-8":"h-12 w-12"}`}),a.jsx("h3",{className:`font-semibold text-foreground mb-2 ${S?"text-base":"text-lg"}`,children:C?" ":"Start Searching"}),a.jsx("p",{className:`text-muted-foreground ${S?"text-sm":""}`,children:C?"          ":"Search through family trees and people using names, places, or occupations"})]})})]})]})},bee=()=>{var C,_,T,B,$,D,L;const{isMobile:e}=Tr(),{language:t,setLanguage:n,theme:r,setTheme:s}=Xt(),{success:i,error:l}=mj(),{user:o,updateNotificationSettings:c,updatePrivacySettings:u}=Pr(),[d,f]=Y.useState("general"),[m,h]=Y.useState(!1),[x,y]=Y.useState(!1),p=t==="ar",[g,w]=Y.useState({language:t,theme:r,notifications:{email:((_=(C=o==null?void 0:o.notifications)==null?void 0:C.email)==null?void 0:_.newSuggestions)??!0,push:((B=(T=o==null?void 0:o.notifications)==null?void 0:T.push)==null?void 0:B.enabled)??!0,sound:!0,familyUpdates:!0,newMembers:!0,birthdays:!0,anniversaries:!0},privacy:{profileVisibility:(($=o==null?void 0:o.privacy)==null?void 0:$.profileVisibility)??"family",allowSearch:((D=o==null?void 0:o.privacy)==null?void 0:D.allowSearchEngines)??!0,showOnlineStatus:((L=o==null?void 0:o.privacy)==null?void 0:L.showOnlineStatus)??!0,allowDirectMessages:!0},display:{dateFormat:"dd/mm/yyyy",timeFormat:"24h",fontSize:"medium",compactMode:!1},backup:{autoBackup:!0,backupFrequency:"weekly",cloudSync:!0}});Y.useEffect(()=>{o&&w(O=>{var W,E,H,V,R,q,F;return{...O,notifications:{...O.notifications,email:((E=(W=o.notifications)==null?void 0:W.email)==null?void 0:E.newSuggestions)??!0,push:((V=(H=o.notifications)==null?void 0:H.push)==null?void 0:V.enabled)??!0},privacy:{...O.privacy,profileVisibility:((R=o.privacy)==null?void 0:R.profileVisibility)??"family",allowSearch:((q=o.privacy)==null?void 0:q.allowSearchEngines)??!0,showOnlineStatus:((F=o.privacy)==null?void 0:F.showOnlineStatus)??!0}}})},[o]),Y.useEffect(()=>{w(O=>({...O,language:t,theme:r}))},[t,r]);const v=(O,W,E)=>{w(H=>({...H,[O]:{...H[O],[W]:E}})),h(!0)},N=O=>{n(O),w(W=>({...W,language:O})),h(!0)},A=O=>{s(O),w(W=>({...W,theme:O})),h(!0)},P=async()=>{y(!0);try{await c({email:{newSuggestions:g.notifications.email,treeUpdates:g.notifications.familyUpdates,subscriptionUpdates:g.notifications.newMembers,marketing:g.notifications.anniversaries},push:{enabled:g.notifications.push}}),await u({profileVisibility:g.privacy.profileVisibility,allowSearchEngines:g.privacy.allowSearch,showOnlineStatus:g.privacy.showOnlineStatus}),h(!1),i({en:"Settings saved successfully",ar:"   "})}catch{l({en:"Failed to save settings",ar:"   "})}finally{y(!1)}},U=()=>{var O,W,E,H,V,R,q;confirm(p?"       ":"Are you sure you want to reset all settings?")&&(w({language:t,theme:r,notifications:{email:((W=(O=o==null?void 0:o.notifications)==null?void 0:O.email)==null?void 0:W.newSuggestions)??!0,push:((H=(E=o==null?void 0:o.notifications)==null?void 0:E.push)==null?void 0:H.enabled)??!0,sound:!0,familyUpdates:!0,newMembers:!0,birthdays:!0,anniversaries:!0},privacy:{profileVisibility:((V=o==null?void 0:o.privacy)==null?void 0:V.profileVisibility)??"family",allowSearch:((R=o==null?void 0:o.privacy)==null?void 0:R.allowSearchEngines)??!0,showOnlineStatus:((q=o==null?void 0:o.privacy)==null?void 0:q.showOnlineStatus)??!0,allowDirectMessages:!0},display:{dateFormat:"dd/mm/yyyy",timeFormat:"24h",fontSize:"medium",compactMode:!1},backup:{autoBackup:!0,backupFrequency:"weekly",cloudSync:!0}}),h(!0))},M=()=>{},S=()=>{};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-foreground",children:p?"":"Settings"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:p?"   ":"Manage application and account settings"})]}),m&&a.jsx(ge,{onClick:P,disabled:x,className:"flex items-center gap-2",size:e?"icon":"default",children:x?a.jsxs(a.Fragment,{children:[a.jsx(wr,{className:"h-4 w-4 animate-spin"}),!e&&(p?" ...":"Saving...")]}):a.jsxs(a.Fragment,{children:[a.jsx(Au,{className:"h-4 w-4"}),!e&&(p?" ":"Save Changes")]})})]}),a.jsx("div",{className:"flex gap-1 border-b overflow-x-auto",children:[{id:"general",label:p?"":"General",icon:Mf},{id:"account",label:p?"":"Account",icon:sn}].map(O=>a.jsxs(ge,{variant:d===O.id?"default":"ghost",onClick:()=>f(O.id),className:"flex items-center gap-2 whitespace-nowrap",size:e?"icon":"default",title:e?O.label:void 0,children:[we.createElement(O.icon,{className:"h-4 w-4"}),!e&&O.label," "]},O.id))}),d==="general"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsxs(yt,{className:"flex items-center gap-2",children:[a.jsx(lj,{className:"h-5 w-5"}),p?" ":"Language & Region"]})}),a.jsx(tt,{className:"space-y-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:p?" ":"Application Language"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:p?"   ":"Choose the application interface language"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(ge,{variant:g.language==="ar"?"default":"outline",size:e?"icon":"sm",onClick:()=>N("ar"),title:e?"":void 0,children:[e?"":""," "]}),a.jsxs(ge,{variant:g.language==="en"?"default":"outline",size:e?"icon":"sm",onClick:()=>N("en"),title:e?"English":void 0,children:[e?"En":"English"," "]})]})]})})]}),a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsxs(yt,{className:"flex items-center gap-2",children:[a.jsx(VI,{className:"h-5 w-5"}),p?"":"Appearance"]})}),a.jsx(tt,{className:"space-y-4",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:p?" ":"Theme Mode"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:p?"   ":"Choose your preferred theme mode"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(ge,{variant:g.theme==="light"?"default":"outline",size:e?"icon":"sm",onClick:()=>A("light"),className:"flex items-center gap-2",title:e?p?"":"Light":void 0,children:[a.jsx(Rf,{className:"h-4 w-4"}),!e&&(p?"":"Light")," "]}),a.jsxs(ge,{variant:g.theme==="dark"?"default":"outline",size:e?"icon":"sm",onClick:()=>A("dark"),className:"flex items-center gap-2",title:e?p?"":"Dark":void 0,children:[a.jsx(Lf,{className:"h-4 w-4"}),!e&&(p?"":"Dark")," "]}),a.jsxs(ge,{variant:"outline",size:e?"icon":"sm",onClick:()=>{},className:"flex items-center gap-2",title:e?p?"":"System":void 0,children:[a.jsx(t5,{className:"h-4 w-4"}),!e&&(p?"":"System")," "]})]})]})})]})]}),d==="notifications"&&a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsxs(yt,{className:"flex items-center gap-2",children:[a.jsx(PI,{className:"h-5 w-5"}),p?" ":"Notification Settings"]})}),a.jsxs(tt,{className:"space-y-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"font-medium",children:p?" ":"Notification Methods"}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:p?"  ":"Email Notifications"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:p?"    ":"Receive notifications via email"})]}),a.jsx(ge,{variant:g.notifications.email?"default":"outline",size:e?"icon":"sm",onClick:()=>v("notifications","email",!g.notifications.email),title:e?g.notifications.email?p?"":"On":p?"":"Off":void 0,children:e?g.notifications.email?p?"":"ON":p?"":"OFF":g.notifications.email?p?"":"On":p?"":"Off"})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:p?" ":"Push Notifications"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:p?"    ":"Receive push notifications on device"})]}),a.jsx(ge,{variant:g.notifications.push?"default":"outline",size:e?"icon":"sm",onClick:()=>v("notifications","push",!g.notifications.push),title:e?g.notifications.push?p?"":"On":p?"":"Off":void 0,children:e?g.notifications.push?p?"":"ON":p?"":"OFF":g.notifications.push?p?"":"On":p?"":"Off"})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:p?"":"Sound Notifications"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:p?"   ":"Play sounds with notifications"})]}),a.jsxs(ge,{variant:g.notifications.sound?"default":"outline",size:e?"icon":"sm",onClick:()=>v("notifications","sound",!g.notifications.sound),className:"flex items-center gap-2",title:e?g.notifications.sound?p?"":"On":p?"":"Off":void 0,children:[g.notifications.sound?a.jsx(QI,{className:"h-4 w-4"}):a.jsx(eT,{className:"h-4 w-4"}),!e&&(g.notifications.sound?p?"":"On":p?"":"Off")]})]})]}),a.jsxs("div",{className:"border-t pt-6 space-y-4",children:[a.jsx("h3",{className:"font-medium",children:p?" ":"Notification Types"}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:p?" ":"Family Updates"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:p?"      ":"Notifications when family members are added or updated"})]}),a.jsx(ge,{variant:g.notifications.familyUpdates?"default":"outline",size:e?"icon":"sm",onClick:()=>v("notifications","familyUpdates",!g.notifications.familyUpdates),title:e?g.notifications.familyUpdates?p?"":"On":p?"":"Off":void 0,children:e?g.notifications.familyUpdates?p?"":"ON":p?"":"OFF":g.notifications.familyUpdates?p?"":"On":p?"":"Off"})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:p?" ":"New Members"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:p?"     ":"Notifications when new members join the tree"})]}),a.jsx(ge,{variant:g.notifications.newMembers?"default":"outline",size:e?"icon":"sm",onClick:()=>v("notifications","newMembers",!g.notifications.newMembers),title:e?g.notifications.newMembers?p?"":"On":p?"":"Off":void 0,children:e?g.notifications.newMembers?p?"":"ON":p?"":"OFF":g.notifications.newMembers?p?"":"On":p?"":"Off"})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:p?" ":"Birthdays"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:p?"    ":"Reminders for family members birthdays"})]}),a.jsx(ge,{variant:g.notifications.birthdays?"default":"outline",size:e?"icon":"sm",onClick:()=>v("notifications","birthdays",!g.notifications.birthdays),title:e?g.notifications.birthdays?p?"":"On":p?"":"Off":void 0,children:e?g.notifications.birthdays?p?"":"ON":p?"":"OFF":g.notifications.birthdays?p?"":"On":p?"":"Off"})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:p?" ":"Anniversaries"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:p?"   ":"Reminders for important anniversaries"})]}),a.jsx(ge,{variant:g.notifications.anniversaries?"default":"outline",size:e?"icon":"sm",onClick:()=>v("notifications","anniversaries",!g.notifications.anniversaries),title:e?g.notifications.anniversaries?p?"":"On":p?"":"Off":void 0,children:e?g.notifications.anniversaries?p?"":"ON":p?"":"OFF":g.notifications.anniversaries?p?"":"On":p?"":"Off"})]})]})]})]}),d==="privacy"&&a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsxs(yt,{className:"flex items-center gap-2",children:[a.jsx(v0,{className:"h-5 w-5"}),p?" ":"Privacy Settings"]})}),a.jsxs(tt,{className:"space-y-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:p?"  ":"Profile Visibility"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:p?"    ":"Who can see your profile"})]}),a.jsxs("select",{value:g.privacy.profileVisibility,onChange:O=>v("privacy","profileVisibility",O.target.value),className:"px-3 py-2 border border-input rounded-md bg-background",children:[a.jsx("option",{value:"public",children:p?"":"Public"}),a.jsx("option",{value:"family",children:p?" ":"Family Only"}),a.jsx("option",{value:"private",children:p?"":"Private"})]})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:p?" ":"Allow Search"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:p?"     ":"Allow others to find you in search"})]}),a.jsx(ge,{variant:g.privacy.allowSearch?"default":"outline",size:e?"icon":"sm",onClick:()=>v("privacy","allowSearch",!g.privacy.allowSearch),title:e?g.privacy.allowSearch?p?"":"Allowed":p?"":"Blocked":void 0,children:e?g.privacy.allowSearch?p?"":"ON":p?"":"OFF":g.privacy.allowSearch?p?"":"Allowed":p?"":"Blocked"})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:p?"  ":"Show Online Status"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:p?"      ":"Show whether you are online or not"})]}),a.jsxs(ge,{variant:g.privacy.showOnlineStatus?"default":"outline",size:e?"icon":"sm",onClick:()=>v("privacy","showOnlineStatus",!g.privacy.showOnlineStatus),className:"flex items-center gap-2",title:e?g.privacy.showOnlineStatus?p?"":"Visible":p?"":"Hidden":void 0,children:[g.privacy.showOnlineStatus?a.jsx(ra,{className:"h-4 w-4"}):a.jsx(oj,{className:"h-4 w-4"}),!e&&(g.privacy.showOnlineStatus?p?"":"Visible":p?"":"Hidden")]})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:p?"  ":"Allow Direct Messages"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:p?"     ":"Allow others to send you direct messages"})]}),a.jsx(ge,{variant:g.privacy.allowDirectMessages?"default":"outline",size:e?"icon":"sm",onClick:()=>v("privacy","allowDirectMessages",!g.privacy.allowDirectMessages),title:e?g.privacy.allowDirectMessages?p?"":"Allowed":p?"":"Blocked":void 0,children:e?g.privacy.allowDirectMessages?p?"":"ON":p?"":"OFF":g.privacy.allowDirectMessages?p?"":"Allowed":p?"":"Blocked"})]})]}),a.jsx("div",{className:"p-4 bg-secondary/50 rounded-lg",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(ju,{className:"h-5 w-5 text-primary mt-0.5"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-sm",children:p?" ":"Privacy Information"}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:p?"     .       .":"We respect your privacy and protect your personal data. You can change these settings at any time."})]})]})})]})]}),d==="display"&&a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsxs(yt,{className:"flex items-center gap-2",children:[a.jsx(t5,{className:"h-5 w-5"}),p?" ":"Display Settings"]})}),a.jsx(tt,{className:"space-y-6",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:p?" ":"Date Format"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:p?"   ":"Choose how dates are displayed"})]}),a.jsxs("select",{value:g.display.dateFormat,onChange:O=>v("display","dateFormat",O.target.value),className:"px-3 py-2 border border-input rounded-md bg-background",children:[a.jsx("option",{value:"dd/mm/yyyy",children:"DD/MM/YYYY"}),a.jsx("option",{value:"mm/dd/yyyy",children:"MM/DD/YYYY"}),a.jsx("option",{value:"yyyy-mm-dd",children:"YYYY-MM-DD"})]})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:p?" ":"Time Format"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:p?"   ":"Choose how time is displayed"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(ge,{variant:g.display.timeFormat==="12h"?"default":"outline",size:e?"icon":"sm",onClick:()=>v("display","timeFormat","12h"),title:e?"12h":void 0,children:[e?"12":"12h"," "]}),a.jsxs(ge,{variant:g.display.timeFormat==="24h"?"default":"outline",size:e?"icon":"sm",onClick:()=>v("display","timeFormat","24h"),title:e?"24h":void 0,children:[e?"24":"24h"," "]})]})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:p?" ":"Font Size"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:p?"   ":"Choose your preferred font size"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(ge,{variant:g.display.fontSize==="small"?"default":"outline",size:e?"icon":"sm",onClick:()=>v("display","fontSize","small"),title:e?p?"":"Small":void 0,children:[e?p?"":"S":p?"":"Small"," "]}),a.jsxs(ge,{variant:g.display.fontSize==="medium"?"default":"outline",size:e?"icon":"sm",onClick:()=>v("display","fontSize","medium"),title:e?p?"":"Medium":void 0,children:[e?p?"":"M":p?"":"Medium"," "]}),a.jsxs(ge,{variant:g.display.fontSize==="large"?"default":"outline",size:e?"icon":"sm",onClick:()=>v("display","fontSize","large"),title:e?p?"":"Large":void 0,children:[e?p?"":"L":p?"":"Large"," "]})]})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:p?" ":"Compact Mode"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:p?"      ":"Show more content in less space"})]}),a.jsx(ge,{variant:g.display.compactMode?"default":"outline",size:e?"icon":"sm",onClick:()=>v("display","compactMode",!g.display.compactMode),title:e?g.display.compactMode?p?"":"On":p?"":"Off":void 0,children:e?g.display.compactMode?p?"":"ON":p?"":"OFF":g.display.compactMode?p?"":"On":p?"":"Off"})]})]})})]}),d==="backup"&&a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsxs(yt,{className:"flex items-center gap-2",children:[a.jsx(TI,{className:"h-5 w-5"}),p?"  ":"Backup & Sync"]})}),a.jsxs(tt,{className:"space-y-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:p?"  ":"Auto Backup"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:p?"     ":"Automatically create backups of your data"})]}),a.jsx(ge,{variant:g.backup.autoBackup?"default":"outline",size:e?"icon":"sm",onClick:()=>v("backup","autoBackup",!g.backup.autoBackup),title:e?g.backup.autoBackup?p?"":"On":p?"":"Off":void 0,children:e?g.backup.autoBackup?p?"":"ON":p?"":"OFF":g.backup.autoBackup?p?"":"On":p?"":"Off"})]}),g.backup.autoBackup&&a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:p?"  ":"Backup Frequency"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:p?"     ":"How often backups are created"})]}),a.jsxs("select",{value:g.backup.backupFrequency,onChange:O=>v("backup","backupFrequency",O.target.value),className:"px-3 py-2 border border-input rounded-md bg-background",children:[a.jsx("option",{value:"daily",children:p?"":"Daily"}),a.jsx("option",{value:"weekly",children:p?"":"Weekly"}),a.jsx("option",{value:"monthly",children:p?"":"Monthly"})]})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:p?" ":"Cloud Sync"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:p?"    ":"Sync data with cloud storage"})]}),a.jsxs(ge,{variant:g.backup.cloudSync?"default":"outline",size:e?"icon":"sm",onClick:()=>v("backup","cloudSync",!g.backup.cloudSync),className:"flex items-center gap-2",title:e?g.backup.cloudSync?p?"":"On":p?"":"Off":void 0,children:[a.jsx(II,{className:"h-4 w-4"}),!e&&(g.backup.cloudSync?p?"":"On":p?"":"Off")]})]})]}),a.jsxs("div",{className:"border-t pt-6 space-y-4",children:[a.jsx("h3",{className:"font-medium",children:p?" ":"Data Management"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs(ge,{variant:"outline",onClick:M,className:"flex items-center gap-2 h-auto p-4",size:e?"icon":"default",children:[a.jsx(ry,{className:"h-5 w-5"}),!e&&a.jsxs("div",{className:"text-left",children:[a.jsx("p",{className:"font-medium",children:p?" ":"Export Data"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:p?"    ":"Download a copy of all your data"})]})]}),a.jsxs(ge,{variant:"outline",onClick:S,className:"flex items-center gap-2 h-auto p-4",size:e?"icon":"default",children:[a.jsx(KI,{className:"h-5 w-5"}),!e&&a.jsxs("div",{className:"text-left",children:[a.jsx("p",{className:"font-medium",children:p?" ":"Import Data"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:p?"    ":"Upload and import data from file"})]})]})]}),a.jsx("div",{className:"p-4 bg-secondary/50 rounded-lg",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx($I,{className:"h-5 w-5 text-primary mt-0.5"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-sm",children:p?" ":"Storage Information"}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:p?" : 2.3   10 ":"Used space: 2.3 GB of 10 GB"}),a.jsx("div",{className:"w-full bg-secondary rounded-full h-2 mt-2",children:a.jsx("div",{className:"bg-primary h-2 rounded-full",style:{width:"23%"}})})]})]})})]})]})]}),d==="account"&&a.jsxs("div",{className:"space-y-6",children:[a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsxs(yt,{className:"flex items-center gap-2",children:[a.jsx(sn,{className:"h-5 w-5"}),p?" ":"Account Information"]})}),a.jsx(tt,{className:"space-y-4",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:p?" ":"Full Name"}),a.jsx(Kt,{value:`${(o==null?void 0:o.firstName)||""} ${(o==null?void 0:o.lastName)||""}`,disabled:!0,className:"bg-secondary/50"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:p?" ":"Email"}),a.jsx(Kt,{value:(o==null?void 0:o.email)||"",disabled:!0,className:"bg-secondary/50"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:p?" ":"Phone Number"}),a.jsx(Kt,{value:(o==null?void 0:o.phone)||"",disabled:!0,className:"bg-secondary/50"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:p?" ":"Join Date"}),a.jsx(Kt,{value:o!=null&&o.createdAt?new Date(o.createdAt).toLocaleDateString():"",disabled:!0,className:"bg-secondary/50"})]})]})})]}),a.jsxs(Qe,{className:"border-destructive/20",children:[a.jsx(xt,{children:a.jsxs(yt,{className:"flex items-center gap-2 text-destructive",children:[a.jsx(fo,{className:"h-5 w-5"}),p?" ":"Danger Zone"]})}),a.jsxs(tt,{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-destructive",children:p?"  ":"Reset Settings"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:p?"     ":"Reset all settings to default values"})]}),a.jsxs(ge,{variant:"outline",onClick:U,className:"flex items-center gap-2",size:e?"icon":"default",children:[a.jsx(po,{className:"h-4 w-4"}),!e&&(p?" ":"Reset")]})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium text-destructive",children:p?" ":"Delete Account"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:p?"    ":"Permanently delete account and all data"})]}),a.jsxs(ge,{variant:"destructive",className:"flex items-center gap-2",size:e?"icon":"default",children:[a.jsx(Ia,{className:"h-4 w-4"}),!e&&(p?" ":"Delete Account")]})]})]})]})]}),m&&a.jsxs("div",{className:"fixed bottom-4 left-1/2 transform -translate-x-1/2 bg-primary text-primary-foreground px-6 py-3 rounded-lg shadow-lg flex items-center gap-3",children:[a.jsx(ju,{className:"h-5 w-5"}),a.jsx("span",{children:p?"   ":"You have unsaved changes"}),a.jsx(ge,{variant:"secondary",size:e?"icon":"sm",onClick:P,disabled:x,className:"flex items-center gap-2",children:x?a.jsx(wr,{className:"h-4 w-4 animate-spin"}):a.jsxs(a.Fragment,{children:[a.jsx(Au,{className:"h-4 w-4"}),!e&&(p?"":"Save")," "]})})]})]})},vee=()=>{var M,S,C;const{user:e,updateProfile:t,uploadAvatar:n,deleteAvatar:r}=Pr(),{language:s}=Xt(),{success:i,error:l}=mj();Ir();const[o,c]=Y.useState(!1),[u,d]=Y.useState(!1),[f,m]=Y.useState({firstName:(e==null?void 0:e.firstName)||"",lastName:(e==null?void 0:e.lastName)||"",email:(e==null?void 0:e.email)||"",phone:(e==null?void 0:e.phone)||"",country:(e==null?void 0:e.country)||"",city:(e==null?void 0:e.city)||"",dateOfBirth:(e==null?void 0:e.dateOfBirth)||"",gender:(e==null?void 0:e.gender)||"",bio:""}),[h,x]=Y.useState(null),[y,p]=Y.useState(null),g=s==="ar";we.useEffect(()=>{e&&m({firstName:e.firstName||"",lastName:e.lastName||"",email:e.email||"",phone:e.phone||"",country:e.country||"",city:e.city||"",dateOfBirth:e.dateOfBirth||"",gender:e.gender||"",bio:""})},[e]);const w=_=>{const{name:T,value:B}=_.target;m($=>({...$,[T]:B}))},v=_=>{var B;const T=(B=_.target.files)==null?void 0:B[0];if(T){if(T.size>5*1024*1024){l({en:"File size exceeds 5MB limit",ar:"      5 "});return}p(T);const $=new FileReader;$.onloadend=()=>{x($.result)},$.readAsDataURL(T)}},N=()=>{x(null),p(null),e!=null&&e.avatar&&x(null)},A=async()=>{var _,T,B,$;d(!0);try{const D={firstName:f.firstName,lastName:f.lastName,phone:f.phone||void 0,country:f.country||void 0,city:f.city||void 0,dateOfBirth:f.dateOfBirth||void 0,gender:f.gender&&f.gender!==""?f.gender:void 0};await t(D),y&&await n(y),c(!1),i({en:"Profile updated successfully",ar:"    "})}catch(D){console.error("Profile update error:",D);let L=D.message||"Unknown error";((_=D.response)==null?void 0:_.status)===405?L="Profile update method not allowed. Please contact support.":((T=D.response)==null?void 0:T.status)===400?L="Invalid profile data. Please check your inputs.":((B=D.response)==null?void 0:B.status)===401?L="Authentication required. Please log in again.":(($=D.response)==null?void 0:$.status)===500&&(L="Server error. Please try again later."),l({en:"Failed to update profile: "+L,ar:"    : "+L})}finally{d(!1)}},P=()=>{e&&m({firstName:e.firstName||"",lastName:e.lastName||"",email:e.email||"",phone:e.phone||"",country:e.country||"",city:e.city||"",dateOfBirth:e.dateOfBirth||"",gender:e.gender||"",bio:""}),x(null),p(null),c(!1)},U=_=>_?new Date(_).toLocaleDateString(s==="ar"?"ar-SA":"en-US"):"";return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-2xl font-bold text-foreground",children:g?" ":"Profile"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:g?"   ":"Manage your account information"})]}),!o&&a.jsxs(ge,{onClick:()=>c(!0),className:"flex items-center gap-2",children:[a.jsx(sa,{className:"h-4 w-4"}),g?"":"Edit"]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[a.jsx("div",{className:"lg:col-span-1",children:a.jsx(Qe,{children:a.jsx(tt,{className:"p-6",children:a.jsxs("div",{className:"flex flex-col items-center space-y-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"relative",children:o?a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"w-24 h-24 rounded-full bg-secondary flex items-center justify-center overflow-hidden",children:h?a.jsx("img",{src:h,alt:"Preview",className:"w-full h-full object-cover"}):(M=e==null?void 0:e.avatar)!=null&&M.url?a.jsx("img",{src:e.avatar.url,alt:e.firstName,className:"w-full h-full object-cover"}):a.jsx(sn,{className:"h-12 w-12 text-muted-foreground"})}),a.jsxs("label",{className:"absolute bottom-0 right-0 bg-primary rounded-full p-2 cursor-pointer shadow-md hover:bg-primary/90 transition-colors",children:[a.jsx(dh,{className:"h-4 w-4 text-primary-foreground"}),a.jsx("input",{type:"file",accept:"image/*",className:"hidden",onChange:v})]})]}):a.jsx("div",{className:"w-24 h-24 rounded-full bg-secondary flex items-center justify-center overflow-hidden",children:(S=e==null?void 0:e.avatar)!=null&&S.url?a.jsx("img",{src:e.avatar.url,alt:e.firstName,className:"w-full h-full object-cover"}):a.jsx(sn,{className:"h-12 w-12 text-muted-foreground"})})}),o&&(h||((C=e==null?void 0:e.avatar)==null?void 0:C.url))&&a.jsx("button",{onClick:N,className:"absolute -top-2 -right-2 bg-destructive rounded-full p-1 shadow-md hover:bg-destructive/90 transition-colors",children:a.jsx(ia,{className:"h-3 w-3 text-destructive-foreground"})})]}),a.jsxs("div",{className:"text-center space-y-1",children:[a.jsxs("h2",{className:"text-xl font-semibold",children:[e==null?void 0:e.firstName," ",e==null?void 0:e.lastName]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:e==null?void 0:e.email}),(e==null?void 0:e.country)&&a.jsxs("div",{className:"flex items-center justify-center gap-1 text-sm text-muted-foreground",children:[a.jsx(ai,{className:"h-4 w-4"}),a.jsxs("span",{children:[e.country,e.city?`, ${e.city}`:""]})]})]})]})})})}),a.jsx("div",{className:"lg:col-span-2",children:a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsxs(yt,{className:"flex items-center gap-2",children:[a.jsx(sn,{className:"h-5 w-5"}),g?" ":"Account Information"]})}),a.jsx(tt,{className:"space-y-6",children:o?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:g?" ":"First Name"}),a.jsx(Kt,{name:"firstName",value:f.firstName,onChange:w,placeholder:g?" ":"First Name"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:g?" ":"Last Name"}),a.jsx(Kt,{name:"lastName",value:f.lastName,onChange:w,placeholder:g?" ":"Last Name"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:g?" ":"Email"}),a.jsx(Kt,{name:"email",value:f.email,onChange:w,disabled:!0,className:"bg-secondary/50"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:g?"    ":"Email cannot be changed"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:g?" ":"Phone Number"}),a.jsx(Kt,{name:"phone",value:f.phone,onChange:w,placeholder:g?" ":"Phone Number"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:g?" ":"Date of Birth"}),a.jsx(Kt,{name:"dateOfBirth",type:"date",value:f.dateOfBirth,onChange:w})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:g?"":"Country"}),a.jsx(Kt,{name:"country",value:f.country,onChange:w,placeholder:g?"":"Country"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:g?"":"City"}),a.jsx(Kt,{name:"city",value:f.city,onChange:w,placeholder:g?"":"City"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:g?"":"Gender"}),a.jsxs("select",{name:"gender",value:f.gender,onChange:_=>m(T=>({...T,gender:_.target.value})),className:"w-full px-3 py-2 border border-input rounded-md bg-background",children:[a.jsx("option",{value:"",children:g?"":"Select"}),a.jsx("option",{value:"male",children:g?"":"Male"}),a.jsx("option",{value:"female",children:g?"":"Female"}),a.jsx("option",{value:"other",children:g?"":"Other"})]})]}),a.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[a.jsxs(ge,{variant:"outline",onClick:P,disabled:u,className:"flex items-center gap-2",children:[a.jsx(ia,{className:"h-4 w-4"}),g?"":"Cancel"]}),a.jsxs(ge,{onClick:A,disabled:u,className:"flex items-center gap-2",children:[u?a.jsx(wr,{className:"h-4 w-4 animate-spin"}):a.jsx(Au,{className:"h-4 w-4"}),g?" ":"Save Changes"]})]})]}):a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:g?" ":"First Name"}),a.jsx("p",{children:(e==null?void 0:e.firstName)||"-"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:g?" ":"Last Name"}),a.jsx("p",{children:(e==null?void 0:e.lastName)||"-"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:g?" ":"Email"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Pa,{className:"h-4 w-4 text-muted-foreground"}),a.jsx("p",{children:(e==null?void 0:e.email)||"-"})]})]}),(e==null?void 0:e.phone)&&a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:g?" ":"Phone Number"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Su,{className:"h-4 w-4 text-muted-foreground"}),a.jsx("p",{children:e.phone})]})]}),((e==null?void 0:e.country)||(e==null?void 0:e.city))&&a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:g?"":"Address"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ai,{className:"h-4 w-4 text-muted-foreground"}),a.jsx("p",{children:e!=null&&e.country||e!=null&&e.city?`${e.country||""}${e.city?`, ${e.city}`:""}`:g?" ":"Not set"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:g?"":"Gender"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(mo,{className:"h-4 w-4 text-muted-foreground"}),a.jsx("p",{children:e!=null&&e.gender?e.gender==="male"?g?"":"Male":e.gender==="female"?g?"":"Female":g?"":"Other":g?" ":"Not set"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:g?" ":"Join Date"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ur,{className:"h-4 w-4 text-muted-foreground"}),a.jsx("p",{children:e!=null&&e.createdAt?U(e.createdAt):"-"})]})]})]})})]})})]})]})},wee=()=>{const{language:e}=Xt(),t=e==="ar",n=[{icon:Qn,titleAr:"  ",titleEn:"Interactive Family Tree",descriptionAr:"            ",descriptionEn:"Create beautiful and interactive family trees with real tree design, connecting lines and distinctive colors",category:"core"},{icon:In,titleAr:" ",titleEn:"Member Management",descriptionAr:"           ",descriptionEn:"Add family members with detailed information, photos, birth and death dates, and family relationships",category:"core"},{icon:Qi,titleAr:" vanced",titleEn:"Advanced Search",descriptionAr:"            ",descriptionEn:"Search all family members by name, birth date, location, or any other information",category:"search"},{icon:fh,titleAr:" ",titleEn:"Sharing & Collaboration",descriptionAr:"           ",descriptionEn:"Share family trees with relatives and allow them to contribute information and photos",category:"social"},{icon:lj,titleAr:" ",titleEn:"Bilingual Support",descriptionAr:"          ",descriptionEn:"Complete interface in Arabic and English with right-to-left writing support",category:"language"},{icon:YI,titleAr:"  ",titleEn:"Mobile Friendly",descriptionAr:"          ",descriptionEn:"Works perfectly on smartphones and tablets with responsive design",category:"mobile"},{icon:v0,titleAr:" ",titleEn:"Security & Privacy",descriptionAr:"         ",descriptionEn:"High data protection with advanced encryption and customizable privacy settings",category:"security"}],r=[{id:"core",nameAr:" ",nameEn:"Core Features",color:"bg-blue-500"},{id:"search",nameAr:"",nameEn:"Search",color:"bg-purple-500"},{id:"social",nameAr:"",nameEn:"Collaboration",color:"bg-pink-500"},{id:"language",nameAr:"",nameEn:"Language",color:"bg-indigo-500"},{id:"mobile",nameAr:"",nameEn:"Mobile",color:"bg-teal-500"},{id:"security",nameAr:"",nameEn:"Security",color:"bg-red-500"}],s=i=>r.find(l=>l.id===i);return a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-blue-50 dark:from-gray-900 dark:to-gray-800",children:[a.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-r from-green-600 to-blue-600 text-white",children:[a.jsx("div",{className:"absolute inset-0 bg-black/20"}),a.jsx("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-24",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h1",{className:"text-4xl md:text-6xl font-bold mb-6",children:t?" ":"Nasabna Features"}),a.jsx("p",{className:"text-xl md:text-2xl mb-8 max-w-3xl mx-auto opacity-90",children:t?"             ":"Discover all the powerful features that make creating and managing your family tree an enjoyable and easy experience"}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[a.jsx(ge,{asChild:!0,size:"lg",className:"bg-primary text-primary-foreground hover:bg-primary/90",children:a.jsxs(It,{to:"/register",children:[t?" ":"Start Free",a.jsx(Zi,{className:"ml-2 h-5 w-5"})]})}),a.jsx(ge,{asChild:!0,variant:"outline",size:"lg",className:"border-primary text-primary hover:bg-primary/10",children:a.jsx(It,{to:"/pricing",children:t?" ":"View Plans"})})]})]})})]}),a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16",children:[a.jsxs("div",{className:"text-center mb-16",children:[a.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-4",children:t?"    ":"Comprehensive Features to Preserve Your Family Heritage"}),a.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-300 max-w-3xl mx-auto",children:t?"                ":"We provide all the tools you need to create a detailed and beautiful family tree that preserves your family history for future generations"})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:n.map((i,l)=>{const o=i.icon,c=s(i.category);return a.jsxs(Qe,{className:"group hover:shadow-xl transition-all duration-300 hover:-translate-y-2 border-0 shadow-lg",children:[a.jsxs(xt,{className:"text-center pb-4",children:[a.jsxs("div",{className:"mx-auto mb-4 relative",children:[a.jsx("div",{className:`w-16 h-16 rounded-full ${c==null?void 0:c.color} flex items-center justify-center group-hover:scale-110 transition-transform duration-300`,children:a.jsx(o,{className:"h-8 w-8 text-white"})}),a.jsx(er,{variant:"secondary",className:"absolute -bottom-2 left-1/2 transform -translate-x-1/2 text-xs",children:t?c==null?void 0:c.nameAr:c==null?void 0:c.nameEn})]}),a.jsx(yt,{className:"text-xl font-bold text-gray-900 dark:text-white",children:t?i.titleAr:i.titleEn})]}),a.jsx(tt,{children:a.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-center leading-relaxed",children:t?i.descriptionAr:i.descriptionEn})})]},l)})})]}),a.jsx("div",{className:"bg-gradient-to-r from-green-600 to-blue-600 text-white",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:"text-3xl md:text-4xl font-bold mb-6",children:t?"  ":"Ready to Start Your Journey?"}),a.jsx("p",{className:"text-xl mb-8 max-w-2xl mx-auto opacity-90",children:t?"      Nasabna   ":"Join thousands of families using Nasabna to preserve their family heritage"}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[a.jsx(ge,{asChild:!0,size:"lg",className:"bg-primary text-primary-foreground hover:bg-primary/90",children:a.jsxs(It,{to:"/register",children:[a.jsx(dj,{className:"mr-2 h-5 w-5"}),t?"  ":"Start Free Now"]})}),a.jsx(ge,{asChild:!0,variant:"outline",size:"lg",className:"border-primary text-primary hover:bg-primary/10",children:a.jsx(It,{to:"/about",children:t?"  ":"Learn More About Us"})})]})]})})}),a.jsx("div",{className:"bg-white dark:bg-gray-900 py-16",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-8 text-center",children:[a.jsxs("div",{children:[a.jsx("div",{className:"text-4xl font-bold text-green-600 mb-2",children:"7"}),a.jsx("div",{className:"text-gray-600 dark:text-gray-300",children:t?" ":"Powerful Features"})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-4xl font-bold text-blue-600 mb-2",children:"2"}),a.jsx("div",{className:"text-gray-600 dark:text-gray-300",children:t?" ":"Supported Languages"})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-4xl font-bold text-purple-600 mb-2",children:"100%"}),a.jsx("div",{className:"text-gray-600 dark:text-gray-300",children:t?"  ":"Mobile Compatible"})]}),a.jsxs("div",{children:[a.jsx("div",{className:"text-4xl font-bold text-orange-600 mb-2",children:"24/hr"}),a.jsx("div",{className:"text-gray-600 dark:text-gray-300",children:t?" ":"Technical Support"})]})]})})})]})},Nee="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQACWAJYAAD/2wBDAAgGBgcGBQgHBwcJCQgKDBQNDAsLDBkSEw8UHRofHh0aHBwgJC4nICIsIxwcKDcpLDAxNDQ0Hyc5PTgyPC4zNDL/wgALCAGQAZABAREA/8QAHAABAAMAAwEBAAAAAAAAAAAAAAYHCAEEBQMC/9oACAEBAAAAAL/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAH5hcRS6afoAAAAAACE5miHDmX6ZmwAAAAAAQTI/TB3NcTsAAAAAA+OKo2Akm1fsAAAAAArHJwA1jZwAAAAADPlBgC/NBgAAAAAM7USAL20SAAAAAAp7MIA09cIAAAAADy8R9AB39ueoAAAAAAUtmrgHOlbpAAAAAAHFIZ4647Gh7v5AAAAAAB4FSRBL7b98AAAAAAAAAAAAAAAPz1nZ/QAAAAAAOI5UlcxXou9KrGtuR8gAAAAAeLnap/mA+lsaJ9oAAAAAcV1lrywAepqWxeQAAAAFYZW+AAD76ps8AAAACIY66gAA7exZeAAAAHyxvDQAATLZP0AAAAFSZbAAAaktsAAAA4x1BgAAE62JyAAAA8bDn4AAAfvcfsgAAAKyyaAAANZWaAAAApLNoAAA0ldoAAACGQcAAATiZgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAf//EAD4QAAEDAgIECggFBAMBAAAAAAECAwQFEQAGBxIhMQgYQVBRVWFxktEiMEBCgZGhsRMUIzLBIFJignKQ4RD/2gAIAQEAAT8A/wCm5a0NoK1rSlIFypRsBit6WMmUJa2pFZaeeTsLcYF0g9GzZ9cSeEblltRDFNqLw6bJT9ziNwjcsuKAfptRZHTZKvscUTSxkyurQ1HrLTLytzckFok/HZ9cIWhxAWhSVJIuFJNwebM+6SqNkaLaQr8zUFpu1EbPpHtV0DGbtJeY84PLE2YtmIT6MRhRS2B2/wB3xwTf/wCg2xlHSXmTJ7yBCmreiX9KI+oqbI7P7fhjIWkqj55i2jq/LVBCbuxHD6Q7U9I5q0naQmMi0PWb1XKnJBTGZPJ/mewfXFTqUyr1B6dPfW/JeUVLcWbkn+umVOZSagzOgSFsSWVBSHEGxBxox0hMZ6oes5qt1OMAmSyOX/Mdh+nNEuUzBhvSpCwhllBcWo8gAucZ5zXIzjmmXVXlH8JStRhs+42P2j+fU5FzW/k7NMSqsqP4aVaj6B77Z/cP5xElMzYbMqOsLZeQFoUNxBFxzPp1rqqPo9djtL1Xag6I+zfq71fQW+Pq9BVdVWNHrUZ1es9T3VRzffq70/Q2+HM/CUlq/MUGHf0Ql10jtuB6vg1y1fmK9Dv6JS06B23I5n4SjChVaE/Y6pYcRftuD6vg1sKNUrz9vRDLaL9tyeZ+ERR1TcmRKk2m6oMka5HIlYt97er4O9HVCyZLqTibKnSTqE8qUC33vzPmGjM5hoE6kyB+nKZU2T0HkPwNsVilyqJVpVMmIKJEZwtrB7OX1NHpcqt1aLTIaCuRJcDaAO3lxl6jM5eoEGkxx+nFZS3fpI3n4m/NGm/RuutxTmWkslU6Oi0lpI2utjlA5SPthQ1TY7/60jWNhvxoQ0brokUZlqzJTOkItGaUNrTZ5SOQn7c0kAi1hjSboSTVHXq1lhtDctV1PQtyXD0o6D2YmwJdNluRZsd2O+2bKbdSUqB7v6YUCXUpbcWFHdkPuGyW20lRPwxoy0JJpbrNazO2hyWmymYW9LZ6V9J7MAAC1hzXmPJdAzWx+HV6c0+q1kugarie5Q24rfBwZUpTlDramwdzUtGsB/snyxJ4Puc2l2ZNPfHSl+33GI3B9zm6uzxp7A6VP3+wxRODgylSXK5W1OAb2oiNUH/ZXljLmS6BlRj8OkU5phVrKdI1nFd6jt5vti3N98KWhAutQSO02wuqU9s2XOjJPa6kfzhFUp7hsidGUex1J/nCVoWLoUFDsN8X5qJtjMefMt5UbJq1TZbdtcMIOu4f9RtxX+EdtU3QKPs3B6Wr66o88VbTBnerKUF1lcZB9yKkNj5jb9cSq5VpyiqVU5jxO/8AEeUf5wXFKN1KJPacBxSTdKiD2HEWuVaCoKi1OYyRu/DeUP5xSdMOd6SUhFZXJQPclJDg+Z2/XFA4R21Ldfo+zcXoivrqnzxlzPmW81tg0mpsuO2uWFnUcH+p24BvzNmXNVHypTjNq8xDCPdRvWs9CRvOM66dq1XFORKHrUyCdmuk/rLHafd+Hzw8+7IdU686txxRupa1Ek95PqWX3Y7qXWXVtuJN0rQogjuIxkrTtWqGpuJXNapwRs11H9ZA7D73x+eMtZqo+a6cJtImIfR7yNy0HoUN45jJtjSRpWp2SY6okbUl1hafQYv6LXavo7sV7MVUzLU3KhVZbkh9Z947EjoSOQetoOYqplqpt1ClS3I76D7p2KHQocoxo30rU7O0dMSTqRKwhPpsX9F3tR092Ab8w6WNKLWToRptOUlytPp2DeGEn3j29AxMmSJ0t2TKeW8+6oqW4s3KifXw5kiDLakxXlsvtKCkOINikjGifSi1nGEKbUVJbrTCdo3B9I94dvSOYNImeIuRstOTV6q5jt24rJP719PcN5xU6lLq9SfqE55T0l9ZW4tXKT7DTKlLpFSYqEF5TMlhYW2tPIRjR3niLnnLTc1GqiY1ZuUyD+xfT3HePbn324zK3nlhDTaSpajuAG840l50dzrmt+WFEQWSWoiOhAO/vO/2PRpnR3JWa2JZUTBeIalo6UE7+8b8MPtyWW3mVBbbiQpCgdhB2g+26es2mi5URR4zmrLqZKVWO1LQ/d89g+fsugXNprWVF0eS5rS6YQlNztU0f2/LaPl7YcaW8xnMekKoOpXrR4qvyrPRZOwn4m/suiTMhy5pCp7ql6seUr8q9t2WVsB+Btge15sqwoeU6rUybGPGWtP/ACtYfW2HVqddW4s3UslRPST7K0tTTqHEGykEKSegjGU6sK5lOlVMG5kRkLV/ytt+t/a9PFRMLRnIZSbKlvts94vrH7YPsoxoHqBm6M47KjdUV9xnuF9Yff2vhIyCjLVHj32OSlK+Sf8A32YY4N0gry1WI99jctKrd6f/AD2vP2juFpAYhNTZsiMmKpSk/ggHWJAG2/dji20HruoeBHlji20HruoeBHlji20HruoeBHlji20HruoeBHlji20HruoeBHlji20HruoeBHlji20HruoeBHlji20HruoeBHlji20HruoeBHlji20HruoeBHlji20HruoeBHlji20HruoeBHlji20HruoeBHlji20HruoeBHlji20HruoeBHlji20HruoeBHlji20HruoeBHlji20HruoeBHlji20HruoeBHlji20HruoeBHlji20HruoeBHlji20HruoeBHljIOjuFo/jzWYU2RJTLUlSi8ANWwI2W7/+mb//2Q==",jee=()=>{const{language:e}=Xt(),t=e==="ar",n=[{icon:Or,titleAr:" ",titleEn:"Love & Respect",descriptionAr:"       ",descriptionEn:"We believe in the importance of family bonds and mutual respect between generations"},{icon:v0,titleAr:" ",titleEn:"Security & Privacy",descriptionAr:"      ",descriptionEn:"We protect your family data with the highest security and privacy standards"},{icon:BI,titleAr:" ",titleEn:"Innovation & Development",descriptionAr:"      ",descriptionEn:"We continuously develop new technologies to improve user experience"},{icon:In,titleAr:" ",titleEn:"Trust & Transparency",descriptionAr:"         ",descriptionEn:"We build long-term relationships with our customers based on trust and transparency"}],r=[{name:" ",nameEn:"Ahmed Mohammed",role:"  ",roleEn:"Founder & CEO",bio:"        ",bioEn:"Web technology expert with a passion for preserving family heritage"},{name:" ",nameEn:"Fatima Ali",role:" ",roleEn:"Development Manager",bio:"      ",bioEn:"Developer specialized in user interfaces and interactive experience"},{name:" ",nameEn:"Mohammed Khalid",role:" ",roleEn:"Marketing Manager",bio:"      ",bioEn:"Expert in digital marketing and reaching Arabic audiences"}],s=[{year:"2024",titleAr:" ",titleEn:"Nasabna Launch",descriptionAr:"        ",descriptionEn:"Launch of the first Arabic platform specialized in interactive family trees"},{year:"2024",titleAr:" ",titleEn:"Bilingual Support",descriptionAr:"     ",descriptionEn:"Added full support for Arabic and English languages"},{year:"2024",titleAr:" ",titleEn:"Responsive Application",descriptionAr:"      ",descriptionEn:"Developed responsive application that works on all devices"}];return a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-green-50 to-blue-50 dark:from-gray-900 dark:to-gray-800",children:[a.jsxs("div",{className:"relative overflow-hidden bg-gradient-to-r from-green-600 to-blue-600 text-white",children:[a.jsx("div",{className:"absolute inset-0 bg-black/20"}),a.jsx("div",{className:"relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-24",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"flex justify-center mb-6",children:a.jsx("div",{className:"w-20 h-20 bg-white/20 rounded-full flex items-center justify-center",children:a.jsx(Qn,{className:"h-12 w-12 text-white"})})}),a.jsx("h1",{className:"text-4xl md:text-6xl font-bold mb-6",children:t?" ":"About Us"}),a.jsx("p",{className:"text-xl md:text-2xl mb-8 max-w-3xl mx-auto opacity-90",children:t?"              ":"We are a team specialized in developing technologies that help families preserve their heritage and history for future generations"}),a.jsx(ge,{asChild:!0,size:"lg",className:"bg-white text-green-600 hover:bg-gray-100",children:a.jsxs(It,{to:"/contact",children:[a.jsx(Pa,{className:"mr-2 h-5 w-5"}),t?" ":"Contact Us"]})})]})})]}),a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16",children:[a.jsxs("div",{className:"text-center mb-12",children:[a.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-4",children:t?" Nasabna":"Discover Nasabna"}),a.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-300 max-w-2xl mx-auto",children:t?"    Nasabna      ":"See how Nasabna can help you preserve your family heritage"})]}),a.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-xl shadow-xl overflow-hidden max-w-4xl mx-auto",children:a.jsxs("div",{className:"aspect-w-16 aspect-h-9 relative",children:[a.jsx("div",{className:"w-full h-full",children:a.jsxs("video",{controls:!0,className:"w-full h-full object-cover",poster:pj,children:[a.jsx("source",{src:"/videos/intro.mp4",type:"video/mp4"}),t?"    .":"Your browser does not support the video tag."]})}),a.jsx("div",{className:"absolute bottom-4 left-0 right-0 text-center text-white bg-black/50 py-2 mx-4 rounded-lg",children:a.jsx("p",{className:"font-semibold",children:t?"   Nasabna":"Nasabna Introduction Video"})})]})}),a.jsx("div",{className:"text-center mt-8",children:a.jsx(ge,{asChild:!0,size:"lg",children:a.jsxs(It,{to:"/features",children:[t?"  ":"Discover All Features",a.jsx(Zi,{className:`mr-2 h-5 w-5 ${t?"rotate-180":""}`})]})})})]}),a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16",children:a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12",children:[a.jsxs(Qe,{className:"border-0 shadow-xl",children:[a.jsxs(xt,{className:"text-center pb-6",children:[a.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-green-500 to-blue-500 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(ZI,{className:"h-8 w-8 text-white"})}),a.jsx(yt,{className:"text-2xl font-bold text-gray-900 dark:text-white",children:t?"":"Our Mission"})]}),a.jsx(tt,{children:a.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-center leading-relaxed text-lg",children:t?"                          .":"Helping Arabic families preserve their heritage and history through an easy-to-use and secure technology platform that enables them to create beautiful and comprehensive interactive family trees that transfer knowledge and memories across generations."})})]}),a.jsxs(Qe,{className:"border-0 shadow-xl",children:[a.jsxs(xt,{className:"text-center pb-6",children:[a.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(JI,{className:"h-8 w-8 text-white"})}),a.jsx(yt,{className:"text-2xl font-bold text-gray-900 dark:text-white",children:t?"":"Our Vision"})]}),a.jsx(tt,{children:a.jsx("p",{className:"text-gray-600 dark:text-gray-300 text-center leading-relaxed text-lg",children:t?"                     .":"To become the leading platform in the Arab world for preserving family heritage, and contribute to strengthening family bonds and reviving values of authenticity and belonging in Arab communities."})})]})]})}),a.jsx("div",{className:"bg-white dark:bg-gray-900 py-16",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs("div",{className:"text-center mb-12",children:[a.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-4",children:t?"":"Our Values"}),a.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-300 max-w-2xl mx-auto",children:t?"        ":"The values we believe in and that guide our work in serving our customers"})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8",children:n.map((i,l)=>{const o=i.icon;return a.jsxs(Qe,{className:"text-center border-0 shadow-lg hover:shadow-xl transition-shadow duration-300",children:[a.jsxs(xt,{children:[a.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-green-500 to-blue-500 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(o,{className:"h-8 w-8 text-white"})}),a.jsx(yt,{className:"text-xl font-bold text-gray-900 dark:text-white",children:t?i.titleAr:i.titleEn})]}),a.jsx(tt,{children:a.jsx("p",{className:"text-gray-600 dark:text-gray-300 leading-relaxed",children:t?i.descriptionAr:i.descriptionEn})})]},l)})})]})}),a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16",children:[a.jsxs("div",{className:"text-center mb-12",children:[a.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-4",children:t?" ":"Our Team"}),a.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-300 max-w-2xl mx-auto",children:t?"      ":"A specialized and passionate team dedicated to providing the best services to our customers"})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:r.map((i,l)=>a.jsxs(Qe,{className:"text-center border-0 shadow-lg hover:shadow-xl transition-all duration-300 hover:-translate-y-2",children:[a.jsxs(xt,{children:[a.jsx("div",{className:"w-32 h-32 mx-auto mb-4 rounded-full overflow-hidden bg-gray-200",children:a.jsx("img",{src:Nee,alt:t?i.name:i.nameEn,className:"w-full h-full object-cover"})}),a.jsx(yt,{className:"text-xl font-bold text-gray-900 dark:text-white",children:t?i.name:i.nameEn}),a.jsx(er,{variant:"secondary",className:"mx-auto",children:t?i.role:i.roleEn})]}),a.jsx(tt,{children:a.jsx("p",{className:"text-gray-600 dark:text-gray-300 leading-relaxed",children:t?i.bio:i.bioEn})})]},l))})]}),a.jsx("div",{className:"bg-white dark:bg-gray-900 py-16",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs("div",{className:"text-center mb-12",children:[a.jsx("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 dark:text-white mb-4",children:t?"":"Our Journey"}),a.jsx("p",{className:"text-lg text-gray-600 dark:text-gray-300 max-w-2xl mx-auto",children:t?"    ":"Important milestones in developing Nasabna"})]}),a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute left-1/2 transform -translate-x-1/2 w-1 h-full bg-gradient-to-b from-green-500 to-blue-500"}),a.jsx("div",{className:"space-y-12",children:s.map((i,l)=>a.jsxs("div",{className:`flex items-center ${l%2===0?"flex-row":"flex-row-reverse"}`,children:[a.jsx("div",{className:`w-1/2 ${l%2===0?"pr-8 text-right":"pl-8 text-left"}`,children:a.jsxs(Qe,{className:"border-0 shadow-lg",children:[a.jsx(xt,{children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(er,{variant:"default",className:"bg-gradient-to-r from-green-500 to-blue-500",children:i.year}),a.jsx(yt,{className:"text-lg font-bold text-gray-900 dark:text-white",children:t?i.titleAr:i.titleEn})]})}),a.jsx(tt,{children:a.jsx("p",{className:"text-gray-600 dark:text-gray-300",children:t?i.descriptionAr:i.descriptionEn})})]})}),a.jsx("div",{className:"relative z-10",children:a.jsx("div",{className:"w-4 h-4 bg-gradient-to-r from-green-500 to-blue-500 rounded-full border-4 border-white dark:border-gray-900"})}),a.jsx("div",{className:"w-1/2"})]},l))})]})]})}),a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16",children:a.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-8 text-center",children:[a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-lg",children:[a.jsx("div",{className:"text-4xl font-bold text-green-600 mb-2",children:"1000+"}),a.jsx("div",{className:"text-gray-600 dark:text-gray-300",children:t?" ":"Registered Families"})]}),a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-lg",children:[a.jsx("div",{className:"text-4xl font-bold text-blue-600 mb-2",children:"5000+"}),a.jsx("div",{className:"text-gray-600 dark:text-gray-300",children:t?" ":"People Added"})]}),a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-lg",children:[a.jsx("div",{className:"text-4xl font-bold text-purple-600 mb-2",children:"2"}),a.jsx("div",{className:"text-gray-600 dark:text-gray-300",children:t?" ":"Supported Languages"})]}),a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 shadow-lg",children:[a.jsx("div",{className:"text-4xl font-bold text-orange-600 mb-2",children:"24/7"}),a.jsx("div",{className:"text-gray-600 dark:text-gray-300",children:t?" ":"Technical Support"})]})]})}),a.jsx("div",{className:"bg-gradient-to-r from-green-600 to-blue-600 text-white",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:"text-3xl md:text-4xl font-bold mb-6",children:t?"   Nasabna":"Join the Nasabna Family"}),a.jsx("p",{className:"text-xl mb-8 max-w-2xl mx-auto opacity-90",children:t?"      ":"Start your journey in preserving your family heritage today"}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[a.jsx(ge,{asChild:!0,size:"lg",className:"bg-white text-green-600 hover:bg-gray-100",children:a.jsxs(It,{to:"/register",children:[a.jsx(dj,{className:"mr-2 h-5 w-5"}),t?" ":"Start Free"]})}),a.jsx(ge,{asChild:!0,variant:"outline",size:"lg",className:"border-white text-white hover:bg-white hover:text-green-600",children:a.jsxs(It,{to:"/features",children:[t?" ":"Discover Features",a.jsx(Zi,{className:"ml-2 h-5 w-5"})]})})]})]})})})]})},See="/assets/contacts-BSvnWvjy.png",_ee=()=>{const{language:e}=Xt(),t=e==="ar",[n,r]=Y.useState({name:"",email:"",subject:"",message:""}),[s,i]=Y.useState(!1),[l,o]=Y.useState(!1),[c,u]=Y.useState(""),d=h=>{const{name:x,value:y}=h.target;r(p=>({...p,[x]:y}))},f=async h=>{h.preventDefault(),i(!0),u("");try{await new Promise(x=>setTimeout(x,1500)),r({name:"",email:"",subject:"",message:""}),o(!0),setTimeout(()=>o(!1),5e3)}catch{u(t?"    .    .":"An error occurred while sending the message. Please try again.")}finally{i(!1)}},m=[{icon:ai,title:t?"":"Our Address",titleAr:"",content:t?"123      ":"123 Family Street, Riyadh, Saudi Arabia",contentAr:"123      "},{icon:Su,title:t?" ":"Call Us",titleAr:" ",content:"+966 11 123 4567",contentAr:"+966 11 123 4567"},{icon:Pa,title:t?" ":"Email Us",titleAr:" ",content:"support@nasabna.com",contentAr:"support@nasabna.com"},{icon:y0,title:t?" ":"Working Hours",titleAr:" ",content:t?" - : 8  - 5 ":"Sunday - Thursday: 8AM - 5PM",contentAr:" - : 8  - 5 "}];return a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsx("section",{className:"relative py-20 md:py-32 bg-gradient-to-br from-primary/10 via-primary/5 to-background overflow-hidden",children:a.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 relative z-10",children:a.jsxs("div",{className:"text-center max-w-4xl mx-auto",children:[a.jsx("h1",{className:"text-4xl sm:text-5xl lg:text-6xl font-bold text-foreground mb-6",children:t?" ":"Contact Us"}),a.jsx("p",{className:"text-xl text-muted-foreground mb-8 max-w-2xl mx-auto",children:t?"         Nasabna  .":"Have questions or need assistance? The Nasabna support team is here to help."})]})})}),a.jsx("section",{className:"py-16",children:a.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-3xl font-bold text-foreground mb-6",children:t?"  ":"Get In Touch"}),a.jsx("p",{className:"text-lg text-muted-foreground mb-8",children:t?"   .         .":"We appreciate your feedback and inquiries. Feel free to reach out to us through any of the following methods."}),a.jsx("div",{className:"space-y-6",children:m.map((h,x)=>a.jsxs("div",{className:"flex items-start",children:[a.jsx("div",{className:"flex-shrink-0 w-12 h-12 bg-primary/10 rounded-lg flex items-center justify-center mr-4",children:a.jsx(h.icon,{className:"h-6 w-6 text-primary"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold text-foreground mb-1",children:t?h.titleAr:h.title}),a.jsx("p",{className:"text-muted-foreground",children:t?h.contentAr:h.content})]})]},x))}),a.jsx("div",{className:"mt-12",children:a.jsx("img",{src:See,alt:t?" ":"Contact Us",className:"rounded-lg shadow-lg w-full max-w-md mx-auto"})})]}),a.jsx("div",{children:a.jsxs(Qe,{children:[a.jsxs(xt,{children:[a.jsx(yt,{className:"text-2xl",children:t?"  ":"Send Us a Message"}),a.jsx(bs,{children:t?"         .":"Fill out the form below and we'll get back to you as soon as possible."})]}),a.jsx(tt,{children:l?a.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6 text-center",children:[a.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(n5,{className:"h-6 w-6 text-green-600"})}),a.jsx("h3",{className:"text-lg font-semibold text-green-800 mb-2",children:t?"   !":"Message Sent Successfully!"}),a.jsx("p",{className:"text-green-700",children:t?"  .    .":"Thank you for contacting us. We'll get back to you soon."})]}):a.jsxs("form",{onSubmit:f,className:"space-y-6",children:[c&&a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:a.jsx("p",{className:"text-red-700 text-center",children:c})}),a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium text-foreground mb-2",children:[t?" ":"Full Name"," *"]}),a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(sn,{className:"h-5 w-5 text-muted-foreground"})}),a.jsx(Kt,{id:"name",name:"name",value:n.name,onChange:d,placeholder:t?"  ":"Enter your full name",className:"pl-10",required:!0,disabled:s})]})]}),a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"email",className:"block text-sm font-medium text-foreground mb-2",children:[t?" ":"Email Address"," *"]}),a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(Pa,{className:"h-5 w-5 text-muted-foreground"})}),a.jsx(Kt,{id:"email",name:"email",type:"email",value:n.email,onChange:d,placeholder:t?"  ":"Enter your email address",className:"pl-10",required:!0,disabled:s})]})]}),a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"subject",className:"block text-sm font-medium text-foreground mb-2",children:[t?"":"Subject"," *"]}),a.jsx(Kt,{id:"subject",name:"subject",value:n.subject,onChange:d,placeholder:t?"  ":"Enter your message subject",required:!0,disabled:s})]}),a.jsxs("div",{children:[a.jsxs("label",{htmlFor:"message",className:"block text-sm font-medium text-foreground mb-2",children:[t?"":"Message"," *"]}),a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:"absolute top-3 left-3",children:a.jsx(HI,{className:"h-5 w-5 text-muted-foreground"})}),a.jsx(id,{id:"message",name:"message",value:n.message,onChange:d,placeholder:t?"  ...":"Write your message here...",rows:5,className:"pl-10",required:!0,disabled:s})]})]}),a.jsx(ge,{type:"submit",className:"w-full flex items-center justify-center",disabled:s,children:s?a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),t?" ...":"Sending..."]}):a.jsxs(a.Fragment,{children:[a.jsx(n5,{className:`h-4 w-4 ${t?"ml-2":"mr-2"}`}),t?" ":"Send Message"]})})]})})]})})]})})}),a.jsx("section",{className:"py-16 bg-muted/30",children:a.jsxs("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs("div",{className:"text-center mb-12",children:[a.jsx("h2",{className:"text-3xl font-bold text-foreground mb-4",children:t?" ":"Frequently Asked Questions"}),a.jsx("p",{className:"text-lg text-muted-foreground max-w-2xl mx-auto",children:t?"      .":"Here are some frequently asked questions that might help you."})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 max-w-4xl mx-auto",children:[a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsx(yt,{className:"text-lg",children:t?"      ":"How long does it take to reply to my message?"})}),a.jsx(tt,{children:a.jsx("p",{className:"text-muted-foreground",children:t?"       24  .":"We typically respond to all messages within 24 business hours."})})]}),a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsx(yt,{className:"text-lg",children:t?"      ":"Can I get support in Arabic?"})}),a.jsx(tt,{children:a.jsx("p",{className:"text-muted-foreground",children:t?"       .":"Yes, our support team is fluent in both Arabic and English."})})]}),a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsx(yt,{className:"text-lg",children:t?"   ":"Do you offer technical support?"})}),a.jsx(tt,{children:a.jsx("p",{className:"text-muted-foreground",children:t?"         .":"Yes, we have a dedicated technical support team to help with technical issues."})})]}),a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsx(yt,{className:"text-lg",children:t?"      ":"How can I report a website issue?"})}),a.jsx(tt,{children:a.jsx("p",{className:"text-muted-foreground",children:t?"           .":"You can send details of the issue through this contact form, and we'll investigate it immediately."})})]})]})]})})]})},Aee=()=>{const{language:e}=Xt(),t=e==="ar",n={title:t?" ":"Privacy Policy",lastUpdated:t?" : 1  2024":"Last updated: January 1, 2024",introduction:{title:t?"":"Introduction",content:t?" Nasabna      .":"At Nasabna, we are committed to protecting your privacy and personal information."},informationCollection:{title:t?"  ":"Information We Collect",personalInfo:{title:t?" ":"Personal Information",content:t?"        (  )    ":"Full name and email address, Contact information (address, phone number), Account information and user identifiers"},familyTreeInfo:{title:t?"  ":"Family Tree Information",content:t?"           ":"Names and dates of family members, Uploaded photos and documents, Family relationships and lineage"},technicalInfo:{title:t?" ":"Technical Information",content:t?" IP           ":"IP address and browser type, Usage data and activity logs, Cookies and device identifiers"}},informationUse:{title:t?"  ":"How We Use Your Information",content:t?"                   ":"Provide and improve our services, Create and manage your account, Process payments and subscriptions, Send updates and important notifications, Ensure security and prevent fraud, Comply with legal requirements"},informationSharing:{title:t?" ":"Information Sharing",intro:t?"           .      :":"We do not sell, rent, or trade your personal information to third parties. We may share your information in the following cases:",points:t?[" ","   ","  ","   "]:["With your explicit consent","With trusted service providers","To comply with laws and regulations","To protect our rights and user safety"]},dataSecurity:{title:t?" ":"Data Security",content:t?"       :":"We use advanced security measures to protect your personal information:",measures:t?[" SSL/TLS  ","    ","    24 ","    ","  "]:["SSL/TLS encryption for data transmission","Advanced server and infrastructure protection","24/7 security monitoring","Regular secure backups","Strict access controls"]},yourRights:{title:t?"":"Your Rights",content:t?"      :":"You have the following rights regarding your personal information:",rights:t?["   ","   ","  ","  ","  ","  "]:["Access your personal information","Correct or update information","Delete your account and information","Restrict data processing","Data portability","Object to processing"]},contact:{title:t?" ":"Contact Us",content:t?"           :":"If you have any questions about this Privacy Policy, please contact us:",email:"privacy@nasabna.com",address:t?"123     ":"123 Nasabna St, Cultural District, Egypt",phone:"+20 123 456 7890"}};return a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsx("section",{className:"relative py-20 md:py-32 bg-gradient-to-br from-primary/10 via-primary/5 to-background overflow-hidden",children:a.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 relative z-10",children:a.jsxs("div",{className:"text-center max-w-4xl mx-auto",children:[a.jsx("h1",{className:"text-4xl sm:text-5xl lg:text-6xl font-bold text-foreground mb-6",children:n.title}),a.jsx("p",{className:"text-xl text-muted-foreground",children:n.lastUpdated})]})})}),a.jsx("section",{className:"py-16",children:a.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"max-w-4xl mx-auto",children:[a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsx(yt,{className:"text-2xl",children:n.introduction.title})}),a.jsx(tt,{children:a.jsx("p",{className:"text-muted-foreground",children:n.introduction.content})})]}),a.jsxs("div",{className:"mt-8 space-y-8",children:[a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsx(yt,{children:n.informationCollection.title})}),a.jsx(tt,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold mb-2",children:n.informationCollection.personalInfo.title}),a.jsx("p",{className:"text-muted-foreground",children:n.informationCollection.personalInfo.content})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold mb-2",children:n.informationCollection.familyTreeInfo.title}),a.jsx("p",{className:"text-muted-foreground",children:n.informationCollection.familyTreeInfo.content})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold mb-2",children:n.informationCollection.technicalInfo.title}),a.jsx("p",{className:"text-muted-foreground",children:n.informationCollection.technicalInfo.content})]})]})})]}),a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsx(yt,{children:n.informationUse.title})}),a.jsx(tt,{children:a.jsx("p",{className:"text-muted-foreground",children:n.informationUse.content})})]}),a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsx(yt,{children:n.informationSharing.title})}),a.jsxs(tt,{children:[a.jsx("p",{className:"text-muted-foreground mb-4",children:n.informationSharing.intro}),a.jsx("ul",{className:"list-disc list-inside space-y-2 text-muted-foreground",children:n.informationSharing.points.map((r,s)=>a.jsx("li",{children:r},s))})]})]}),a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsx(yt,{children:n.dataSecurity.title})}),a.jsxs(tt,{children:[a.jsx("p",{className:"text-muted-foreground mb-4",children:n.dataSecurity.content}),a.jsx("ul",{className:"list-disc list-inside space-y-2 text-muted-foreground",children:n.dataSecurity.measures.map((r,s)=>a.jsx("li",{children:r},s))})]})]}),a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsx(yt,{children:n.yourRights.title})}),a.jsxs(tt,{children:[a.jsx("p",{className:"text-muted-foreground mb-4",children:n.yourRights.content}),a.jsx("ul",{className:"list-disc list-inside space-y-2 text-muted-foreground",children:n.yourRights.rights.map((r,s)=>a.jsx("li",{children:r},s))})]})]}),a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsx(yt,{children:n.contact.title})}),a.jsxs(tt,{children:[a.jsx("p",{className:"text-muted-foreground mb-4",children:n.contact.content}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:t?" :":"Email:"})," ",n.contact.email]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:t?":":"Address:"})," ",n.contact.address]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:t?":":"Phone:"})," ",n.contact.phone]})]})]})]})]})]})})})]})},kee=()=>{const{language:e}=Xt(),t=e==="ar",n={title:t?" ":"Terms of Service",lastUpdated:t?" : 1  2024":"Last updated: January 1, 2024",welcome:{title:t?"   Nasabna":"Welcome to Nasabna",content:t?"       .":"These terms govern your use of our family tree platform."},acceptance:{title:t?" ":"Acceptance of Terms",content:t?"  Nasabna       .            .":"By using the Nasabna platform, you agree to be bound by these Terms and Conditions. If you do not agree to any of these terms, please do not use our services.",requirements:t?["     13   ","    ","      "]:["You must be 13 years or older to use the service","You must provide accurate and current information","You are responsible for maintaining account confidentiality"]},serviceDescription:{title:t?" ":"Description of Services",content:t?"Nasabna           .  :":"Nasabna is a digital platform for creating and managing family trees and preserving family heritage. Our services include:",services:t?["    ","   ","  ","  ","   "]:["Interactive family tree creation tools","Digital photo and document storage","Collaboration and sharing tools","Search and discovery features","Data export and report generation"]},userAccounts:{title:t?" ":"User Accounts",creation:{title:t?" ":"Account Creation",content:t?"                   ":"You must provide accurate and current information, You are responsible for all activities under your account, You must notify us immediately of any unauthorized use"},security:{title:t?" ":"Account Security",content:t?"              ":"Choose a strong and unique password, Do not share login credentials, Enable two-factor authentication when available"}},userContent:{title:t?" ":"User Content",content:t?"               .":"You retain ownership of content you create or upload to the platform, but you grant us a license to use it to provide the service.",guidelines:t?["       ","      ","  ","     "]:["Ensure you have the right to upload content","Do not upload offensive or illegal content","Respect others' privacy","We reserve the right to remove violating content"]},prohibitedUses:{title:t?" ":"Prohibited Uses",content:t?"      :":"You may not use our platform for the following purposes:",prohibitions:t?["     ","    ","    ","    ","   "]:["Violating any local or international laws","Harassment, bullying, or threatening","Publishing false or misleading content","Attempting to hack or disrupt the system","Violating intellectual property rights"]},termination:{title:t?"":"Termination",content:t?"        .          .":"Either party may terminate this agreement at any time. We reserve the right to suspend or terminate your account for violations of these terms.",details:t?["     ","        ","    "]:["You may delete your account at any time","We will provide notice before account termination when possible","You may export your data before deletion"]},limitationOfLiability:{title:t?" ":"Limitation of Liability",content:t?'  " "       .        .':'We provide our services "as is" and make no express or implied warranties. Our liability is limited to the maximum extent permitted by law.',details:t?["    ","    ","    "]:["We do not guarantee continuous service availability","We are not responsible for data loss","We recommend regular backups"]},changes:{title:t?"  ":"Changes to Terms",content:t?"        .            .":"We reserve the right to modify these terms at any time. We will notify you of any material changes via email or through the platform."},contact:{title:t?" ":"Contact Information",content:t?"          :":"If you have any questions about these Terms of Service, please contact us:",email:"legal@nasabna.com",address:t?"123     ":"123 Nasabna St, Cultural District, Egypt",phone:"+20 123 456 7890"}};return a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsx("section",{className:"relative py-20 md:py-32 bg-gradient-to-br from-primary/10 via-primary/5 to-background overflow-hidden",children:a.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 relative z-10",children:a.jsxs("div",{className:"text-center max-w-4xl mx-auto",children:[a.jsx("h1",{className:"text-4xl sm:text-5xl lg:text-6xl font-bold text-foreground mb-6",children:n.title}),a.jsx("p",{className:"text-xl text-muted-foreground",children:n.lastUpdated})]})})}),a.jsx("section",{className:"py-16",children:a.jsx("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"max-w-4xl mx-auto",children:[a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsx(yt,{className:"text-2xl",children:n.welcome.title})}),a.jsx(tt,{children:a.jsx("p",{className:"text-muted-foreground",children:n.welcome.content})})]}),a.jsxs("div",{className:"mt-8 space-y-8",children:[a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsx(yt,{children:n.acceptance.title})}),a.jsxs(tt,{children:[a.jsx("p",{className:"text-muted-foreground mb-4",children:n.acceptance.content}),a.jsx("ul",{className:"list-disc list-inside space-y-2 text-muted-foreground",children:n.acceptance.requirements.map((r,s)=>a.jsx("li",{children:r},s))})]})]}),a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsx(yt,{children:n.serviceDescription.title})}),a.jsxs(tt,{children:[a.jsx("p",{className:"text-muted-foreground mb-4",children:n.serviceDescription.content}),a.jsx("ul",{className:"list-disc list-inside space-y-2 text-muted-foreground",children:n.serviceDescription.services.map((r,s)=>a.jsx("li",{children:r},s))})]})]}),a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsx(yt,{children:n.userAccounts.title})}),a.jsx(tt,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold mb-2",children:n.userAccounts.creation.title}),a.jsx("p",{className:"text-muted-foreground",children:n.userAccounts.creation.content})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold mb-2",children:n.userAccounts.security.title}),a.jsx("p",{className:"text-muted-foreground",children:n.userAccounts.security.content})]})]})})]}),a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsx(yt,{children:n.userContent.title})}),a.jsxs(tt,{children:[a.jsx("p",{className:"text-muted-foreground mb-4",children:n.userContent.content}),a.jsx("ul",{className:"list-disc list-inside space-y-2 text-muted-foreground",children:n.userContent.guidelines.map((r,s)=>a.jsx("li",{children:r},s))})]})]}),a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsx(yt,{children:n.prohibitedUses.title})}),a.jsxs(tt,{children:[a.jsx("p",{className:"text-muted-foreground mb-4",children:n.prohibitedUses.content}),a.jsx("ul",{className:"list-disc list-inside space-y-2 text-muted-foreground",children:n.prohibitedUses.prohibitions.map((r,s)=>a.jsx("li",{children:r},s))})]})]}),a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsx(yt,{children:n.termination.title})}),a.jsxs(tt,{children:[a.jsx("p",{className:"text-muted-foreground mb-4",children:n.termination.content}),a.jsx("ul",{className:"list-disc list-inside space-y-2 text-muted-foreground",children:n.termination.details.map((r,s)=>a.jsx("li",{children:r},s))})]})]}),a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsx(yt,{children:n.limitationOfLiability.title})}),a.jsxs(tt,{children:[a.jsx("p",{className:"text-muted-foreground mb-4",children:n.limitationOfLiability.content}),a.jsx("ul",{className:"list-disc list-inside space-y-2 text-muted-foreground",children:n.limitationOfLiability.details.map((r,s)=>a.jsx("li",{children:r},s))})]})]}),a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsx(yt,{children:n.changes.title})}),a.jsx(tt,{children:a.jsx("p",{className:"text-muted-foreground",children:n.changes.content})})]}),a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsx(yt,{children:n.contact.title})}),a.jsxs(tt,{children:[a.jsx("p",{className:"text-muted-foreground mb-4",children:n.contact.content}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:t?" :":"Email:"})," ",n.contact.email]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:t?":":"Address:"})," ",n.contact.address]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:t?":":"Phone:"})," ",n.contact.phone]})]})]})]})]})]})})})]})},Xb=Y.createContext(void 0),Eee=({value:e,onValueChange:t,children:n,className:r})=>a.jsx(Xb.Provider,{value:{value:e,onValueChange:t},children:a.jsx("div",{className:Ai("w-full",r),children:n})}),Cee=({children:e,className:t})=>a.jsx("div",{className:Ai("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),children:e}),ef=({value:e,children:t,className:n})=>{const r=Y.useContext(Xb);if(!r)throw new Error("TabsTrigger must be used within Tabs");const{value:s,onValueChange:i}=r,l=s===e;return a.jsx("button",{className:Ai("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",l?"bg-background text-foreground shadow-sm":"hover:bg-background/50",n),onClick:()=>i(e),children:t})},tf=({value:e,children:t,className:n})=>{const r=Y.useContext(Xb);if(!r)throw new Error("TabsContent must be used within Tabs");const{value:s}=r;return s!==e?null:a.jsx("div",{className:Ai("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",n),children:t})},Pee=()=>{const e=Ir(),{language:t}=Xt(),{user:n}=Pr(),r=(O,W)=>t==="ar"?O:W,[s,i]=Y.useState({isOpen:!1,message:""}),[l,o]=Y.useState("overview"),[c,u]=Y.useState({userCount:0,totalTrees:0,privateTrees:0,publicTrees:0,personCount:0,totalSubscriptions:0,activeSubscriptions:0,recentUsers:[],recentTrees:[],monthlyRevenue:0,growthRate:0}),[d,f]=Y.useState([]),[m,h]=Y.useState([]),[x,y]=Y.useState([]),[p,g]=Y.useState(!0),[w,v]=Y.useState(""),[N,A]=Y.useState("all"),P=O=>{i({...O,isOpen:!0})},U=()=>{i(O=>({...O,isOpen:!1}))},M=()=>{s.onConfirm&&s.onConfirm(),U()};Y.useEffect(()=>{S()},[]);const S=async()=>{g(!0);try{await Promise.all([_(),T(),B()]),await C()}catch(O){console.error("Error fetching admin data:",O)}finally{g(!1)}},C=async()=>{try{const[O,W,E,H,V]=await Promise.all([nn.getUserCount(),nn.getTotalTreeCount(),nn.getPrivateTreeCount(),nn.getPublicTreeCount(),nn.getPersonCount()]);u(R=>{const q=R.monthlyRevenue,F=R.growthRate,G=R.activeSubscriptions,ee=R.totalSubscriptions;return{...R,userCount:(O==null?void 0:O.count)??O??0,totalTrees:(W==null?void 0:W.count)??W??0,privateTrees:(E==null?void 0:E.count)??E??0,publicTrees:(H==null?void 0:H.count)??H??0,personCount:(V==null?void 0:V.count)??V??0,monthlyRevenue:q,growthRate:F,activeSubscriptions:G,totalSubscriptions:ee}})}catch(O){console.error("Error fetching stats:",O)}},_=async()=>{g(!0);try{const O=await nn.getAllUsers(),E=(Array.isArray(O)?O:(O==null?void 0:O.data)||[]).map(V=>{var R,q,F,G,ee,ae,re,Q;return{id:V.id||V.Id||"",firstName:V.firstName||V.FirstName||V.userName||V.UserName||"Unknown",lastName:V.lastName||V.LastName||"",email:V.email||V.Email||`${V.firstName||V.userName||"user"}@example.com`,gender:V.gender||V.Gender||"other",role:V.role||V.Role||"user",subscription:{plan:((R=V.subscription)==null?void 0:R.plan)||((q=V.Subscription)==null?void 0:q.Plan)||V.plan||"basic",status:((F=V.subscription)==null?void 0:F.status)||((G=V.Subscription)==null?void 0:G.Status)||V.status||"active",currentPeriodStart:((ee=V.subscription)==null?void 0:ee.currentPeriodStart)||((ae=V.Subscription)==null?void 0:ae.CurrentPeriodStart)||new Date().toISOString(),currentPeriodEnd:((re=V.subscription)==null?void 0:re.currentPeriodEnd)||((Q=V.Subscription)==null?void 0:Q.CurrentPeriodEnd)||new Date(Date.now()+30*24*60*60*1e3).toISOString()},createdAt:V.createdAt||V.CreatedAt||V.created||new Date().toISOString(),lastLogin:V.lastLogin||V.LastLogin||void 0,isActive:V.isActive!==void 0?V.isActive:!0}});f(E);const H=(O==null?void 0:O.count)??E.length;u(V=>({...V,userCount:H,recentUsers:E.slice(0,5)}))}catch(O){console.error("Error fetching users:",O),f([]),u(W=>({...W,userCount:0,recentUsers:[]}))}finally{g(!1)}},T=async()=>{try{const O=await nn.getAdminTrees(),E=(Array.isArray(O)?O:(O==null?void 0:O.data)||[]).map(H=>{let V={id:"",firstName:"Unknown",lastName:"User",email:"unknown@example.com"};if(H.owner||H.Owner){const q=H.owner||H.Owner;V={id:q.id||q.Id||"",firstName:q.firstName||q.FirstName||q.name||"Unknown",lastName:q.lastName||q.LastName||"",email:q.email||q.Email||`${q.firstName||q.name||"unknown"}@example.com`}}else if(H.ownerId||H.OwnerId){const q=H.ownerId||H.OwnerId;V={id:"",firstName:q,lastName:"",email:`${q}@example.com`}}let R=0;return H.members&&Array.isArray(H.members)?R=H.members.length:R=H.personCount||H.totalPeople||H.PersonCount||0,{id:H.id||H.Id||"",name:H.name||H.Name||"Unnamed Tree",owner:V,personCount:R,isPrivate:H.isPrivate||H.IsPrivate||!1,createdAt:H.createdAt||H.CreatedAt||new Date().toISOString(),lastModified:H.lastModified||H.updatedAt||new Date().toISOString()}});h(E),u(H=>({...H,recentTrees:E.slice(0,5)}))}catch(O){console.error("Error fetching trees:",O),h([])}},B=async()=>{try{const O=await nn.getAllSubscriptions(),E=(Array.isArray(O)?O:(O==null?void 0:O.data)||[]).map(q=>({id:q.id||q.Id||"",userId:q.userId||q.UserId||"",plan:q.plan||q.Plan||"basic",status:q.status||q.Status||"active",currentPeriodStart:q.currentPeriodStart||q.CurrentPeriodStart||new Date().toISOString(),currentPeriodEnd:q.currentPeriodEnd||q.CurrentPeriodEnd||new Date(Date.now()+30*24*60*60*1e3).toISOString(),amount:q.amount||9.99,currency:q.currency||"USD"}));y(E);const H=E.filter(q=>q.status==="active"),V=H.reduce((q,F)=>q+(F.amount||0),0),R=E.length>0?Math.round(H.length/E.length*1e3)/10:0;u(q=>({...q,totalSubscriptions:E.length,activeSubscriptions:H.length,monthlyRevenue:V,growthRate:R}))}catch(O){console.error("Error fetching subscriptions:",O),u(W=>({...W,totalSubscriptions:0,activeSubscriptions:0,monthlyRevenue:0,growthRate:0})),y([])}},$=d.filter(O=>{const W=`${O.firstName} ${O.lastName} ${O.email}`.toLowerCase().includes(w.toLowerCase()),E=N==="all"||O.subscription.status===N;return W&&E}),D=m.filter(O=>`${O.name} ${O.owner.firstName} ${O.owner.lastName}`.toLowerCase().includes(w.toLowerCase())),L=x.filter(O=>{const W=`${O.id} ${O.userId}`.toLowerCase().includes(w.toLowerCase()),E=N==="all"||O.status===N;return W&&E});return p?a.jsx("div",{className:"min-h-screen bg-gradient-to-br from-background to-muted flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-primary border-t-transparent mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:t==="ar"?"   ...":"Loading Admin Dashboard..."}),a.jsx("p",{className:"text-muted-foreground",children:t==="ar"?" ":"Please wait"})]})}):a.jsxs("div",{className:"space-y-6",children:[a.jsx(Pb,{isOpen:s.isOpen,onClose:U,onConfirm:M,title:s.title,message:s.message,confirmText:s.confirmText,cancelText:s.cancelText,variant:s.variant}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold text-foreground",children:t==="ar"?"  ":"Admin Dashboard"}),a.jsx("p",{className:"text-muted-foreground mt-1",children:t==="ar"?"  ":"Comprehensive system management"})]}),a.jsxs(ge,{onClick:S,className:"w-full sm:w-auto",children:[a.jsx(po,{className:"h-4 w-4 mr-2"}),t==="ar"?" ":"Refresh Data"]})]}),a.jsxs(Eee,{value:l,onValueChange:o,className:"w-full",children:[a.jsxs(Cee,{className:"grid w-full grid-cols-5",children:[a.jsxs(ef,{value:"overview",className:"flex items-center gap-2",children:[a.jsx(CI,{className:"h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:t==="ar"?" ":"Overview"})]}),a.jsxs(ef,{value:"users",className:"flex items-center gap-2",children:[a.jsx(In,{className:"h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:t==="ar"?"":"Users"})]}),a.jsxs(ef,{value:"trees",className:"flex items-center gap-2",children:[a.jsx(Qn,{className:"h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:t==="ar"?"":"Trees"})]}),a.jsxs(ef,{value:"subscriptions",className:"flex items-center gap-2",children:[a.jsx(Tf,{className:"h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:t==="ar"?"":"Subscriptions"})]}),a.jsxs(ef,{value:"limits",className:"flex items-center gap-2",children:[a.jsx(zi,{className:"h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:t==="ar"?"":"Limits"})]})]}),a.jsxs("div",{className:"mt-6",children:[a.jsx(tf,{value:"overview",children:a.jsx(Iee,{stats:c,language:t,navigate:e})}),a.jsx(tf,{value:"users",children:a.jsx(Tee,{users:$,searchQuery:w,setSearchQuery:v,filterStatus:N,setFilterStatus:A,language:t,onRefresh:_,openConfirmDialog:P,t:r})}),a.jsx(tf,{value:"trees",children:a.jsx(Lee,{trees:D,searchQuery:w,setSearchQuery:v,language:t,navigate:e,onRefresh:T,openConfirmDialog:P,t:r})}),a.jsx(tf,{value:"subscriptions",children:a.jsx(Mee,{subscriptions:L,searchQuery:w,setSearchQuery:v,filterStatus:N,setFilterStatus:A,language:t,onRefresh:B})}),a.jsx(tf,{value:"limits",children:a.jsx(Ree,{users:d,language:t,onRefresh:S})})]})]})]})},Iee=({stats:e,language:t,navigate:n})=>{const r=[{title:t==="ar"?" ":"Total Users",value:e.userCount.toLocaleString(),icon:In,color:"bg-primary",change:`+${e.growthRate.toFixed(1)}%`,changeType:"positive"},{title:t==="ar"?" ":"Total Trees",value:e.totalTrees.toLocaleString(),icon:Qn,color:"bg-green-500",change:`+${e.growthRate.toFixed(1)}%`,changeType:"positive"},{title:t==="ar"?" ":"Active Subscriptions",value:e.activeSubscriptions.toLocaleString(),icon:Tf,color:"bg-purple-500",change:`+${e.growthRate.toFixed(1)}%`,changeType:"positive"},{title:t==="ar"?" ":"Monthly Revenue",value:`$${e.monthlyRevenue.toLocaleString()}`,icon:LI,color:"bg-emerald-500",change:`+${(e.growthRate*1.5).toFixed(1)}%`,changeType:"positive"}];return a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:r.map((s,i)=>{const l=s.icon;return a.jsx(Qe,{className:"relative overflow-hidden",children:a.jsx(tt,{className:"p-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-muted-foreground mb-1",children:s.title}),a.jsx("p",{className:"text-2xl font-bold text-foreground",children:s.value}),a.jsxs("div",{className:"flex items-center mt-2",children:[a.jsx(hp,{className:"h-4 w-4 text-green-500 mr-1"}),a.jsx("span",{className:"text-sm text-green-600 font-medium",children:s.change})]})]}),a.jsx("div",{className:`p-3 rounded-full ${s.color}`,children:a.jsx(l,{className:"h-6 w-6 text-white"})})]})})},`stat-${i}`)})}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsxs(yt,{className:"flex items-center gap-2",children:[a.jsx(In,{className:"h-5 w-5"}),t==="ar"?" ":"Recent Users"]})}),a.jsx(tt,{children:a.jsx("div",{className:"space-y-4",children:e.recentUsers.slice(0,5).map(s=>{var i,l;return a.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-muted",children:[a.jsx("div",{className:"w-10 h-10 rounded-full bg-primary/10 flex items-center justify-center",children:a.jsxs("span",{className:"text-primary font-medium text-sm",children:[(i=s.firstName)==null?void 0:i.charAt(0),(l=s.lastName)==null?void 0:l.charAt(0)]})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("p",{className:"font-medium text-sm truncate text-foreground",children:[s.firstName," ",s.lastName]}),a.jsx("p",{className:"text-xs text-muted-foreground truncate",children:s.email})]}),a.jsx(er,{variant:"outline",className:"text-xs",children:s.subscription.plan})]},s.id)})})})]}),a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsxs(yt,{className:"flex items-center gap-2",children:[a.jsx(Qn,{className:"h-5 w-5"}),t==="ar"?" ":"Recent Trees"]})}),a.jsx(tt,{children:a.jsx("div",{className:"space-y-4",children:e.recentTrees.slice(0,5).map(s=>a.jsxs("div",{className:"flex items-center gap-3 p-3 rounded-lg bg-muted",children:[a.jsx("div",{className:"w-10 h-10 rounded-full bg-green-100 flex items-center justify-center",children:a.jsx(Qn,{className:"h-5 w-5 text-green-600"})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsx("p",{className:"font-medium text-sm truncate text-foreground",children:s.name}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:[s.personCount," ",t==="ar"?"":"people"]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[s.isPrivate?a.jsx(zi,{className:"h-4 w-4 text-gray-400"}):a.jsx(mo,{className:"h-4 w-4 text-gray-400"}),a.jsx(ge,{variant:"ghost",size:"sm",onClick:()=>n(`/trees/${s.id}`),children:a.jsx(ra,{className:"h-4 w-4"})})]})]},s.id))})})]})]}),a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsxs(yt,{className:"flex items-center gap-2",children:[a.jsx(zi,{className:"h-5 w-5"}),t==="ar"?"  ":"New Limitation Status"]})}),a.jsx(tt,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-sm text-gray-600",children:t==="ar"?"      API.          10   .":"The system now fetches user limits from the API. Users without a subscription plan can create one tree and 10 people per tree."}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"p-4 bg-primary/10 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-primary-foreground mb-2",children:t==="ar"?" ":"Default Limits"}),a.jsxs("ul",{className:"text-sm text-primary-foreground space-y-1",children:[a.jsxs("li",{children:[" ",t==="ar"?"  ":"One tree only"]}),a.jsxs("li",{children:[" ",t==="ar"?"10   ":"10 people per tree"]}),a.jsxs("li",{children:[" ",t==="ar"?" ":"No photos"]}),a.jsxs("li",{children:[" ",t==="ar"?" ":"No sharing"]})]})]}),a.jsxs("div",{className:"p-4 bg-green-500/10 rounded-lg",children:[a.jsx("h4",{className:"font-medium text-green-900 mb-2",children:t==="ar"?" ":"Subscriber Limits"}),a.jsxs("ul",{className:"text-sm text-green-800 space-y-1",children:[a.jsxs("li",{children:[" ",t==="ar"?"    API":"Limits fetched from API"]}),a.jsxs("li",{children:[" ",t==="ar"?"   ":"Limits updated automatically"]}),a.jsxs("li",{children:[" ",t==="ar"?"   ":"Flexible limits based on plan"]})]})]})]})]})})]})]})},Tee=({users:e,searchQuery:t,setSearchQuery:n,filterStatus:r,setFilterStatus:s,language:i,onRefresh:l,openConfirmDialog:o,t:c})=>{const{showSuccess:u,showError:d}=Xt(),f=async(m,h)=>{const x=i==="ar"?" ":"Confirm Deletion",y=i==="ar"?`       "${h}"      .`:`Are you sure you want to delete the user "${h}"? This action cannot be undone.`;o({title:x,message:y,confirmText:i==="ar"?"":"Delete",cancelText:i==="ar"?"":"Cancel",variant:"destructive",onConfirm:async()=>{try{await Xn.deleteUser(m),l(),u(i==="ar"?"  ":"User Deleted",i==="ar"?"   ":"User deleted successfully")}catch(p){console.error("Error deleting user:",p),d(i==="ar"?"   ":"Failed to Delete User",i==="ar"?"   .    .":"Failed to delete user. Please try again.")}}})};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-foreground",children:i==="ar"?" ":"User Management"}),a.jsx("p",{className:"text-muted-foreground",children:i==="ar"?"    ":"Manage all users in the system"})]}),a.jsxs(ge,{onClick:l,className:"w-full sm:w-auto",children:[a.jsx(po,{className:"h-4 w-4 mr-2"}),i==="ar"?"":"Refresh"]})]}),a.jsx(Qe,{children:a.jsx(tt,{className:"p-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsx("div",{className:"flex-1",children:a.jsxs("div",{className:"relative",children:[a.jsx(Qi,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),a.jsx(Kt,{placeholder:i==="ar"?"  ...":"Search users...",value:t,onChange:m=>n(m.target.value),className:"pl-10"})]})}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("select",{value:r,onChange:m=>s(m.target.value),className:"px-3 py-2 border border-input rounded-md text-sm bg-background text-foreground",children:[a.jsx("option",{value:"all",children:i==="ar"?" ":"All Status"}),a.jsx("option",{value:"active",children:i==="ar"?"":"Active"}),a.jsx("option",{value:"cancelled",children:i==="ar"?"":"Cancelled"}),a.jsx("option",{value:"past_due",children:i==="ar"?"":"Past Due"})]}),a.jsxs(ge,{variant:"outline",size:"sm",children:[a.jsx(ry,{className:"h-4 w-4 mr-2"}),i==="ar"?"":"Export"]})]})]})})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map(m=>a.jsx(Qe,{className:"hover:shadow-md transition-shadow",children:a.jsxs(tt,{className:"p-4",children:[a.jsx("div",{className:"flex items-start justify-between mb-3",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 rounded-full bg-primary/10 flex items-center justify-center",children:m.gender==="male"?a.jsx(Na,{className:"h-6 w-6 text-primary"}):a.jsx(fj,{className:"h-6 w-6 text-primary"})}),a.jsxs("div",{children:[a.jsxs("h3",{className:"font-semibold text-foreground",children:[m.firstName," ",m.lastName]}),a.jsx("p",{className:"text-sm text-muted-foreground truncate",children:m.email})]})]})}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-sm text-muted-foreground",children:i==="ar"?":":"Role:"}),a.jsx(er,{variant:m.role==="admin"?"default":"secondary",children:m.role==="admin"?i==="ar"?"":"Admin":i==="ar"?"":"User"})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-sm text-muted-foreground",children:i==="ar"?":":"Subscription:"}),a.jsx(er,{variant:m.subscription.status==="active"?"default":"outline",className:"capitalize",children:m.subscription.plan})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-sm text-muted-foreground",children:i==="ar"?" :":"Joined:"}),a.jsx("span",{className:"text-sm text-foreground",children:new Date(m.createdAt).toLocaleDateString()})]})]}),a.jsx("div",{className:"flex gap-2 mt-4",children:a.jsxs(ge,{variant:"destructive",size:"sm",className:"flex-1",onClick:()=>f(m.email,`${m.firstName} ${m.lastName}`),children:[a.jsx(Ia,{className:"h-4 w-4 mr-1"}),i==="ar"?"":"Delete"]})})]})},m.id))}),e.length===0&&a.jsx(Qe,{children:a.jsxs(tt,{className:"p-8 text-center",children:[a.jsx(In,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:i==="ar"?"  ":"No users found"}),a.jsx("p",{className:"text-muted-foreground mb-4",children:i==="ar"?"      ":"There are no users in the system yet"}),a.jsxs(ge,{onClick:l,children:[a.jsx(po,{className:"h-4 w-4 mr-2"}),i==="ar"?"":"Refresh"]})]})})]})},Lee=({trees:e,searchQuery:t,setSearchQuery:n,language:r,navigate:s,onRefresh:i,openConfirmDialog:l,t:o})=>{const{showSuccess:c,showError:u}=Xt(),d=async(f,m)=>{const h=r==="ar"?" ":"Confirm Deletion",x=r==="ar"?`       "${m}"      .`:`Are you sure you want to delete the tree "${m}"? This action cannot be undone.`;l({title:h,message:x,confirmText:r==="ar"?"":"Delete",cancelText:r==="ar"?"":"Cancel",variant:"destructive",onConfirm:async()=>{try{const y=parseInt(f);if(isNaN(y))throw new Error("Invalid tree ID");await Pt.deleteTree(y),i(),c(r==="ar"?"  ":"Tree Deleted",r==="ar"?"   ":"Tree deleted successfully")}catch(y){console.error("Error deleting tree:",y),u(r==="ar"?"   ":"Failed to Delete Tree",r==="ar"?"   .    .":"Failed to delete tree. Please try again.")}}})};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-foreground",children:r==="ar"?" ":"Tree Management"}),a.jsx("p",{className:"text-muted-foreground",children:r==="ar"?"     ":"Manage all family trees in the system"})]}),a.jsxs(ge,{onClick:i,className:"w-full sm:w-auto",children:[a.jsx(po,{className:"h-4 w-4 mr-2"}),r==="ar"?"":"Refresh"]})]}),a.jsx(Qe,{children:a.jsx(tt,{className:"p-4",children:a.jsxs("div",{className:"relative",children:[a.jsx(Qi,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),a.jsx(Kt,{placeholder:r==="ar"?"  ...":"Search trees...",value:t,onChange:f=>n(f.target.value),className:"pl-10"})]})})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map(f=>a.jsx(Qe,{className:"hover:shadow-md transition-shadow",children:a.jsxs(tt,{className:"p-4",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 rounded-full bg-green-100 flex items-center justify-center",children:a.jsx(Qn,{className:"h-6 w-6 text-green-600"})}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-semibold text-foreground truncate",children:f.name}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:[f.owner.firstName," ",f.owner.lastName]})]})]}),a.jsx("div",{className:"flex items-center gap-1",children:f.isPrivate?a.jsx(zi,{className:"h-4 w-4 text-gray-400"}):a.jsx(mo,{className:"h-4 w-4 text-gray-400"})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-sm text-gray-600",children:r==="ar"?" :":"People Count:"}),a.jsx("span",{className:"text-sm font-medium text-gray-900",children:f.personCount})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-sm text-gray-600",children:r==="ar"?":":"Type:"}),a.jsx(er,{variant:f.isPrivate?"default":"secondary",children:f.isPrivate?r==="ar"?"":"Private":r==="ar"?"":"Public"})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-sm text-gray-600",children:r==="ar"?" :":"Created:"}),a.jsx("span",{className:"text-sm text-gray-900",children:new Date(f.createdAt).toLocaleDateString()})]})]}),a.jsxs("div",{className:"flex gap-2 mt-4",children:[a.jsxs(ge,{variant:"outline",size:"sm",className:"flex-1",onClick:()=>s(`/trees/${f.id}`),children:[a.jsx(ra,{className:"h-4 w-4 mr-1"}),r==="ar"?"":"View"]}),a.jsxs(ge,{variant:"destructive",size:"sm",className:"flex-1",onClick:()=>d(f.id,f.name),children:[a.jsx(Ia,{className:"h-4 w-4 mr-1"}),r==="ar"?"":"Delete"]})]})]})},f.id))}),e.length===0&&a.jsx(Qe,{children:a.jsxs(tt,{className:"p-8 text-center",children:[a.jsx(Qn,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:r==="ar"?"  ":"No trees found"}),a.jsx("p",{className:"text-gray-600",children:o("      ","No trees match your search criteria")})]})})]})},Mee=({subscriptions:e,searchQuery:t,setSearchQuery:n,filterStatus:r,setFilterStatus:s,language:i,onRefresh:l})=>a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-foreground",children:i==="ar"?" ":"Subscription Management"}),a.jsx("p",{className:"text-muted-foreground",children:i==="ar"?"    ":"Manage all subscriptions in the system"})]}),a.jsxs(ge,{onClick:l,className:"w-full sm:w-auto",children:[a.jsx(po,{className:"h-4 w-4 mr-2"}),i==="ar"?"":"Refresh"]})]}),a.jsx(Qe,{children:a.jsx(tt,{className:"p-4",children:a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsx("div",{className:"flex-1",children:a.jsxs("div",{className:"relative",children:[a.jsx(Qi,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),a.jsx(Kt,{placeholder:i==="ar"?"  ...":"Search subscriptions...",value:t,onChange:o=>n(o.target.value),className:"pl-10"})]})}),a.jsxs("select",{value:r,onChange:o=>s(o.target.value),className:"px-3 py-2 border border-input rounded-md text-sm bg-background text-foreground",children:[a.jsx("option",{value:"all",children:i==="ar"?" ":"All Status"}),a.jsx("option",{value:"active",children:i==="ar"?"":"Active"}),a.jsx("option",{value:"cancelled",children:i==="ar"?"":"Cancelled"}),a.jsx("option",{value:"past_due",children:i==="ar"?"":"Past Due"})]})]})})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:e.map(o=>a.jsx(Qe,{className:"hover:shadow-md transition-shadow",children:a.jsxs(tt,{className:"p-4",children:[a.jsxs("div",{className:"flex items-start justify-between mb-3",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("div",{className:"w-12 h-12 rounded-full bg-purple-500/10 flex items-center justify-center",children:a.jsx(Tf,{className:"h-6 w-6 text-purple-600"})}),a.jsxs("div",{children:[a.jsxs("h3",{className:"font-semibold text-foreground capitalize",children:[o.plan," Plan"]}),a.jsxs("p",{className:"text-sm text-muted-foreground truncate",children:["ID: ",o.id]})]})]}),a.jsx(ge,{variant:"ghost",size:"sm",children:a.jsx(WI,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-sm text-gray-600",children:i==="ar"?":":"Status:"}),a.jsx(er,{variant:o.status==="active"?"default":o.status==="cancelled"?"destructive":"outline",children:o.status==="active"?i==="ar"?"":"Active":o.status==="cancelled"?i==="ar"?"":"Cancelled":i==="ar"?"":"Past Due"})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-sm text-muted-foreground",children:i==="ar"?":":"Amount:"}),a.jsxs("span",{className:"text-sm font-medium text-foreground",children:["$",o.amount," ",o.currency]})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-sm text-muted-foreground",children:i==="ar"?" :":"Expires:"}),a.jsx("span",{className:"text-sm text-foreground",children:new Date(o.currentPeriodEnd).toLocaleDateString()})]})]}),a.jsxs("div",{className:"flex gap-2 mt-4",children:[a.jsxs(ge,{variant:"outline",size:"sm",className:"flex-1",children:[a.jsx(ra,{className:"h-4 w-4 mr-1"}),i==="ar"?"":"View"]}),a.jsxs(ge,{variant:"outline",size:"sm",className:"flex-1",children:[a.jsx(sa,{className:"h-4 w-4 mr-1"}),i==="ar"?"":"Edit"]}),a.jsx(ge,{variant:"destructive",size:"sm",children:a.jsx(Ia,{className:"h-4 w-4"})})]})]})},o.id))}),e.length===0&&a.jsx(Qe,{children:a.jsxs(tt,{className:"p-8 text-center",children:[a.jsx(Tf,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:i==="ar"?"  ":"No subscriptions found"}),a.jsx("p",{className:"text-muted-foreground",children:i==="ar"?"      ":"No subscriptions match your search criteria"})]})})]}),Ree=({users:e,language:t,onRefresh:n})=>{const r=e.reduce((s,i)=>{var o;const l=((o=i.subscription)==null?void 0:o.plan)||"free";return s[l]||(s[l]=[]),s[l].push(i),s},{});return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-foreground",children:t==="ar"?" ":"Limit Management"}),a.jsx("p",{className:"text-muted-foreground",children:t==="ar"?"   ":"View and manage user limits"})]}),a.jsxs(ge,{onClick:n,className:"w-full sm:w-auto",children:[a.jsx(po,{className:"h-4 w-4 mr-2"}),t==="ar"?"":"Refresh"]})]}),a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsxs(yt,{className:"flex items-center gap-2",children:[a.jsx(zi,{className:"h-5 w-5"}),t==="ar"?"  ":"New Limitation System"]})}),a.jsx(tt,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-sm text-muted-foreground",children:t==="ar"?"      API.          10   .":"The system now fetches user limits from the API. Users without a subscription plan can create one tree and 10 people per tree."}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[a.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:t==="ar"?" ":"Default Limits"}),a.jsxs("ul",{className:"text-sm text-blue-800 space-y-1",children:[a.jsxs("li",{children:[" ",t==="ar"?"  ":"One tree only"]}),a.jsxs("li",{children:[" ",t==="ar"?"10   ":"10 people per tree"]}),a.jsxs("li",{children:[" ",t==="ar"?" ":"No photos"]}),a.jsxs("li",{children:[" ",t==="ar"?" ":"No sharing"]})]})]}),a.jsxs("div",{className:"p-4 bg-green-50 rounded-lg border border-green-200",children:[a.jsx("h4",{className:"font-medium text-green-900 mb-2",children:t==="ar"?" ":"Subscriber Limits"}),a.jsxs("ul",{className:"text-sm text-green-800 space-y-1",children:[a.jsxs("li",{children:[" ",t==="ar"?"    API":"Limits fetched from API"]}),a.jsxs("li",{children:[" ",t==="ar"?"   ":"Flexible limits based on plan"]}),a.jsxs("li",{children:[" ",t==="ar"?" ":"Automatic updates"]})]})]}),a.jsxs("div",{className:"p-4 bg-purple-50 rounded-lg border border-purple-200",children:[a.jsx("h4",{className:"font-medium text-purple-900 mb-2",children:t==="ar"?"  API":"API Endpoint"}),a.jsxs("p",{className:"text-sm text-purple-800",children:["GET /api/FamilyTree/UserTreeLimit/","{userId}"]}),a.jsx("p",{className:"text-xs text-purple-600 mt-2",children:t==="ar"?"       ":"This endpoint is used to fetch limits for each user"})]})]})]})})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Object.entries(r).map(([s,i])=>a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsxs(yt,{className:"flex items-center justify-between",children:[a.jsxs("span",{className:"capitalize",children:[s," ",t==="ar"?"":"Plan"]}),a.jsx(er,{variant:"secondary",children:i.length})]})}),a.jsx(tt,{children:a.jsxs("div",{className:"space-y-3",children:[i.slice(0,3).map(l=>{var o,c;return a.jsxs("div",{className:"flex items-center gap-3 p-2 rounded-lg bg-muted",children:[a.jsx("div",{className:"w-8 h-8 rounded-full bg-primary/10 flex items-center justify-center",children:a.jsx("span",{className:"text-primary font-medium text-xs",children:(o=l.firstName)==null?void 0:o.charAt(0)})}),a.jsxs("div",{className:"flex-1 min-w-0",children:[a.jsxs("p",{className:"font-medium text-sm truncate text-foreground",children:[l.firstName," ",l.lastName]}),a.jsx("p",{className:"text-xs text-muted-foreground truncate",children:l.email})]}),a.jsx(er,{variant:"outline",className:"text-xs",children:((c=l.subscription)==null?void 0:c.status)||"active"})]},l.id)}),i.length>3&&a.jsx("p",{className:"text-xs text-muted-foreground text-center pt-2 border-t",children:t==="ar"?` ${i.length-3}  `:`And ${i.length-3} more users`})]})})]},s))})]})},$ee=()=>{const{language:e}=Xt(),[t,n]=Y.useState([]),[r,s]=Y.useState(!0),[i,l]=Y.useState(null);Y.useEffect(()=>{o()},[]);const o=async()=>{try{s(!0),l(null);const f=localStorage.getItem("authToken"),h=await fetch("https://qabael.premiumasp.net/api/admin/join-requests",{headers:{Authorization:f?`Bearer ${f}`:"","Content-Type":"application/json"}});if(!h.ok)throw new Error(`HTTP error! status: ${h.status}`);const x=await h.json();let y=[];Array.isArray(x)?y=x:x&&typeof x=="object"&&"data"in x?y=Array.isArray(x.data)?x.data:[]:y=[];const p=y.map(g=>{const w=g.id??g.Id??g.ID??0,v=g.familyTreeId??g.FamilyTreeId??0,N=g.name??g.Name??"",A=g.birthDate??g.BirthDate??"",P=g.birthPlace??g.BirthPlace??"",U=g.gender??g.Gender??"",M=g.occupation??g.Occupation??"",S=g.relatedPersonId??g.RelatedPersonId??0,C=g.status??g.Status??"Pending",_=g.requesterId??g.RequesterId??"",T=g.relationshipType??g.RelationshipType??"",B=g.createdAt??g.CreatedAt??new Date().toISOString();return{id:w,familyTreeId:v,name:N,birthDate:A,birthPlace:P,gender:U,occupation:M,relatedPersonId:S,status:C,requesterId:_,relationshipType:T,createdAt:B}}).filter(g=>g.id>0);n(p)}catch{l(e==="ar"?"    ":"Failed to load join requests")}finally{s(!1)}},c=async f=>{try{await nn.acceptJoinRequest(f),dn.success({en:"Request accepted successfully",ar:"   "}),o()}catch{dn.error({en:"Failed to accept request",ar:"   "})}},u=async f=>{try{await nn.rejectJoinRequest(f),dn.success({en:"Request rejected successfully",ar:"   "}),o()}catch{dn.error({en:"Failed to reject request",ar:"   "})}},d=f=>{switch(f.toLowerCase()){case"pending":return a.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:[a.jsx(y0,{className:"h-3 w-3 mr-1"}),e==="ar"?" ":"Pending"]});case"accepted":return a.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[a.jsx(Si,{className:"h-3 w-3 mr-1"}),e==="ar"?"":"Accepted"]});case"rejected":return a.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[a.jsx(sy,{className:"h-3 w-3 mr-1"}),e==="ar"?"":"Rejected"]});default:return a.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:f})}};return r?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsx(wr,{className:"h-12 w-12 animate-spin text-primary"})}):i?a.jsx("div",{className:"flex items-center justify-center h-64",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"mx-auto w-16 h-16 bg-destructive/10 rounded-full flex items-center justify-center mb-4",children:a.jsx(ii,{className:"h-8 w-8 text-destructive"})}),a.jsx("h2",{className:"text-2xl font-bold text-destructive mb-4",children:i}),a.jsx(ge,{onClick:o,children:e==="ar"?" ":"Try Again"})]})}):a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h1",{className:"text-2xl font-bold",children:e==="ar"?"  ":"Manage Join Requests"}),a.jsx(ge,{onClick:o,variant:"outline",size:"sm",children:e==="ar"?"":"Refresh"})]}),a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsxs(yt,{className:"flex items-center gap-2",children:[a.jsx(In,{className:"h-5 w-5"}),e==="ar"?"  ":"Manage Join Requests"]})}),a.jsx(tt,{children:a.jsx("div",{className:"space-y-4",children:t.length===0?a.jsxs("div",{className:"text-center py-12",children:[a.jsx(In,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-medium mb-1",children:e==="ar"?"  ":"No Requests Found"}),a.jsx("p",{className:"text-muted-foreground",children:e==="ar"?"    ":"No join requests found currently"})]}):t.map(f=>a.jsx("div",{className:"border rounded-lg p-4",children:a.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("h3",{className:"font-medium",children:f.name}),d(f.status)]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Ur,{className:"h-4 w-4 text-muted-foreground"}),a.jsx("span",{children:new Date(f.birthDate).toLocaleDateString(e==="ar"?"ar-SA":"en-US")})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ai,{className:"h-4 w-4 text-muted-foreground"}),a.jsx("span",{children:f.birthPlace})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Qo,{className:"h-4 w-4 text-muted-foreground"}),a.jsx("span",{children:f.occupation})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(In,{className:"h-4 w-4 text-muted-foreground"}),a.jsx("span",{children:f.relationshipType})]})]}),a.jsxs("div",{className:"mt-2 text-xs text-muted-foreground",children:[e==="ar"?" :":"Requested by:"," ",f.requesterId]}),a.jsxs("div",{className:"mt-1 text-xs text-muted-foreground",children:[e==="ar"?" :":"Tree ID:"," ",f.familyTreeId]})]}),f.status.toLowerCase()==="pending"&&a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(ge,{variant:"default",size:"sm",onClick:()=>c(f.id),className:"flex items-center gap-1",children:[a.jsx(Hm,{className:"h-4 w-4"}),e==="ar"?"":"Accept"]}),a.jsxs(ge,{variant:"destructive",size:"sm",onClick:()=>u(f.id),className:"flex items-center gap-1",children:[a.jsx(hj,{className:"h-4 w-4"}),e==="ar"?"":"Reject"]})]})]})},f.id))})})]})]})},Fee=()=>{const e=Ir(),{language:t}=Xt(),[n,r]=Y.useState([]),[s,i]=Y.useState(!0),[l,o]=Y.useState(null);Y.useEffect(()=>{(async()=>{try{i(!0);const m=await Hu.getAllPlans();r(m)}catch(m){console.error("Error fetching plans:",m),o(t==="ar"?"   ":"Failed to load plans")}finally{i(!1)}})()},[t]);const[c,u]=we.useState("yearly"),d=f=>{if(!f)return[];const m=Array.from(f.matchAll(/<li[^>]*>(.*?)<\/li>/gi)).map(p=>p[1].replace(/<[^>]+>/g,"").trim()).filter(Boolean);if(m.length)return m;let h=f;h=h.replace(/\\n/g,`
`).replace(/\\\s*-\s*/g,`
- `).replace(/([.!?])\s*-\s+/g,`$1
- `).replace(/\s*/g,`
 `).replace(/\s+-\s+/g,`
- `);const x=Array.from(h.matchAll(/(?:^|\n)\s*[-*]\s+(.+?)(?=\n|$)/g)).map(p=>p[1].trim()).filter(Boolean);if(x.length)return x;const y=h.split(/[-*]\s+/).map(p=>p.trim()).filter(Boolean);return y.length>1?y.slice(1):y};return a.jsx("div",{className:"min-h-screen bg-gray-50 py-12",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs("div",{className:"text-center mb-12",children:[a.jsx("h1",{className:"text-3xl font-bold text-gray-900 sm:text-4xl",children:t==="ar"?" ":"Pricing Plans"}),a.jsx("p",{className:"mt-4 text-lg text-gray-600 max-w-2xl mx-auto",children:t==="ar"?"      ":"Select the plan that fits your needs and enjoy all features"}),a.jsx("div",{className:"mt-8 flex justify-center",children:a.jsxs("div",{className:"inline-flex rounded-md shadow-sm",role:"group",children:[a.jsx("button",{type:"button",onClick:()=>u("monthly"),className:`px-4 py-2 text-sm font-medium rounded-l-lg ${c==="monthly"?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-100"}`,children:t==="ar"?"":"Monthly"}),a.jsxs("button",{type:"button",onClick:()=>u("yearly"),className:`px-4 py-2 text-sm font-medium rounded-r-md ${c==="yearly"?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-100"}`,children:[t==="ar"?"":"Yearly",a.jsx(er,{className:"ml-2 bg-green-100 text-green-800",children:t==="ar"?" 17%":"Save 17%"})]})]})})]}),s?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"})}):l?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("p",{className:"text-red-500 mb-4",children:l}),a.jsx(ge,{onClick:()=>window.location.reload(),children:t==="ar"?" ":"Try Again"})]}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:n.map(f=>a.jsxs(Qe,{className:"flex flex-col",children:[f.name==="Yearly"&&a.jsx("div",{className:"absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-1/2",children:a.jsx(er,{className:"bg-blue-500",children:t==="ar"?" ":"Most Popular"})}),a.jsx(xt,{children:a.jsx(yt,{className:"text-xl",children:f.name})}),a.jsxs(tt,{className:"flex-1",children:[a.jsxs("div",{className:"mb-6",children:[a.jsxs("span",{className:"text-4xl font-bold text-gray-900",children:["$",f.price]}),a.jsxs("span",{className:"text-gray-600",children:["/",f.billingCycle==="year"?t==="ar"?"":"year":t==="ar"?"":"month"]})]}),a.jsx("ul",{className:"space-y-2 text-sm text-gray-600 mb-6",children:f.productId.includes("basic")?a.jsxs(a.Fragment,{children:[a.jsxs("li",{className:"flex items-start",children:[a.jsx(Bs,{className:"h-4 w-4 text-green-600 mr-2 mt-0.5 flex-shrink-0"}),a.jsx("span",{children:t==="ar"?"   ":"Create up to 1 family tree"})]}),a.jsxs("li",{className:"flex items-start",children:[a.jsx(Bs,{className:"h-4 w-4 text-green-600 mr-2 mt-0.5 flex-shrink-0"}),a.jsx("span",{children:t==="ar"?"  50   ":"Add up to 50 family members"})]}),a.jsxs("li",{className:"flex items-start",children:[a.jsx(Bs,{className:"h-4 w-4 text-green-600 mr-2 mt-0.5 flex-shrink-0"}),a.jsx("span",{children:t==="ar"?"     ":"View and edit your tree anytime"})]}),a.jsxs("li",{className:"flex items-start",children:[a.jsx(Bs,{className:"h-4 w-4 text-green-600 mr-2 mt-0.5 flex-shrink-0"}),a.jsx("span",{children:t==="ar"?"   ":"Basic email support"})]}),a.jsxs("li",{className:"flex items-start",children:[a.jsx(Bs,{className:"h-4 w-4 text-green-600 mr-2 mt-0.5 flex-shrink-0"}),a.jsx("span",{children:t==="ar"?"   ":"Limited storage for photos and documents"})]})]}):(()=>{const m=d(f.description);return m.length>0?m.map((h,x)=>a.jsxs("li",{className:"flex items-start",children:[a.jsx(Bs,{className:"h-4 w-4 text-green-600 mr-2 mt-0.5 flex-shrink-0"}),a.jsx("span",{children:h})]},x)):a.jsxs("li",{className:"flex items-start",children:[a.jsx(Bs,{className:"h-4 w-4 text-green-600 mr-2 mt-0.5 flex-shrink-0"}),a.jsx("span",{children:f.description})]})})()}),a.jsx(ge,{onClick:()=>e(`/subscription/checkout/${f.productId}`,{state:{plan:f}}),className:"w-full",children:t==="ar"?"  ":"Choose This Plan"})]})]},f.id))}),a.jsxs("div",{className:"mt-16 max-w-3xl mx-auto",children:[a.jsx("div",{className:"text-center",children:a.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:t==="ar"?" ":"Frequently Asked Questions"})}),a.jsxs("div",{className:"space-y-4",children:[a.jsx(Qe,{children:a.jsxs(tt,{className:"p-6",children:[a.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:t==="ar"?"      ":"How can I change my subscription plan?"}),a.jsx("p",{className:"text-gray-600",children:t==="ar"?"              .":"You can upgrade or downgrade your subscription plan at any time from your account settings page."})]})}),a.jsx(Qe,{children:a.jsxs(tt,{className:"p-6",children:[a.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:t==="ar"?"      ":"Can I cancel my subscription at any time?"}),a.jsx("p",{className:"text-gray-600",children:t==="ar"?"      .       .":"Yes, you can cancel your subscription at any time. No automatic billing will occur after cancellation."})]})}),a.jsx(Qe,{children:a.jsxs(tt,{className:"p-6",children:[a.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:t==="ar"?"    ":"Do you offer a free trial period?"}),a.jsx("p",{className:"text-gray-600",children:t==="ar"?"      14     .":"Yes, we offer a 14-day free trial for all new subscription plans."})]})})]})]})]})})},O7=(e=!0)=>{const{user:t,isLoading:n}=Pr(),r=Ir(),s=!!t,i=(t==null?void 0:t.email)||"";return Y.useEffect(()=>{!n&&!s&&e&&r("/auth/login")},[s,n,e,r]),{user:t,userEmail:i,isAuthenticated:s,isLoading:n}},Oee=()=>{const e=Ir(),{userEmail:t,isAuthenticated:n,isLoading:r}=O7(),{language:s}=Xt(),[i,l]=Y.useState([]),[o,c]=Y.useState(!0),[u,d]=Y.useState(null);if(r)return a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})});if(!n)return a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:a.jsxs(Qe,{className:"max-w-md w-full mx-4",children:[a.jsx(xt,{children:a.jsx(yt,{children:s==="ar"?"  ":"Login Required"})}),a.jsx(tt,{children:a.jsx("p",{className:"text-muted-foreground",children:s==="ar"?"     ":"Please log in to view subscription plans"})}),a.jsx(tt,{children:a.jsx(ge,{onClick:()=>e("/login"),className:"w-full",children:s==="ar"?" ":"Login"})})]})});Y.useEffect(()=>{f()},[]);const f=async()=>{try{c(!0);const p=await Hu.getAllPlans();l(p)}catch(p){console.error("Error fetching plans:",p),d(s==="ar"?"   ":"Failed to load plans")}finally{c(!1)}},m=p=>{e(`/subscription/checkout/${p.productId}`,{state:{plan:p,userEmail:t||""}})},h=p=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(p),x=p=>p.productId.includes("basic")?[{key:"maxTrees",value:1},{key:"maxPeoplePerTree",value:50},{key:"storage",value:1073741824},{key:"canShare",value:!0},{key:"canExport",value:!1},{key:"prioritySupport",value:!1}]:p.productId.includes("premium")?[{key:"maxTrees",value:5},{key:"maxPeoplePerTree",value:200},{key:"storage",value:10737418240},{key:"canShare",value:!0},{key:"canExport",value:!0},{key:"prioritySupport",value:!0}]:[{key:"maxTrees",value:0},{key:"maxPeoplePerTree",value:0},{key:"storage",value:53687091200},{key:"canShare",value:!0},{key:"canExport",value:!0},{key:"prioritySupport",value:!0}],y=(p,g)=>{switch(p){case"maxTrees":return g===0?s==="ar"?"   ":"Unlimited Family Trees":s==="ar"?g+" "+(g>1?" ":" "):`${g} Family Tree${g>1?"s":""}`;case"maxPeoplePerTree":return g===0?s==="ar"?"  ":"Unlimited People":s==="ar"?" "+g+" "+(g>1?"  ":"  "):`Up to ${g} People per Tree`;case"storage":const w=v=>v>=1073741824?`${(v/1073741824).toFixed(0)} GB`:v>=1048576?`${(v/1048576).toFixed(0)} MB`:`${v} bytes`;return s==="ar"?w(g)+" ":`${w(g)} Storage`;case"canShare":return g?s==="ar"?" ":"Tree Sharing":"";case"canExport":return g?s==="ar"?" ":"Tree Export":"";case"prioritySupport":return g?s==="ar"?" ":"Priority Support":"";default:return g?s==="ar"?"":"Available":s==="ar"?" ":"Not Available"}};return o?a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):u?a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:a.jsxs(Qe,{className:"max-w-md w-full mx-4",children:[a.jsx(xt,{children:a.jsx(yt,{className:"text-destructive",children:s==="ar"?"":"Error"})}),a.jsx(tt,{children:a.jsx("p",{className:"text-muted-foreground",children:u})}),a.jsx(tt,{children:a.jsx(ge,{onClick:f,className:"w-full",children:s==="ar"?" ":"Try Again"})})]})}):a.jsx("div",{className:"min-h-screen bg-background py-12",children:a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs("div",{className:"text-center mb-12",children:[a.jsx("h1",{className:"text-3xl font-bold text-foreground sm:text-4xl",children:s==="ar"?"  ":"Choose Your Subscription Plan"}),a.jsx("p",{className:"mt-4 text-lg text-muted-foreground max-w-2xl mx-auto",children:s==="ar"?"      ":"Select the plan that fits your needs and enjoy all features"})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8",children:i.map(p=>{const g=p.billingCycle==="year";return a.jsxs(Qe,{className:"flex flex-col",children:[a.jsx(xt,{children:a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsx("div",{children:a.jsx(yt,{className:"text-xl",children:p.name})}),p.name==="Yearly"&&a.jsx(er,{className:"bg-primary text-primary-foreground",children:s==="ar"?" ":"Most Popular"})]})}),a.jsxs(tt,{className:"flex-1",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("span",{className:"text-4xl font-bold text-foreground",children:h(p.price)}),a.jsxs("span",{className:"text-muted-foreground",children:["/",g?s==="ar"?"":"year":s==="ar"?"":"month"]})]}),a.jsx("ul",{className:"space-y-2 text-sm text-muted-foreground mb-6",children:p.productId.includes("basic")?a.jsxs(a.Fragment,{children:[a.jsxs("li",{className:"flex items-start",children:[a.jsx(Bs,{className:"h-4 w-4 text-green-600 mr-2 mt-0.5 flex-shrink-0"}),a.jsx("span",{children:s==="ar"?"   ":"Create up to 1 family tree"})]}),a.jsxs("li",{className:"flex items-start",children:[a.jsx(Bs,{className:"h-4 w-4 text-green-600 mr-2 mt-0.5 flex-shrink-0"}),a.jsx("span",{children:s==="ar"?"  50   ":"Add up to 50 family members"})]}),a.jsxs("li",{className:"flex items-start",children:[a.jsx(Bs,{className:"h-4 w-4 text-green-600 mr-2 mt-0.5 flex-shrink-0"}),a.jsx("span",{children:s==="ar"?"     ":"View and edit your tree anytime"})]}),a.jsxs("li",{className:"flex items-start",children:[a.jsx(Bs,{className:"h-4 w-4 text-green-600 mr-2 mt-0.5 flex-shrink-0"}),a.jsx("span",{children:s==="ar"?"   ":"Basic email support"})]}),a.jsxs("li",{className:"flex items-start",children:[a.jsx(Bs,{className:"h-4 w-4 text-green-600 mr-2 mt-0.5 flex-shrink-0"}),a.jsx("span",{children:s==="ar"?"   ":"Limited storage for photos and documents"})]})]}):x(p).map((w,v)=>{if(!w.value&&w.key!=="maxTrees"&&w.key!=="maxPeoplePerTree"&&w.key!=="storage")return null;let N=Bs;(w.key==="maxTrees"||w.key==="maxPeoplePerTree")&&(N=In),w.key==="canShare"&&(N=fh),w.key==="canExport"&&(N=ry),w.key==="prioritySupport"&&(N=FI);const A=N;return a.jsxs("li",{className:"flex items-start",children:[a.jsx(A,{className:"h-4 w-4 text-green-600 mr-2 mt-0.5 flex-shrink-0"}),a.jsx("span",{children:y(w.key,w.value)})]},v)})})]}),a.jsx(tt,{children:a.jsx(ge,{onClick:()=>m(p),className:"w-full",children:s==="ar"?"  ":"Choose This Plan"})})]},p.id)})})]})})};var D7="https://js.stripe.com/v3",Dee=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/;var Bee=function(){for(var t=document.querySelectorAll('script[src^="'.concat(D7,'"]')),n=0;n<t.length;n++){var r=t[n];if(Dee.test(r.src))return r}return null},i4=function(t){var n="",r=document.createElement("script");r.src="".concat(D7).concat(n);var s=document.head||document.body;if(!s)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return s.appendChild(r),r},zee=function(t,n){!t||!t._registerWrapper||t._registerWrapper({name:"stripe-js",version:"2.4.0",startTime:n})},nf=null,$m=null,Fm=null,Uee=function(t){return function(){t(new Error("Failed to load Stripe.js"))}},qee=function(t,n){return function(){window.Stripe?t(window.Stripe):n(new Error("Stripe.js not available"))}},Hee=function(t){return nf!==null?nf:(nf=new Promise(function(n,r){if(typeof window>"u"||typeof document>"u"){n(null);return}if(window.Stripe){n(window.Stripe);return}try{var s=Bee();if(!(s&&t)){if(!s)s=i4(t);else if(s&&Fm!==null&&$m!==null){var i;s.removeEventListener("load",Fm),s.removeEventListener("error",$m),(i=s.parentNode)===null||i===void 0||i.removeChild(s),s=i4(t)}}Fm=qee(n,r),$m=Uee(r),s.addEventListener("load",Fm),s.addEventListener("error",$m)}catch(l){r(l);return}}),nf.catch(function(n){return nf=null,Promise.reject(n)}))},Wee=function(t,n,r){if(t===null)return null;var s=t.apply(void 0,n);return zee(s,r),s},rf,B7=!1,z7=function(){return rf||(rf=Hee(null).catch(function(t){return rf=null,Promise.reject(t)}),rf)};Promise.resolve().then(function(){return z7()}).catch(function(e){B7||console.warn(e)});var Vee=function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];B7=!0;var s=Date.now();return z7().then(function(i){return Wee(i,n,s)})},U7={exports:{}},Gee="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",Yee=Gee,Jee=Yee;function q7(){}function H7(){}H7.resetWarningCache=q7;var Zee=function(){function e(r,s,i,l,o,c){if(c!==Jee){var u=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw u.name="Invariant Violation",u}}e.isRequired=e;function t(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:H7,resetWarningCache:q7};return n.PropTypes=n,n};U7.exports=Zee();var Xee=U7.exports;const yr=f4(Xee);function a4(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable})),n.push.apply(n,r)}return n}function o4(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?a4(Object(n),!0).forEach(function(r){W7(e,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a4(Object(n)).forEach(function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(n,r))})}return e}function cp(e){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?cp=function(t){return typeof t}:cp=function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cp(e)}function W7(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function V7(e,t){return Kee(e)||Qee(e,t)||ete(e,t)||tte()}function Kee(e){if(Array.isArray(e))return e}function Qee(e,t){var n=e&&(typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"]);if(n!=null){var r=[],s=!0,i=!1,l,o;try{for(n=n.call(e);!(s=(l=n.next()).done)&&(r.push(l.value),!(t&&r.length===t));s=!0);}catch(c){i=!0,o=c}finally{try{!s&&n.return!=null&&n.return()}finally{if(i)throw o}}return r}}function ete(e,t){if(e){if(typeof e=="string")return l4(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l4(e,t)}}function l4(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function tte(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var bi=function(t,n,r){var s=!!r,i=we.useRef(r);we.useEffect(function(){i.current=r},[r]),we.useEffect(function(){if(!s||!t)return function(){};var l=function(){i.current&&i.current.apply(i,arguments)};return t.on(n,l),function(){t.off(n,l)}},[s,n,t,i])},W2=function(t){var n=we.useRef(t);return we.useEffect(function(){n.current=t},[t]),n.current},Vu=function(t){return t!==null&&cp(t)==="object"},nte=function(t){return Vu(t)&&typeof t.then=="function"},rte=function(t){return Vu(t)&&typeof t.elements=="function"&&typeof t.createToken=="function"&&typeof t.createPaymentMethod=="function"&&typeof t.confirmCardPayment=="function"},c4="[object Object]",ste=function e(t,n){if(!Vu(t)||!Vu(n))return t===n;var r=Array.isArray(t),s=Array.isArray(n);if(r!==s)return!1;var i=Object.prototype.toString.call(t)===c4,l=Object.prototype.toString.call(n)===c4;if(i!==l)return!1;if(!i&&!r)return t===n;var o=Object.keys(t),c=Object.keys(n);if(o.length!==c.length)return!1;for(var u={},d=0;d<o.length;d+=1)u[o[d]]=!0;for(var f=0;f<c.length;f+=1)u[c[f]]=!0;var m=Object.keys(u);if(m.length!==o.length)return!1;var h=t,x=n,y=function(g){return e(h[g],x[g])};return m.every(y)},G7=function(t,n,r){return Vu(t)?Object.keys(t).reduce(function(s,i){var l=!Vu(n)||!ste(t[i],n[i]);return r.includes(i)?(l&&console.warn("Unsupported prop change: options.".concat(i," is not a mutable property.")),s):l?o4(o4({},s||{}),{},W7({},i,t[i])):s},null):null},Y7="Invalid prop `stripe` supplied to `Elements`. We recommend using the `loadStripe` utility from `@stripe/stripe-js`. See https://stripe.com/docs/stripe-js/react#elements-props-stripe for details.",u4=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Y7;if(t===null||rte(t))return t;throw new Error(n)},ite=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Y7;if(nte(t))return{tag:"async",stripePromise:Promise.resolve(t).then(function(s){return u4(s,n)})};var r=u4(t,n);return r===null?{tag:"empty"}:{tag:"sync",stripe:r}},ate=function(t){!t||!t._registerWrapper||!t.registerAppInfo||(t._registerWrapper({name:"react-stripe-js",version:"2.8.1"}),t.registerAppInfo({name:"react-stripe-js",version:"2.8.1",url:"https://stripe.com/docs/stripe-js/react"}))},mg=we.createContext(null);mg.displayName="ElementsContext";var J7=function(t,n){if(!t)throw new Error("Could not find Elements context; You need to wrap the part of your app that ".concat(n," in an <Elements> provider."));return t},Z7=function(t){var n=t.stripe,r=t.options,s=t.children,i=we.useMemo(function(){return ite(n)},[n]),l=we.useState(function(){return{stripe:i.tag==="sync"?i.stripe:null,elements:i.tag==="sync"?i.stripe.elements(r):null}}),o=V7(l,2),c=o[0],u=o[1];we.useEffect(function(){var m=!0,h=function(y){u(function(p){return p.stripe?p:{stripe:y,elements:y.elements(r)}})};return i.tag==="async"&&!c.stripe?i.stripePromise.then(function(x){x&&m&&h(x)}):i.tag==="sync"&&!c.stripe&&h(i.stripe),function(){m=!1}},[i,c,r]);var d=W2(n);we.useEffect(function(){d!==null&&d!==n&&console.warn("Unsupported prop change on Elements: You cannot change the `stripe` prop after setting it.")},[d,n]);var f=W2(r);return we.useEffect(function(){if(c.elements){var m=G7(r,f,["clientSecret","fonts"]);m&&c.elements.update(m)}},[r,f,c.elements]),we.useEffect(function(){ate(c.stripe)},[c.stripe]),we.createElement(mg.Provider,{value:c},s)};Z7.propTypes={stripe:yr.any,options:yr.object};var ote=function(t){var n=we.useContext(mg);return J7(n,t)},lte=function(){var t=ote("calls useElements()"),n=t.elements;return n};yr.func.isRequired;var X7=we.createContext(null);X7.displayName="CustomCheckoutSdkContext";var cte=function(t,n){if(!t)throw new Error("Could not find CustomCheckoutProvider context; You need to wrap the part of your app that ".concat(n," in an <CustomCheckoutProvider> provider."));return t},ute=we.createContext(null);ute.displayName="CustomCheckoutContext";yr.any,yr.shape({clientSecret:yr.string.isRequired,elementsOptions:yr.object}).isRequired;var V2=function(t){var n=we.useContext(X7),r=we.useContext(mg);if(n&&r)throw new Error("You cannot wrap the part of your app that ".concat(t," in both <CustomCheckoutProvider> and <Elements> providers."));return n?cte(n,t):J7(r,t)},dte=function(t){return t.charAt(0).toUpperCase()+t.slice(1)},Gr=function(t,n){var r="".concat(dte(t),"Element"),s=function(c){var u=c.id,d=c.className,f=c.options,m=f===void 0?{}:f,h=c.onBlur,x=c.onFocus,y=c.onReady,p=c.onChange,g=c.onEscape,w=c.onClick,v=c.onLoadError,N=c.onLoaderStart,A=c.onNetworksChange,P=c.onConfirm,U=c.onCancel,M=c.onShippingAddressChange,S=c.onShippingRateChange,C=V2("mounts <".concat(r,">")),_="elements"in C?C.elements:null,T="customCheckoutSdk"in C?C.customCheckoutSdk:null,B=we.useState(null),$=V7(B,2),D=$[0],L=$[1],O=we.useRef(null),W=we.useRef(null);bi(D,"blur",h),bi(D,"focus",x),bi(D,"escape",g),bi(D,"click",w),bi(D,"loaderror",v),bi(D,"loaderstart",N),bi(D,"networkschange",A),bi(D,"confirm",P),bi(D,"cancel",U),bi(D,"shippingaddresschange",M),bi(D,"shippingratechange",S),bi(D,"change",p);var E;y&&(t==="expressCheckout"?E=y:E=function(){y(D)}),bi(D,"ready",E),we.useLayoutEffect(function(){if(O.current===null&&W.current!==null&&(_||T)){var V=null;T?V=T.createElement(t,m):_&&(V=_.create(t,m)),O.current=V,L(V),V&&V.mount(W.current)}},[_,T,m]);var H=W2(m);return we.useEffect(function(){if(O.current){var V=G7(m,H,["paymentRequest"]);V&&"update"in O.current&&O.current.update(V)}},[m,H]),we.useLayoutEffect(function(){return function(){if(O.current&&typeof O.current.destroy=="function")try{O.current.destroy(),O.current=null}catch{}}},[]),we.createElement("div",{id:u,className:d,ref:W})},i=function(c){V2("mounts <".concat(r,">"));var u=c.id,d=c.className;return we.createElement("div",{id:u,className:d})},l=n?i:s;return l.propTypes={id:yr.string,className:yr.string,onChange:yr.func,onBlur:yr.func,onFocus:yr.func,onReady:yr.func,onEscape:yr.func,onClick:yr.func,onLoadError:yr.func,onLoaderStart:yr.func,onNetworksChange:yr.func,onConfirm:yr.func,onCancel:yr.func,onShippingAddressChange:yr.func,onShippingRateChange:yr.func,options:yr.object},l.displayName=r,l.__elementType=t,l},Yr=typeof window>"u",fte=we.createContext(null);fte.displayName="EmbeddedCheckoutProviderContext";var hte=function(){var t=V2("calls useStripe()"),n=t.stripe;return n};Gr("auBankAccount",Yr);var d4=Gr("card",Yr);Gr("cardNumber",Yr);Gr("cardExpiry",Yr);Gr("cardCvc",Yr);Gr("fpxBank",Yr);Gr("iban",Yr);Gr("idealBank",Yr);Gr("p24Bank",Yr);Gr("epsBank",Yr);Gr("payment",Yr);Gr("expressCheckout",Yr);Gr("currencySelector",Yr);Gr("paymentRequestButton",Yr);Gr("linkAuthentication",Yr);Gr("address",Yr);Gr("shippingAddress",Yr);Gr("paymentMethodMessaging",Yr);Gr("affirmMessage",Yr);Gr("afterpayClearpayMessage",Yr);const mte=Vee("pk_live_51S6EXD5qoy7m34J1ssDHcQOn3qgDqmoZrfb6qI2Mjbtn5qagd5T3h8CXWsWdvFkFbpKkhyg3qeAMSc5izbzsISVd004l89jmyc"),lx=(e,t)=>{try{const r=e*({USD:1,AED:3.67,EGP:30.9,SAR:3.75}[t]||1);return new Intl.NumberFormat("en-US",{style:"currency",currency:t}).format(r)}catch{return new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e)}},pte=({plan:e,userEmail:t,selectedPaymentMethod:n,selectedCurrency:r,formatPrice:s,onPaymentComplete:i,onPaymentError:l})=>{const o=hte(),c=lte(),{language:u}=Xt(),[d,f]=Y.useState(!1),[m,h]=Y.useState(""),[x,y]=Y.useState(""),p=async w=>{var v;if(w.preventDefault(),!o||!c){h(u==="ar"?" Stripe     ":" Stripe not loaded properly");return}if(!x){h(u==="ar"?"   ":" Please enter your name");return}f(!0),h("");try{const N={email:t,productId:e.productId,currency:r};let A;if(n==="recurring"?A=await Hu.createSubscription(N):A=await Hu.createOneTimePayment(N),!A||!A.clientSecret&&!A.url)throw new Error(u==="ar"?"   ":"Failed to create payment");if(A.url||A.Url){window.location.href=A.url||A.Url;return}const P=A.clientSecret,U=c.getElement(d4);if(!P||!U)throw new Error(u==="ar"?"   ":" Missing payment details");const M=await o.confirmCardPayment(P,{payment_method:{card:U,billing_details:{name:x,email:t}}});if(M.error)throw new Error(M.error.message||(u==="ar"?" ":"Payment failed"));((v=M.paymentIntent)==null?void 0:v.status)==="succeeded"&&(h(u==="ar"?"   !":" Payment succeeded!"),i())}catch(N){console.error("Payment error:",N);const A=N.message||(u==="ar"?"   ":"An unexpected error occurred");h(` ${A}`),l(A)}finally{f(!1)}},g={style:{base:{fontSize:"16px",color:"#424770","::placeholder":{color:"#aab7c4"}},invalid:{color:"#9e2146"}}};return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-foreground",children:u==="ar"?"  ":"Name on Card"}),a.jsx(Kt,{id:"name",type:"text",value:x,onChange:w=>y(w.target.value),placeholder:u==="ar"?" ":"Full Name",required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{htmlFor:"card",className:"block text-sm font-medium text-foreground",children:u==="ar"?" ":"Card Information"}),a.jsx("div",{className:"border rounded-md p-3 bg-card",children:a.jsx(d4,{options:g})})]})]}),m&&a.jsx("div",{className:`p-3 rounded-md text-center ${m.includes("")?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-100":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-100"}`,children:m}),a.jsx("div",{className:"space-y-3",children:a.jsx(ge,{onClick:p,disabled:!o||d,className:"w-full",children:d?u==="ar"?" ...":"Processing...":`${u==="ar"?"":"Pay"} ${s(e.price,r)}`})})]})},gte=()=>{const e=Ir(),t=G2(),{productId:n}=Gu(),{userEmail:r,isAuthenticated:s,isLoading:i}=O7(),{language:l}=Xt(),o=t.state,[c,u]=Y.useState((o==null?void 0:o.plan)||null),[d,f]=Y.useState(null),[m,h]=Y.useState("USD"),[x,y]=Y.useState(!(o!=null&&o.plan)),[p,g]=Y.useState(null);if(i)return a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})});if(!s)return a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:a.jsxs(Qe,{className:"max-w-md w-full mx-4",children:[a.jsx(xt,{children:a.jsx(yt,{children:l==="ar"?"  ":"Login Required"})}),a.jsxs(tt,{children:[a.jsx("p",{className:"text-muted-foreground",children:l==="ar"?"     ":"Please log in to complete payment"}),a.jsx(ge,{onClick:()=>e("/login"),className:"w-full mt-4",children:l==="ar"?" ":"Login"})]})]})});Y.useEffect(()=>{(async()=>{if(n&&!c)try{y(!0);const U=(await Hu.getAllPlans()).find(M=>M.productId===n);U?u(U):g(l==="ar"?"  ":"Plan not found")}catch(P){console.error("Error fetching plan:",P),g(l==="ar"?"   ":"Failed to load plan")}finally{y(!1)}})()},[n,c,l]);const w=()=>{e("/subscription/success")},v=A=>{console.error("Payment error:",A)},N=async(A,P)=>{A.preventDefault(),f(P?"recurring":"one-time")};return x?a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})}):p||!c?a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:a.jsxs(Qe,{className:"max-w-md w-full mx-4",children:[a.jsx(xt,{children:a.jsx(yt,{className:"text-destructive",children:l==="ar"?"":"Error"})}),a.jsxs(tt,{children:[a.jsx("p",{className:"text-muted-foreground",children:p||(l==="ar"?"  ":"Plan not available")}),a.jsx(ge,{onClick:()=>e("/subscription"),className:"w-full mt-4",children:l==="ar"?"  ":"Back to Plans"})]})]})}):a.jsx("div",{className:"min-h-screen bg-background py-12",children:a.jsxs("div",{className:"max-w-2xl mx-auto px-4 sm:px-6 lg:px-8",children:[a.jsxs("div",{className:"text-center mb-8",children:[a.jsx("h1",{className:"text-3xl font-bold text-foreground",children:l==="ar"?" ":"Complete Payment"}),a.jsx("p",{className:"mt-2 text-muted-foreground",children:l==="ar"?"     ":"Please enter your payment information"})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsx(yt,{children:l==="ar"?" ":"Order Summary"})}),a.jsxs(tt,{className:"space-y-4",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium text-foreground",children:c.name}),a.jsx("p",{className:"text-sm text-muted-foreground",children:c.billingCycle==="year"?l==="ar"?" ":"Yearly Subscription":l==="ar"?" ":"Monthly Subscription"})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"font-medium text-foreground",children:lx(c.price,m)}),a.jsx("p",{className:"text-sm text-muted-foreground",children:m})]})]}),a.jsx("div",{className:"border-t border-border pt-4",children:a.jsxs("div",{className:"flex justify-between",children:[a.jsx("p",{className:"font-medium text-foreground",children:l==="ar"?"":"Total"}),a.jsx("p",{className:"font-medium text-foreground",children:lx(c.price,m)})]})})]})]}),a.jsxs(Qe,{children:[a.jsxs(xt,{children:[a.jsx(yt,{children:l==="ar"?" ":"Payment Information"}),a.jsx(bs,{children:l==="ar"?"   ":"Enter your credit card information"})]}),a.jsxs(tt,{children:[a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"text-center",children:a.jsx("h3",{className:"text-lg font-medium text-gray-900",children:l==="ar"?"  ":"Choose Payment Method"})}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("label",{htmlFor:"currency",className:"text-sm font-medium text-gray-700",children:l==="ar"?":":"Currency:"}),a.jsxs("select",{id:"currency",value:m,onChange:A=>h(A.target.value),className:"border border-gray-300 rounded-md px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:[a.jsxs("option",{value:"USD",children:[l==="ar"?" ":"US Dollar"," (USD)"]}),a.jsxs("option",{value:"AED",children:[l==="ar"?" ":"UAE Dirham"," (AED)"]}),a.jsxs("option",{value:"EGP",children:[l==="ar"?" ":"Egyptian Pound"," (EGP)"]}),a.jsxs("option",{value:"SAR",children:[l==="ar"?" ":"Saudi Riyal"," (SAR)"]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 gap-3",children:[a.jsx(ge,{onClick:A=>N(A,!1),className:`w-full py-6 ${d==="one-time"?"ring-2 ring-blue-500":""}`,children:a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx("span",{className:"font-semibold text-lg",children:l==="ar"?" ":"One-time Payment"}),a.jsx("span",{className:"text-sm opacity-80",children:l==="ar"?"  ":"No auto-renewal"})]})}),a.jsx(ge,{onClick:A=>N(A,!0),variant:"outline",className:`w-full py-6 ${d==="recurring"?"ring-2 ring-blue-500":""}`,children:a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx("span",{className:"font-semibold text-lg",children:c.billingCycle==="year"?l==="ar"?"  ":"Annual Auto-renewal":l==="ar"?"  ":"Monthly Auto-renewal"}),a.jsx("span",{className:"text-sm opacity-80",children:c.billingCycle==="year"?l==="ar"?"   ":"Auto-renewal every year":l==="ar"?"   ":"Auto-renewal every month"})]})})]})]}),d&&a.jsxs("div",{className:"mt-8",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h4",{className:"text-md font-medium text-gray-900",children:l==="ar"?" ":"Card Information"}),a.jsx("div",{className:"text-sm text-gray-500",children:d==="recurring"?l==="ar"?" ":"Auto-renewal":l==="ar"?" ":"One-time payment"})]}),a.jsx(Z7,{stripe:mte,children:a.jsx(pte,{plan:c,userEmail:r||"",selectedPaymentMethod:d,selectedCurrency:m,formatPrice:lx,onPaymentComplete:w,onPaymentError:v})})]})]})]})]})]})})},xte=()=>{const e=Ir(),{language:t}=Xt();return a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:a.jsxs(Qe,{className:"max-w-md w-full mx-auto",children:[a.jsxs(xt,{className:"text-center",children:[a.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-green-100 dark:bg-green-900",children:a.jsx(Si,{className:"h-6 w-6 text-green-600 dark:text-green-400"})}),a.jsx(yt,{className:"text-2xl",children:t==="ar"?"  !":"Payment Successful!"}),a.jsx(bs,{children:t==="ar"?"  ":"Thank you for your subscription"})]}),a.jsxs(tt,{className:"space-y-6",children:[a.jsx("div",{className:"text-center",children:a.jsx("p",{className:"text-muted-foreground",children:t==="ar"?"   .        .":"Your payment has been successfully confirmed. You now have access to all features of your chosen plan."})}),a.jsx("div",{className:"bg-green-50 border border-green-200 rounded-md p-4 dark:bg-green-900/20 dark:border-green-800",children:a.jsxs("div",{className:"flex",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx(Si,{className:"h-5 w-5 text-green-400 dark:text-green-500"})}),a.jsxs("div",{className:"ml-3",children:[a.jsx("h3",{className:"text-sm font-medium text-green-800 dark:text-green-200",children:t==="ar"?" ":"What's next?"}),a.jsx("div",{className:"mt-2 text-sm text-green-700 dark:text-green-300",children:a.jsxs("ul",{className:"list-disc space-y-1 pl-5",children:[a.jsx("li",{children:t==="ar"?"     ":"You can now create your family trees"}),a.jsx("li",{children:t==="ar"?"    ":"You can invite family members to collaborate"}),a.jsx("li",{children:t==="ar"?"     ":"You have access to all premium features"})]})})]})]})}),a.jsxs("div",{className:"flex flex-col space-y-3",children:[a.jsx(ge,{asChild:!0,children:a.jsx(It,{to:"/dashboard",children:t==="ar"?"   ":"Go to Dashboard"})}),a.jsx(ge,{variant:"outline",onClick:()=>e("/subscription"),children:t==="ar"?"  ":"View Subscription Plans"})]})]})]})})},yte=()=>{const e=Ir();return a.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:a.jsxs(Qe,{className:"p-8 text-center max-w-md",children:[a.jsx("div",{className:"text-yellow-500 dark:text-yellow-400 mb-6",children:a.jsx(sy,{className:"h-16 w-16 mx-auto"})}),a.jsx("h1",{className:"text-2xl font-bold text-foreground mb-2",children:"  "}),a.jsx("p",{className:"text-muted-foreground mb-6",children:"   .         ."}),a.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 mb-6 dark:bg-blue-900/20",children:[a.jsx("h3",{className:"font-semibold text-blue-900 mb-2 dark:text-blue-100",children:"    "}),a.jsx("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:"           ."})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs(ge,{onClick:()=>e("/subscription"),className:"w-full",children:[a.jsx(po,{className:"h-4 w-4 ml-2"})," "]}),a.jsx(ge,{variant:"outline",onClick:()=>e("/dashboard"),className:"w-full",children:"   "}),a.jsxs(ge,{variant:"outline",onClick:()=>e("/"),className:"w-full",children:[a.jsx(ho,{className:"h-4 w-4 ml-2"})," "]})]}),a.jsx("div",{className:"mt-6 pt-6 border-t border-border",children:a.jsx("p",{className:"text-xs text-muted-foreground",children:"        "})})]})})},bte=()=>{const{language:e}=Xt();return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background px-4",children:a.jsxs("div",{className:"max-w-md w-full text-center",children:[a.jsxs("div",{className:"mb-8",children:[a.jsx("div",{className:"mx-auto w-32 h-32 bg-primary/10 rounded-full flex items-center justify-center mb-6",children:a.jsx("svg",{className:"w-16 h-16 text-primary",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.172 16.172a4 4 0 015.656 0M9 12h6m-6-4h6m2 5.291A7.962 7.962 0 0112 15c-2.34 0-4.291-1.007-5.691-2.709M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})})}),a.jsx("h1",{className:"text-6xl font-bold text-primary mb-4",children:"404"})]}),a.jsxs("div",{className:"mb-8",children:[a.jsx("h2",{className:"text-2xl font-semibold text-foreground mb-4",children:e==="ar"?"  ":"Page Not Found"}),a.jsx("p",{className:"text-muted-foreground mb-6",children:e==="ar"?"            .":"Sorry, the page you're looking for doesn't exist or has been moved to another location."})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx(ge,{asChild:!0,className:"w-full",children:a.jsxs(It,{to:"/",children:[a.jsx(b0,{className:"w-4 h-4 mr-2"}),e==="ar"?" ":"Go Home"]})}),a.jsx(ge,{asChild:!0,variant:"outline",className:"w-full",children:a.jsxs(It,{to:"#",onClick:()=>window.history.back(),children:[a.jsx(ho,{className:"w-4 h-4 mr-2"}),e==="ar"?" ":"Go Back"]})})]}),a.jsx("div",{className:"mt-8 pt-8 border-t border-border",children:a.jsxs("p",{className:"text-sm text-muted-foreground",children:[e==="ar"?"       ":"If you think this is an error, please ",a.jsx(It,{to:"/contact",className:"text-primary hover:text-primary/80 underline",children:e==="ar"?" ":"contact us"}),"."]})})]})})},Kb=()=>a.jsx("div",{className:"min-h-screen bg-background",children:a.jsxs("div",{className:"lg:pl-72",children:[a.jsxs("div",{className:"sticky top-0 z-40 flex h-16 shrink-0 items-center gap-x-4 border-b border-border bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60 px-4 shadow-sm sm:gap-x-6 sm:px-6 lg:px-8",children:[a.jsx("div",{className:"flex flex-1"}),a.jsx("div",{className:"flex items-center gap-x-4 lg:gap-x-6",children:a.jsx("div",{className:"relative",children:a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("div",{className:"h-8 w-8 rounded-full bg-muted animate-pulse"})}),a.jsxs("div",{className:"hidden lg:block",children:[a.jsx("div",{className:"h-4 w-20 bg-muted rounded animate-pulse mb-1"}),a.jsx("div",{className:"h-3 w-16 bg-muted rounded animate-pulse"})]})]})})})]}),a.jsx("main",{className:"py-6",children:a.jsx("div",{className:"px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"space-y-8",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[a.jsxs("div",{children:[a.jsx("div",{className:"h-8 w-48 bg-muted rounded animate-pulse mb-2"}),a.jsx("div",{className:"h-4 w-64 bg-muted rounded animate-pulse"})]}),a.jsx("div",{className:"mt-4 sm:mt-0",children:a.jsx("div",{className:"h-10 w-32 bg-muted rounded animate-pulse"})})]}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:[...Array(4)].map((e,t)=>a.jsxs("div",{className:"rounded-lg border bg-card text-card-foreground shadow-sm p-6",children:[a.jsxs("div",{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[a.jsx("div",{className:"h-4 w-24 bg-muted rounded animate-pulse"}),a.jsx("div",{className:"h-4 w-4 bg-muted rounded-full animate-pulse"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"h-6 w-8 bg-muted rounded animate-pulse"}),a.jsx("div",{className:"h-3 w-16 bg-muted rounded animate-pulse"})]})]},t))}),a.jsxs("div",{children:[a.jsx("div",{className:"h-6 w-32 bg-muted rounded animate-pulse mb-4"}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:[...Array(4)].map((e,t)=>a.jsx("div",{className:"rounded-lg border bg-card text-card-foreground shadow-sm h-24 p-4",children:a.jsxs("div",{className:"space-y-3",children:[a.jsx("div",{className:"h-6 w-6 bg-muted rounded animate-pulse"}),a.jsx("div",{className:"h-4 w-20 bg-muted rounded animate-pulse"}),a.jsx("div",{className:"h-3 w-16 bg-muted rounded animate-pulse"})]})},t))})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[a.jsx("div",{className:"rounded-lg border bg-card text-card-foreground shadow-sm",children:a.jsxs("div",{className:"p-6",children:[a.jsx("div",{className:"h-5 w-32 bg-muted rounded animate-pulse mb-4"}),a.jsx("div",{className:"space-y-4",children:[...Array(3)].map((e,t)=>a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx("div",{className:"w-8 h-8 bg-muted rounded-full animate-pulse"})}),a.jsxs("div",{className:"flex-1 min-w-0 space-y-2",children:[a.jsx("div",{className:"h-4 w-48 bg-muted rounded animate-pulse"}),a.jsx("div",{className:"h-3 w-20 bg-muted rounded animate-pulse"})]})]},t))})]})}),a.jsx("div",{className:"rounded-lg border bg-card text-card-foreground shadow-sm",children:a.jsxs("div",{className:"p-6",children:[a.jsx("div",{className:"h-5 w-32 bg-muted rounded animate-pulse mb-4"}),a.jsx("div",{className:"space-y-4",children:[...Array(3)].map((e,t)=>a.jsxs("div",{className:"flex items-start justify-between p-3 bg-muted/30 rounded-lg",children:[a.jsxs("div",{className:"flex-1 space-y-2",children:[a.jsx("div",{className:"h-4 w-32 bg-muted rounded animate-pulse"}),a.jsx("div",{className:"h-3 w-40 bg-muted rounded animate-pulse"})]}),a.jsx("div",{className:"h-6 w-6 bg-muted rounded animate-pulse"})]},t))})]})})]})]})})})]})}),vte=({onCancel:e,onSuccess:t})=>{const n=Ir(),{language:r}=Xt(),{createTree:s,isLoading:i,trees:l}=xs(),{limits:o,isLimitReached:c}=xc(),u=Y.useRef(null),{isMobile:d}=Tr(),f=r==="ar",[m,h]=Y.useState({name:"",nameEn:"",description:"",descriptionEn:"",isPublic:!0,allowCollaboration:!1}),[x,y]=Y.useState(null),p=c("trees",l.length),g=N=>{var P;const A=(P=N.target.files)==null?void 0:P[0];if(A){const U=new FileReader;U.onload=M=>{var C;const S=(C=M.target)==null?void 0:C.result;h(_=>({..._,coverImage:S}))},U.readAsDataURL(A)}},w=async()=>{var N,A;try{if(y(null),p){const U=(o==null?void 0:o.trees)||1,M=f?`       (${U} ).     .`:`You've reached the maximum number of trees (${U} trees). Please upgrade your subscription to create more.`;y(M),dn.error({en:M,ar:M});return}const P=await Pt.createTree(f?m.name:m.nameEn,!m.isPublic,f?m.description||"":m.descriptionEn||"");dn.success({en:"Tree created successfully",ar:"   "}),t?t(P.id):n(`/trees/${P.id}`)}catch(P){let U=f?"   ":"Failed to create tree";if(P.response)if(P.response.status===400)if((N=P.response.data)!=null&&N.message){const M=P.response.data.message.toLowerCase();M.includes("duplicate")||M.includes("already exists")||M.includes("in use")||M.includes("unique")?U=f?"   .    .":"Tree name is already in use. Please choose a different name.":U+=`: ${P.response.data.message}`}else U=f?"  .     .":"Invalid request. Please check the entered information.";else(A=P.response.data)!=null&&A.message&&(U+=`: ${P.response.data.message}`);else P.message&&(U+=`: ${P.message}`);y(U),dn.error({en:U,ar:U})}},v=()=>m.name.trim()!==""&&m.nameEn.trim()!=="";return a.jsxs("div",{className:"space-y-6",children:[x&&a.jsx("div",{className:"bg-destructive/10 border border-destructive/20 rounded-lg p-3",children:a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(fo,{className:"h-5 w-5 text-destructive flex-shrink-0 mt-0.5"}),a.jsx("p",{className:"text-destructive text-sm",children:x})]})}),a.jsxs(Qe,{children:[a.jsx(xt,{children:a.jsxs(yt,{className:"flex items-center gap-2",children:[a.jsx(ju,{className:"h-5 w-5"}),d?f?"":"Info":f?" ":"Tree Information"]})}),a.jsxs(tt,{className:"space-y-6",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:d?f?"":"Image":f?" ":"Cover Image"}),a.jsxs("div",{className:"relative",children:[a.jsx("div",{className:`w-full rounded-lg bg-gradient-to-br from-primary/20 to-primary/40 flex items-center justify-center overflow-hidden ${d?"h-32":"h-48"}`,children:m.coverImage?a.jsx("img",{src:m.coverImage,alt:"Tree Cover",className:"w-full h-full object-cover"}):a.jsxs("div",{className:"text-center",children:[a.jsx(Qn,{className:`mx-auto mb-2 ${d?"h-8 w-8":"h-16 w-16"}`}),a.jsx("p",{className:"text-sm text-muted-foreground",children:d?f?" ":"Choose Image":f?"   ":"Choose a cover image for the tree"})]})}),a.jsxs(ge,{size:d?"sm":"default",variant:"outline",className:`absolute bottom-2 right-2 flex items-center gap-2 ${d?"px-2 py-1 text-xs":""}`,onClick:()=>{var N;return(N=u.current)==null?void 0:N.click()},children:[a.jsx(dh,{className:`h-4 w-4 ${d?"h-3 w-3":""}`}),d?f?"":"Image":f?" ":"Choose Image"]}),a.jsx("input",{ref:u,type:"file",accept:"image/*",onChange:g,className:"hidden"})]})]}),a.jsxs("div",{className:`grid grid-cols-1 ${d?"gap-4":"md:grid-cols-2 gap-6"}`,children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:d?f?" ()":"Name (Ar)":f?"  () *":"Tree Name (Arabic) *"}),a.jsx(Kt,{value:m.name,onChange:N=>h(A=>({...A,name:N.target.value})),placeholder:d?f?" ":"Tree Name":f?":    ":"Example: Al-Ahmed Family Tree",required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:d?f?" ()":"Name (En)":f?"  () *":"Tree Name (English) *"}),a.jsx(Kt,{value:m.nameEn,onChange:N=>h(A=>({...A,nameEn:N.target.value})),placeholder:d?"Tree Name":"Example: Al-Ahmed Family Tree",required:!0})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("label",{className:"text-sm font-medium",children:d?f?"":"Description":f?" ":"Tree Description"}),a.jsx(id,{value:f?m.description||"":m.descriptionEn||"",onChange:N=>h(A=>({...A,[f?"description":"descriptionEn"]:N.target.value})),placeholder:d?f?" ":"Tree Description":f?"  ...":"Write a description for the tree...",rows:d?3:4})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:`font-medium ${d?"text-base":"text-lg"}`,children:d?f?"":"Settings":f?" ":"Privacy Settings"}),a.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[a.jsxs("div",{children:[a.jsx("p",{className:`font-medium ${d?"text-sm":""}`,children:d?f?"":"Public":f?" ":"Public Tree"}),a.jsx("p",{className:`text-sm text-muted-foreground ${d?"text-xs":""}`,children:f?"   ":"Everyone can view the tree"})]}),a.jsx(ge,{variant:m.isPublic?"default":"outline",size:d?"sm":"default",onClick:()=>h(N=>({...N,isPublic:!N.isPublic})),children:m.isPublic?f?"":"Public":f?"":"Private"})]}),a.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[a.jsxs("div",{children:[a.jsx("p",{className:`font-medium ${d?"text-sm":""}`,children:d?f?"":"Collab":f?" ":"Allow Collaboration"}),a.jsx("p",{className:`text-sm text-muted-foreground ${d?"text-xs":""}`,children:f?"  ":"Allow others to contribute"})]}),a.jsx(ge,{variant:m.allowCollaboration?"default":"outline",size:d?"sm":"default",onClick:()=>h(N=>({...N,allowCollaboration:!N.allowCollaboration})),children:m.allowCollaboration?f?"":"On":f?"":"Off"})]})]}),a.jsxs("div",{className:`flex ${d?"flex-col gap-2":"gap-3 pt-4"}`,children:[a.jsxs(ge,{onClick:w,className:`flex items-center gap-2 ${d?"w-full":""}`,disabled:i||!v()||p,children:[i?a.jsx(wr,{className:`animate-spin ${d?"h-3 w-3":"h-4 w-4"}`}):a.jsx(Au,{className:`h-4 w-4 ${d?"h-3 w-3":""}`}),d?f?"":"Create":f?" ":"Create Tree"]}),a.jsx(ge,{variant:"outline",onClick:e||(()=>n("/trees")),disabled:i,className:d?"w-full":"",children:f?"":"Cancel"})]})]})]})]})},wte=({onLogout:e,showWarning:t,setShowWarning:n})=>{const[r,s]=Y.useState(60),{language:i}=Xt(),{resetLogoutTimer:l}=Q4(10);Y.useEffect(()=>{let c=null;return t&&(s(60),c=setInterval(()=>{s(u=>u<=1?(e(),0):u-1)},1e3)),()=>{c&&clearInterval(c)}},[t,e]);const o=()=>{n(!1),s(60),l()};return t?a.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/50",children:a.jsx("div",{className:"bg-card rounded-lg p-6 max-w-md w-full mx-4 border border-border shadow-lg",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-warning/10 mb-4",children:a.jsx("svg",{className:"h-6 w-6 text-warning",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})})}),a.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:i==="ar"?"  ":"Automatic Logout Warning"}),a.jsx("p",{className:"text-muted-foreground mb-4",children:i==="ar"?`    .      ${r}       .`:`You've been inactive for a while. You will be automatically logged out in ${r} seconds if no activity is detected.`}),a.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[a.jsx(ge,{onClick:o,className:"w-full sm:w-auto",children:i==="ar"?" ":"Stay Logged In"}),a.jsx(ge,{variant:"outline",onClick:e,className:"w-full sm:w-auto",children:i==="ar"?"  ":"Logout Now"})]})]})})}):null},Ds=({children:e})=>{const{isAuthenticated:t,isLoading:n,user:r}=Pr(),s=G2();if(Q4(10),n)return a.jsx(Kb,{});if(!t){const i=s.pathname+s.search;return localStorage.setItem("attemptedUrl",i),a.jsx(Cf,{to:"/login",replace:!0})}return a.jsx(a.Fragment,{children:e})},Om=({children:e})=>{const{isAuthenticated:t,isLoading:n}=Pr();if(n&&!t)return a.jsx(Kb,{});if(t){const s=localStorage.getItem("attemptedUrl");return s?(localStorage.removeItem("attemptedUrl"),a.jsx(Cf,{to:s,replace:!0})):a.jsx(Cf,{to:"/dashboard",replace:!0})}return a.jsx(a.Fragment,{children:e})},Nte=()=>{const{isLoading:e,isAuthenticated:t,user:n}=Pr(),{language:r,theme:s}=Xt(),[i,l]=Y.useState(!1);we.useEffect(()=>{const c=document.documentElement;c.setAttribute("lang",r),c.setAttribute("dir",r==="ar"?"rtl":"ltr"),c.classList.toggle("dark",s==="dark")},[r,s]),Y.useEffect(()=>{const c=()=>{l(!0)};return window.addEventListener("inactivity-warning",c),()=>{window.removeEventListener("inactivity-warning",c)}},[]);const o=async()=>{const{logout:c}=Pr.getState();try{await c()}catch{}finally{l(!1),window.location.href="/login"}};return e?a.jsx(Kb,{}):a.jsxs("div",{className:"min-h-screen bg-background text-foreground",children:[t&&a.jsx(wte,{onLogout:o,showWarning:i,setShowWarning:l}),a.jsxs(BE,{children:[a.jsx(Un,{path:"/",element:a.jsx(Do,{children:a.jsx(FG,{})})}),a.jsx(Un,{path:"/login",element:a.jsx(Om,{children:a.jsx($d,{children:a.jsx(UG,{})})})}),a.jsx(Un,{path:"/register",element:a.jsx(Om,{children:a.jsx($d,{children:a.jsx(HG,{})})})}),a.jsx(Un,{path:"/forgot-password",element:a.jsx(Om,{children:a.jsx($d,{children:a.jsx(VG,{})})})}),a.jsx(Un,{path:"/reset-password",element:a.jsx(Om,{children:a.jsx($d,{children:a.jsx(YG,{})})})}),a.jsx(Un,{path:"/verify-email",element:a.jsx($d,{children:a.jsx(JG,{})})}),a.jsx(Un,{path:"/shared/:id",element:a.jsx(pee,{})}),a.jsx(Un,{path:"/dashboard",element:a.jsx(Ds,{children:a.jsx(gs,{children:a.jsx(QG,{})})})}),a.jsx(Un,{path:"/subscription",element:a.jsx(Ds,{children:a.jsx(gs,{children:a.jsx(Oee,{})})})}),a.jsx(Un,{path:"/subscription/checkout/:productId",element:a.jsx(Ds,{children:a.jsx(gs,{children:a.jsx(gte,{})})})}),a.jsx(Un,{path:"/subscription/success",element:a.jsx(Ds,{children:a.jsx(gs,{children:a.jsx(xte,{})})})}),a.jsx(Un,{path:"/subscription/cancel",element:a.jsx(Ds,{children:a.jsx(gs,{children:a.jsx(yte,{})})})}),a.jsx(Un,{path:"/trees",element:a.jsx(Ds,{children:a.jsx(gs,{children:a.jsx(eY,{})})})}),a.jsx(Un,{path:"/trees/create",element:a.jsx(Ds,{children:a.jsx(gs,{children:a.jsx(vte,{})})})}),a.jsx(Un,{path:"/trees/:id",element:a.jsx(Ds,{children:a.jsx(gs,{children:a.jsx(cee,{})})})}),a.jsx(Un,{path:"/trees/:id/edit",element:a.jsx(Ds,{children:a.jsx(gs,{children:a.jsx(mee,{})})})}),a.jsx(Un,{path:"/persons/create",element:a.jsx(Ds,{children:a.jsx(gs,{children:a.jsx(MA,{})})})}),a.jsx(Un,{path:"/persons/:id",element:a.jsx(Ds,{children:a.jsx(gs,{children:a.jsx(gee,{})})})}),a.jsx(Un,{path:"/persons/:id/edit",element:a.jsx(Ds,{children:a.jsx(gs,{children:a.jsx(xee,{})})})}),a.jsx(Un,{path:"/search",element:a.jsx(Ds,{children:a.jsx(gs,{children:a.jsx(yee,{})})})}),a.jsx(Un,{path:"/contact",element:a.jsx(Do,{children:a.jsx(_ee,{})})}),a.jsx(Un,{path:"/profile",element:a.jsx(Ds,{children:a.jsx(gs,{children:a.jsx(vee,{})})})}),a.jsx(Un,{path:"/settings",element:a.jsx(Ds,{children:a.jsx(gs,{children:a.jsx(bee,{})})})}),a.jsx(Un,{path:"/pricing",element:a.jsx(Do,{children:a.jsx(Fee,{})})}),a.jsx(Un,{path:"/features",element:a.jsx(Do,{children:a.jsx(wee,{})})}),a.jsx(Un,{path:"/about",element:a.jsx(Do,{children:a.jsx(jee,{})})}),a.jsx(Un,{path:"/privacy",element:a.jsx(Do,{children:a.jsx(Aee,{})})}),a.jsx(Un,{path:"/terms",element:a.jsx(Do,{children:a.jsx(kee,{})})}),a.jsx(Un,{path:"/admin/dashboard",element:a.jsx(a5,{children:a.jsx(gs,{children:a.jsx(Pee,{})})})}),a.jsx(Un,{path:"/admin/join-requests",element:a.jsx(a5,{children:a.jsx(gs,{children:a.jsx($ee,{})})})}),a.jsx(Un,{path:"*",element:a.jsx(Do,{children:a.jsx(bte,{})})})]})]})};try{Pr.getState().initialize()}catch{}const jte=new FE({defaultOptions:{queries:{staleTime:5*60*1e3,gcTime:10*60*1e3,retry:(e,t)=>{var n,r;return((n=t==null?void 0:t.response)==null?void 0:n.status)>=400&&((r=t==null?void 0:t.response)==null?void 0:r.status)<500?!1:e<3},refetchOnWindowFocus:!1},mutations:{retry:!1}}});class Ste extends we.Component{constructor(t){super(t),this.state={hasError:!1}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,n){}render(){return this.state.hasError?a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:a.jsx("div",{className:"max-w-md w-full mx-auto p-6",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-destructive/10",children:a.jsx("svg",{className:"h-6 w-6 text-destructive",fill:"none",viewBox:"0 0 24 24",strokeWidth:"1.5",stroke:"currentColor",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z"})})}),a.jsx("h1",{className:"mt-4 text-xl font-semibold text-foreground",children:"Something went wrong"}),a.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:"We're sorry, but something unexpected happened. Please try refreshing the page."}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row gap-3 justify-center",children:[a.jsx("button",{onClick:()=>window.location.reload(),className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-primary hover:bg-primary/90 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary",children:"Refresh Page"}),a.jsx("button",{onClick:()=>this.setState({hasError:!1}),className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary",children:"Try Again"})]}),!1]})})}):this.props.children}}const _te={duration:4e3,position:"top-right",style:{background:"hsl(var(--background))",color:"hsl(var(--foreground))",border:"1px solid hsl(var(--border))"},success:{iconTheme:{primary:"hsl(var(--primary))",secondary:"hsl(var(--primary-foreground))"}},error:{iconTheme:{primary:"hsl(var(--destructive))",secondary:"hsl(var(--destructive-foreground))"}}};"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(e=>{}).catch(e=>{})});let cx=null;const Ate=()=>{const e=document.getElementById("root");if(!e)return;const t=document.getElementById("loading");t&&t.remove(),cx||(cx=ux.createRoot(e)),cx.render(a.jsx(we.StrictMode,{children:a.jsx(Ste,{children:a.jsx(OE,{client:jte,children:a.jsxs(zE,{children:[a.jsx(Nte,{}),a.jsx($C,{toastOptions:_te})]})})})}))};Ate();export{Kn as _};
//# sourceMappingURL=index-BTk3zYEH.js.map
